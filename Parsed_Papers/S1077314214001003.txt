@&#MAIN-TITLE@&#Multigrid convergent principal curvature estimators in digital geometry

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose discrete principal curvature estimators based on integral invariants.


                        
                        
                           
                           We prove the multigrid convergence of these estimators.


                        
                        
                           
                           We provide an experimental evaluation on synthetic and real data.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Digital geometry

Curvature estimation

Multigrid convergence

Integral invariants

@&#ABSTRACT@&#


               
               
                  In many geometry processing applications, the estimation of differential geometric quantities such as curvature or normal vector field is an essential step. In this paper, we investigate a new class of estimators on digital shape boundaries based on integral invariants (Pottmann et al., 2007) [39]. More precisely, we provide both proofs of multigrid convergence of principal curvature estimators and a complete experimental evaluation of their performances.
               
            

@&#INTRODUCTION@&#

In many shape processing applications, the estimation of differential quantities on the shape boundary is usually an important step. Their correct estimation makes easier further processing, like quantitative evaluation, feature detection, shape matching or visualization. This paper focuses on estimating the curvature tensor on the boundary of digital shapes. Such digital structures are subsets of the 3-dimensional digital space 
                           
                              
                                 
                                    Z
                                 
                                 
                                    3
                                 
                              
                           
                         and come generally from the digitization of some Euclidean shape. Of course, the curvature tensor estimation should be as close as possible to the curvature tensor of the underlying Euclidean shape before digitization. Digital data form a special case of discrete data with specific properties: (1) digital data cannot sample the boundary of the Euclidean shape (i.e. they do not lie on the shape boundary), (2) digital data is distributed around the true sample according to arithmetic noise, which looks rather uniform over a range 
                           
                              [
                              -
                              h
                              ,
                              h
                              ]
                           
                         from a statistical point of view, where h is the digitization grid step. Another way of stating these characteristics is to say that the Hausdorff distance between the Euclidean shape and its digitization is some 
                           
                              O
                              (
                              h
                              )
                           
                        . Of course, the quality of the estimation should be improved as the digitization step gets finer and finer. This property is called the multigrid convergence 
                        [25,11]. It is similar in spirit with the stability property in geometry processing: given a continuous shape and a specific sampling of its boundary, the estimated measure should converge to the Euclidean one when the sampling become denser (e.g. 
                        [2,35]).

Our objective is to design a curvature tensor estimator for digital data such that: (1) it is provably multigrid convergent, (2) it is accurate in practice, (3) it is computable in an exact manner, (4) it can be efficiently computed either locally or globally (evaluation at a single surface point or extraction of the curvature tensor field), (5) it is robust to further perturbations (like bad digitization around the boundary, outliers).

Digital data being discrete in nature, it is interesting to look at the curvature estimation techniques on triangulated meshes. In computer graphics and geometry processing, there exists a vast family of techniques to estimate either the mean or Gaussian curvatures, or sometimes the full curvature tensor. Most of them are local (i.e. limited to a 1-ring or 2-ring of neighbors) but exhibit correct results for nice meshes. They generally fall into three categories: fitting, discrete methods, curvature tensor estimation. We may refer to [44,20] for comprehensive evaluations, and Desbrun et al. [17] or Bobenko and Suris [5] for an entirely discrete theory. Most of them have not theoretical convergence guarantees even without noise on the mesh. We may quote [37,42] as approaches trying to tackle perturbation through averaging.

For Gaussian curvature estimated with Gauss-Bonnet approach (angle defect), Xu [47] provides a stability theorem for triangulated mesh whose vertices lie on the underlying smooth manifold, with valence 6 and parallelogram condition (each 1-ring of neighbors is projected as a parallelogram onto a plane). Assuming a sampling with density 
                           
                              δ
                           
                        , he provides an additional convergence property whenever the sampling is perturbated by some 
                           
                              O
                              (
                              
                                 
                                    δ
                                 
                                 
                                    α
                                 
                              
                              )
                           
                        , but 
                           
                              α
                              >
                              2
                           
                         (inadequate for discrete data). Note that if the triangulated mesh did not satisfy these requirements, such estimation did not converge.

The integral measures of curvatures, based on normal cycle theory [13,14] is another notable approach for estimating curvature information on a triangulated mesh. The authors exhibit some convergence results for triangulated meshes with vertices lying on the underlying smooth Euclidean shape boundary. In this case, if the mesh has Hausdorff distance to shape boundary below 
                           
                              ∊
                           
                        , convergence is obtained with speed/error 
                           
                              O
                              (
                              ∊
                              )
                           
                         under some hypotheses.

Finally, in geometry processing, interesting mathematical tools have been developed to design differential estimators on smooth surfaces based on integral invariants [39,38]. They consist in moving a kernel along the shape surface and in computing integrals on the intersection between the shape and the kernel. The authors have demonstrated that some integral quantities provide interesting curvature information when the kernel size tends to zero. They also achieve stability depending on the kernel radius and on 
                           
                              ∊
                           
                        , for instance in the case of a mesh sampling. Our new estimators rely on the same ideas.

When having only discrete data (i.e. a cloud of points), the most natural way to approach curvature(s) is to fit a polynomial surface of degree two at least. Perhaps the best representative of these techniques is the osculating jets of Cazals and Pouget [8]. The authors provide 
                           
                              O
                              (
                              
                                 
                                    δ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         convergence results when the data is a surface sampling, assuming 
                           
                              δ
                           
                         is the density of points. There is no theoretical result in presence of noise, although the least-square fitting of osculating jets is very robust to noise in practice.

Another family of techniques exploits the Voronoi diagram [1,34,35]. The idea behind these approaches is, instead of fitting the tangent space, to estimate at best the orthogonal space. The convolved covariance measure introduced by Mérigot et al. [35] is particularly appealing since this measure achieves robustness even for arbitrary compact sets, essentially in 
                           
                              O
                              (
                              
                                 
                                    ∊
                                 
                              
                              )
                           
                        . It is in some sense an integral measure of the covariance matrix of the normal cone around the point of interest. However, convergence of curvature(s) is subject to several parameters r and R which contribute contradictorily to the Hausdorff error. In practice, this approach gives results comparable to osculating jets for curvatures.

Recently, several authors have developed new interesting approaches for estimating the normal vector field on noisy point clouds, even in the presence of sharp features [32,6,48]. Furthermore, Boulch and Marlet [6] gives probabilistic convergence results. Although they cannot be used “as is” for curvature computation, they could be used in parallel with curvature estimation techniques to locate sharp features in a first pass, and to limit curvature estimations to smooth zones.

In digital geometry, we usually consider multigrid convergence as an essential criterion [11]. Hence, in dimension 2, parameter free convergence results have been obtained for length [9] and normal vector estimation [16]. Based either on binomial convolution principles [33,18], or polynomial fitting [40], convergence results can also be obtained for higher order derivatives of digital curves. Algorithms are parametrized by the size of the convolution or fitting kernel support and convergence theorems hold when such support size is an increasing function of the grid resolution and some shape characteristics.

For curvature estimation along 2D curves, multigrid convergence of parameter-free estimators is still challenging, although accurate experimental results have been obtained with maximal digital circular arcs [41] and with global optimization [23]. In 3D digital space, several empirical methods exist for estimating curvatures, but none achieves multigrid convergence (e.g. see [31,19]). In [10], we recently presented a digital estimator for mean curvature for 2D and 3D digital objects, which achieves multigrid convergence in 
                           
                              O
                              (
                              
                                 
                                    h
                                 
                                 
                                    
                                       
                                          1
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              )
                           
                        .

This paper completes [10] to propose a new curvature tensor estimator for digital data, which casts carefully the Integral Invariant (II) method of [39,38] into the digital world. This estimator is a non-trivial extension of our mean digital curvature estimator [10], since it involves the computation of digital moments and covariance matrices, and requires results from matrix perturbation theory.

The contributions of the paper can be sketched as follows. First, we define digital versions of integral invariant estimators with multigrid convergence results (Theorems 3 and 4). We provide an explicit formula for the kernel size, which guarantees uniform convergence in 
                           
                              O
                              (
                              
                                 
                                    h
                                 
                                 
                                    
                                       
                                          1
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              )
                           
                         for smooth enough curves and surfaces (Theorem 6). Furthermore, we demonstrate that these estimators have simple, exact and efficient implementations (available in DGtal library [46]). We provide an extensive comparative evaluation of these estimators (mean curvature, principal curvatures), which shows that they compete with classical ones in terms of accuracy (Section 4). Computation speed is also considered, and our method is for instance ten times faster than the osculating jets. Finally, we show empirical results illustrating the robustness to noise and outliers of our estimators.

Since we are interested in evaluating both theoretically and experimentally the behavior of a given differential estimator on digital object boundaries, we first have to formalize links between Euclidean objects and digital ones with the help of a digitization process. Let us consider a family 
                           
                              X
                           
                         of smooth and compact subsets of 
                           
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                           
                        . In Section 2.3 we will be more precise on the notion of smoothness for shapes 
                           
                              X
                              ∈
                              X
                           
                        . We denote 
                           
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              (
                              X
                              )
                           
                         the digitization of 
                           
                              X
                           
                         in a 
                           
                              d
                           
                        -dimensional grid of grid step h. More precisely, we consider classical Gauss digitization defined as
                           
                              (1)
                              
                                 
                                    
                                       D
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 X
                                 )
                                 
                                 
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                h
                                             
                                          
                                          ·
                                          X
                                       
                                    
                                 
                                 ∩
                                 
                                    
                                       Z
                                    
                                    
                                       d
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    1
                                 
                                 
                                    h
                                 
                              
                              ·
                              X
                           
                         is the uniform scaling of 
                           
                              X
                           
                         by factor 
                           
                              
                                 
                                    1
                                 
                                 
                                    h
                                 
                              
                           
                        . Furthermore, the set 
                           
                              ∂
                              X
                           
                         denotes the frontier of 
                           
                              X
                           
                         (i.e. its topological boundary). If 
                           
                              z
                              ∈
                              
                                 
                                    Z
                                 
                                 
                                    d
                                 
                              
                           
                        , then 
                           
                              
                                 
                                    Q
                                 
                                 
                                    z
                                 
                              
                           
                         denotes the unit d-dimensional cube of 
                           
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                           
                         centered on z. The h-frontier 
                        
                           
                              
                                 
                                    Δ
                                 
                                 
                                    h
                                 
                              
                              Z
                           
                         
                        of a digital set 
                        
                           
                              Z
                              ⊂
                              
                                 
                                    Z
                                 
                                 
                                    d
                                 
                              
                           
                         is defined as 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    h
                                 
                              
                              Z
                              
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              
                              ∂
                              (
                              h
                              ·
                              
                                 
                                    ∪
                                 
                                 
                                    z
                                    ∈
                                    Z
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    z
                                 
                              
                              )
                           
                        . Therefore, the h-frontier of 
                           
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              (
                              X
                              )
                           
                         is a 
                           
                              (
                              d
                              -
                              1
                              )
                           
                        -dimensional subset of 
                           
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                           
                        , which is close to 
                           
                              ∂
                              X
                           
                        . We will precise the term “close” later in this section. Since this paper deals with multigrid convergence, digital shapes will always come from the digitization of continuous ones. To simplify notations, the h-frontier of the Gauss digitization at step h of a shape X will simply be denoted by 
                           
                              
                                 
                                    ∂
                                 
                                 
                                    h
                                 
                              
                              X
                              
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              
                              
                                 
                                    Δ
                                 
                                 
                                    h
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              (
                              X
                              )
                           
                        , and called later on h-boundary of X.

As discussed in various previous works (see for instance [11] for a survey), the idea of multigrid convergence is that when we define a quantity estimator on 
                           
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              (
                              X
                              )
                           
                        , we check if the estimated quantity converges (theoretically and/or experimentally) to the associated one on 
                           
                              X
                           
                         when h tends to zero. More formally,
                           Definition 1
                           Multigrid convergence for local geometric quantities

A local discrete geometric estimator 
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ^
                                       
                                    
                                 
                               of some geometric quantity E is multigrid convergent for the family 
                                 
                                    X
                                 
                               if and only if, for any 
                                 
                                    X
                                    ∈
                                    X
                                 
                              , there exists a grid step 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          X
                                       
                                    
                                    >
                                    0
                                 
                               such that the estimate 
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ^
                                       
                                    
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    X
                                    )
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    h
                                    )
                                 
                               is defined for all 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                    ∈
                                    
                                       
                                          ∂
                                       
                                       
                                          h
                                       
                                    
                                    X
                                 
                               with 
                                 
                                    0
                                    <
                                    h
                                    <
                                    
                                       
                                          h
                                       
                                       
                                          X
                                       
                                    
                                 
                              , and for any 
                                 
                                    x
                                    ∈
                                    ∂
                                    X
                                 
                              ,
                                 
                                    (2)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   ∀
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         ∂
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   X
                                                   
                                                   with
                                                   
                                                   ∥
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   -
                                                   x
                                                   
                                                      
                                                         ∥
                                                      
                                                      
                                                         ∞
                                                      
                                                   
                                                   ⩽
                                                   h
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  E
                                                               
                                                               
                                                                  ^
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           D
                                                                        
                                                                        
                                                                           h
                                                                        
                                                                     
                                                                     (
                                                                     X
                                                                     )
                                                                     ,
                                                                     
                                                                        
                                                                           x
                                                                        
                                                                        
                                                                           ˆ
                                                                        
                                                                     
                                                                     ,
                                                                     h
                                                                  
                                                               
                                                            
                                                            -
                                                            E
                                                            (
                                                            X
                                                            ,
                                                            x
                                                            )
                                                         
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         X
                                                         ,
                                                         x
                                                      
                                                   
                                                   (
                                                   h
                                                   )
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              where 
                                 
                                    
                                       
                                          τ
                                       
                                       
                                          X
                                          ,
                                          x
                                       
                                    
                                    :
                                    
                                       
                                          R
                                       
                                       
                                          +
                                       
                                    
                                    ⧹
                                    {
                                    0
                                    }
                                    →
                                    
                                       
                                          R
                                       
                                       
                                          +
                                       
                                    
                                 
                               has null limit at 0. This function defines the speed of convergence of 
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ^
                                       
                                    
                                 
                               toward E at point x of 
                                 
                                    X
                                 
                              . The convergence is uniform for X when every 
                                 
                                    
                                       
                                          τ
                                       
                                       
                                          X
                                          ,
                                          x
                                       
                                    
                                 
                               is bounded from above by a function 
                                 
                                    
                                       
                                          τ
                                       
                                       
                                          X
                                       
                                    
                                 
                               independent of 
                                 
                                    x
                                    ∈
                                    ∂
                                    X
                                 
                               with null limit at 0.

When a geometrical quantity is global (e.g. area or volume), we do not need an explicit mapping between 
                           
                              ∂
                              X
                           
                         and 
                           
                              
                                 
                                    ∂
                                 
                                 
                                    h
                                 
                              
                              X
                           
                        , and Definition 1 can be rephrased to define multigrid convergence of global geometric quantities 
                        [11]. A local discrete estimator however estimates a geometric quantity at points on the h-frontier of a digital set, otherwise said at any point on the interpixel representation of the digital set boundary. This definition encompasses usual definitions where input points are pointels, linels or surfels.

In some proofs, a more precise mapping between points 
                           
                              x
                              ∈
                              ∂
                              X
                           
                         and 
                           
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                              ∈
                              
                                 
                                    ∂
                                 
                                 
                                    h
                                 
                              
                              X
                           
                         is required. For any shape 
                           
                              X
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                           
                        , the medial axis 
                        
                           
                              MA
                              (
                              ∂
                              X
                              )
                           
                         of 
                           
                              ∂
                              X
                           
                         is the subset of 
                           
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                           
                         whose points have more than one closest point to 
                           
                              ∂
                              X
                           
                        . The reach reach(X) of X is the infimum of the distance between 
                           
                              ∂
                              X
                           
                         and its medial axis. Shapes with positive reach have principal curvatures bounded by 
                           
                              ±
                              1
                              /
                              reach
                              (
                              X
                              )
                           
                        . The (orthogonal) projection 
                        
                           
                              
                                 
                                    π
                                 
                                 
                                    X
                                 
                              
                           
                         is the mapping from 
                           
                              X
                              ⧹
                              MA
                              (
                              ∂
                              X
                              )
                           
                         onto 
                           
                              ∂
                              X
                           
                         that associates to each point its closest point in 
                           
                              ∂
                              X
                           
                         (cf. Fig. 1
                        (b)).

This projection can be restricted to domain 
                           
                              
                                 
                                    ∂
                                 
                                 
                                    h
                                 
                              
                              X
                           
                         in order to define a mapping 
                           
                              
                                 
                                    π
                                 
                                 
                                    h
                                 
                                 
                                    X
                                 
                              
                           
                         from the h-frontier 
                           
                              
                                 
                                    ∂
                                 
                                 
                                    h
                                 
                              
                              X
                           
                         to the boundary 
                           
                              ∂
                              X
                           
                        . This mapping was called back-projection in [29]. For any 2D shape X with positive reach, for 
                           
                              0
                              <
                              h
                              ⩽
                              reach
                              (
                              X
                              )
                           
                        , Lemma B.9 [29] indicates that the map 
                           
                              
                                 
                                    π
                                 
                                 
                                    h
                                 
                                 
                                    X
                                 
                              
                           
                         is well-defined and onto. It shows that the Hausdorff distance of boundaries 
                           
                              
                                 
                                    ∂
                                 
                                 
                                    h
                                 
                              
                              X
                           
                         and 
                           
                              ∂
                              X
                           
                         is no greater than 
                           
                              
                                 
                                    
                                       
                                          2
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              h
                           
                        , hence they get closer and closer as the grid step is refined.

In d dimensions, it is possible to show
                           1
                           The proof follows the same lines as Lemma B.9 [29].
                        
                        
                           1
                         that their Hausdorff distance is no greater than 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              h
                           
                        . Furthermore, it is a known fact that 
                           
                              
                                 
                                    π
                                 
                                 
                                    X
                                 
                              
                           
                         is continuous over 
                           
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                              ⧹
                              MA
                              (
                              ∂
                              X
                              )
                           
                        , hence over 
                           
                              
                                 
                                    ∂
                                 
                                 
                                    h
                                 
                              
                              X
                           
                         with an adequate h.

In geometry processing, integral invariants have been widely investigated to define estimators of differential quantities (see [39,38] for a complete overview). For short, the main idea is to move a kernel on points 
                           
                              x
                              ∈
                              ∂
                              X
                           
                         and to compute integrals on the intersection between 
                           
                              X
                           
                         and the kernel. Even though different kernels (e.g. Euclidean ball, Euclidean sphere) and different integration functions can be considered, we focus here on volumetric integral invariants defined as follows:
                           Definition 2
                           Given 
                                 
                                    X
                                    ∈
                                    X
                                 
                               and a radius 
                                 
                                    R
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          +
                                          ∗
                                       
                                    
                                 
                              , the volumetric integral 
                                 
                                    
                                       
                                          V
                                       
                                       
                                          R
                                       
                                    
                                    (
                                    x
                                    )
                                 
                               at 
                                 
                                    x
                                    ∈
                                    ∂
                                    X
                                 
                               is given by (see Fig. 1(a))
                                 
                                    (3)
                                    
                                       
                                          
                                             V
                                          
                                          
                                             R
                                          
                                       
                                       (
                                       x
                                       )
                                       
                                       
                                          
                                             
                                                =
                                             
                                             
                                                def
                                             
                                          
                                       
                                       
                                       
                                          ∫
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   R
                                                
                                             
                                             (
                                             x
                                             )
                                          
                                       
                                       χ
                                       (
                                       p
                                       )
                                       dp
                                       ,
                                    
                                 
                              where 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          R
                                       
                                    
                                    (
                                    x
                                    )
                                 
                               is the Euclidean ball with radius R and center x and 
                                 
                                    χ
                                    (
                                    p
                                    )
                                 
                               the characteristic function of 
                                 
                                    X
                                 
                              . In dimension 2, we simply denote 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          R
                                       
                                    
                                    (
                                    x
                                    )
                                 
                               such quantity.

Several authors have detailed connections between 
                           
                              
                                 
                                    V
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              )
                           
                         and curvature (resp. mean curvature) at x for shapes in 
                           
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                         (resp. 
                           
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                           
                        ) [7,39,38].

If 
                           
                              κ
                              (
                              X
                              ,
                              x
                              )
                           
                         is the curvature of 
                           
                              ∂
                              X
                           
                         at x and 
                           
                              H
                              (
                              X
                              ,
                              x
                              )
                           
                         is the mean curvature of 
                           
                              ∂
                              X
                           
                         at x, we have:
                           Lemma 1
                           
                              [38]
                           


                           
                              For a sufficiently smooth shape 
                              
                                 
                                    X
                                 
                               
                              in 
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                    x
                                    ∈
                                    ∂
                                    X
                                 
                              
                              , we have
                              
                                 
                                    (4)
                                    
                                       
                                          
                                             A
                                          
                                          
                                             R
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       
                                          
                                             π
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                       -
                                       
                                          
                                             κ
                                             (
                                             X
                                             ,
                                             x
                                             )
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       O
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             4
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           


                              For a sufficiently smooth shape 
                              
                                 
                                    X
                                 
                               
                              in 
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    x
                                    ∈
                                    ∂
                                    X
                                 
                              
                              , we have
                              
                                 
                                    (5)
                                    
                                       
                                          
                                             V
                                          
                                          
                                             R
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       
                                          
                                             2
                                             π
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             3
                                          
                                       
                                       -
                                       
                                          
                                             π
                                             H
                                             (
                                             X
                                             ,
                                             x
                                             )
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             4
                                          
                                       
                                       +
                                       O
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             5
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           

Such results are obtained by Taylor expansion at x of the surface 
                           
                              ∂
                              X
                           
                         approximated by a parametric function 
                           
                              y
                              =
                              f
                              (
                              x
                              )
                           
                         in 2D and 
                           
                              z
                              =
                              f
                              (
                              x
                              ,
                              y
                              )
                           
                         in 3D. From Eqs. (4) and (5) and with a fixed radius R, one can derive local estimators 
                           
                              
                                 
                                    
                                       
                                          κ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    R
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          H
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    R
                                 
                              
                           
                         respectively:
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             κ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       R
                                    
                                 
                                 (
                                 X
                                 ,
                                 x
                                 )
                                 
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 
                                 
                                    
                                       3
                                       π
                                    
                                    
                                       2
                                       R
                                    
                                 
                                 -
                                 
                                    
                                       3
                                       
                                          
                                             A
                                          
                                          
                                             R
                                          
                                       
                                       (
                                       x
                                       )
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       R
                                    
                                 
                                 (
                                 X
                                 ,
                                 x
                                 )
                                 
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 
                                 
                                    
                                       8
                                    
                                    
                                       3
                                       R
                                    
                                 
                                 -
                                 
                                    
                                       4
                                       
                                          
                                             V
                                          
                                          
                                             R
                                          
                                       
                                       (
                                       x
                                       )
                                    
                                    
                                       π
                                       
                                          
                                             R
                                          
                                          
                                             4
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

In this way, when R tends to zero, both estimated values will converge to expected ones (respectively 
                           
                              κ
                           
                         and H). More formally:
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             κ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       R
                                    
                                 
                                 (
                                 X
                                 ,
                                 x
                                 )
                                 =
                                 κ
                                 (
                                 X
                                 ,
                                 x
                                 )
                                 +
                                 O
                                 (
                                 R
                                 )
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       R
                                    
                                 
                                 (
                                 X
                                 ,
                                 x
                                 )
                                 =
                                 H
                                 (
                                 X
                                 ,
                                 x
                                 )
                                 +
                                 O
                                 (
                                 R
                                 )
                                 .
                              
                           
                        
                     

Similarly, directional information such as principal curvatures and thus Gaussian curvature can be retrieved from integral computations. Indeed, instead of computing the measure of 
                           
                              
                                 
                                    B
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              )
                              ∩
                              X
                           
                         as in Definition 2, we consider its covariance matrix. Given a non-empty subset 
                           
                              Y
                              ⊂
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                           
                        , the covariance matrix of Y is given by
                           
                              (8)
                              
                                 J
                                 (
                                 Y
                                 )
                                 
                                 
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                 
                                 
                                 
                                    ∫
                                    
                                       Y
                                    
                                 
                                 (
                                 p
                                 -
                                 
                                    
                                       Y
                                    
                                    
                                       ‾
                                    
                                 
                                 )
                                 
                                    
                                       (
                                       p
                                       -
                                       
                                          
                                             Y
                                          
                                          
                                             ‾
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 dp
                                 =
                                 
                                    ∫
                                    
                                       Y
                                    
                                 
                                 
                                    
                                       pp
                                    
                                    
                                       T
                                    
                                 
                                 dp
                                 -
                                 Vol
                                 (
                                 Y
                                 )
                                 
                                    
                                       Y
                                    
                                    
                                       ‾
                                    
                                 
                                 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    Y
                                 
                                 
                                    ‾
                                 
                              
                           
                         is the centroid of Y and 
                           
                              Vol
                              (
                              Y
                              )
                           
                         its volume. For non-negative integers 
                           
                              p
                              ,
                              
                              q
                           
                         and s, we recall the definition of 
                           
                              (
                              p
                              ,
                              q
                              ,
                              s
                              )
                           
                        
                        -moments 
                        
                           
                              
                                 
                                    m
                                 
                                 
                                    p
                                    ,
                                    q
                                    ,
                                    s
                                 
                              
                              (
                              Y
                              )
                           
                         of Y:
                           
                              (9)
                              
                                 
                                    
                                       m
                                    
                                    
                                       p
                                       ,
                                       q
                                       ,
                                       s
                                    
                                 
                                 (
                                 Y
                                 )
                                 
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 
                                 
                                    
                                       ∭
                                    
                                    
                                       Y
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       s
                                    
                                 
                                 dxdydz
                                 .
                              
                           
                        
                     

Note that the volume 
                           
                              Vol
                              (
                              Y
                              )
                           
                         is the 0-moment 
                           
                              
                                 
                                    m
                                 
                                 
                                    0
                                    ,
                                    0
                                    ,
                                    0
                                 
                              
                              (
                              Y
                              )
                           
                        , and that the centroid 
                           
                              
                                 
                                    Y
                                 
                                 
                                    ‾
                                 
                              
                           
                         is the vector of 1-moments normalized by the 0-moment, i.e. 
                           
                              
                                 
                                    (
                                    
                                       
                                          m
                                       
                                       
                                          1
                                          ,
                                          0
                                          ,
                                          0
                                       
                                    
                                    (
                                    Y
                                    )
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          0
                                          ,
                                          1
                                          ,
                                          0
                                       
                                    
                                    (
                                    Y
                                    )
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          0
                                          ,
                                          0
                                          ,
                                          1
                                       
                                    
                                    (
                                    Y
                                    )
                                    )
                                 
                                 
                                    T
                                 
                              
                              /
                              
                                 
                                    m
                                 
                                 
                                    0
                                    ,
                                    0
                                    ,
                                    0
                                 
                              
                              (
                              Y
                              )
                           
                        . For simplicity, let us denote by A the Euclidean set 
                           
                              
                                 
                                    B
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              )
                              ∩
                              X
                           
                        . The covariance matrix of A is then rewritten as
                           2
                           
                              
                                 
                                    ⊗
                                 
                               denotes the usual tensor product in vector spaces.
                        
                        
                           2
                        :
                           
                              (10)
                              
                                 J
                                 (
                                 A
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         2
                                                         ,
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   A
                                                   )
                                                
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                         ,
                                                         1
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   A
                                                   )
                                                
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                         ,
                                                         0
                                                         ,
                                                         1
                                                      
                                                   
                                                   (
                                                   A
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                         ,
                                                         1
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   A
                                                   )
                                                
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         0
                                                         ,
                                                         2
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   A
                                                   )
                                                
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         0
                                                         ,
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                   (
                                                   A
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                         ,
                                                         0
                                                         ,
                                                         1
                                                      
                                                   
                                                   (
                                                   A
                                                   )
                                                
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         0
                                                         ,
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                   (
                                                   A
                                                   )
                                                
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         0
                                                         ,
                                                         0
                                                         ,
                                                         2
                                                      
                                                   
                                                   (
                                                   A
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             0
                                             ,
                                             0
                                             ,
                                             0
                                          
                                       
                                       (
                                       A
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                         ,
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   A
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         0
                                                         ,
                                                         1
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   A
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         0
                                                         ,
                                                         0
                                                         ,
                                                         1
                                                      
                                                   
                                                   (
                                                   A
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 ⊗
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            1
                                                            ,
                                                            0
                                                            ,
                                                            0
                                                         
                                                      
                                                      (
                                                      A
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            0
                                                            ,
                                                            1
                                                            ,
                                                            0
                                                         
                                                      
                                                      (
                                                      A
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            0
                                                            ,
                                                            0
                                                            ,
                                                            1
                                                         
                                                      
                                                      (
                                                      A
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 .
                              
                           
                        
                     

In [39], the authors have demonstrated that eigenvalues and eigenvectors of 
                           
                              J
                              (
                              A
                              )
                           
                         provide principal curvature and principal direction information:
                           Lemma 2
                           
                              [39, Theorem 2]
                           


                           
                              Given a shape 
                              
                                 
                                    X
                                    ∈
                                    X
                                 
                              
                              , the eigenvalues 
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                 
                               
                              of 
                              
                                 
                                    J
                                    (
                                    A
                                    )
                                 
                              
                              , where 
                              
                                 
                                    A
                                    =
                                    
                                       
                                          B
                                       
                                       
                                          R
                                       
                                    
                                    (
                                    x
                                    )
                                    ∩
                                    X
                                 
                               
                              and 
                              
                                 
                                    x
                                    ∈
                                    ∂
                                    X
                                 
                              
                              , have the following Taylor expansion:
                              
                                 
                                    (11)
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             2
                                             π
                                          
                                          
                                             15
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             5
                                          
                                       
                                       -
                                       
                                          
                                             π
                                          
                                          
                                             48
                                          
                                       
                                       
                                          
                                             
                                                3
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                X
                                                ,
                                                x
                                                )
                                                +
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                X
                                                ,
                                                x
                                                )
                                             
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             6
                                          
                                       
                                       +
                                       O
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             7
                                          
                                       
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    (12)
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             2
                                             π
                                          
                                          
                                             15
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             5
                                          
                                       
                                       -
                                       
                                          
                                             π
                                          
                                          
                                             48
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                X
                                                ,
                                                x
                                                )
                                                +
                                                3
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                X
                                                ,
                                                x
                                                )
                                             
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             6
                                          
                                       
                                       +
                                       O
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             7
                                          
                                       
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    (13)
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       
                                          
                                             19
                                             π
                                          
                                          
                                             480
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             5
                                          
                                       
                                       -
                                       
                                          
                                             9
                                             π
                                          
                                          
                                             512
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                X
                                                ,
                                                x
                                                )
                                                +
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                X
                                                ,
                                                x
                                                )
                                             
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             6
                                          
                                       
                                       +
                                       O
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             7
                                          
                                       
                                       )
                                       ,
                                    
                                 
                              
                              where 
                              
                                 
                                    
                                       
                                          κ
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    X
                                    ,
                                    x
                                    )
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          κ
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    X
                                    ,
                                    x
                                    )
                                 
                               
                              denotes the principal curvatures of 
                              
                                 
                                    ∂
                                    X
                                 
                               
                              at x.
                              
                                 3
                                 There is a typographic error in 
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                       
                                     in the paper [39].
                              
                              
                                 3
                              
                           

Hence, similarly to Eq. (6), one can define local estimators 
                           
                              
                                 
                                    
                                       
                                          κ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    R
                                 
                                 
                                    1
                                 
                              
                           
                        , 
                           
                              
                                 
                                    
                                       
                                          κ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                         and finally the Gaussian curvature 
                           
                              
                                 
                                    
                                       
                                          K
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    R
                                 
                              
                              
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              
                              
                                 
                                    
                                       
                                          κ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    R
                                 
                                 
                                    1
                                 
                              
                              ·
                              
                                 
                                    
                                       
                                          κ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                         as functions of 
                           
                              
                                 
                                    {
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    1
                                    ,
                                    2
                                    ,
                                    3
                                 
                              
                           
                         and R. From Lemma 2, all these estimators converge in the continuous setting when R tends to 0.

When dealing with digital shapes 
                           
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              (
                              X
                              )
                           
                        , implementation of these estimators becomes straightforward: choose a radius R, center a Euclidean (or digital) ball at chosen points of 
                           
                              
                                 
                                    ∂
                                 
                                 
                                    h
                                 
                              
                              X
                           
                         (e.g. centroids of linels or surfels), compute the quantities (area, volume, covariance matrix) and finally estimate curvature information 
                           
                              
                                 
                                    κ
                                 
                                 
                                    ̃
                                 
                              
                              ,
                              
                              
                                 
                                    H
                                 
                                 
                                    ∼
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          κ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                           
                        , 
                           
                              
                                 
                                    
                                       
                                          κ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                           
                         or 
                           
                              
                                 
                                    K
                                 
                                 
                                    ∼
                                 
                              
                           
                        . However, several issues are hidden in this approach: What are meaningful values for R according to the shape size and geometry? Do points of 
                           
                              
                                 
                                    ∂
                                 
                                 
                                    h
                                 
                              
                              X
                           
                         converge to points 
                           
                              x
                              ∈
                              ∂
                              X
                           
                         for which Lemmas 1 and 2 are valid? Does counting the number of pixels (resp. voxels) converge to 
                           
                              
                                 
                                    A
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              )
                           
                         (resp. 
                           
                              
                                 
                                    V
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              )
                           
                        )? Does the digital covariance matrix converge to the expected one? The rest of the paper addresses all these questions.

In [10], we have demonstrated that digital versions of estimators defined in Eq. (6) lead to efficient and multigrid convergent estimators for digitizations of smooth 2D shapes. In this section, we briefly describe the overall structure of this proof since similar arguments will be used in Section 3 to demonstrate that our digital principal curvature estimators do converge uniformly.

First, we used existing results on digital area or volume estimation by counting grid points. Hence, for 2D shapes 
                           
                              X
                              ∈
                              X
                           
                         and 3D shapes 
                           
                              
                                 
                                    X
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              X
                           
                        , we have
                           
                              (14)
                              
                                 
                                    
                                       Area
                                    
                                    
                                       ^
                                    
                                 
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 X
                                 )
                                 ,
                                 h
                                 )
                                 
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 
                                 
                                    
                                       h
                                    
                                    
                                       2
                                    
                                 
                                 Card
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 X
                                 )
                                 )
                                 =
                                 Area
                                 (
                                 X
                                 )
                                 +
                                 O
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       β
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       Vol
                                    
                                    
                                       ^
                                    
                                 
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ,
                                 h
                                 )
                                 
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 
                                 
                                    
                                       h
                                    
                                    
                                       3
                                    
                                 
                                 Card
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 )
                                 =
                                 Vol
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 +
                                 O
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       γ
                                    
                                 
                                 )
                                 ,
                              
                           
                        for 
                           
                              β
                              =
                              γ
                              =
                              1
                           
                         in the general case and 
                           
                              β
                              =
                              γ
                              >
                              1
                           
                         with further constraints on 
                           
                              X
                           
                         (e.g. 
                        
                           
                              
                                 
                                    C
                                 
                                 
                                    3
                                 
                              
                           
                         with non-zero curvature) [27,21,26].

Then, we focused on the convergence of the area estimation on Euclidean shapes defined by 
                           
                              
                                 
                                    B
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              )
                              ∩
                              X
                           
                         at 
                           
                              x
                              ∈
                              ∂
                              X
                           
                         in dimension 2. We defined a digital curvature estimator 
                           
                              
                                 
                                    
                                       
                                          κ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    R
                                 
                              
                              (
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              (
                              X
                              )
                              ,
                              x
                              ,
                              h
                              )
                           
                         by applying the area estimation by counting on 
                           
                              
                                 
                                    B
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              )
                              ∩
                              X
                           
                         and Eq. (6), see [10, Eq. (11)]. We first demonstrated that 
                           
                              
                                 
                                    
                                       
                                          κ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    R
                                 
                              
                              (
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              (
                              X
                              )
                              ,
                              x
                              ,
                              h
                              )
                           
                         converges to 
                           
                              κ
                              (
                              X
                              ,
                              x
                              )
                           
                         (note that curvatures are evaluated at the same point 
                        
                           
                              x
                              ∈
                              ∂
                              X
                           
                        ):
                           Theorem 1
                           Convergence of 
                                 
                                    
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          R
                                       
                                    
                                 
                               along 
                                 
                                    ∂
                                    X
                                 
                              , [10]
                           


                           
                              Let X be some convex shape of 
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              , with at least 
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              -boundary and bounded curvature. Then there exists positive constants 
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          1
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          K
                                       
                                       
                                          2
                                       
                                    
                                 
                               
                              such that
                              
                                 
                                    (15)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   ∀
                                                   h
                                                   <
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   R
                                                   =
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   x
                                                   ∈
                                                   ∂
                                                   X
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        κ
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                            (
                                                            X
                                                            )
                                                            ,
                                                            x
                                                            ,
                                                            h
                                                            )
                                                            -
                                                            κ
                                                            (
                                                            X
                                                            ,
                                                            x
                                                            )
                                                         
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         Kh
                                                      
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              where 
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          m
                                       
                                    
                                    =
                                    
                                       
                                          β
                                       
                                       
                                          2
                                          +
                                          β
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          k
                                       
                                       
                                          m
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          (
                                          1
                                          +
                                          β
                                          )
                                          
                                             
                                                K
                                             
                                             
                                                1
                                             
                                          
                                          /
                                          
                                             
                                                K
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                1
                                             
                                             
                                                2
                                                +
                                                β
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    K
                                    =
                                    
                                       
                                          K
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          m
                                       
                                    
                                    +
                                    3
                                    
                                       
                                          K
                                       
                                       
                                          1
                                       
                                    
                                    /
                                    
                                       
                                          k
                                       
                                       
                                          m
                                       
                                       
                                          1
                                          +
                                          β
                                       
                                    
                                 
                              
                              , with 
                              
                                 
                                    β
                                 
                               
                              as above. In the general case, 
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          m
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              .
                           

Then, we showed that moving the digital estimation from 
                           
                              x
                              ∈
                              ∂
                              X
                           
                         to 
                           
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                              ∈
                              
                                 
                                    ∂
                                 
                                 
                                    h
                                 
                              
                              X
                           
                         does not change the convergence results:
                           Theorem 2
                           Uniform convergence 
                                 
                                    
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          R
                                       
                                    
                                 
                               along 
                                 
                                    
                                       
                                          ∂
                                       
                                       
                                          h
                                       
                                    
                                    X
                                 
                              , [10]
                           


                           
                              Let X be some convex shape of 
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              , with at least 
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              -boundary and bounded curvature. Then, there exists positive constants 
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          0
                                       
                                    
                                 
                               
                              and k, for any 
                              
                                 
                                    h
                                    ⩽
                                    
                                       
                                          h
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              , setting 
                              
                                 
                                    R
                                    =
                                    
                                       
                                          kh
                                       
                                       
                                          
                                             
                                                1
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                              
                              , we have
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                                
                                                   ∀
                                                   x
                                                   ∈
                                                   ∂
                                                   X
                                                   ,
                                                   
                                                   ∀
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         ∂
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   X
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   ∥
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   -
                                                   x
                                                   
                                                      
                                                         ∥
                                                      
                                                      
                                                         ∞
                                                      
                                                   
                                                   ⩽
                                                   h
                                                   
                                                   ⇒
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        κ
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                            (
                                                            X
                                                            )
                                                            ,
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                            ,
                                                            h
                                                            )
                                                            -
                                                            κ
                                                            (
                                                            X
                                                            ,
                                                            x
                                                            )
                                                         
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         Kh
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

In [10], we also presented similar results and convergence speed for mean curvature estimation in 3D from digital volume estimation.

To demonstrate that principal curvature estimators can be defined from digital version of integral invariants, we use exactly the same process:
                           
                              1.
                              We first demonstrate that digital estimations of covariance matrix are multigrid convergent (Sections 3.1 and 3.2).

Then, we give explicit error bounds on both the geometrical moments and the covariance matrix when we change the reference point from 
                                    
                                       x
                                       ∈
                                       ∂
                                       X
                                    
                                  to 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                       ∈
                                       
                                          
                                             ∂
                                          
                                          
                                             h
                                          
                                       
                                       X
                                    
                                  (Sections 3.3 and 3.4).

Finally, we gather all these results to demonstrate that principal curvature estimators are uniformly multigrid convergent for all 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                       ∈
                                       
                                          
                                             ∂
                                          
                                          
                                             h
                                          
                                       
                                       X
                                    
                                  (Section 3.5).

In this section, we derive digital principal curvature and principal direction estimators by digital approximation of local covariance matrices. Convergence results rely on the fact that digital moments converge in the same manner as volumes [26]. In the whole section, the considered family of shapes 
                        
                           X
                        
                      is composed of compact subsets of 
                        
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        
                      with positive reach, the boundary of which is 
                        
                           
                              
                                 C
                              
                              
                                 3
                              
                           
                        
                      and can be decomposed into a finite number of monotonous (convex/concave) pieces. Compactness is required so that the boundary belongs to the shape. 
                        
                           
                              
                                 C
                              
                              
                                 3
                              
                           
                        
                     -smoothness is required in the truncated Taylor expansion of Pottmann et al. [39,38] relating covariance matrix and curvatures. Positive reach guarantees that two pieces of boundaries are not too close to each other, and this fact is also required in the previous truncated Taylor expansion (although this is not stated in their paper). The finite decomposition into monotonous pieces induces that integrals as limits of sums converge at speed at least 
                        
                           O
                           (
                           h
                           )
                        
                     .

Following the same principles as the area and volume estimators by counting, we define the digital 
                        
                           
                              (
                              p
                              ,
                              q
                              ,
                              s
                              )
                           
                        
                        -moments 
                        
                           
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    p
                                    ,
                                    q
                                    ,
                                    s
                                 
                              
                              (
                              Z
                              ,
                              h
                              )
                           
                         of a subset Z of 
                           
                              
                                 
                                    Z
                                 
                                 
                                    3
                                 
                              
                           
                         at step h as
                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       p
                                       ,
                                       q
                                       ,
                                       s
                                    
                                 
                                 (
                                 Z
                                 ,
                                 h
                                 )
                                 
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 
                                 
                                    
                                       h
                                    
                                    
                                       3
                                       +
                                       p
                                       +
                                       q
                                       +
                                       s
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       p
                                       ,
                                       q
                                       ,
                                       s
                                    
                                 
                                 (
                                 Z
                                 )
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    M
                                 
                                 
                                    p
                                    ,
                                    q
                                    ,
                                    s
                                 
                              
                              (
                              Z
                              )
                              
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              
                              
                                 
                                    ∑
                                 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    ,
                                    k
                                    )
                                    ∈
                                    Z
                                 
                              
                              
                                 
                                    i
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    j
                                 
                                 
                                    q
                                 
                              
                              
                                 
                                    k
                                 
                                 
                                    s
                                 
                              
                           
                        . To shorten expressions, we denote by 
                           
                              σ
                           
                         the sum 
                           
                              p
                              +
                              q
                              +
                              s
                           
                        , which will always be an integer in 
                           
                              {
                              0
                              ,
                              1
                              ,
                              2
                              }
                           
                        .

There exist multigrid convergent results for digital moments that are similar to the multigrid convergence of the area and the volume estimator (see Eq. (14)). Since their speed of convergence depends on the order 
                           
                              σ
                           
                         of the moment, we may thus write for some constant 
                           
                              
                                 
                                    μ
                                 
                                 
                                    σ
                                 
                              
                              ⩾
                              1
                           
                         
                        [26]:
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       p
                                       ,
                                       q
                                       ,
                                       s
                                    
                                 
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 Y
                                 )
                                 ,
                                 h
                                 )
                                 =
                                 
                                    
                                       m
                                    
                                    
                                       p
                                       ,
                                       q
                                       ,
                                       s
                                    
                                 
                                 (
                                 Y
                                 )
                                 +
                                 O
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             σ
                                          
                                       
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

The involved constants 
                           
                              
                                 
                                    μ
                                 
                                 
                                    i
                                 
                              
                           
                         are at least 1 in the general case, and some authors have established better bounds in places where the Gaussian curvature does not vanish (e.g. see [28] where 
                           
                              
                                 
                                    μ
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    38
                                 
                                 
                                    25
                                 
                              
                              -
                              ∊
                           
                        , or [36], Theorem 1, where 
                           
                              
                                 
                                    μ
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    66
                                 
                                 
                                    43
                                 
                              
                              -
                              ∊
                           
                        ).

We wish to apply this formula to the set 
                           
                              A
                              =
                              
                                 
                                    B
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              )
                              ∩
                              X
                           
                        , whose size decreases with h. Big “O” notation in Eq. (17) hides the fact that the involved constant depends on the shape size, scale and maximal curvature. Hence, we need to normalize our moment estimation so that the error is no more influenced by the scale:
                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       p
                                       ,
                                       q
                                       ,
                                       s
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                h
                                             
                                          
                                          (
                                          A
                                          )
                                          ,
                                          h
                                       
                                    
                                 
                                 =
                                 
                                    
                                       h
                                    
                                    
                                       3
                                       +
                                       σ
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       p
                                       ,
                                       q
                                       ,
                                       s
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   ·
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                   ∩
                                                   X
                                                
                                             
                                          
                                          ∩
                                          
                                             
                                                Z
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       h
                                    
                                    
                                       3
                                       +
                                       σ
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       p
                                       ,
                                       q
                                       ,
                                       s
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                h
                                             
                                          
                                          ·
                                          
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                            ·
                                                            x
                                                         
                                                      
                                                   
                                                   ∩
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   ·
                                                   X
                                                
                                             
                                          
                                          ∩
                                          
                                             
                                                Z
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       3
                                       +
                                       σ
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   R
                                                
                                             
                                          
                                       
                                    
                                    
                                       3
                                       +
                                       σ
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       p
                                       ,
                                       q
                                       ,
                                       s
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                h
                                                /
                                                R
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                            ·
                                                            x
                                                         
                                                      
                                                   
                                                   ∩
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   ·
                                                   X
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       3
                                       +
                                       σ
                                    
                                 
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       p
                                       ,
                                       q
                                       ,
                                       s
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                h
                                                /
                                                R
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                            ·
                                                            x
                                                         
                                                      
                                                   
                                                   ∩
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   ·
                                                   X
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                h
                                             
                                             
                                                R
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

The shape 
                           
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             R
                                          
                                       
                                       ·
                                       x
                                    
                                 
                              
                              ∩
                              
                                 
                                    1
                                 
                                 
                                    R
                                 
                              
                              ·
                              X
                           
                         tends toward a half-ball of radius 1 as R decreases. Therefore, we may apply Eq. (17) on Eq. (18) and consider that the involved constant does not depend on R or h. Note that we use below the obvious relation 
                           
                              
                                 
                                    m
                                 
                                 
                                    p
                                    ,
                                    q
                                    ,
                                    s
                                 
                              
                              (
                              R
                              ·
                              Y
                              )
                              =
                              
                                 
                                    R
                                 
                                 
                                    3
                                    +
                                    σ
                                 
                              
                              
                                 
                                    m
                                 
                                 
                                    p
                                    ,
                                    q
                                    ,
                                    s
                                 
                              
                              (
                              Y
                              )
                           
                        .
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       p
                                       ,
                                       q
                                       ,
                                       s
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                h
                                             
                                          
                                          (
                                          A
                                          )
                                          ,
                                          h
                                       
                                    
                                 
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       3
                                       +
                                       σ
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       p
                                       ,
                                       q
                                       ,
                                       s
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   ·
                                                   x
                                                
                                             
                                          
                                          ∩
                                          
                                             
                                                1
                                             
                                             
                                                R
                                             
                                          
                                          ·
                                          X
                                       
                                    
                                 
                                 +
                                 
                                    
                                       R
                                    
                                    
                                       3
                                       +
                                       σ
                                    
                                 
                                 O
                                 
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   R
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             σ
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       m
                                    
                                    
                                       p
                                       ,
                                       q
                                       ,
                                       s
                                    
                                 
                                 (
                                 
                                    
                                       B
                                    
                                    
                                       R
                                    
                                 
                                 (
                                 x
                                 )
                                 ∩
                                 X
                                 )
                                 +
                                 O
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       3
                                       +
                                       σ
                                       -
                                       
                                          
                                             μ
                                          
                                          
                                             σ
                                          
                                       
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             σ
                                          
                                       
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       m
                                    
                                    
                                       p
                                       ,
                                       q
                                       ,
                                       s
                                    
                                 
                                 (
                                 A
                                 )
                                 +
                                 O
                                 
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                3
                                                +
                                                σ
                                                -
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      σ
                                                   
                                                
                                             
                                          
                                          
                                             
                                                h
                                             
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      σ
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Eq. (19) is a multigrid convergence result for digital moments of subsets 
                           
                              
                                 
                                    B
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              )
                              ∩
                              X
                           
                         valid for R decreasing as h decreases.

For any digital subset 
                           
                              Z
                              ⊂
                              
                                 
                                    Z
                                 
                                 
                                    3
                                 
                              
                           
                        , we define its digital covariance matrix 
                        
                           
                              
                                 
                                    J
                                 
                                 
                                    ^
                                 
                              
                              (
                              Z
                              ,
                              h
                              )
                           
                         
                        at step h as:
                           
                              (20)
                              
                                 
                                    
                                       J
                                    
                                    
                                       ^
                                    
                                 
                                 (
                                 Z
                                 ,
                                 h
                                 )
                                 
                                 
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                         ,
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   Z
                                                   ,
                                                   h
                                                   )
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                         ,
                                                         1
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   Z
                                                   ,
                                                   h
                                                   )
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                         ,
                                                         0
                                                         ,
                                                         1
                                                      
                                                   
                                                   (
                                                   Z
                                                   ,
                                                   h
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                         ,
                                                         1
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   Z
                                                   ,
                                                   h
                                                   )
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                         ,
                                                         2
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   Z
                                                   ,
                                                   h
                                                   )
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                         ,
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                   (
                                                   Z
                                                   ,
                                                   h
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                         ,
                                                         0
                                                         ,
                                                         1
                                                      
                                                   
                                                   (
                                                   Z
                                                   ,
                                                   h
                                                   )
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                         ,
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                   (
                                                   Z
                                                   ,
                                                   h
                                                   )
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                         ,
                                                         0
                                                         ,
                                                         2
                                                      
                                                   
                                                   (
                                                   Z
                                                   ,
                                                   h
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             0
                                             ,
                                             0
                                             ,
                                             0
                                          
                                       
                                       (
                                       Z
                                       ,
                                       h
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                         ,
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   Z
                                                   ,
                                                   h
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                         ,
                                                         1
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   Z
                                                   ,
                                                   h
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                         ,
                                                         0
                                                         ,
                                                         1
                                                      
                                                   
                                                   (
                                                   Z
                                                   ,
                                                   h
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 ⊗
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                            ,
                                                            0
                                                            ,
                                                            0
                                                         
                                                      
                                                      (
                                                      Z
                                                      ,
                                                      h
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            0
                                                            ,
                                                            1
                                                            ,
                                                            0
                                                         
                                                      
                                                      (
                                                      Z
                                                      ,
                                                      h
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            0
                                                            ,
                                                            0
                                                            ,
                                                            1
                                                         
                                                      
                                                      (
                                                      Z
                                                      ,
                                                      h
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 .
                              
                           
                        
                     

We now establish the multigrid convergence of the digital covariance matrix toward the covariance matrix. In this case, we know the exact position of the point x at which both digital and continuous covariance matrices are computed. The following theorem only takes into account the integral approximation error.
                           Theorem 3
                           Multigrid convergence of digital covariance matrix


                           
                              Let 
                              
                                 
                                    X
                                    ∈
                                    X
                                 
                              
                              . Then, there exists some constant 
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          X
                                       
                                    
                                 
                              
                              , such that for any grid step 
                              
                                 
                                    0
                                    <
                                    h
                                    <
                                    
                                       
                                          h
                                       
                                       
                                          X
                                       
                                    
                                 
                              
                              , for arbitrary 
                              
                                 
                                    x
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              , for arbitrary 
                              
                                 
                                    R
                                    ⩾
                                    h
                                 
                              
                              , with non-empty 
                              
                                 
                                    A
                                    (
                                    R
                                    ,
                                    x
                                    )
                                    
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                    
                                       
                                          B
                                       
                                       
                                          R
                                       
                                    
                                    (
                                    x
                                    )
                                    ∩
                                    X
                                 
                              
                              , we have:
                              
                                 
                                    
                                       ∥
                                       
                                          
                                             J
                                          
                                          
                                             ^
                                          
                                       
                                       (
                                       
                                          
                                             D
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       A
                                       (
                                       R
                                       ,
                                       x
                                       )
                                       )
                                       ,
                                       h
                                       )
                                       -
                                       J
                                       (
                                       A
                                       (
                                       R
                                       ,
                                       x
                                       )
                                       )
                                       ∥
                                       ⩽
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                2
                                             
                                          
                                       
                                       O
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             5
                                             -
                                             
                                                
                                                   μ
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           


                              The constants hidden in the big O do not depend on the shape size or geometry. 
                              
                                 
                                    ∥
                                    ·
                                    ∥
                                 
                               
                              denotes the spectral norm on matrices.
                           

To simplify expressions, we set 
                                 
                                    A
                                    
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                    A
                                    (
                                    R
                                    ,
                                    x
                                    )
                                    ,
                                    
                                    
                                       
                                          A
                                       
                                       
                                          h
                                       
                                    
                                    
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                    
                                       
                                          D
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    A
                                    (
                                    R
                                    ,
                                    x
                                    )
                                    )
                                 
                              . We begin by translating the sets A and 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          h
                                       
                                    
                                 
                               towards the origin w.r.t. x. We must use a vector that takes into account the digitization, hence we shift 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          h
                                       
                                    
                                 
                               by the vector 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          h
                                       
                                    
                                 
                              , the integer vector closest to 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          h
                                       
                                    
                                 
                              , and we shift A with the vector 
                                 
                                    h
                                    
                                       
                                          x
                                       
                                       
                                          h
                                       
                                    
                                 
                              . We further set 
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          h
                                       
                                    
                                    
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                    
                                       
                                          D
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    A
                                    )
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          h
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ∼
                                       
                                    
                                    
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                    A
                                    -
                                    h
                                    
                                       
                                          x
                                       
                                       
                                          h
                                       
                                    
                                 
                              . Following these definitions,
                                 
                                    (21)
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ^
                                          
                                       
                                       (
                                       
                                          
                                             D
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       A
                                       (
                                       R
                                       ,
                                       x
                                       )
                                       )
                                       ,
                                       h
                                       )
                                       =
                                       
                                          
                                             J
                                          
                                          
                                             ^
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      h
                                                   
                                                
                                                ,
                                                h
                                             
                                          
                                       
                                       =
                                       
                                          
                                             J
                                          
                                          
                                             ^
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                   
                                                   
                                                      h
                                                   
                                                
                                                +
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      h
                                                   
                                                
                                                ,
                                                h
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

Using the translation invariance for covariance matrix
                                 4
                                 For any finite subset 
                                       
                                          Y
                                          ⊂
                                          
                                             
                                                R
                                             
                                             
                                                3
                                             
                                          
                                       
                                    , for any vector 
                                       
                                          v
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                          
                                          J
                                          (
                                          Y
                                          +
                                          v
                                          )
                                          =
                                          J
                                          (
                                          Y
                                          )
                                       
                                    .
                              
                              
                                 4
                               which implies that for any finite subset 
                                 
                                    Z
                                    ⊂
                                    
                                       
                                          Z
                                       
                                       
                                          3
                                       
                                    
                                 
                              , for any integral vector 
                                 
                                    v
                                    ∈
                                    
                                       
                                          Z
                                       
                                       
                                          3
                                       
                                    
                                 
                              , for any 
                                 
                                    h
                                    >
                                    0
                                    ,
                                    
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    Z
                                    +
                                    v
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    Z
                                    )
                                 
                              , we have
                                 
                                    (22)
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ^
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                   
                                                   
                                                      h
                                                   
                                                
                                                +
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      h
                                                   
                                                
                                                ,
                                                h
                                             
                                          
                                       
                                       =
                                       
                                          
                                             J
                                          
                                          
                                             ^
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                   
                                                   
                                                      h
                                                   
                                                
                                                ,
                                                h
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

Writing down the definition of digital covariance matrix (see Eq. (20)), we have:
                                 
                                    (23)
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ^
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                   
                                                   
                                                      h
                                                   
                                                
                                                ,
                                                h
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     m
                                                                  
                                                                  
                                                                     ˆ
                                                                  
                                                               
                                                            
                                                            
                                                               2
                                                               ,
                                                               0
                                                               ,
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              ∼
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        h
                                                                     
                                                                  
                                                                  ,
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         ⋱
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       -
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   0
                                                   ,
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            h
                                                         
                                                      
                                                      ,
                                                      h
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     m
                                                                  
                                                                  
                                                                     ˆ
                                                                  
                                                               
                                                            
                                                            
                                                               1
                                                               ,
                                                               0
                                                               ,
                                                               0
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     ∼
                                                                  
                                                               
                                                            
                                                            
                                                               h
                                                            
                                                         
                                                         ,
                                                         h
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ⊗
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        m
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  1
                                                                  ,
                                                                  0
                                                                  ,
                                                                  0
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        A
                                                                     
                                                                     
                                                                        ∼
                                                                     
                                                                  
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                            ,
                                                            h
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            ⋮
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                       .
                                    
                                 
                              
                           

We remark that 
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          h
                                       
                                    
                                    =
                                    
                                       
                                          D
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    A
                                    )
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          h
                                       
                                    
                                    =
                                    
                                       
                                          D
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          
                                             A
                                             -
                                             h
                                             
                                                
                                                   x
                                                
                                                
                                                   h
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          D
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          ∼
                                       
                                    
                                    )
                                 
                              . Consequently, we apply convergence result of Eq. (19) onto set 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ∼
                                       
                                    
                                 
                               and insert them into Eq. (23) to get
                                 
                                    (24)
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ^
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   ∼
                                                
                                             
                                          
                                          
                                             h
                                          
                                       
                                       ,
                                       h
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               2
                                                               ,
                                                               0
                                                               ,
                                                               0
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               ∼
                                                            
                                                         
                                                         )
                                                         +
                                                         O
                                                         (
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               5
                                                               -
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         ⋱
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       -
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   0
                                                   ,
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             (
                                             
                                                
                                                   A
                                                
                                                
                                                   ∼
                                                
                                             
                                             )
                                             +
                                             O
                                             (
                                             
                                                
                                                   R
                                                
                                                
                                                   3
                                                   -
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   h
                                                
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     m
                                                                  
                                                                  
                                                                     1
                                                                     ,
                                                                     0
                                                                     ,
                                                                     0
                                                                  
                                                               
                                                               (
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     ∼
                                                                  
                                                               
                                                               )
                                                               +
                                                               O
                                                               (
                                                               
                                                                  
                                                                     R
                                                                  
                                                                  
                                                                     4
                                                                     -
                                                                     
                                                                        
                                                                           μ
                                                                        
                                                                        
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           μ
                                                                        
                                                                        
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                               )
                                                               )
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋱
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

Note that constants in big O are independent of X thanks to the normalization. In Eq. (24), we recognize easily 
                                 
                                    J
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          ∼
                                       
                                    
                                    )
                                 
                               plus other terms. We bound the other terms from above with two facts: (i) the radius R is greater than h, (ii) since 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ∼
                                       
                                    
                                 
                               is non-empty and close to the origin, we apply Eqs. (A.2) and (A.4) of Lemma 4 for set 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ∼
                                       
                                    
                                    ⊂
                                    
                                       
                                          B
                                       
                                       
                                          R
                                       
                                    
                                    (
                                    t
                                    )
                                 
                               with 
                                 
                                    t
                                    =
                                    x
                                    -
                                    h
                                    
                                       
                                          x
                                       
                                       
                                          h
                                       
                                    
                                 
                              , noticing that 
                                 
                                    ∥
                                    t
                                    
                                       
                                          ∥
                                       
                                       
                                          ∞
                                       
                                    
                                    ⩽
                                    
                                       
                                          h
                                       
                                       
                                          2
                                       
                                    
                                 
                              . We obtain
                                 
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ^
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   ∼
                                                
                                             
                                          
                                          
                                             h
                                          
                                       
                                       ,
                                       h
                                       )
                                       =
                                       J
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             ∼
                                          
                                       
                                       )
                                       +
                                       O
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             5
                                             -
                                             
                                                
                                                   μ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                       +
                                       O
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             5
                                             -
                                             
                                                
                                                   μ
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       )
                                       +
                                       O
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             5
                                             -
                                             
                                                
                                                   μ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       )
                                       .
                                    
                                 
                              We conclude since 
                                 
                                    J
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   ∼
                                                
                                             
                                          
                                       
                                    
                                    =
                                    J
                                    
                                       
                                          
                                             A
                                             -
                                             h
                                             
                                                
                                                   x
                                                
                                                
                                                   h
                                                
                                             
                                          
                                       
                                    
                                    =
                                    J
                                    (
                                    A
                                    )
                                 
                               (Translation invariance for covariance matrix).□

In general, we do not know the exact position of x but only some approximation 
                           
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                           
                         taken on the digital boundary 
                           
                              
                                 
                                    ∂
                                 
                                 
                                    h
                                 
                              
                              X
                           
                        . We therefore examine the perturbation of the moments when they are evaluated at a shifted position 
                           
                              x
                              +
                              t
                           
                        .
                           Lemma 3
                           
                              For any measurable subset 
                              
                                 
                                    X
                                    ⊂
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                 
                               
                              and any vector 
                              
                                 
                                    t
                                 
                               
                              with norm 
                              
                                 
                                    t
                                    
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                    ∥
                                    t
                                    
                                       
                                          ∥
                                       
                                       
                                          2
                                       
                                    
                                    ⩽
                                    R
                                 
                              
                              , we have for 
                              
                                 
                                    0
                                    ⩽
                                    p
                                    +
                                    q
                                    +
                                    s
                                    
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                    σ
                                    ⩽
                                    2
                                 
                              
                              :
                              
                                 
                                    (25)
                                    
                                       
                                          
                                             m
                                          
                                          
                                             p
                                             ,
                                             q
                                             ,
                                             s
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      R
                                                   
                                                
                                                (
                                                x
                                                +
                                                t
                                                )
                                                ∩
                                                X
                                             
                                          
                                       
                                       =
                                       
                                          
                                             m
                                          
                                          
                                             p
                                             ,
                                             q
                                             ,
                                             s
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      R
                                                   
                                                
                                                (
                                                x
                                                )
                                                ∩
                                                X
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                σ
                                             
                                          
                                       
                                       O
                                       
                                          
                                             
                                                ∥
                                                x
                                                
                                                   
                                                      ∥
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      tR
                                                   
                                                   
                                                      2
                                                      +
                                                      σ
                                                      -
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

The proof is detailed in Appendix A.2.

We now establish the multigrid convergence of the digital covariance matrix toward the covariance matrix even when the exact point x is unknown.
                           Theorem 4
                           Multigrid convergence of digital covariance matrix with position error


                           
                              Let 
                              
                                 
                                    X
                                    ∈
                                    X
                                 
                              
                              . Then, there exists some constant 
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          X
                                       
                                    
                                 
                              
                              , such that for any grid step 
                              
                                 
                                    0
                                    <
                                    h
                                    <
                                    
                                       
                                          h
                                       
                                       
                                          X
                                       
                                    
                                 
                              
                              , for arbitrary 
                              
                                 
                                    R
                                    ⩾
                                    h
                                 
                              
                              , for any 
                              
                                 
                                    x
                                    ∈
                                    ∂
                                    X
                                 
                               
                              and any 
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                    ∈
                                    
                                       
                                          ∂
                                       
                                       
                                          h
                                       
                                    
                                    X
                                    ,
                                    
                                    ∥
                                    x
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                    
                                       
                                          ∥
                                       
                                       
                                          ∞
                                       
                                    
                                    ⩽
                                    h
                                 
                              
                              , we have:
                              
                                 
                                    
                                       ∥
                                       
                                          
                                             J
                                          
                                          
                                             ^
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      h
                                                   
                                                
                                                (
                                                A
                                                (
                                                R
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                )
                                                )
                                                ,
                                                h
                                             
                                          
                                       
                                       -
                                       J
                                       (
                                       A
                                       (
                                       R
                                       ,
                                       x
                                       )
                                       )
                                       ∥
                                       ⩽
                                       O
                                       
                                          
                                             
                                                ∥
                                                x
                                                -
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                ∥
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                2
                                             
                                          
                                       
                                       O
                                       
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      5
                                                      -
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                              with 
                              
                                 
                                    A
                                    (
                                    R
                                    ,
                                    y
                                    )
                                    
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                    
                                       
                                          B
                                       
                                       
                                          R
                                       
                                    
                                    (
                                    y
                                    )
                                    ∩
                                    X
                                 
                              
                              . The constants hidden in the big O do not depend on the shape size or geometry.
                           

The fact that 
                                 
                                    ∥
                                    x
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                    
                                       
                                          ∥
                                       
                                       
                                          ∞
                                       
                                    
                                    ⩽
                                    h
                                    ⩽
                                    R
                                 
                               induces that 
                                 
                                    A
                                    (
                                    R
                                    ,
                                    x
                                    )
                                 
                               and 
                                 
                                    A
                                    (
                                    R
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                 
                               are both non-empty. We cut the difference of two matrices into two parts:
                                 
                                    
                                       ∥
                                       
                                          
                                             J
                                          
                                          
                                             ^
                                          
                                       
                                       (
                                       
                                          
                                             D
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       A
                                       (
                                       R
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       )
                                       ,
                                       h
                                       )
                                       -
                                       J
                                       (
                                       A
                                       (
                                       R
                                       ,
                                       x
                                       )
                                       )
                                       ∥
                                       ⩽
                                       ∥
                                       
                                          
                                             J
                                          
                                          
                                             ^
                                          
                                       
                                       (
                                       
                                          
                                             D
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       A
                                       (
                                       R
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       )
                                       ,
                                       h
                                       )
                                       -
                                       J
                                       (
                                       A
                                       (
                                       R
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       )
                                       ∥
                                       +
                                       ∥
                                       J
                                       (
                                       A
                                       (
                                       R
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       )
                                       -
                                       J
                                       (
                                       A
                                       (
                                       R
                                       ,
                                       x
                                       )
                                       )
                                       ∥
                                       .
                                    
                                 
                              
                           

For the first error term, we apply directly Theorem 3 at point 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              . For the second term, we set 
                                 
                                    t
                                    
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                    -
                                    x
                                    ,
                                    
                                    t
                                    
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                    ∥
                                    t
                                    ∥
                                 
                              . Then we use the invariance of the covariance matrix with respect to translation to shift the problem toward the origin:
                                 
                                    
                                       ∥
                                       J
                                       (
                                       A
                                       (
                                       R
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       )
                                       -
                                       J
                                       (
                                       A
                                       (
                                       R
                                       ,
                                       x
                                       )
                                       )
                                       ∥
                                       =
                                       ∥
                                       J
                                       (
                                       A
                                       (
                                       R
                                       ,
                                       x
                                       +
                                       t
                                       )
                                       )
                                       -
                                       J
                                       (
                                       A
                                       (
                                       R
                                       ,
                                       x
                                       )
                                       )
                                       ∥
                                       =
                                       ∥
                                       J
                                       (
                                       A
                                       (
                                       R
                                       ,
                                       x
                                       +
                                       t
                                       )
                                       -
                                       x
                                       )
                                       -
                                       J
                                       (
                                       A
                                       (
                                       R
                                       ,
                                       x
                                       )
                                       -
                                       x
                                       )
                                       ∥
                                       =
                                       ∥
                                       J
                                       (
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             R
                                          
                                       
                                       (
                                       x
                                       +
                                       t
                                       )
                                       -
                                       x
                                       )
                                       ∩
                                       (
                                       X
                                       -
                                       x
                                       )
                                       )
                                       -
                                       J
                                       (
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             R
                                          
                                       
                                       (
                                       x
                                       )
                                       -
                                       x
                                       )
                                       ∩
                                       (
                                       X
                                       -
                                       x
                                       )
                                       )
                                       ∥
                                       =
                                       ∥
                                       J
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             R
                                          
                                       
                                       (
                                       t
                                       )
                                       ∩
                                       (
                                       X
                                       -
                                       x
                                       )
                                       )
                                       -
                                       J
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             R
                                          
                                       
                                       (
                                       0
                                       )
                                       ∩
                                       (
                                       X
                                       -
                                       x
                                       )
                                       )
                                       ∥
                                       =
                                       ∥
                                       J
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             R
                                          
                                       
                                       (
                                       t
                                       )
                                       ∩
                                       
                                          
                                             X
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       -
                                       J
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             R
                                          
                                       
                                       (
                                       0
                                       )
                                       ∩
                                       
                                          
                                             X
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ∥
                                       ,
                                    
                                 
                              with 
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ′
                                       
                                    
                                    
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                    X
                                    -
                                    x
                                 
                              . We will apply Lemma 3 for the different moments in the covariance matrix J. We denote by 
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          t
                                       
                                    
                                 
                               the set 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          R
                                       
                                    
                                    (
                                    t
                                    )
                                    ∩
                                    
                                       
                                          X
                                       
                                       
                                          ′
                                       
                                    
                                 
                               and by 
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          0
                                       
                                    
                                 
                               the set 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          R
                                       
                                    
                                    (
                                    0
                                    )
                                    ∩
                                    
                                       
                                          X
                                       
                                       
                                          ′
                                       
                                    
                                 
                              .
                                 
                                    
                                       ∥
                                       J
                                       (
                                       
                                          
                                             Y
                                          
                                          
                                             t
                                          
                                       
                                       )
                                       -
                                       J
                                       (
                                       
                                          
                                             Y
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       ∥
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        m
                                                                     
                                                                     
                                                                        2
                                                                        ,
                                                                        0
                                                                        ,
                                                                        0
                                                                     
                                                                  
                                                                  (
                                                                  
                                                                     
                                                                        Y
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  )
                                                                  -
                                                                  
                                                                     
                                                                        m
                                                                     
                                                                     
                                                                        2
                                                                        ,
                                                                        0
                                                                        ,
                                                                        0
                                                                     
                                                                  
                                                                  (
                                                                  
                                                                     
                                                                        Y
                                                                     
                                                                     
                                                                        0
                                                                     
                                                                  
                                                                  )
                                                               
                                                               
                                                            
                                                            
                                                               
                                                               
                                                                  ⋱
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                -
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            0
                                                            ,
                                                            0
                                                            ,
                                                            0
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        m
                                                                     
                                                                     
                                                                        1
                                                                        ,
                                                                        0
                                                                        ,
                                                                        0
                                                                     
                                                                  
                                                                  (
                                                                  
                                                                     
                                                                        Y
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               
                                                                  ⋮
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ⊗
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           m
                                                                        
                                                                        
                                                                           1
                                                                           ,
                                                                           0
                                                                           ,
                                                                           0
                                                                        
                                                                     
                                                                     (
                                                                     
                                                                        
                                                                           Y
                                                                        
                                                                        
                                                                           t
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  
                                                                     ⋮
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      T
                                                   
                                                
                                                +
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            0
                                                            ,
                                                            0
                                                            ,
                                                            0
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        m
                                                                     
                                                                     
                                                                        1
                                                                        ,
                                                                        0
                                                                        ,
                                                                        0
                                                                     
                                                                  
                                                                  (
                                                                  
                                                                     
                                                                        Y
                                                                     
                                                                     
                                                                        0
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               
                                                                  ⋮
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ⊗
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           m
                                                                        
                                                                        
                                                                           1
                                                                           ,
                                                                           0
                                                                           ,
                                                                           0
                                                                        
                                                                     
                                                                     (
                                                                     
                                                                        
                                                                           Y
                                                                        
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  
                                                                     ⋮
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

Matrix 
                                 
                                    J
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          t
                                       
                                    
                                    )
                                    -
                                    J
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                               contains differences of geometrical moments of order two (e.g. 
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          2
                                          ,
                                          0
                                          ,
                                          0
                                       
                                    
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          t
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          m
                                       
                                       
                                          2
                                          ,
                                          0
                                          ,
                                          0
                                       
                                    
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                              ) and quantities in the form of 
                                 
                                    Δ
                                    
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                1
                                                ,
                                                0
                                                ,
                                                0
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      t
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                             
                                          
                                          (
                                          
                                             
                                                Y
                                             
                                             
                                                t
                                             
                                          
                                          )
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                1
                                                ,
                                                0
                                                ,
                                                0
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                0
                                                ,
                                                0
                                                ,
                                                0
                                             
                                          
                                          (
                                          
                                             
                                                Y
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                    
                                 
                               (component 
                                 
                                    (
                                    1
                                    ,
                                    1
                                    )
                                 
                               in 
                                 
                                    J
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          t
                                       
                                    
                                    )
                                    -
                                    J
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                               matrix). From Lemma 3, every error on second-order moments is in 
                                 
                                    O
                                    (
                                    
                                       
                                          tR
                                       
                                       
                                          4
                                       
                                    
                                    )
                                 
                              . To bound 
                                 
                                    Δ
                                 
                               quantities, we first observe that 
                                 
                                    ∣
                                    
                                       
                                          m
                                       
                                       
                                          0
                                          ,
                                          0
                                          ,
                                          0
                                       
                                    
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          t
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          m
                                       
                                       
                                          0
                                          ,
                                          0
                                          ,
                                          0
                                       
                                    
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    ∣
                                    =
                                    π
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    t
                                    +
                                    O
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    +
                                    O
                                    (
                                    
                                       
                                          tR
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    )
                                 
                               using Theorem 7 in [38]. Hence,
                                 
                                    
                                       Δ
                                       =
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   0
                                                   ,
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             (
                                             
                                                
                                                   Y
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                             +
                                             O
                                             (
                                             
                                                
                                                   tR
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   0
                                                   ,
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             (
                                             
                                                
                                                   Y
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       O
                                       (
                                       
                                          
                                             tR
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   0
                                                   ,
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   0
                                                   ,
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             (
                                             
                                                
                                                   Y
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                       .
                                    
                                 
                              
                           

Since 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          b
                                          +
                                          O
                                          (
                                          x
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          a
                                       
                                       
                                          b
                                       
                                    
                                    +
                                    
                                       
                                          a
                                       
                                       
                                          
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    O
                                    (
                                    x
                                    )
                                 
                              , using Lemma 3 and 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    (
                                    a
                                    -
                                    b
                                    )
                                    (
                                    a
                                    +
                                    b
                                    )
                                 
                              ,
                                 
                                    
                                       Δ
                                       =
                                       O
                                       (
                                       
                                          
                                             tR
                                          
                                          
                                             4
                                          
                                       
                                       )
                                       +
                                       (
                                       
                                          
                                             m
                                          
                                          
                                             1
                                             ,
                                             0
                                             ,
                                             0
                                          
                                       
                                       (
                                       
                                          
                                             Y
                                          
                                          
                                             t
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             m
                                          
                                          
                                             1
                                             ,
                                             0
                                             ,
                                             0
                                          
                                       
                                       (
                                       
                                          
                                             Y
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       )
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             (
                                             
                                                
                                                   Y
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             (
                                             
                                                
                                                   Y
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   0
                                                   ,
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             (
                                             
                                                
                                                   Y
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       O
                                       (
                                       
                                          
                                             tR
                                          
                                          
                                             4
                                          
                                       
                                       )
                                       +
                                       (
                                       O
                                       (
                                       
                                          
                                             tR
                                          
                                          
                                             3
                                          
                                       
                                       )
                                       +
                                       O
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             4
                                          
                                       
                                       )
                                       )
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             (
                                             
                                                
                                                   Y
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                   ,
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             (
                                             
                                                
                                                   Y
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   0
                                                   ,
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             (
                                             
                                                
                                                   Y
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                       
                                       (
                                       
                                          Lemma 4,
                                       
                                       Eq
                                       .
                                       
                                       
                                          (A.2)
                                       
                                       )
                                    
                                 
                              We use Lemma 3 and the fact that since 
                                 
                                    t
                                    <
                                    R
                                 
                              , 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          0
                                          ,
                                          0
                                          ,
                                          0
                                       
                                    
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    =
                                    O
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                              , we have:
                                 
                                    
                                       Δ
                                       =
                                       O
                                       (
                                       
                                          
                                             tR
                                          
                                          
                                             4
                                          
                                       
                                       )
                                       +
                                       (
                                       O
                                       (
                                       
                                          
                                             tR
                                          
                                          
                                             3
                                          
                                       
                                       )
                                       +
                                       O
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             4
                                          
                                       
                                       )
                                       )
                                       
                                          
                                             O
                                             (
                                             
                                                
                                                   tR
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   0
                                                   ,
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             (
                                             
                                                
                                                   Y
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       O
                                       (
                                       
                                          
                                             tR
                                          
                                          
                                             4
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           

The same bound is found for all terms of the matrix. Putting everything together gives the result.□

Following the truncated Taylor expansion of Lemma 2, we define estimators of curvatures from the diagonalization of the digital covariance matrix.
                           Definition 3
                           Let Z be a digital shape, x some point of 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                 
                               and 
                                 
                                    h
                                    >
                                    0
                                 
                               a grid step. For 
                                 
                                    R
                                    ⩾
                                    h
                                 
                              , we define the integral principal curvature estimators 
                              
                                 
                                    
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          R
                                       
                                       
                                          1
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                 
                               of Z at point 
                                 
                                    y
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                 
                               and step h as
                                 
                                    (26)
                                    
                                       
                                          
                                             
                                                
                                                   κ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             R
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Z
                                       ,
                                       y
                                       ,
                                       h
                                       )
                                       =
                                       
                                          
                                             6
                                          
                                          
                                             π
                                             
                                                
                                                   R
                                                
                                                
                                                   6
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       -
                                       3
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             8
                                          
                                          
                                             5
                                             R
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    (27)
                                    
                                       
                                          
                                             
                                                
                                                   κ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       Z
                                       ,
                                       y
                                       ,
                                       h
                                       )
                                       =
                                       
                                          
                                             6
                                          
                                          
                                             π
                                             
                                                
                                                   R
                                                
                                                
                                                   6
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       -
                                       3
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             8
                                          
                                          
                                             5
                                             R
                                          
                                       
                                       ,
                                    
                                 
                              where 
                                 
                                    
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                               are the two greatest eigenvalues of 
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ^
                                       
                                    
                                    (
                                    
                                       
                                          B
                                       
                                       
                                          R
                                          /
                                          h
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   h
                                                
                                             
                                             ·
                                             y
                                          
                                       
                                    
                                    ∩
                                    Z
                                    ,
                                    h
                                    )
                                    )
                                 
                              .

We recall the following result of matrix perturbation theory [3,43,4]:
                           Theorem 5
                           Lidskii-Weyl inequality


                           
                              If 
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    B
                                    )
                                 
                               
                              denotes the ordered eigenvalues of some symmetric matrix B and 
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    B
                                    +
                                    E
                                    )
                                 
                               
                              the ordered eigenvalues of some symmetric matrix 
                              
                                 
                                    B
                                    +
                                    E
                                 
                              
                              , then 
                              
                                 
                                    
                                       
                                          max
                                       
                                       
                                          i
                                       
                                    
                                    ∣
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    B
                                    )
                                    -
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    B
                                    +
                                    E
                                    )
                                    ∣
                                    ⩽
                                    ∥
                                    E
                                    ∥
                                 
                              
                              .
                           

We prove below that our integral principal curvature estimators are multigrid convergent toward the principal curvatures along the shape.
                           Theorem 6
                           Uniform convergence of principal curvature estimators 
                                 
                                    
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          R
                                       
                                       
                                          1
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                 
                               along 
                                 
                                    
                                       
                                          ∂
                                       
                                       
                                          h
                                       
                                    
                                    X
                                 
                              
                           


                           
                              Let 
                              
                                 
                                    X
                                    ∈
                                    X
                                 
                              
                              . For 
                              
                                 
                                    i
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    }
                                 
                              
                              , recall that 
                              
                                 
                                    
                                       
                                          κ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    X
                                    ,
                                    x
                                    )
                                 
                               
                              is the i-th principal curvature of 
                              
                                 
                                    ∂
                                    X
                                 
                               
                              at boundary point x. Then, there exist positive constants 
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          X
                                       
                                    
                                    ,
                                    k
                                    ,
                                    K
                                 
                               
                              such that, for any 
                              
                                 
                                    h
                                    ⩽
                                    
                                       
                                          h
                                       
                                       
                                          X
                                       
                                    
                                 
                              
                              , setting 
                              
                                 
                                    R
                                    =
                                    
                                       
                                          kh
                                       
                                       
                                          
                                             
                                                1
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                              
                              , we have
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                                
                                                   ∀
                                                   x
                                                   ∈
                                                   ∂
                                                   X
                                                   ,
                                                   
                                                   ∀
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         ∂
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   X
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   ∥
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   -
                                                   x
                                                   
                                                      
                                                         ∥
                                                      
                                                      
                                                         ∞
                                                      
                                                   
                                                   ⩽
                                                   h
                                                   
                                                   ⇒
                                                   
                                                   ∣
                                                   
                                                      
                                                         
                                                            
                                                               κ
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         R
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                   ,
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   ,
                                                   h
                                                   )
                                                   -
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   X
                                                   ,
                                                   x
                                                   )
                                                   ∣
                                                   ⩽
                                                   
                                                      
                                                         Kh
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

We prove the result for the first principal curvature, the proof for the second one is similar. According to Definition 3, 
                                 
                                    
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                               are the two greatest eigenvalues of 
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ^
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   R
                                                   /
                                                   h
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            h
                                                         
                                                      
                                                      ·
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                
                                             
                                             ∩
                                             Z
                                             ,
                                             h
                                          
                                       
                                    
                                 
                               with 
                                 
                                    Z
                                    =
                                    
                                       
                                          D
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    X
                                    )
                                    )
                                 
                              . We derive easily:
                                 
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ^
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      R
                                                      /
                                                      h
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               h
                                                            
                                                         
                                                         ·
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                   
                                                
                                                ∩
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      h
                                                   
                                                
                                                (
                                                X
                                                )
                                                ,
                                                h
                                             
                                          
                                       
                                       =
                                       
                                          
                                             J
                                          
                                          
                                             ^
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      R
                                                      /
                                                      h
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               h
                                                            
                                                         
                                                         ·
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                   
                                                
                                                ∩
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               h
                                                            
                                                         
                                                         ·
                                                         X
                                                      
                                                   
                                                
                                                ∩
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      3
                                                   
                                                
                                                ,
                                                h
                                             
                                          
                                       
                                       =
                                       
                                          
                                             J
                                          
                                          
                                             ^
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      h
                                                   
                                                
                                                ·
                                                (
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      R
                                                   
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                )
                                                ∩
                                                X
                                                )
                                                ∩
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      3
                                                   
                                                
                                                ,
                                                h
                                             
                                          
                                       
                                       =
                                       
                                          
                                             J
                                          
                                          
                                             ^
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      h
                                                   
                                                
                                                (
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      R
                                                   
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                )
                                                ∩
                                                X
                                                )
                                                ,
                                                h
                                             
                                          
                                       
                                       =
                                       
                                          
                                             J
                                          
                                          
                                             ^
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      h
                                                   
                                                
                                                (
                                                A
                                                (
                                                R
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                )
                                                )
                                                ,
                                                h
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           


                              Theorem 4 indicates that 
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ^
                                       
                                    
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    A
                                    (
                                    R
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    )
                                    ,
                                    h
                                    )
                                 
                               and 
                                 
                                    J
                                    (
                                    A
                                    (
                                    R
                                    ,
                                    x
                                    )
                                    )
                                 
                               are close to each other with a norm difference bounded by 
                                 
                                    O
                                    (
                                    ∥
                                    x
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                    ∥
                                    
                                       
                                          R
                                       
                                       
                                          4
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          2
                                       
                                    
                                    O
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          5
                                          -
                                          
                                             
                                                μ
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    )
                                 
                              . Since both matrices are symmetric by definition, Theorem 5 implies that 
                                 
                                    
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                               are close to the eigenvalues 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    J
                                    (
                                    A
                                    (
                                    R
                                    ,
                                    x
                                    )
                                    )
                                    )
                                 
                               and 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    J
                                    (
                                    A
                                    (
                                    R
                                    ,
                                    x
                                    )
                                    )
                                    )
                                 
                               with the same bound.
                                 5
                                 Note that since error bounds tend to zero as h tends to zero, the ordering of the eigenvalues in both matrices is the same for a sufficiently small h.
                              
                              
                                 5
                               We thus write:
                                 
                                    
                                       
                                          
                                             
                                                
                                                   κ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             R
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             D
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       X
                                       )
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                       ,
                                       h
                                       )
                                       =
                                       
                                          
                                             6
                                          
                                          
                                             π
                                             
                                                
                                                   R
                                                
                                                
                                                   6
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       -
                                       3
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             8
                                          
                                          
                                             5
                                             R
                                          
                                       
                                       =
                                       
                                          
                                             6
                                          
                                          
                                             π
                                             
                                                
                                                   R
                                                
                                                
                                                   6
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                -
                                                3
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                O
                                                (
                                                ∥
                                                x
                                                -
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                ∥
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      4
                                                   
                                                
                                                )
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         0
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                O
                                                (
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      5
                                                      -
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       +
                                       
                                          
                                             8
                                          
                                          
                                             5
                                             R
                                          
                                       
                                       .
                                    
                                 
                              We then substitute the truncated Taylor expansion of Lemma 2 into the latter equation and we bound 
                                 
                                    ∥
                                    x
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                    ∥
                                 
                               by h. After some calculations, we get:
                                 
                                    (28)
                                    
                                       
                                          
                                             
                                                
                                                   κ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             R
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             D
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       X
                                       )
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                       ,
                                       h
                                       )
                                       =
                                       
                                          
                                             κ
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       X
                                       ,
                                       x
                                       )
                                       +
                                       O
                                       (
                                       R
                                       )
                                       +
                                       O
                                       (
                                       h
                                       /
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                2
                                             
                                          
                                       
                                       O
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       /
                                       
                                          
                                             R
                                          
                                          
                                             1
                                             +
                                             
                                                
                                                   μ
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           

Setting 
                                 
                                    R
                                    =
                                    
                                       
                                          kh
                                       
                                       
                                          α
                                       
                                    
                                 
                              , we optimize the value 
                                 
                                    α
                                 
                               to minimize all errors. Since 
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                       
                                    
                                    ⩾
                                    1
                                 
                               for the shape X, the optimal value is 
                                 
                                    α
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          3
                                       
                                    
                                 
                              . The bound follows. □

It is worth to note that the preceding error bound could be improved at neighborhoods where the Gaussian curvature does not vanish: the constants 
                           
                              
                                 
                                    μ
                                 
                                 
                                    i
                                 
                              
                           
                         are then closer to 
                           
                              1.5
                           
                        . However, there is the issue of estimating more precisely the position of 
                           
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                           
                         with respect to x. In the best known case [30], uniform convergence with bound 
                           
                              ≈
                              O
                              (
                              
                                 
                                    h
                                 
                                 
                                    0.434
                                 
                              
                              )
                           
                         can be expected for radius R with a size proportional to 
                           
                              
                                 
                                    h
                                 
                                 
                                    0.434
                                 
                              
                           
                        .

In Theorem 6, we focused on multigrid convergence of principal curvature quantities. However, similar results can be obtained for principal curvature directions as well [15].

We present an experimental evaluation of curvature estimators in 2D and 3D (mean and principal curvatures). We have implemented our Integral Invariant estimators (II) in the open-source library DGtal 
                     [46]. DGtal allows us to construct parametric or implicit shapes in dimension 2 and 3 for any grid step h. Furthermore, DGtal allows comparison with former approaches available in dimension 2: curvature from Most-centered Maximal Segment with length information (MDSS) [12,16], curvature from Most-centered Digital Circular Arc (MDCA) [41] and Binomial based convolution (BC) [18]; and in dimension 3: curvature from polynomial surface approximation (Jet Fitting) [8] using a binding between DGtal and CGal 
                     [45]. Jet Fitting approach requires a point set on which the polynomial fitting is performed. In our multigrid setting, the radius of the spherical kernel used to construct the local point-set around a given surface element is the same as the radius of the integral invariant kernel (
                        
                           R
                           =
                           
                              
                                 kh
                              
                              
                                 α
                              
                           
                        
                     ).

As described in Section 2, brute-force implementation is trivial. We first need to construct a kernel from a Euclidean ball with radius given by 
                        
                           R
                           =
                           
                              
                                 kh
                              
                              
                                 α
                              
                           
                        
                      as described in theorem statements. Then, the digital object boundary is tracked and the kernel is centered on each surface elements. For 2D and 3D mean curvature estimators, the volumetric integral of the intersection between the kernel and the object is computed; for 3D principal curvature estimators, the covariance matrix of this intersection is computed and then eigenvalues and eigenvectors are deduced from it by diagonalization.

With this approach, we achieve a computational cost of 
                        
                           O
                           (
                           
                              
                                 (
                                 R
                                 /
                                 h
                                 )
                              
                              
                                 d
                              
                           
                           )
                        
                      per surface element (i.e. the size of the kernel at grid step h). However, we can take advantage of the digital surface structure to considerably speed up this algorithm: if we consider a surface tracker for which surface elements are processed by proximity (the current surface element is a neighbor of the previous one through a translation vector 
                        
                           
                              
                                 δ
                              
                              
                                 →
                              
                           
                        
                     ), the area/volume estimation can be done incrementally. Indeed, they are countable additive:
                        
                           
                              
                                 
                                    Area
                                 
                                 
                                    ^
                                 
                              
                              (
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              (
                              X
                              )
                              ∩
                              
                                 
                                    B
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              +
                              
                                 
                                    δ
                                 
                                 
                                    →
                                 
                              
                              )
                              ,
                              h
                              )
                              =
                              
                                 
                                    Area
                                 
                                 
                                    ^
                                 
                              
                              (
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              (
                              X
                              )
                              ∩
                              
                                 
                                    B
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              )
                              ,
                              h
                              )
                              +
                              
                                 
                                    Area
                                 
                                 
                                    ^
                                 
                              
                              (
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              (
                              X
                              )
                              ∩
                              (
                              
                                 
                                    B
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              +
                              
                                 
                                    δ
                                 
                                 
                                    →
                                 
                              
                              )
                              ⧹
                              
                                 
                                    B
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              )
                              )
                              ,
                              h
                              )
                              -
                              
                                 
                                    Area
                                 
                                 
                                    ^
                                 
                              
                              (
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              (
                              X
                              )
                              ∩
                              (
                              
                                 
                                    B
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              )
                              ⧹
                              
                                 
                                    B
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              +
                              
                                 
                                    δ
                                 
                                 
                                    →
                                 
                              
                              )
                              )
                              ,
                              h
                              )
                              .
                           
                        
                     
                  

Similarly we have for moments:
                        
                           
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    p
                                    ,
                                    q
                                    ,
                                    s
                                 
                              
                              (
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              (
                              X
                              )
                              ∩
                              
                                 
                                    B
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              +
                              
                                 
                                    δ
                                 
                                 
                                    →
                                 
                              
                              )
                              ,
                              h
                              )
                              =
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    p
                                    ,
                                    q
                                    ,
                                    s
                                 
                              
                              (
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              (
                              X
                              )
                              ∩
                              
                                 
                                    B
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              )
                              ,
                              h
                              )
                              +
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    p
                                    ,
                                    q
                                    ,
                                    s
                                 
                              
                              (
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              (
                              X
                              )
                              ∩
                              (
                              
                                 
                                    B
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              +
                              
                                 
                                    δ
                                 
                                 
                                    →
                                 
                              
                              )
                              ⧹
                              
                                 
                                    B
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              )
                              )
                              ,
                              h
                              )
                              -
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    p
                                    ,
                                    q
                                    ,
                                    s
                                 
                              
                              (
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              (
                              X
                              )
                              ∩
                              (
                              
                                 
                                    B
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              )
                              ⧹
                              
                                 
                                    B
                                 
                                 
                                    R
                                 
                              
                              (
                              x
                              +
                              
                                 
                                    δ
                                 
                                 
                                    →
                                 
                              
                              )
                              )
                              ,
                              h
                              )
                              .
                           
                        
                     
                  

Then, if we precompute all kernels 
                        
                           
                              
                                 D
                              
                              
                                 h
                              
                           
                           (
                           
                              
                                 B
                              
                              
                                 R
                              
                           
                           (
                           0
                           ±
                           
                              
                                 δ
                              
                              
                                 →
                              
                           
                           )
                           ⧹
                           
                              
                                 B
                              
                              
                                 R
                              
                           
                           (
                           0
                           )
                           )
                        
                      for some 
                        
                           
                              
                                 δ
                              
                              
                                 →
                              
                           
                        
                      displacements (based on surface element umbrella configurations, 8 in 2D and 26 in 3D for 
                        
                           ∥
                           
                              
                                 δ
                              
                              
                                 →
                              
                           
                           
                              
                                 ∥
                              
                              
                                 ∞
                              
                           
                           =
                           h
                        
                     ), the computational cost per surface element can be reduced to 
                        
                           O
                           (
                           
                              
                                 (
                                 R
                                 /
                                 h
                                 )
                              
                              
                                 d
                                 -
                                 1
                              
                           
                           )
                        
                     . Finally, in the ideal case of a Hamiltonian traversal of the surface, only the first surfel has to be computed using kernel 
                        
                           
                              
                                 B
                              
                              
                                 R
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 ˆ
                              
                           
                           )
                        
                      and every subsequent neighboring surfel is processed using sub-kernels 
                        
                           
                              
                                 D
                              
                              
                                 h
                              
                           
                           (
                           
                              
                                 B
                              
                              
                                 R
                              
                           
                           (
                           0
                           ±
                           
                              
                                 δ
                              
                              
                                 →
                              
                           
                           )
                           ⧹
                           
                              
                                 B
                              
                              
                                 R
                              
                           
                           (
                           0
                           )
                           )
                        
                     .

In our experimental evaluation, we need to compare the estimated curvature values with expected Euclidean ones on parametric curves and surfaces on which such curvature information is known. We have chosen three 2D shapes to perform our evaluation: an ellipse (Fig. 2
                     (a)) which matches the theorem’s hypotheses (convex 
                        
                           
                              
                                 C
                              
                              
                                 3
                              
                           
                        
                      shape), a flower (Fig. 2(b)) and an accelerated flower (Fig. 2(c)) which do not satisfy the hypotheses exactly (
                        
                           
                              
                                 C
                              
                              
                                 3
                              
                           
                        
                      but non-convex shapes). In 3D, we chose a sphere (Fig. 2(d)), a rounded cube (Fig. 2(e)) and Goursat’s surface (Fig. 2(f)). As in 2D, the sphere and the rounded cube match the theorem’s hypotheses, and we have a non-convex shape with Goursat’s surface. Equations, parameters and shape domains of these Euclidean objects are given in Table 1
                     . In order to quantitatively interpret error measurements given in the graphs, we detail expected minimum and maximal curvature values in this table. To compensate subpixel/subvoxel digitization effects when digitizing a continuous object, we evaluate the estimators on digitization of 10 random translations of the continuous objects (continuous objects are translated by a vector randomly selected in 
                        
                           
                              
                                 [
                                 -
                                 1
                                 ,
                                 1
                                 ]
                              
                              
                                 2
                              
                           
                        
                      or 
                        
                           
                              
                                 [
                                 -
                                 1
                                 ,
                                 1
                                 ]
                              
                              
                                 3
                              
                           
                        
                     ). Estimated quantities are compared to expected Euclidean ones for each pair of digital/continuous contour points (
                        
                           
                              
                                 x
                              
                              
                                 ˆ
                              
                           
                           ∈
                           
                              
                                 ∂
                              
                              
                                 h
                              
                           
                           X
                        
                      and 
                        
                           x
                           ∈
                           ∂
                           X
                        
                     ). In our experiments, we consider two different metrics on point-wise errors to get a global error measurement. First 
                        
                           
                              
                                 l
                              
                              
                                 ∞
                              
                           
                        
                      metric is used to quantify worst-case error since it reflects the uniform convergence of Theorems 2 and 6. In other experiments, we also consider 
                        
                           
                              
                                 l
                              
                              
                                 2
                              
                           
                        
                      error to get an average error analysis.

From Theorems 2 and 6, theory indicates that the best candidate for 
                        
                           α
                        
                      is 
                        
                           
                              
                                 α
                              
                              
                                 m
                              
                           
                           
                           
                              
                                 =
                              
                              
                                 def
                              
                           
                           
                           
                              
                                 1
                              
                              
                                 3
                              
                           
                        
                      to ensure a multigrid convergence in 
                        
                           O
                           (
                           
                              
                                 h
                              
                              
                                 
                                    
                                       1
                                    
                                    
                                       3
                                    
                                 
                              
                           
                           )
                        
                     . We first need to confirm this setting considering 
                        
                           α
                        
                      values in 
                        
                           
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          2
                                       
                                       
                                          5
                                       
                                    
                                    ,
                                    
                                       
                                          1
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          2
                                       
                                       
                                          7
                                       
                                    
                                    ,
                                    
                                       
                                          1
                                       
                                       
                                          4
                                       
                                    
                                 
                              
                           
                        
                     . Fig. 3
                     (a, b and c) presents results for the worst-case (
                        
                           
                              
                                 l
                              
                              
                                 ∞
                              
                           
                        
                     ) distance between the true expected curvature values and the estimated ones. For multigrid ellipses, we observe experimental convergence for several 
                        
                           α
                        
                      values (except for 
                        
                           α
                           =
                           
                              
                                 1
                              
                              
                                 2
                              
                           
                        
                     ). As suggested by Theorem 2, for 
                        
                           α
                           =
                           
                              
                                 α
                              
                              
                                 m
                              
                           
                           
                           
                              
                                 =
                              
                              
                                 def
                              
                           
                           
                           
                              
                                 1
                              
                              
                                 3
                              
                           
                        
                      the behavior of the 
                        
                           
                              
                                 l
                              
                              
                                 ∞
                              
                           
                        
                      error is experimentally in 
                        
                           O
                           (
                           
                              
                                 h
                              
                              
                                 
                                    
                                       1
                                    
                                    
                                       3
                                    
                                 
                              
                           
                           )
                        
                     . The theorem is defined in the general case, but the big O error can be improved with some further hypothesis on the shape. This could explain why better convergence speeds seem to be obtained when 
                        
                           α
                           =
                           
                              
                                 2
                              
                              
                                 7
                              
                           
                        
                      and 
                        
                           
                              
                                 1
                              
                              
                                 4
                              
                           
                        
                     . For non-convex shapes (flower and accelerated flower), we still observe the convergence. Interestingly, values 
                        
                           α
                        
                      greater than 
                        
                           
                              
                                 1
                              
                              
                                 3
                              
                           
                        
                      (and thus larger digital kernel size) seems to lead to slightly better estimations. The theoretical rationale behind this observation should be explored in future works.

We performed the same analysis in 3D for the mean and principal curvature estimators. Section 3 in [10] and Theorem 6 theoretically prove that 
                        
                           α
                           =
                           
                              
                                 1
                              
                              
                                 3
                              
                           
                        
                      leads to an 
                        
                           
                              
                                 l
                              
                              
                                 ∞
                              
                           
                        
                      error at least in 
                        
                           O
                           (
                           
                              
                                 h
                              
                              
                                 
                                    
                                       1
                                    
                                    
                                       3
                                    
                                 
                              
                           
                           )
                        
                     . Fig. 4
                      gives results of 
                        
                           
                              
                                 l
                              
                              
                                 ∞
                              
                           
                        
                      error for various 
                        
                           α
                        
                      values. We observe that for both convex and non-convex shapes, 
                        
                           α
                           =
                           
                              
                                 1
                              
                              
                                 3
                              
                           
                        
                      provides expected convergence speed in mean and principal curvatures estimation. As in 2D, better convergence speed can be obtained with 
                        
                           α
                           =
                           
                              
                                 2
                              
                              
                                 7
                              
                           
                        
                      and 
                        
                           
                              
                                 1
                              
                              
                                 4
                              
                           
                        
                     .

In Fig. 3(d, e and f) we compare the proposed 2D curvature estimator (II with 
                        
                           α
                           =
                           
                              
                                 1
                              
                              
                                 3
                              
                           
                        
                     ) with BC, MDSS, MDCA estimators for the 
                        
                           
                              
                                 l
                              
                              
                                 2
                              
                           
                        
                      (mean error) and 
                        
                           
                              
                                 l
                              
                              
                                 ∞
                              
                           
                        
                      error metrics. In these noise-free shapes, 
                        
                           
                              
                                 l
                              
                              
                                 ∞
                              
                           
                        
                      convergence speeds of MDCA is close to II. We observe a convergence for BC, but with lower convergence speeds. Note that MDSS exhibits no experimental convergence here. We observe for ellipses that BC provides better 
                        
                           
                              
                                 l
                              
                              
                                 2
                              
                           
                        
                      results than II for high h values, but the behavior of both curves show that II will be better when h is refined. For flower and accelerated flower, we have the same behavior for 
                        
                           
                              
                                 l
                              
                              
                                 2
                              
                           
                        
                      than for 
                        
                           
                              
                                 l
                              
                              
                                 ∞
                              
                           
                        
                      error.

In all graphs, we had to stop the computations for BC and MDCA for the following reasons: in our implementation of BC, the mask size becomes too large for small h values which induces memory usage issues. For MDCA, circular arc recognition in DGtal is driven by a geometrical predicate based on a determinant computation of squared point coordinates. Hence, small h values lead to numerical capacity issues and thus instability (which could be solved considering arbitrary precision integer numbers but would lead to efficiency issues). The proposed integral invariant estimator does not suffer from these kinds of issues. Note that for the finest experiment 
                        
                           h
                           =
                           0.00017
                        
                     , digital shapes are defined in a digital domain 235,2952. At this scale, the digital ellipse has 648,910 contour elements.


                     Fig. 5
                      illustrates the comparison with Jet Fitting on mean and principal curvatures with 
                        
                           
                              
                                 l
                              
                              
                                 ∞
                              
                           
                        
                      error metric on a sphere (a, d and g), a rounded cube (b, e and h) and Goursat’s surface (c, f and i). We notice Jet Fitting performs better on a sphere for mean and principal curvatures than our estimators. On a rounded cube or Goursat’s surface and for the mean curvature, Jet Fitting has similar convergence speed than II. However, II has slightly lower 
                        
                           
                              
                                 l
                              
                              
                                 ∞
                              
                           
                        
                      errors. For principal curvatures, we observe that our estimator significantly outperforms principal curvatures from Jet Fitting. If we look at mean errors (
                        
                           
                              
                                 l
                              
                              
                                 2
                              
                           
                        
                      metrics) in Fig. 6
                     , similar behaviors can be observed. Note that for the finest experiment 
                        
                           h
                           =
                           0.04
                        
                     , digital shapes are defined in a digital domain 
                        
                           
                              
                                 500
                              
                              
                                 3
                              
                           
                        
                     . At this scale, the digital rounded cube object has 1,125,222 surface elements.

We have also evaluated the behavior of our estimators on noisy data. Given a digital binary object, our noise model consists in swapping the grid point value at p with probability defined by a power law 
                        
                           
                              
                                 β
                              
                              
                                 1
                                 +
                                 dt
                                 (
                                 p
                                 )
                              
                           
                        
                      for some user-specified 
                        
                           β
                           ∈
                           [
                           0
                           ,
                           1
                           ]
                        
                      (
                        
                           dt
                           (
                           p
                           )
                        
                      corresponds to the distance of p to the boundary of the original digital shape). Such noise model, so-called 
                        
                           Kanungo
                        
                      noise [22], is particularly well-adapted to evaluate the stability of digital geometry algorithms [24]. In Fig. 7
                     (a and d), examples of noisified objects are given. Our experimental setting can be described as follows: for both the flower in 2D and the rounded cube in 3D (
                        
                           h
                           =
                           0.1
                        
                      for both), we slightly increase the noise parameter from 0 to 1 and we plot the 
                        
                           
                              
                                 l
                              
                              
                                 ∞
                              
                           
                        
                      error. In dimension two (Fig. 7(e)), we observe that estimators based on geometrical object recognition (MDSS and MDCA) are highly sensitive to contour perturbations. Both BC and II are extremely robust to small noise but for 
                        
                           β
                        
                      greater than 0.5, II significantly outperforms BC. In dimension 3, we observe that both II and Jet Fitting approaches lead to quite stable results. Indeed, some computations in the Jet Fitting approach rely on a point-set PCA (Principal Component Analysis) which also provides robust statistics.

In Fig. 8
                     , we detail timings in logscale of various estimators on the flower object in 2D and the rounded cube in 3D. As expected, approaches based on object recognition in dimension 2 (MDSS and MDCA) provide faster computations. We also observe that II is a bit slower but has an asymptotic behavior much more favorable that BC. In dimension 3 (Fig. 8(b)), we observe that Jet fitting and II behaviors are similar and that II is 10 times faster than our implementation of Jet fitting.

Finally, Fig. 9
                      shows mean curvature and principal directions mapped on various shapes (rounded cube, Goursat’s surface, Leopold surface) and on an object (Stanford bunny). From these experiments, we can see that principal directions are nicely captured by covariance matrix eigenvectors.

@&#CONCLUSION@&#

In this paper, we have used integral invariant results from differential geometry to design simple and efficient digital curvature estimators in dimension 2 and 3. Digital geometry is a perfect domain for such differential tools: volume, area or geometrical moments computations are digital by nature, interesting connections to fundamental results on Gauss digitization exist, fast computations are induced by the specific geometry of digital surfaces. For curvature estimation in dimension 2 as well as principal curvature estimations in dimension 3, we have proven a theoretical uniform convergence in 
                        
                           O
                           
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          
                                             
                                                1
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                      for 
                        
                           
                              
                                 C
                              
                              
                                 3
                              
                           
                        
                      smooth object boundaries. Experimental evaluation has not only confirmed this bound but has also shown that these estimators can be computed efficiently in practice with low computational costs. Our digital Integral Invariant estimators and all other estimators used in the experimental evaluation section are publicly available in DGtal 
                     [46]. Convergence speed are obtained with a weak constraint on the distance between 
                        
                           
                              
                                 x
                              
                              
                                 ˆ
                              
                           
                        
                      and x (which just needs to be lower that h for the 
                        
                           
                              
                                 l
                              
                              
                                 ∞
                              
                           
                        
                      metric). Using a specific projection as discussed in [29], better convergence speed is expected at least for dimension 2.

@&#ACKNOWLEDGMENTS@&#

This work has been mainly funded by DigitalSnow ANR-11-BS02-009, PRIMES LABEX ANR-11-LABX-0063/ANR-11-IDEX-0007 and KIDICO ANR-2010-BLAN-0205 research Grants. We gratefully acknowledge support from the CNRS/IN2P3 Computing Center (Lyon/Villeurbanne – France), for providing a significant amount of the computing resources needed for this work. We also thank the Stanford 3D Scanning Repository for Bunny model.

We gather here a few technical facts and results related to covariance matrices, digital and continuous 
                           
                              (
                              p
                              ,
                              q
                              ,
                              s
                              )
                           
                        -moments.
                           Lemma 4
                           
                              Let 
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          R
                                       
                                    
                                    (
                                    t
                                    )
                                 
                               
                              be the ball of radius R and center t. Then, for any non-empty 
                              
                                 
                                    Y
                                    ⊂
                                    
                                       
                                          B
                                       
                                       
                                          R
                                       
                                    
                                    (
                                    t
                                    )
                                 
                              
                              ,
                              
                                 
                                    (A.1)
                                    
                                       
                                          
                                             m
                                          
                                          
                                             0
                                             ,
                                             0
                                             ,
                                             0
                                          
                                       
                                       (
                                       Y
                                       )
                                       =
                                       O
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             3
                                          
                                       
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    (A.2)
                                    
                                       
                                          
                                             m
                                          
                                          
                                             p
                                             ,
                                             q
                                             ,
                                             s
                                          
                                       
                                       (
                                       Y
                                       )
                                       =
                                       O
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             3
                                          
                                       
                                       (
                                       ∥
                                       t
                                       
                                          
                                             ∥
                                          
                                          
                                             ∞
                                          
                                       
                                       +
                                       R
                                       )
                                       )
                                       ,
                                       
                                       (
                                       p
                                       +
                                       q
                                       +
                                       s
                                       =
                                       1
                                       )
                                    
                                 
                              
                              
                                 
                                    (A.3)
                                    
                                       
                                          
                                             m
                                          
                                          
                                             p
                                             ,
                                             q
                                             ,
                                             s
                                          
                                       
                                       (
                                       Y
                                       )
                                       =
                                       O
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             3
                                          
                                       
                                       (
                                       ∥
                                       t
                                       
                                          
                                             ∥
                                          
                                          
                                             ∞
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       R
                                       ∥
                                       t
                                       
                                          
                                             ∥
                                          
                                          
                                             ∞
                                          
                                       
                                       +
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       )
                                       ,
                                       
                                       (
                                       p
                                       +
                                       q
                                       +
                                       s
                                       =
                                       2
                                       )
                                    
                                 
                              
                              and
                              
                                 
                                    (A.4)
                                    
                                       
                                          
                                             m
                                          
                                          
                                             p
                                             ,
                                             q
                                             ,
                                             s
                                          
                                       
                                       (
                                       Y
                                       )
                                       /
                                       
                                          
                                             m
                                          
                                          
                                             0
                                             ,
                                             0
                                             ,
                                             0
                                          
                                       
                                       (
                                       Y
                                       )
                                       =
                                       O
                                       (
                                       R
                                       +
                                       t
                                       )
                                       ,
                                       
                                       (
                                       p
                                       +
                                       q
                                       +
                                       s
                                       =
                                       1
                                       )
                                       .
                                    
                                 
                              
                           

Eq. (A.1) is immediate since 0-order moment is the volume of Y, hence it cannot exceed the volume of the ball which is 
                                 
                                    
                                       
                                          4
                                       
                                       
                                          3
                                       
                                    
                                    π
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                 
                              . For Eq. (A.2), we make the change of variable 
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    =
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    )
                                    -
                                    t
                                 
                               in the following expression:
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             1
                                             ,
                                             0
                                             ,
                                             0
                                          
                                       
                                       (
                                       Y
                                       )
                                       =
                                       
                                          
                                             ∭
                                          
                                          
                                             Y
                                          
                                       
                                       xdxdydz
                                       =
                                       
                                          
                                             ∭
                                          
                                          
                                             Y
                                             -
                                             t
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       
                                          
                                             t
                                          
                                          
                                             x
                                          
                                       
                                       )
                                       
                                          
                                             dx
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             dy
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             dz
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             t
                                          
                                          
                                             x
                                          
                                       
                                       Vol
                                       (
                                       Y
                                       )
                                       +
                                       
                                          
                                             m
                                          
                                          
                                             1
                                             ,
                                             0
                                             ,
                                             0
                                          
                                       
                                       (
                                       Y
                                       -
                                       t
                                       )
                                       .
                                    
                                 
                              
                           

In the first term, 
                                 
                                    Vol
                                    (
                                    Y
                                    )
                                 
                               is bounded by the volume of any ball of radius R. By the additivity of integrals, the second term is maximized by the 
                                 
                                    (
                                    1
                                    ,
                                    0
                                    ,
                                    0
                                    )
                                 
                              -moment of the half-ball 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          R
                                       
                                       
                                          +
                                       
                                    
                                    (
                                    0
                                    )
                                 
                               centered on 0 and lying in the positive x orthants. Now, using spherical coordinates, we get
                                 
                                    (A.5)
                                    
                                       
                                          
                                             m
                                          
                                          
                                             1
                                             ,
                                             0
                                             ,
                                             0
                                          
                                       
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             R
                                          
                                          
                                             +
                                          
                                       
                                       (
                                       0
                                       )
                                       )
                                       =
                                       
                                          ∫
                                          
                                             0
                                          
                                          
                                             R
                                          
                                       
                                       
                                          ∫
                                          
                                             
                                                
                                                   -
                                                   π
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   π
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          ∫
                                          
                                             
                                                
                                                   -
                                                   π
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   π
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       (
                                       ρ
                                       cos
                                       ϕ
                                       cos
                                       θ
                                       )
                                       (
                                       
                                          
                                             ρ
                                          
                                          
                                             2
                                          
                                       
                                       cos
                                       ϕ
                                       )
                                       
                                       d
                                       θ
                                       d
                                       ϕ
                                       d
                                       ρ
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ρ
                                                            
                                                            
                                                               4
                                                            
                                                         
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             0
                                          
                                          
                                             R
                                          
                                       
                                       
                                          
                                             
                                                
                                                   sin
                                                   θ
                                                
                                             
                                          
                                          
                                             -
                                             
                                                
                                                   π
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   π
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             [
                                             ϕ
                                             +
                                             sin
                                             (
                                             ϕ
                                             )
                                             cos
                                             (
                                             ϕ
                                             )
                                             ]
                                          
                                          
                                             -
                                             
                                                
                                                   π
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   π
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             π
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                    
                                 
                              which concludes for Eq. (A.2) (other cases 
                                 
                                    p
                                    +
                                    q
                                    +
                                    s
                                    =
                                    1
                                 
                               are similar). Other equations are proved in a similar way. □


                        
                           Proof
                           By decomposing X according to the two shifted balls (see Fig. A.10
                              ), we get:
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             p
                                             ,
                                             q
                                             ,
                                             s
                                          
                                       
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             R
                                          
                                       
                                       (
                                       x
                                       +
                                       t
                                       )
                                       ∩
                                       X
                                       )
                                       -
                                       
                                          
                                             m
                                          
                                          
                                             p
                                             ,
                                             q
                                             ,
                                             s
                                          
                                       
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             R
                                          
                                       
                                       (
                                       x
                                       )
                                       ∩
                                       X
                                       )
                                       =
                                       
                                          
                                             m
                                          
                                          
                                             p
                                             ,
                                             q
                                             ,
                                             s
                                          
                                       
                                       (
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             R
                                          
                                       
                                       (
                                       x
                                       +
                                       t
                                       )
                                       ⧹
                                       
                                          
                                             B
                                          
                                          
                                             R
                                          
                                       
                                       (
                                       x
                                       )
                                       )
                                       ∩
                                       X
                                       )
                                       -
                                       
                                          
                                             m
                                          
                                          
                                             p
                                             ,
                                             q
                                             ,
                                             s
                                          
                                       
                                       (
                                       (
                                       
                                          
                                             B
                                          
                                          
                                             R
                                          
                                       
                                       (
                                       x
                                       )
                                       ⧹
                                       
                                          
                                             B
                                          
                                          
                                             R
                                          
                                       
                                       (
                                       x
                                       +
                                       t
                                       )
                                       )
                                       ∩
                                       X
                                       )
                                       .
                                    
                                 
                              
                           

We denote by 
                                 
                                    Δ
                                    (
                                    t
                                    )
                                 
                               the difference on the right term of preceding equation. The two sets on the right form the symmetric difference (symbol 
                                 
                                    ⊖
                                 
                              ) of the two shifted balls. We will use the following fact:
                                 
                                    (A.6)
                                    
                                       ∅
                                       
                                       ≠
                                       
                                       
                                          
                                             Y
                                          
                                          
                                             1
                                          
                                       
                                       ⊂
                                       
                                          
                                             Y
                                          
                                          
                                             2
                                          
                                       
                                       ⊂
                                       
                                          
                                             R
                                          
                                          
                                             3
                                          
                                       
                                       
                                       ⇒
                                       
                                       ∣
                                       
                                          
                                             
                                                sup
                                             
                                             
                                                Y
                                                ⊂
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             m
                                          
                                          
                                             p
                                             ,
                                             q
                                             ,
                                             s
                                          
                                       
                                       (
                                       Y
                                       )
                                       ∣
                                       ⩽
                                       ∣
                                       
                                          
                                             
                                                sup
                                             
                                             
                                                Y
                                                ⊂
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             m
                                          
                                          
                                             p
                                             ,
                                             q
                                             ,
                                             s
                                          
                                       
                                       (
                                       Y
                                       )
                                       ∣
                                       .
                                    
                                 
                              
                           

By additivity of integrals, we have immediately:
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∣
                                                   Δ
                                                   (
                                                   t
                                                   )
                                                   ∣
                                                
                                             
                                             
                                                
                                                   
                                                   =
                                                   ∣
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         p
                                                         ,
                                                         q
                                                         ,
                                                         s
                                                      
                                                   
                                                   (
                                                   (
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   (
                                                   x
                                                   +
                                                   t
                                                   )
                                                   ⊖
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                   )
                                                   ∩
                                                   X
                                                   )
                                                   ∣
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   ⩽
                                                   
                                                      
                                                         
                                                            sup
                                                         
                                                         
                                                            Y
                                                            ⊂
                                                            (
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                            (
                                                            x
                                                            +
                                                            t
                                                            )
                                                            ⊖
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                            (
                                                            x
                                                            )
                                                            )
                                                            ∩
                                                            X
                                                         
                                                      
                                                   
                                                   ∣
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         p
                                                         ,
                                                         q
                                                         ,
                                                         s
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                   ∣
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   ⩽
                                                   
                                                      
                                                         
                                                            sup
                                                         
                                                         
                                                            Y
                                                            ⊂
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                            (
                                                            x
                                                            +
                                                            t
                                                            )
                                                            ⊖
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                            (
                                                            x
                                                            )
                                                         
                                                      
                                                   
                                                   ∣
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         p
                                                         ,
                                                         q
                                                         ,
                                                         s
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                   ∣
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   ⩽
                                                   
                                                      
                                                         
                                                            sup
                                                         
                                                         
                                                            Y
                                                            ⊂
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  R
                                                                  +
                                                                  t
                                                               
                                                            
                                                            (
                                                            x
                                                            )
                                                            -
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  R
                                                                  -
                                                                  t
                                                               
                                                            
                                                            (
                                                            x
                                                            )
                                                         
                                                      
                                                   
                                                   ∣
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         p
                                                         ,
                                                         q
                                                         ,
                                                         s
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                   ∣
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

In the last row, we cover the symmetric difference of two shifted balls by the difference of two balls of same center, a kind of spherical shell or annulus in 2D (see Fig. A.10). Although it is a rough upper bound, it induces the same order of perturbation. We denote this set 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          R
                                          +
                                          t
                                       
                                    
                                    (
                                    x
                                    )
                                    -
                                    
                                       
                                          B
                                       
                                       
                                          R
                                          -
                                          t
                                       
                                    
                                    (
                                    x
                                    )
                                 
                               by 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          R
                                          ,
                                          t
                                       
                                    
                                    (
                                    x
                                    )
                                 
                              .

For zeroth order moment, we use simply the volume of the ball:
                                 
                                    (A.7)
                                    
                                       
                                          
                                             
                                                sup
                                             
                                             
                                                Y
                                                ⊂
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      R
                                                      ,
                                                      t
                                                   
                                                
                                                (
                                                x
                                                )
                                             
                                          
                                       
                                       ∣
                                       
                                          
                                             m
                                          
                                          
                                             0
                                             ,
                                             0
                                             ,
                                             0
                                          
                                       
                                       (
                                       Y
                                       )
                                       ∣
                                       =
                                       
                                          
                                             m
                                          
                                          
                                             0
                                             ,
                                             0
                                             ,
                                             0
                                          
                                       
                                       (
                                       
                                          
                                             H
                                          
                                          
                                             R
                                             ,
                                             t
                                          
                                       
                                       (
                                       x
                                       )
                                       )
                                       =
                                       
                                          
                                             4
                                             π
                                          
                                          
                                             3
                                          
                                       
                                       (
                                       6
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                       t
                                       +
                                       2
                                       
                                          
                                             t
                                          
                                          
                                             3
                                          
                                       
                                       )
                                       =
                                       O
                                       (
                                       
                                          
                                             tR
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           

For first order moments, we translate the shape to the origin, then we use the previous result plus the fact that the centered 
                                 
                                    (
                                    1
                                    ,
                                    0
                                    ,
                                    0
                                    )
                                 
                              -moment is maximized by the corresponding moment for the x-positive half-ball
                                 6
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                x
                                             
                                          
                                       
                                     denotes the x-component of x.
                              
                              
                                 6
                              :
                                 
                                    (A.8)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            sup
                                                         
                                                         
                                                            Y
                                                            ⊂
                                                            
                                                               
                                                                  H
                                                               
                                                               
                                                                  R
                                                                  ,
                                                                  t
                                                               
                                                            
                                                            (
                                                            x
                                                            )
                                                         
                                                      
                                                   
                                                   ∣
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                         ,
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                   ∣
                                                
                                             
                                             
                                                
                                                   
                                                   ⩽
                                                   
                                                      
                                                         
                                                            sup
                                                         
                                                         
                                                            Y
                                                            ⊂
                                                            
                                                               
                                                                  H
                                                               
                                                               
                                                                  R
                                                                  ,
                                                                  t
                                                               
                                                            
                                                            (
                                                            0
                                                            )
                                                         
                                                      
                                                   
                                                   ∣
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                         ,
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                   ∣
                                                   +
                                                   ∣
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   ∣
                                                   ∣
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         0
                                                         ,
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                   ∣
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   =
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                         ,
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         R
                                                         +
                                                         t
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   (
                                                   0
                                                   )
                                                   -
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         R
                                                         -
                                                         t
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   (
                                                   0
                                                   )
                                                   )
                                                   +
                                                   O
                                                   (
                                                   ∣
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   ∣
                                                   
                                                      
                                                         tR
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   =
                                                   2
                                                   π
                                                   (
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   t
                                                   +
                                                   
                                                      
                                                         Rt
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                   +
                                                   O
                                                   (
                                                   ∣
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   ∣
                                                   
                                                      
                                                         tR
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   =
                                                   O
                                                   (
                                                   
                                                      
                                                         tR
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                   +
                                                   O
                                                   (
                                                   ∥
                                                   x
                                                   ∥
                                                   
                                                      
                                                         tR
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

For second order moments, we translate the shape to the origin, then we use the two previous results plus the fact that the 
                                 
                                    (
                                    2
                                    ,
                                    0
                                    ,
                                    0
                                    )
                                 
                              -moment is maximized by the corresponding moment for the ball:
                                 
                                    (A.9)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            sup
                                                         
                                                         
                                                            Y
                                                            ⊂
                                                            
                                                               
                                                                  H
                                                               
                                                               
                                                                  R
                                                                  ,
                                                                  t
                                                               
                                                            
                                                            (
                                                            x
                                                            )
                                                         
                                                      
                                                   
                                                   ∣
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         2
                                                         ,
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                   ∣
                                                
                                             
                                             
                                                
                                                   
                                                   ⩽
                                                   
                                                      
                                                         
                                                            sup
                                                         
                                                         
                                                            Y
                                                            ⊂
                                                            
                                                               
                                                                  H
                                                               
                                                               
                                                                  R
                                                                  ,
                                                                  t
                                                               
                                                            
                                                            (
                                                            0
                                                            )
                                                         
                                                      
                                                   
                                                   ∣
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         2
                                                         ,
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                   ∣
                                                   +
                                                   2
                                                   ∣
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   ∣
                                                   ∣
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                         ,
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   
                                                   +
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ∣
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         0
                                                         ,
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                   ∣
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   =
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         2
                                                         ,
                                                         0
                                                         ,
                                                         0
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         R
                                                         ,
                                                         t
                                                      
                                                   
                                                   (
                                                   0
                                                   )
                                                   )
                                                   +
                                                   ∥
                                                   x
                                                   ∥
                                                   (
                                                   O
                                                   (
                                                   
                                                      
                                                         tR
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   
                                                   +
                                                   O
                                                   (
                                                   ∥
                                                   x
                                                   ∥
                                                   
                                                      
                                                         tR
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   )
                                                   +
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   O
                                                   (
                                                   
                                                      
                                                         tR
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   =
                                                   O
                                                   (
                                                   
                                                      
                                                         tR
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   )
                                                   +
                                                   O
                                                   (
                                                   ∥
                                                   x
                                                   ∥
                                                   
                                                      
                                                         tR
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                   +
                                                   O
                                                   (
                                                   ∥
                                                   x
                                                   
                                                      
                                                         ∥
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         tR
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Other moments are proved similarly. □

@&#REFERENCES@&#

