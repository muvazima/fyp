@&#MAIN-TITLE@&#Constructive generation of the medial axis for solid models

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel constructive method is given based on reuse of the existing MA.


                        
                        
                           
                           Only the MA in the local re-dilation region needs to be regenerated.


                        
                        
                           
                           Some new properties of MA are analyzed for the constructive MA generation.


                        
                        
                           
                           The local re-dilation region is incrementally determined for Boolean subtraction operations.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Medial axis

Boolean operation

Constructive method

Euclidean distance transform

@&#ABSTRACT@&#


               
               
                  The medial axis (MA) is a simplified representation of complicated models which is widely used in current research. However, the efficient generation of the MA for complicated solid models continues to pose a challenge. In this study, a constructive approach for the generation of the MA is proposed for solid models after they are voxelized. With this method, the MA of the model constructed from two operand models via a Boolean operation is efficiently generated by merging the MAs of the operand models in a certain way, instead of regenerating them from scratch. To support the proposed method, the affected region of the resultant model is computed first using a Boolean operation. Second, only the MA in the affected region is regenerated by distance dilation. Third, the complete MA of the resultant model is constructed by combining the newly generated MA with the unchanged MAs of the operand models. In this study, the accuracy and complexity are analyzed for the final MA and some examples are given to illustrate the performance of the proposed method.
               
            

@&#INTRODUCTION@&#

The medial axis (MA) of an object is the set of all points having more than one closest point on the object’s boundary  [1]. It is useful in many engineering fields because of its beneficial properties  [2]. Much research has been conducted regarding the generation of MAs  [3–5]. However, the computational efficiency is still not satisfactory for complicated models, even though some strategies have been proposed for special types of models  [6]. One common characteristic of almost all the existing approaches is that the model is regarded as one single part. In that case, the MA is generated each time from scratch, even when only a small modification is made to the model, which induces an intolerably low computational inefficiency. The efficient generation of the MA of solid models is still a challenge in engineering applications. Complicated engineering models often are constructed progressively using Boolean operations. Therefore, the MAs for these models can be obtained incrementally and efficiently by combining the MAs of the operand models.

Based on the above analysis, a constructive method is proposed which generates the MA of the resultant model obtained by a Boolean union or subtraction operation efficiently. In this method, the region that will be changed, hereafter called the affected region, is analyzed first. Then, the double queues based distance dilation (DQDD) algorithm is applied to the affected region. The output of the DQDD algorithm, the Euclidean distance transformation (EDT), formed by the distance values of the voxels of the model, is computed by distance dilation from outside to inside. Finally, the MA is generated using the computed EDT. The distance value of a voxel is calculated between the centers of the voxel and its touch voxel. Here, the touch voxel of a given voxel is the nearest voxel of the given voxel on the model boundary. The proposed method can also be used on a single model when the affected region is the whole model. The EDT and the MA in the affected regions only need to be regenerated when Boolean operations are performed on the operand models, dramatically improving the computational efficiency.

The remainder of this paper is organized as follows. In Section  2, the related work is summarized. The motivation for the study, an overview of the proposed DQDD method and some concepts are described in Section  3. Several fundamental properties are discussed in Section  4. The construction of the voxel map and the distance update of the affected region are described in Sections  5 and 6, respectively. Section  7 describes the process of MA generation. The accuracy and complexity analysis and some example results are given in Sections  8 and 9, respectively. Finally, the conclusions and the directions for future work are given in Section  10.

@&#RELATED WORK@&#

Since H. Blum  [7] introduced the MA to provide an effective description for 2D objects, there has been significant research on MA generation. The approaches can be classified into three categories: thinning, tracing and Voronoi graph-based methods  [8–15]. The thinning method is most similar to that applied in this study; therefore, the research related to that method is discussed. Research on improving the computational efficiency of the MA is also reviewed. For more information about the MA, readers can refer to other works  [16,17].

In the thinning method, the model is usually approximated first to easily compute the MA. The computational precision is controlled by the approximation precision of the model. L. Lam et al. introduced the thinning method  [18]. L.R. Nackman put forward a method which substituted a polygon/polyhedron for the smooth boundaries and thus used the MA of the polygon as the MA of the input model  [19]. Based on the diffusion of the combined waves, G.L. Scott et al. proposed a method to determine the symmetric axis of a model, which was a superset of the MA  [20]. This method is very effective for 0–1 images, but the computational error is considerably greater for color images. K. Siddiqi et al.  [21] proposed a vector field-based thinning method. In the approach by J. Vleugels and M. Overmars  [22], voxelization was recursively performed on a space that contained MA voxels until the necessary resolution was reached. To preserve the topology of the model, G. Borgefors et al. proposed a thinning method for 3D skeletonization that can be used to compute both the surface skeleton and the curve skeleton [23]. In their method, the Euclidean distance can be represented by the local distances, and an optimal method is given to compute the minimum distance between two points  [24]. G.K. Viswanathan et al. also proposed a thinning method to obtain the MA of the character  [25]. In this method, points are deleted from the outer boundary layer-by-layer until a single pixel-wide skeleton is produced.

To reduce the computational complexity, many researchers have proposed various strategies. Parallelizing approaches based on GPUs have been proposed by several researchers. Using GPUs, J. Ma et al.  [26] obtained the 3D MA point approximation using the nearest neighbors and the normal field. Recently, A.C. Jalba et al. improved upon their work  [27]. M. Ramanathan and B. Gurumoorthy explored how to exact the MA of a model generated by a Boolean union for a 2D model  [28]. The boundaries of the operand models that are not part of the union were identified and their corresponding MAs were removed. Y.C. Chang et al. tried to divide the 3D polyhedron into a set of regions by using influence shells. Then, the medial surface of each region was computed and they were combined to generate the MA for the entire model  [29]. The common characteristic of these methods is that the complicated model is divided into simpler parts for the computation and then recombined after the MA computation. E.C. Sherbrooke et al.  [30] built the linearly approximate segments of the curve in the direction of the tracing. Their method can be used for conveniently computing the MA of polyhedrons. Using a piecewise circular boundary conversion, O. Aichholzer et al. handled models with free-form shapes to efficiently generate the MA  [31]. Moreover, with their method, convergence is guaranteed. To speed up the Voronoi graph-based MA generation method, A. Meijster et al. separated the grid points of the image into independent rows and columns; thus, it is well suited for parallelization on a shared-memory machine  [32]. T. Hirata devised an efficient algorithm for each row to find the lower envelope of the minima of the set of distance functions  [33]. In the incremental method proposed by R. Ramamurthy and R.T. Farouki  [34], a single boundary segment was added to an existing boundary-segment set at each step, modifying the Voronoi regions of the existing boundary segments. The Voronoi region of the new segment was then constructed. After the Voronoi diagram was computed, the MA was obtained by removing certain edges of the Voronoi diagram that did not belong to the MA and by adding certain edges that belonged to the MA but were absent from the Voronoi diagram.

@&#MOTIVATION@&#

The proposed constructive MA generation method is inspired and closely related to two ideas. The first is the division strategy proposed by Y.C. Chang et al.  [29], in which the input polygon/polyhedron is divided into a set of regions, as shown in Fig. 1
                         (Fig. 7 in Ref.  [29]). The division lies on the concave elements and the influence shells are perpendicular to the adjacent boundary elements of the concave elements. The influence zone of a concave element is bounded by the influence shells that are perpendicular to the concave element, while the area outside all influence zones constitutes other regions. After the MAs of all regions are generated, they are combined to obtain the MA of the entire model. The method can be very efficient by parallelizing the generation of the MAs of different regions. However, the existing MA cannot be reused even if only a small modification is made to the model. The reason is that the division of regions has to be redone from scratch. Moreover, the method of obtaining a robust division for a complicated 3D model is not a trivial task.

The second is the idea of piecewise MA generation followed by a combination using Boolean union operations, proposed by M. Ramanathan and B. Gurumoorthy [28]. In their work, the vanished boundary of the operand models corresponds to the area where the MA must be recomputed, as shown in Fig. 2
                         (Fig. 27 in Ref. [28]). It is a completely novel idea for the generation of the MA, wherein the MAs of operand models can be reused. Y.S. Liu et al. also explored a similar method  [35,36]. However, the method for handling the Boolean subtraction operations is not described in their work. The difficulty in Boolean subtraction operations is that the affected region is not easily computed. The extension of the method to 3D models is also a difficult task, especially when a freeform boundary is included. M. Ramanathan and B. Gurumoorthy conducted further research in this area recently  [37]. However, they only obtained the seam lines of the medial surface. The medial surfaces themselves were not computed since it is computation-intensive  [37].

Based on the above analysis, the aim of this study is to propose a voxelization-based approximate method for the MA generation of complicated 3D solid models during the modeling process, including both Boolean union and subtraction operations. Here, the complicated 3D solid model may contain freeform boundary surfaces. The existing MAs of operand models can be reused as much as possible during the modeling process. Note that Boolean intersection is not considered since it is not used very often in the modeling process. Moreover, the method for the Boolean intersection operation may be similar to that used for the Boolean subtraction operation since their results are mutually supplementary with respect to the first operand model.

To describe the proposed method, some basic concepts are introduced first. To be more explicit and readable, a 2D example is used here. Some of the concepts are adapted from the previous work on the dilation-based method for MA generation  [38].


                        
                           Definition 1
                           The distance between two voxelsmeans the distance between the centers of these two voxels. The distance of a voxel means the distance from the center of the voxel to that of its touch voxel. Note that the distance used in this study is Euclidean distance.


                        
                           Definition 2
                           A vanished boundary is the boundary that will vanish after a Boolean operation is performed on the operand models. As shown in Fig. 3
                              , the orange line 
                                 M
                                 N
                               is a vanished boundary since it will vanish after a Boolean union operation is performed on model 
                                 A
                               and model 
                                 B
                              . Similarly, the added boundary is the boundary that will be added to the first operand model by the second model after a Boolean operation is performed on it. Moreover, if a part of the MA is generated by two parts of the boundary, the two parts of the boundary are called dual boundaries. As shown in Fig. 3, 
                                 E
                                 M
                               and 
                                 F
                                 N
                               are the dual boundaries of 
                                 M
                                 N
                              .


                        
                           Definition 3
                           An affected/unaffected region is the region whose MA will/will not be regenerated when a Boolean operation is performed on it. The voxels in affected/ unaffected regions are affected/unaffected voxels. As shown in Fig. 3, the shadowed region is an affected region if models 
                                 A
                               and 
                                 B
                               are both models with MA information, and a Boolean union operation is performed on them.


                        
                           Definition 4
                           A dilation unit refers to a set of adjacent boundary faces that are used as a dilation seed during the dilation process  [38]. Those boundary faces are usually connected and treated as a unit. Initially, each boundary face is a dilation unit. Then, the small dilation units are merged with their neighbor dilation units until every dilation unit contains adequate area.


                        
                           Definition 5
                           The dilation region of a dilation unit is the region that contains only those voxels whose touch voxels are in the dilation unit. As shown in Fig. 3, the dilation regions of various boundary faces of models 
                                 A
                               and 
                                 B
                               are separated by the purple MA segments.


                        Fig. 4
                         shows a flowchart of the proposed method, which consists of three primary parts: 
                           
                              (1)
                              The voxel map construction. For a single model, the voxel map is constructed during voxelization. For the resultant model after Boolean operations, it is obtained by reusing the maps of the operand models. The dilation units should also be established for the operand models, to improve the algorithm’s robustness  [38].

The distance update for all voxels in the affected region, using the DQDD algorithm. First, the affected region is computed. Then, the double queues are initialized, and the distance dilation is adapted for the affected region.

The MA generation. The general MA voxels are identified based on the updated distance information of the affected region first and then refined later. Finally, the new MA in the affected region is combined with the reused MA in the unaffected regions to obtain the final MA for the resultant model.

Several fundamental properties are presented in this section to support the generation of the MA based on the constructive DQDD method.


                     
                        Property 1
                        
                           The relevant boundary only contains the dual boundary of a vanished boundary when a Boolean union operation is performed. Here, the relevant boundary means that the MA and the distance information of a voxel will be changed after a Boolean union operation if its touch voxels are on the vanished boundary or the relevant boundary.
                        

As shown in Fig. 5
                     (a), suppose that model 
                        A
                      is combined with model 
                        B
                      by a Boolean union operation, and the boundary voxels 
                        C
                      and 
                        D
                      are the touch voxels of the MA voxel 
                        E
                     . If voxel 
                        C
                      vanishes in the resultant model 
                        A
                        ∪
                        B
                     , the MA voxel 
                        E
                      will lose its touch voxel 
                        C
                      on the vanished boundary and may not be an MA voxel any longer. Another boundary voxel may become the new dual boundary voxel of voxel 
                        D
                     . Therefore, the voxel on the dual boundary of the vanished boundary, such as voxel 
                        D
                     , needs to be reconsidered to find the new MA of the resultant model because of the change of its MA and distance information.

According to Property 1, the relevant boundary can be computed and used to find the local change of the MA in the resultant model after a Boolean union operation is performed. The affected region contains the relevant boundary and the voxels whose touch voxels are on the relevant boundary or the vanished boundary.


                     
                        Derivative 1
                        The irrelevant boundary is the boundary of the resultant model which is not the relevant boundary when a Boolean union operation is performed. In this application, the irrelevant boundary means that the MA and the distance information of a voxel are not changed after a Boolean union operation if its touch voxels are on the irrelevant boundary.

As shown in Fig. 5(b), suppose that model 
                        A
                      is combined with model 
                        B
                      by a Boolean union operation. Let voxels 
                        C
                      and 
                        D
                     , which are on the irrelevant boundary, be the touch voxels of the MA voxel 
                        E
                      in model 
                        A
                     . Suppose voxels 
                        C
                      and 
                        D
                      do not vanish in model 
                        A
                        ∪
                        B
                     . The MA voxel 
                        E
                      is in the unaffected region; voxels 
                        C
                      and 
                        D
                      are on the irrelevant boundary. The touch voxels 
                        C
                      and 
                        D
                      of voxel 
                        E
                      in model 
                        A
                      still exist on the boundary in 
                        A
                        ∪
                        B
                     . The boundary voxels 
                        C
                      and 
                        D
                      provide the shortest distance value for the MA voxel 
                        E
                      in model 
                        A
                      and any boundary voxel of model 
                        B
                      can only provide a longer distance value for voxels in model 
                        A
                     . Therefore, voxels 
                        C
                      and 
                        D
                      are still the touch voxels of the MA voxel 
                        E
                     , having an MA that cannot be changed by a Boolean union operation. And the distance value of a voxel does not change if its touch voxels are voxel 
                        C
                      or 
                        D
                     .

By using Derivative 1, the irrelevant boundary can be computed and used to find the unchanged MA in the resultant model after a Boolean union operation is performed. The unaffected region contains the irrelevant boundary and the voxels whose touch voxels are on the irrelevant boundary.


                     
                        Property 2
                        
                           The boundary of the resultant model except the added boundary is unprovidable when a Boolean subtraction is performed. Here, the unprovidable boundary is the boundary that does not provide new touch voxels for voxels of the changed model.
                        

As shown in Fig. 5(c), suppose that the subtraction of model 
                        B
                      from model 
                        A
                      is constructed and the boundary voxel 
                        D
                      of model 
                        A
                      remains on the boundary of model 
                        A
                        −
                        B
                     . Therefore, voxel 
                        D
                      lies on the boundary of model 
                        A
                        −
                        B
                      except the added boundary. For any voxel 
                        C
                      in model 
                        A
                        −
                        B
                     , voxel 
                        D
                      cannot provide a shorter distance value than that of the added boundary for voxels in the resultant model. Therefore, voxel 
                        D
                      and other voxels on the boundary of model 
                        A
                        −
                        B
                      except the added boundary, are on the unprovidable boundary.

Using Property 2, it can be concluded that the local distance change during a Boolean subtraction operation is only caused by the added boundary. Therefore, the unprovidable boundary is in the unaffected region. However, the whole affected region cannot be computed directly after a Boolean subtraction operation is performed. The following section describes the method to incrementally determine changes in the affected region after a Boolean subtraction operation.

The proposed method is based on the voxel model in which the voxels are stored in a voxel map. For the single model, the voxel map can be easily obtained by voxelization that can be used further to obtain the voxel map of the resultant model generated by Boolean operations. The dilation units of a model are initially established by using the method proposed in W. Gao et al.  [38] before model voxelization.

As shown in Fig. 6
                     (a) and (b), sets of adjacent small faces are combined together or merged into larger faces to constitute dilation units. Using dilation units, the influence of noise such as small faces can be suppressed and the robustness of the method is improved. For the detailed method of building dilation units of a given model, the reader can refer to W. Gao et al.  [38].

One of the most widely used models in CAD systems is the B-rep solid model. The first imperative task is to voxelize the input model. Research work has been conducted for model voxelization; the ray-tracing algorithm  [39] is adopted for this study.

To facilitate the proposed method, most of the attributes proposed in W. Gao et al.  [38] are also added for each voxel here, as tabulated in Table 1
                        . The distance value of a boundary voxel is 0 and that of the other voxels are initialized at infinity.

After voxelization, all voxels are stored in the voxel map. The voxel map is represented by a 3D matrix. The voxel in the 
                           i
                        th position on the 
                           x
                        -axis, the 
                           j
                        th position on the 
                           y
                        -axis and the 
                           k
                        th position on the 
                           z
                        -axis is mapped to 
                           voxel_map
                           
                              [
                              i
                              ]
                           
                           
                              [
                              j
                              ]
                           
                           
                              [
                              k
                              ]
                           
                        . The integers 
                           i
                           ,
                           j
                         and 
                           k
                         are used to record the voxel positions. As shown in Fig. 7
                        , the voxel map is generated for model 
                           A
                        . In the figure, the yellow voxels are boundary voxels and the gray voxels are outside voxels. The outline of model 
                           A
                         is marked with a dotted line. The origin point, voxel_map[0][0][0], of the voxel map is in the bottom left corner.

After a Boolean union/subtraction operation is performed between the voxelized operand models, the resultant model is obtained and a voxel map is constructed for it. There are some studies on methods to conduct Boolean operations between models [40–42]. In this study, the Boolean operation between the voxel models is simplified based on two assumptions since they are out of our research focus. The first is that the voxel sizes of the operand models are the same. The voxel size is defined as the edge length of the voxel. The second is that they are aligned before a Boolean operation is performed between them since the voxels in the first and second operand models may not be aligned. As shown in Fig. 8
                        (a), a Boolean union/subtraction is performed between models 
                           A
                         and 
                           B
                        . They are required to have the same voxel size and the voxels in the intersection are aligned. To align the two models, model 
                           B
                         must be moved slightly along the coordinate axes for at most half of the voxel size. When the voxel size is small, the new resultant model approximates the actual resultant model.

Then, a reuse-based method is introduced in which the voxel maps of the operand models are reused instead of rebuilding the map from scratch. The key problem is transferring the voxel information from the voxel maps of both operand models to that of the resultant model. The process is described as follows. 
                           
                              (1)
                              Create an empty voxel map that can contain all the voxels of the resultant model;

Put the information for each voxel in the operand model 
                                    A
                                  in the corresponding position of the new voxel map;

Put the information of each voxel in the operand model 
                                    B
                                  into the corresponding position of the new voxel map. For any position that contains voxels of both models, a conflict elimination rule is needed to compute the final information. There are some differences between the conflict elimination rules when the Boolean union operation and the Boolean subtraction operation are performed, which will be detailed in the following subsection.

During voxel map construction for Boolean operations, the voxels of the voxel map of one operand model, model 
                              A
                           , are copied to the corresponding position of the empty voxel map of the resultant model. The voxels of the voxel map of another operand model, model 
                              B
                           , must also be transferred to the corresponding voxel in the resultant model. The transferring rules vary and are summarized in Table 2
                           .

In Table 2, the voxel types of the resultant voxels are given for the different combinations of voxel types of voxel 
                              a
                            from model 
                              A
                            and voxel 
                              b
                            from model 
                              B
                           . How the voxel attributes are changed is also given besides the voxel type. The change modes are defined as follows: 
                              
                                 •
                                 
                                    Keep: The voxel attributes remain unchanged.


                                    Reset: The voxel attributes are reset. Here, the distance value of the body voxel is set to infinity and will be computed later using the DQDD algorithm.


                                    Null: The outside voxels have no attribute.

For example, suppose voxel 
                              a
                            and voxel 
                              b
                            are both body voxels. The resultant voxel must be outside the resultant model after a Boolean subtraction operation is performed on them. Therefore, it becomes an outside voxel whose attribute is Null.

As listed in Table 2, the voxel type is not determinate and must be further distinguished when voxels 
                              a
                            and 
                              b
                            are both boundary voxels. In that case, two rules are applied as follows.


                           
                              Rule 1
                              For the Boolean union operation, if the resultant voxel has one or more neighbor outside voxels, it is a boundary voxel. Otherwise, it is a body voxel. As shown in Fig. 8(b), voxel 
                                    A
                                  is a boundary voxel with at least one neighbor outside voxel, and voxel 
                                    C
                                  is a body voxel with no neighbor outside voxel when the operation between model 
                                    A
                                  and model 
                                    B
                                  is a Boolean union operation.


                           
                              Rule 2
                              For the Boolean subtraction operation, if the resultant voxel has one or more neighbor body voxels, it is a boundary voxel. Otherwise, it is an outside voxel. As shown in Fig. 8(b), voxel 
                                    B
                                  is a boundary voxel with at least one neighbor body voxel while voxel 
                                    C
                                  is an outside voxel with no neighbor body voxels when the operation between model 
                                    A
                                  and model 
                                    B
                                  is a Boolean subtraction operation.

After constructing the voxel map of the resultant model of a Boolean operation, the next task is to update the distance values of voxels in the affected region. The affected region is computed first.

The affected region contains the voxels that will be involved in the distance update by the DQDD algorithm. The affected regions of the different cases are shown in Fig. 9
                        .

The affected region is the entire model for the single model without the MA and distance information, as shown in Fig. 9(a). The red voxels are the affected boundary voxels whose distance values are 0, and the purple voxels are the affected body voxels whose distance values are infinity.

The affected region contains the relevant boundary and the voxels whose touch voxels are on the relevant boundary or the vanished boundary according to Property 1 and Derivative 1 when a Boolean union operation is performed. Fig. 9(b) shows the resultant model after a Boolean union operation is performed on models 
                           A
                         and 
                           B
                        . In the unaffected region, the yellow voxels are unaffected boundary voxels, and the cyan voxels are unaffected body voxels. Their distance values and MA information remain unchanged according to the definition of unaffected region. In the affected region, the red voxels are the affected boundary voxels whose distance values are 0, and the purple voxels are the affected body voxels whose distance values are infinity. Their distance values and MA information must be recomputed; thus, they are all reset. In the case that model 
                           B
                         has no MA before the Boolean union operation, the unaffected region in model 
                           B
                         must be considered as an affected region to compute its MA after the Boolean union operation.

For the Boolean subtraction operation, however, it is more difficult to obtain the affected region. Here, all the body voxels of the resultant model are considered to be in the initial affected region, and it will be refined incrementally during the distance update process. The attributes of all the voxels remain unchanged, as shown in Fig. 9(c). According to Property 2, the distance update is only caused by the added boundary. As shown in Fig. 9(c), only the added boundary in red is in the affected region. Because only a portion of the body voxels will be updated by the added boundary, the final affected region will be far smaller than the entire resultant model.

After the affected region is obtained, the DQDD algorithm is used to compute the distance values for the voxels in the affected region.

The DQDD algorithm is used to compute EDT in the affected region based on the distance dilation process  [38]. Suppose the distance value of voxel 
                              A
                            is known. The process that utilizes the touch voxel of voxel 
                              A
                            to compute the distance value of its neighbor body voxel 
                              B
                            is called a dilation operationfrom voxel 
                              A
                            to voxel 
                              B
                           . The approach of the dilation operation from voxel 
                              A
                            to voxel 
                              B
                            is as follows. (1) If the touch voxel of voxel 
                              A
                            provides the shortest distance value for voxel 
                              B
                           , it becomes the new touch voxel of voxel 
                              B
                            and the distance information for voxel 
                              B
                            is updated. (2) If the touch voxel of voxel 
                              A
                            provides the same shortest distance to the touch voxel for voxel 
                              B
                           , the touch voxel of voxel 
                              A
                            becomes another new touch voxel of voxel 
                              B
                            without replacing the old one.

In this study, the dilation process is performed based on an algorithm using double queues. The key data structures to store voxels for dilation in the DQDD algorithm are the double queues, which are comprised of the current queue and the next queue. The former is used to store the voxels from which the dilation is being conducted while the latter is used to store the voxels that will become the voxels in the current queue in the next dilation round. To restrict the voxels that dilate in the current queue, their distance values are required to be in the current range. The current range is a distance range of 
                              
                                 [
                                 
                                    current length
                                 
                                 ,
                                 
                                    current length + VS
                                 
                                 )
                              
                           , where 
                              V
                              S
                            is the value of the voxel size and the current length is a variable whose value is 
                              V
                              S
                              ×
                              
                                 round
                              
                           .

Here the reason that the queues are used is that the voxel numbers to be stored during dilation are dynamic and may be very large. It may be expensive and cannot guarantee that the arrays are set large enough for storing the voxels when the arrays are used. However, the linked lists have changeable sizes and little space cost to store the voxels. Therefore, the queues or stacks which are implemented by the linked lists can be used and the queues are chosen and used here.

To illustrate the DQDD algorithm, the pseudo-code is given in Fig. 10
                           . There are three primary steps in the DQDD algorithm: the initialization of the double queues, the distance dilation based on the double queues and the update of the double queues. The detailed process of the DQDD algorithm is discussed in the next subsection. The dilation process is the same even though the affected regions may be different for different Boolean operations.

Without loss of generality, the model in Fig. 11
                            is used as an example to illustrate the distance update process based on the DQDD algorithm. In Fig. 11(a), model 
                              B
                            is subtracted from model 
                              A
                            and the affected region is computed as introduced in Section  6.1. In the affected region, the red voxels are affected boundary voxels, whose distance values are 0, and the purple voxels are affected body voxels, whose distance values remain unchanged. The yellow voxels are unaffected surface voxels.

(1) The initialization of the double queues
                        

The current queue and next queue must both be initialized. In the initialization process, the round is set to 0, and thus the current length is 0. The current queue is in the range 
                              
                                 [
                                 0
                                 ,
                                 V
                                 S
                                 )
                              
                            and is called the initial current queue. Only the boundary voxels have distance values in the initial current range. Therefore, the initial current queue contains all the boundary voxels in the affected region, and the next queue is set to Null. As shown in Fig. 11(b), all the affected boundary voxels are put into the initial current queue. The current queue is marked in blue in the figure.

(2) The distance dilation based on the double queues
                        

After the current queue and the next queue are both initialized, they can be used to conduct the distance dilation. A voxel (voxel 
                              A
                           ) from the current queue is taken out and used to compute the distance dilation from it to its 26 neighbor affected body voxels. If the distance value of any neighbor affected body voxel is in the next range, push it into the next queue. The next range is a distance range of 
                              
                                 [
                                 
                                    current
                                 
                                 
                                 
                                    length
                                 
                                 +
                                 V
                                 S
                                 ,
                                 
                                    current
                                 
                                 
                                 
                                    length
                                 
                                 +
                                 2
                                 V
                                 S
                                 )
                              
                           . The next range will become the current range in the next round. The neighbor voxels may be face-, edge- or point-adjacent. As shown in Fig. 11(c), all the boundary voxels are removed from the current queue and the dilation operations are performed from them to their neighbor affected body voxels.

After this round of distance dilation, the distance values of some body voxels are updated from 2 to 1 and pushed into the next queue. As shown in Fig. 11(d), two voxels, shown in green, are updated and pushed into the next queue.

(3) The updates of the current queue and the next queue
                        

To continue the distance dilation, the current queue, the next queue and the dilation round must be updated, which is started by checking whether the next queue is empty. 
                              
                                 •
                                 If not, set it to be the new current queue. The previous current queue is emptied and used as the new next queue. At this time, the round increases by one so the current range also increases by 
                                       V
                                       S
                                    . Then, another dilation round, as mentioned in step 2 above, begins. As shown in Fig. 11(d) and (e), the old next queue, in green, is set as the new current queue, in blue.

Otherwise, i.e., if it is empty, stop the distance update process. At this time, all voxels have obtained their correct distance values. As shown in Fig. 11(e), the voxels in the current queue, in blue, cannot update any neighbor affected voxels. As a result, the next queue is empty, and the distance update process ends.

Using the DQDD algorithm, no voxels whose distance values need not be updated will be involved and therefore the final affected region is obtained. It can be seen from Fig. 11(f) that the final affected region only contains red affected boundary voxels and two purple affected body voxels whose distance values are updated. The final affected region is relatively small with respect to the whole region.

After the distance values of the voxels in the affected region are computed, the MA voxels in the affected region can be obtained using the distance information. In this subsection, the general process of MA voxel computation for the affected region is introduced first. Then, the methods by which the MA voxels are refined and the new generated MA voxels in the affected region are combined with the reused MA voxels to obtain the final MA of the resultant model are described.

After the distance value of each voxel in the affected region is obtained, it is used to evaluate whether the voxel is an MA voxel. The dilation-based method is adopted to compute the MA voxels  [38]. As shown in Fig. 12
                        (a), the dilation region is generated based on the distance information of each voxel. In this figure, the regions with different colors are different regions. The voxels that lie on the intersection of two different dilation regions of two different dilation units are MA voxels, shown by voxels with two colors in Fig. 12(a).

However, it is not always true that the voxels on the boundaries of the dilation regions have the same distance to two voxels on different surfaces during the dilation process. As shown in Fig. 12(a), only one touch voxel can be found for the voxels with yellow rectangles, which belong to different dilation regions and are adjacent. The MA candidate voxels generated from different dilation regions are located on different layers. This problem is the double-layer problem. It is caused by the discretization of voxelization and is an intrinsic characteristic of the discretization-based method. For this case, one layer of voxels needs to be selected as the approximate MA voxels. As shown in Fig. 12(b), only the voxel with the red rectangle is chosen as the MA voxel between dilation unit 2 and dilation unit 4.

Although most MA voxels can be computed based on the above-mentioned generation process, they are not the final MA voxels. The reason is that only the voxels that are located on the intersection of two different dilation regions are regarded as MA voxels in the dilation-based method. Therefore, the MA voxels whose touch voxels are on the same dilation unit are excluded. For this case, the final MA should be refined by adding the missed MA voxels. Without loss of generality, the dilation unit that is a curved face is discussed here.

Both touch voxels of a voxel can be located on the same curved surface according to the definition of the MA. In addition to the condition that both the touch voxels of the candidate MA voxels that provide the shortest distance values are on the same surface, the following condition must also be satisfied:


                        Additional condition: Both the lines connecting the center of a candidate MA voxel and one of the centers of its touch voxels should be co-linear to the normal line of the corresponding touch voxel on the curved surface within a given threshold. A threshold for the maximum angle error and an interval threshold for the ratio of the distances of the two touch voxels to the candidate MA voxel are given with the consideration of discretization by voxelization, which will be discussed in Section  8.3.2.

As shown in Fig. 13
                        , voxel 
                           A
                         has two touch voxels, 
                           B
                         and 
                           C
                        , on the curved surface. After the condition that line 
                           A
                           B
                         and line 
                           A
                           C
                         are equal and are co-linear to the normal line of the corresponding touch voxels on the same curved surface within the given threshold is checked, voxel 
                           A
                         is found to be an MA voxel. Similarly, voxel 
                           D
                         has two touch voxels, 
                           E
                         and 
                           F
                        . However, line 
                           D
                           E
                         and line 
                           D
                           F
                         are not co-linear to the normal line of the corresponding touch voxels on the same curved surface within the given threshold. Therefore, voxel 
                           D
                         is not an MA voxel.

The final MA of the resultant model after a Boolean operation comprises two parts: the MA reused from the operand models and the newly generated MA from the affected region. These two parts are combined to obtain the MA for the resultant model.

Because the information for the voxels of all the regions is guaranteed to be correct according to the DQDD algorithm and subsequent MA generation, the information for the voxels of the resultant model can be reused if another Boolean operation is imposed on it.

The last two sections discuss the computation of the EDT and the MA. There may be some errors in the resultant MA from the discretization of the model by voxelization. Meanwhile, the space and time complexity should also be analyzed to show its performance. In this section, the accuracy of the proposed method is analyzed from three parts: (1) the accuracy of the boundary voxels, (2) the correctness of the distance values of the voxels and (3) the accuracy of the MA voxels.

In the ray-tracing algorithm for boundary voxelization  [39], all of the boundary points are body boundary voxels. The distance between a point inside a voxel and the center of that voxel cannot be larger than 
                           
                              
                                 3
                              
                           
                           V
                           S
                           /
                           2
                        , which is also the maximum error of the boundary voxels. Therefore, the accuracy of the boundary voxels can be no more than 
                           
                              
                                 3
                              
                           
                           V
                           S
                           /
                           2
                        .

To prove that the correct distance values of voxels are obtained by the DQDD method, the following Property 3 is proposed below.


                        
                           Property 3
                           
                              For any body voxel 
                              
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                               
                              in 
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                              
                              , there must be a neighbor voxel 
                              
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                               
                              in 
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                               
                              which satisfies:  (1)  
                                 j
                                 <
                                 i
                               
                              and  (2)  the touch voxel of 
                              
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                               
                              is the same (e.g., voxel 
                              
                                 
                                    
                                       V
                                    
                                    
                                       3
                                    
                                 
                               
                              ). Here an 
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                               
                              voxel means a voxel whose distance value is in the current range in the 
                              
                                 i
                              
                              th dilation round.
                           

The proof of the property is detailed in the Appendix. Based on the DQDD method and Property 3, the distance values of all voxels from 
                           
                              
                                 R
                              
                              
                                 0
                              
                           
                         to 
                           
                              
                                 R
                              
                              
                                 i
                                 +
                                 1
                              
                           
                         can be computed correctly and then the distance values of all voxels are correct in the 
                           i
                        th dilation round as follows.

First, the boundary voxels are 
                           
                              
                                 R
                              
                              
                                 0
                              
                           
                         voxels and their touch voxels are themselves. Therefore, their distance values are correct. The current distance is 0 and the current range is 
                           
                              
                                 R
                              
                              
                                 0
                              
                           
                         in the 0th dilation round. Then, all 
                           
                              
                                 R
                              
                              
                                 0
                              
                           
                         voxels are put into the current queue and the distance dilation is performed for their neighbor voxels. All 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                         voxels have a distance-computed 
                           
                              
                                 R
                              
                              
                                 0
                              
                           
                         neighbor voxel of the same touch voxel according to Property 3. All 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                         voxels will obtain their touch voxels during the dilation of 
                           
                              
                                 R
                              
                              
                                 0
                              
                           
                         voxels; thus the distance values of all 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                         voxels are correct. Similarly, the 
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                         voxel can obtain its touch voxels in the dilation of the distance-computed 
                           
                              
                                 R
                              
                              
                                 j
                              
                           
                         voxels with the correct distance values 
                           
                              (
                              j
                              <
                              i
                              )
                           
                         in the 
                           
                              (
                              i
                              −
                              1
                              )
                           
                        th round.

Finally, all voxels of any distance range can obtain their touch voxels and their distance values correctly after all the rounds of distance dilation.

The accuracy of the MA voxels influences the quality of the generated MA. For the MA voxels on the convex boundary edges, the maximum error is 
                           
                              
                                 3
                              
                           
                           V
                           S
                           /
                           2
                        , as shown in Section  8.1. The following subsections focus on the accuracy analysis of the MA voxels whose touch voxels are on different dilation units and those whose touch voxels are on the same dilation unit.

Suppose the touch voxels of an MA voxel 
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                            are on dilation units 
                              A
                            and 
                              B
                           . After voxelization, dilation units 
                              A
                            and 
                              B
                            are approximated by points which are the centers of the boundary voxels. The actual MA of the dilation units 
                              A
                            and 
                              B
                            is marked in red (face 
                              C
                           ) in Fig. 14
                           .

As discussed in Section  7.1, voxel 
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                            in the dilation region of dilation unit 
                              A
                            is an MA voxel only if it has a face-neighbor voxel 
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                            in the dilation region of face 
                              B
                           . With the consideration that the centers of voxel 
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                            are separated by face 
                              C
                            and the distance between 
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                            is 
                              V
                              S
                           , the maximum error between the MA face 
                              C
                            and the center of the MA voxels 
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                            or voxels 
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                            is not larger than 
                              V
                              S
                           .

Suppose that the touch voxels in the same dilation unit of the MA point 
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                            are 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                            and that the distance between 
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                            (or 
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                           ) is 
                              R
                           . 
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                            is in voxel 
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                            whose center is 
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              
                              
                                 (
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 )
                              
                           , as shown in Fig. 15
                           . In this case, 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              
                              
                                 (
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 )
                              
                            can be no larger than 
                              
                                 
                                    3
                                 
                              
                              V
                              S
                              /
                              2
                           . The normal directions of 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                            on the boundary are almost the same. Denote the normal line of the boundary surface passing through 
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                            as 
                              l
                           , which is approximately parallel to the line 
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                           . The following inequality can then be obtained: 
                              
                                 (1)
                                 
                                    Dist
                                    
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       l
                                       )
                                    
                                    ⩽
                                    Dist
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       l
                                       )
                                    
                                    +
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    .
                                 
                              
                           
                        

With the consideration that 
                              Dist
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 l
                                 )
                              
                            is approximately equal to 
                              Dist
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 l
                                 )
                              
                           , inequality (1) is rewritten as follows: 
                              
                                 (2)
                                 
                                    Dist
                                    
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       l
                                       )
                                    
                                    ⩽
                                    Dist
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       l
                                       )
                                    
                                    +
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ⩽
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    ⩽
                                    
                                       
                                          3
                                       
                                    
                                    V
                                    S
                                    .
                                 
                              
                           
                        

And obviously 
                              
                                 
                                    (3)
                                    
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                       ⩾
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                       ⩾
                                       R
                                       −
                                       
                                          
                                             3
                                          
                                       
                                       V
                                       S
                                    
                                 
                                 
                                    (4)
                                    
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                       ⩽
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                       ⩽
                                       R
                                       +
                                       
                                          
                                             3
                                          
                                       
                                       V
                                       S
                                       .
                                    
                                 
                              
                           
                        

Using inequalities (2) and (3), the angle error 
                              α
                            for the additional condition of Section  7.2 of the two lines can be written as follows:
                              
                                 (5)
                                 
                                    sin
                                    α
                                    =
                                    Dist
                                    
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       l
                                       )
                                    
                                    /
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                    ⩽
                                    
                                       
                                          3
                                       
                                    
                                    V
                                    S
                                    /
                                    
                                       (
                                       R
                                       −
                                       
                                          
                                             3
                                          
                                       
                                       V
                                       S
                                       )
                                    
                                    .
                                 
                              
                           
                        

Because 
                              α
                            is very small, 
                              sin
                              α
                              ≈
                              α
                           . Therefore, the threshold for 
                              α
                            is 
                              
                                 
                                    3
                                 
                              
                              V
                              S
                              /
                              
                                 (
                                 R
                                 −
                                 
                                    
                                       3
                                    
                                 
                                 V
                                 S
                                 )
                              
                           .

Moreover, using inequalities (3) and (4), the distance ratio of the two touch voxels to the candidate MA voxel can be written as follows: 
                              
                                 
                                    (6)
                                    
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       ⩾
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   P
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   P
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   P
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   P
                                                
                                                
                                                   3
                                                
                                             
                                             +
                                             
                                                
                                                   P
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   P
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ⩾
                                       
                                          
                                             R
                                             −
                                             
                                                
                                                   3
                                                
                                             
                                             V
                                             S
                                          
                                          
                                             R
                                             +
                                             
                                                
                                                   3
                                                
                                             
                                             V
                                             S
                                          
                                       
                                    
                                 
                                 
                                    (7)
                                    
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       ⩽
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   P
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   P
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   P
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   P
                                                
                                                
                                                   3
                                                
                                             
                                             −
                                             
                                                
                                                   P
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   P
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ⩽
                                       
                                          
                                             R
                                             +
                                             
                                                
                                                   3
                                                
                                             
                                             V
                                             S
                                          
                                          
                                             R
                                             −
                                             
                                                
                                                   3
                                                
                                             
                                             V
                                             S
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

Inequalities (5)–(7) show that the thresholds of the angle error and the distance ratio are determinate when 
                              V
                              S
                            is given. Moreover, the former converges to 0 and the latter converges to 1 when 
                              V
                              S
                            is small enough. Based on the above analysis, the computational error for the MA voxels is converged.

To illustrate the efficiency of the proposed constructive DQDD method, both the space complexity and time complexity are analyzed in this subsection. Meanwhile, the proposed method is also compared with the from-scratch method. In this study, the from-scratch method means computing the MA of the resultant model directly without reusing the MAs of operand models.

The key data structures of the proposed constructive DQDD method are double queues that are two pointers pointing to the voxels in voxel maps. So the required space includes that for the voxel maps of operand models 
                              
                                 
                                    O
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                            and that for the resultant model 
                              R
                            respectively. As the space of a voxel map depends on the resolution of the model, the space complexity 
                              s
                              c
                            can be represented as:
                              
                                 (8)
                                 
                                    s
                                    c
                                    =
                                    O
                                    
                                       (
                                       N
                                       o
                                       _
                                       
                                          
                                             x
                                          
                                          
                                             O
                                             1
                                          
                                       
                                       ⋅
                                       N
                                       o
                                       _
                                       
                                          
                                             y
                                          
                                          
                                             O
                                             1
                                          
                                       
                                       ⋅
                                       N
                                       o
                                       _
                                       
                                          
                                             z
                                          
                                          
                                             O
                                             1
                                          
                                       
                                       +
                                       N
                                       o
                                       _
                                       
                                          
                                             x
                                          
                                          
                                             O
                                             2
                                          
                                       
                                       ⋅
                                       N
                                       o
                                       _
                                       
                                          
                                             y
                                          
                                          
                                             O
                                             2
                                          
                                       
                                       ⋅
                                       N
                                       o
                                       _
                                       
                                          
                                             z
                                          
                                          
                                             O
                                             2
                                          
                                       
                                       +
                                       N
                                       o
                                       _
                                       
                                          
                                             x
                                          
                                          
                                             R
                                          
                                       
                                       ⋅
                                       N
                                       o
                                       _
                                       
                                          
                                             y
                                          
                                          
                                             R
                                          
                                       
                                       ⋅
                                       N
                                       o
                                       _
                                       
                                          
                                             z
                                          
                                          
                                             R
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        

Here, 
                              N
                              o
                              _
                              x
                              ,
                              N
                              o
                              _
                              y
                            and 
                              N
                              o
                              _
                              z
                            are the voxel numbers of the bounding box of the corresponding model on axes 
                              x
                              ,
                              y
                            and 
                              z
                            for operand models 
                              
                                 
                                    O
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                            and resultant model respectively. During the constructive design process, a serial of constructive Boolean operations are performed and the incremental MA is generated. In this case, the space complexity can keep constant since both the voxel maps of the old operand models can be deleted in the next Boolean operation. Therefore, the space complexity of the proposed constructive method is stable.

The time cost of the proposed DQDD method is comprised of the following four parts: time of voxelization 
                              
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                           , voxel map construction 
                              
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           , distance update 
                              
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                            and MA generation 
                              
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       4
                                    
                                 
                                 )
                              
                           .

For a model 
                              M
                           , the time cost of voxelization depends on the resolution of model 
                              M
                           . It can be described as: 
                              
                                 (9)
                                 
                                    
                                       
                                          T
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    N
                                    o
                                    _
                                    
                                       
                                          x
                                       
                                       
                                          M
                                       
                                    
                                    ⋅
                                    N
                                    o
                                    _
                                    
                                       
                                          y
                                       
                                       
                                          M
                                       
                                    
                                    ⋅
                                    N
                                    o
                                    _
                                    
                                       
                                          z
                                       
                                       
                                          M
                                       
                                    
                                    ⋅
                                    
                                       
                                          T
                                       
                                       
                                          v
                                       
                                    
                                    .
                                 
                              
                           
                        

Here, 
                              
                                 
                                    T
                                 
                                 
                                    v
                                 
                              
                            refers to the time cost of voxelization for a single voxel.

Similarly, the time cost of voxel map construction depends on the voxel numbers of the operand models 
                              
                                 
                                    O
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                            which is described as: 
                              
                                 (10)
                                 
                                    
                                       
                                          T
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       (
                                       N
                                       o
                                       _
                                       
                                          
                                             x
                                          
                                          
                                             O
                                             1
                                          
                                       
                                       ⋅
                                       N
                                       o
                                       _
                                       
                                          
                                             y
                                          
                                          
                                             O
                                             1
                                          
                                       
                                       ⋅
                                       N
                                       o
                                       _
                                       
                                          
                                             z
                                          
                                          
                                             O
                                             1
                                          
                                       
                                       +
                                       N
                                       o
                                       _
                                       
                                          
                                             x
                                          
                                          
                                             O
                                             2
                                          
                                       
                                       ⋅
                                       N
                                       o
                                       _
                                       
                                          
                                             y
                                          
                                          
                                             O
                                             2
                                          
                                       
                                       ⋅
                                       N
                                       o
                                       _
                                       
                                          
                                             z
                                          
                                          
                                             O
                                             2
                                          
                                       
                                       )
                                    
                                    ⋅
                                    
                                       
                                          T
                                       
                                       
                                          c
                                       
                                    
                                    .
                                 
                              
                           
                        

Here, 
                              
                                 
                                    T
                                 
                                 
                                    c
                                 
                              
                            means the time cost of voxel map construction for a single voxel.

For the distance update time, it is only related to the affected voxels. Each of them will be put into the current queue and perform dilation operations to its neighbor voxels once and only once. As a result, the time cost of distance update is: 
                              
                                 (11)
                                 
                                    
                                       
                                          T
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    26
                                    N
                                    o
                                    _
                                    v
                                    o
                                    x
                                    e
                                    
                                       
                                          l
                                       
                                       
                                          a
                                          f
                                          f
                                       
                                    
                                    ⋅
                                    
                                       
                                          T
                                       
                                       
                                          d
                                       
                                    
                                    .
                                 
                              
                           
                        

Here, 
                              N
                              o
                              _
                              v
                              o
                              x
                              e
                              
                                 
                                    l
                                 
                                 
                                    a
                                    f
                                    f
                                 
                              
                            means the number of affected voxels in the resultant model and 
                              
                                 
                                    T
                                 
                                 
                                    d
                                 
                              
                            means the time cost of dilation operations from a voxel to one of its 26 neighbor voxels.

During MA generation, only the affected voxels will be involved. As a result, the time complexity of MA generation is as follows: 
                              
                                 (12)
                                 
                                    
                                       
                                          T
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    N
                                    o
                                    _
                                    v
                                    o
                                    x
                                    e
                                    
                                       
                                          l
                                       
                                       
                                          a
                                          f
                                          f
                                       
                                    
                                    ⋅
                                    
                                       
                                          T
                                       
                                       
                                          g
                                       
                                    
                                    .
                                 
                              
                           
                        

Here, 
                              
                                 
                                    T
                                 
                                 
                                    g
                                 
                              
                            means the time cost of MA generation for a single voxel.

Based on the above analysis, the time cost 
                              
                                 
                                    T
                                 
                                 
                                    c
                                    o
                                    n
                                 
                              
                            of the proposed constructive method is given as follows using equalities (9)–(12): 
                              
                                 (13)
                                 
                                    
                                       
                                          T
                                       
                                       
                                          c
                                          o
                                          n
                                       
                                    
                                    =
                                    N
                                    o
                                    _
                                    
                                       
                                          x
                                       
                                       
                                          O
                                          2
                                       
                                    
                                    ⋅
                                    N
                                    o
                                    _
                                    
                                       
                                          y
                                       
                                       
                                          O
                                          2
                                       
                                    
                                    ⋅
                                    N
                                    o
                                    _
                                    
                                       
                                          z
                                       
                                       
                                          O
                                          2
                                       
                                    
                                    ⋅
                                    
                                       
                                          T
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    
                                       (
                                       N
                                       o
                                       _
                                       
                                          
                                             x
                                          
                                          
                                             O
                                             1
                                          
                                       
                                       ⋅
                                       N
                                       o
                                       _
                                       
                                          
                                             y
                                          
                                          
                                             O
                                             1
                                          
                                       
                                       ⋅
                                       N
                                       o
                                       _
                                       
                                          
                                             z
                                          
                                          
                                             O
                                             1
                                          
                                       
                                       +
                                       N
                                       o
                                       _
                                       
                                          
                                             x
                                          
                                          
                                             O
                                             2
                                          
                                       
                                       ⋅
                                       N
                                       o
                                       _
                                       
                                          
                                             y
                                          
                                          
                                             O
                                             2
                                          
                                       
                                       ⋅
                                       N
                                       o
                                       _
                                       
                                          
                                             z
                                          
                                          
                                             O
                                             2
                                          
                                       
                                       )
                                    
                                    ⋅
                                    
                                       
                                          T
                                       
                                       
                                          c
                                       
                                    
                                    +
                                    N
                                    o
                                    _
                                    v
                                    o
                                    x
                                    e
                                    
                                       
                                          l
                                       
                                       
                                          a
                                          f
                                          f
                                       
                                    
                                    
                                       (
                                       26
                                       
                                          
                                             T
                                          
                                          
                                             d
                                          
                                       
                                       +
                                       
                                          
                                             T
                                          
                                          
                                             g
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        

To further compare the time cost between the proposed constructive method and the from-scratch method, the time cost 
                              
                                 
                                    T
                                 
                                 
                                    f
                                    s
                                 
                              
                            for the latter can be obtained similarly by using equalities (9), (11) and (12) as follows:
                              
                                 (14)
                                 
                                    
                                       
                                          T
                                       
                                       
                                          f
                                          s
                                       
                                    
                                    =
                                    N
                                    o
                                    _
                                    
                                       
                                          x
                                       
                                       
                                          R
                                       
                                    
                                    ⋅
                                    N
                                    o
                                    _
                                    
                                       
                                          y
                                       
                                       
                                          R
                                       
                                    
                                    ⋅
                                    N
                                    o
                                    _
                                    
                                       
                                          z
                                       
                                       
                                          R
                                       
                                    
                                    ⋅
                                    
                                       
                                          T
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    N
                                    o
                                    _
                                    v
                                    o
                                    x
                                    e
                                    
                                       
                                          l
                                       
                                       
                                          a
                                          l
                                          l
                                       
                                    
                                    ⋅
                                    
                                       (
                                       26
                                       
                                          
                                             T
                                          
                                          
                                             d
                                          
                                       
                                       +
                                       
                                          
                                             T
                                          
                                          
                                             g
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        

Here, 
                              N
                              o
                              _
                              v
                              o
                              x
                              e
                              
                                 
                                    l
                                 
                                 
                                    a
                                    l
                                    l
                                 
                              
                            means the number of all the voxels in the resultant model.

With the consideration that the voxelization is much more expensive than other operations, the time complexity can be compared between the voxelization time approximately. The second operand model is usually smaller than the resultant model during the modeling process and thus the time complexity of the proposed method is smaller.

In another case, suppose that all input models are already voxelized and 
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                            is not needed. Voxel map construction is usually much shorter than other operations so 
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                            can be ignored. Therefore, the time complexities of these two methods can be compared between their involved voxel numbers. The affected region is usually much smaller than the whole model and thus the time complexity of the proposed method is much smaller in this case. The experiments in Section  9 will demonstrate the conclusion.

The proposed constructive DQDD method was implemented with visual studio 2008 and the geometric modeling kernel ACIS 17.0. To demonstrate the efficacy and efficiency of the proposed method, three groups of experiments are conducted as follows. The first group applies the proposed method incrementally during the modeling process from scratch. The second group applies the proposed method when different small modifications are imposed on complicated models with MAs. The third group applies the proposed method when two complicated full models with MA and distance information are combined with a Boolean union operation. For each experiment, the computational time and the number of involved voxels of the proposed method and those of the from-scratch method are compared. It is adopted for comparison because it is a general-purpose method without much limitation for the models. Without loss of generality, the resolution of the examples is set to 100. In addition, the correctness of the proposed constructive method is also verified by comparing its MA with that generated by the from-scratch method.

The example shown in Fig. 16
                         illustrates the sequence of Boolean operations for modeling from scratch. For each step, the newly added or subtracted part is marked with a red circle in the left figure. In the right figure, the red voxels are the newly generated MA voxels, while the brown voxels are the reused MA voxels from the previous steps. The example is devised carefully to involve all the possible cases, while different shapes of modeling primitives are utilized. The construction process is described as follows.


                        
                           
                              (1)
                              The initial model is voxelized, and the initial MA is obtained, as shown in Fig. 16(a).

A small “V” part is subtracted from the model. The resultant MA is shown in Fig. 16(b). The resultant MA is unchanged since the faces of the “V” part are very small and thus combined into the near dilation unit, which illustrates the robustness of the method.

A cylinder is subtracted from the model, and the modified MA for the resultant model is obtained as shown in Fig. 16(c). Another two cylinders are similarly subtracted, as shown in Fig. 16(d)–(e).

A cuboid is subtracted and the modified MA for the resultant model is shown in Fig. 16(f). Similarly, another cuboid is subtracted, as shown in Fig. 16(g).

A model with an MA is reused and united with the existing model. The modified MA for the resultant model is shown in Fig. 16(h).

A model without the MA information is united with the existing model to generate the final model, as shown in Fig. 16(i).

The computational time is recorded to illustrate the performance of the proposed constructive method in comparison with the from-scratch method. The time cost includes the cost of voxelization, voxel map construction, dilation in the affected region and MA generation. The voxelization time of a model will be zero if it already has an MA.

The detailed computational time and the number of involved voxels for each step are given in Table 3
                         and Fig. 16. The data show that the constructive method outperforms the from-scratch method dramatically. Step 
                           h
                         shows the most improved efficiency of all the steps. The reason is that the time-consuming voxelization is not needed in this step since both of the operand models are already voxelized. Even for the worst step, i.e., step 
                           f
                        , the time saved is near 80%. The most expensive step of the from-scratch method is voxelization. Moreover, it can be seen from Table 3 that the constructive method is still faster than the from-scratch method even if the voxelization time is not considered for both methods. The detailed percentage of the computational cost and the number of affected voxels between the proposed method and the from-scratch method are shown in Table 4
                        . These data more clearly illustrate the performance of the proposed method.

The data in Tables 3–4 and Fig. 17
                         also show that the time cost of the constructive method and the from-scratch method have different proportional trends with the complexity of the input model. After a Boolean operation, the resultant model becomes more complicated. The time cost of the from-scratch method in every step is higher than that of the earlier step. However, the time cost of the constructive method is not proportional to the complexity of the model. The reuse of existing MA and distance information impacts the computational efficiency of the MA generation strongly, especially for complicated models.

In this experiment, small modifications are imposed on the complicated models that have the MA and distance information for design purposes. Fig. 18
                         shows three complicated models with some small modifications (with small red circles). Without loss of generality, the influence of one modification by a Boolean union operation and two modifications by Boolean subtraction operations is discussed. The total computational time and the involved voxels are given in Table 5
                        . The data in the table show that the computational efficiency is improved dramatically when small modifications are imposed on the complicated models. This conclusion does not hold for some simple models. For example, the MA will be changed dramatically when a small hole passing through is subtracted from a sphere. However, the computational time of the proposed constructive method is still likely to be better for simple models than that for from-scratch methods since the affected region is smaller than the whole region. Moreover, engineering design models are usually complicated. Therefore, the proposed method is very useful for some engineering applications, such as finite element analysis and simulation-driven designs.

In this experiment, two voxelized models with MA and distance information are united to obtain a new complicated model. Three pairs of models are shown in Fig. 19
                        . The total computational time and involved voxels of the resultant model are given in Table 6
                        . The data in the table show that if two models have been voxelized and contain MA and distance information, the computational time and the number of voxelized voxels of the proposed method will be far less than those of the from-scratch method. It will be even better when the two models are more complicated.

@&#CONCLUSIONS@&#

An efficient constructive MA generation method for solid models is proposed in this study. The major contributions include: 
                        
                           (1)
                           An approach to generating the MA efficiently is proposed. With this method, only the MA of the affected region needs to be regenerated for the resultant model based on the reuse of the MAs of the operand models. In most cases, the computational efficiency can be improved dramatically.

A novel method that is based on the double-queue representation of the voxels is devised deliberately to efficiently support the constructive generation of the MA when Boolean operations are performed. With the help of the double queues, the minimum affected region can be obtained automatically.

Some properties of the MA are developed to support the proposed constructive MA generation method.

Future work will proceed in three directions. The first is to consider the influence of voxel size and multi-resolutional voxels. Based on those results, Boolean operations on unaligned voxel models will be considered. The second is to extend the method for parameter modifications on 3D models. The third is to extend the method to other types of 3D models, such as the meshing models that are widely used in engineering and animation, etc.

@&#ACKNOWLEDGMENTS@&#

The authors are appreciated for the support from NSF of China (61173126, 61163016), the 863 High-Technology Project of China (2011AA100804) and Zhejiang Provincial Natural Science Foundation of China (LZ12F02001).

For an arbitrary body voxel 
                        
                           
                              V
                           
                           
                              1
                           
                        
                        
                        
                           (
                           voxel_map
                           
                              [
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ]
                           
                           
                              [
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              ]
                           
                           
                              [
                              
                                 
                                    z
                                 
                                 
                                    1
                                 
                              
                              ]
                           
                           )
                        
                     , its center can be represented by 
                        
                           
                              P
                           
                           
                              1
                           
                        
                        
                        
                           (
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              +
                              0.5
                              )
                           
                           V
                           S
                           ,
                           
                              (
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              +
                              0.5
                              )
                           
                           V
                           S
                           ,
                           
                              (
                              
                                 
                                    z
                                 
                                 
                                    1
                                 
                              
                              +
                              0.5
                              )
                           
                           V
                           S
                           )
                        
                     . One of its neighbor voxels is voxel 
                        
                           
                              V
                           
                           
                              2
                           
                        
                        
                        
                           (
                           voxel_map
                           
                              [
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ]
                           
                           
                              [
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              ]
                           
                           
                              [
                              
                                 
                                    z
                                 
                                 
                                    2
                                 
                              
                              ]
                           
                           )
                        
                      with the center 
                        
                           
                              P
                           
                           
                              2
                           
                        
                        
                        
                           (
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              +
                              0.5
                              )
                           
                           V
                           S
                           ,
                           
                              (
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              +
                              0.5
                              )
                           
                           V
                           S
                           ,
                           
                              (
                              
                                 
                                    z
                                 
                                 
                                    2
                                 
                              
                              +
                              0.5
                              )
                           
                           V
                           S
                           )
                        
                     . Their common touch 
                        
                           
                              V
                           
                           
                              3
                           
                        
                        
                        
                           (
                           voxel_map
                           
                              [
                              
                                 
                                    x
                                 
                                 
                                    3
                                 
                              
                              ]
                           
                           
                              [
                              
                                 
                                    y
                                 
                                 
                                    3
                                 
                              
                              ]
                           
                           
                              [
                              
                                 
                                    z
                                 
                                 
                                    3
                                 
                              
                              ]
                           
                           )
                        
                      can be described with the center 
                        
                           
                              P
                           
                           
                              3
                           
                        
                        
                        
                           (
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    3
                                 
                              
                              +
                              0.5
                              )
                           
                           V
                           S
                           ,
                           
                              (
                              
                                 
                                    y
                                 
                                 
                                    3
                                 
                              
                              +
                              0.5
                              )
                           
                           V
                           S
                           ,
                           
                              (
                              
                                 
                                    z
                                 
                                 
                                    3
                                 
                              
                              +
                              0.5
                              )
                           
                           V
                           S
                           )
                        
                     . Obviously, Property 3 must hold if the following inequality (15) is correct. 
                        
                           (15)
                           
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                              ⩽
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                              −
                              V
                              S
                              .
                           
                        
                     
                  

It can be rewritten as: 
                        
                           (16)
                           
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   z
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ⩽
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   z
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              −
                              1
                              .
                           
                        
                     
                  

Without loss of generality, set 
                        
                           
                              x
                           
                           
                              3
                           
                        
                        ⩽
                        
                           
                              x
                           
                           
                              1
                           
                        
                        ;
                        
                           
                              y
                           
                           
                              3
                           
                        
                        ⩽
                        
                           
                              y
                           
                           
                              1
                           
                        
                        ;
                        
                           
                              z
                           
                           
                              3
                           
                        
                        ⩽
                        
                           
                              z
                           
                           
                              1
                           
                        
                     . And neighbor voxel 
                        
                           
                              V
                           
                           
                              2
                           
                        
                      is chosen from all neighbor voxels to satisfy: 
                        
                           (17)
                           
                              
                                 
                                    x
                                 
                                 
                                    3
                                 
                              
                              ⩽
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ⩽
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    y
                                 
                                 
                                    3
                                 
                              
                              ⩽
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              ⩽
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    z
                                 
                                 
                                    3
                                 
                              
                              ⩽
                              
                                 
                                    z
                                 
                                 
                                    2
                                 
                              
                              ⩽
                              
                                 
                                    z
                                 
                                 
                                    1
                                 
                              
                              .
                           
                        
                     
                  

As voxel 
                        
                           
                              V
                           
                           
                              2
                           
                        
                      is a neighbor voxel of voxel 
                        
                           
                              V
                           
                           
                              1
                           
                        
                     , coordinate of 
                        
                           
                              P
                           
                           
                              2
                           
                        
                      can be rewritten as 
                        
                           (
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              −
                              a
                              )
                           
                           V
                           S
                           ,
                           
                              (
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              −
                              b
                              )
                           
                           V
                           S
                           ,
                           
                              (
                              
                                 
                                    z
                                 
                                 
                                    1
                                 
                              
                              −
                              c
                              )
                           
                           V
                           S
                           )
                        
                     . Here, 
                        a
                        ,
                        b
                      and 
                        c
                      are all 0 or 1 and they cannot be 0 at the same time since 
                        
                           
                              P
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              P
                           
                           
                              2
                           
                        
                      are not the same point.

Similarly, inequality (16) can be rewritten as: 
                        
                           (18)
                           
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             a
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             b
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             c
                                             −
                                             
                                                
                                                   z
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ⩽
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   z
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              −
                              1
                              .
                           
                        
                     
                  

Without loss of generality, 
                        a
                        ,
                        b
                      and 
                        c
                      cannot be 0 at the same time. Suppose 
                        a
                      is 1, then 
                        
                           (19)
                           
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             a
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             b
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             c
                                             −
                                             
                                                
                                                   z
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ⩽
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             1
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   z
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              .
                           
                        
                      Observe that 
                        
                           (20)
                           
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             1
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   z
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ⩽
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   z
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              −
                              1
                              .
                           
                        
                     
                  

Inequality (18) can be deduced from inequalities (19) and (20) and then inequalities (15) and (16) hold.

@&#REFERENCES@&#

