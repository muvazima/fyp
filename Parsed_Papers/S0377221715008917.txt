@&#MAIN-TITLE@&#A branch-and-cut algorithm for the truck dock assignment problem with operational time constraints

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a new model and motivate our choices.


                        
                        
                           
                           Several classes of valid inequalities have been identified.


                        
                        
                           
                           The dimension of associated polytope and some classes of facet-defining inequalities have been identified.


                        
                        
                           
                           A branch-and-cut algorithm has been developed.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Truck dock assignment

Polytope

Dimension

Valid inequalities

Facet-defining inequalities

@&#ABSTRACT@&#


               
               
                  In this paper, we address a truck dock assignment problem with operational time constraint which has to be faced in the management of cross docks. More specifically, this problem is the subproblem of more involved problems with additional constraints and criteria. We propose a new integer programming model for this problem. The dimension of the polytope associated with the proposed model is identified by introducing a systematic way of generating linearly independent feasible solutions. Several classes of valid inequalities are also introduced. Some of them are proved to be facet-defining. Then, exact separation algorithms are described for separating cuts for classes with exponential number of constraints, and an efficient branch-and-cut algorithm solving real-life size instances in a reasonable time is provided. In most cases, the optimal solution is identified at the root node without requiring any branching.
               
            

@&#INTRODUCTION@&#

Cross-docks play a key role in modern distribution systems. They are logistic terminals where deliveries are unloaded from inbound trucks, sorted and moved from one dock to another—within the cross dock—until they are finally loaded on the outbound trucks towards the next destination within the distribution network. Cross docks are often used to perform rapid transhipment activities and usually do not carry out any further processing of the shipments (see Fig. 1
                     ). An important problem in a cross dock is the dock assignment of inbound and outbound trucks, given the characteristics of cross dock (such as layout, installations, resources, capacity, etc.) and those of clients (such as time windows within which the trucks are present at cross dock, origin–destination volumes of flow, etc.).

In the truck dock assignment problem, given the time windows defined by the arrival and the departure times of every truck (as well as capacity of the cross dock), we aim at finding an optimal assignment of the trucks to the docks in such a way that the number of deliveries being processed is maximized. A delivery from an inbound truck that has not succeeded to leave the cross dock using an outbound truck in the same day, leads to impose some holding costs at the cross dock until being delivered to its destination in the next call of the outbound truck (which is usually the next day). Every inbound truck usually has shipments to several different destinations. Whether an inbound truck will be able to deliver deliveries to an outbound truck via cross dock depends on, (1) feasibility of time windows (i.e. the outbound truck does not leave before the inbound arrives), (2) the arrival time of incoming truck plus the dock-to-dock transfer time within the cross dock, which should not exceed the departure time of the outbound truck, and (3) the available capacity at the cross-dock during the visit time window of the inbound trucks.

As mentioned, the transfer of shipments from inbound truck i to outbound truck j depends on the transfer time between the two docks k and l where i and j, respectively, are assigned. A sub-optimal solution to the truck dock assignment problem can cause significant waiting times for other arriving trucks, which will eventually miss the same-day-service of their shipment. However, an optimal assignment can minimize the intra cross dock (i.e. inter-dock) operational cost, including the costs for drivers and vehicles that carry out in-house pickups and deliveries and also the handling costs for sorting and consolidating cargo. In presence of capacity, the total volume of deliveries present at the cross dock at every point in time is restricted.

In this paper, we propose a new model for the dock assignment problem. Then, we identify the dimension of the corresponding polytope. We introduce several classes of valid inequalities and prove that some of those valid inequalities are in fact facet-defining ones. We propose then separation procedures which are embedded in an efficient branch-and-cut algorithm. This method is capable of providing optimal solution to real-life size instances of the problem in a reasonable computational time.

The paper is structured as follows. In Section 2, we review the relevant literature on the cross dock management. In Section 3, we introduce our mathematical model and discuss the relation with a related presented in Miao, Lim, and Ma (2009). Section 4 is reserved to present some classes of valid inequalities for the problem. Section 4.2 reports some polyhedral properties. Section 5 describes the proposed solution method and Section 6 reports some computational results and analysis. Section 7 summarizes the work, presents a conclusion and pinpoints some further research directions. Some elaborated details are also provided in Appendix A.

@&#LITERATURE REVIEW@&#

The truck dock assignment problem, as many other optimization problems arising in cross dock management, has been receiving an increasing attention during the last decade. This is evidenced by several recent surveys (Boysen & Fliedner, 2010; Gu, Goetschalckx, & McGinnis, 2007; Van Belle, Valckenaers, & Cattrysse, 2012) devoted to operations management and to scheduling in cross docks.


                     Lim, Miao, Rodrigues, and Xu (2005a) studied the transshipment problem with supplier and customer time windows where flow is constrained by transportation schedules and warehouse capacities with the objective to minimize total cost, including inventory costs. Tsui and Chang (1992) proposed a bilinear model for the truck dock assignment of a shipping company. Lim, Ma, and Miao (2006b) proposed a tabu search as well as a CPLEX-based GA for the same problem as in Lim et al. (2005a). Miao et al. (2009) proposed an integer programming formulation for the truck dock assignment problem in which the cross dock capacity over the time planning horizon is taken into account explicitly over the time-horizon. Two meta-heuristics based on tabu search and on genetic algorithms are proposed. Recently, Miao, Cai, and Xu (2014) proposed a different model and an adaptive tabu search algorithm to address the uncapacitated case. Berghman, Leus, and Spieksma (2014) presented a model for a dock assignment problem. They assumed that the trailers need to be assigned to the gates for a given period of time for loading or unloading activities. The parking lot is used as a buffer zone. Transportation between the parking lot and the gates is performed by tractors owned by the terminal operator. They examine several integer programming formulations. Cohen and Keren (2009) discussed the existing approaches and proposed a formulation and a new heuristic for assigning cross dock doors to trailers. Deshpande, Yalcin, Zayas-Castro, and Herrera (2007) introduced a dock assignment heuristic. They integrated the tactical level decision-making process and the operational aspects in LTL terminals to evaluate the performance of the system. Liao, Egbelu, and Chang (2013) studied the problem of determining simultaneously the dock assignment and the sequence of inbound trucks. They consider a multi-door cross docking operation with the objective to minimize the total weighted tardiness, under a fixed outbound truck departure schedule. The problem is solved by six different metaheuristic algorithms, which include simulated annealing, tabu search, ant colony optimization, differential evolution, and two hybrid differential-evolution algorithms. Shakeri, Low, and Li (2008) addressed the two problems of truck scheduling and truck-to-door assignment jointly in a mixed integer programming model. Yu and Egbelu (2008) seek the best truck docking or scheduling sequence for both inbound and outbound trucks to minimize the total operation time when a temporary storage buffer is located to hold items temporarily at the shipping dock. In this work, the product assignment to the trucks and the docking sequences of the inbound and outbound trucks are determined simultaneously. Boloori Arabani, Fatemi Ghomi, and Zandieh (2011) proposed meta-heuristics to find the best sequence of inbound and outbound trucks, so that the objective, which is minimizing the total operation time called makespan, can be satisfied. Arabani, Ghomi, and Zandieh (2010) deal with scheduling problem of inbound and outbound trailers in a cross docking system according to just-in-time approach.


                     Ou, Hsu, and Li (2010) dealt with air cargo and formulated the problem as a time-indexed integer programming problem. They showed that even with limited number of unloading docks at the terminal, the problem is quite difficult to solve. They also proposed an exact solution procedure to determine an optimal unloading sequence for the shipments carried by each truck, together with a Lagrangian relaxation-based heuristic for assigning the trucks to the docks and determining the trucks arrival time. Some similar models with application in airport gate assignment have been reported in Babic, Teodorovic, and Tošic (1984), Ding, Lim, Rodrigues, and Zhu (2004), Ding, Lim, Rodrigues, and Zhu (2005), Oh, Hwang, Cha, and Lee (2006) and Lim, Rodrigues, and Zhu (2005b). Agustina, Lee, and Piplani (2010) address the distribution planning problem of cross docking network, considering transshipment possibility among the cross docks and tardiness permission for some pickups. The problem is formulated as a bi-objective integer programming model minimizing the total transportation, holding costs and the total tardiness. A heuristic procedure to construct an initial solution and three metaheuristics are proposed. Kim, Feron, and Clarke (2013) considered a problem of minimizing the total cost of the multi-cross dock distribution network, including transportation cost, inventory handling cost and penalty cost. They proposed an adaptive tabu search and an adaptive genetic algorithm to solve instances of the problem efficiently.

An approach based on the discrete-event simulation including an enhanced robust design technique was proposed by Shi, Liu, Shang, and Cui (2013). The authors addressed a multi-response optimization problem inherent in logistics management. They aimed at designing a robust configuration for a cross-docking distribution center so that the system is insensitive to the disturbances of supply uncertainty and provides steady parts supply to downstream assembly plants.

Last, Buijs, Vis, and Carlo (2014) proposed a framework specifying the interdependencies between different cross-docking problem aspects and a new general classification scheme for the cross-docking research based on the inputs and outputs for each problem aspect. They also highlighted the importance of synchronization in cross-docking networks and described two real-life illustrative problems that are not yet addressed in the literature.

We address the truck dock assignment problem (TDAP) as defined in Lim, Ma, and Miao (2006a) and Miao et al. (2009). In the TDAP, the assignment of inbound and outbound trucks has to be determined in such a way that the total operational cost and the penalty resulting from the total volume of unfulfilled shipments is minimized and the capacity constraint of the cross-dock and the time-windows constraints associated to vehicles are satisfied. More specifically, we assume that n trucks arrives at and/or departs from the cross dock. A time-window [ai, di
                     ] is associated with truck i. It corresponds to the time interval during which the truck is docked at the cross-dock. δij
                      is set to 1 if and only if truck i departs no later than truck j arrives and to 0 otherwise. Each inbound truck is loaded with a number of pallets with different destinations. fij
                      denotes the number of pallets to be transferred from truck i to truck j (1 ≤ i, j ≤ n). The cross-dock has m docks and a capacity of C pallets, which can be hold at each time period. The time requires to transfer pallets from dock k to dock l (1 ≤ k, l ≤ m) is denoted by tkl
                     . The operational cost per unit of time between docks k and l (1 ≤ k, l ≤ m) is denoted by ckl
                     . Last, pij
                      is the penalty cost per pallet not transferred from truck i to truck j (1 ≤ i, j ≤ n).

To model the TDAP, we define the following decision variables. For 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           
                           n
                           ,
                        
                      and 
                        
                           k
                           =
                           1
                           ,
                           …
                           ,
                           
                           m
                           ,
                        
                      let yik
                      be a binary variable equal to 1 if and only if truck i is assigned to dock k. For 
                        
                           i
                           ,
                           j
                           =
                           1
                           ,
                           …
                           ,
                           
                           n
                           ,
                        
                      and 
                        
                           k
                           ,
                           l
                           =
                           1
                           ,
                           …
                           ,
                           
                           m
                           ,
                        
                      let zijkl
                      be a binary variable equal to 1 if and only if pallets of truck i which is assigned to dock k are transferred to truck j which is assigned to dock l.

As in Miao et al. (2009), we made the following assumptions:

                        
                           (i)
                           
                              fij
                               ≥ 0 if and only if dj
                               ≥ ai
                              , ∀i, j ≠ i, otherwise 
                                 
                                    
                                       f
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    0
                                 
                              . In other words, truck i transfer some cargo to truck j if and only if truck j departs no earlier than truck i arrives;


                              ai
                               < di
                               (1 ≤ i ≤ n) which means that for each truck, the arrival time must be strictly smaller than its departure time;


                              n > m which means that a priori the cross-dock is congested;

capacity C is defined as follows: when truck i comes, then it consumes 
                                 
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       m
                                    
                                    
                                       ∑
                                       
                                          l
                                          =
                                          1
                                       
                                       m
                                    
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       f
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       z
                                       
                                          i
                                          j
                                          k
                                          l
                                       
                                    
                                 
                               units of capacity. On the other hand, when truck j leaves, then 
                                 
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       m
                                    
                                    
                                       ∑
                                       
                                          l
                                          =
                                          1
                                       
                                       m
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       f
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       z
                                       
                                          i
                                          j
                                          k
                                          l
                                       
                                    
                                 
                               units of capacity are released;

sort all the ai
                               and di
                               in an increasing order, and let 
                                 
                                    
                                       t
                                       r
                                    
                                    
                                    
                                       (
                                       r
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       
                                       2
                                       n
                                       )
                                    
                                 
                               correspond to these 2n numbers such that 
                                 
                                    
                                       t
                                       1
                                    
                                    ≤
                                    
                                       t
                                       2
                                    
                                    ≤
                                    ⋯
                                    ≤
                                    
                                       t
                                       
                                          2
                                          n
                                       
                                    
                                 
                              . According to this assumption, we can easily formulate the capacity constraints in the model given below.

Then the TDAP can be stated as :

(TDAP)

                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          m
                                          i
                                          n
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             c
                                             
                                                k
                                                l
                                             
                                          
                                          
                                             t
                                             
                                                k
                                                l
                                             
                                          
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                p
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                f
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   m
                                                
                                                
                                                   ∑
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   m
                                                
                                                
                                                   z
                                                   
                                                      i
                                                      j
                                                      k
                                                      l
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                       
                                    
                                    
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             y
                                             
                                                i
                                                k
                                             
                                          
                                          ≤
                                          1
                                          ,
                                          
                                          ∀
                                          i
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                l
                                             
                                          
                                          ≤
                                          
                                             y
                                             
                                                i
                                                k
                                             
                                          
                                          ,
                                          
                                          ∀
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                          ,
                                          l
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                l
                                             
                                          
                                          ≤
                                          
                                             y
                                             
                                                j
                                                l
                                             
                                          
                                          ,
                                          
                                          ∀
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                          ,
                                          l
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             y
                                             
                                                i
                                                k
                                             
                                          
                                          +
                                          
                                             y
                                             
                                                j
                                                k
                                             
                                          
                                          ≤
                                          1
                                          +
                                          
                                             δ
                                             
                                                i
                                                j
                                             
                                          
                                          +
                                          
                                             δ
                                             
                                                j
                                                i
                                             
                                          
                                          
                                          ∀
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                k
                                             
                                          
                                          ≤
                                          
                                             δ
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          ∀
                                          i
                                          ,
                                          j
                                          ≠
                                          i
                                          ,
                                          k
                                          ,
                                          l
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (7)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             ∑
                                             j
                                             n
                                          
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                {
                                                i
                                                :
                                                
                                                   a
                                                   i
                                                
                                                ≤
                                                
                                                   t
                                                   r
                                                
                                                }
                                             
                                          
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                l
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          +
                                          
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             ∑
                                             i
                                             n
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                {
                                                j
                                                :
                                                
                                                   d
                                                   j
                                                
                                                ≤
                                                
                                                   t
                                                   r
                                                
                                                }
                                             
                                          
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                l
                                             
                                          
                                          ≤
                                          C
                                          
                                          ∀
                                          r
                                          ∈
                                          
                                             {
                                             1
                                             ,
                                             2
                                             ,
                                             ⋯
                                             ,
                                             2
                                             n
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (8)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                l
                                             
                                          
                                          =
                                          0
                                          
                                          ∀
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                          ,
                                          l
                                          :
                                          j
                                          ≠
                                          i
                                          ,
                                          
                                             (
                                             
                                                d
                                                j
                                             
                                             −
                                             
                                                a
                                                i
                                             
                                             −
                                             
                                                t
                                                
                                                   k
                                                   l
                                                
                                             
                                             )
                                          
                                          ≤
                                          0
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                l
                                             
                                          
                                          ≤
                                          1
                                          
                                          ∀
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                          ,
                                          l
                                          :
                                          j
                                          ≠
                                          i
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (10)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                l
                                             
                                          
                                          ≥
                                          0
                                          
                                          ∀
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                          ,
                                          l
                                          :
                                          j
                                          ≠
                                          i
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (11)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             y
                                             
                                                i
                                                k
                                             
                                          
                                          ≤
                                          1
                                          
                                          ∀
                                          i
                                          ,
                                          k
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (12)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             y
                                             
                                                i
                                                k
                                             
                                          
                                          ≥
                                          0
                                          
                                          ∀
                                          i
                                          ,
                                          k
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (13)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             y
                                             
                                                i
                                                k
                                             
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          ,
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                l
                                             
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

In this formulation, the objective function (1) accounts for two types of costs. In the first part, the monetary cost of the time spent for transferring pallets from one truck to another is measured. The time is not associated with pallets but with the whole load of the truck. The second part deals with the penalty for the unfulfilled shipments. Constraints (2) ensure that a truck can be assigned to no more than one dock. Constraints (3) and (4) indicate that for a pallet transfer between truck i and truck j, i can use dock k and j can use dock l, if i is allocated to k and j is allocated to l. The constraints (5) guarantee that if the arrival/departure time windows of two trucks i and j overlap (
                        
                           
                              δ
                              
                                 i
                                 j
                              
                           
                           =
                           
                              δ
                              
                                 j
                                 i
                              
                           
                           =
                           0
                        
                     ), either of them can be docked at dock k (not both). Constraints (6) ensure that truck i and truck j can use the same dock for realizing the transfer of pallets from i to j, only if their time windows do not intersect —i.e., i leaves no later than j arrives. Constraints (7) guarantee that at every event time (arrival and/or departure of a truck), the capacity of cross dock is respected. For a given i, j, k, l: j ≠ i, the corresponding constraint in (8) ensure that zjilk
                      is set to zero if fij
                      > 0 and 
                        
                           (
                           
                              d
                              j
                           
                           −
                           
                              a
                              i
                           
                           −
                           
                              t
                              
                                 k
                                 l
                              
                           
                           )
                           <
                           0
                        
                     .

The model (TDAP) is related to the models given in Miao et al. (2014, 2009). Miao et al. (2014) propose a model relying on the same decision variables as in the (TDAP). But, the problem addressed differs since they do not define any capacity for the cross-dock and they distinguish the inbound and outbound flows. More precisely, inbound and outbound trucks are identified as well as the maximum numbers of docks assigned to each type of vehicles. The (TDAP) is based on the same assumptions as the model (TDAP-M) introduced by Miao et al. (2009) (see Appendix A). However, variables zijkl
                      are defined in terms of assignments of trucks to doors in their formulation. zijkl
                      is equal to 1 if and only if truck i is assigned to dock k and truck j to dock l. For the (TDAP), zijkl
                      is associated with the assignment decisions but also with the existence of pallets to transfer from i to j (fij
                      > 0). Such a definition allows us to capture solutions which are disregarded by the (TDAP-M). It allows to use the cross-dock as a temporary storage area, which means that trucks do not need to be docked simultaneously to transfer pallets from one vehicle to the other. Due to the definition of variables zijkl
                     , the constraint sets of (TDAP) and (TDAP-M) differ. Constraints (A.5) in (TDAP-M) have to be removed while restrictions (A.6) have to be modified. More precisely, constraints (A.5) are as follows:

                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             y
                                             
                                                i
                                                k
                                             
                                          
                                          +
                                          
                                             y
                                             
                                                j
                                                l
                                             
                                          
                                          −
                                          1
                                          ≤
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                l
                                             
                                          
                                          
                                          
                                             (
                                             1
                                             ≤
                                             i
                                             ,
                                             j
                                             ≤
                                             n
                                             ,
                                             1
                                             ≤
                                             k
                                             ,
                                             l
                                             ≤
                                             m
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Let i and j be two vehicles such that truck j leaves the cross dock before truck i arrives. According to assumption (i), we have 
                        
                           
                              f
                              
                                 i
                                 j
                              
                           
                           =
                           0
                        
                     . If fij
                      ≠ 0 and a sufficient capacity on the cross dock was available, truck j has already dropped off its cargo on the cross dock buffer before it departs. This cargo can be later on transferred to i, once i arrives. Having 
                        
                           
                              f
                              
                                 i
                                 j
                              
                           
                           =
                           0
                           ,
                        
                      voids the corresponding constraint in (A.8) and this constraint does not make any decision on zijkl
                     . If for some k, l, 
                        
                           
                              z
                              
                                 j
                                 i
                                 l
                                 k
                              
                           
                           =
                           1
                           ,
                        
                      as it is possible, then constraint (A.5) would set zijkl
                      to 1, too, for a zero-size load of pallets from i to j.

When 
                        
                           
                              f
                              
                                 i
                                 j
                              
                           
                           =
                           0
                        
                      and 
                        
                           
                              z
                              
                                 i
                                 j
                                 k
                                 l
                              
                           
                           =
                           1
                        
                      (due to equality with zjilk
                     ), we have 
                        
                           
                              p
                              
                                 i
                                 j
                              
                           
                           
                              f
                              
                                 i
                                 j
                              
                           
                           
                              (
                              1
                              −
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 m
                              
                              
                                 ∑
                                 
                                    l
                                    =
                                    1
                                 
                                 m
                              
                              
                                 z
                                 
                                    i
                                    j
                                    k
                                    l
                                 
                              
                              )
                           
                        
                      equal to zero because no penalty is going to be paid for a flow that does not exist, i.e. 
                        
                           
                              f
                              
                                 i
                                 j
                              
                           
                           =
                           0
                        
                     . However, still the first term in the objective function (i.e. for the same i, j, 
                        
                           
                              ∑
                              
                                 k
                                 =
                                 1
                              
                              m
                           
                           
                              ∑
                              
                                 l
                                 =
                                 1
                              
                              m
                           
                           
                              c
                              
                                 k
                                 l
                              
                           
                           
                              t
                              
                                 k
                                 l
                              
                           
                           
                              z
                              
                                 i
                                 j
                                 k
                                 l
                              
                           
                        
                     ) is contributing in the objective values by forcing to pay transport cost for pallets, which do not exist. That means, for 
                        
                           
                              f
                              
                                 i
                                 j
                              
                           
                           =
                           0
                        
                      we still have to pay for the transfer cost. This is a direct consequence of tying up the destiny of zijkl
                      and zjilk
                      to each other using (A.5).

Another relevant case is the following. Given i, j, k, l: j ≠ i, suppose that 
                        
                           (
                           
                              d
                              j
                           
                           −
                           
                              a
                              i
                           
                           )
                           ≥
                           0
                        
                      and 
                        
                           (
                           
                              d
                              j
                           
                           −
                           
                              a
                              i
                           
                           −
                           
                              t
                              
                                 k
                                 l
                              
                           
                           )
                           <
                           0
                        
                     . Truck j does not leave before truck i arrives, but there is no sufficient time to make the transfer between dock k and dock l. However, if pallets of truck j are unloaded before it leaves, truck i can still take them and zjilk
                      can be set to 1. This does not fall under assumption (i) and fij
                      might be strictly positive. Therefore, corresponding constraint in (A.8) forces 
                        
                           
                              z
                              
                                 i
                                 j
                                 k
                                 l
                              
                           
                           =
                           0
                        
                     . On the other hand, (A.5) forces yik
                      or yjl
                      to be equal to 0, and zjilk
                      is equal 0 to satisfy constraints (A.3) and (A.4). In such a case, having 
                        
                           
                              z
                              
                                 j
                                 i
                                 l
                                 k
                              
                           
                           =
                           1
                        
                      in a feasible solution is possible assuming a sufficient capacity, but such solutions will not be considered if constraints (A.5) are included.

Following the same lines, constraints (A.6) are replaced by restrictions (6). More precisely, constraints (A.6) are as follows:

                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             δ
                                             
                                                i
                                                j
                                             
                                          
                                          +
                                          
                                             δ
                                             
                                                j
                                                i
                                             
                                          
                                          ≥
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                k
                                             
                                          
                                          
                                          
                                             (
                                             1
                                             ≤
                                             i
                                             ,
                                             j
                                             ≤
                                             n
                                             ,
                                             i
                                             ≠
                                             j
                                             ,
                                             1
                                             ≤
                                             k
                                             ≤
                                             m
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

There are the two cases in which we should allow distinct trucks i and j to use the same dock k. First, truck i drops its pallets and leaves dock k before truck j arrives at dock k. Second, vehicle j drops its pallets and leaves dock k before vehicle i arrives at dock k. Therefore, zijkk
                      only depends on whether i leaves before j arrives or not. Whether j departs before i arrives or not is not directly related to zijkk
                     . Because if j depart before i arrives (i.e. 
                        
                           
                              δ
                              
                                 i
                                 j
                              
                           
                           =
                           0
                        
                      and 
                        
                           
                              δ
                              
                                 j
                                 i
                              
                           
                           =
                           1
                        
                     ), still there is no possibility of transferring from i to j, but the original constraint turns to 
                        
                           
                              z
                              
                                 i
                                 j
                                 k
                                 k
                              
                           
                           ≤
                           
                              δ
                              
                                 i
                                 j
                              
                           
                           +
                           
                              δ
                              
                                 j
                                 i
                              
                           
                           =
                           1
                        
                      which is of no effect. While 
                        
                           
                              z
                              
                                 i
                                 j
                                 k
                                 k
                              
                           
                           ≤
                           
                              δ
                              
                                 i
                                 j
                              
                           
                           =
                           0
                           ,
                        
                      clearly sets the variable to the correct value.

Our initial numerical experiments showed that the LP relaxation of the model is often not so tight and the lower bound usually does not improve well in order to quickly close the optimality gap. Therefore, in this section, we introduce several classes of (face-defining) valid inequalities for this problem in order to speed up the solving of instances even if the valid inequalities do not tighten the polytope. Some of these valid inequalities are identified by directly optimizing over the first Chvàtal–Gomory closure (see Fischetti & Lodi, 2007) and some others by efforts in re-constructing the convex hull of all the solutions of given instances.


                        
                           Lemma 1
                           
                              The following inequalities are valid for the TDAP polytope:
                              
                                 
                                    (14)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      l
                                                      n
                                                   
                                                   
                                                      z
                                                      
                                                         i
                                                         j
                                                         k
                                                         l
                                                      
                                                   
                                                   ≤
                                                   
                                                      y
                                                      
                                                         i
                                                         k
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   i
                                                   ,
                                                   j
                                                   ≠
                                                   i
                                                   ,
                                                   
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (15)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      k
                                                      n
                                                   
                                                   
                                                      z
                                                      
                                                         i
                                                         j
                                                         k
                                                         l
                                                      
                                                   
                                                   ≤
                                                   
                                                      y
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   i
                                                   ,
                                                   j
                                                   ≠
                                                   i
                                                   ,
                                                   
                                                   l
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (16)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      k
                                                   
                                                   
                                                      z
                                                      
                                                         i
                                                         j
                                                         k
                                                         l
                                                      
                                                   
                                                   ≤
                                                   
                                                      ∑
                                                      k
                                                   
                                                   
                                                      y
                                                      
                                                         i
                                                         k
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   i
                                                   ,
                                                   j
                                                   ≠
                                                   i
                                                   ,
                                                   
                                                   l
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (17)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      l
                                                   
                                                   
                                                      z
                                                      
                                                         i
                                                         j
                                                         k
                                                         l
                                                      
                                                   
                                                   ≤
                                                   
                                                      ∑
                                                      l
                                                   
                                                   
                                                      y
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   i
                                                   ,
                                                   j
                                                   ≠
                                                   i
                                                   ,
                                                   
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (18)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         k
                                                         ,
                                                         l
                                                      
                                                   
                                                   
                                                      z
                                                      
                                                         i
                                                         j
                                                         k
                                                         l
                                                      
                                                   
                                                   ≤
                                                   
                                                      ∑
                                                      k
                                                   
                                                   
                                                      y
                                                      
                                                         i
                                                         
                                                         k
                                                      
                                                   
                                                   
                                                   ∀
                                                   i
                                                   ,
                                                   j
                                                   ≠
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (19)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         k
                                                         ,
                                                         l
                                                      
                                                   
                                                   
                                                      z
                                                      
                                                         i
                                                         j
                                                         k
                                                         l
                                                      
                                                   
                                                   ≤
                                                   
                                                      ∑
                                                      l
                                                   
                                                   
                                                      y
                                                      
                                                         j
                                                         
                                                         l
                                                      
                                                   
                                                   
                                                   ∀
                                                   i
                                                   ,
                                                   j
                                                   ≠
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Constraints (14) and (15) state that if truck i (j) is not assigned to dock k (l), no transfer from i (j) to any j ≠ i via an 
                                 
                                    i
                                    −
                                    k
                                 
                               (
                                 
                                    l
                                    −
                                    j
                                 
                              ) transfer can take place.

Constraints (16) and (17) are aggregation of constraints (A.3) and (A.4) and constraints (18) and (19) are aggregation of constraints (14) and (15).□

While none of the constraints (16)–(19) contribute in improving the LP relaxation and none of them can tighten the polytope, however, our extensive initial numerical experiments show that when directly added to the model, these constraints contribute significantly in the efficiency of the whole solution process.

                           Lemma 2
                           
                              If truck i is assigned to dock m and truck k to n, at most two variables among zijmn, zikmn and zjkmn can take value 1.
                              
                                 
                                    (20)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      z
                                                      
                                                         i
                                                         j
                                                         m
                                                         n
                                                      
                                                   
                                                   +
                                                   
                                                      z
                                                      
                                                         i
                                                         k
                                                         m
                                                         n
                                                      
                                                   
                                                   +
                                                   
                                                      z
                                                      
                                                         j
                                                         k
                                                         m
                                                         n
                                                      
                                                   
                                                   ≤
                                                   
                                                      y
                                                      
                                                         i
                                                         m
                                                      
                                                   
                                                   +
                                                   
                                                      y
                                                      
                                                         k
                                                         n
                                                      
                                                   
                                                   
                                                   ∀
                                                   i
                                                   ,
                                                   j
                                                   ≠
                                                   i
                                                   
                                                   ,
                                                   k
                                                   ∉
                                                   
                                                      {
                                                      i
                                                      ,
                                                      j
                                                      }
                                                   
                                                   ,
                                                   
                                                   m
                                                   ,
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              The following constraints are valid for the TDAP polytope:
                              
                                 
                                    (21)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      y
                                                      
                                                         i
                                                         k
                                                      
                                                   
                                                   ≤
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ,
                                                         l
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         z
                                                         
                                                            i
                                                            j
                                                            k
                                                            l
                                                         
                                                      
                                                      +
                                                      
                                                         z
                                                         
                                                            j
                                                            i
                                                            l
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                   ∀
                                                   i
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

An assignment of a truck i to a dock k must not take place if no transfer between i and any other j occurs.□


                              The following constraints are valid for the TDAP polytope:
                              
                                 
                                    (22)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      y
                                                      
                                                         i
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         
                                                            k
                                                            ′
                                                         
                                                         ,
                                                         l
                                                         :
                                                         
                                                            k
                                                            ′
                                                         
                                                         ≠
                                                         k
                                                      
                                                   
                                                   
                                                      z
                                                      
                                                         i
                                                         j
                                                         
                                                            k
                                                            ′
                                                         
                                                         l
                                                      
                                                   
                                                   ≤
                                                   1
                                                   
                                                   ∀
                                                   i
                                                   ,
                                                   k
                                                   ,
                                                   j
                                                   ≠
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (23)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      y
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         
                                                            l
                                                            ′
                                                         
                                                         ,
                                                         k
                                                         :
                                                         
                                                            l
                                                            ′
                                                         
                                                         ≠
                                                         l
                                                      
                                                   
                                                   
                                                      z
                                                      
                                                         i
                                                         j
                                                         k
                                                         
                                                            l
                                                            ′
                                                         
                                                      
                                                   
                                                   ≤
                                                   1
                                                   
                                                   ∀
                                                   i
                                                   ,
                                                   l
                                                   ,
                                                   j
                                                   ≠
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              The following four classes of inequalities are valid for the TDAP polytope:
                              
                                 
                                    (24)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      z
                                                      
                                                         i
                                                         
                                                            j
                                                            ′
                                                         
                                                         k
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      z
                                                      
                                                         j
                                                         i
                                                         l
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      z
                                                      
                                                         j
                                                         
                                                            j
                                                            ′
                                                         
                                                         l
                                                         l
                                                      
                                                   
                                                   ≤
                                                   
                                                      y
                                                      
                                                         i
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      y
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   
                                                   ∀
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   ,
                                                   l
                                                   ,
                                                   
                                                      j
                                                      ′
                                                   
                                                   ≠
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (25)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      z
                                                      
                                                         i
                                                         
                                                            j
                                                            ′
                                                         
                                                         k
                                                         l
                                                      
                                                   
                                                   +
                                                   
                                                      z
                                                      
                                                         j
                                                         i
                                                         l
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      z
                                                      
                                                         j
                                                         
                                                            j
                                                            ′
                                                         
                                                         l
                                                         k
                                                      
                                                   
                                                   ≤
                                                   
                                                      y
                                                      
                                                         i
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      y
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   
                                                   ∀
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   ,
                                                   l
                                                   ,
                                                   
                                                      j
                                                      ′
                                                   
                                                   ≠
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (26)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      z
                                                      
                                                         i
                                                         
                                                            j
                                                            ′
                                                         
                                                         k
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      z
                                                      
                                                         i
                                                         j
                                                         k
                                                         l
                                                      
                                                   
                                                   +
                                                   
                                                      z
                                                      
                                                         j
                                                         
                                                            j
                                                            ′
                                                         
                                                         l
                                                         l
                                                      
                                                   
                                                   ≤
                                                   
                                                      y
                                                      
                                                         i
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      y
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   
                                                   ∀
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   ,
                                                   l
                                                   ,
                                                   
                                                      j
                                                      ′
                                                   
                                                   ≠
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (27)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      z
                                                      
                                                         i
                                                         
                                                            j
                                                            ′
                                                         
                                                         k
                                                         l
                                                      
                                                   
                                                   +
                                                   
                                                      z
                                                      
                                                         i
                                                         j
                                                         k
                                                         l
                                                      
                                                   
                                                   +
                                                   
                                                      z
                                                      
                                                         j
                                                         
                                                            j
                                                            ′
                                                         
                                                         l
                                                         k
                                                      
                                                   
                                                   ≤
                                                   
                                                      y
                                                      
                                                         i
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      y
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   
                                                   ∀
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   ,
                                                   l
                                                   ,
                                                   
                                                      j
                                                      ′
                                                   
                                                   ≠
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              Given a set of trucks
                              
                                 
                                    S
                                    ,
                                 
                               
                              where
                              
                                 
                                    |
                                    S
                                    |
                                    =
                                    Q
                                 
                               
                              and dock k and trucks
                              
                                 
                                    
                                       i
                                       1
                                    
                                    ,
                                    
                                       i
                                       2
                                    
                                    ,
                                    ⋯
                                    ,
                                    
                                    
                                       i
                                       Q
                                    
                                    ,
                                 
                               
                              for which:
                              
                                 
                                    (28)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      y
                                                      
                                                         
                                                            i
                                                            1
                                                         
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      y
                                                      
                                                         
                                                            i
                                                            2
                                                         
                                                         k
                                                      
                                                   
                                                   ≤
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (29)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      y
                                                      
                                                         
                                                            i
                                                            2
                                                         
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      y
                                                      
                                                         
                                                            i
                                                            3
                                                         
                                                         k
                                                      
                                                   
                                                   ≤
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (30)
                                    
                                       
                                          
                                             
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      y
                                                      
                                                         
                                                            i
                                                            
                                                               Q
                                                               −
                                                               1
                                                            
                                                         
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      y
                                                      
                                                         
                                                            i
                                                            N
                                                         
                                                         Q
                                                      
                                                   
                                                   ≤
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              from constraints 
                              
                                 (5)
                              
                              . The following constraint is a valid cover inequality for the TDAP polytope:
                              
                                 
                                    (31)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      y
                                                      
                                                         
                                                            i
                                                            1
                                                         
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      y
                                                      
                                                         
                                                            i
                                                            2
                                                         
                                                         k
                                                      
                                                   
                                                   +
                                                   ⋯
                                                   +
                                                   
                                                      y
                                                      
                                                         
                                                            i
                                                            
                                                               Q
                                                               −
                                                               1
                                                            
                                                         
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      y
                                                      
                                                         
                                                            i
                                                            Q
                                                         
                                                         k
                                                      
                                                   
                                                   ≤
                                                   
                                                      |
                                                      Q
                                                      |
                                                   
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Clearly, constraints (31) are dominated by those of (28)–(30).

                           Proof of Lemma 6
                           Proof using mathematical induction is straightforward.□

The following inequalities are more general form of constraints (21).

                           Lemma 7
                           
                              The following constraints are valid for the TDAP polytope. Let T and D be the sets of indexes of trucks and docks, respectively. Let also
                              
                                 
                                    
                                       S
                                       T
                                    
                                    ∪
                                    
                                       S
                                       D
                                    
                                    =
                                    S
                                    ⊂
                                    T
                                    ∪
                                    D
                                    =
                                    V
                                 
                               
                              and i ∈ ST:
                              
                                 
                                    (i)
                                    
                                       
                                          
                                             (32)
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  j
                                                                  ,
                                                                  l
                                                                  ∈
                                                                  V
                                                                  ,
                                                                  k
                                                                  ∈
                                                                  
                                                                     
                                                                        (
                                                                        V
                                                                        /
                                                                        
                                                                        S
                                                                        )
                                                                     
                                                                     D
                                                                  
                                                               
                                                            
                                                            
                                                               z
                                                               
                                                                  i
                                                                  j
                                                                  k
                                                                  l
                                                               
                                                            
                                                            +
                                                            
                                                               ∑
                                                               
                                                                  j
                                                                  ,
                                                                  l
                                                                  ∈
                                                                  V
                                                                  ,
                                                                  k
                                                                  ∈
                                                                  
                                                                     
                                                                        (
                                                                        V
                                                                        /
                                                                        
                                                                        S
                                                                        )
                                                                     
                                                                     D
                                                                  
                                                               
                                                            
                                                            
                                                               z
                                                               
                                                                  j
                                                                  i
                                                                  l
                                                                  k
                                                               
                                                            
                                                            ≥
                                                            
                                                               ∑
                                                               
                                                                  k
                                                                  ∈
                                                                  
                                                                     
                                                                        (
                                                                        V
                                                                        /
                                                                        
                                                                        S
                                                                        )
                                                                     
                                                                     D
                                                                  
                                                               
                                                            
                                                            
                                                               y
                                                               
                                                                  i
                                                                  k
                                                               
                                                            
                                                            
                                                            ∀
                                                            i
                                                            ∈
                                                            
                                                               S
                                                               T
                                                            
                                                            ⊂
                                                            V
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    


                                       Let i′ ∈ (V/ S)
                                          T
                                       ,

                                          
                                             (33)
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  j
                                                                  ,
                                                                  l
                                                                  ∈
                                                                  V
                                                                  ,
                                                                  k
                                                                  ∈
                                                                  
                                                                     
                                                                        (
                                                                        V
                                                                        /
                                                                        
                                                                        S
                                                                        )
                                                                     
                                                                     D
                                                                  
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  z
                                                                  
                                                                     i
                                                                     j
                                                                     k
                                                                     l
                                                                  
                                                               
                                                               +
                                                               
                                                                  z
                                                                  
                                                                     j
                                                                     i
                                                                     l
                                                                     k
                                                                  
                                                               
                                                               )
                                                            
                                                            +
                                                            
                                                               ∑
                                                               
                                                                  j
                                                                  ,
                                                                  l
                                                                  ∈
                                                                  V
                                                                  ,
                                                                  k
                                                                  ∈
                                                                  
                                                                     S
                                                                     D
                                                                  
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  z
                                                                  
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                     j
                                                                     k
                                                                     l
                                                                  
                                                               
                                                               +
                                                               
                                                                  z
                                                                  
                                                                     j
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                     l
                                                                     k
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            ≥
                                                            
                                                               ∑
                                                               
                                                                  k
                                                                  ∈
                                                                  
                                                                     
                                                                        (
                                                                        V
                                                                        /
                                                                        
                                                                        S
                                                                        )
                                                                     
                                                                     D
                                                                  
                                                               
                                                            
                                                            
                                                               y
                                                               
                                                                  i
                                                                  k
                                                               
                                                            
                                                            +
                                                            
                                                               ∑
                                                               
                                                                  k
                                                                  ∈
                                                                  
                                                                     S
                                                                     D
                                                                  
                                                               
                                                            
                                                            
                                                               y
                                                               
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                                  k
                                                               
                                                            
                                                            ,
                                                            
                                                            ∀
                                                            i
                                                            ∈
                                                            
                                                               S
                                                               T
                                                            
                                                            ⊂
                                                            V
                                                            ,
                                                            
                                                               i
                                                               ′
                                                            
                                                            ∈
                                                            
                                                               
                                                                  (
                                                                  v
                                                                  /
                                                                  
                                                                  S
                                                                  )
                                                               
                                                               T
                                                            
                                                            ⊂
                                                            V
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       This class of valid inequalities is obtained by an aggregation of constraints 
                                       (32) 
                                       for i ∈ S and i′ ∈ V/ S.

We show that under certain conditions, the TDAP polytope is a full-dimensional polytope and some of the proposed valid inequalities are facet-defining (Balas, 1997).

Note that every constraint in (6) and (8) either fixes a variable to zero or is already implied by the bound constraints (9).


                        Dimension of TDAP polytope : There are two cases: (1) constraints (6) are all implied by constraints (9) and the constraint set (8) is empty, in which case we identify 
                           
                              n
                              
                                 (
                                 n
                                 −
                                 1
                                 )
                              
                              
                                 m
                                 2
                              
                              +
                              n
                              m
                           
                         linearly independent points in the TDAP polytope, or (2) some of the constraints (6) and (8) are implying equality (fixing some variables to 0). In the latter case, dimension of the TDAP polytope would be 
                           
                              n
                              
                                 (
                                 n
                                 −
                                 1
                                 )
                              
                              
                                 m
                                 2
                              
                              +
                              n
                              m
                              −
                              
                                 |
                                 E
                                 q
                                 |
                              
                           
                         where |Eq| is the cardinality of the set of constraint in (6) and (8) satisfied as equality.

                           Theorem 8
                           
                              Given C ≥ fij
                              , ∀i, j ≠ i, if all the constraints in 
                              
                                 (6)
                               
                              are implied by the bound constraints and constraints set 
                              
                                 (8)
                               
                              is empty, the TDAP polytope is a full-dimensional polytope.
                           

Let 
                                 
                                    
                                       y
                                       T
                                    
                                    =
                                    
                                       [
                                       
                                          y
                                          11
                                       
                                       ,
                                       
                                          y
                                          12
                                       
                                       ,
                                       
                                       ⋯
                                       
                                       ,
                                       
                                       
                                          y
                                          
                                             1
                                             
                                             m
                                          
                                       
                                       ,
                                       
                                       ⋯
                                       
                                       ,
                                       
                                       
                                          y
                                          
                                             n
                                             
                                             m
                                             −
                                             1
                                          
                                       
                                       ,
                                       
                                          y
                                          
                                             n
                                             
                                             m
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       z
                                       T
                                    
                                    =
                                    
                                       [
                                       
                                          z
                                          1211
                                       
                                       ,
                                       
                                          z
                                          1212
                                       
                                       ,
                                       
                                       ⋯
                                       
                                       ,
                                       
                                       
                                          z
                                          
                                             12
                                             
                                             m
                                             
                                             m
                                          
                                       
                                       ,
                                       
                                          z
                                          1311
                                       
                                       ,
                                       
                                       ⋯
                                       
                                       ,
                                       
                                       
                                          z
                                          
                                             n
                                             ,
                                             n
                                             −
                                             1
                                             ,
                                             m
                                             ,
                                             m
                                          
                                       
                                       ]
                                    
                                 
                               and 
                                 
                                    
                                       a
                                       T
                                    
                                    =
                                    
                                       [
                                       
                                          y
                                          T
                                       
                                       
                                       |
                                       
                                       
                                          z
                                          T
                                       
                                       ]
                                    
                                 
                              .

                                 
                                    (a)
                                    Let 
                                          
                                             
                                                b
                                                
                                                   y
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                T
                                             
                                             =
                                             e
                                             
                                                (
                                                
                                                   y
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                )
                                             
                                             ,
                                             
                                             
                                                b
                                                T
                                             
                                             ∈
                                             
                                                B
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      a
                                                      T
                                                   
                                                   
                                                      |
                                                   
                                                
                                             
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             k
                                          
                                       
                                    

Let 
                                          
                                             
                                                c
                                                
                                                   z
                                                   
                                                      i
                                                      j
                                                      k
                                                      l
                                                   
                                                
                                                T
                                             
                                             =
                                             e
                                             
                                                (
                                                
                                                   y
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                )
                                             
                                             +
                                             e
                                             
                                                (
                                                
                                                   y
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                )
                                             
                                             +
                                             e
                                             
                                                (
                                                
                                                   z
                                                   
                                                      i
                                                      j
                                                      k
                                                      l
                                                   
                                                
                                                )
                                             
                                             ,
                                             
                                             
                                                c
                                                T
                                             
                                             ∈
                                             
                                                B
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      a
                                                      T
                                                   
                                                   
                                                      |
                                                   
                                                
                                             
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             ,
                                             l
                                             :
                                             j
                                             ≠
                                             i
                                          
                                       
                                    

where e(i) is the unit vector having ith entry equal to 1 and 0, elsewhere. Note that 
                                 
                                    b
                                    
                                       y
                                       
                                          i
                                          k
                                       
                                    
                                    T
                                 
                               and 
                                 
                                    
                                       c
                                       
                                          z
                                          
                                             i
                                             j
                                             k
                                             l
                                          
                                       
                                       T
                                    
                                    ,
                                    ∀
                                    i
                                    ,
                                    j
                                    ,
                                    k
                                    ,
                                    l
                                 
                               are all feasible solutions of the TDAP.

Let 
                                 
                                    A
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   b
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   c
                                                   T
                                                
                                             
                                          
                                       
                                       ]
                                    
                                 
                               be a square matrix of size 
                                 
                                    n
                                    
                                       (
                                       n
                                       −
                                       1
                                       )
                                    
                                    
                                       m
                                       2
                                    
                                    +
                                    n
                                    m
                                 
                              .

It can be easily shown that the rows of A can be re-ordered to represent a lower triangular matrix where all the diagonal elements are 1. The matrix A is non-singular and the set of vectors comprised of all the rows of A contains 
                                 
                                    n
                                    
                                       (
                                       n
                                       −
                                       1
                                       )
                                    
                                    
                                       m
                                       2
                                    
                                    +
                                    n
                                    m
                                 
                               linearly independent vectors. Therefore, the TDAP polytope in this case is a full-dimensional polytope.□


                              Suppose that C ≥ fij
                              , ∀i, j ≠ i and those equality-implying constraints 
                              
                                 (6)
                               
                              and 
                              
                                 (8)
                               
                              (i.e. those that imply
                              
                                 
                                    
                                       z
                                       
                                          i
                                          j
                                          k
                                          k
                                       
                                    
                                    =
                                    0
                                 
                               
                              and/or
                              
                                 
                                    
                                       z
                                       
                                          i
                                          j
                                          k
                                          l
                                       
                                    
                                    =
                                    0
                                 
                              
                              ) exist in A. Let matrix A′ be obtained from matrix A by removing the rows in 
                              c
                              
                                 T
                               
                              corresponding to every equality-implying constraint in 
                              
                                 (6)
                               
                              and 
                              
                                 (8)
                              
                              .
                              
                                 
                                    r
                                    a
                                    n
                                    k
                                    
                                       (
                                       
                                          A
                                          ′
                                       
                                       )
                                    
                                    =
                                    d
                                    i
                                    m
                                    
                                       (
                                       TDAP
                                       )
                                    
                                 
                               
                              is equal to the dimension of the resulting polytope.□
                           


                              The valid inequalities 
                              
                                 (14)
                               
                              and 
                              
                                 (15)
                               
                              are facet-defining.
                           

For a given i, k(l), all the rows of A′ after removing the one corresponding to 
                                 
                                    
                                       b
                                       
                                          y
                                          
                                             i
                                             k
                                          
                                       
                                       T
                                    
                                    =
                                    e
                                    
                                       (
                                       
                                          y
                                          
                                             i
                                             k
                                          
                                       
                                       )
                                    
                                 
                               are linearly independent and satisfy (14) and (15) with equality. Hence, the number of feasible solutions satisfying these inequalities with equality is 
                                 
                                    r
                                    a
                                    n
                                    k
                                    (
                                    
                                       A
                                       ′
                                    
                                    )
                                    −
                                    1
                                 
                              .□


                              The valid inequalities 
                              
                                 (3)
                              
                              and 
                              
                                 (4)
                               
                              are defining facets for the TDAP polytope.
                           

The proof is similar to that of Theorem 10.□


                              The bound constraints 
                              
                                 (10)
                               
                              are defining facets for the TDAP polytope.
                           

The proof is similar to that of Theorem 10.□

We have developed a branch-and-cut algorithm to solve instances of the TDAP. The branch-and-cut algorithm has been implemented using CPLEX as an algorithmic framework as it will be explains below. This means that we have to define mainly what is the initial model and how cuts will be separated. This is what we present in the two next sections.

The
                         initial model includes constraints (1)–(13) together with additional constraints (14)–(19). As noted earlier, while constraints (16)–(19) are already implied by other constraints in the TDAP, still the efficiency of our branch-and-cut owes – to a high extent – to the presence of these constraints in the initial model. The latter is confirmed by our extensive numerical experiments.

Constraints (1)–(13) together with (14) and (15) result in a relatively tight formulation which fits well to our branch-and-cut. The remaining valid inequalities are separated dynamically and added in the branch-and-cut style.

The reason we did not add all the polynomial valid inequalities to the model and directly calling CPLEX to solve the resulting IP is because the LP gap is rather small in the initial model (constraints (1)–(19)) and often only a very small fraction of any other set of additional (polynomial size) valid inequalities are eventually effective. Thus the overall performance is better managed when such valid inequalities are dynamically separated and added to the model. This also avoid memory issues and/or numerical instabilities caused by adding them all to the model. This has been proven by our extensive computational experiments.

Almost all the constraints except constraints (32) and (33) can be separated by enumeration. In fact, we only present separation algorithms for constraints (31) and (32). The same procedure as for (32) can be applied for separating cuts for all i ∈ S and i′ ∈ V/ S. The inequalities (33) can be obtained by aggregating them.


                        Separation of constraints (
                        
                           31
                        
                        ) : Separation of this set of constraints can be done using simple data structures such as trees and linked lists. In such data structures, every constraint in (28)–(30) corresponds to a node of the tree or an element of the list and there is an edge between every two nodes/elements if the constraints share a common variable. Any number of nodes/elements traversed when leaving a node/element towards another one, can be part of the constraint.

However, the smaller the N, the sharper the constraint.


                        Separation procedure for the constraints 
                        (32): Let s be a dummy node and establish a graph 
                           
                              
                                 G
                                 ′
                              
                              =
                              
                                 (
                                 V
                                 ∪
                                 
                                    {
                                    s
                                    }
                                 
                                 ,
                                 
                                    A
                                    ′
                                 
                                 )
                              
                           
                         where there is an edge between s and every j with capacity 
                           
                              
                                 
                                    z
                                    ¯
                                 
                                 
                                    i
                                    j
                                    k
                                    *
                                 
                              
                              +
                              
                                 
                                    z
                                    ¯
                                 
                                 
                                    j
                                    i
                                    *
                                    k
                                 
                              
                              ,
                           
                         if 
                           
                              
                                 
                                    z
                                    ¯
                                 
                                 
                                    i
                                    j
                                    k
                                    *
                                 
                              
                              +
                              
                                 
                                    z
                                    ¯
                                 
                                 
                                    j
                                    i
                                    *
                                    k
                                 
                              
                              >
                              0
                           
                         and an edge {i, k} with capacity 
                           
                              
                                 
                                    y
                                    ¯
                                 
                                 
                                    i
                                    k
                                 
                              
                              ,
                           
                         if 
                           
                              
                                 
                                    y
                                    ¯
                                 
                                 
                                    i
                                    k
                                 
                              
                              >
                              0
                           
                        . Moreover, from every j where 
                           
                              
                                 
                                    z
                                    ¯
                                 
                                 
                                    i
                                    j
                                    k
                                    *
                                 
                              
                              +
                              
                                 
                                    z
                                    ¯
                                 
                                 
                                    j
                                    i
                                    *
                                    k
                                 
                              
                              >
                              0
                           
                         we establish an edge (j, k).

Now, a set S ⊂ V where i ∈ S, s ∉ S defines a cut of 
                           
                              
                                 δ
                                 +
                              
                              
                                 (
                                 S
                                 )
                              
                           
                         if the cut capacity is less than 
                           
                              
                                 ∑
                                 
                                    k
                                    ∈
                                    
                                       
                                          (
                                          V
                                          /
                                          
                                          S
                                          )
                                       
                                       D
                                    
                                 
                              
                              
                                 y
                                 
                                    i
                                    k
                                 
                              
                           
                        . This set S can also be examined to identify possible constraints (33). Complexity of this separation depends mainly on complexity of max-flow algorithm being used for every i.

@&#IMPLEMENTATION@&#

Since we apply CPLEX as a modern branch-and-cut framework. We implement the usercutcallback which leads us to separate the cuts each time visiting a node of the tree or each time re-optimizing the linear relaxation at a node. The management of the tree and all additional features are performed by CPLEX. Specifically, the choice of the variable to branch on is left to CPLEX as our extensive numerical experiments with different variable selection strategies have not shown any significant improvement. The reported experiments confirm that the performance is not influenced by priorities in branching direction.

The instances are generated in the same way as in (Miao et al., 2009) and they are publicly available.
                        1
                     
                     
                        1
                        
                           www.LGI2A.univ-artois.fr/~gelareh/downloads/cross_dock/data.rar.
                      Our computational experiments are conducted on an Intel(R)Core(TM)i7-4770 CPU, 2 processors with 3.40 gigahertz running on a machine with 16 gigabytes RAM. The runs are made on a 64-bit machine. In total we have 100 instances (25 major instances each of which in 4 different versions) ranging from 
                        
                           m
                           =
                           3
                           ,
                           n
                           =
                           10
                        
                      up to 
                        
                           m
                           =
                           14
                           ,
                           n
                           =
                           50
                        
                     . A time limit of 1500 seconds has been set in CPLEX 12.6.1 for solving these instances. However, in some cases, solving LP at a given node of the branch-and-cut algorithm may takes longer and therefore CPLEX may not manage to terminate exactly in 1500 seconds. In such cases, it normally terminates upon completion of the LP solution at the active node of the branch-and-bound. This may result in slight deviations from the 1500 seconds in some cases.


                     Tables 1 and 2 report our computational experiments. The first column stands for the instance name in format (‘data-n-m-#Version’) and the best objective incumbent value is indicated in the second column (‘Obj.’). The third column reports the status of CPLEX upon termination (using the user-defined termination criteria, memory issues or the solver’s optimality conditions) and the next column indicates the number of branch-and-bound nodes processed before termination. The column (‘CPUTime’) and (‘Gap(percent)’) report the CPU time elapsed when termination criteria was met and the relative gap, respectively. The last two columns report the number of separated cuts and the detailed number of cuts from among different classes of valid inequalities in format (‘#Vineq1-#Vineq2’).

From among 100 instances, 74 were solved to optimality at the root node. 85 instances were solved with less than one percent gap at root node (except one case, data-30-6-3, that needed 3 branching and terminated to 0.34 percent gap). 90 instances were solved to less than 5 percent gap within the time limit. Within the time limit, in 6 cases, we had one node to branch and obtained solutions with less than 5 percent gap. In 5 cases we had to branch on more than one node (maximum 8 nodes) to obtain solutions with less than 5 percent in 4 cases and 9.57 percent in one case.

For 10 instances with 50 trucks, we had larger gaps within the time limit. Note that no branching has taken place for any of these 10 instances. We lifted up the time limit to 3600 seconds. As further cuts were separated, the lower bound has improved but no better integer solution for none of the instances has been observed.

In our initial numerical experiments we have observed that separating valid inequalities (32) and (33) does not pay off from a computational perspective as the cuts are not sufficiently effective. The valid inequalities (32) are not enough sharp either. Therefore, we only separated cuts from among (20)–(21)–([22,23])–([24,25,26,27]).

It must be noted that no cut from among (21)–([22,23]) was ever separated as perhaps they are dominated by the valid inequalities that already exist in the tightened formulation. The separated cuts are only from the classes (20)–([24,25,26,27]) with majority being from among ([24,25,26,27]).

@&#CONCLUSIONS@&#

We propose a new model for the truck dock assignment problem based on the assumptions formulated in Miao et al. (2009). We identified several classes of valid inequalities. By proposing a systematic way for generating linearly independent feasible solutions, we showed that the corresponding polytope is a full-dimensional one. Based on that, we proved that some of the proposed valid inequalities are facet-defining. Finally, we developed a branch-and-cut algorithm that solves 74 percent of the instances of the testbed to optimality at the root node and 90 percent to less than 5 percent gap within the time limit. In all such cases, either none or only a few branching were needed.

Given that the model is a pure binary model with a particular structure, our initial experiment with several decomposition schemes did not perform well as the choice of a good subproblem is not trivial. However, we showed that branch-and-cut methods are successful candidates that can be very efficient in dealing with this class of problems and can solve real-size instances in a reasonable time. We pushed the limit of solvability of instances of the problem when compared to the earlier contributions (e.g. Miao et al., 2009).

Our future work will be on identifying more facets of the TDAP polytope and identify possible reformulation with exponential number of columns. Metaheuristics and other exact methods such as decompositions and hybrid methods also deserve attention.

@&#ACKNOWLEDGMENT@&#

The authors would like to thank Professor Andrea Lodi for sharing the code for optimizing on the Chvàtal–Gomory closure. This work was partially supported by the International Campus on Safety and Intermodality in Transportation, the Nord-Pas-de-Calais Region, the European Community, the Regional Delegation for Research and Technology, the French Ministry of Higher Education and Research and the National Center for Scientific Research. This support is gratefully acknowledged. The authors would like to thank the reviewers for improving the paper quality.

The following decision variables are defined. For 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           
                           n
                           ,
                        
                      and 
                        
                           k
                           =
                           1
                           ,
                           …
                           ,
                           
                           m
                           ,
                        
                      let yik
                      be a binary variable equal to 1 if and only if truck i is assigned to dock k. For 
                        
                           i
                           ,
                           j
                           =
                           1
                           ,
                           …
                           ,
                           
                           n
                           ,
                        
                      and 
                        
                           k
                           ,
                           l
                           =
                           1
                           ,
                           …
                           ,
                           
                           m
                           ,
                        
                      let zijkl
                      be a binary variable equal to 1 if and only if truck i is assigned to dock k and truck j to dock l.

(TDAP-M)

                        
                           (A.1)
                           
                              
                                 
                                    
                                       
                                          m
                                          i
                                          n
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             c
                                             
                                                k
                                                l
                                             
                                          
                                          
                                             t
                                             
                                                k
                                                l
                                             
                                          
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                l
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                p
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                f
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   m
                                                
                                                
                                                   ∑
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   m
                                                
                                                
                                                   z
                                                   
                                                      i
                                                      j
                                                      k
                                                      l
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (A.2)
                           
                              
                                 
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                       
                                    
                                    
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             y
                                             
                                                i
                                                k
                                             
                                          
                                          ≤
                                          1
                                          ,
                                          
                                          
                                             (
                                             1
                                             ≤
                                             i
                                             ≤
                                             n
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (A.3)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                l
                                             
                                          
                                          ≤
                                          
                                             y
                                             
                                                i
                                                k
                                             
                                          
                                          ,
                                          
                                          
                                             (
                                             1
                                             ≤
                                             i
                                             ,
                                             j
                                             ≤
                                             n
                                             ,
                                             1
                                             ≤
                                             k
                                             ,
                                             l
                                             ≤
                                             m
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (A.4)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                l
                                             
                                          
                                          ≤
                                          
                                             y
                                             
                                                j
                                                l
                                             
                                          
                                          ,
                                          
                                          
                                             (
                                             1
                                             ≤
                                             i
                                             ,
                                             j
                                             ≤
                                             n
                                             ,
                                             1
                                             ≤
                                             k
                                             ,
                                             l
                                             ≤
                                             m
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (A.5)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             y
                                             
                                                i
                                                k
                                             
                                          
                                          +
                                          
                                             y
                                             
                                                j
                                                l
                                             
                                          
                                          −
                                          1
                                          ≤
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                l
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          1
                                          ≤
                                          i
                                          ,
                                          j
                                          ≤
                                          n
                                          ,
                                          1
                                          ≤
                                          k
                                          ,
                                          l
                                          ≤
                                          m
                                          )
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (A.6)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             δ
                                             
                                                i
                                                j
                                             
                                          
                                          +
                                          
                                             δ
                                             
                                                j
                                                i
                                             
                                          
                                          ≥
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          1
                                          ≤
                                          i
                                          ,
                                          j
                                          ≤
                                          n
                                          ,
                                          i
                                          ≠
                                          j
                                          ,
                                          1
                                          ≤
                                          k
                                          ≤
                                          m
                                          )
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (A.7)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             ∑
                                             j
                                             n
                                          
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                {
                                                i
                                                :
                                                
                                                   a
                                                   i
                                                
                                                ≤
                                                
                                                   t
                                                   r
                                                
                                                }
                                             
                                          
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                l
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          −
                                          
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             ∑
                                             i
                                             n
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                {
                                                j
                                                :
                                                
                                                   d
                                                   j
                                                
                                                ≤
                                                
                                                   t
                                                   r
                                                
                                                }
                                             
                                          
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                l
                                             
                                          
                                          ≤
                                          C
                                       
                                    
                                    
                                       
                                          (
                                          1
                                          ≤
                                          r
                                          ≤
                                          2
                                          n
                                          )
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (A.8)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                d
                                                j
                                             
                                             −
                                             
                                                a
                                                i
                                             
                                             −
                                             
                                                t
                                                
                                                   k
                                                   l
                                                
                                             
                                             )
                                          
                                          ≥
                                          0
                                       
                                    
                                    
                                       
                                          (
                                          1
                                          ≤
                                          i
                                          ,
                                          j
                                          ≤
                                          n
                                          ,
                                          1
                                          ≤
                                          k
                                          ,
                                          l
                                          ≤
                                          m
                                          )
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (A.9)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                j
                                                k
                                                l
                                             
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          ,
                                          
                                             y
                                             
                                                i
                                                k
                                             
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                             (
                                             1
                                             ≤
                                             i
                                             ,
                                             j
                                             ≤
                                             n
                                             ,
                                             1
                                             ≤
                                             k
                                             ,
                                             l
                                             ≤
                                             m
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

@&#REFERENCES@&#

