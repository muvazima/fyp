@&#MAIN-TITLE@&#Variational surface design under normal field guidance

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Two extended energy functionals are proposed for variational surface modeling.


                        
                        
                           
                           The guiding normal field can be used to control the shapes of the variational surfaces efficiently.


                        
                        
                           
                           The proposed technique can be used for various modeling purposes like editing, hole filling or transition surface design.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Membrane energy functional

Thin plate energy functional

Normal vector field

Geometric modeling

@&#ABSTRACT@&#


               
               
                  This paper proposes a novel method for shape design of a Bézier surface with given boundary curves. The surface is defined as the minimizer of an extended membrane functional or an extended thin plate functional under the guidance of a specified normal field together with an initial prescribed surface. For given boundary curves and the guiding normal field, the free coefficients of a Bézier surface are obtained by solving a linear system. Unlike previous PDE based surface modeling techniques which construct surfaces just from boundaries, our proposed method can be used to generate smooth and fair surfaces that even follow a specified normal field. Several interesting examples are given to demonstrate the applications of the proposed method in geometric modeling.
               
            

@&#INTRODUCTION@&#

Functional optimization technique is a general approach to fair surface design [1–4]. Moreton and Séquin [1] proposed a method for the creation of smoothly connected surfaces of any genus or topological type. Welch and Witkin [2] achieved fair surfaces by functional optimization of the surface shape. The users were able to control the surface shape by attaching points and curves to the surface. Fair surface design can also be formulated as solving partial differential equations (PDEs) subject to geometric or physical constraints [5–12]. In literature [6], a system was proposed for global and local deformations of PDE-based surface models subject to physical constraints. At the same time, the system also computed the B-spline finite element approximation of the PDE surface and allowed users to interactively manipulate the surface.

The tensor product Bézier surfaces, B-spline surfaces and NURBS surfaces are widely used in surface shape design. By employing the technique of control points, these surfaces can be designed interactively. Generally, the parametric surfaces can be deformed by searching the control points and weights subject to the geometric constraints [13–19]. Hu et al. [20] proposed two methods for modifying the shape of NURBS surfaces with geometric constraints, such as points, normal vectors at selected points, and pre-constructed curves. Both methods are dedicated to changing the control points and weights of an initial surface. Sauvage et al. [21] addressed the deformation of B-spline surfaces while constraining the volume enclosed by the surface. Pusch et al. [22] proposed an algorithm for locally deforming either a parametric surface or a hierarchical subdivision surface to match a set of positional and energy minimizing constraints.

Among all functionals for fair surface design, Dirichlet functional [23] and bi-harmonic functional [24] are popular for generating smooth and fair surfaces that interpolate given boundary curves. However, surfaces generated by these two functionals have few degrees of freedoms for shape adjustment, and they cannot represent even cylinder or cone like surfaces which are widely used in CAD. The geometric PDE method can generate typical surfaces for shape modeling [25] and surface restoration [26]. But, these equations are hard to have analytic solutions due to high nonlinearity. For applications like transition surface design or hole filling, the interpolating surfaces may have salient features which should be controlled by additional parameters. This motivates us developing new functionals for fair surface design that have enough degrees of freedoms for shape adjustment as well as explicit solutions.

We propose to design Bézier surfaces with given borders by minimizing an extended membrane energy or an extended thin plate energy. Besides being as fair as possible, the resulting surface also fits to a prescribed normal vector field and an initial prescribed surface. Two shape parameters λ and γ are introduced to balance the effects of normal field and the initial surface. If λ and γ are chosen zero, the energy functional will degenerate to the Dirichlet functional or the bi-harmonic functional. The algorithm is easy to implement and the free control points of the surface are obtained by solving a linear system. For the convenience of adjusting the specified normal vector field, we can discretize the functional on a grid of parametric points and specify a discrete normal vector field. We have applied the proposed method for surface editing, hole filling and transition surface modeling.

The paper is organized as follows. In Section 2, an extended membrane energy functional and an extended thin plate energy functional are introduced. In Section 3, we propose explicit formulae for variational surface design under the guidance of normal vector field with given borders. Variational surface design under the guidance of discrete normal field is given in Section 4. In Section 5 we present several interesting examples. Section 6 concludes the paper.

In this section, we propose two new energy functionals for Bézier surface shape design. These functionals are defined on the space of Bézier patches 
                        R
                        :
                        Ω
                        →
                        
                           
                              R
                           
                           
                              3
                           
                        
                     . Assuming 
                        R
                        (
                        u
                        ,
                        v
                        )
                        =
                        
                           
                              ∑
                           
                           
                              i
                              =
                              0
                           
                           
                              n
                           
                        
                        
                           
                              ∑
                           
                           
                              j
                              =
                              0
                           
                           
                              m
                           
                        
                        
                           
                              B
                           
                           
                              i
                           
                           
                              n
                           
                        
                        (
                        u
                        )
                        
                           
                              B
                           
                           
                              j
                           
                           
                              m
                           
                        
                        (
                        v
                        )
                        
                           
                              P
                           
                           
                              ij
                           
                        
                      is the Bézier surface to be designed, 
                        N
                        (
                        u
                        ,
                        v
                        )
                        =
                        
                           
                              ∑
                           
                           
                              i
                              =
                              0
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                           
                        
                        
                           
                              ∑
                           
                           
                              j
                              =
                              0
                           
                           
                              
                                 
                                    m
                                 
                                 
                                    1
                                 
                              
                           
                        
                        
                           
                              B
                           
                           
                              i
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                           
                        
                        (
                        u
                        )
                        
                           
                              B
                           
                           
                              j
                           
                           
                              
                                 
                                    m
                                 
                                 
                                    1
                                 
                              
                           
                        
                        (
                        v
                        )
                        
                           
                              N
                           
                           
                              ij
                           
                        
                      is the prescribed normal function and 
                        S
                        (
                        u
                        ,
                        v
                        )
                        =
                        
                           
                              ∑
                           
                           
                              i
                              =
                              0
                           
                           
                              n
                           
                        
                        
                           
                              ∑
                           
                           
                              j
                              =
                              0
                           
                           
                              m
                           
                        
                        
                           
                              B
                           
                           
                              i
                           
                           
                              n
                           
                        
                        (
                        u
                        )
                        
                           
                              B
                           
                           
                              j
                           
                           
                              m
                           
                        
                        (
                        v
                        )
                        
                           
                              
                                 
                                    P
                                 
                                 
                                    ^
                                 
                              
                           
                           
                              ij
                           
                        
                      is the given Bézier surface. We would like to find a fair surface 
                        R
                        (
                        u
                        ,
                        v
                        )
                      that lies close to the given surface 
                        S
                        (
                        u
                        ,
                        v
                        )
                      and fits well to the known normal field 
                        N
                        (
                        u
                        ,
                        v
                        )
                     .

First, we extend the membrane energy functional by allowing the surface to follow the shape of a given normal field and an initial surface. The extended membrane energy functional is given by
                        
                           (1)
                           
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              (
                              R
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              {
                              
                                 
                                    R
                                 
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    R
                                 
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                              +
                              λ
                              [
                              
                                 
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          u
                                       
                                    
                                    ·
                                    N
                                    )
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          v
                                       
                                    
                                    ·
                                    N
                                    )
                                 
                                 
                                    2
                                 
                              
                              ]
                              +
                              γ
                              
                                 
                                    (
                                    R
                                    −
                                    S
                                    )
                                 
                                 
                                    2
                                 
                              
                              }
                              
                              du
                              
                              dv
                              ,
                           
                        
                     where 
                        
                           
                              R
                           
                           
                              u
                           
                        
                        ,
                        
                           
                              R
                           
                           
                              v
                           
                        
                      are the partial derivatives of 
                        R
                     , and 
                        λ
                        (
                        ≥
                        0
                        )
                     , 
                        γ
                        (
                        ≥
                        0
                        )
                      are the coefficients chosen by users. If 
                        λ
                        >
                        0
                     , the resulting surface fits to the prescribed normals. If 
                        γ
                        >
                        0
                     , the resulting surface follows the shape of the initial given surface also. The corresponding Euler–Lagrange equation of the functional is
                        
                           
                              0
                              =
                              (
                              I
                              +
                              λ
                              
                                 
                                    NN
                                 
                                 
                                    t
                                 
                              
                              )
                              (
                              
                                 
                                    R
                                 
                                 
                                    uu
                                 
                              
                              +
                              
                                 
                                    R
                                 
                                 
                                    vv
                                 
                              
                              )
                              +
                              λ
                              [
                              (
                              
                                 
                                    NN
                                 
                                 
                                    u
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    u
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    t
                                 
                              
                              )
                              
                                 
                                    R
                                 
                                 
                                    u
                                 
                              
                              +
                              (
                              
                                 
                                    NN
                                 
                                 
                                    v
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    v
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    t
                                 
                              
                              )
                              
                                 
                                    R
                                 
                                 
                                    v
                                 
                              
                              ]
                              −
                              γ
                              (
                              R
                              −
                              S
                              )
                              ,
                           
                        
                     where I is the identity matrix and t represents the transpose of a column vector. If both the coefficients λ and γ vanish, the functional reduces to the classical Dirichlet functional, and the corresponding Euler–Lagrange equation becomes the classical Laplacian equation.

Second, we extend the thin plate functional by using the prescribed normal field. In addition to interpolating the given boundary curves, the thin plate energy can be used to optimize surfaces that interpolate given tangent planes at the boundaries. In a similar fashion to the functional (1), the extended thin plate functional is defined as
                        
                           (2)
                           
                              
                                 
                                    E
                                 
                                 
                                    2
                                 
                              
                              (
                              R
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              {
                              
                                 
                                    R
                                 
                                 
                                    uu
                                 
                                 
                                    2
                                 
                              
                              +
                              2
                              
                                 
                                    R
                                 
                                 
                                    uv
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    R
                                 
                                 
                                    vv
                                 
                                 
                                    2
                                 
                              
                              +
                              λ
                              [
                              
                                 
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          u
                                       
                                    
                                    ·
                                    N
                                    )
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          v
                                       
                                    
                                    ·
                                    N
                                    )
                                 
                                 
                                    2
                                 
                              
                              ]
                              +
                              γ
                              
                                 
                                    (
                                    R
                                    −
                                    S
                                    )
                                 
                                 
                                    2
                                 
                              
                              }
                              
                              du
                              
                              dv
                              ,
                           
                        
                     where 
                        
                           
                              R
                           
                           
                              uu
                           
                        
                        ,
                        
                           
                              R
                           
                           
                              uv
                           
                        
                        ,
                        
                           
                              R
                           
                           
                              vv
                           
                        
                      are the second derivatives of R. The corresponding Euler–Lagrange equation for this functional is
                        
                           
                              0
                              =
                              
                                 
                                    R
                                 
                                 
                                    uuuu
                                 
                              
                              +
                              2
                              
                                 
                                    R
                                 
                                 
                                    uuvv
                                 
                              
                              +
                              
                                 
                                    R
                                 
                                 
                                    vvvv
                                 
                              
                              −
                              λ
                              
                                 
                                    NN
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    uu
                                 
                              
                              −
                              λ
                              
                                 
                                    NN
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    vv
                                 
                              
                              −
                              λ
                              [
                              (
                              
                                 
                                    NN
                                 
                                 
                                    u
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    u
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    t
                                 
                              
                              )
                              
                                 
                                    R
                                 
                                 
                                    u
                                 
                              
                              +
                              (
                              
                                 
                                    NN
                                 
                                 
                                    v
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    N
                                 
                                 
                                    v
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    t
                                 
                              
                              )
                              
                                 
                                    R
                                 
                                 
                                    v
                                 
                              
                              ]
                              +
                              γ
                              (
                              R
                              −
                              S
                              )
                              .
                           
                        
                     When the coefficients λ, γ vanish, the functional degenerates to the thin plate functional. The corresponding Euler–Lagrange equation becomes the biharmonic equation.

Though the minimizer of functional in Eq. (1) or in Eq. (2) can be characterized by the Euler–Lagrange equation, practical applications such as filling holes or designing transition surfaces usually need to solve fair surfaces with known boundaries. In the following we minimize the functional (1) or (2) by assuming the boundary curves or the boundary control points of a Bézier surface are already given. As the integrals in Eq. (1) or (2) can be computed explicitly, the free control points of the Bézier surface will be finally obtained by solving a linear system.

When we model a surface by minimizing the extended membrane energy functional with the given boundary curves, the minimization problem can be converted to solving the following system of equations. 
                           
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             E
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             P
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                                 =
                                 0
                                 
                                 (
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 −
                                 1
                                 ;
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 −
                                 1
                                 )
                                 .
                              
                           
                        Since the energy functional 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                           (
                           R
                           )
                         is a quadratic functional in terms of the unknown control points, the mentioned equations form a linear system.

Let
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 {
                                 [
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 (
                                 u
                                 )
                                 −
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 (
                                 u
                                 )
                                 ]
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 v
                                 )
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 (
                                 u
                                 )
                                 
                                    
                                       B
                                    
                                    
                                       l
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 v
                                 )
                                 (
                                 I
                                 +
                                 λ
                                 
                                    
                                       NN
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 }
                                 
                                 du
                                 
                                 dv
                                 ,
                                 
                                 k
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 −
                                 1
                                 ,
                                 l
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 m
                              
                           
                        and
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       m
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 {
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 u
                                 )
                                 [
                                 
                                    
                                       B
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 (
                                 v
                                 )
                                 −
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 (
                                 v
                                 )
                                 ]
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 u
                                 )
                                 
                                    
                                       B
                                    
                                    
                                       l
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 (
                                 v
                                 )
                                 (
                                 I
                                 +
                                 λ
                                 
                                    
                                       NN
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 }
                                 
                                 du
                                 
                                 dv
                                 ,
                                 
                                 k
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 l
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 −
                                 1
                              
                           
                        for 
                           i
                           ∈
                           {
                           1
                           ,
                           …
                           ,
                           n
                           −
                           1
                           }
                         and 
                           j
                           ∈
                           {
                           1
                           ,
                           …
                           ,
                           m
                           −
                           1
                           }
                        , we have the following proposition.
                           Proposition 1
                           
                              A Bézier surface 
                              
                                 R
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       0
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 u
                                 )
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 v
                                 )
                                 
                                    
                                       P
                                    
                                    
                                       ij
                                    
                                 
                               
                              is the extremal of the functional 
                              (1) 
                              with prescribed border if and only if the control points of the surface satisfy the following linear system:
                              
                                 
                                    (3)
                                    
                                       0
                                       =
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ,
                                             l
                                             =
                                             0
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                       (
                                       
                                          
                                             F
                                          
                                          
                                             kl
                                          
                                          
                                             ij
                                          
                                       
                                       +
                                       
                                          
                                             G
                                          
                                          
                                             kl
                                          
                                          
                                             ij
                                          
                                       
                                       +
                                       
                                          
                                             W
                                          
                                          
                                             kl
                                          
                                          
                                             ij
                                          
                                       
                                       )
                                       
                                          
                                             P
                                          
                                          
                                             kl
                                          
                                       
                                       −
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ,
                                             l
                                             =
                                             0
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             kl
                                          
                                          
                                             ij
                                          
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             kl
                                          
                                       
                                    
                                 
                              
                              for any 
                              
                                 i
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 −
                                 1
                                 }
                                 ,
                                 j
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 −
                                 1
                                 }
                              , where
                              
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             kl
                                          
                                          
                                             ij
                                          
                                       
                                       =
                                       {
                                       
                                          
                                             
                                                
                                                   −
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         0
                                                         l
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   k
                                                   =
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         k
                                                         −
                                                         1
                                                         ,
                                                         l
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         kl
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   n
                                                   −
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         n
                                                         −
                                                         1
                                                         ,
                                                         l
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   k
                                                   =
                                                   n
                                                   ,
                                                
                                             
                                          
                                       
                                       
                                          
                                             G
                                          
                                          
                                             kl
                                          
                                          
                                             ij
                                          
                                       
                                       =
                                       {
                                       
                                          
                                             
                                                
                                                   −
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         k
                                                         0
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   l
                                                   =
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         k
                                                         ,
                                                         l
                                                         −
                                                         1
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         kl
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   l
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   m
                                                   −
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         k
                                                         ,
                                                         m
                                                         −
                                                         1
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   l
                                                   =
                                                   m
                                                   ,
                                                
                                             
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             kl
                                          
                                          
                                             ij
                                          
                                       
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       γ
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       u
                                       )
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       v
                                       )
                                       
                                          
                                             B
                                          
                                          
                                             k
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       u
                                       )
                                       
                                          
                                             B
                                          
                                          
                                             l
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       v
                                       )
                                       
                                       du
                                       
                                       dv
                                       I
                                       ,
                                    
                                 
                              
                           

We compute the gradient of the functional with respect to each control point 
                                 
                                    
                                       P
                                    
                                    
                                       ij
                                    
                                 
                              . Denote 
                                 
                                    
                                       Δ
                                    
                                    
                                       10
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       kl
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       k
                                       +
                                       1
                                       ,
                                       l
                                    
                                 
                                 −
                                 
                                    
                                       P
                                    
                                    
                                       kl
                                    
                                 
                               and 
                                 
                                    
                                       Δ
                                    
                                    
                                       01
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       kl
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       k
                                       ,
                                       l
                                       +
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       P
                                    
                                    
                                       kl
                                    
                                 
                              . For any 
                                 i
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 −
                                 1
                                 }
                              , and any 
                                 j
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 −
                                 1
                                 }
                              , the gradient of functional E
                              1 is obtained as follows:
                                 
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   E
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   P
                                                
                                                
                                                   ij
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       {
                                       n
                                       [
                                       
                                          
                                             B
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       (
                                       u
                                       )
                                       −
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       (
                                       u
                                       )
                                       ]
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       v
                                       )
                                       
                                          
                                             R
                                          
                                          
                                             u
                                          
                                       
                                       +
                                       
                                          
                                             mB
                                          
                                          
                                             i
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       u
                                       )
                                       [
                                       
                                          
                                             B
                                          
                                          
                                             j
                                             −
                                             1
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       (
                                       v
                                       )
                                       −
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       (
                                       v
                                       )
                                       ]
                                       
                                          
                                             R
                                          
                                          
                                             v
                                          
                                       
                                       +
                                       λ
                                       n
                                       [
                                       
                                          
                                             B
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       (
                                       u
                                       )
                                       −
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       (
                                       u
                                       )
                                       ]
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       v
                                       )
                                       N
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             u
                                          
                                       
                                       ·
                                       N
                                       )
                                       +
                                       λ
                                       
                                          
                                             mB
                                          
                                          
                                             i
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       u
                                       )
                                       [
                                       
                                          
                                             B
                                          
                                          
                                             j
                                             −
                                             1
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       (
                                       v
                                       )
                                       −
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       (
                                       v
                                       )
                                       ]
                                       N
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             v
                                          
                                       
                                       ·
                                       N
                                       )
                                       +
                                       γ
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       u
                                       )
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       v
                                       )
                                       (
                                       R
                                       −
                                       S
                                       )
                                       }
                                       
                                       du
                                       
                                       dv
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       {
                                       n
                                       [
                                       
                                          
                                             B
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       (
                                       u
                                       )
                                       −
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       (
                                       u
                                       )
                                       ]
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       v
                                       )
                                       (
                                       I
                                       +
                                       λ
                                       
                                          
                                             NN
                                          
                                          
                                             t
                                          
                                       
                                       )
                                       
                                          
                                             R
                                          
                                          
                                             u
                                          
                                       
                                       +
                                       
                                          
                                             mB
                                          
                                          
                                             i
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       u
                                       )
                                       [
                                       
                                          
                                             B
                                          
                                          
                                             j
                                             −
                                             1
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       (
                                       v
                                       )
                                       −
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       (
                                       v
                                       )
                                       ]
                                       (
                                       I
                                       +
                                       λ
                                       
                                          
                                             NN
                                          
                                          
                                             t
                                          
                                       
                                       )
                                       
                                          
                                             R
                                          
                                          
                                             v
                                          
                                       
                                       +
                                       γ
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       u
                                       )
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       v
                                       )
                                       (
                                       R
                                       −
                                       S
                                       )
                                       }
                                       
                                       du
                                       
                                       dv
                                       =
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ,
                                             l
                                             =
                                             0
                                          
                                          
                                             n
                                             −
                                             1
                                             ,
                                             m
                                          
                                       
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       {
                                       [
                                       
                                          
                                             B
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       (
                                       u
                                       )
                                       −
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       (
                                       u
                                       )
                                       ]
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       v
                                       )
                                       
                                          
                                             B
                                          
                                          
                                             k
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       (
                                       u
                                       )
                                       
                                          
                                             B
                                          
                                          
                                             l
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       v
                                       )
                                       (
                                       I
                                       +
                                       λ
                                       
                                          
                                             NN
                                          
                                          
                                             t
                                          
                                       
                                       )
                                       }
                                       
                                       du
                                       
                                       dv
                                       
                                          
                                             Δ
                                          
                                          
                                             10
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             kl
                                          
                                       
                                       +
                                       
                                          
                                             m
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ,
                                             l
                                             =
                                             0
                                          
                                          
                                             n
                                             ,
                                             m
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       {
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       u
                                       )
                                       [
                                       
                                          
                                             B
                                          
                                          
                                             j
                                             −
                                             1
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       (
                                       v
                                       )
                                       −
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       (
                                       v
                                       )
                                       ]
                                       
                                          
                                             B
                                          
                                          
                                             k
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       u
                                       )
                                       
                                          
                                             B
                                          
                                          
                                             l
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       (
                                       v
                                       )
                                       (
                                       I
                                       +
                                       λ
                                       
                                          
                                             NN
                                          
                                          
                                             t
                                          
                                       
                                       )
                                       }
                                       
                                       du
                                       
                                       dv
                                       
                                          
                                             Δ
                                          
                                          
                                             01
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             kl
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ,
                                             l
                                             =
                                             0
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       γ
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       u
                                       )
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       v
                                       )
                                       
                                          
                                             B
                                          
                                          
                                             k
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       u
                                       )
                                       
                                          
                                             B
                                          
                                          
                                             l
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       v
                                       )
                                       
                                       du
                                       
                                       dv
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             kl
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             kl
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           

By denoting the coefficient matrices in above equation as 
                                 
                                    
                                       C
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                              , 
                                 
                                    
                                       D
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                               and 
                                 
                                    
                                       W
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                              , respectively, and further reformulating the differences 
                                 
                                    
                                       Δ
                                    
                                    
                                       10
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       kl
                                    
                                 
                               and 
                                 
                                    
                                       Δ
                                    
                                    
                                       10
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       kl
                                    
                                 
                              , we obtain
                                 
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   E
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   P
                                                
                                                
                                                   ij
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ,
                                             l
                                             =
                                             0
                                          
                                          
                                             n
                                             −
                                             1
                                             ,
                                             m
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             kl
                                          
                                          
                                             ij
                                          
                                       
                                       
                                          
                                             Δ
                                          
                                          
                                             10
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             kl
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ,
                                             l
                                             =
                                             0
                                          
                                          
                                             n
                                             ,
                                             m
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             D
                                          
                                          
                                             kl
                                          
                                          
                                             ij
                                          
                                       
                                       
                                          
                                             Δ
                                          
                                          
                                             10
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             kl
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ,
                                             l
                                             =
                                             0
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             kl
                                          
                                          
                                             ij
                                          
                                       
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             kl
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             kl
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ,
                                             l
                                             =
                                             0
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             kl
                                          
                                          
                                             ij
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             kl
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ,
                                             l
                                             =
                                             0
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                       
                                          
                                             G
                                          
                                          
                                             kl
                                          
                                          
                                             ij
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             kl
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ,
                                             l
                                             =
                                             0
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             kl
                                          
                                          
                                             ij
                                          
                                       
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             kl
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             kl
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ,
                                             l
                                             =
                                             0
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                       (
                                       
                                          
                                             F
                                          
                                          
                                             kl
                                          
                                          
                                             ij
                                          
                                       
                                       +
                                       
                                          
                                             G
                                          
                                          
                                             kl
                                          
                                          
                                             ij
                                          
                                       
                                       +
                                       
                                          
                                             W
                                          
                                          
                                             kl
                                          
                                          
                                             ij
                                          
                                       
                                       )
                                       
                                          
                                             P
                                          
                                          
                                             kl
                                          
                                       
                                       −
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ,
                                             l
                                             =
                                             0
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             kl
                                          
                                          
                                             ij
                                          
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             kl
                                          
                                       
                                       .
                                    
                                 
                              This leads the expression in Eq. (3).□

The linear system (3) can be written in the form of matrix equation, which takes the 
                           X
                           ,
                           Y
                           ,
                           Z
                         coordinates of the control points as the unknowns. When the coordinates of all unknown control points are obtained, a fair surface that interpolates given boundary curves and fits the guiding normal field will be generated.

Just like the thin plate energy functional, the extended thin plate energy functional permits the construction of surfaces with G
                        1 continuity with the surrounding surfaces. To achieve such a goal the outer two arrays of control points of a Bézier surface can be given in advance based on the continuity conditions while the remaining control points will be obtained by minimizing the functional (2) under the guidance of a given normal field. In a similar way to Section 3.1, we compute the control points where the gradient of the functional vanishes. From Eq. (2) we have
                           
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             E
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             P
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 {
                                 n
                                 (
                                 n
                                 −
                                 1
                                 )
                                 [
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       −
                                       2
                                    
                                    
                                       n
                                       −
                                       2
                                    
                                 
                                 (
                                 u
                                 )
                                 −
                                 2
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                    
                                       n
                                       −
                                       2
                                    
                                 
                                 (
                                 u
                                 )
                                 +
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                    
                                       n
                                       −
                                       2
                                    
                                 
                                 (
                                 u
                                 )
                                 ]
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 v
                                 )
                                 
                                    
                                       R
                                    
                                    
                                       uu
                                    
                                 
                                 +
                                 2
                                 nm
                                 [
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 (
                                 u
                                 )
                                 −
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 (
                                 u
                                 )
                                 ]
                                 [
                                 
                                    
                                       B
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 (
                                 v
                                 )
                                 −
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 (
                                 v
                                 )
                                 ]
                                 
                                    
                                       R
                                    
                                    
                                       uv
                                    
                                 
                                 +
                                 m
                                 (
                                 m
                                 −
                                 1
                                 )
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 u
                                 )
                                 [
                                 
                                    
                                       B
                                    
                                    
                                       j
                                       −
                                       2
                                    
                                    
                                       m
                                       −
                                       2
                                    
                                 
                                 (
                                 v
                                 )
                                 −
                                 2
                                 
                                    
                                       B
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                    
                                       m
                                       −
                                       2
                                    
                                 
                                 (
                                 v
                                 )
                                 +
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                    
                                       m
                                       −
                                       2
                                    
                                 
                                 (
                                 v
                                 )
                                 ]
                                 
                                    
                                       R
                                    
                                    
                                       vv
                                    
                                 
                                 +
                                 λ
                                 n
                                 [
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 (
                                 u
                                 )
                                 −
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 (
                                 u
                                 )
                                 ]
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 v
                                 )
                                 N
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       u
                                    
                                 
                                 ·
                                 N
                                 )
                                 +
                                 λ
                                 
                                    
                                       mB
                                    
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 u
                                 )
                                 [
                                 
                                    
                                       B
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 (
                                 v
                                 )
                                 −
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 (
                                 v
                                 )
                                 ]
                                 N
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       v
                                    
                                 
                                 ·
                                 N
                                 )
                                 +
                                 γ
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 u
                                 )
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 v
                                 )
                                 (
                                 R
                                 −
                                 S
                                 )
                                 }
                                 
                                 du
                                 
                                 dv
                                 =
                                 0
                              
                           
                        for 
                           i
                           ∈
                           {
                           2
                           ,
                           …
                           ,
                           n
                           −
                           2
                           }
                         and 
                           j
                           ∈
                           {
                           2
                           ,
                           …
                           ,
                           m
                           −
                           2
                           }
                        .

Particularly, we let
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 {
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       (
                                       n
                                       −
                                       1
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 [
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       −
                                       2
                                    
                                    
                                       n
                                       −
                                       2
                                    
                                 
                                 
                                    
                                       (
                                       u
                                       )
                                       −
                                       2
                                       
                                          
                                             B
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                          
                                             n
                                             −
                                             2
                                          
                                       
                                       (
                                       u
                                       )
                                       +
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             n
                                             −
                                             2
                                          
                                       
                                       (
                                       u
                                       )
                                       ]
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       v
                                       )
                                       
                                       
                                          
                                             B
                                          
                                          
                                             k
                                          
                                          
                                             n
                                             −
                                             2
                                          
                                       
                                       (
                                       u
                                       )
                                       
                                          
                                             B
                                          
                                          
                                             l
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       v
                                       )
                                       }
                                       
                                       du
                                       
                                       dv
                                       ,
                                       
                                          
                                             I
                                          
                                          
                                             kl
                                          
                                          
                                             ij
                                          
                                       
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       {
                                       2
                                       
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             m
                                          
                                          
                                             2
                                          
                                       
                                       [
                                       
                                          
                                             B
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       (
                                       u
                                       )
                                       −
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       (
                                       u
                                       )
                                       ]
                                       [
                                       
                                          
                                             B
                                          
                                          
                                             j
                                             −
                                             1
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       (
                                       v
                                       )
                                       −
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       (
                                       v
                                       )
                                       ]
                                       
                                       
                                          
                                             B
                                          
                                          
                                             k
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       (
                                       u
                                       )
                                       
                                          
                                             B
                                          
                                          
                                             l
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       (
                                       v
                                       )
                                       }
                                       
                                       du
                                       
                                       dv
                                       ,
                                       
                                          
                                             J
                                          
                                          
                                             kl
                                          
                                          
                                             ij
                                          
                                       
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       {
                                       
                                          
                                             m
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       m
                                       −
                                       1
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 u
                                 )
                                 [
                                 
                                    
                                       B
                                    
                                    
                                       j
                                       −
                                       2
                                    
                                    
                                       m
                                       −
                                       2
                                    
                                 
                                 (
                                 v
                                 )
                                 −
                                 2
                                 
                                    
                                       B
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                    
                                       m
                                       −
                                       2
                                    
                                 
                                 (
                                 v
                                 )
                                 +
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                    
                                       m
                                       −
                                       2
                                    
                                 
                                 (
                                 v
                                 )
                                 ]
                                 
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 u
                                 )
                                 
                                    
                                       B
                                    
                                    
                                       l
                                    
                                    
                                       m
                                       −
                                       2
                                    
                                 
                                 (
                                 v
                                 )
                                 }
                                 
                                 du
                                 
                                 dv
                                 ,
                                 
                                    
                                       L
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 λ
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 [
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 (
                                 u
                                 )
                                 −
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 (
                                 u
                                 )
                                 ]
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 v
                                 )
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 (
                                 u
                                 )
                                 
                                    
                                       B
                                    
                                    
                                       l
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 v
                                 )
                                 
                                    
                                       NN
                                    
                                    
                                       t
                                    
                                 
                                 
                                 du
                                 
                                 dv
                                 ,
                                 
                                    
                                       M
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 λ
                                 
                                    
                                       m
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 u
                                 )
                                 [
                                 
                                    
                                       B
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 (
                                 v
                                 )
                                 −
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 (
                                 v
                                 )
                                 ]
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 u
                                 )
                                 
                                    
                                       B
                                    
                                    
                                       l
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 (
                                 v
                                 )
                                 
                                    
                                       NN
                                    
                                    
                                       t
                                    
                                 
                                 
                                 du
                                 
                                 dv
                                 ,
                                 
                                    
                                       W
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 γ
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 u
                                 )
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 v
                                 )
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 u
                                 )
                                 
                                    
                                       B
                                    
                                    
                                       l
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 v
                                 )
                                 
                                 du
                                 
                                 dv
                                 I
                                 .
                              
                           
                        The equation 
                           ∂
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                           /
                           ∂
                           
                              
                                 P
                              
                              
                                 ij
                              
                           
                           =
                           0
                         becomes
                           
                              (4)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             E
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             P
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ,
                                       l
                                       =
                                       0
                                    
                                    
                                       n
                                       −
                                       2
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       Δ
                                    
                                    
                                       20
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       kl
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ,
                                       l
                                       =
                                       0
                                    
                                    
                                       n
                                       −
                                       1
                                       ,
                                       m
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       I
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       Δ
                                    
                                    
                                       11
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       kl
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ,
                                       l
                                       =
                                       0
                                    
                                    
                                       n
                                       ,
                                       m
                                       −
                                       2
                                    
                                 
                                 
                                    
                                       J
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       Δ
                                    
                                    
                                       02
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       kl
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ,
                                       l
                                       =
                                       0
                                    
                                    
                                       n
                                       −
                                       1
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       Δ
                                    
                                    
                                       10
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       kl
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ,
                                       l
                                       =
                                       0
                                    
                                    
                                       n
                                       ,
                                       m
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       Δ
                                    
                                    
                                       01
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       kl
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ,
                                       l
                                       =
                                       0
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       kl
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       kl
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ,
                                       l
                                       =
                                       0
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       kl
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ,
                                       l
                                       =
                                       0
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       kl
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ,
                                       l
                                       =
                                       0
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       kl
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ,
                                       l
                                       =
                                       0
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       kl
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ,
                                       l
                                       =
                                       0
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       kl
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ,
                                       l
                                       =
                                       0
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       kl
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       kl
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ,
                                       l
                                       =
                                       0
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 I
                                 +
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 I
                                 +
                                 
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 I
                                 +
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 +
                                 
                                    
                                       W
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 )
                                 
                                    
                                       P
                                    
                                    
                                       kl
                                    
                                 
                                 −
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ,
                                       l
                                       =
                                       0
                                    
                                    
                                       n
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       kl
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                        where
                           
                              
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   0
                                                   l
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             k
                                             =
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   1
                                                   l
                                                
                                                
                                                   ij
                                                
                                             
                                             −
                                             2
                                             
                                                
                                                   H
                                                
                                                
                                                   0
                                                   l
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             k
                                             =
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   kl
                                                
                                                
                                                   ij
                                                
                                             
                                             −
                                             2
                                             
                                                
                                                   H
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                   ,
                                                   l
                                                
                                                
                                                   ij
                                                
                                             
                                             +
                                             
                                                
                                                   H
                                                
                                                
                                                   k
                                                   −
                                                   2
                                                   ,
                                                   l
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             k
                                             =
                                             2
                                             ,
                                             …
                                             ,
                                             n
                                             −
                                             2
                                             ,
                                          
                                       
                                       
                                          
                                             −
                                             2
                                             
                                                
                                                   H
                                                
                                                
                                                   n
                                                   −
                                                   2
                                                   ,
                                                   l
                                                
                                                
                                                   ij
                                                
                                             
                                             +
                                             
                                                
                                                   H
                                                
                                                
                                                   n
                                                   −
                                                   3
                                                   ,
                                                   l
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             k
                                             =
                                             n
                                             −
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   n
                                                   −
                                                   2
                                                   ,
                                                   l
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             k
                                             =
                                             n
                                             ,
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   k
                                                   0
                                                
                                                
                                                   ij
                                                
                                             
                                             −
                                             
                                                
                                                   I
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                   ,
                                                   0
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             −
                                             1
                                             ,
                                             l
                                             =
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                   ,
                                                   m
                                                   −
                                                   1
                                                
                                                
                                                   ij
                                                
                                             
                                             −
                                             
                                                
                                                   I
                                                
                                                
                                                   k
                                                   ,
                                                   m
                                                   −
                                                   1
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             −
                                             1
                                             ,
                                             l
                                             =
                                             m
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   0
                                                   l
                                                
                                                
                                                   ij
                                                
                                             
                                             −
                                             
                                                
                                                   I
                                                
                                                
                                                   0
                                                   ,
                                                   l
                                                   −
                                                   1
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             k
                                             =
                                             0
                                             ,
                                             l
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             m
                                             −
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                   ,
                                                   l
                                                   −
                                                   1
                                                
                                                
                                                   ij
                                                
                                             
                                             −
                                             
                                                
                                                   I
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                   ,
                                                   l
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             k
                                             =
                                             n
                                             ,
                                             l
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             m
                                             −
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   kl
                                                
                                                
                                                   ij
                                                
                                             
                                             −
                                             
                                                
                                                   I
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                   ,
                                                   l
                                                
                                                
                                                   ij
                                                
                                             
                                             −
                                             
                                                
                                                   I
                                                
                                                
                                                   k
                                                   ,
                                                   l
                                                   −
                                                   1
                                                
                                                
                                                   ij
                                                
                                             
                                             +
                                             
                                                
                                                   I
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                   ,
                                                   l
                                                   −
                                                   1
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             −
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                          
                                             l
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             m
                                             −
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   00
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             k
                                             =
                                             0
                                             ,
                                             l
                                             =
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   I
                                                
                                                
                                                   0
                                                   ,
                                                   m
                                                   −
                                                   1
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             k
                                             =
                                             0
                                             ,
                                             l
                                             =
                                             m
                                             ,
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   I
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                   ,
                                                   0
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             k
                                             =
                                             n
                                             ,
                                             l
                                             =
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                   ,
                                                   m
                                                   −
                                                   1
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             k
                                             =
                                             n
                                             ,
                                             l
                                             =
                                             m
                                             ,
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   k
                                                   0
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             l
                                             =
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   k
                                                   1
                                                
                                                
                                                   ij
                                                
                                             
                                             −
                                             2
                                             
                                                
                                                   J
                                                
                                                
                                                   k
                                                   0
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             l
                                             =
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   kl
                                                
                                                
                                                   ij
                                                
                                             
                                             −
                                             2
                                             
                                                
                                                   J
                                                
                                                
                                                   k
                                                   ,
                                                   l
                                                   −
                                                   1
                                                
                                                
                                                   ij
                                                
                                             
                                             +
                                             
                                                
                                                   J
                                                
                                                
                                                   k
                                                   ,
                                                   l
                                                   −
                                                   2
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             l
                                             =
                                             2
                                             ,
                                             …
                                             ,
                                             m
                                             −
                                             2
                                             ,
                                          
                                       
                                       
                                          
                                             −
                                             2
                                             
                                                
                                                   J
                                                
                                                
                                                   k
                                                   ,
                                                   m
                                                   −
                                                   2
                                                
                                                
                                                   ij
                                                
                                             
                                             +
                                             
                                                
                                                   J
                                                
                                                
                                                   k
                                                   ,
                                                   m
                                                   −
                                                   3
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             l
                                             =
                                             m
                                             −
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   k
                                                   ,
                                                   m
                                                   −
                                                   2
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             l
                                             =
                                             m
                                             ,
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             −
                                             
                                                
                                                   L
                                                
                                                
                                                   0
                                                   l
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             k
                                             =
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                   ,
                                                   l
                                                
                                                
                                                   ij
                                                
                                             
                                             −
                                             
                                                
                                                   L
                                                
                                                
                                                   kl
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             −
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                   ,
                                                   l
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             k
                                             =
                                             n
                                             ,
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       kl
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             −
                                             
                                                
                                                   M
                                                
                                                
                                                   k
                                                   0
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             l
                                             =
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   M
                                                
                                                
                                                   k
                                                   ,
                                                   l
                                                   −
                                                   1
                                                
                                                
                                                   ij
                                                
                                             
                                             −
                                             
                                                
                                                   M
                                                
                                                
                                                   kl
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             l
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             m
                                             −
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   M
                                                
                                                
                                                   k
                                                   ,
                                                   m
                                                   −
                                                   1
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                          
                                          
                                             l
                                             =
                                             m
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

From Eq. (4) we know that the 
                           X
                           ,
                           Y
                           ,
                           Z
                         coordinates of the unknown control points 
                           
                              
                                 P
                              
                              
                                 ij
                              
                           
                         
                        
                           (
                           i
                           =
                           2
                           ,
                           3
                           ,
                           …
                           ,
                           n
                           −
                           2
                        ; 
                           j
                           =
                           2
                           ,
                           3
                           ,
                           …
                           ,
                           m
                           −
                           2
                        ) satisfy a system of linear equations. From the definition of the extended thin plate functional we know that the generated surface can interpolate the given boundary curves and the given tangent planes at the boundaries.

An expected way to define the guiding normal field for the extended membrane energy functional or the extended thin plate energy functional is by using unit normals. However, the continuous unit normal field is generally represented by irrational functions which makes the integrals hard to compute. To balance the computational efficiency and unit normal requirement the functional (1) or (2) can be defined discretely. Instead of defining a continuous normal field we assume that unit normal vectors are given at a dense set of sampled grid points.

We now explain the main idea by computing the discrete integral for the extended membrane energy functional, the discrete integral for the extended thin plate functional can be computed in the same way. Assuming 
                        
                           
                              {
                              N
                              (
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              }
                           
                           
                              
                                 
                                    i
                                 
                                 
                                    p
                                 
                              
                              ,
                              
                                 
                                    j
                                 
                                 
                                    p
                                 
                              
                              =
                              0
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    p
                                 
                              
                              ,
                              
                                 
                                    m
                                 
                                 
                                    p
                                 
                              
                           
                        
                      are a set of unit normals corresponding to a set of points 
                        S
                        (
                        
                           
                              u
                           
                           
                              
                                 
                                    i
                                 
                                 
                                    p
                                 
                              
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              
                                 
                                    j
                                 
                                 
                                    p
                                 
                              
                           
                        
                        )
                     , 
                        
                           
                              u
                           
                           
                              
                                 
                                    i
                                 
                                 
                                    p
                                 
                              
                           
                        
                        ∈
                        {
                        0
                        ,
                        1
                        /
                        
                           
                              n
                           
                           
                              p
                           
                        
                        ,
                        2
                        /
                        
                           
                              n
                           
                           
                              p
                           
                        
                        ,
                        …
                        ,
                        1
                        }
                     , 
                        
                           
                              v
                           
                           
                              
                                 
                                    j
                                 
                                 
                                    p
                                 
                              
                           
                        
                        ∈
                        {
                        0
                        ,
                        1
                        /
                        
                           
                              m
                           
                           
                              p
                           
                        
                        ,
                        2
                        /
                        
                           
                              m
                           
                           
                              p
                           
                        
                        ,
                        …
                        ,
                        1
                        }
                      on the Bézier surface 
                        S
                        (
                        u
                        ,
                        v
                        )
                     . The functional (1) can be computed discretely as follows:
                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              (
                              R
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                    =
                                    0
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              {
                              
                                 
                                    R
                                 
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              +
                              
                                 
                                    R
                                 
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              +
                              
                                 
                                    λ
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              
                                 
                                    (
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          u
                                       
                                    
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    )
                                    ·
                                    N
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              
                                 
                                    (
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          v
                                       
                                    
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    )
                                    ·
                                    N
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    γ
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              
                                 
                                    (
                                    R
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    )
                                    −
                                    S
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    2
                                 
                              
                              }
                              .
                           
                        
                     The weights 
                        
                           
                              λ
                           
                           
                              
                                 
                                    i
                                 
                                 
                                    p
                                 
                              
                              ,
                              
                                 
                                    j
                                 
                                 
                                    p
                                 
                              
                           
                        
                      and 
                        
                           
                              γ
                           
                           
                              
                                 
                                    i
                                 
                                 
                                    p
                                 
                              
                              ,
                              
                                 
                                    j
                                 
                                 
                                    p
                                 
                              
                           
                        
                      are non-negative numbers corresponding to the sampled normals 
                        N
                        (
                        
                           
                              u
                           
                           
                              
                                 
                                    i
                                 
                                 
                                    p
                                 
                              
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              
                                 
                                    j
                                 
                                 
                                    p
                                 
                              
                           
                        
                        )
                      or sampled points 
                        S
                        (
                        
                           
                              u
                           
                           
                              
                                 
                                    i
                                 
                                 
                                    p
                                 
                              
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              
                                 
                                    j
                                 
                                 
                                    p
                                 
                              
                           
                        
                        )
                     . These weights can be chosen as a same value or different values for different normals or different points depending on various application purposes. Particularly, one can highlight surface features in some region by defining proper normal vectors 
                        N
                        (
                        
                           
                              u
                           
                           
                              
                                 
                                    i
                                 
                                 
                                    p
                                 
                              
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              
                                 
                                    j
                                 
                                 
                                    p
                                 
                              
                           
                        
                        )
                      and choosing large values for the weights 
                        
                           
                              λ
                           
                           
                              
                                 
                                    i
                                 
                                 
                                    p
                                 
                              
                              ,
                              
                                 
                                    j
                                 
                                 
                                    p
                                 
                              
                           
                        
                     . An example of preserving surface features based on normal constraint was given in [27].

With given boundary curves together with their control points, the objective functional 
                        
                           
                              
                                 
                                    E
                                 
                                 
                                    ^
                                 
                              
                           
                           
                              1
                           
                        
                        (
                        R
                        )
                      is just the function of the inner control points of the Bézier surface. It follows that the free control points can be obtained by solving the following system:
                        
                           (6)
                           
                              
                                 
                                    ∂
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          P
                                       
                                       
                                          ij
                                       
                                    
                                 
                              
                              =
                              0
                              
                              (
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                              −
                              1
                              ;
                              j
                              =
                              1
                              ,
                              …
                              ,
                              m
                              −
                              1
                              )
                              .
                           
                        
                     
                  

Let
                        
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                    =
                                    0
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              [
                              
                                 
                                    B
                                 
                                 
                                    i
                                    −
                                    1
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              −
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              ]
                              
                                 
                                    B
                                 
                                 
                                    j
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              
                                 
                                    B
                                 
                                 
                                    k
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              
                                 
                                    B
                                 
                                 
                                    l
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              
                              ×
                              (
                              I
                              +
                              λ
                              N
                              (
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              
                                 
                                    N
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              )
                              ,
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                    =
                                    0
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              [
                              
                                 
                                    B
                                 
                                 
                                    j
                                    −
                                    1
                                 
                                 
                                    m
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              −
                              
                                 
                                    B
                                 
                                 
                                    j
                                 
                                 
                                    m
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              ]
                              
                                 
                                    B
                                 
                                 
                                    k
                                 
                                 
                                    n
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              
                                 
                                    B
                                 
                                 
                                    l
                                 
                                 
                                    m
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              
                              ×
                              (
                              I
                              +
                              λ
                              N
                              (
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              
                                 
                                    N
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              )
                              .
                           
                        
                     
                  

Based on Eq. (6), the coordinates of the unknown control points 
                        
                           
                              P
                           
                           
                              ij
                           
                        
                      (
                        i
                        =
                        1
                        ,
                        …
                        ,
                        n
                        −
                        1
                     ; 
                        j
                        =
                        1
                        ,
                        …
                        ,
                        m
                        −
                        1
                     ) satisfy the following linear system:
                        
                           (7)
                           
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    ,
                                    l
                                    =
                                    0
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    ij
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    ij
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    ij
                                 
                              
                              )
                              
                                 
                                    P
                                 
                                 
                                    kl
                                 
                              
                              −
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    ,
                                    l
                                    =
                                    0
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                              
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    ij
                                 
                              
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    kl
                                 
                              
                              =
                              0
                           
                        
                     for any 
                        i
                        ∈
                        {
                        1
                        ,
                        …
                        ,
                        n
                        −
                        1
                        }
                        ,
                        j
                        ∈
                        {
                        1
                        ,
                        …
                        ,
                        m
                        −
                        1
                        }
                     , where
                        
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    ij
                                 
                              
                              =
                              {
                              
                                 
                                    
                                       
                                          −
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                0
                                                l
                                             
                                             
                                                ij
                                             
                                          
                                          ,
                                       
                                       
                                          k
                                          =
                                          0
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                k
                                                −
                                                1
                                                ,
                                                l
                                             
                                             
                                                ij
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                kl
                                             
                                             
                                                ij
                                             
                                          
                                          ,
                                       
                                       
                                          k
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          −
                                          1
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                n
                                                −
                                                1
                                                ,
                                                l
                                             
                                             
                                                ij
                                             
                                          
                                          ,
                                       
                                       
                                          k
                                          =
                                          n
                                          ,
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    ij
                                 
                              
                              =
                              {
                              
                                 
                                    
                                       
                                          −
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                k
                                                0
                                             
                                             
                                                ij
                                             
                                          
                                          ,
                                       
                                       
                                          l
                                          =
                                          0
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                k
                                                ,
                                                l
                                                −
                                                1
                                             
                                             
                                                ij
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                kl
                                             
                                             
                                                ij
                                             
                                          
                                          ,
                                       
                                       
                                          l
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          m
                                          −
                                          1
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                k
                                                ,
                                                m
                                                −
                                                1
                                             
                                             
                                                ij
                                             
                                          
                                          ,
                                       
                                       
                                          l
                                          =
                                          m
                                          ,
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    kl
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                    =
                                    0
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              γ
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              
                                 
                                    B
                                 
                                 
                                    j
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              
                                 
                                    B
                                 
                                 
                                    k
                                 
                                 
                                    n
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              
                                 
                                    B
                                 
                                 
                                    l
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              )
                              I
                              .
                           
                        
                     
                  

The system can be solved in the same way as in the previous section and a final surface that interpolates the given boundary curves will be generated.

In this section, we present a few examples to demonstrate the effects of surface shape design under normal field guidance. For each example we first construct an initial surface interpolating the given boundary curves, and then we design a guiding normal field for the surface. The final surface is obtained by solving the optimization problem. Besides the guiding normal field, the final surface can also be adjusted by changing the parameters λ and γ.


                     Fig. 1
                      illustrates an example of surface modeling by optimizing the extended membrane functional (1). An initial Bézier surface of order 5×5 is given with two different guiding normal fields; see Fig. 1(a) and (e) for the initial surface and the normal fields. By fixing the boundary curves and minimizing the energy functional with various choices of parameters λ and γ, we obtain several surface shapes shown as the remaining sub-figures of Fig. 1. From the figure we can see that the final surface follows the guiding normal field or the initial surface well when the parameter λ or γ has been increased, respectively.

In the following two figures we present examples of surface modeling under the guidance of discrete normal fields. Particularly, the parameter γ is chosen zero for these two figures.


                     Fig. 2
                     (a) illustrates an initial Bézier surface of order 8×8. The prescribed normal field is drawn in red, as shown in Fig. 2(b). This is a hat shape with wave edge. Based on the initial Bézier surface and the prescribed normal field, we can edit the surface shape by choosing different values for the parameter λ when the extended membrane energy functional is minimized. Fig. 2(d)–(f) illustrates the surfaces obtained by choosing different values for the parameter λ but choosing zero for the parameter γ. Obviously, the top of the new hat is flat. As a comparison, the Bézier surface which minimizes the Dirichlet functional is given in Fig. 2(c).

The initial surface illustrated in Fig. 3
                     (a) is the same as the surface given in Fig. 2(a) but the prescribed normal field has been changed. The surfaces shown in Fig. 3(b)–(d) are generated by optimizing the discrete extended membrane energy functional with different choices of values for the parameter λ. For each figure the parameter λ is chosen the same value for all the sampled points. Clearly, the greater the value of λ is, the more obvious the feature of the resulting surface is.


                     Fig. 4
                      illustrates an example of hole filling by optimizing the thin plate functional or the extended thin plate functional. A hole with a set of surrounding patches is shown in Fig. 4(a) and we will fill the hole by a Bézier patch of degrees 7×7. To guarantee the G
                     1 continuity at the borders, the outer two arrays of control points are given in advance based on the border curves and the tangent planes at the borders. When we compute the remaining control points for the Bézier surface by minimizing the thin plate energy, a smooth interpolating surface is obtained; see Fig. 4(b) for the filling surface and Fig. 4(e) for the control mesh of the surface. If we set a guiding normal field for filling the hole, a Bézier surface that interpolates the given boundary data but minimizing the extended thin plate energy is obtained. Fig. 4(c) and (f) illustrates the filling surface and the control mesh of the surface, respectively. Comparing with the ground truth surface (Fig. 4(d)), the guiding normal field can help to restore salient features well.

Finally, we present two examples of blending surface modeling by optimizing the extended thin plate energy functional (2). For each example a bi-quintic Bézier surface is used as the transition surface between two given surfaces; see Fig. 5
                     (a) and d for the initial surfaces. To guarantee the G
                     1 continuity between the transition surface and the surrounding surfaces, two arrays of boundary control points of the Bézier surface are given in advance. The surfaces generated by minimizing the thin plate energy are given in Fig. 5(b) and (e), respectively. From the figures we can see that the surfaces do not preserve the features well. When we add a guiding normal field for each surface and refine the surface to a new one by optimizing the extended thin plate energy, we obtain two surfaces following the surface features very well; see Fig. 5(c) and (f) for the obtained two transition surfaces.

@&#CONCLUSION@&#

In this paper, we have proposed two extended energy optimization models for surface shape design. Particularly, a surface can be designed or deformed by the extended membrane energy functional or the extended thin plate functional under the guidance of specified normal fields. The proposed method allows us to adjust the surface shape, while the discrete normal fields could be used for the local shape control with the increment of corresponding weights. When the surfaces and the guiding normal fields are represented by Bézier patches, the free control points of the Bézier surface can be obtained by solving a linear system. Besides the surface modeling purpose, the proposed method can be used for surface editing, hole filling and transition surface design, etc.

The authors declare no conflict of interest associated with this manuscript.

@&#ACKNOWLEDGMENT@&#

We owe thanks to reviewers for their helpful comments and suggestions. This work is supported by NNSF of China grants (11290142, 61272300).

@&#REFERENCES@&#

