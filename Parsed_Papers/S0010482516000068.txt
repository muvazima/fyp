@&#MAIN-TITLE@&#Wheezing recognition algorithm using recordings of respiratory sounds at the mouth in a pediatric population

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We recorded by Smartphone respiratory sounds at the mouth in pediatric population.


                        
                        
                           
                           Two clinical operators validated the presence or absence of wheezing in 97 toddlers.


                        
                        
                           
                           We used Short-Time Fourier Transform and SVM classifier for wheeze recognition.


                        
                        
                           
                           71.4% Sensitivity and 88.9% Specificity were observed for wheeze detection.


                        
                        
                           
                           An independent test found a fair agreement with a clinical operator.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Automated wheezing detection

Childhood asthma

Bronchiolitis

Support vector machine

ROC analysis

@&#ABSTRACT@&#


               
               
                  Background
                  Respiratory diseases in children are a common reason for physician visits. A diagnostic difficulty arises when parents hear wheezing that is no longer present during the medical consultation. Thus, an outpatient objective tool for recognition of wheezing is of clinical value.
               
               
                  Method
                  We developed a wheezing recognition algorithm from recorded respiratory sounds with a Smartphone placed near the mouth. A total of 186 recordings were obtained in a pediatric emergency department, mostly in toddlers (mean age 20 months). After exclusion of recordings with artefacts and those with a single clinical operator auscultation, 95 recordings with the agreement of two operators on auscultation diagnosis (27 with wheezing and 68 without) were subjected to a two phase algorithm (signal analysis and pattern classifier using machine learning algorithms) to classify records.
               
               
                  Results
                  The best performance (71.4% sensitivity and 88.9% specificity) was observed with a Support Vector Machine-based algorithm. We further tested the algorithm over a set of 39 recordings having a single operator and found a fair agreement (kappa=0.28, CI95% [0.12, 0.45]) between the algorithm and the operator.
               
               
                  Conclusions
                  The main advantage of such an algorithm is its use in contact-free sound recording, thus valuable in the pediatric population.
               
            

@&#INTRODUCTION@&#

Asthma is the most common chronic disorder in children. Asthma in preschool children can be difficult to diagnose, and doctors must rely on children׳s medical histories, signs and symptoms, and physical exams to make a diagnosis. Wheezing is a whistling or squeaky sound that occurs while breathing and is an important argument for asthma diagnosis. This fluctuating sign is often absent on the day of examination, and doctors have to rely on abnormal respiratory sounds reported by parents. Unfortunately, parental understanding of wheeze may include whistling, squeaking or gasping sounds, or a different style, rate or timbre of breathing. For instance, Cane and McKenzie used a panel of video clips of children with audible wheezing that was shown to 190 parents [1]. The “correct” labeling of wheeze was reported in 59% of the cases. Another difficulty in identifying wheezing is that even its identification by doctors is operator-dependent. It has been shown that the inter-operator agreement ranges between chance and almost perfect agreement [2]. Therefore, it appears crucial to possess an objective tool permitting the identification of wheezing.

The acoustical definition of wheezing represents an objective definition. In a recent general review of lung auscultation technique [3], wheezing was defined as a musical, high-pitched sound, heard on inspiration, expiration or both, and was characterized by sinusoidal oscillations with sound energy in the range of 100 to 1000Hz and duration of at least 100ms. The frequency range given for wheeze allows it to be differentiated from another bronchial sound, rhonchus, which has a lower pitch [3]. This definition of wheeze is close to the definition of the European Respiratory Society, which was published in 2000 in the Computerized Respiratory Sound Analysis (CORSA) guidelines [4]. Wheeze was defined by periodic waveforms with a dominant frequency usually over 100Hz and duration of at least 100ms. On theoretical grounds, an objective acoustical definition would solve the problem of wheezing recognition. However, this acoustical definition is somewhat arbitrary and other definitions can be found in the literature [5]. Moreover, the definition probably suffers from a low specificity that has led investigators to record respiratory sounds in quiet environments and use automatic methods of analysis. The automated analysis of respiratory sounds is a rapidly growing field with increasing interest from medical societies (as attested by the recently created Breath sounds Task Force from the European Respiratory Society). One of the most common analysis methods is based on the use of Fast Fourier Transform [6–8]; some other engineering methods are based on “linear predictive coding” [9,10], wavelet transform [11,12] or “mel-frequency cepstral coefficients” (MFCC) [13]. These analysis methods allow the determination of signal-based features that are subsequently used in machine learning algorithms, the most common of which are Logistic Regression, Artificial Neural Network (ANN) [12,14,15], Gaussian Mixture Models [16] or Support Vector Machine (SVM). A review comparing the different machine learning algorithms applied to respiratory sound classification into normal and wheeze classes has been published [16]. In all these studies the authors employed contact sensors for sound acquisition. While the use of contact sensors may have some advantages, such as lower sensitivity to background sounds propagated through air, they also have some drawbacks. For instance, they are more vulnerable to sound conducted through body tissues and spurious rubbing sounds. Moreover contact sensors can be difficult to attach and maintain, especially in pediatric subjects (not to mention the risk of cross contamination of patients). Thus, to our best knowledge this is the first study whose purpose is to analyze wheezing sounds acquired with a contact-free microphone.

The objectives of our study were to recognize wheeze in the pediatric population using a sound recording made at the mouth with a Smartphone of a subject presenting abnormal lung auscultation. To this end, we specifically extracted features compatible with wheezing based on its acoustic definition and then evaluated two different machine learning algorithms. To clearly present our research, we present in the Materials and Methods section the block diagram of the proposed algorithm in 
                     Fig.1, and then in the first and in the second subsections we present the protocol of data acquisition and some preliminary results. The third subsection is devoted to the description of the study population. In the subsequent subsections we explain the used signal analysis algorithm and give the explanatory elements that allowed extracting the features. The last subsection describes the theoretical bases of the various machine learning algorithms. The third section focuses on results: clinical examination and distribution of features between the two groups. The reduced number of features to be used in the machine learning algorithm and the decision threshold are further described. The discussion and conclusions of the paper are assembled in the last section.

The diagram of the algorithm is given in Fig. 1. The overall approach consists of four phases: first, recording of the sound with a Smartphone microphone, second, conception of the analysis algorithm that yields a set of features of the signal that are employed in the third phase, in which a pattern classifier is trained. The last step validates the classifier and evaluates its performance.

The recording of respiratory sounds is performed with the principal microphone (SP0410HR5H-PB, distributed by Knowles Electronics, Itasca, IL, USA) of the Nexus 4™ Smartphone (Google, Mountain View, CA, USA). This microphone consists of an acoustic sensor, a low noise input buffer, and an output amplifier. Its sensitivity at 94dB SPL @ 1kHz is −42dBV/Pa and has a frequency response curve presenting less than 0.1% variation in the 100–4000Hz zone. This microphone (or similar ones) is used by most of the Smartphone manufacturers on the market.

The recording itself was made by the operator of the study (PB) by placing the microphone close to the mouth of the patient (at a target distance of 5–10cm). The duration of the recording was 30s (a range of 20–40s is accepted, based on the cooperation of the child). The recording software used was “Easy Voice Recorder”™ (by Digipom, Longueuil, QC, Canada), which is available for download on Google Play (free license). The sampling frequency was 16kHz and we used the WAV (Waveform Audio File Format) with a single channel. All of the recordings were subsequently downloaded on a PC computer where mathematical analysis and programming were performed using Octave.

The site of respiratory sound acquisition in this study was chosen to be a few centimeters away from the mouth of the patient, with the microphone of the Smartphone directed towards the patient. This choice was made as an attempt to achieve contact-free sound acquisition but also to avoid signal distortions from the contact with the skin and from filtering of the signal by the neck wall. In previous studies, authors have chosen more often to apply the microphone to the neck over the trachea [17], but we believe that this method is hindered by the low-pass filtering of the neck wall. To illustrate this, we performed a series of preliminary experiments where recordings were made on the same patient at two sites: over the trachea and close to the mouth (
                        Fig. 2).


                        Fig. 2 shows a recording obtained from a 2 month-old patient, who was hospitalized for bronchiolitis and presented wheezing at lung auscultation (as attested by an experienced pediatric respiratory physician, BM). For this recording, we used a SHURE™ Beta 57A supercardioid dynamic microphone with a 44.1kHz sampling rate.

High frequency harmonics are attenuated and the mean frequency of the wheezing signal detected by our algorithm was 250Hz in the case of a recording over the neck (Fig. 2b), whilst it was 900Hz in the case of signal acquired at the mouth (Fig. 2a).

The spectrograms of the recordings are in the bottom, recognized signals as wheezing are labeled (“+” signs). The value of the floating variable y is given at the top. It is given a value of 1 if the analyzed segment contains wheezing, and 0 otherwise.

The study was carried out on a pediatric population consulting in an emergency medical unit or being hospitalized in the pediatric ward of a general hospital (Centre Hospitalier de Fontainebleau) during the winter season of 2013–2014. A total of 186 recordings were made (see flow chart in 
                        Fig. 3). Children were eligible if they (1) were between 1 day and 12 years old, (2) were consulting in the emergency medical unit or were hospitalized in the pediatric ward, (3) presented abnormal respiratory sounds at initial clinical evaluation (at least one sound: wheezing, crackles, rhonchus, acute laryngitis, rhinitis), and (4) had chest auscultation according to a standardized protocol. The written informed consent of at least one parent was required before enrollment, and the study protocol was approved by The Institutional Review Board of the French learned society for respiratory medicine (CEPRO 2013-Delclaux).

The key exclusion criterion was the presence of baby vocals or crying noises for longer than 50% of the recording length. For that reason, 34 of the 186 initial recordings were discarded.

Since it has been demonstrated that the identification of wheezing is operator-dependent, only recordings with operator agreement (two operators) on auscultation diagnosis (presence or absence of wheezing) were included in the training and validation sets of the machine learning algorithm. The first operator was systematically the main investigator (PB: senior year resident), whereas the second operator was either the senior pediatrician or the resident on duty in the emergency unit at the moment of inclusion of the patient.

As seen in Fig. 3, for 39 recordings, there was only one operator and those were not used in the development of the algorithm. Nevertheless, these recordings were employed in the testing phase of the algorithm where the agreement between the operator and the pattern recognition algorithm was evaluated.

The final set included 95 recordings (68 without wheezing versus 27 with wheezing). Initially, 29 wheezing-containing recordings were identified. The analysis of one of them gave an empty matrix so it was disregarded from the dataset, another one contained repeated clock noises that were artificially selected as wheeze-compatible by the analysis algorithm and was also disregarded from the dataset.

We therefore divided this set into a training set, containing 70 recordings (or 60% of the set) with 20 wheeze-containing recordings, and a validation set containing the resting recordings. The groups were assembled in order to obtain approximately the same proportion of wheezing positive recordings in each group, chosen in alphabetical order.

The raw data of a given WAV recording was divided into overlapping segments of length 64 ms with 50% overlap using a Hanning window (
                        Fig. 4a). Then, the signal from each interval was filtered using an autoregressive model [9]. This model permits linking the signal at time step, n, to the signal at the p previous time steps:
                           
                              (1)
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    
                                       [
                                       n
                                       ]
                                    
                                    =
                                    −
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       p
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       
                                          [
                                          
                                             n
                                             −
                                             k
                                          
                                          ]
                                       
                                       +
                                       ε
                                       
                                          [
                                          n
                                          ]
                                       
                                    
                                 
                              
                           
                        where p is the order of the model, 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              
                                 [
                                 n
                                 ]
                              
                           
                         is the signal amplitude at the n time step in the ith signal interval, 
                           
                              
                                 a
                              
                              
                                 k
                              
                           
                         is the parameter of the model of order k, and 
                           
                              ε
                              
                                 [
                                 n
                                 ]
                              
                           
                         is a random white noise with variance 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    2
                                 
                              
                           
                        .

A 61 order autoregressive model using the whitening lattice-filter method of Burg was used to fit the initial data and we present in Fig. 4b the FFT of the autoregressive model and of the initial signal. The order of the model was fit to achieve the best power spectral density peak detection. Thus, we achieved a noise-free model that detected local maxima in the Fourier spectrum permitting the identification of wheezing.

A calculation of the power spectral density (PSD) is obtained by the following formula:
                           
                              (2)
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       (
                                       ω
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                Δ
                                             
                                             2
                                          
                                       
                                       
                                          
                                             
                                                |
                                                
                                                   1
                                                   +
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      p
                                                   
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            −
                                                            j
                                                            k
                                                            ω
                                                         
                                                      
                                                   
                                                
                                                |
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 P
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                              
                           
                         is the PSD of the signal 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                         as a function of the frequency ω.

We used the function arburg in Octave to obtain an autoregressive model of the signal and the function ar_psd to calculate the power spectral density (PSD) by FFT.

Feature selection is a technique of selecting a subset of relevant features for building a robust classifier. We chose to work with a set of 14 features based on the acoustic definition of wheezing and thus expecting to give the best differentiation between the two groups.

The calculation of the features was performed over the whole sound recording.

We thus defined 
                           
                              
                                 F
                              
                              
                                 1.
                                 .
                                 14
                              
                           
                         as follows:


                        
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              mean
                              
                                 (
                                 
                                    
                                       
                                          f
                                       
                                       
                                          i
                                       
                                       
                                          1.
                                          .
                                          
                                             
                                                N
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                           
                         with i the harmonic order (fundamental or second harmonic), f, the mean frequency of a given wheezing segment and N
                        
                           i
                         the number of wheezing compatible signals detected in a given recording for each harmonic.
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          3
                                          ,
                                          4
                                       
                                    
                                    =
                                    
                                       
                                          [
                                          
                                             max
                                             
                                                (
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         1.
                                                         .
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                             min
                                             
                                                (
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         1.
                                                         .
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                          ]
                                       
                                       /
                                       
                                          mean
                                          
                                             (
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      1.
                                                      .
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          5
                                          ,
                                          6
                                       
                                    
                                    =
                                    mean
                                    
                                       (
                                       
                                          
                                             
                                                PSD
                                             
                                             
                                                i
                                             
                                             
                                                1.
                                                .
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

We defined 
                           
                              
                                 PSD
                              
                              
                                 i
                              
                              
                                 m
                              
                           
                         as the mean PSD over the time intervals included in a given wheezing m for the harmonic i:
                           
                              
                                 
                                    PSD
                                    i
                                    m
                                 
                                 =
                                 mean
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   f
                                                   ∈
                                                   F
                                                
                                             
                                             
                                                PSD
                                                i
                                             
                                             
                                                f
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   f
                                                   l
                                                
                                                
                                                   f
                                                   L
                                                
                                             
                                             PSD
                                             
                                                f
                                             
                                          
                                       
                                    
                                    
                                       intervals
                                       
                                       included
                                       
                                       in
                                       
                                       wheezing
                                       
                                       m
                                    
                                 
                              
                           
                        where f
                        
                           l
                        =200Hz and f
                        
                           L
                        =2500Hz are the boundary frequency for the calculation of the mean PSD, while F is the set of frequencies corresponding to the definition of a wheezing peak (Fig. 1).
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          7
                                          ,
                                          8
                                       
                                    
                                    =
                                    
                                       
                                          [
                                          
                                             max
                                             
                                                (
                                                
                                                   
                                                      
                                                         PSD
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         1.
                                                         .
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                             min
                                             
                                                (
                                                
                                                   
                                                      
                                                         PSD
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         1.
                                                         .
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                          ]
                                       
                                       /
                                       
                                          mean
                                          
                                             (
                                             
                                                
                                                   
                                                      PSD
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      1.
                                                      .
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    F
                                 
                                 
                                    9
                                    ,
                                    10
                                 
                              
                              =
                              mean
                              
                                 (
                                 
                                    
                                       
                                          τ
                                       
                                       
                                          i
                                       
                                       
                                          1.
                                          .
                                          
                                             
                                                N
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                           
                         where τ is the duration of the ith harmonic of a given wheezing,


                        
                           
                              F
                              
                                 11
                                 ,
                                 12
                              
                           
                           =
                           
                              
                                 max
                                 
                                    
                                       τ
                                       i
                                       
                                          1.
                                          .
                                          
                                             N
                                             i
                                          
                                       
                                    
                                 
                                 −
                                 
                                 min
                                 
                                    
                                       τ
                                       i
                                       
                                          1.
                                          .
                                          
                                             N
                                             i
                                          
                                       
                                    
                                 
                              
                           
                           /
                           mean
                           
                              
                                 τ
                                 i
                                 
                                    1.
                                    .
                                    
                                       N
                                       i
                                    
                                 
                              
                           
                           
                        and 
                           
                              
                                 
                                    F
                                 
                                 
                                    13
                                    ,
                                    14
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             τ
                                          
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 T
                              
                           
                         with T the total duration of the recording.

In 
                        Fig. 5, we give the spectrogram representation of wheezing identified on lung auscultation (Fig. 5a), and of a cry (Fig. 5b) recorded for the same child. A wheeze compatible signal is defined as having three or fewer detectable harmonics on each time segment [18] and duration of at least 100ms [3] provided the other conditions listed in Fig. 1 are met. The minimal duration of 100ms of each wheezing compatible signal was assured by tracking the spectral crests on successive temporal segments. The maximum frequency variation in a sequence of consecutive time segments admitted in order to consider a given segment as belonging to a wheezing was 20%. In Fig. 5a the represented wheezes are mixed (inspiratory and expiratory) with predominant inspiratory part.

The signal analysis algorithm was more thoroughly tested on a set of artificial and clinical sounds (see Supplementary material).

In order to achieve better separation of the positive from the negative examples, rescaling was performed on the features.

In a further step of the conception of the algorithm, we tried to reduce the dimension of the feature matrix, keeping most of the variance permitting to observe a stable pattern classifier. For that purpose, we computed and diagonalized the covariance matrix 
                           Σ
                         that allowed reducing the dimensions of the feature matrix by truncating the eigenvector matrix of dimensions n×n to n×k thus retaining a given fraction of the variance. This fraction is given by the ratio of the sum of the first k eigenvalues divided by the sum of all the eigenvalues.

Two machine learning algorithms were used in this work: Logistic Regression (LR) and Support Vector Machine (SVM).

The LR algorithm is a linear algorithm, which uses several independent features to estimate the probability of a categorical event. Namely, the probability estimation is given by
                           
                              (3)
                              
                                 
                                    P
                                    
                                       (
                                       
                                          y
                                          =
                                          1
                                          
                                             |
                                             
                                                x
                                                ;
                                                θ
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          h
                                       
                                       
                                          ϑ
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    
                                       1
                                       
                                          1
                                          +
                                          
                                             
                                                e
                                             
                                             
                                                −
                                                
                                                   
                                                      θ
                                                   
                                                   T
                                                
                                                x
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In Eq. (3), x is the features vector of 
                           
                              n
                              +
                              1
                           
                         dimensions (
                           
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              =
                              1
                           
                        ,
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                        , …,
                           
                              
                                 x
                              
                              
                                 n
                              
                           
                        ) and 
                           θ
                         is the parameters vector with components (
                           
                              
                                 ϑ
                              
                              
                                 0
                              
                           
                        , 
                           
                              
                                 ϑ
                              
                              
                                 1
                              
                           
                        , …, 
                           
                              
                                 ϑ
                              
                              
                                 n
                              
                           
                        ).

The output of the algorithm is a probability (continuous variable between 0 and 1) of a categorical event. Applying an optimal threshold (α) results in either “zero” for the absence of wheezing (y=0) or “one” for the presence of wheezing (y=1) in a given recording. There is a “training phase” of the algorithm where labeled examples of wheezing-containing recordings and no wheeze-detected recordings are given to the algorithm. During this phase, a set of parameters is determined by minimizing a cost function.

Giving a training set of m examples 
                           
                              {
                              
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 ..
                                 .
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                          
                                             (
                                             m
                                             )
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             (
                                             m
                                             )
                                          
                                       
                                    
                                    )
                                 
                              
                              }
                           
                         with 
                           
                              x
                              ∈
                              
                                 
                                    ℜ
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                           
                         and 
                           
                              y
                              ∈
                              
                                 {
                                 
                                    0
                                    ,
                                    1
                                 
                                 }
                              
                           
                         one can write the cost function of the LR algorithm as follows:
                           
                              (4)
                              
                                 
                                    J
                                    
                                       (
                                       θ
                                       )
                                    
                                    =
                                    −
                                    
                                       1
                                       m
                                    
                                    
                                       {
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             [
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                                
                                                lg
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            ϑ
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  (
                                                                  j
                                                                  )
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   (
                                                   
                                                      1
                                                      −
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            (
                                                            j
                                                            )
                                                         
                                                      
                                                   
                                                   )
                                                
                                                lg
                                                
                                                   (
                                                   
                                                      1
                                                      −
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            (
                                                            j
                                                            )
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                             ]
                                          
                                       
                                       }
                                    
                                    +
                                    
                                       λ
                                       
                                          2
                                          m
                                       
                                    
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       
                                          
                                             ϑ
                                          
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In Eq. (4), 
                           λ
                         is the regularization parameter and the minimizing of 
                           
                              J
                              
                                 (
                                 θ
                                 )
                              
                           
                         fits the parameters vector 
                           θ
                        .

The SVM algorithm is designed to separate more effectively the negative and positive examples by using a cost function that values zero if 
                           
                              
                                 
                                    θ
                                 
                                 T
                              
                              
                                 
                                    x
                                 
                                 
                                    (
                                    j
                                    )
                                 
                              
                              ≥
                              1
                           
                         (in the case of 
                           
                              
                                 
                                    y
                                 
                                 
                                    (
                                    j
                                    )
                                 
                              
                              =
                              1
                           
                        ) and if 
                           
                              
                                 
                                    θ
                                 
                                 T
                              
                              
                                 
                                    x
                                 
                                 
                                    (
                                    j
                                    )
                                 
                              
                              ≤
                              −
                              1
                           
                         (in the case of 
                           
                              
                                 
                                    y
                                 
                                 
                                    (
                                    j
                                    )
                                 
                              
                              =
                              0
                           
                        ). The new cost function is written as
                           
                              (5)
                              
                                 
                                    J
                                    
                                       (
                                       
                                          θ
                                       
                                       )
                                    
                                    =
                                    C
                                    
                                       {
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                m
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      (
                                                      
                                                         j
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      cos
                                                      
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            (
                                                            
                                                               j
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   (
                                                   
                                                      1
                                                      −
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            (
                                                            
                                                               j
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      cos
                                                      
                                                      t
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            (
                                                            
                                                               j
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                             ]
                                          
                                       
                                       }
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          
                                             ϑ
                                          
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In Eq. (5), beside the modification in the cost function, a regularization term is added, the importance of which in the overall cost depends on the constant C, with cos
                        t
                        1 and cos
                        t
                        0 being the new cost functions corresponding to y=1 and y=0, respectively.

We used an SVM algorithm with Gaussian kernels because the decision boundary is expected to be non-linear.

When using a Gaussian kernel for a given 
                           x
                        , new features are computed depending on the proximity of a given 
                           x
                         to the landmarks 
                           
                              
                                 l
                              
                              
                                 
                                    (
                                    1
                                    )
                                 
                                 ,
                                 ..
                                 .
                                 ,
                                 
                                    (
                                    m
                                    )
                                 
                              
                           
                        . Landmarks are given by the examples in the training set.

In this manner, a new set of features is built and in the case of Gaussian kernels, the feature vector 
                           f
                         for a given 
                           x
                         can be written as follows:
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   0
                                                
                                             
                                             =
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             exp
                                             
                                                (
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            
                                                               ‖
                                                               
                                                                  x
                                                                  −
                                                                  
                                                                     
                                                                        l
                                                                     
                                                                     
                                                                        (
                                                                        1
                                                                        )
                                                                     
                                                                  
                                                               
                                                               ‖
                                                            
                                                            2
                                                         
                                                      
                                                      
                                                         2
                                                         
                                                            
                                                               σ
                                                            
                                                            2
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          ⋮
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   m
                                                
                                             
                                             =
                                             exp
                                             
                                                (
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            
                                                               ‖
                                                               
                                                                  x
                                                                  −
                                                                  
                                                                     
                                                                        l
                                                                     
                                                                     
                                                                        (
                                                                        m
                                                                        )
                                                                     
                                                                  
                                                               
                                                               ‖
                                                            
                                                            2
                                                         
                                                      
                                                      
                                                         2
                                                         
                                                            
                                                               σ
                                                            
                                                            2
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In Eq. (6), 
                           
                              
                                 σ
                              
                              2
                           
                         is a parameter of the Gaussian kernel that defines the steepness of the rise of the feature around the landmark. Hence, 
                           
                              f
                              ∈
                              
                                 
                                    ℜ
                                 
                                 
                                    m
                                    +
                                    1
                                 
                              
                           
                         and the new cost function can be written:
                           
                              (7)
                              
                                 
                                    J
                                    
                                       (
                                       θ
                                       )
                                    
                                    =
                                    C
                                    
                                       {
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             [
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                                
                                                   
                                                      cost
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                         T
                                                      
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            (
                                                            j
                                                            )
                                                         
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   (
                                                   
                                                      1
                                                      −
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            (
                                                            j
                                                            )
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      cost
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                         T
                                                      
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            (
                                                            j
                                                            )
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                             ]
                                          
                                       
                                       }
                                    
                                    +
                                    
                                       1
                                       2
                                    
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       m
                                    
                                    
                                       
                                          
                                             ϑ
                                          
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     

This cost function is convex and therefore a global minimum is calculated by minimizing Eq. (7).

The performances of the classifiers are evaluated by comparing their predictions to the diagnosis given by the physician. The performance of each test is given by its ability to identify true positives while excluding false positives. Thus, the two quantities that are commonly used are the specificity (SP), which is defined as the probability that a normal person is classified as normal, and the sensitivity (SE), which is defined as the probability that a diseased person is classified as diseased:
                           
                              (8)
                              
                                 
                                    Specificity
                                    
                                    (
                                    SP
                                    )
                                    
                                    =
                                    
                                       
                                          TN
                                       
                                       
                                          TN
                                          +
                                          FP
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    Sensitivity
                                    
                                    (
                                    SE
                                    )
                                    
                                    =
                                    
                                       
                                          TP
                                       
                                       
                                          TP
                                          +
                                          FN
                                       
                                    
                                 
                              
                           
                        where TP, FN, FP, and TN are the amount of the true positive, false negative, false positive and true negative test results, respectively.

The receiver operating characteristic (ROC) curve is the continuous function of sensitivity versus (1-specificity) across all possible values of the threshold above which the test is considered positive. The area under the curve (AUC) provides a single measure that summarizes the discriminative ability of the classifier through a full range of thresholds [19].

Following the definition of SE and SP (Eqs. (8 and 9)), it is clear that both quantities depend on the threshold (α) for the probability P (Eq. (3)). We define SE
                           c
                         and SP
                           c
                         as the values of sensitivity and specificity, respectively, which correspond to the conventional threshold α=0.5.

Several methods exist permitting the optimal value of α to be determined, resulting in the best tradeoff between SE and SP [19]. We chose the simple method based on the calculation of the F
                        1 score defined as
                           
                              (10)
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          2
                                          
                                             TN
                                          
                                       
                                       
                                          2
                                          
                                             TP
                                          
                                          +
                                          
                                             FN
                                          
                                          +
                                          
                                             FP
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The number of features to be used in the algorithm was set by the maximum of F
                        1c
                         on the validation set while progressively changing the number of features. The optimal value of α is given by the maximum of F1(α) on the validation set.

We used the non-parametric two-tailed statistical Mann–Whitney test to compare clinical and signal analysis features between the two groups (with and without wheezing). The significance level of the type I error was set to 5%. We used the Kolmogorov–Smirnov distribution theory to calculate 95% confidence intervals for SE and SP of the algorithms. The AUC was calculated by the trapezoidal rate and parametric statistics are applied to it [20]. Z-score was used to test the null hypothesis and to compare AUC between the LR and the SVM algorithms. In the latter case, the correlation between the classifiers was evaluated by the Kendall tau as the results were obtained from an ordinal scale [21]. In order to address the inter-operator agreement, we used Cohen׳s kappa [22]. These tests were also used to quantify the agreement between a pattern classifier and an operator on the test set. The null hypothesis confounding the value of kappa to be no different from that expected by chance was tested according to Fleiss et al. [23] assuming the superiority of the pattern classifier (one-tailed p value).

@&#RESULTS@&#


                        
                        Table 1 describes the distribution of the clinical characteristics of the 95 patients whose recordings constituted the training and the validation sets. We observed that children with wheezing were more often hospitalized after presentation at the EMU which was not surprising as they were more often diagnosed with bronchiolitis. There were no other differences in clinical features (age, other respiratory sounds, etc.) between the two groups.

In 
                        Table 2 we show the comparison of the features obtained by signal analysis of the recordings. All the recordings were containing sounds compatible with wheezing based on its acoustical definition. As seen, the relative frequency variability of the first harmonic (F3) is significantly different between the two groups and the difference between the groups in the mean frequency of the second harmonic has almost attained significance (F2). These differences suggest that the most important differentiating feature between the groups lies in the frequency definition, as a pure first harmonic, i.e. having less variability in a given recording and a frequency of the second harmonic that is approximately the double of the fundamental are features that are associated with the acoustical definition of wheezing. This result also stresses that a specific acoustic definition of wheezing cannot be given.

In this section, we present the contingency tables for operator 1 (PB) and the resident (
                        Table 3) and for operator 1 and the senior pediatrician (
                        Table 4) that were implied in patient clinical examination.

Thus, we see that the first operator (PB) seemed to exhibit a better agreement with the senior pediatrician (kappa: 0.86, 95% CI: [0.78; 0.94], p<0.0001) than with the resident (kappa: 0.58, 95% CI: [0.49; 0.67], p<0.0001).

We also calculated the overall agreement between PB and the mixed (resident/senior pediatrician) operator over all the recordings, thus obtaining a kappa of 0.68 reflecting a substantial agreement, 95% CI [0.61; 0.75], p<0.0001.

The results of the training using a LR-based algorithm without regularization (i.e. 
                           
                              λ
                              =
                              0
                           
                        ) are shown in 
                        Table 5. A rationale for the choice of λ=0 is given as Supplemental Results in Supplementary material. By principal component analysis, we studied the LR-based algorithm׳s performances as a function of the number of features, and the best performances were observed with 11 and 12 feature-based algorithms. We chose to use 11 feature-based algorithm owing to the possible improvement of the numerical stability when using fewer features. This choice retained 97% of the variance.

The ROC analysis of the validation set permitted the decision threshold to be fixed to 0.35, corresponding to the highest F1 score (0.667), overall accuracy of 80% and a sensitivity and specificity of 71% and 83%, respectively (
                        Fig. 6). There were 4 misclassified examples. Two were in the group, wheezing; the first one corresponded to a case of acute laryngitis attested by the two clinical operators in a 3.5 year-old child, while the other concerned a 2 month-old baby presenting bronchiolitis. The two other misclassified examples were in the group without wheezing and were labeled by the clinical operators as acute laryngitis; one of them presented added artifact sounds like clock noises.

The results obtained with the SVM-based algorithm are shown in 
                        Table 6. As previously stated, by using principal component analysis, we studied the algorithm׳s performances as a function of the number of features and found comparable performances over the validation set in the range 2–14 features. Perfect (SE
                           c
                        =100, SP
                           c
                        =100) performances were obtained on the training set for all numbers of features; those evaluations are not shown.

Acceptable performances of the algorithm were observed with 2 features and we chose this configuration because of the expected better numerical stability.

We chose to work with the two features-based SVM algorithm which retained 52.5% of the variance. Only one set of C and 
                           σ
                         variables (see Eqs. (6) and (7)) permitted a solution to be observed that was independent of the initial values of parameters theta (
                           
                              C
                              =
                              1
                           
                        , 
                           
                              σ
                              =
                              0.1
                           
                        ).

The decision threshold was fixed to 1.1e−8, which resulted in the best F1 score of 0.714, overall classification accuracy of 84% and the observed sensibility and specificity over the validation set were 71% and 89%, respectively (
                        Figs. 6 and 7).

Here as well, four recordings were misclassified. Among the two in the wheezing group, the first corresponded to the same recording in a 3.5 year-old child with acute laryngitis that was also misclassified by the LR-based algorithm; the second was the recording of a 2 year-old child who presented bronchial rhonchus and wheezing on lung auscultation. In the absence of wheezing group, two recordings were misclassified; the first corresponded to a child admitted to the emergency department for acute asthma who did not present any wheezing on admission but presented some after bronchodilator aerosol administration, while the other corresponded to a 1.5 year-old child, who presented upper airways respiratory noises. Both operators diagnosed obstructive rhinitis in the latter child.


                        Fig. 7 shows the decision boundary (blue line) for the SVM-based algorithm using the 2 reduced features and the decision threshold of 1.1e−8. This frontier is formed by all of the points in the plane that have a probability that equals the decision threshold.

In Fig. 6, we present the resulting ROC curves for the LR- and SVM-based algorithms over the validation set and the confidence intervals for the SP and the SE. The use of the Kolmogorov–Smirnov distribution theory gave a 95% CI of 0.48 for the sensitivity and 0.31 for the specificity. The observed area under the curve (AUC) was 0.806 for the LR- and 0.893 for the SVM-based algorithms, respectively (
                        Table 7).

We observed a statistically significant difference from the chance diagonal for both algorithms. We also tested the statistical difference between the two algorithms. The Kendall tau, representing the correlation between the two areas, was 0.08 and the corresponding Z-score was 0.655, which gave a p-value of 0.51 for a two-tailed hypothesis, thus rejecting the hypothesis assuming a difference between the two algorithms.

The performance of the LR-based algorithm was also evaluated on the set of 39 recordings presenting only one operator (test set). This set included 31 recordings with lung auscultation by PB, 6 recordings with lung auscultation by the resident and the two remaining recordings presented lung auscultation by the senior pediatrician. This sample was evaluated since we have previously shown that the agreement between the operators was substantial (kappa=0.68).

Thus, the inter-operator agreement was evaluated by Cohen׳s kappa coefficient. A calculation of sensibility and specificity of the algorithm is not possible on this set as it is not evaluated by the “gold standard”, i.e. the double operators׳ concomitant examination. The contingency table of the LR-based algorithm is given in 
                        Table 8.

The overall agreement was 64%, and the inter-operator agreement between the clinical operator and the algorithm was modest (kappa=0.06, 95% CI [−0.11; 0.22]) and was not significantly different from the agreement expected by chance (one-tailed p-value p=0.357).

We also tested the performance of the SVM-based algorithm on the test set. Its contingency table is given in 
                        Table 9. The overall agreement was of 71.8% and Cohen׳s kappa was 0.28, 95% CI [0.12; 0.45]. The observed agreement was statistically significant (p=0.038). We conclude that the SVM-based algorithm performed better on the test set.

@&#DISCUSSION AND CONCLUSION@&#

In this study, one of the conditions for a peak in the power spectrum to be considered as wheezing was that the peak width at 95% of the peak power should be less than 40Hz. The value of 40Hz is close to the value of 70Hz chosen by Taplidou et al. [8]. Signal resolution is given by 1 over the time span of the signal segment. This means that the signal resolution should be no less than 20Hz, and thus the minimal time length of a segment is 50ms. On the other hand, a time segment longer than 100ms exposes us to the risk of failing to detect wheezing. Hence, an acceptable time resolution should lie somewhere between 50ms and 100ms. In Oletic et al. [24], the authors present a review of wheeze detection algorithms based on short-time Fourier transform signal decomposition. The temporal resolution reported in different studies spanned from 8.2ms to 170.6ms, thus the value chosen by us lies within the limits of this interval.

Bahoura [16] showed that a feature set composed by MFCC in combination with Gaussian mixture model had the best performances in terms of specificity and sensitivity in detecting wheezes. The author used a combined database consisting exclusively of the R.A.L.E. database [25]. Several points hinder the implementation of Bahoura׳s work in the context of this study. First, we used recordings made close to the mouth that is very different from recordings made by microphones applied to the skin as mainly breath sounds and noises originated from the nasal cavity are added to the signal. Second, the population of this study is pediatric and it has been mentioned in Bahoura that wheezing signal depends on the age [16]. This fact hinders the comparison between works not based on age-matched populations. Third, our work was done on signal with low signal-to-noise ratio, and thus recorded wheezes were to be differentiated from breath sounds and many other noises. As illustrated in Table 1, approximately 30% of all recordings with wheezes contained nose or throat originated sounds, 20% contained crackles and one third rhonchi.

The SVM-based learning algorithm has been used previously in wheeze detection algorithms by other authors [26,27] and more specifically in the pediatric population by Mazic et al. [28]. In the latter study, the authors used MFCC in combination with a two level ensemble classifier composed by two SVM-based algorithms. They found that the maximal difference between the central frequencies (defined as the arithmetic mean calculated from the upper and lower cut-off frequencies) of the tested wheeze and its closest neighbor from the training set should be less than 60Hz. As suggested by the authors, this observation could be MFCC related. Moreover, we reported in Table 2 that the mean of the fundamental harmonic in the wheezing positive set was 399±106Hz, with a minimal mean frequency of 301Hz and maximal mean frequency of 736Hz. These observations could diminish the efficiency of MFCC-based features in the pediatric population. In a recent study by Mendes et al. [29] the authors suggest that features based on wheeze signature in the spectrogram space are the best feature set for the robust detection of wheezes, moreover a significant boost in performance was obtained by using around ten features.

When referring to wheezes, often a distinction is made between monophonic and polyphonic wheezes. Thus, it is justified to ask whether the described algorithm could detect both types of wheezing. Historically, monophonic wheeze was first defined by Paul Forgacs [30]. He stated that “The sound produced by”…“a bronchus almost completely occluded by a tumor”…“is a single musical note, in other words, a monophonic wheeze”. Forgacs defined polyphonic wheeze as “confined to expiration and consists of several harmonically unrelated musical notes, starting and ending simultaneously, like a dissonant chord”. Nevertheless, confusion persists, and another definition can be found defining the polyphonic wheeze as wheeze that contains several frequencies and the monophonic wheeze as a wheeze containing essentially a single frequency [4,31,32]. This confusion has led some authors to propose machine learning algorithms separating polyphonic from monophonic wheezes, as Ulukaya et al. [33] using the monofrequency definition for monophonic wheeze. In conclusion, in the case where the monophonic wheeze is defined by the presence of a single harmonic and the polyphonic wheeze by the presence of several harmonics, the algorithm described in this work should allow an equivalent detection of both. If the polyphonic wheeze is represented by a superposition of several notes, the proposed algorithm could not produce an optimal detection.

The design of a pattern classifier for wheezing in the pediatric population suspected of bronchiolitis is challenging. According to some authors [35,36] infants could have a different type of wheezing that is acoustically characterized by complex repetitive sound waves, more similar to rhonchi or snoring than to the typical wheeze of older patients with asthma. It is possible that this type of wheezing reflects a different sound source, e.g. secretions in large airways. Pasterkamp et al. in [36] suggested that acoustic measurements would be needed to define a prognostic significance of different wheeze patterns, i.e., to determine if wheezy infants with complex repetitive sounds rather than typical wheezes may be at lower risk for future manifestation of asthma.

Previous studies have already used Smartphones for wheezing recognition by applying the Smartphone׳s microphone to the neck over the trachea [17] and contact-free data acquisition systems were also used in respiratory sounds analysis [34]. To our best knowledge, this is the first time that a system combining the two approaches is used.

The novelty of this approach is also that the features are extracted over the whole recording containing other pathological noises. The observed sensitivity and specificity of the classifier is acceptable and comparable to the other methods previously reported in the literature. In the meta-analysis of Gurung et al. [37], the authors report an overall sensitivity for automated wheezing detection of 80% (95% CI 72–86%) and specificity of 85% (95% CI 78–91%), which are close to those observed (71% and 89%, respectively) with the SVM classifier.

An important feature of our study is the inclusion of each patient only once in the recording set; in this way, we alleviate any sampling bias that can be an important criticism for previous studies [10,15,16].

Another study using a comparable technique of recording in an intensive care unit setting [38] evaluated the sensitivity and specificity of the PulmoTrack™ (Karmel Sonix Ltd., Haifa, Israel) system, an instrument developed for the continuous tracking and recording of breath sounds and the detection of wheezing. The PulmoTrack system uses 5 piezoelectric contact sensors applied over the right and left axillae and both posterior bases of the lung. The sensors are piezoelectric elements with linear frequency response from 75 to 2000Hz, a usable range that extends beyond 4kHz, and a built-in passive ambient noise rejection capability. With this set up, wheeze detection is performed by a FFT-based algorithm, allowing a sensitivity of 91% and specificity of 89% in wheeze detection when compared to a panel of pulmonary experts who performed auscultation of the same respiratory sound [39]. In the clinical study of Prodhan et al. [38], the sensitivity and the specificity observed with the same device were only 75% (95% CI 57.9–87.0%) and 76% (95% CI 60.5–87.1%), respectively. This could be explained by the fact that the recordings were made in a noisy environment, as previously reported [15].

Güler et al. [14] used a combined neural network and a genetic algorithm trained on 129 features representing the 129 points of the logarithm of the PSD values obtained from the lung sound in a randomly chosen full breath cycle. Lung sounds were obtained from 96 subjects; 56 of them had suffered from pulmonary diseases. The sounds were classified as normal, wheeze and crackles by a panel of pulmonary physicians, based on the detection of adventitious sounds on auditory and visual inspection of the sound signal and its waveform. Lung sounds from the chest wall were recorded in quiet room using an electret microphone. The authors used ROC analysis in order to compare different neural networks and found an AUC of 0.949 for the best performing algorithm on the test set. Based on the number of recordings included in the test set, we compared the performances of the algorithm and the SVM-based algorithm described in this paper. The observed Z-score was 0.616, resulting in a two-tailed p-value of 0.538. Thus, one cannot conclude in any difference in the performance of the two algorithms.

The number of recordings used in the validation set (n=25) was restricted. We further used a test set of 39 recordings with only one standardized auscultation since good agreement was observed between the operators. Nevertheless, this simple test could be to the detriment of the performance of our classifier because there was no “gold standard” diagnosis of wheezing (agreement of two operators). Therefore, the classifier will be further evaluated in a larger group of children.

Our study also has several strengths related to the potential developments of the classifier. The sound recording requires no contact with the child, no standardized environment and only a standard Smartphone. For instance, parents could record abnormal breath sounds and provide the recording to health workers to obtain a diagnosis. Health workers (medical doctors, nurses, physiotherapists) who are interested in identifying a respiratory sound but lacking the experience to assure the authenticity of a sound based only on the results of the clinical examination could benefit from a proved algorithm of wheeze identification.

Another application of the algorithm is possible in the settings of a controlled clinical trial, where response to a given medication is judged on the importance of clinical examination, for example to authenticate the disappearance of wheezing after the administration of a bronchodilator drug.

Another possible application of the technology is during the methacholine challenge test in preschool children in which the endpoint remains challenging [40].

In conclusion, we present in this paper a new method permitting the recognition of wheezing by the acoustical analysis of the recorded sound. Our approach consists of recording the sound using a microphone in a Smartphone placed in the vicinity of the mouth. No physical contact with the patent is required, which is particularly valuable in pediatric patients.

@&#ACKNOWLEDGMENT@&#

The authors would like to thank Dr. Pascal Sonier, chief of the pediatric service in Hôpital de Fontainebleau for his assistance.

Supplementary data associated with this article can be found in the online version at doi:10.1016/j.compbiomed.2016.01.002.


                     
                        
                           
                              Supplementary material
                           
                           
                        
                     
                  

@&#REFERENCES@&#

