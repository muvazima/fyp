@&#MAIN-TITLE@&#National-strategic investment in European power transmission capacity

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We formulate a three-stage equilibrium model for strategic network investment.


                        
                        
                           
                           Zonal regulators upgrade domestic power lines to shift welfare towards their constituents.


                        
                        
                           
                           The failure to reach the first-best investment is illustrated using a four-node network.


                        
                        
                           
                           We propose a variation of disjunctive constraints to solve GNE/EPEC-type problems.


                        
                        
                           
                           This approach does not require a priori assumptions on the valuation of shared constraints.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Electricity transmission

Network expansion

Generalized Nash equilibrium (GNE)

Mixed-integer equilibrium problem under equilibrium constraints (MI-EPEC)

@&#ABSTRACT@&#


               
               
                  The transformation of the European electricity system requires substantial investment in transmission capacity to facilitate cross-border trade and to efficiently integrate renewable energy sources. However, network planning in the EU is still mainly a national prerogative. In contrast to other studies aiming to identify the pan-European (continental) welfare-optimal transmission expansion, we investigate the impact of zonal planners deciding on network investment strategically, with the aim of maximizing the sum of consumer surplus, generator profits and congestion rents in their jurisdiction. This reflects the inadequacy of current mechanisms to compensate for welfare re-allocations across national boundaries arising from network upgrades.
                  We propose a three-stage equilibrium model to describe the Nash game between zonal planners (i.e., national governments, regulators, or system operators), each taking into account the impact of network expansion on the electricity spot market and the resulting welfare effects on the constituents within its jurisdiction. We propose a novel way to solve the resulting GNE/EPEC-type problem using a variation of a disjunctive constraints reformulation. This allows to solve this problem without a priori assumptions on the relative valuation of shared constraints by each player.
                  Using a four-node sample network, we identify several Nash equilibria of the game between the zonal planners. This example illustrates the failure to reach the first-best welfare expansion in the absence of an effective framework for cross-border cost-benefit allocation.
               
            

Over the past decades, applications in the context of the electricity sector have driven many developments in the Operations Research literature. This holds both with regard to the formulation of elaborate optimisation and equilibrium models as well as many improvements of numerical and computational methods to solve large-scale, real-world problems (Hobbs & Litvinov, 2014; Smeers, 1997).

Electricity is a rather peculiar commodity: first, it is not feasible to store power in large quantities, and this puts constraints on the dispatch of power plants and demand. It must be guaranteed that the system is balanced in every instant, or “the lights go out”. Second, the physical and electrical-engineering characteristics of alternate-current (AC) power flow in meshed networks are very complicated due to the presence of loop flows and the non-convex dynamics of electricity. A network operator has only very limited means to influence how power is routed across the network. Third, most power plants exhibit considerable ramp-up time, and once they are operating, they have to obey minimum-generation constraints; accurately describing the unit commitment problem (i.e., the on-off decision) requires binary variables, which increases computational complexity considerably. This makes it also challenging to find market-clearing prices (O’Neill, Sotkiewicz, Hobbs, Rothkopf, & Stewart, 2005). In combination, these properties make modelling electricity systems, the markets associated with them, and the efficient operation of the grid a formidable challenge.

Today, locational-pricing mixed-integer programs are used to determine the efficient operation of most US power markets; the Federal Energy Regulatory Commission (FERC) is currently pushing to include the characteristics of AC power flow in these models, to replace the commonly used engineering-economic models relying on linearised, so-called direct-current load flow (DCLF) formulations.
                        1
                     
                     
                        1
                        The term DCLF is actually a misnomer, as it is not based on the assumption of direct-current electricity flows; instead, it is a linearisation of the non-convex alternating-current (AC) power flow model. See http://www.ferc.gov/industries/electric/indus-act/market-planning/opf-papers.asp
 for an overview of papers within this project, accessed February 19, 2015.
                      Other recent work focuses on changing the network topology (i.e., line switching) to mediate congestion and improve efficiency of grid operation (e.g., Villumsen & Philpott, 2012).

The difficulties of modelling electricity are made even more challenging due to the uncertain nature of supply and demand. Appropriate levels of backup and security margins must be ensured to remedy contingencies such as plant failures or power line outages. These problems are exacerbated by the increasing levels of generation from volatile renewable energy sources, in particular wind and solar. Large-scale stochastic programs are used to decide on the optimal infrastructure investment plans under variable renewable feed-in and other uncertainties (e.g., Parpasa & Webster, 2014; Munoz, Hobbs, Ho, & Kasina, 2014). To better account for the stochastic nature of electricity systems, there is also research on robust optimisation: rather than identifying the outcome which is best in expectation, it may be a better reflection of the network operator’s incentives to minimize the chance of blackouts, or to minimise losses when forecasts of renewable generation turn out to be wrong (Lorca, Sun, Litvinov, & Zheng, 2014; Ruiz & Conejo, 2015).

In contrast to these optimisation problems, equilibrium models are applied to investigate whether generators are exerting market power, either in the short-term spot market (Anderson & Cau, 2011) or across multiple markets, for example linking markets for power and carbon dioxide emissions (Limpaitoon, Chen, & Oren, 2014); generators may be able to act strategically in one market in order to extract rents in the other. Multi-stage models are applied to better understand the functioning and interdependencies along hierarchical markets, such as sequential market clearing or the relation between investment in generation capacity and the operation of the spot market (Murphy & Smeers, 2010; Wogrin, Hobbs, Ralph, Centeno, & Barquín, 2013). Another application of multi-stage, hierarchical models relate not to different timing of decisions, but to the level of players in a game-theoretic setting: some actors in the market may be in a position to move first, in a Stackelberg leader-follower sense, and exert market power to appropriate excess profits (Gabriel & Leuthold, 2010; Ruiz, Conejo, & Smeers, 2012). Yet another field of OR applications focuses on the optimal regulation of market players, to counteract the exertion of market power. The prime example is the design of the regulatory framework for transmission system operators (TSO), which – by the nature of network industries – are a natural monopoly. Proper regulation is able to better align the incentives of the network operator with the welfare-optimal investment plans (Schill, Egerer, & Rosellón, 2015).

In this work, we combine several aspects from the OR literature outlined above to tackle an issue that has received little attention so far: strategic, non-cooperative behaviour by zonal network planners. We ask whether zonal planners would alter their transmission capacity investment if they were only concerned with zonal (i.e., national) welfare, rather than the welfare of the entire region. Daxhelet and Smeers (2007), Buijs and Belmans (2011) and Tohidi and Hesamzadeh (2014) have made inroads into this research question; we propose a novel approach that incorporates the coordination aspects between non-cooperative network planners with regard to cross-border power lines. Mathematically, this is formulated as a three-level, hierarchical game, which is solved using a combination of first-order conditions, strong-duality reformulations, disjunctive constraints and non-convex optimisation.

We introduce the term “national-strategic” to differentiate our work from other studies that treat generators as strategic players (e.g., Zerrahn & Huppmann, 2014; Pozo, Contreras, & Sauma, 2013; Schröder, Traber, & Kemfert, 2013; Anderson & Cau, 2011; Neuhoff et al., 2005), as well as from the literature that treats one TSO responsible for the entire network area as the strategic player (e.g., Rosellón & Weigt, 2011; Léautier & Thelen, 2009). In contrast to these articles, we assume that the strategic players in the game are zonal planners such as national governments, regulators, or TSOs in charge of a certain network area: they anticipate the effects of investment within their jurisdiction on the welfare allocation. They may thus have an incentive to withhold line upgrades or over-invest compared to the welfare-optimal expansion plan in order to induce a shift of rents towards stakeholders in their zone. This distortion of investment may impede the effective integration of the European power market and the efficient shift to a power system based on renewable energy sources.

The next section briefly discusses the European context of network investment and market integration. Section 3 presents the theory of network for- 107 mation and discuss three previous models similar to our research 108 question. Section 4 describes the three-stage model depicting the national-strategic investment game; Section 5 provides the mathematical formulation. Section 6 extensively discusses the problems of solving multi-level games in general and illustrates how our approach deals with those challenges. Section 7 provides a numerical example of the three-stage model to illustrate the impact of strategic, non-cooperative network planning; Section 8 concludes and suggests potential avenues for further research.

The creation of a well-integrated Internal Energy Market (IEM, EC, 2012) and the decarbonisation of the European electricity sector require both a paradigm shift within the generation portfolio as well as a significant expansion of the power transmission system. The switch to renewable power generation is fundamental to meeting European climate goals (EU Road Map 2050, 
                     EC, 2011); however, wind and solar are inherently volatile and the most effective sites are often not located close to cities and industrial regions. As a consequence, the transmission system must be strengthened to ensure the effective and efficient integration of these energy sources. Due to the national scope of planning electricity systems for most of the 20th century, additional cross-border transmission capacity is required to achieve these goals.

There are several recent applied studies that aim to determine the optimal network investment plans to support such a decarbonisation of the electricity sector (e.g., Egerer, Gerbaulet, & Lorenz, 2013; Tröster, Kuwahata, & Ackermann, 2011). These models take a long-term view (i.e., until the year 2050), and they typically use a pan-European welfare maximisation approach, where all investment decisions are taken by a benevolent central planner. The European Ten-Year Network Development Plan (TYNDP, ENTSO-E, 2013) lists planned or required investments over the following decade.
                        2
                     
                     
                        2
                        In contrast to the other studies mentioned, the TYNDP is not derived from an explicit welfare-maximisation rationale. Instead, it lists transmission expansion projects as planned by the individual transmission system operators (TSO) and agreed within the European Network of Transmission System Operators for Electricity (ENTSO-E), the TSO’s trade association, following a public stakeholder process. Some key projects for trans-European energy infrastructure are labelled as projects of common interest by the European Commission and therefore have access to additional financial support (EC, 2013).
                      However, all these studies and political documents neglect that transmission investments may have a strong impact on welfare distribution both across national borders and among different stakeholders: generators, consumers, and TSOs.

Network expansion is still a national prerogative in Europe, both regarding planning and financing. Grid investments are highly capital-intensive and, once built, constitute a “lock-in” regarding the grid topology for many decades to come. Funding for grid upgrades is usually guaranteed by the national regulator, who allows the TSO to levy network usage fees to recover expansion costs.
                        3
                     
                     
                        3
                        If the income earned by the TSO from usage tariffs and congestion rents exceeds the approved funding base, the surplus must be used to either maintain and guarantee availability of the existing grid, invest in transmission capacity upgrades, or to lower usage fees (EC, 2009).
                     
                  

Due to the nature of electricity flows in an integrated network, beneficiaries of transmission investment may be located in a different jurisdiction than those bearing the costs. National governments, regulators and/or the TSOs may then be reluctant to invest if the benefits accrue elsewhere, unless an appropriate compensation mechanism is in place. Furthermore, any analysis of the power market is particularly complicated due to the specific characteristics of electricity transmission: if one line between two zones is expanded, the changes in power flow patterns may adversely affect other, not directly adjacent TSOs due to an increase of loop flows or a reduction of effectively available transmission capacity along other lines.


                     Egerer, Kunz, and von Hirschhausen (2013) discuss the welfare implications for different topologies of the North and Baltic Seas offshore connectors. They show a significant re-allocation of rents, both across jurisdictions, as well as between the different stakeholder groups. This indicates that the cost allocation of network investment is of paramount importance (cf. Buijs, Bekaert, & Belmans, 2010). In principle, the beneficiaries of any network upgrade should bear the costs. With this in mind, the EU has introduced the Inter-TSO compensation mechanism (ITC, EC, 2010), intended to remunerate TSOs for transit flows and grid upgrades of regional importance.

Theoretically, an appropriate allocation of benefits and costs through side payments would result in a grand coalition and yield a welfare-optimal expansion on the European level. There is a string of scientific literature examining various allocation methods based on cooperative game theory (Gately, 1974; Nylund, 2014). However, quantifying re-allocation of welfare might prove impossible due to issues of measurement; for instance, one may debate whether the no-investment welfare allocation should serve as a reference (i.e., the status quo), a hypothetical case of unilateral investment, or some projections regarding the future state of the electricity sector. We believe that this difficulty is one of the reasons why the ITC is still mainly used for compensation of transit flows (where a reference can be more easily established and the monetary transfers involved are fairly small), rather than for compensation of actual network upgrades (cf. Buijs et al., 2010). The current annual budget dispensed through the ITC is around 100 million euro (Rüster et al., 2012, p. 25ff); the investment volume planned according to the TYNDP is more than 100 billion euro (ENTSO-E, 2013) over the next decade.
                        4
                     
                     
                        4
                        Of course, only a fraction of the investment costs need to be financed through a pan-European fund; most line upgrades are viable from a national perspective alone. Nevertheless, the discrepancy is significant.
                     
                  

So far, we have argued specifically with the European situation in mind; nevertheless, Buijs et al. (2010) point out that while the institutional setting in the US power markets differs from Europe in many aspects, the same underlying conundrum is present in renewables support and network upgrades between different states as well as between regional system operators such as the Pennsylvania–Maryland–New Jersey Interconnection (PJM) and the Midwest ISO (MISO).

The question of how networks are formed when some players act strategically and have to agree whether or not to build a link between them is not new in the economics and game theory literature. However, to date no canonical approach exists to solve such games (cf. Bloch & Jackson, 2007, 2006). To further complicate the research question which we tackle in this work, the size of the link in electricity networks (i.e., capacity of the power line) is of paramount importance for resulting flows and locational (nodal) prices. We therefore opt for the most straightforward game structure: zonal planners strategically decide only on the upgrades of lines within their jurisdiction. Cross-border lines are decided by a supra-national planner. This allows us to sidestep, for the time being, the question of how to properly model negotiation on links between zones, while we are still able to focus on the impact of strategic zonal planners. We formulate a methodology to identify Nash equilibria and quantify the welfare “loss” due to strategic behaviour on the network planning level.
                        5
                     
                     
                        5
                        To be precise, it is not a welfare loss, but a failure to reap all welfare gains from network investment and a more efficient and integrated spot market.
                     
                  

A similar research question was tackled by Daxhelet and Smeers (2007), although they focus on network usage tariffs: the authors compare several proposals discussed within the Florence Regulatory Forum and discuss the different implementations of supra-national coordination. They propose a two-stage model in which national regulators set network usage tariffs for generators (G-component) and consumers (or load, hence L-component) in their jurisdiction, aiming to maximize welfare (defined as consumer surplus, generator profits and congestion rent) in their zone. In their model, the regulators play a Nash game, which forms the upper level of the model, while the spot market forms the lower level and takes the network usage tariffs in each zone as given. Mathematically, each regulator faces a mathematical program under equilibrium constraints (MPEC); the equilibrium constraints represent the optimality conditions of the lower-level market-clearing problem given the tariffs. Since several regulators interact simultaneously, the entire problem is an equilibrium problem under equilibrium constraints (EPEC), in particular a multi-leader-single-follower game (cf. Kulkarni and Shanbhag, 2014). The network in this model is treated as exogenously given.

In contrast, Buijs and Belmans (2011) focus on network upgrades. They compare the supra-national welfare-optimal investment to two other approaches: first, a setup where the planner responsible for one zone decides on investment in the entire network seeking to maximize domestic welfare comprising consumer surplus, generator profits and congestion rents less investment costs. Similar to the work by Daxhelet and Smeers, the zonal planner takes into account the impact of its decisions on the spot market, which forms the lower level; it is agnostic with respect to the welfare effects in other zones.

As a second model, Buijs and Belmans introduce a variation of the supra-national planner model, which they refer to as Pareto planner; they add explicit constraints that the aggregate welfare in each zone must not be reduced due to investment relative to the status quo. Both the zonal planner and the Pareto planner solve an MPEC; however, Buijs and Belmans do not actually compute Nash equilibria between the zonal planners. Their results only serve as upper bounds: how much could a zone benefit at most if all transmission investment was carried out in the most beneficial way for this particular zone. Similarly, their Pareto planner approach exhibits an inconsistency: it is only constrained relative to the status quo. As already pointed out, this may not be adequate if a zonal planner can unilaterally improve domestic welfare, for instance by expanding a line which is entirely within its jurisdiction.


                     Buijs and Belmans (2011) use genetic algorithms to solve each MPEC; it is not straightforward how this could be generalized to obtain a Nash equilibrium between the zonal planners. Two approaches to solve such EPEC-type problems are most commonly used in the literature: enumeration discretises the strategy space for each strategic player; the lower-level optimisation problem is then solved for each possible strategy of the upper-level game, and the pay-offs as well as deviation incentives for each player are determined ex post. Such an approach is used, for example, by Nylund and Egerer (2014). The problem when implementing this approach in practice comes from the difficulty of determining a suitable discretisation, and a general issue of scalability to solve large-scale problems.

In contrast to enumeration, diagonalisation describes an iterative algorithm: each MPEC is solved consecutively, holding the decisions variables of the rivals fixed. This approach is sometimes referred to as a variant of the “Gauss-Seidel” algorithm. While it does work in certain applications, convergence to a stable Nash equilibrium is not guaranteed. In particular, several Nash equilibria may exist, and it is not clear whether diagonalisation would identify all solutions. More importantly, one can usually make no informed statement whether other equilibria may exist; in particular, a Pareto improvement may be possible (i.e., a new equilibrium where at least one player is strictly better off, and no player has a worse payoff than in the previously found equilibrium).

A recent article by Tohidi and Hesamzadeh (2014) uses a third option to solve the EPEC between zonal planners in the investment game: they derive the KKT conditions of each zonal planner’s MPEC, which they reformulate using disjunctive constraints. This is feasible because the ISO problem is linear and they assume that demand is not responsive to price. On top of the reformulated first-order conditions, they place an objective function that minimizes the total welfare in the entire region; this can be interpreted as the “worst Nash equilibrium” among non-cooperative zonal network planners. The overall problem is therefore a Mixed-Integer Linear Problem (MILP), which can be solved efficiently using standard methods. Tohidi and Hesamzadeh apply their model to the IEEE RTS-96 dataset to illustrate the impact of non-cooperative network investment.


                     Tohidi and Hesamzadeh do not mention that the common-follower structure of the game makes this problem a Generalized Nash equilibrium (Harker, 1991, discussed in more detail below). They also do not discuss that KKT conditions are generally not necessary nor sufficient in an MPEC. We will return to this problem later. Furthermore, their approach to cross-border investment is different from ours: they assume that either of the two planners with access to a cross-border line can invest in the line, without the ability of the other player to deter line upgrades into its zone. We believe that this is not a realistic representation of network planning across jurisdictions. For this reason, we assign the decision regarding cross-border investment to another player, the supra-national network planner. We discuss these aspects in more detail below.

As outlined above, we propose a three-stage model to describe the Nash game between zonal planners. The supra-national planner decides on cross-border investment, anticipating the equilibrium in the Nash game between the zonal planners investing in their intra-zonal power lines. These zonal planners in turn anticipate the impact that their investment has on the spot market clearing and the welfare between their domestic constituents and stakeholders in other countries or zones. Table 1 illustrates the stages, players and decision variables of the game.

We solve this game by backward induction; therefore, we present the structure from the bottom stage to the top-level player. We first only describe the model stages and players; the mathematical formulation is presented in the subsequent section.

The third (bottom) level of the game is the competitive and integrated spot market, where generators, consumers, and TSOs of each zone take the network capacity as given for determining short-term dispatch and demand. The characteristics of the power network are taken into account using a loss-free direct-current load flow (DCLF) representation of Kirchhoff’s laws, as is the current standard in this stream of modelling (e.g., Leuthold, Weigt, & von Hirschhausen, 2012). This approach explicitly accounts for the externalities occurring in meshed electricity systems.
                           6
                        
                        
                           6
                           The current European market design for trading power across zone borders is based on available net transfer capacity (NTC). Because power does not actually flow in such a way, the stated NTC values include security margins to ensure network feasibility in spite of loop flows. Oggioni and Smeers (2013) and Oggioni, Smeers, Allevi, and Schaible (2012) discuss the difficulty of combining zonal pricing and trade based on net transfer capacities. The negative externalities arising out of NTC-based trade increase in lock-step with market integration and cross-border trade; European TSOs are currently looking into flow-based approaches to replace the NTC trading framework.
                        
                     

Mathematically, the problem of a competitive market between generators and demand is equivalent to an Independent System Operator (ISO) optimizing welfare of the entire region (with the network taken as given), so we will use the latter notion in the mathematical derivation. Most importantly, in our subsequent formulation, congestion rents earned by TSOs are based on actual flows rather than financial transmission rights to properly account for externalities from network congestion.

The second (intermediate) stage is the Nash game between the zonal planners, each deciding on network upgrades in its jurisdiction. Every zonal planner aims to maximize welfare in its zone; congestion rents earned by the zonal TSO are explicitly included in the objective function. Rents from cross-border transmission and the expansion costs for these lines are shared equally between the adjacent zones.

The decision on cross-border line upgrades is not taken by the zonal planners, but by the player at the first stage of the game. This is the simplest setup for our illustrative model; we will return to potential modifications and more elaborate formulations of bargaining in the concluding section, when we discuss further research.

The first (top) level of our model is a supra-national coordination agency; it could represent, for example, the Agency for the Cooperation of Energy Regulators (ACER). While this player cannot influence the decision by the zonal planners on their domestic line upgrades, it can decide on the expansion of cross-border lines; because it anticipates the strategic reaction of zonal planners, it can set the cross-border line investment in such a ways as to induce them to end up in a second-best Nash equilibrium.
                           7
                        
                        
                           7
                           The first-best solution would be the supra-national network investment plan without strategic considerations by the zonal planners.
                        
                     

Realizing that there may exist multiple equilibria in the game between the zonal planners (stage II), the coordination agency can therefore also be interpreted as an equilibrium selection mechanism—it coordinates among the zonal planners to make sure a “good” equilibrium is attained. The coordination agency has a central role in the mathematical implementation and the solution approach, which we will discuss in the next section.

We now turn to the mathematical formulation; Table 2
                      lists selected important notation used in this work; the remaining sets, variables and parameters are introduced where necessary. Our approach follows the methodology developed by Ruiz et al. (2012); we will discuss their approach and the extensions we introduce below, when we discuss the difficulties posed by multi-stage games.
                        8
                     
                     
                        8
                        A similar three-stage model is developed by Zerrahn and Huppmann (2014); the authors use similar reformulations to the lowest-level equilibrium problem, derive Karush–Kuhn–Tucker (KKT) conditions of the intermediate strategic players and use the top-level player as an equilibrium selection mechanism. In their work, however, the intermediate (strategic) players are generators rather than zonal planners, seeking to maximize profits by strategically withholding generation capacity or intentionally congesting the network. The top-level player is the network planner facing a trade-off between investment costs and the welfare effects of additional line capacity; the welfare gains can be distinguished between efficiency gains (less congestion) and a higher degree of competition between strategic generators.
                     
                  

The ISO optimizes the short-term dispatch of power plants, deciding on the generation level gns
                         at each node n and of technology s, demand dn
                        , and the voltage angle δn
                        .
                           9
                        
                        
                           9
                           This approach using voltage angles is equivalent to another method frequently used when formulating DCLF models, namely using power transmission distribution factors (PTDF).
                         Consumer welfare (utility from consuming electricity) is given by the function 
                           
                              
                                 (
                                 
                                    a
                                    n
                                 
                                 −
                                 
                                    
                                       1
                                       2
                                    
                                 
                                 
                                    b
                                    n
                                 
                                 
                                    d
                                    n
                                 
                                 )
                              
                              
                                 d
                                 n
                              
                              ,
                           
                         while 
                           
                              c
                              
                                 n
                                 s
                              
                              G
                           
                         are the per-unit (i.e., marginal) generation costs. From the point of view of the ISO, the line expansion el
                         is an exogenous parameter.

                           
                              (1a)
                              
                                 
                                    
                                       
                                          
                                             max
                                             
                                                g
                                                ,
                                                d
                                                ,
                                                δ
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                [
                                                
                                                   (
                                                   
                                                      a
                                                      n
                                                   
                                                   −
                                                   
                                                      
                                                         1
                                                         2
                                                      
                                                   
                                                   
                                                      b
                                                      n
                                                   
                                                   
                                                      d
                                                      n
                                                   
                                                   )
                                                
                                                
                                                   d
                                                   n
                                                
                                                −
                                                
                                                   ∑
                                                   s
                                                
                                                
                                                   c
                                                   
                                                      n
                                                      s
                                                   
                                                   G
                                                
                                                
                                                   g
                                                   
                                                      n
                                                      s
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (1b)
                              
                                 
                                    
                                       
                                          
                                             s.t.
                                             
                                             
                                                ∑
                                                s
                                             
                                             
                                                g
                                                
                                                   n
                                                   s
                                                
                                             
                                             −
                                             
                                                ∑
                                                k
                                             
                                             
                                                B
                                                
                                                   n
                                                   k
                                                
                                             
                                             
                                                δ
                                                k
                                             
                                             −
                                             
                                                d
                                                n
                                             
                                             =
                                             0
                                          
                                       
                                       
                                          
                                             
                                             (
                                             
                                                p
                                                n
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (1c)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                l
                                             
                                             +
                                             
                                                e
                                                l
                                             
                                             −
                                             
                                                ∑
                                                k
                                             
                                             
                                                H
                                                
                                                   l
                                                   k
                                                
                                             
                                             
                                                δ
                                                k
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                             
                                             (
                                             
                                                
                                                   μ
                                                   ¯
                                                
                                                l
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (1d)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                l
                                             
                                             +
                                             
                                                e
                                                l
                                             
                                             +
                                             
                                                ∑
                                                k
                                             
                                             
                                                H
                                                
                                                   l
                                                   k
                                                
                                             
                                             
                                                δ
                                                k
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                             
                                             (
                                             
                                                
                                                   μ
                                                   ̲
                                                
                                                l
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (1e)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   g
                                                   ¯
                                                
                                                
                                                   n
                                                   s
                                                
                                             
                                             −
                                             
                                                g
                                                
                                                   n
                                                   s
                                                
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                             
                                             (
                                             
                                                β
                                                
                                                   n
                                                   s
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (1f)
                              
                                 
                                    
                                       
                                          
                                             
                                                δ
                                                
                                                   n
                                                   ^
                                                
                                             
                                             =
                                             0
                                          
                                       
                                       
                                          
                                             
                                             (
                                             γ
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (1g)
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                                
                                                   n
                                                   s
                                                
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                             
                                             (
                                             
                                                ψ
                                                
                                                   n
                                                   s
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (1h)
                              
                                 
                                    
                                       
                                          
                                             
                                                d
                                                n
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                             
                                             (
                                             
                                                ϕ
                                                n
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Constraint (1b) is the energy balance; the dual variable to this constraint is the price of energy at each node. Constraints (1c)–(1d) are the thermal line capacity limits (in positive and negative power flow direction). The maximum available generation by node and technology is given by Constraint (1e). Using voltage angles to determine power flows requires the definition of a slack bus (
                           
                              n
                              ^
                           
                        ), at which the voltage angle is 0 by assumption (Constraint (1f)). The dual variables for all constraints are given in parentheses.

The ISO problem forms the lower stage to the optimisation problem of the zonal planners, the subsequent game stage II; hence, the standard approach is to insert the ISO problem to the upper-level problem as equilibrium constraints, specified below
                           10
                        
                        
                           10
                           The equilibrium model (2) could be simplified by combining Eqs. (2a) and (2b) and Eqs. (2i) and (2j); however, we will require the more extensive version in the later reformulations.
                        :

                           
                              (2a)
                              
                                 
                                    
                                       
                                          
                                             0
                                             =
                                             
                                                c
                                                
                                                   n
                                                   s
                                                
                                                G
                                             
                                             −
                                             
                                                p
                                                n
                                             
                                             +
                                             
                                                β
                                                
                                                   n
                                                   s
                                                
                                             
                                             −
                                             
                                                ψ
                                                
                                                   n
                                                   s
                                                
                                             
                                          
                                       
                                       
                                          
                                             ,
                                             
                                             
                                                g
                                                
                                                   n
                                                   s
                                                
                                             
                                             
                                             (free)
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2b)
                              
                                 
                                    
                                       
                                          
                                             0
                                             =
                                             −
                                             
                                                a
                                                n
                                             
                                             +
                                             
                                                b
                                                n
                                             
                                             
                                                d
                                                n
                                             
                                             +
                                             
                                                p
                                                n
                                             
                                             −
                                             
                                                ϕ
                                                n
                                             
                                          
                                       
                                       
                                          
                                             ,
                                             
                                             
                                                d
                                                n
                                             
                                             
                                             (free)
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2c)
                              
                                 
                                    
                                       
                                          
                                             0
                                             =
                                             
                                                ∑
                                                k
                                             
                                             
                                                B
                                                
                                                   k
                                                   n
                                                
                                             
                                             
                                                p
                                                k
                                             
                                             +
                                             
                                                ∑
                                                l
                                             
                                             
                                                H
                                                
                                                   l
                                                   n
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      μ
                                                      ¯
                                                   
                                                   l
                                                
                                                −
                                                
                                                   
                                                      μ
                                                      ̲
                                                   
                                                   l
                                                
                                                )
                                             
                                             −
                                             
                                                {
                                                
                                                   
                                                      γ
                                                      
                                                      if
                                                      
                                                      n
                                                      =
                                                      
                                                         n
                                                         ^
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                      else
                                                      
                                                   
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                             ,
                                             
                                             
                                                δ
                                                n
                                             
                                             
                                             (free)
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2d)
                              
                                 
                                    
                                       
                                          
                                             0
                                             =
                                             
                                                ∑
                                                s
                                             
                                             
                                                g
                                                
                                                   n
                                                   s
                                                
                                             
                                             −
                                             
                                                ∑
                                                k
                                             
                                             
                                                B
                                                
                                                   n
                                                   k
                                                
                                             
                                             
                                                δ
                                                k
                                             
                                             −
                                             
                                                d
                                                n
                                             
                                          
                                       
                                       
                                          
                                             ,
                                             
                                             
                                                p
                                                n
                                             
                                             
                                             (free)
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2e)
                              
                                 
                                    
                                       
                                          
                                             0
                                             ≤
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                l
                                             
                                             +
                                             
                                                e
                                                l
                                             
                                             −
                                             
                                                ∑
                                                k
                                             
                                             
                                                H
                                                
                                                   l
                                                   k
                                                
                                             
                                             
                                                δ
                                                k
                                             
                                          
                                       
                                       
                                          
                                             
                                             ⊥
                                             
                                             
                                                
                                                   μ
                                                   ¯
                                                
                                                l
                                             
                                             ≥
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2f)
                              
                                 
                                    
                                       
                                          
                                             0
                                             ≤
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                l
                                             
                                             +
                                             
                                                e
                                                l
                                             
                                             +
                                             
                                                ∑
                                                k
                                             
                                             
                                                H
                                                
                                                   l
                                                   k
                                                
                                             
                                             
                                                δ
                                                k
                                             
                                          
                                       
                                       
                                          
                                             
                                             ⊥
                                             
                                             
                                                
                                                   μ
                                                   ̲
                                                
                                                l
                                             
                                             ≥
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2g)
                              
                                 
                                    
                                       
                                          
                                             0
                                             ≤
                                             
                                                
                                                   g
                                                   ¯
                                                
                                                
                                                   n
                                                   s
                                                
                                             
                                             −
                                             
                                                g
                                                
                                                   n
                                                   s
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             ⊥
                                             
                                             
                                                β
                                                
                                                   n
                                                   s
                                                
                                             
                                             ≥
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2h)
                              
                                 
                                    
                                       
                                          
                                             0
                                             =
                                             
                                                δ
                                                
                                                   n
                                                   ^
                                                
                                             
                                          
                                       
                                       
                                          
                                             ,
                                             
                                             γ
                                             
                                             (free)
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2i)
                              
                                 
                                    
                                       
                                          
                                             0
                                             ≤
                                             
                                                g
                                                
                                                   n
                                                   s
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             ⊥
                                             
                                             
                                                ψ
                                                
                                                   n
                                                   s
                                                
                                             
                                             ≥
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2j)
                              
                                 
                                    
                                       
                                          
                                             0
                                             ≤
                                             
                                                d
                                                n
                                             
                                          
                                       
                                       
                                          
                                             
                                             ⊥
                                             
                                             
                                                ϕ
                                                n
                                             
                                             ≥
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Gabriel and Leuthold (2010), as one example, formulate such a two-stage, Stackelberg leader-follower model by taking first-order KKT conditions of the ISO problem (1), and replace the complementarity (or slackness) constraints using disjunctive constraints (Fortuny-Amat & McCarl, 1981). This yields a mixed-integer problem; however, deriving stationarity conditions for the zonal planners requires to take the derivative of the objective function. When binary variables are included due to the disjunctive constraints formulation, this is not possible; hence, this method is not suitable for our approach. Another possibility to replace complementarity conditions was proposed by Siddiqui and Gabriel (2013), using Schur’s decomposition and so-called SOS1-type variables. However, implementing this approach in a mathematically exact way also requires binary variables, and thus suffers from the same caveat.

Therefore, we apply the aforementioned methodology by Ruiz et al. (2012): we use strong duality to replace the optimisation problem by a set of constraints, which can be included in the next stage’s optimisation problems without the need for binary variables.

All constraints of Problem (1) are linear and the objective function (1a) is concave (to be maximized); therefore, strong duality holds (for any non-trivial set of parameters that admits a feasible solution). The Lagrangian dual problem then reads as follows:

                           
                              (3a)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   p
                                                   ,
                                                   
                                                      μ
                                                      ¯
                                                   
                                                   ,
                                                   
                                                      μ
                                                      ̲
                                                   
                                                   ,
                                                   β
                                                   ,
                                                   γ
                                                   ,
                                                   ϕ
                                                
                                             
                                             
                                                
                                                   1
                                                   2
                                                
                                             
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                1
                                                
                                                   b
                                                   n
                                                
                                             
                                             
                                                (
                                             
                                             
                                                
                                                   (
                                                   
                                                      a
                                                      n
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      p
                                                      n
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      ϕ
                                                      n
                                                   
                                                   )
                                                
                                                2
                                             
                                             −
                                             2
                                             
                                                a
                                                n
                                             
                                             
                                                p
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             2
                                             
                                                a
                                                n
                                             
                                             
                                                ϕ
                                                n
                                             
                                             −
                                             2
                                             
                                                p
                                                n
                                             
                                             
                                                ϕ
                                                n
                                             
                                             
                                                )
                                                +
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   L
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      μ
                                                      ¯
                                                   
                                                   l
                                                
                                                +
                                                
                                                   
                                                      μ
                                                      ̲
                                                   
                                                   l
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      f
                                                      ¯
                                                   
                                                   l
                                                
                                                +
                                                
                                                   e
                                                   l
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   N
                                                   ,
                                                   s
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                β
                                                
                                                   n
                                                   s
                                                
                                             
                                             
                                                
                                                   g
                                                   ¯
                                                
                                                
                                                   n
                                                   s
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3b)
                              
                                 
                                    
                                       
                                          
                                             s.t.
                                             
                                             
                                                c
                                                
                                                   n
                                                   s
                                                
                                                G
                                             
                                             −
                                             
                                                p
                                                n
                                             
                                             +
                                             
                                                β
                                                
                                                   n
                                                   s
                                                
                                             
                                             −
                                             
                                                ψ
                                                
                                                   n
                                                   s
                                                
                                             
                                          
                                       
                                       
                                          
                                             =
                                             0
                                             
                                             (
                                             
                                                g
                                                
                                                   n
                                                   s
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3c)
                              
                                 
                                    
                                       
                                          
                                             −
                                             
                                                a
                                                n
                                             
                                             +
                                             
                                                b
                                                n
                                             
                                             
                                                d
                                                n
                                             
                                             +
                                             
                                                p
                                                n
                                             
                                             −
                                             
                                                ϕ
                                                n
                                             
                                          
                                       
                                       
                                          
                                             =
                                             0
                                             
                                             (
                                             
                                                d
                                                n
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3d)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                k
                                             
                                             
                                                B
                                                
                                                   k
                                                   n
                                                
                                             
                                             
                                                p
                                                k
                                             
                                             +
                                             
                                                ∑
                                                l
                                             
                                             
                                                H
                                                
                                                   l
                                                   n
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      μ
                                                      ¯
                                                   
                                                   l
                                                
                                                −
                                                
                                                   
                                                      μ
                                                      ̲
                                                   
                                                   l
                                                
                                                )
                                             
                                             −
                                             
                                                {
                                                
                                                   
                                                      γ
                                                      
                                                      if
                                                      
                                                      n
                                                      =
                                                      
                                                         n
                                                         ^
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                      else
                                                      
                                                   
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                             =
                                             0
                                             
                                             (
                                             
                                                δ
                                                n
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Strong duality holds, hence the objective values at the optimal solution of Problems (1) and (3) are identical. This can be stated formally in the following constraint:

                           
                              (4)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   1
                                                   2
                                                
                                             
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                1
                                                
                                                   b
                                                   n
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      (
                                                      
                                                         a
                                                         n
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                +
                                                
                                                   
                                                      (
                                                      
                                                         p
                                                         n
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                +
                                                
                                                   
                                                      (
                                                      
                                                         ϕ
                                                         n
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                −
                                                2
                                                
                                                   a
                                                   n
                                                
                                                
                                                   p
                                                   n
                                                
                                                +
                                                2
                                                
                                                   a
                                                   n
                                                
                                                
                                                   ϕ
                                                   n
                                                
                                                −
                                                2
                                                
                                                   p
                                                   n
                                                
                                                
                                                   ϕ
                                                   n
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             −
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   L
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      μ
                                                      ¯
                                                   
                                                   l
                                                
                                                +
                                                
                                                   
                                                      μ
                                                      ̲
                                                   
                                                   l
                                                
                                                )
                                             
                                             
                                                (
                                             
                                             
                                                (
                                                
                                                   
                                                      f
                                                      ¯
                                                   
                                                   l
                                                
                                                +
                                                
                                                   e
                                                   l
                                                
                                                )
                                             
                                             −
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   N
                                                   ,
                                                   s
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                β
                                                
                                                   n
                                                   s
                                                
                                             
                                             
                                                
                                                   g
                                                   ¯
                                                
                                                
                                                   n
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             +
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                [
                                                
                                                   (
                                                   
                                                      a
                                                      n
                                                   
                                                   −
                                                   
                                                      
                                                         1
                                                         2
                                                      
                                                   
                                                   
                                                      b
                                                      n
                                                   
                                                   
                                                      d
                                                      n
                                                   
                                                   )
                                                
                                                
                                                   d
                                                   n
                                                
                                                −
                                                
                                                   ∑
                                                   s
                                                
                                                
                                                   c
                                                   
                                                      n
                                                      s
                                                   
                                                   G
                                                
                                                
                                                   g
                                                   
                                                      n
                                                      s
                                                   
                                                
                                                ]
                                             
                                             ≥
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        Strong duality entails that any vector (
                           
                              g
                              ,
                              d
                              ,
                              δ
                              ,
                              p
                              ,
                              
                                 μ
                                 ¯
                              
                              ,
                              
                                 μ
                                 ̲
                              
                              ,
                              β
                              ,
                              γ
                              ,
                              ϕ
                           
                        ) satisfying the primal constraints (1b)–(1h), the dual constraints (3b)–(3d) as well as the strong-duality constraint (4) is an optimal solution to both the primal and the dual problem. We can now use this set of linear and quadratic constraints to replace the ISO optimality conditions in the optimisation problems of the players at the higher stages of the game, without having to deal with complementarity constraints or binary variables due to using disjunctive constraints.
                           11
                        
                        
                           11
                           The constraints to the dual problem (3b)–(3d) are also the stationarity (KKT) conditions, if one would solve this problem as an equilibrium problem (or mathematically, a mixed complementarity problem, MCP), as given by Eqs. (2). The solution vector of the strong duality problem would also solve the MCP, and vice versa.
                        
                     

Normally when using strong duality, Constraint (4) would have to hold with equality; we write it as an inequality such that the quadratic constraint remains convex (for a given network, i.e., fixed el
                        ). Since the objective value of Problem (1) for any feasible solution is always smaller than the objective value of Problem (3) for any feasible solution due to weak duality, Constraint (4) can never hold with a strict inequality for a vector that is primal and dual feasible.

The zonal planner r aims to maximize the sum of generator profits, consumer surplus and congestion rent earned by the zonal TSO at all nodes within its zone Nr
                        ⊂N by deciding on network upgrades for all lines el
                         within its jurisdiction; these are the lines in the set Lr
                        ⊂L. For cross-border lines, the investment level is taken as given by the zonal planner; both investment costs and congestions rents are shared equally between the two adjacent zonal TSOs by assumption. The parameter shrlr
                         denotes the share of costs and rents of line l to be attributed to the TSO of zone r; it is 1 for domestic lines, 0.5 for cross-border lines, and 0 otherwise.

Mathematically, the optimisation problem of the zonal planners reads as follows:

                           
                              (5a)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                max
                                                
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                               l
                                                            
                                                            ∈
                                                            
                                                               L
                                                               r
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            and
                                                            
                                                            all
                                                            
                                                            variables
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                            of
                                                            
                                                            the
                                                            
                                                            ISO
                                                            
                                                            (
                                                            1
                                                            ,
                                                            3
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   
                                                      N
                                                      r
                                                   
                                                
                                             
                                             
                                                [
                                                
                                                   (
                                                   
                                                      a
                                                      n
                                                   
                                                   −
                                                   
                                                      
                                                         1
                                                         2
                                                      
                                                   
                                                   
                                                      b
                                                      n
                                                   
                                                   
                                                      d
                                                      
                                                         n
                                                         t
                                                      
                                                   
                                                   −
                                                   
                                                      p
                                                      n
                                                   
                                                   )
                                                
                                                
                                                   d
                                                   n
                                                
                                                +
                                                
                                                   ∑
                                                   s
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      n
                                                   
                                                   
                                                      g
                                                      
                                                         n
                                                         s
                                                      
                                                   
                                                   −
                                                   
                                                      c
                                                      
                                                         n
                                                         s
                                                      
                                                      G
                                                   
                                                   
                                                      g
                                                      
                                                         n
                                                         s
                                                      
                                                   
                                                   )
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   
                                                      L
                                                      r
                                                   
                                                
                                             
                                             
                                                [
                                                s
                                                h
                                                
                                                   r
                                                   
                                                      l
                                                      r
                                                   
                                                
                                                
                                                   (
                                                   
                                                      ∑
                                                      k
                                                   
                                                   
                                                      H
                                                      
                                                         l
                                                         k
                                                      
                                                   
                                                   
                                                      δ
                                                      k
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      ∑
                                                      k
                                                   
                                                   
                                                      I
                                                      
                                                         l
                                                         k
                                                      
                                                   
                                                   
                                                      p
                                                      k
                                                   
                                                   )
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      l
                                                      ∈
                                                      
                                                         L
                                                         r
                                                      
                                                   
                                                
                                                
                                                   c
                                                   l
                                                   T
                                                
                                                
                                                   e
                                                   l
                                                
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5b)
                              
                                 
                                    
                                       
                                          
                                             s.t.
                                             
                                             
                                                c
                                                
                                                   n
                                                   s
                                                
                                                G
                                             
                                             −
                                             
                                                p
                                                n
                                             
                                             +
                                             
                                                β
                                                
                                                   n
                                                   s
                                                
                                             
                                             −
                                             
                                                ψ
                                                
                                                   n
                                                   s
                                                
                                             
                                          
                                       
                                       
                                          
                                             =
                                             0
                                             
                                             (
                                             
                                                η
                                                
                                                   n
                                                   s
                                                   r
                                                
                                                R
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5c)
                              
                                 
                                    
                                       
                                          
                                             −
                                             
                                                a
                                                n
                                             
                                             +
                                             
                                                b
                                                n
                                             
                                             
                                                d
                                                n
                                             
                                             +
                                             
                                                p
                                                n
                                             
                                             −
                                             
                                                ϕ
                                                n
                                             
                                          
                                       
                                       
                                          
                                             =
                                             0
                                             
                                             (
                                             
                                                ρ
                                                
                                                   n
                                                   r
                                                
                                                R
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5d)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                k
                                             
                                             
                                                B
                                                
                                                   k
                                                   n
                                                
                                             
                                             
                                                p
                                                k
                                             
                                             +
                                             
                                                ∑
                                                l
                                             
                                             
                                                H
                                                
                                                   l
                                                   n
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      μ
                                                      ¯
                                                   
                                                   l
                                                
                                                −
                                                
                                                   
                                                      μ
                                                      ̲
                                                   
                                                   l
                                                
                                                )
                                             
                                             −
                                             
                                                {
                                                
                                                   
                                                      γ
                                                      
                                                      if
                                                      
                                                      n
                                                      =
                                                      
                                                         n
                                                         ^
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                      else
                                                      
                                                   
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                             =
                                             0
                                             
                                             (
                                             
                                                ν
                                                
                                                   n
                                                   r
                                                
                                                R
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5e)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                s
                                             
                                             
                                                g
                                                
                                                   n
                                                   s
                                                
                                             
                                             −
                                             
                                                ∑
                                                k
                                             
                                             
                                                B
                                                
                                                   n
                                                   k
                                                
                                             
                                             
                                                δ
                                                k
                                             
                                             −
                                             
                                                d
                                                n
                                             
                                          
                                       
                                       
                                          
                                             =
                                             0
                                             
                                             (
                                             
                                                λ
                                                
                                                   n
                                                   r
                                                
                                                R
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5f)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                l
                                             
                                             +
                                             
                                                e
                                                l
                                             
                                             −
                                             
                                                ∑
                                                k
                                             
                                             
                                                H
                                                
                                                   l
                                                   k
                                                
                                             
                                             
                                                δ
                                                k
                                             
                                          
                                       
                                       
                                          
                                             ≥
                                             0
                                             
                                             (
                                             
                                                
                                                   μ
                                                   ¯
                                                
                                                
                                                   l
                                                   r
                                                
                                                R
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5g)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                l
                                             
                                             +
                                             
                                                e
                                                l
                                             
                                             +
                                             
                                                ∑
                                                k
                                             
                                             
                                                H
                                                
                                                   l
                                                   k
                                                
                                             
                                             
                                                δ
                                                k
                                             
                                          
                                       
                                       
                                          
                                             ≥
                                             0
                                             
                                             (
                                             
                                                
                                                   μ
                                                   ̲
                                                
                                                
                                                   l
                                                   r
                                                
                                                R
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5h)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   g
                                                   ¯
                                                
                                                
                                                   n
                                                   s
                                                
                                             
                                             −
                                             
                                                g
                                                
                                                   n
                                                   s
                                                
                                             
                                          
                                       
                                       
                                          
                                             ≥
                                             0
                                             
                                             (
                                             
                                                β
                                                
                                                   n
                                                   s
                                                   r
                                                
                                                R
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5i)
                              
                                 
                                    
                                       
                                          
                                             δ
                                             
                                                n
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             =
                                             0
                                             
                                             (
                                             
                                                γ
                                                r
                                                R
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5j)
                              
                                 
                                    
                                       
                                          
                                             g
                                             
                                                n
                                                s
                                             
                                          
                                       
                                       
                                          
                                             ≥
                                             0
                                             
                                             (
                                             
                                                ψ
                                                
                                                   n
                                                   s
                                                   r
                                                
                                                R
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5k)
                              
                                 
                                    
                                       
                                          
                                             d
                                             n
                                          
                                       
                                       
                                          
                                             ≥
                                             0
                                             
                                             (
                                             
                                                ϕ
                                                
                                                   n
                                                   r
                                                
                                                R
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5l)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   1
                                                   2
                                                
                                             
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                1
                                                
                                                   b
                                                   n
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      (
                                                      
                                                         a
                                                         n
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                +
                                                
                                                   
                                                      (
                                                      
                                                         p
                                                         n
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                +
                                                
                                                   
                                                      (
                                                      
                                                         ϕ
                                                         n
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                −
                                                2
                                                
                                                   a
                                                   n
                                                
                                                
                                                   p
                                                   n
                                                
                                                +
                                                2
                                                
                                                   a
                                                   n
                                                
                                                
                                                   ϕ
                                                   n
                                                
                                                −
                                                2
                                                
                                                   p
                                                   n
                                                
                                                
                                                   ϕ
                                                   n
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   L
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      μ
                                                      ¯
                                                   
                                                   l
                                                
                                                +
                                                
                                                   
                                                      μ
                                                      ̲
                                                   
                                                   l
                                                
                                                )
                                             
                                             
                                                (
                                             
                                             
                                                (
                                                
                                                   
                                                      f
                                                      ¯
                                                   
                                                   l
                                                
                                                +
                                                
                                                   e
                                                   l
                                                
                                                )
                                             
                                             −
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   N
                                                   ,
                                                   s
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                β
                                                
                                                   n
                                                   s
                                                
                                             
                                             
                                                
                                                   g
                                                   ¯
                                                
                                                
                                                   n
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                [
                                                
                                                   (
                                                   
                                                      a
                                                      n
                                                   
                                                   −
                                                   
                                                      
                                                         1
                                                         2
                                                      
                                                   
                                                   
                                                      b
                                                      n
                                                   
                                                   
                                                      d
                                                      n
                                                   
                                                   )
                                                
                                                
                                                   d
                                                   n
                                                
                                                −
                                                
                                                   ∑
                                                   s
                                                
                                                
                                                   c
                                                   
                                                      n
                                                      s
                                                   
                                                   G
                                                
                                                
                                                   g
                                                   
                                                      n
                                                      s
                                                   
                                                
                                                ]
                                             
                                             ≥
                                             0
                                             
                                             
                                                (
                                                
                                                   κ
                                                   r
                                                   R
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Constraints (5b)–(5l) are the primal and dual constraints from the ISO (lower-level) problem and the strong-duality constraint; they ensure optimality of the ISO lower-level problem given the network investment decision variables.

The optimisation problem faced by one zonal planner (Problem (5)) is similar to the model presented by Buijs and Belmans (2011); since the lower-level is an equilibrium problem, each zonal planner faces an MPEC. Searching for Nash equilibria between several MPECs, we obtain an EPEC. The constraints faced by each zonal planner are identical; nevertheless, the valuation that the zonal planner accords to them (i.e., the dual variables marked with an R superscript) may differ across the planners. Therefore, the problem at hand is a Generalized Nash game (GNE). Harker (1991) proposes to assign identical duals to all shared constraints by assumption; this facilitates the solution of such problems considerably, since the problem then reduces to a Nash equilibrium (NE), which can be solved as a Variational Inequality (VI) or Mixed Complementarity Problem (MCP) using standard methods. This assumption can be interpreted as an implicit auction of the scarce resource or constraining factor; there exists a coordination mechanism between the players affected by the shared constraint. However, since one of the main tenets of our work is that such a coordination mechanism does not exist, we do not use this approach here. Instead, we will present a reformulation based on disjunctive constraints below to circumvent this problem without having to make a priori assumptions.

We proceed by taking first-order (KKT) conditions of the zonal planner’s MPEC, stated in Appendix A; however, both the objective function (5a) and the strong-duality constraint (5l) are non-convex due to the congestion rents in the objective function (5a) and the line expansion in the strong-duality constraint (5l). As a consequence, the KKT conditions are neither necessary nor sufficient for an equilibrium, and there may be a multitude of KKT points. Let us first discuss the caveat that the KKT conditions are not necessary: this means that there may exist equilibria of the game between zonal planners that our approach does not capture. Mathematically, such equilibria are related to relaxed definitions of the Nash equilibrium, such as a Nash Bouligand stationary point (or Nash B-stationary point, Kulkarni & Shanbhag, 2014). All numerical approaches suffer from the caveat that it cannot be guaranteed to identify all equilibria. This holds for enumeration or diagonalisation, as well as the models proposed by Tohidi and Hesamzadeh (2014) and Ruiz et al. (2012).

In contrast to this problem of not necessarily finding all equilibria, the non-sufficiency of the KKT conditions for an equilibrium is easy to overcome. We treat each KKT point as a candidate equilibrium and check for each zonal planner whether a profitable deviation exists, keeping all line capacities not within the jurisdiction of the respective zonal planner fixed. The algorithm is explained in more detail below, when we summarize the methodological advances of our approach. If no profitable deviation exists for any zonal planner, we keep the KKT point as an equilibrium; otherwise, we discard it. Our approach therefore only admits global Nash equilibria, in contrast to other approaches that only focus on deviation incentives in the neighbourhood of equilibrium candidates (local Nash equilibrium, Hu & Ralph, 2007).

In this way, we can use the KKT conditions as constraints to describe global Nash equilibria; the decision which equilibrium to choose is taken by the top-level player in this game, the supra-national planner.

The supra-national planner decides on cross-border network investment, anticipating the optimal strategic reaction of the zonal planners. It seeks to maximize welfare in the entire region, less the required investment costs:

                           
                              (6)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                max
                                                
                                                   
                                                      
                                                         
                                                            g
                                                            ,
                                                            d
                                                            ,
                                                            δ
                                                            ,
                                                            e
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            and
                                                            
                                                            all
                                                            
                                                            variables
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                            of
                                                            
                                                            the
                                                            
                                                            EPEC
                                                            (
                                                            9
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                [
                                                
                                                   (
                                                   
                                                      a
                                                      n
                                                   
                                                   −
                                                   
                                                      
                                                         1
                                                         2
                                                      
                                                   
                                                   
                                                      b
                                                      n
                                                   
                                                   
                                                      d
                                                      n
                                                   
                                                   )
                                                
                                                
                                                   d
                                                   n
                                                
                                                −
                                                
                                                   ∑
                                                   s
                                                
                                                
                                                   c
                                                   
                                                      n
                                                      s
                                                   
                                                   G
                                                
                                                
                                                   g
                                                   
                                                      n
                                                      s
                                                   
                                                
                                                ]
                                             
                                             −
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   L
                                                
                                             
                                             
                                                c
                                                l
                                                T
                                             
                                             
                                                e
                                                l
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             s.t.
                                             
                                             equilibrium
                                             
                                             between
                                             
                                             the
                                             
                                             zonal
                                             
                                             regulators
                                             
                                             (KKT
                                             
                                             conditions
                                             
                                             (9))
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             and
                                             
                                             optimal
                                             
                                             dispatch
                                             
                                             by
                                             
                                             the
                                             
                                             ISO
                                             
                                             (KKT
                                             
                                             conditions
                                             
                                             (2))
                                          
                                       
                                    
                                 
                              
                           
                        
                     

As already mentioned above, there may exist multiple Nash equilibria. We therefore implement an iterative algorithm seeking to identify a range of possible outcomes. This allows us to give a broader interpretation to the top-level player than either Tohidi and Hesamzadeh (2014) or Ruiz et al. (2012) have done: rather than just presenting one Nash equilibrium, we can compare several equilibria. We will return to this issue when discussing the numerical results.

Our model extends the approach used by Tohidi and Hesamzadeh (2014) and Ruiz et al. (2012) in three important aspects: firstly, they assume a constant demand or piece-wise constant willingness-to-pay function of consumers, respectively, while we use a linear inverse demand curve. This allows to identify marginal benefits of network expansion. Secondly, Ruiz et al. hold the dual variable associated with lower-level complementarity (κR
                      in our formulation) fixed and test for different (exogenous) values, while Tohidi and Hesamzadeh (2014) do not discuss the GNE aspects at all.

The third contribution of this work relative to these two earlier models concerns the interpretation of the top level player: they use this player merely as an equilibrium selection mechanism, but do not discuss whether multiple Nash equilibria exist. We develop an iterative algorithm to identify alternative equilibria, and thus provide more room for interpretation of the three-stage nature of the model.

One general methodological novelty in comparison to Tohidi and Hesamzadeh (2014) and Ruiz et al. (2012) concerns the nature of the Generalized Nash Equilibrium (GNE) between the players at the intermediate model stage. In particular, as we mentioned earlier, we decide against the common simplification when solving GNE models of assuming identical multipliers for shared constraints (Harker, 1991) or a fixed, exogenously specified ratio between the multipliers (Oggioni et al., 2012). Instead, we replace the complementarity constraints of the zonal planners’ and the ISO’s KKT conditions by disjunctive constraints. This allows us to circumvent the problem of a non-square MCP model: we illustrate the approach using the example of the nodal energy balance faced by the ISO (Constraint (1e)).

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   g
                                                   ¯
                                                
                                                
                                                   n
                                                   s
                                                
                                             
                                             −
                                             
                                                g
                                                
                                                   n
                                                   s
                                                
                                             
                                             ≥
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        For optimality, either this constraint is not binding, or the associated dual variable for the ISO (βns
                        ) equals 0. However, each zonal planner must also consider this constraint in its own optimisation problem (Constraint (5h)), with the associated dual variable (
                           
                              β
                              
                                 n
                                 s
                                 r
                              
                              R
                           
                        ). The entire problem then reads as follows:

                           
                              (7a)
                              
                                 
                                    
                                       
                                          0
                                       
                                       
                                          ≤
                                       
                                       
                                          
                                             
                                                
                                                   g
                                                   ¯
                                                
                                                
                                                   n
                                                   s
                                                
                                             
                                             −
                                             
                                                g
                                                
                                                   n
                                                   s
                                                
                                             
                                             
                                             ⊥
                                             
                                             
                                                β
                                                
                                                   n
                                                   s
                                                
                                             
                                             ≥
                                             0
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          ≤
                                       
                                       
                                          
                                             
                                                
                                                   g
                                                   ¯
                                                
                                                
                                                   n
                                                   s
                                                
                                             
                                             −
                                             
                                                g
                                                
                                                   n
                                                   s
                                                
                                             
                                             
                                             ⊥
                                             
                                             
                                                β
                                                
                                                   n
                                                   s
                                                   r
                                                
                                                R
                                             
                                             ≥
                                             0
                                             
                                             ∀
                                             
                                             r
                                             ∈
                                             R
                                          
                                       
                                    
                                 
                              
                           
                        It is not possible to solve such a model with shared constraints as a MCP, because it is essentially a non-square system (more variables than unique equations). However, we can replace the entire system using disjunctive constraints. We introduce one large scalar K and a binary variable rns
                         for each constraint.

                           
                              (7b)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   g
                                                   ¯
                                                
                                                
                                                   n
                                                   s
                                                
                                             
                                             −
                                             
                                                g
                                                
                                                   n
                                                   s
                                                
                                             
                                             ≥
                                             0
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   g
                                                   ¯
                                                
                                                
                                                   n
                                                   s
                                                
                                             
                                             −
                                             
                                                g
                                                
                                                   n
                                                   s
                                                
                                             
                                             ≤
                                             K
                                             
                                             
                                                r
                                                
                                                   n
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                β
                                                
                                                   n
                                                   s
                                                
                                             
                                             +
                                             
                                                ∑
                                                r
                                             
                                             
                                                β
                                                
                                                   n
                                                   s
                                                   r
                                                
                                                R
                                             
                                             ≤
                                             K
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   r
                                                   
                                                      n
                                                      s
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

This reformulation allows to include shared constraints without the requirement to make assumptions on the ratio of the dual variables of the shared constraints between the different players. For shared equality constraints, the complementarity condition can be neglected altogether. We reformulate all inequality constraints of the zonal planners’ KKT conditions (stated in Appendix A) in this way. After this reformulation, we can also eliminate the strong-duality constraint (5l): the primal and dual feasibility of the ISO problem is already included in the zonal planners’ constraints, and complementarity of the ISO’s variables is enforced by the disjunctive constraints reformulation. After this simplification, the resulting problem is only bilinear in the dual variable to the strong duality constraint (
                           
                              κ
                              r
                              R
                           
                        ).

There is one general concern of modelling bilevel games that we still need to address: when solving two-stage games, the most commonly applied approach uses first-order optimality condition of the lower-level optimisation problems and inserts those as constraints to the upper-level optimisation problem. An important assumption is implicitly taken here: the decision variables of the lower-level player are then, mathematically speaking, decision variables of the upper-level player, respecting optimality constraints. If the optimal response of the lower-level player is unique for any given decision of the upper-level player, this need not be a concern. However, there may be cases where uniqueness of the lower-level best response is not given; the lower-level player is indifferent between several options.

In such cases, the upper-level player may then decide which of the options the lower-level player “chooses”. This is commonly referred to as the optimistic approach; it is the best the upper-level player can do given the bilevel game.

In contrast, one may consider a case where the lower-level player wants to do what is worst for the upper-level player, given a situation where it is indifferent between several options; this is the pessimistic approach. Such a situation may be plausible in cases where the upper- and lower-level players are rivals, and the lower-level player wants to maximize its profits—but also has an incentive to reduce the profits of the rival, if it does not have a downside for itself (by definition, own payoff is not affected, as this player is indifferent between two decisions). Mathematically, this leads to a min–max-problem, which is computationally difficult to solve.

In the three-stage model (Problem (6)), we implicitly use the optimistic approach, where optimistic is to be seen from the supra-national planner’s point of view. We believe that this makes sense: the supra-national planner and the ISO’s objective are well aligned. For the zonal planners, we assume that they are only concerned with national welfare—but we do not presume that they are malevolent towards other states/zones.

For the deviation-incentive checking algorithm (explained in the following section), we solve the optimisation model of the zonal planners (Problem (5)); here, we also use the optimistic approach (now optimistic from the point of view of the respective zonal planner). Again, this makes sense, because our question when solving this model is to check whether the zonal planner has a deviation incentive from the equilibrium candidate solution identified by the three-stage model. If we do not find a deviation incentive under the optimistic assumption, we can be confident that indeed there is none.
                           12
                        
                        
                           12
                           We are aware that this assumption may exclude equilibria in the game between zonal planners, which are not deviation-proof under the optimistic assumption, but are incentive-compatible if the ISO can credibly commit to “retaliate” by following the pessimistic strategy. However, identifying whether such a case may even exist is beyond the scope of this work.
                        
                     

Let us now turn to the iterative algorithm to identify multiple equilibria, which we already referred to earlier. The problem of our three-stage model is as follows: there may exist multiple equilibria in the national-strategic game, and there may be KKT points which are not stable in the Nash sense, because a zonal planner finds a profitable deviation—in this case, the KKT conditions would hold because it is a local welfare minimum or saddle point in one or more variables of a zonal planner. This section describes an iterative algorithm to identify multiple equilibria, and to check for deviation incentives:

                           
                              1.
                              Solve the national-strategic model (Problem (6)). The optimal line expansion is denoted as 
                                    
                                       
                                          e
                                          l
                                          *
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                       ,
                                    
                                  where i is the iteration counter; let the set I collect all iterations of this algorithm.

Loop over zonal planners: Solve the zonal MPEC problem (Problem (5)), with all line investments but the domestic ones fixed to the level determined in Step 1, 
                                    
                                       
                                          e
                                          l
                                       
                                       =
                                       
                                          e
                                          l
                                          *
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                       
                                       ∀
                                       
                                       l
                                       ∉
                                       
                                          L
                                          r
                                       
                                    
                                 . If at least one zonal planner has a profitable deviation, discard the KKT point as an equilibrium candidate.

If the KKT point identified is an equilibrium candidate: check whether a previously found equilibrium dominates the current candidate solution. Definition: a solution A dominates another solution B if each zonal planner is (weakly) better off in solution A than in B. If no dominating previous solution is found, keep this KKT point as an additional equilibrium.

Add constraints to the national-strategic model (Problem (6)) such that the solution 
                                    
                                       
                                          e
                                          l
                                          *
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                  is excluded from the feasible region. To this end, we introduce auxiliary binary variables 
                                    
                                       
                                          z
                                          l
                                          +
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                       ,
                                       
                                          z
                                          l
                                          −
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                 ; the parameter 
                                    
                                       
                                          e
                                          l
                                       
                                       ¯
                                    
                                  is an suitable large upper bound on the line expansion:

                                    
                                       (8)
                                       
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        e
                                                                        l
                                                                     
                                                                     >
                                                                     
                                                                        z
                                                                        l
                                                                        +
                                                                     
                                                                     
                                                                        (
                                                                        i
                                                                        )
                                                                     
                                                                     
                                                                     
                                                                        e
                                                                        l
                                                                        *
                                                                     
                                                                     
                                                                        (
                                                                        i
                                                                        )
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        e
                                                                        l
                                                                     
                                                                     <
                                                                     
                                                                        
                                                                           e
                                                                           l
                                                                        
                                                                        ¯
                                                                     
                                                                     −
                                                                     
                                                                        z
                                                                        l
                                                                        −
                                                                     
                                                                     
                                                                        (
                                                                        i
                                                                        )
                                                                     
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              e
                                                                              l
                                                                           
                                                                           ¯
                                                                        
                                                                        −
                                                                        
                                                                           e
                                                                           l
                                                                           *
                                                                        
                                                                        
                                                                           (
                                                                           i
                                                                           )
                                                                        
                                                                        )
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                     
                                                                        ∑
                                                                        l
                                                                     
                                                                     
                                                                        z
                                                                        l
                                                                        +
                                                                     
                                                                     
                                                                        (
                                                                        i
                                                                        )
                                                                     
                                                                     +
                                                                     
                                                                        z
                                                                        l
                                                                        −
                                                                     
                                                                     
                                                                        (
                                                                        i
                                                                        )
                                                                     
                                                                     ≥
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                         }
                                                      
                                                      
                                                      ∀
                                                      
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                             
                                          
                                       
                                    
                                 The logic is straightforward: at least one of the auxiliary binary variables must equal 1 for each previous iteration; hence, these constraints ensure the next KKT point found in Problem (6) differs with regard to at least one line expansion variable from all previously found KKT points. This must hold irrespective of whether a point was a stable equilibrium or not.
                                    13
                                 
                                 
                                    13
                                    Otherwise, the iterative algorithm would get stuck at this point. In the GAMS implementation, we use an 
                                          ϵ
                                        distance to replace the strict by a weak inequality.
                                 
                              


                        
                           …
                         Repeat at Step 1; stop after n iterations

Of course, in the type of game with continuous decision variables that we are proposing here, we can expect a continuous set of equilibria rather than a number of singletons. Adjusting the parameters 
                           ϵ
                         and n accordingly and further tailoring the iterative algorithm to the problem at hand may allow to more comprehensively assess the solution space of the three-stage game.

There is one important methodological and conceptual benefit of this iterative solution to the more “hands-on” approach of solving such a game by diagonalisation and attempting to find different equilibria by using various starting points: using such an approach, one can make no informed statement whether “better” equilibria exist, in the sense that there is a dominating equilibrium (as defined in Step 3 of the iterative algorithm). In contrast, using our iterative algorithm, the first KKT point will be the candidate equilibrium with the highest level of aggregate welfare—irrespective of whether this point is an equilibrium. The second iteration will provide the KKT point with the second-highest overall welfare, and so forth. As we stated earlier, there may exist equilibria which are not KKT points—our approach cannot find these, so the above statement does not apply to such equilibria. However, our approach is at least an improvement to the diagonalisation and enumeration approach.

The three-stage model is, after the disjunctive constraints reformulation, a quadratic program with mixed-integer non-convex constraints. We implement the problem in GAMS and use the BARON solver (Tawarmalani & Sahinidis, 2005); this solver aims to solve non-convex problems to global optimality.
                           14
                        
                        
                           14
                           Of course, our statements only hold under the assumption that the BARON solver identifies the correct global optimum of the non-convex problem. We did extensive testing for the stylized example presented in the following section, and we are confident that the solutions presented here are plausible.
                        
                     

In order to identify and quantify the impact of strategic zonal planners, we compute two benchmark cases: first, a model without any investment at all, which is exactly the ISO dispatch problem (Problem (1)). As a second benchmark, we compute the optimal supra-national investment problem without strategic consideration by zonal planners. This can be computed by combining the objective function of the supra-national planner (6) with the operational constraints of the ISO problem (Constraints (1b)–(1h)), allowing investments on all lines. Both benchmark models are convex quadratic optimisation problems (QP) and are numerically solved using the CPLEX solver. The GAMS code is provided in the online supplementary material.

We apply this model to a four-node, two-country example, which is motivated by the current situation between Germany and Poland. We assume two countries with two nodes each; the south of country A has a large industrial base, while the north of country A has only low demand for electricity. Country B has intermediate demand at both nodes. The energy system of both countries used to be based on autarky of each zone, with limited transmission capacity between them.

Two shifts caused a significant imbalance in the power network: large installation of generation capacity with low variable costs in the north of country A (e.g., wind power in the coastal region), and decommissioning of base-load generation capacity in the south of Countries A and B (e.g., the nuclear phase-out in Germany, less power generation from coal due to emission reduction efforts).

We abstract from investment in power generation; we assume that the shifts in the generation portfolio have already taken place, but in different locations than the replaced large conventional power plants. This can be due to fixed feed-in tariffs or other subsidies; support for renewable energy often does not give sufficient consideration to locational aspects. Investment is then undertaken based on regional wind availability and similar factors, rather than where it would be most beneficial for the electricity system.


                     Fig. 1
                      depicts the network, the installed generation capacity by type, the reference demand at each node, the initial transmission capacity, and the equilibrium prices in the absence of network expansion. All quantities, flows and capacities presented here are given in gigawatthours,
                        15
                     
                     
                        15
                        Capacities are actually in gigwatt rather than gigawatthour (energy). By assuming one representative hour, the two are equivalent.
                      all prices and costs are given in euro per megawatthour. We assume three types of power plants: “renewables” with zero marginal generation costs, “base” with 40 euro per megawatthour and “peak” with 70 euro per megawatthour. The parameters for the linear inverse demand function, derived from the bottom-level optimisation problem (1a) and present in the first-order optimality condition of the market (2b), are computed using a price of 70 euro per megawatthour and an elasticity of 
                        
                           −
                           0.25
                        
                     . The costs for network expansion are assumed to be 2 euro per megawatthour. 
                        16
                     
                     
                        16
                        This value is derived from the following assumptions: a double-circuit 380 kilovolt line costs 1.4 million euro per kilometre; the distance between two nodes is 400 kilometre; the line is used at full capacity in half of the hours every year; the lifetime of the line is 40 years; and the interest rate is 4  percent per annum.
                      The impedance of all lines is assumed to be identical. The GAMS code and the detailed results are provided in the supplementary material.

Without substantial upgrades of the transmission grid, we observe a large price differential between the two nodes of country A. However, in order to transmit power to the node with the highest willingness-to-pay, upgrades must also be made in the northern cross-border line and the line within country B due to the particular power flow characteristics in an alternating-current (AC) power grid.

We first compute two benchmark cases: no investment and (supra-national) welfare-optimal investment. In the initial (current) network, peak-load generators in both southern nodes are the price-setting plants—there is idle capacity at node n1, but it cannot be transported to the high-price nodes due to the constraints of the network. With welfare-optimal investment in transmission capacity, prices in node n2 slightly decrease, as more base-load generation can be shipped to that node. Prices in the northern nodes increase in line with a general price convergence—the resulting price differential between the nodes is exactly equal to the costs of building an additional marginal unit of line capacity.

Because the plant in node n4 is still the price-setting plant in the system even with welfare-optimal line expansions, prices converge towards the high price at that node; this may seem counter-intuitive at first given that network investment is generally expected to exhibit a price-decreasing effect. Nevertheless, welfare is increased due to the network expansion, because peak-load (i.e., high variable cost) generation can be replaced by the base-load plant at node n1 which was idle in the no-investment benchmark case.

However, when analysing the welfare shifts due to the network expansion as illustrated in Fig. 2
                         and Table 3
                        , one notices that all welfare gains accrue in country A, while country B finds its welfare decreased relative to the status quo. This begs the question whether a zonal planner would not find it in its best interest to restrict the network expansion within its jurisdiction, since explicit transfers between the zones to compensate for this loss of welfare are not possible in the current setting.

To investigate this effect, we compute equilibria of the three-stage game; we use the iterative algorithm presented in Section 5 to identify 46 KKT points of the game.
                           17
                        
                        
                           17
                           Due to the “holes” cut into the feasible region by the iterative algorithm to identify other KKT points, the solver requires more time after each iteration. The 47th iteration was aborted after 24 hours of computation time.
                         Of these 46 candidate solutions, 5 are not Nash equilibria (i.e., at least one of the zonal planners identified a profitable deviation). Another 35 KKT points are Nash equilibria in the sense that no zonal planner has a unilateral deviation incentive, but the equilibria are not Pareto efficient (also referred to as Pareto optimal). A Pareto improvement exists; the solutions are dominated by other equilibria.
                           18
                        
                        
                           18
                           A dominated equilibrium is one where another equilibrium was found which is a welfare improvement for all zonal planners. Thus, agreeing to move to the dominating equilibrium is in every player’s best interest; a joint deviation incentive for all players without transfers/compensation exists.
                         Three iterations experienced numerical difficulties and where therefore excluded. This leaves three Nash equilibria found at iterations 1, 23 and 27; they are presented in Fig. 3
                        .

In general, network expansion is lower than in the welfare-optimal benchmark. The difference is most pronounced on line l4, where expansion is lower by one third relative to the benchmark. This makes sense intuitively: the zonal planner of country B specifically “withholds” line expansion; this has the effect to reduce prices at node n3 and thereby shifts rents from generators at node n1 to the consumers at node n3. Equilibrium C is the only solution where not all lines are fully congested; this is line l3, which is consequently not expanded.

In the three national-strategic equilibria, aggregate welfare is 10 percent lower compared to the welfare-optimal benchmark (see Table 3). At the same time, by strategically reducing line expansion on the domestic line, the zonal planner of country B is able to appropriate more than 20 percent of the welfare gains, rather than seeing its constituents worse off due to the network expansion.

As a last remark, let us compare the three equilibria: it is clear that Equilibrium A is the network expansion with the highest aggregate welfare. However, one may argue that Equilibrium C is the more “equitable” outcome from the point of view of the supra-national planner, as both zones benefit more evenly from the expansion. In any case, the difference between the three equilibria is relatively small. We are not sure whether this is due to the small scale of the sample network, an artefact arising from the numerical aspects of the non-convex problem, or an inherent property of the game structure.

In the mathematical formulation presented so far and the illustrative example, we assumed only one representative hour in the spot market (stage III). We did this to clearly identify the different effects and the failure to reach the first-best outcome for the entire region. Given that renewable feed-in and demand are variable and difficult to predict with certainty, the next logical step is to extend the game to either a dynamic or even stochastic setting.

Mathematically, this model extension is straightforward: The ISO problem can easily be replaced by a dynamic market, with variable demand curves over time or fluctuating renewable feed-in. If one assumes standard welfare maximisation, the objective functions of the zonal planners and the supra-national planner have then to aggregate the welfare over all hours. In a stochastic setting and under the assumption of risk-neutral behaviour by all planners, the extension would be equivalent. However, considering robust optimisation, as mentioned in the Introduction, would greatly complicate the resulting three-stage problem.

In a meshed power network, line expansions may lead to significant re-allocations of profits and rents across different stakeholder groups and national boundaries. Zonal (or national) interests and the lack of an efficient compensation mechanism may prevent reaping all potential welfare gains from network investments, because the beneficiaries of network expansion are located in different jurisdiction than those stakeholders bearing the costs. Zonal planners, such as governments, regulators, or national TSOs, may therefore have incentives to over-invest or intentionally withhold power line upgrades in their jurisdiction to induce a shift of rents towards their constituents. This may impede the efficient investment in the power sector. Our motivation is based on current European measures towards integration of power markets and the transformation towards a low-carbon power sector—but it may also be valid in other regions, in particular North America with a number of inter-linked regional system operators.

We develop a hierarchical, three-stage model to represent the Generalized Nash game between zonal planners, each taking into account how line capacity upgrades impact the outcome in the competitive spot market. The game is led by a supra-national planner, who decides on cross-border line expansion, anticipating the resulting equilibria between zonal planners. We make use of strong duality to replace the equilibrium constraints of the lowest-level player, the ISO managing the competitive spot market, and take first-order conditions of the zonal planners’ optimisation problem. Adapting a disjunctive constraints reformulation, we circumvent the common problem when solving Generalized Nash games, and do not need to make a priori assumptions on the relative valuations of shared constraints. Finally, we implement an iterative algorithm to determine a range of potential equilibria. Our approach suffers from the caveats typically encountered when tackling bilevel equilibrium problems, namely a potential multiplicity of equilibria and the difficulty to identify meaningful results using numerical optimisation methods. Nevertheless, our reformulation and iterative approach offers a route to provide a more comprehensive categorisation of results compared to the standard approaches, enumeration/discretisation and diagonalisation.

Our results based on a simple test case demonstrate that the national-strategic behaviour yields a significant welfare loss compared to the system-optimal investment. A zonal planner has incentives to “under-invest” in its domestic line in order for its constituents to obtain a share of the welfare gains, rather than seeing its domestic welfare decreased by the system-optimal network upgrades.

For further research and future model extensions, we intend to develop the three-stage approach in several directions: firstly, we want to relax the current simplification that all cross-border network investment is decided by the supra-national planner. Instead, those line upgrades should be subject to a bargaining process between the adjacent zonal planners, including the option to block cross-border investment by either of the adjacent zones. This will require the explicit modelling of a compensation mechanism, in the spirit of the ITC and the notion of “projects of common interest”. It will be interesting to see whether an explicit transfer scheme can alleviate the failure to reach the first-best equilibrium.

As a second line of further research, we intend to focus on the welfare allocation between the different stakeholder groups, and the shifts between them due to network upgrades. One may imagine a situation where the regulator has a preference for the welfare of consumers, rather than the equal weight of consumer welfare, generator profits, and TSO rents assumed so far. Furthermore, in such a setting, an explicit funding constraint of the TSO has to be considered; network usage tariffs will be used to finance additional transmission capacity. Thereby, we will be able to explicitly include the trade-off between the benefits of additional transmission capacity and the consumer welfare loss due to the tariffs. This is similar to the work by Daxhelet and Smeers (2007), but extends it in the direction of network investment.

@&#ACKNOWLEDGEMENTS@&#

The authors would like to thank Sauleh Siddiqui and Franziska Holz for many valuable comments, as well as Dr. Immanuel Bomze and three anonymous reviewers for their comments and suggestions to improve this manuscript. Financial support by Energie-Control Austria (ECA) for D. Huppmann within the special series “10 years of e-control” is gratefully acknowledged. The views expressed in this article should not be considered as a statement regarding the views of ECA.


                     
                        
                           (9a)
                           
                              
                                 
                                    
                                       
                                          0
                                          ≤
                                          
                                             c
                                             l
                                             T
                                          
                                          −
                                          
                                             (
                                             
                                                
                                                   μ
                                                   ¯
                                                
                                                
                                                   l
                                                   r
                                                
                                                R
                                             
                                             +
                                             
                                                
                                                   μ
                                                   ̲
                                                
                                                
                                                   l
                                                   r
                                                
                                                R
                                             
                                             )
                                          
                                          +
                                          
                                             κ
                                             r
                                             R
                                          
                                          
                                             (
                                             
                                                
                                                   μ
                                                   ¯
                                                
                                                l
                                             
                                             +
                                             
                                                
                                                   μ
                                                   ̲
                                                
                                                l
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                          ⊥
                                          
                                          
                                             e
                                             l
                                          
                                          ≥
                                          0
                                          
                                          if
                                          
                                          l
                                          ∈
                                          
                                             L
                                             r
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9b)
                           
                              
                                 
                                    
                                       
                                          0
                                          =
                                          
                                             
                                                [
                                                −
                                                
                                                   p
                                                   n
                                                
                                                +
                                                
                                                   c
                                                   
                                                      n
                                                      s
                                                   
                                                   G
                                                
                                                ]
                                             
                                             
                                                if
                                                
                                                n
                                                ∈
                                                
                                                   N
                                                   r
                                                
                                             
                                          
                                          −
                                          
                                             λ
                                             
                                                n
                                                r
                                             
                                             R
                                          
                                          +
                                          
                                             β
                                             
                                                n
                                                s
                                                r
                                             
                                             R
                                          
                                          −
                                          
                                             ψ
                                             
                                                r
                                                n
                                                s
                                             
                                             R
                                          
                                          +
                                          
                                             κ
                                             r
                                             R
                                          
                                          
                                             c
                                             
                                                n
                                                s
                                             
                                             G
                                          
                                       
                                    
                                    
                                       
                                          ,
                                          
                                          
                                             g
                                             
                                                n
                                                s
                                             
                                          
                                          
                                          (free)
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9c)
                           
                              
                                 
                                    
                                       0
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             [
                                             −
                                             
                                                a
                                                n
                                             
                                             +
                                             
                                                b
                                                n
                                             
                                             
                                                d
                                                n
                                             
                                             +
                                             
                                                p
                                                n
                                             
                                             ]
                                          
                                          
                                             if
                                             
                                             n
                                             ∈
                                             
                                                N
                                                r
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                             ρ
                                             
                                                n
                                                r
                                             
                                             R
                                          
                                          
                                             b
                                             n
                                          
                                          +
                                          
                                             λ
                                             
                                                n
                                                r
                                             
                                             R
                                          
                                          −
                                          
                                             ϕ
                                             
                                                n
                                                r
                                             
                                             R
                                          
                                          −
                                          
                                             κ
                                             r
                                             R
                                          
                                          
                                             (
                                             
                                                a
                                                n
                                             
                                             −
                                             
                                                b
                                                n
                                             
                                             
                                                d
                                                n
                                             
                                             )
                                          
                                          ,
                                          
                                          
                                             d
                                             n
                                          
                                          
                                          (free)
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9d)
                           
                              
                                 
                                    
                                       0
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             [
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   
                                                      L
                                                      r
                                                   
                                                
                                             
                                             s
                                             h
                                             
                                                r
                                                
                                                   l
                                                   r
                                                
                                             
                                             
                                                H
                                                
                                                   l
                                                   n
                                                
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                I
                                                
                                                   l
                                                   k
                                                
                                             
                                             
                                                p
                                                k
                                             
                                             ]
                                          
                                          
                                             if
                                             
                                             n
                                             ∈
                                             
                                                N
                                                r
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                N
                                             
                                          
                                          
                                             B
                                             
                                                k
                                                n
                                             
                                          
                                          
                                             λ
                                             
                                                k
                                                r
                                             
                                             R
                                          
                                          +
                                          
                                             ∑
                                             
                                                l
                                                ∈
                                                L
                                             
                                          
                                          
                                             H
                                             
                                                l
                                                n
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   μ
                                                   ¯
                                                
                                                
                                                   l
                                                   r
                                                
                                                R
                                             
                                             −
                                             
                                                
                                                   μ
                                                   ̲
                                                
                                                
                                                   l
                                                   r
                                                
                                                R
                                             
                                             )
                                          
                                          
                                          −
                                          
                                          
                                             {
                                             
                                                
                                                   
                                                      γ
                                                      r
                                                      R
                                                   
                                                   
                                                   if
                                                   
                                                   n
                                                   =
                                                   
                                                      n
                                                      ^
                                                   
                                                
                                                
                                                   0
                                                   
                                                   else
                                                   
                                                
                                             
                                             }
                                          
                                          ,
                                          
                                          
                                          
                                          
                                             δ
                                             n
                                          
                                          
                                          (free)
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9e)
                           
                              
                                 
                                    
                                       0
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             [
                                             
                                                d
                                                n
                                             
                                             −
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                g
                                                
                                                   n
                                                   s
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   
                                                      L
                                                      r
                                                   
                                                
                                             
                                             s
                                             h
                                             
                                                r
                                                
                                                   l
                                                   r
                                                
                                             
                                             
                                                I
                                                
                                                   l
                                                   n
                                                
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                H
                                                
                                                   l
                                                   k
                                                
                                             
                                             
                                                δ
                                                k
                                             
                                             ]
                                          
                                          
                                             if
                                             
                                             n
                                             ∈
                                             
                                                N
                                                r
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                s
                                                ∈
                                                S
                                             
                                          
                                          
                                             η
                                             
                                                n
                                                s
                                                r
                                             
                                             R
                                          
                                          −
                                          
                                             ρ
                                             
                                                n
                                                r
                                             
                                             R
                                          
                                          −
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                N
                                             
                                          
                                          
                                             ν
                                             
                                                k
                                                r
                                             
                                             R
                                          
                                          
                                             B
                                             
                                                n
                                                k
                                             
                                          
                                          +
                                          
                                             κ
                                             r
                                             R
                                          
                                          
                                             1
                                             
                                                b
                                                n
                                             
                                          
                                          
                                             (
                                             
                                                p
                                                n
                                             
                                             −
                                             
                                                a
                                                n
                                             
                                             −
                                             
                                                ϕ
                                                n
                                             
                                             )
                                          
                                          ,
                                          
                                          
                                          
                                             p
                                             n
                                          
                                          (free)
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9f)
                           
                              
                                 
                                    
                                       
                                          0
                                          ≤
                                          −
                                          
                                             ∑
                                             
                                                n
                                                ∈
                                                N
                                             
                                          
                                          
                                             ν
                                             
                                                n
                                                r
                                             
                                             R
                                          
                                          
                                             H
                                             
                                                l
                                                n
                                             
                                          
                                          +
                                          
                                             κ
                                             r
                                             R
                                          
                                          
                                             (
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                l
                                             
                                             +
                                             
                                                e
                                                l
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                          ⊥
                                          
                                          
                                             
                                                μ
                                                ¯
                                             
                                             l
                                          
                                          ≥
                                          0
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9g)
                           
                              
                                 
                                    
                                       
                                          0
                                          ≤
                                          
                                             ∑
                                             
                                                n
                                                ∈
                                                N
                                             
                                          
                                          
                                             ν
                                             
                                                n
                                                r
                                             
                                             R
                                          
                                          
                                             H
                                             
                                                l
                                                n
                                             
                                          
                                          +
                                          
                                             κ
                                             r
                                             R
                                          
                                          
                                             (
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                l
                                             
                                             +
                                             
                                                e
                                                l
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                          ⊥
                                          
                                          
                                             
                                                μ
                                                ̲
                                             
                                             l
                                          
                                          ≥
                                          0
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9h)
                           
                              
                                 
                                    
                                       
                                          0
                                          ≤
                                          −
                                          
                                             η
                                             
                                                n
                                                s
                                                r
                                             
                                             R
                                          
                                          +
                                          
                                             κ
                                             r
                                             R
                                          
                                          
                                             
                                                g
                                                ¯
                                             
                                             
                                                n
                                                s
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          ⊥
                                          
                                          
                                             β
                                             
                                                n
                                                s
                                             
                                          
                                          ≥
                                          0
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9i)
                           
                              
                                 
                                    
                                       
                                          0
                                          =
                                          
                                             ν
                                             
                                                
                                                   n
                                                   ^
                                                
                                                r
                                             
                                             R
                                          
                                       
                                    
                                    
                                       
                                          ,
                                          
                                          γ
                                          (free)
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9j)
                           
                              
                                 
                                    
                                       
                                          0
                                          ≤
                                          
                                             η
                                             
                                                n
                                                s
                                                r
                                             
                                             R
                                          
                                       
                                    
                                    
                                       
                                          
                                          ⊥
                                          
                                          
                                             ψ
                                             
                                                n
                                                s
                                             
                                          
                                          ≥
                                          0
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9k)
                           
                              
                                 
                                    
                                       0
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             ρ
                                             
                                                n
                                                r
                                             
                                             R
                                          
                                          +
                                          
                                             κ
                                             r
                                             R
                                          
                                          
                                             1
                                             
                                                b
                                                n
                                             
                                          
                                          
                                             (
                                             
                                                ϕ
                                                n
                                             
                                             +
                                             
                                                a
                                                n
                                             
                                             −
                                             
                                                p
                                                n
                                             
                                             )
                                          
                                          
                                          ⊥
                                          
                                          
                                             ϕ
                                             n
                                          
                                          ≥
                                          0
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          Eqs.
                                          
                                          (5b)--(5l)
                                          
                                          in
                                          
                                          complementarity
                                          
                                          form
                                       
                                    
                                 
                              
                           
                        
                     
                  

As explained in Section 5, the strong duality constraint is replaced by the ISO’s equilibrium constraints (Eqs. (2)). All complementarity conditions are replaced by the disjunctive constraints reformulation. The constraints are bilinear (and non-convex) in the dual variable to the strong-duality constraint (
                        
                           κ
                           r
                           R
                        
                     ).

Supplementary material associated with this article can be found, in the online version, at 10.1016/j.ejor.2015.05.056.


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

