@&#MAIN-TITLE@&#Derivatives of isogeometric functions on n-dimensional rational patches in 
                  
                     
                        R
                     
                     
                        d
                     
                  
               
            

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We derive an exact representation of the derivatives of an isogeometric function.


                        
                        
                           
                           The isogeometric function is defined over a domain of arbitrary dimension.


                        
                        
                           
                           We use the formula to derive smoothness results for functions on singular patches.


                        
                        
                           
                           The conditions depend on the exact representation of the interior of the domain.


                        
                        
                           
                           The derivative formula can be used to derive functionals for regularization.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Isogeometric analysis

Derivative

NURBS

Singular patch

Smoothness

Embedded manifold

@&#ABSTRACT@&#


               
               
                  We consider isogeometric functions and their derivatives. Given a geometry mapping, which is defined by an n-dimensional NURBS patch in 
                        
                           
                              R
                           
                           
                              d
                           
                        
                     , an isogeometric function is obtained by composing the inverse of the geometry mapping with a NURBS function in the parameter domain. Hence an isogeometric function can be represented by a NURBS parametrization of its graph. We take advantage of the projective representation of the NURBS patch as a B-spline patch in homogeneous coordinates.
                  We derive a closed form representation of the graph of a partial derivative of an isogeometric function. The derivative can be interpreted as an isogeometric function of higher degree and lower smoothness on the same piecewise rational geometry mapping, hence the space of isogeometric functions is closed under differentiation. We distinguish the two cases 
                        n
                        =
                        d
                      and 
                        n
                        <
                        d
                     , with a focus on 
                        n
                        =
                        d
                        −
                        1
                      in the latter one.
                  As a first application of the presented formula we derive conditions which guarantee 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      smoothness for isogeometric functions on several singularly parametrized planar and volumetric domains as well as on embedded surfaces. It is interesting to note that the presented conditions depend not only on the general structure of the patch, but on the exact representation of the interior of the given geometry mapping.
               
            

@&#INTRODUCTION@&#

The aim of this work is to contribute to a better understanding of the properties of derivatives of the functions that occur in isogeometric analysis. Our starting point is the notion of isogeometric functions. It is inspired by the seminal article by Hughes et al. (2005), which introduced the framework of isogeometric analysis (IgA). An isogeometric function is the composition of a NURBS function defined on some parameter domain with the inverse of a NURBS geometry mapping defined on the same parameter domain. Ideally, the geometry mapping is directly obtained from the NURBS representations in an existing CAD model. In this case, the numerical simulations can be performed directly based on the exact geometric representations provided by the CAD framework.

In IgA, the space of isogeometric functions is used to discretize and solve a partial differential equation. The underlying physical domain is defined by the NURBS geometry mapping. The numerical simulation uses the isogeometric functions as test/trial functions for a Galerkin discretization of the variational formulation (see e.g. Hughes et al., 2005; Gomez et al., 2008; Cottrell et al., 2009). Alternatively, these functions can be used as a basis for a collocation approach (see Auricchio et al., 2010; Schillinger et al., 2013). Consequently, it is necessary to find a good representation of the derivatives of the test functions, either for approximation or for point-wise evaluation. In addition, it may be necessary to establish smoothness and regularity properties of the spaces of isogeometric functions, which possibly entail additional constraints, e.g., for singularly parametrized domains.

The properties of derivatives of NURBS patches are well understood. When it comes to derivatives of isogeometric functions defined on these patches, however, many questions are still open. An exact representation is hard to obtain, since the derivatives of piecewise rational functions and their inverse functions are involved.

The approach presented in the paper leads to a closed-form representation of the derivatives of isogeometric functions which can be evaluated in a stable way. Moreover, this representation is quite helpful for analyzing the 
                        
                           
                              C
                           
                           
                              k
                           
                        
                      smoothness or the 
                        
                           
                              H
                           
                           
                              k
                           
                        
                      regularity of an isogeometric function. We consider the most general setting, i.e. domains represented by n-dimensional patches in 
                        
                           
                              R
                           
                           
                              d
                           
                        
                     , for both 
                        n
                        =
                        d
                      and 
                        n
                        <
                        d
                     , where we especially focus on 
                        n
                        =
                        d
                        −
                        1
                      (such as surface patches in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                     ). The present paper is an extension of a conference article by Takacs and Jüttler (2013), which was limited to the case 
                        n
                        =
                        d
                        =
                        2
                     .

An isogeometric function on a physical domain, defined by a NURBS patch, can be represented as a NURBS patch parametrizing its graph. If the domain is an n-dimensional patch in 
                        
                           
                              R
                           
                           
                              d
                           
                        
                     , then the graph of an isogeometric function is an n-dimensional patch in 
                        
                           
                              R
                           
                           
                              d
                              +
                              1
                           
                        
                     . Throughout this paper we will use homogeneous coordinates to simplify the notation. Using this approach, we develop a closed form representation of the graphs of the partial derivatives of an isogeometric function. The derivatives can again be interpreted as isogeometric functions of higher degree and lower smoothness defined on the image of the same piecewise rational geometry mapping.

Consequently, the space of isogeometric functions on a given domain patch is closed under differentiation. We derive an exact representation of the derivatives of isogeometric functions. This may be of interest for symbolic manipulations, for other applications where an exact evaluation of derivatives is necessary, and for the formulation of regularization methods for solving inverse problems using the isogeometric approach.

As a first application, we investigate conditions that guarantee smoothness when dealing with patches with singular parametrizations. Related results concerning the smoothness of singular rational Bézier patches were developed e.g. by Bohl and Reif (1997) and Sederberg et al. (2011). We consider a slightly different framework. First, we keep the domain parametrization fixed and consider the space of isogeometric functions defined over this domain parametrization. Second, we investigate not only surfaces, but parameterizations of general n-dimensional patches in 
                        
                           
                              R
                           
                           
                              d
                           
                        
                     . Our method provides a systematic approach to derive conditions which characterize smoothness of arbitrary order. We demonstrate the capabilities of the proposed approach to smoothness analysis by presenting results for parametrizations of planar and volumetric domains and for surfaces in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                     .

Regularly mapped, tensor-product NURBS can describe quadrilateral (
                        n
                        =
                        2
                     ) or hexahedral (
                        n
                        =
                        3
                     ) domains only. When it comes to representing more general domains, a standard approach is to consider singular patches. Consequently, surface patches such as the spherical shell presented in Section 6 are used in many applications (see e.g. Kiendl et al., 2009; Benson et al., 2010). The results concerning the smoothness of isogeometric functions are related to the results by Takacs and Jüttler (2011, 2012) concerning 
                        
                           
                              H
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              H
                           
                           
                              2
                           
                        
                      regularity properties on singular patches.

When using singular patches, certain isogeometric basis functions may not be 
                        
                           
                              C
                           
                           
                              1
                           
                        
                     - or 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -smooth, hence some derivatives cannot be evaluated properly. This may affect the stability and convergence properties of the numerical schemes applied. Contributions to the numerical analysis in IgA include consistency, stability and approximation power of the method (Bazilevs et al., 2006; Cottrell et al., 2007; Hughes et al., 2010; Echter and Bischoff, 2010). However, singularly parametrized domains are not covered by these general results and have to be dealt with differently.

The first strategy that comes to mind when dealing with singular patches is to cut out the near-singular part of the patch, i.e. not evaluating functions at points where the Jacobian determinant is close to zero. However, this will lead to a reduced order of convergence in many situations. Another approach to handle singularities is to define some auxiliary basis functions locally at the singularity. We suggest to define new basis functions that lie in the span of the standard basis, i.e. that are smooth linear combinations of the non-smooth basis functions. We derive conditions on the isogeometric functions that guarantee the desired smoothness. These conditions can be used to define new basis functions and thus a smooth function space for discretization. It turns out that the dimension of this smooth function space is very sensitive to changes of the geometry mapping.

The remainder of the paper is organized as follows. In Section 2 we introduce the notation of isogeometric functions on rational patches. We first introduce the homogeneous coordinate representation of rational n-dimensional patches in 
                        
                           
                              R
                           
                           
                              d
                           
                        
                     . In the second part we introduce isogeometric functions on such patches. In Section 3 we treat the case of derivatives on patches with 
                        n
                        =
                        d
                     . We then discuss 
                        
                           
                              C
                           
                           
                              1
                           
                        
                        (
                        
                           
                              Ω
                           
                           
                              ¯
                           
                        
                        )
                      and 
                        
                           
                              C
                           
                           
                              2
                           
                        
                        (
                        
                           
                              Ω
                           
                           
                              ¯
                           
                        
                        )
                      smoothness properties of isogeometric functions on planar domains Ω in Section 4. We denote by 
                        
                           
                              C
                           
                           
                              k
                           
                        
                        (
                        
                           
                              Ω
                           
                           
                              ¯
                           
                        
                        )
                      the space of functions where the k-th derivatives are continuous in the interior of the domain Ω and can be extended continuously to the boundary ∂Ω. In Section 5 we extend the results to n-dimensional patches in 
                        
                           
                              R
                           
                           
                              d
                           
                        
                      with 
                        n
                        <
                        d
                     . We especially focus on surfaces in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                      in Section 6, where we consider four examples corresponding to two types of model cases. We conclude the paper with some final remarks in Section 7.

We introduce rational n-dimensional patches, which are embedded into the Euclidean space of dimension d and we define isogeometric functions on these patches.

Throughout this section we deal with piecewise rational parametrizations of patches in 
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                        . In order to keep the notation simple we will adopt the concept of homogeneous coordinates. This is a common approach when dealing with rational functions or NURBS (see e.g. Farin, 1999).

Any Cartesian coordinate vector 
                           r
                           =
                           
                              
                                 [
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       d
                                    
                                 
                                 ]
                              
                              
                                 T
                              
                           
                         in 
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                         can be represented in homogeneous coordinates by
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       ˜
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             d
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 ∈
                                 R
                                 \
                                 {
                                 0
                                 }
                                 ×
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 r
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                              
                           
                           /
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 0
                              
                           
                         for 
                           i
                           ∈
                           {
                           1
                           ,
                           …
                           ,
                           d
                           }
                        . Hence any two points r and s are identical if and only if the homogeneous coordinate vectors 
                           
                              
                                 r
                              
                              
                                 ˜
                              
                           
                         and 
                           
                              
                                 s
                              
                              
                                 ˜
                              
                           
                         are linearly dependent. More precisely, a point with the Cartesian coordinates r corresponds to the equivalence class 
                           
                              
                                 r
                              
                              
                                 ˜
                              
                           
                           R
                         of points in homogeneous coordinates. In the remainder of this paper, homogeneous coordinates are always denoted with a tilde (
                           
                              
                                 r
                              
                              
                                 ˜
                              
                           
                        ) and Cartesian coordinates without it (r).

A piecewise rational patch in Cartesian coordinates
                           
                              
                                 r
                                 (
                                 u
                                 )
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             (
                                             u
                                             )
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             (
                                             u
                                             )
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   d
                                                
                                             
                                             (
                                             u
                                             )
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             (
                                             u
                                             )
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 
                                 for
                                 
                                 u
                                 ∈
                                 B
                                 ⊂
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                              
                           
                         can be represented by a piecewise polynomial parametrization in homogeneous coordinates,
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 u
                                 )
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       u
                                       )
                                       ,
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       u
                                       )
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       u
                                       )
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 
                                 for
                                 
                                 u
                                 ∈
                                 B
                                 .
                              
                           
                         The parameter domain B of the patch is the n-dimensional open box
                           
                              
                                 B
                                 =
                                 
                                    
                                       (
                                       0
                                       ,
                                       1
                                       )
                                    
                                    
                                       n
                                    
                                 
                                 .
                              
                           
                         We assume that 
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 0
                              
                           
                           (
                           u
                           )
                           >
                           0
                         for all 
                           u
                           ∈
                           
                              
                                 B
                              
                              
                                 ¯
                              
                           
                        . Here 
                           
                              
                                 B
                              
                              
                                 ¯
                              
                           
                         is the closure of B. The homogeneous coordinates are piecewise polynomial spline functions, 
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 d
                                 +
                                 1
                              
                           
                           ∈
                           
                              
                                 S
                              
                              
                                 p
                                 ,
                                 s
                              
                           
                        . Here 
                           
                              
                                 S
                              
                              
                                 p
                                 ,
                                 s
                              
                           
                         is the space of 
                           
                              
                                 C
                              
                              
                                 s
                              
                           
                        -smooth tensor-product spline functions of degree 
                           p
                           =
                           (
                           
                              
                                 p
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 p
                              
                              
                                 n
                              
                           
                           )
                         with the inner knots 
                           
                              
                                 θ
                              
                              
                                 j
                              
                              
                                 ν
                              
                           
                        , 
                           ν
                           =
                           1
                           ,
                           …
                           ,
                           n
                        , where the vector 
                           s
                           =
                           (
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 s
                              
                              
                                 n
                              
                           
                           )
                         specifies the order of smoothness (differentiability) with respect to the parameters 
                           u
                           =
                           (
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 u
                              
                              
                                 n
                              
                           
                           )
                        . Consequently, the knot vectors take the form
                           
                              (1)
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ν
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             0
                                             ,
                                             …
                                             ,
                                             0
                                          
                                          ︸
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ν
                                             
                                          
                                          +
                                          1
                                          
                                          times
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   j
                                                
                                                
                                                   ν
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   θ
                                                
                                                
                                                   j
                                                
                                                
                                                   ν
                                                
                                             
                                          
                                          ︸
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ν
                                             
                                          
                                          −
                                          
                                             
                                                s
                                             
                                             
                                                ν
                                             
                                          
                                          
                                          times
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          
                                             1
                                             ,
                                             …
                                             ,
                                             1
                                          
                                          ︸
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ν
                                             
                                          
                                          +
                                          1
                                          
                                          times
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         We will not consider spline spaces with more general knot vectors in this paper. The bounds for the degree and smoothness of the derivative patches, which will be derived in the later sections, can be generalized to more general spline spaces. For details on NURBS and B-splines and their applications in computer aided geometric design we refer to Farin (1999), Prautzsch et al. (2002), Hoschek and Lasser (1993).

We recall the tensor-product B-spline representation of 
                           
                              
                                 r
                              
                              
                                 ˜
                              
                           
                         with respect to the tensor-product B-spline basis 
                           
                              
                                 {
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 ∈
                                 I
                              
                           
                         of 
                           
                              
                                 S
                              
                              
                                 p
                                 ,
                                 s
                              
                           
                        ,
                           
                              (2)
                              
                                 
                                    
                                       r
                                    
                                    
                                       ˜
                                    
                                 
                                 :
                                 u
                                 ↦
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       u
                                       )
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       u
                                       )
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 u
                                 )
                                 ,
                              
                           
                         with homogeneous control points 
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 d
                                 +
                                 1
                              
                           
                        . When using Cartesian coordinates, this is transformed into
                           
                              (3)
                              
                                 r
                                 :
                                 u
                                 ↦
                                 
                                    
                                       (
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       u
                                       )
                                       ,
                                       …
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       u
                                       )
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 u
                                 )
                                 ,
                              
                           
                         with Cartesian control points 
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                 
                                 /
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       d
                                    
                                 
                                 /
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       0
                                    
                                 
                                 )
                              
                              
                                 T
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                        , weights 
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                                 ,
                                 0
                              
                           
                         and piecewise rational (NURBS) basis functions
                           
                              (4)
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 u
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             0
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       u
                                       )
                                    
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       u
                                       )
                                    
                                 
                                 ,
                                 
                                 with
                                 
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 u
                                 )
                                 =
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       I
                                    
                                 
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       j
                                       ,
                                       0
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 u
                                 )
                                 .
                              
                           
                         The (physical) domain 
                           Ω
                           ⊂
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                         is given as the image of the geometry mapping r, i.e. 
                           Ω
                           =
                           r
                           (
                           B
                           )
                        , where we assume that the mapping 
                           r
                           :
                           B
                           →
                           Ω
                         is bijective. In the following subsection we define isogeometric functions on the domain Ω.

We consider a bijective NURBS patch 
                           r
                           :
                           B
                           →
                           Ω
                           ⊂
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                         as in (3) with 
                           
                              
                                 r
                              
                              
                                 ˜
                              
                           
                         as in (2) such that 
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 j
                              
                           
                           ∈
                           
                              
                                 S
                              
                              
                                 p
                                 ,
                                 s
                              
                           
                        , for 
                           0
                           ≤
                           j
                           ≤
                           d
                        .


                        
                           Definition 1
                           Consider an auxiliary spline function 
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       d
                                       +
                                       1
                                    
                                 
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       p
                                       ,
                                       s
                                    
                                 
                              ,
                                 
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             d
                                             +
                                             1
                                          
                                       
                                       (
                                       u
                                       )
                                       =
                                       
                                          ∑
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       u
                                       )
                                       .
                                    
                                 
                               The function 
                                 f
                                 :
                                 Ω
                                 =
                                 r
                                 (
                                 B
                                 )
                                 →
                                 R
                              , which is defined via
                                 
                                    
                                       f
                                       
                                          (
                                          r
                                          (
                                          u
                                          )
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   d
                                                   +
                                                   1
                                                
                                             
                                             (
                                             u
                                             )
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             (
                                             u
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             r
                                          
                                          
                                             d
                                             +
                                             1
                                          
                                       
                                       (
                                       u
                                       )
                                    
                                 
                               is called an isogeometric function on the physical domain Ω. The symbol 
                                 
                                    
                                       V
                                    
                                    
                                       p
                                       ,
                                       s
                                    
                                 
                               denotes the space of all isogeometric functions obtained by considering 
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       d
                                       +
                                       1
                                    
                                 
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       p
                                       ,
                                       s
                                    
                                 
                              .

Clearly, due to the nestedness of spline spaces, it is possible to use spline spaces of higher degree 
                           
                              
                                 p
                              
                              
                                 ′
                              
                           
                           ≥
                           p
                         and lower smoothness 
                           
                              
                                 s
                              
                              
                                 ′
                              
                           
                           ≤
                           s
                         with the same inner knots (with suitably increased knot multiplicities). The space 
                           V
                         of all isogeometric functions is obtained by considering piecewise polynomial functions 
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 d
                                 +
                                 1
                              
                           
                         of any degree over the given knot sequences. Strictly speaking, these functions are defined only in the interior of the boxes defined by the knot sequences, since they need not be continuous.

The graph of an isogeometric function 
                           f
                           ∈
                           
                              
                                 V
                              
                              
                                 p
                                 ,
                                 s
                              
                           
                         can be represented by the parametric surface
                        
                           
                              (5)
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 u
                                 )
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       u
                                       )
                                       ,
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       u
                                       )
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       u
                                       )
                                       ,
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             d
                                             +
                                             1
                                          
                                       
                                       (
                                       u
                                       )
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                         which possesses the B-spline representation
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 u
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 u
                                 )
                                 ,
                              
                           
                         with homogeneous control points 
                           
                              
                                 (
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       d
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 T
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 d
                                 +
                                 2
                              
                           
                         for 
                           i
                           ∈
                           I
                        .

If all weights 
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                                 ,
                                 0
                              
                           
                         are non-zero, then an isogeometric function 
                           f
                           ∈
                           
                              
                                 V
                              
                              
                                 p
                                 ,
                                 s
                              
                           
                         has a representation in the basis 
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                           ∘
                           
                              
                                 r
                              
                              
                                 −
                                 1
                              
                           
                         with coefficients 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                              
                           
                           /
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                                 ,
                                 0
                              
                           
                         where the rational basis functions 
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                         are given as in (4), i.e.
                           
                              
                                 f
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             d
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 ∘
                                 
                                    
                                       r
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          0
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          i
                                       
                                    
                                    ∘
                                    
                                       
                                          r
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

We present two simple examples to give a geometric interpretation of isogeometric functions. The left part of Fig. 1
                         depicts a bivariate geometry mapping r of a planar domain Ω and the graph surface f of an isogeometric function f defined on Ω. The right part visualizes an isogeometric function f defined over a planar curve given by r.

In the following sections we derive a closed form representation of the derivatives of isogeometric functions 
                           f
                           ∈
                           
                              
                                 V
                              
                              
                                 p
                                 ,
                                 s
                              
                           
                         and, more generally, 
                           f
                           ∈
                           V
                        . The main results, which will be presented in Theorems 3 and 5, are valid for NURBS. In the examples in Sections 4 and 6, however, we will restrict ourselves to rational tensor-product Bézier patches. There we consider 
                           
                              
                                 S
                              
                              
                                 p
                                 ,
                                 s
                              
                           
                           =
                           
                              
                                 S
                              
                              
                                 p
                                 ,
                                 p
                              
                           
                           =
                           
                              
                                 Π
                              
                              
                                 p
                              
                           
                        , where 
                           
                              
                                 Π
                              
                              
                                 p
                              
                           
                         is the space of polynomials of degree p. The Bernstein polynomials
                           
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 u
                                 )
                                 =
                                 
                                    ∏
                                    
                                       j
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             i
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                           
                         for 
                           u
                           =
                           (
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 u
                              
                              
                                 n
                              
                           
                           )
                         and
                           
                              
                                 i
                                 ∈
                                 I
                                 =
                                 
                                    {
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    :
                                    0
                                    ≤
                                    
                                       
                                          i
                                       
                                       
                                          j
                                       
                                    
                                    ≤
                                    
                                       
                                          p
                                       
                                       
                                          j
                                       
                                    
                                    
                                    ∀
                                    1
                                    ≤
                                    j
                                    ≤
                                    n
                                    }
                                 
                              
                           
                         form a basis of the space 
                           
                              
                                 Π
                              
                              
                                 p
                              
                           
                        . In this context we will omit the index 
                           s
                           =
                           p
                         for the order of smoothness and write simply 
                           
                              
                                 S
                              
                              
                                 p
                              
                           
                        , 
                           
                              
                                 V
                              
                              
                                 p
                              
                           
                         instead of 
                           
                              
                                 S
                              
                              
                                 p
                                 ,
                                 p
                              
                           
                        , 
                           
                              
                                 V
                              
                              
                                 p
                                 ,
                                 p
                              
                           
                        . Clearly, any NURBS parametrization can be transformed into a piecewise Bézier representation via knot insertion.

In this section we assume that the geometry mapping takes the form
                        
                           
                              r
                              :
                              B
                              ⊂
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                              →
                              Ω
                              ⊂
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                              .
                           
                        
                      We derive a representation of the partial derivatives of an isogeometric function 
                        f
                        ∈
                        V
                      with respect to the coordinates in physical space 
                        
                           
                              x
                           
                           
                              i
                           
                        
                      for 
                        i
                        ∈
                        {
                        1
                        ,
                        …
                        ,
                        d
                        }
                     . More precisely, we define an operator 
                        
                           
                              D
                           
                           
                              i
                           
                        
                     , such that 
                        
                           
                              D
                           
                           
                              i
                           
                        
                        
                           
                              r
                           
                           
                              ˜
                           
                        
                      represents the graph of 
                        
                           
                              ∇
                           
                           
                              i
                           
                        
                        f
                     , similar to the representation (5). Here 
                        
                           
                              ∇
                           
                           
                              i
                           
                        
                        f
                        =
                        
                           
                              ∂
                              f
                           
                           
                              ∂
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           
                        
                      is the i-th component of the gradient of f.

Note that the graph f of an isogeometric function f is a hypersurface in 
                        
                           
                              R
                           
                           
                              d
                              +
                              1
                           
                        
                     . We recall the homogeneous representation of the tangent space to a parametrized hypersurface f at a point 
                        f
                        (
                        u
                        )
                      (cf. Ovsienko and Tabachnikov, 2005):


                     
                        Lemma 2
                        
                           Let 
                           f 
                           be a d-dimensional patch in 
                           
                              
                                 
                                    R
                                 
                                 
                                    d
                                    +
                                    1
                                 
                              
                           
                           , which is given in the form 
                           (5) 
                           with 
                           
                              n
                              =
                              d
                           
                           . We consider the tangent hyperplane 
                           
                              
                                 
                                    T
                                 
                                 
                                    u
                                 
                              
                            
                           to the manifold at the point 
                           
                              f
                              (
                              u
                              )
                           
                           , which is assumed to be regular. The points of this hyperplane satisfy the equation
                           
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ˜
                                       
                                    
                                    
                                       
                                          (
                                          u
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          ˜
                                       
                                    
                                    =
                                    0
                                    ,
                                 
                              
                            
                           where the vector 
                           
                              
                                 
                                    g
                                 
                                 
                                    ˜
                                 
                              
                              (
                              u
                              )
                            
                           has the entries
                           
                              
                                 (6)
                                 
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          j
                                       
                                    
                                    (
                                    u
                                    )
                                    =
                                    det
                                    ⁡
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             f
                                          
                                          
                                             ˜
                                          
                                       
                                       (
                                       u
                                       )
                                       ,
                                       
                                          
                                             ∂
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             ˜
                                          
                                       
                                       (
                                       u
                                       )
                                       ,
                                       …
                                       ,
                                       
                                          
                                             ∂
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             ˜
                                          
                                       
                                       (
                                       u
                                       )
                                       )
                                    
                                    ,
                                    
                                    j
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    d
                                    +
                                    1
                                    .
                                 
                              
                           
                        

In these formulas, the vectors 
                        
                           
                              
                                 
                                    e
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              j
                           
                        
                      are the unit vectors spanning the coordinate axes in 
                        
                           
                              R
                           
                           
                              d
                              +
                              1
                           
                        
                     , i.e. 
                        
                           
                              
                                 
                                    e
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              0
                           
                        
                        =
                        
                           
                              (
                              1
                              ,
                              0
                              ,
                              …
                              ,
                              0
                              )
                           
                           
                              T
                           
                        
                     , 
                        
                           
                              
                                 
                                    e
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              1
                           
                        
                        =
                        
                           
                              (
                              0
                              ,
                              1
                              ,
                              0
                              ,
                              …
                              ,
                              0
                              )
                           
                           
                              T
                           
                        
                     , etc., and
                        
                           
                              
                                 
                                    ∂
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    ˜
                                 
                              
                              (
                              u
                              )
                              =
                              
                                 
                                    ∂
                                    
                                       
                                          f
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              u
                              )
                           
                        
                      denotes the partial derivative with respect to the i-th parameter 
                        
                           
                              u
                           
                           
                              i
                           
                        
                     .

The proof of this observation results from the fact that a point 
                        
                           
                              x
                           
                           
                              ˜
                           
                        
                      belongs to the tangent hyperplane if and only if its homogeneous coordinates are linearly dependent on 
                        
                           
                              f
                           
                           
                              ˜
                           
                        
                      and the d partial derivatives of the vector 
                        
                           
                              f
                           
                           
                              ˜
                           
                        
                      of homogeneous coordinates.

We use this well-known result from projective geometry to derive a representation of the derivatives of isogeometric functions as rational hypersurface patches. More precisely, given the graph of an isogeometric function f as a d-dimensional patch in 
                        
                           
                              R
                           
                           
                              d
                              +
                              1
                           
                        
                     , the following theorem provides a representation of the graph of a partial derivative of f, again as a d-dimensional patch in 
                        
                           
                              R
                           
                           
                              d
                              +
                              1
                           
                        
                     :


                     
                        Theorem 3
                        
                           The graph of the partial derivative 
                           
                              
                                 
                                    ∇
                                 
                                 
                                    i
                                 
                              
                              f
                              =
                              
                                 
                                    ∂
                                    f
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                            
                           of an isogeometric function 
                           
                              f
                              ∈
                              V
                           
                           , which is given in the form 
                           (5) 
                           with 
                           
                              n
                              =
                              d
                           
                           , can be represented by the parametric hypersurface
                           
                              
                                 (7)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          ˜
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          ,
                                          −
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    .
                                 
                              
                           
                        


                     
                        Proof
                        We consider a fixed parameter value u. According to Lemma 2, the tangent hyperplane of the hypersurface 
                              
                                 
                                    f
                                 
                                 
                                    ˜
                                 
                              
                            at u is
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          u
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             x
                                          
                                          
                                             ˜
                                          
                                       
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             d
                                             +
                                             2
                                          
                                       
                                       :
                                       
                                          
                                             g
                                          
                                          
                                             ˜
                                          
                                       
                                       
                                          
                                             (
                                             u
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ˜
                                          
                                       
                                       =
                                       0
                                       }
                                    
                                    .
                                 
                              
                            Let 
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              f
                              (
                              x
                              )
                            be the first order Taylor approximation of f at 
                              r
                              (
                              u
                              )
                           . Inserting 
                              
                                 
                                    (
                                    1
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          d
                                       
                                    
                                    ,
                                    
                                       
                                          T
                                       
                                       
                                          1
                                       
                                    
                                    f
                                    (
                                    x
                                    )
                                    )
                                 
                                 
                                    T
                                 
                              
                            into the equation of the tangent plane gives
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    u
                                    )
                                    +
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       d
                                    
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          j
                                       
                                    
                                    (
                                    u
                                    )
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          d
                                          +
                                          1
                                       
                                    
                                    (
                                    u
                                    )
                                    
                                       
                                          T
                                       
                                       
                                          1
                                       
                                    
                                    f
                                    (
                                    x
                                    )
                                    =
                                    0
                                    ,
                                 
                              
                            with 
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    j
                                 
                              
                            as in (6). Solving for 
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              f
                              (
                              x
                              )
                            leads to
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          1
                                       
                                    
                                    f
                                    (
                                    x
                                    )
                                    =
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          (
                                          u
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          (
                                          u
                                          )
                                       
                                    
                                    −
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       d
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                j
                                             
                                          
                                          (
                                          u
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          (
                                          u
                                          )
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                            hence
                              
                                 
                                    
                                       
                                          ∂
                                          
                                             
                                                T
                                             
                                             
                                                1
                                             
                                          
                                          f
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          u
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          (
                                          u
                                          )
                                       
                                    
                                    .
                                 
                              
                            Since 
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              f
                              (
                              x
                              )
                            is the first order Taylor approximation of f at the point 
                              x
                              =
                              r
                              (
                              u
                              )
                           ,
                              
                                 
                                    
                                       
                                          ∂
                                          f
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       (
                                       r
                                       (
                                       u
                                       )
                                       )
                                    
                                    =
                                    
                                       
                                          ∂
                                          
                                             
                                                T
                                             
                                             
                                                1
                                             
                                          
                                          f
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          u
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          (
                                          u
                                          )
                                       
                                    
                                    .
                                 
                              
                            Therefore the graph of the derivative in Cartesian coordinates fulfills
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                u
                                                )
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                (
                                                u
                                                )
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                   
                                                
                                                (
                                                u
                                                )
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                (
                                                u
                                                )
                                             
                                          
                                          ,
                                          
                                             
                                                ∂
                                                f
                                             
                                             
                                                ∂
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             r
                                             (
                                             u
                                             )
                                             )
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                u
                                                )
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                (
                                                u
                                                )
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                   
                                                
                                                (
                                                u
                                                )
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                (
                                                u
                                                )
                                             
                                          
                                          ,
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                u
                                                )
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                      +
                                                      1
                                                   
                                                
                                                (
                                                u
                                                )
                                             
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                 
                              
                            which directly leads to the representation (7) in homogeneous coordinates.  □

Assume that r is a regular mapping. Then, given an isogeometric function 
                        f
                        ∈
                        
                           
                              V
                           
                           
                              p
                              ,
                              s
                           
                        
                      corresponding to the spline space 
                        
                           
                              S
                           
                           
                              p
                              ,
                              s
                           
                        
                     , the derivative 
                        
                           
                              ∇
                           
                           
                              i
                           
                        
                        f
                        =
                        
                           
                              ∂
                              f
                           
                           
                              ∂
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           
                        
                      is again an isogeometric function. It fulfills 
                        
                           
                              ∇
                           
                           
                              i
                           
                        
                        f
                        ∈
                        
                           
                              V
                           
                           
                              
                                 
                                    p
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    ˆ
                                 
                              
                           
                        
                     , with 
                        
                           
                              p
                           
                           
                              ˆ
                           
                        
                        =
                        (
                        d
                        +
                        2
                        )
                        p
                        −
                        1
                      and 
                        
                           
                              s
                           
                           
                              ˆ
                           
                        
                        =
                        s
                        −
                        1
                     . The space 
                        
                           
                              V
                           
                           
                              
                                 
                                    p
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    ˆ
                                 
                              
                           
                        
                      is the space of isogeometric functions corresponding to 
                        
                           
                              S
                           
                           
                              
                                 
                                    p
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    ˆ
                                 
                              
                           
                        
                     . Note that 
                        
                           
                              S
                           
                           
                              p
                              ,
                              s
                           
                        
                        ⊆
                        
                           
                              S
                           
                           
                              
                                 
                                    p
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    ˆ
                                 
                              
                           
                        
                        ⊂
                        P
                      and 
                        
                           
                              V
                           
                           
                              p
                              ,
                              s
                           
                        
                        ⊆
                        
                           
                              V
                           
                           
                              
                                 
                                    p
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    ˆ
                                 
                              
                           
                        
                        ⊂
                        V
                      (see Definition 1). Here 
                        P
                      is the space of polynomials of arbitrary degree. Hence, we can directly conclude that the space 
                        V
                      of all isogeometric functions on Ω is closed under differentiation.

The bounds on the degree and smoothness are derived from the representation of Theorem 3 and are stated for generic functions on generic geometries. For certain choices of the function f or of the geometry mapping r, the degree of the derivatives may be decreased and/or the smoothness may be increased. In the following we use the representation of the partial derivatives from Theorem 3 to analyze the smoothness properties of isogeometric functions defined on singular patches. Note that the smoothness may decrease when singularities are present.

We use Theorem 3 to analyze the order of smoothness of isogeometric functions defined on patches containing singularities. In the following we assume that a homogeneous representation of a rational patch in Bernstein–Bézier form is given. Since any NURBS patch can be split into a collection of rational patches, we restrict ourselves to rational patches.

We denote with 
                        
                           
                              D
                           
                           
                              0
                           
                        
                        ⊂
                        
                           
                              B
                           
                           
                              ¯
                           
                        
                      the set of singular points of the geometry mapping r. Recall that 
                        
                           
                              B
                           
                           
                              ¯
                           
                        
                      is the closure of B. Let 
                        det
                        ⁡
                        
                           
                              ∇
                           
                           
                              u
                           
                        
                        r
                        (
                        u
                        )
                        ≥
                        0
                      for all 
                        u
                        ∈
                        
                           
                              B
                           
                           
                              ¯
                           
                        
                      and 
                        det
                        ⁡
                        
                           
                              ∇
                           
                           
                              u
                           
                        
                        r
                        (
                        u
                        )
                        =
                        0
                      if and only if 
                        u
                        ∈
                        
                           
                              D
                           
                           
                              0
                           
                        
                     . Note that the Jacobian determinant 
                        det
                        ⁡
                        
                           
                              ∇
                           
                           
                              u
                           
                        
                        r
                        (
                        u
                        )
                      is a rational function of the form
                        
                           
                              det
                              ⁡
                              
                                 
                                    ∇
                                 
                                 
                                    u
                                 
                              
                              r
                              (
                              u
                              )
                              =
                              
                                 
                                    (
                                    −
                                    1
                                    )
                                 
                                 
                                    d
                                    +
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          d
                                          +
                                          1
                                       
                                    
                                    (
                                    u
                                    )
                                 
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       u
                                       )
                                       )
                                    
                                    
                                       d
                                       +
                                       1
                                    
                                 
                              
                              ,
                           
                        
                      where the numerator 
                        
                           
                              
                                 
                                    g
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              d
                              +
                              1
                           
                        
                        (
                        u
                        )
                      is the function defined in (6). Recall that 
                        
                           
                              
                                 
                                    r
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              0
                           
                        
                        (
                        u
                        )
                        >
                        0
                      for all 
                        u
                        ∈
                        
                           
                              B
                           
                           
                              ¯
                           
                        
                     . Consequently, the set 
                        
                           
                              D
                           
                           
                              0
                           
                        
                      is the zero set of the multivariate polynomial 
                        
                           
                              
                                 
                                    g
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              d
                              +
                              1
                           
                        
                        (
                        u
                        )
                     .

We exemplify two types of singular planar patches (types P1 and P2) and three types of singular volumetric patches (types V1, V2 and V3). Patches of type P1, which were already studied by Takacs and Jüttler (2013), possess collapsing control points. Patches of type P2 have singularities caused by parallel tangents at a corner of the parameter domain. The trivariate patches of type V1 represent four-sided pyramids by collapsing the control points of one of the faces. The patches of type V2 describe tetrahedral patches by collapsing two faces to a point and to a curve, respectively. The patch described by type V3 contains a different kind of singularity. In this case the singularity is caused by two edges being collinear in the physical domain. The boundary of the patch consists of five quadrilateral faces and one degenerate triangular face.

We will derive 
                        
                           
                              C
                           
                           
                              1
                           
                        
                        (
                        
                           
                              Ω
                           
                           
                              ¯
                           
                        
                        )
                      and 
                        
                           
                              C
                           
                           
                              2
                           
                        
                        (
                        
                           
                              Ω
                           
                           
                              ¯
                           
                        
                        )
                      smoothness conditions for isogeometric functions defined on these model patches. Note that we consider a non-standard notion of 
                        
                           
                              C
                           
                           
                              k
                           
                        
                        (
                        
                           
                              Ω
                           
                           
                              ¯
                           
                        
                        )
                      smoothness on the closed domain 
                        
                           
                              Ω
                           
                           
                              ¯
                           
                        
                      which is defined below. Usually, 
                        
                           
                              C
                           
                           
                              k
                           
                        
                      smoothness is defined on open domains.


                     
                        Definition 4
                        Let 
                              Ω
                              ⊂
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                            be an open set. We say that 
                              f
                              ∈
                              
                                 
                                    C
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    Ω
                                 
                                 
                                    ¯
                                 
                              
                              )
                            if and only if 
                              f
                              ∈
                              
                                 
                                    C
                                 
                                 
                                    k
                                 
                              
                              (
                              Ω
                              )
                            and the derivatives of f up to order k can be extended continuously to the boundary ∂Ω of the domain Ω. We call such a function f a 
                              
                                 
                                    C
                                 
                                 
                                    k
                                 
                              
                            
                           smooth function. Here the space 
                              
                                 
                                    C
                                 
                                 
                                    k
                                 
                              
                              (
                              Ω
                              )
                            consists of all functions that satisfy the standard definition of 
                              
                                 
                                    C
                                 
                                 
                                    k
                                 
                              
                            smoothness on an open domain Ω.

All presented types of patches are (rational) Bézier patches, which can be seen as restrictions of NURBS patches to one of its elements (knot spans). Since the boundary of the Bézier element may be in the interior of the full NURBS patch, the smoothness of the functions at the boundary of the Bézier element is also of interest, and this is reflected by the definition. In addition, the functions covered by the definition possess certain regularity properties which may be required in isogeometric analysis, e.g., in order to guarantee the existence of the integrals needed to derive the discretization.

The approach to derive the smoothness conditions for isogeometric functions on a singular patch consists of two major steps. First we compute the derivatives up to the desired order, second we derive 
                        
                           
                              C
                           
                           
                              0
                           
                        
                      continuity conditions for the resulting singular patches.

More precisely, given an isogeometric function with arbitrary coefficients 
                        
                           
                              f
                           
                           
                              i
                           
                        
                      (as in Table 1
                     ), we compute the derivatives according to Theorem 3. Hence all derivatives are given via a hypersurface representing their graphs. These hypersurfaces are given as homogeneous patches in Bernstein–Bézier form. Each homogeneous control point of such a patch is either a basepoint, a point at infinity, or real point in Euclidean space.

The second task consists in the analysis of the continuity of such patches. First one can identify linear conditions on the coefficients 
                        
                           
                              f
                           
                           
                              i
                           
                        
                      such that no points at infinity occur, resulting in a singular hypersurface consisting of real control points and basepoints only. Depending on the type of the singularity, one may then be able to cancel out basepoints. Again there exist linear conditions on the coefficients 
                        
                           
                              f
                           
                           
                              i
                           
                        
                      that guarantee 
                        
                           
                              C
                           
                           
                              0
                           
                        
                     -continuity for the resulting singular hypersurfaces. Here we refer to Warren (1990) which deals with the properties of surfaces containing basepoints. Related results concerning toric patches are presented in Krasauskas (2002).

See Takacs and Jüttler (2013) for further details on deriving smoothness conditions for isogeometric functions on planar patches.

We exemplify this case by considering an isogeometric function 
                                 
                                    
                                       f
                                    
                                    
                                       δ
                                    
                                 
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       (
                                       2
                                       ,
                                       2
                                       )
                                    
                                 
                              , which is represented by its graph surface
                                 
                                    (8)
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             δ
                                          
                                       
                                       (
                                       u
                                       )
                                       =
                                       
                                          ∑
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             0
                                          
                                          2
                                       
                                       
                                          ∑
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             0
                                          
                                          2
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                               with the control points given in Table 1, where the basis functions 
                                 
                                    
                                       B
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                               are the tensor-product Bernstein polynomials of degree 
                                 (
                                 2
                                 ,
                                 2
                                 )
                              . The singular points form the set 
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 {
                                 (
                                 0
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ,
                                 0
                                 ≤
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ≤
                                 1
                                 }
                              .

The left part of Fig. 2
                               depicts an example of a patch of type P1. Note that the position of the inner control point with index 
                                 (
                                 1
                                 ,
                                 1
                                 )
                               depends on the value of the perturbation parameter 
                                 δ
                                 =
                                 (
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 )
                              .

Using Theorem 3, we conclude that 
                                 
                                    
                                       f
                                    
                                    
                                       δ
                                    
                                 
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                               if and only if
                                 
                                    (9)
                                    
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             0
                                             ,
                                             0
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             0
                                             ,
                                             1
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             0
                                             ,
                                             2
                                             )
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (10)
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             0
                                             ,
                                             0
                                             )
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             0
                                             )
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             0
                                             ,
                                             0
                                             )
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             2
                                             )
                                          
                                       
                                       )
                                       +
                                       2
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             1
                                             )
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             2
                                             )
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             0
                                             )
                                          
                                       
                                       =
                                       0
                                       .
                                    
                                 
                               This condition admits the (well-known) geometric interpretation that the Cartesian control points 
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       0
                                       ,
                                       0
                                       )
                                    
                                 
                              , 
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       0
                                       ,
                                       1
                                       )
                                    
                                 
                              , 
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       0
                                       ,
                                       2
                                       )
                                    
                                 
                              , 
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       1
                                       ,
                                       0
                                       )
                                    
                                 
                              , 
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       1
                                       ,
                                       1
                                       )
                                    
                                 
                               and 
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       1
                                       ,
                                       2
                                       )
                                    
                                 
                               must be coplanar to secure 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                               smoothness.

Using again Theorem 3 to compute the graph surfaces of the second partial derivatives from the first order ones, we conclude that 
                                 
                                    
                                       f
                                    
                                    
                                       δ
                                    
                                 
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                               if and only if Eqs. (9), (10) and
                                 
                                    (11)
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             0
                                             )
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             0
                                             )
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             0
                                             )
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             1
                                             )
                                          
                                       
                                       )
                                       +
                                       2
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             1
                                             )
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             2
                                             )
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             0
                                             )
                                          
                                       
                                       =
                                       0
                                    
                                 
                              
                              
                                 
                                    (12)
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             0
                                             ,
                                             0
                                             )
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             0
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             2
                                             )
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             1
                                             )
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             0
                                             ,
                                             0
                                             )
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             2
                                             )
                                          
                                       
                                       )
                                       +
                                       4
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             1
                                             )
                                          
                                       
                                       −
                                       2
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             2
                                             )
                                          
                                       
                                       −
                                       2
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             0
                                             )
                                          
                                       
                                       =
                                       0
                                    
                                 
                               are satisfied. Note that Eqs. (10), (11) and (12) are equivalent if 
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                              .

The spaces of 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               smooth isogeometric functions obtained from the biquadratic parametrization have generally the dimensions 6 and 4, respectively. If 
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                              , however, then both spaces possess the dimension 6. In fact, in this case the space consists of all quadratic polynomials on the physical domain.

Here we consider an isogeometric function 
                                 
                                    
                                       f
                                    
                                    
                                       δ
                                    
                                 
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       (
                                       2
                                       ,
                                       2
                                       )
                                    
                                 
                               represented in the form (8) with the control points given in Table 1. The set 
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                               of singularities contains only one point, 
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 {
                                 (
                                 0
                                 ,
                                 0
                                 )
                                 }
                              . The right part of Fig. 2 depicts a patch of type P2. Again, the inner control point depends on δ. Similar to type P1 we conclude that 
                                 
                                    
                                       f
                                    
                                    
                                       δ
                                    
                                 
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                               if and only if
                                 
                                    (13)
                                    
                                       
                                          2
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                0
                                                ,
                                                0
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                0
                                                ,
                                                1
                                                )
                                             
                                          
                                          +
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                1
                                                ,
                                                0
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                2
                                                ,
                                                0
                                                )
                                             
                                          
                                          −
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                0
                                                ,
                                                2
                                                )
                                             
                                          
                                          =
                                          2
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                1
                                                ,
                                                0
                                                )
                                             
                                          
                                          −
                                          2
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                0
                                                ,
                                                1
                                                )
                                             
                                          
                                          .
                                       
                                    
                                 
                               Moreover, 
                                 
                                    
                                       f
                                    
                                    
                                       δ
                                    
                                 
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                               if and only if (13) and
                                 
                                    (14)
                                    
                                       4
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             0
                                             ,
                                             0
                                             )
                                          
                                       
                                       +
                                       (
                                       4
                                       +
                                       2
                                       
                                          
                                             δ
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       2
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             0
                                             ,
                                             1
                                             )
                                          
                                       
                                       −
                                       2
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             0
                                             ,
                                             2
                                             )
                                          
                                       
                                       =
                                       4
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             1
                                             )
                                          
                                       
                                       −
                                       (
                                       1
                                       −
                                       
                                          
                                             δ
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             1
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             2
                                             )
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    (15)
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             0
                                             ,
                                             2
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             0
                                             )
                                          
                                       
                                       )
                                       (
                                       
                                          
                                             δ
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       =
                                       (
                                       4
                                       
                                          
                                             δ
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       6
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             0
                                             ,
                                             1
                                             )
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             δ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             0
                                             )
                                          
                                       
                                       +
                                       (
                                       
                                          
                                             δ
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             2
                                             )
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             1
                                             )
                                          
                                       
                                       )
                                    
                                 
                               are satisfied. If 
                                 (
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 (
                                 0
                                 ,
                                 0
                                 )
                               then Eq. (15) can be omitted since both sides vanish.

The spaces of 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               smooth isogeometric functions obtained from the biquadratic parametrization have generally the dimensions 7 and 5, respectively. If 
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                              , however, then the latter space has dimension 6.

We consider an isogeometric function 
                                 
                                    
                                       f
                                    
                                    
                                       δ
                                    
                                 
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       (
                                       2
                                       ,
                                       2
                                       ,
                                       2
                                       )
                                    
                                 
                               represented by
                                 
                                    (16)
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             δ
                                          
                                       
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       )
                                       =
                                       
                                          ∑
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             0
                                          
                                          2
                                       
                                       
                                          ∑
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             0
                                          
                                          2
                                       
                                       
                                          ∑
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   3
                                                
                                             
                                             =
                                             0
                                          
                                          2
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                 
                               with tensor-product Bernstein polynomials 
                                 
                                    
                                       B
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                               of degree 
                                 (
                                 2
                                 ,
                                 2
                                 ,
                                 2
                                 )
                               and control points
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             1
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                2
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                2
                                             
                                             ,
                                             
                                                
                                                   f
                                                
                                                
                                                   (
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       
                                       for 
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             3
                                          
                                       
                                       )
                                       ≠
                                       (
                                       1
                                       ,
                                       1
                                       ,
                                       1
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             (
                                             1
                                             ,
                                             1
                                             ,
                                             1
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             1
                                             ,
                                             1
                                             +
                                             
                                                
                                                   δ
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                1
                                                2
                                             
                                             +
                                             
                                                
                                                   δ
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                1
                                                2
                                             
                                             +
                                             
                                                
                                                   δ
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   f
                                                
                                                
                                                   (
                                                   1
                                                   ,
                                                   1
                                                   ,
                                                   1
                                                   )
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       
                                       otherwise, 
                                    
                                 
                               as depicted in Fig. 3
                              . Note that the inner control point depends on δ. The set of singular points is 
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 {
                                 (
                                 0
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 ,
                                 0
                                 ≤
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 ≤
                                 1
                                 }
                              .

One can show that 
                                 
                                    
                                       f
                                    
                                    
                                       δ
                                    
                                 
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                               if and only if the coefficients of the isogeometric function satisfy
                                 
                                    (17)
                                    
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             0
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             0
                                             ,
                                             0
                                             ,
                                             0
                                             )
                                          
                                       
                                       
                                       for all 
                                       0
                                       ≤
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             3
                                          
                                       
                                       ≤
                                       2
                                    
                                 
                               and six additional linearly independent equations. We do not write down the equations explicitly, since this would not give any further insight. Eq. (17) leaves one degree of freedom for the coefficients with index 
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 0
                              . The six additional equations restrict the coefficients with 
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 1
                              . The remaining coefficients remain unrestricted. Summing up, the dimension of the space of 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                               smooth functions is equal to 
                                 1
                                 +
                                 3
                                 +
                                 9
                                 =
                                 13
                              .

Similarly we can characterize 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                               smoothness by (17) and 12 further equations. Generally, the space of 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               smooth functions has dimension 7. If 
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 0
                              , the dimension raises to 10. In this case, the space of 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               smooth isogeometric functions is described by Eqs. (17), as well as
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             0
                                             ,
                                             1
                                             )
                                          
                                       
                                       =
                                       
                                          1
                                          2
                                       
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             0
                                             ,
                                             0
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             0
                                             ,
                                             2
                                             )
                                          
                                       
                                       )
                                       
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             2
                                             ,
                                             1
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             2
                                             ,
                                             0
                                             )
                                          
                                       
                                       +
                                       
                                          1
                                          2
                                       
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             0
                                             ,
                                             2
                                             )
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             0
                                             ,
                                             0
                                             )
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             1
                                             ,
                                             0
                                             )
                                          
                                       
                                       =
                                       
                                          1
                                          2
                                       
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             0
                                             ,
                                             0
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             2
                                             ,
                                             0
                                             )
                                          
                                       
                                       )
                                       
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             1
                                             ,
                                             2
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             0
                                             ,
                                             2
                                             )
                                          
                                       
                                       +
                                       
                                          1
                                          2
                                       
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             2
                                             ,
                                             0
                                             )
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             0
                                             ,
                                             0
                                             )
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             1
                                             ,
                                             1
                                             )
                                          
                                       
                                       =
                                       
                                          1
                                          2
                                       
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             0
                                             ,
                                             2
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             2
                                             ,
                                             0
                                             )
                                          
                                       
                                       )
                                       
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             2
                                             ,
                                             2
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             0
                                             ,
                                             2
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             2
                                             ,
                                             0
                                             )
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             1
                                             ,
                                             0
                                             ,
                                             0
                                             )
                                          
                                       
                                    
                                 
                               and
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             1
                                             ,
                                             2
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             0
                                             ,
                                             0
                                             )
                                          
                                       
                                       −
                                       2
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             0
                                             ,
                                             1
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             0
                                             ,
                                             2
                                             )
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             1
                                             ,
                                             0
                                             )
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             1
                                             ,
                                             1
                                             )
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             2
                                             ,
                                             1
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             0
                                             ,
                                             0
                                             )
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             0
                                             ,
                                             1
                                             )
                                          
                                       
                                       −
                                       2
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             1
                                             ,
                                             0
                                             )
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             1
                                             ,
                                             1
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             2
                                             ,
                                             0
                                             )
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             2
                                             ,
                                             2
                                             )
                                          
                                       
                                       =
                                       3
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             0
                                             ,
                                             0
                                             )
                                          
                                       
                                       −
                                       4
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             0
                                             ,
                                             1
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             0
                                             ,
                                             2
                                             )
                                          
                                       
                                       −
                                       4
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             1
                                             ,
                                             0
                                             )
                                          
                                       
                                       +
                                       4
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             1
                                             ,
                                             1
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             2
                                             ,
                                             2
                                             ,
                                             0
                                             )
                                          
                                       
                                       .
                                    
                                 
                               This space is equal to the space of quadratic polynomials on the physical domain. If a perturbation is present, however, this is no longer true and the approximation power is reduced.

We consider an isogeometric function 
                                 
                                    
                                       f
                                    
                                    
                                       δ
                                    
                                 
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       (
                                       2
                                       ,
                                       2
                                       ,
                                       2
                                       )
                                    
                                 
                               represented in the form (16) with control points
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             1
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                2
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                4
                                             
                                             ,
                                             
                                                
                                                   f
                                                
                                                
                                                   (
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       
                                       for 
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             3
                                          
                                       
                                       )
                                       ≠
                                       (
                                       1
                                       ,
                                       1
                                       ,
                                       1
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             (
                                             1
                                             ,
                                             1
                                             ,
                                             1
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             1
                                             ,
                                             1
                                             +
                                             
                                                
                                                   δ
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                1
                                                2
                                             
                                             +
                                             
                                                
                                                   δ
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                1
                                                4
                                             
                                             +
                                             
                                                
                                                   δ
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   f
                                                
                                                
                                                   (
                                                   1
                                                   ,
                                                   1
                                                   ,
                                                   1
                                                   )
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       
                                       otherwise
                                       ,
                                    
                                 
                               as shown in Fig. 4
                              . The patch is singular for all points in the set 
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 {
                                 (
                                 0
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 ,
                                 0
                                 ≤
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 ≤
                                 1
                                 }
                                 ∪
                                 {
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 0
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 ,
                                 0
                                 ≤
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 ≤
                                 1
                                 }
                              . Again, the inner control point 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       (
                                       1
                                       ,
                                       1
                                       ,
                                       1
                                       )
                                    
                                 
                               depends on 
                                 δ
                                 =
                                 (
                                 
                                    
                                       δ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       3
                                    
                                 
                                 )
                              .

The conditions for 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                               smoothness lead to 17 independent equations, leading to a space of dimension 10. If no perturbation is applied, then this space is equal to the space of 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               smooth functions (which is equal to the space of all quadratic polynomials on the tetrahedron in this case). Generally, however, the space of 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               smooth functions has dimension 7 only.

This example covers a different class of singularities. The top face of the object is equivalent to the triangular patch P2. All other faces are non-degenerate quadrilaterals. We consider an isogeometric function 
                                 
                                    
                                       f
                                    
                                    
                                       δ
                                    
                                 
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       (
                                       2
                                       ,
                                       2
                                       ,
                                       2
                                       )
                                    
                                 
                               represented in the form (16) with control points
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             0
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             1
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             0
                                             ,
                                             
                                                
                                                   f
                                                
                                                
                                                   (
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   0
                                                   )
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       
                                       for 
                                       0
                                       ≤
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ≤
                                       2
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             0
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             1
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             0
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   f
                                                
                                                
                                                   (
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   0
                                                   )
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       
                                       for 
                                       0
                                       ≤
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             3
                                          
                                       
                                       ≤
                                       2
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             (
                                             0
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             1
                                             ,
                                             0
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   f
                                                
                                                
                                                   (
                                                   0
                                                   ,
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       
                                       for 
                                       0
                                       ≤
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             3
                                          
                                       
                                       ≤
                                       2
                                    
                                 
                               and
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             (
                                             1
                                             ,
                                             1
                                             ,
                                             1
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             1
                                             ,
                                             
                                                7
                                                8
                                             
                                             +
                                             
                                                
                                                   δ
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                7
                                                8
                                             
                                             +
                                             
                                                
                                                   δ
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             1
                                             +
                                             
                                                
                                                   δ
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   f
                                                
                                                
                                                   (
                                                   1
                                                   ,
                                                   1
                                                   ,
                                                   1
                                                   )
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             (
                                             1
                                             ,
                                             1
                                             ,
                                             2
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             1
                                             ,
                                             
                                                3
                                                4
                                             
                                             ,
                                             
                                                3
                                                4
                                             
                                             ,
                                             2
                                             ,
                                             
                                                
                                                   f
                                                
                                                
                                                   (
                                                   1
                                                   ,
                                                   1
                                                   ,
                                                   2
                                                   )
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             (
                                             1
                                             ,
                                             2
                                             ,
                                             1
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             1
                                             ,
                                             
                                                3
                                                4
                                             
                                             ,
                                             
                                                7
                                                4
                                             
                                             ,
                                             1
                                             ,
                                             
                                                
                                                   f
                                                
                                                
                                                   (
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   1
                                                   )
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             (
                                             1
                                             ,
                                             2
                                             ,
                                             2
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             1
                                             ,
                                             
                                                1
                                                2
                                             
                                             ,
                                             
                                                3
                                                2
                                             
                                             ,
                                             2
                                             ,
                                             
                                                
                                                   f
                                                
                                                
                                                   (
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   2
                                                   )
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             (
                                             2
                                             ,
                                             1
                                             ,
                                             1
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             1
                                             ,
                                             
                                                7
                                                4
                                             
                                             ,
                                             
                                                3
                                                4
                                             
                                             ,
                                             1
                                             ,
                                             
                                                
                                                   f
                                                
                                                
                                                   (
                                                   2
                                                   ,
                                                   1
                                                   ,
                                                   1
                                                   )
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             (
                                             2
                                             ,
                                             1
                                             ,
                                             2
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             1
                                             ,
                                             
                                                3
                                                2
                                             
                                             ,
                                             
                                                1
                                                2
                                             
                                             ,
                                             2
                                             ,
                                             
                                                
                                                   f
                                                
                                                
                                                   (
                                                   2
                                                   ,
                                                   1
                                                   ,
                                                   2
                                                   )
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             (
                                             2
                                             ,
                                             2
                                             ,
                                             1
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             1
                                             ,
                                             
                                                3
                                                2
                                             
                                             ,
                                             
                                                3
                                                2
                                             
                                             ,
                                             1
                                             ,
                                             
                                                
                                                   f
                                                
                                                
                                                   (
                                                   2
                                                   ,
                                                   2
                                                   ,
                                                   1
                                                   )
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             (
                                             2
                                             ,
                                             2
                                             ,
                                             2
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             1
                                             ,
                                             1
                                             ,
                                             1
                                             ,
                                             2
                                             ,
                                             
                                                
                                                   f
                                                
                                                
                                                   (
                                                   2
                                                   ,
                                                   2
                                                   ,
                                                   2
                                                   )
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                               as shown in Fig. 5
                              . There is exactly one singular point, 
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 {
                                 (
                                 1
                                 ,
                                 1
                                 ,
                                 1
                                 )
                                 }
                              , which corresponds to the control point with index 
                                 (
                                 2
                                 ,
                                 2
                                 ,
                                 2
                                 )
                              . In the unperturbed case, the parametrization of the domain (i.e., the control points without the last coordinate, which corresponds to the isogeometric function) have been constructed by applying degree elevation to a tri-linear patch. The 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                               smoothness of 
                                 
                                    
                                       f
                                    
                                    
                                       δ
                                    
                                 
                               is characterized by four linearly independent equations, leaving a space of dimension 23. The space of 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               smooth isogeometric functions has dimension 18. The basis functions with indices 
                                 (
                                 0
                                 ,
                                 0
                                 ,
                                 0
                                 )
                              , 
                                 (
                                 1
                                 ,
                                 0
                                 ,
                                 0
                                 )
                              , 
                                 (
                                 0
                                 ,
                                 1
                                 ,
                                 0
                                 )
                               and 
                                 (
                                 0
                                 ,
                                 0
                                 ,
                                 1
                                 )
                               are not involved in the nine equations. In this example the dimension of the space of 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               smooth isogeometric functions is not reduced if the inner control point is perturbed. This, however, is not true when the perturbation is applied to control points different from 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       (
                                       1
                                       ,
                                       1
                                       ,
                                       1
                                       )
                                    
                                 
                              .

In all but the last of the presented examples, the dimension of the 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               smooth subspace of the isogeometric function space depends on the location of the “free” inner control point. Using perturbations of other control points lead to similar results.

Hence, the smoothness properties are very sensitive with respect to the choice of the parametrization. This should be taken into account when dealing with applications that need very smooth functions, since using 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               smooth isogeometric functions will often be too restrictive. In the vicinity of the singularity, the space spanned by these functions does not provide a representation of low-degree polynomials in the physical space (see especially types P1, V1, V2). This indicates the reduction of approximation power.

In concrete applications, one should try to find a parametrization that leads to a high-dimensional space. We observed that parametrizations obtained by degree elevation of (bi-/tri-)linear ones are quite useful.

We extend the result of Section 3 to functions on n-manifolds embedded into 
                        
                           
                              R
                           
                           
                              d
                           
                        
                     , where 
                        n
                        <
                        d
                     . More precisely, we derive a representation of the intrinsic gradient of an isogeometric function 
                        f
                        ∈
                        V
                     .

We consider an n-dimensional patch 
                        r
                        (
                        u
                        )
                      with homogeneous representation
                        
                           
                              
                                 
                                    r
                                 
                                 
                                    ˜
                                 
                              
                              (
                              u
                              )
                              =
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    u
                                    )
                                    ,
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    u
                                    )
                                    ,
                                    …
                                    ,
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          d
                                       
                                    
                                    (
                                    u
                                    )
                                    )
                                 
                                 
                                    T
                                 
                              
                           
                        
                      embedded into 
                        
                           
                              R
                           
                           
                              d
                           
                        
                     , with 
                        n
                        <
                        d
                     , and an isogeometric function f defined on r. Let 
                        
                           
                              x
                           
                           
                              0
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              d
                           
                        
                      be a point on the patch r. Let F be an extension of f to an open neighborhood 
                        
                           
                              N
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                           
                        
                        ⊂
                        
                           
                              R
                           
                           
                              d
                           
                        
                      of 
                        
                           
                              x
                           
                           
                              0
                           
                        
                     . The intrinsic gradient 
                     
                        
                           
                              ∇
                           
                           
                              r
                           
                        
                        f
                      of f is
                        
                           
                              
                                 
                                    ∇
                                 
                                 
                                    r
                                 
                              
                              f
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              
                                 
                                    Π
                                 
                                 
                                    r
                                 
                              
                              
                                 (
                                 
                                    
                                       ∇
                                    
                                    
                                       x
                                    
                                 
                                 F
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 )
                              
                              ,
                           
                        
                      where 
                        
                           
                              ∇
                           
                           
                              x
                           
                        
                        F
                      is the gradient of F with respect to x in 
                        
                           
                              N
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                           
                        
                      and the operator 
                        
                           
                              Π
                           
                           
                              r
                           
                        
                      projects a vector orthogonally into the tangent space of the patch r at 
                        
                           
                              x
                           
                           
                              0
                           
                        
                      (see e.g. Šír et al., 2008). When considering a surface in the three-dimensional space (i.e. 
                        n
                        =
                        2
                     , 
                        d
                        =
                        3
                     ), this projection takes the form
                        
                           
                              
                                 
                                    Π
                                 
                                 
                                    r
                                 
                              
                              (
                              
                                 
                                    ∇
                                 
                                 
                                    x
                                 
                              
                              F
                              )
                              =
                              
                                 
                                    ∇
                                 
                                 
                                    x
                                 
                              
                              F
                              −
                              
                                 (
                                 
                                    
                                       (
                                       
                                          
                                             ∇
                                          
                                          
                                             x
                                          
                                       
                                       F
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 n
                                 )
                              
                              n
                              ,
                           
                        
                      where n is the unit normal vector of r in 
                        
                           
                              x
                           
                           
                              0
                           
                        
                     .

The projection of the gradient onto the tangent space does not depend on the extension F of the function f into the embedding space, but it is fully determined by values of F on the patch (i.e. 
                        
                           
                              ∇
                           
                           
                              r
                           
                        
                        f
                      only depends on f). The intrinsic gradient is therefore well-defined.

We choose a particular extension F of f that allows to obtain the intrinsic gradient without the projection. The n-dimensional patch 
                        
                           
                              r
                           
                           
                              ˜
                           
                        
                        (
                        u
                        )
                     , with 
                        u
                        ∈
                        
                           
                              R
                           
                           
                              n
                           
                        
                     , is extended to a d-dimensional patch in 
                        
                           
                              R
                           
                           
                              d
                           
                        
                     . Consider a basis 
                        
                           
                              n
                           
                           
                              n
                              +
                              1
                           
                        
                        (
                        u
                        )
                        ,
                        …
                        ,
                        
                           
                              n
                           
                           
                              d
                           
                        
                        (
                        u
                        )
                      of the normal space at u, i.e. 
                        
                           
                              (
                              
                                 
                                    ∂
                                 
                                 
                                    j
                                 
                              
                              r
                              )
                           
                           
                              T
                           
                        
                        
                           
                              n
                           
                           
                              k
                           
                        
                        =
                        0
                      for all 
                        j
                        =
                        1
                        ,
                        …
                        ,
                        n
                      and 
                        k
                        =
                        n
                        +
                        1
                        ,
                        …
                        ,
                        d
                     , where r is the representation of 
                        
                           
                              r
                           
                           
                              ˜
                           
                        
                      in Cartesian coordinates. Moreover let 
                        N
                        =
                        (
                        
                           
                              n
                           
                           
                              n
                              +
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              n
                           
                           
                              d
                           
                        
                        )
                     . We denote by
                        
                           
                              F
                              
                                 (
                                 u
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       +
                                    
                                 
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          r
                                          (
                                          u
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          (
                                          u
                                          )
                                       
                                    
                                 
                                 )
                              
                              +
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                +
                                             
                                          
                                          N
                                          (
                                          u
                                          )
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                 
                                 )
                              
                           
                        
                      the extended graph of f, with the row vector 
                        
                           
                              u
                           
                           
                              +
                           
                        
                        =
                        (
                        
                           
                              u
                           
                           
                              n
                              +
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              u
                           
                           
                              d
                           
                        
                        )
                      and
                        
                           
                              
                                 
                                    u
                                 
                                 
                                    +
                                 
                              
                              N
                              (
                              u
                              )
                              =
                              
                                 ∑
                                 
                                    j
                                    =
                                    n
                                    +
                                    1
                                 
                                 d
                              
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                              
                              
                                 
                                    n
                                 
                                 
                                    j
                                 
                              
                              (
                              u
                              )
                              .
                           
                        
                      There are several possibilities to obtain a basis of the normal space. In the case 
                        d
                        =
                        3
                      and 
                        n
                        =
                        2
                     , the normal space is spanned simply by the normal vector 
                        
                           
                              ∂
                           
                           
                              1
                           
                        
                        r
                        ×
                        
                           
                              ∂
                           
                           
                              2
                           
                        
                        r
                     . For other values of d and n, however, the choice of the directions of the normal vectors is not unique. We outline an approach to generate the homogeneous representation of the normal space directly.

In order to generate a set 
                        
                           
                              N
                           
                           
                              ˜
                           
                        
                      of normal vectors 
                        
                           
                              
                                 
                                    n
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              k
                           
                        
                     , 
                        n
                        +
                        1
                        ≤
                        k
                        ≤
                        d
                     , of low degree, we consider the hyperplanes
                        
                           
                              
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       ˜
                                    
                                 
                                 :
                                 det
                                 ⁡
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       ˜
                                    
                                 
                                 ,
                                 
                                    
                                       ∂
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       ˜
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       ∂
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       ˜
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       d
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       ˜
                                    
                                 
                                 )
                                 =
                                 0
                                 }
                              
                           
                        
                      which are spanned by 
                        
                           
                              r
                           
                           
                              ˜
                           
                        
                     , by the n partial derivatives of 
                        
                           
                              r
                           
                           
                              ˜
                           
                        
                      and by 
                        d
                        −
                        n
                        −
                        1
                      arbitrarily chosen auxiliary points 
                        
                           
                              
                                 
                                    q
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              n
                              +
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              
                                 
                                    q
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              d
                              −
                              1
                           
                        
                     . The coordinates of their normal vectors are the coefficients of 
                        
                           
                              
                                 
                                    x
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              
                                 
                                    x
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              n
                           
                        
                      in the expansion of the determinant. These hyperplanes contain the tangent space of the patch 
                        
                           
                              r
                           
                           
                              ˜
                           
                        
                     . Hence their normal vectors are possible choices for the vectors 
                        
                           
                              
                                 
                                    n
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              k
                           
                        
                     , with 
                        n
                        +
                        1
                        ≤
                        k
                        ≤
                        d
                     . Applying this construction for 
                        (
                        d
                        −
                        n
                        )
                      sets of auxiliary points in general position leads to a set of 
                        (
                        d
                        −
                        n
                        )
                      linearly independent normal vectors of degree 
                        
                           
                              p
                           
                           
                              n
                           
                        
                        ≤
                        (
                        n
                        +
                        1
                        )
                        p
                        −
                        1
                     .

Rewriting the representation of the graph of the extended function F in homogeneous coordinates gives
                        
                           (18)
                           
                              
                                 
                                    F
                                 
                                 
                                    ˜
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       +
                                    
                                 
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          u
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          (
                                          u
                                          )
                                       
                                    
                                 
                                 )
                              
                              +
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                +
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          u
                                          )
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                 
                                 )
                              
                              ,
                           
                        
                      where 
                        
                           
                              N
                           
                           
                              ˜
                           
                        
                        =
                        (
                        
                           
                              
                                 
                                    n
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              n
                              +
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              
                                 
                                    n
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              d
                           
                        
                        )
                     . The entries 
                        
                           
                              
                                 
                                    n
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              j
                           
                           
                              k
                           
                        
                      of the vectors 
                        
                           
                              
                                 
                                    n
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              k
                           
                        
                      are chosen as 
                        
                           
                              
                                 
                                    n
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              j
                           
                           
                              k
                           
                        
                        =
                        
                           
                              n
                           
                           
                              j
                           
                           
                              k
                           
                        
                      and 
                        
                           
                              
                                 
                                    n
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              0
                           
                           
                              k
                           
                        
                        =
                        0
                      for all 
                        n
                        +
                        1
                        ≤
                        k
                        ≤
                        d
                      and 
                        1
                        ≤
                        j
                        ≤
                        d
                     . The graph of the isogeometric function defined on the patch 
                        
                           
                              r
                           
                           
                              ˜
                           
                        
                      is represented by 
                        
                           
                              F
                           
                           
                              ˜
                           
                        
                        (
                        u
                        ,
                        0
                        )
                        =
                        
                           
                              (
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              (
                              u
                              )
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    d
                                    +
                                    1
                                 
                              
                              (
                              u
                              )
                              )
                           
                           
                              T
                           
                        
                        =
                        
                           
                              f
                           
                           
                              ˜
                           
                        
                        (
                        u
                        )
                     . We denote with 
                        
                           
                              
                                 
                                    e
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              j
                           
                        
                      the unit vector that spans the j-th coordinate axis in 
                        
                           
                              R
                           
                           
                              d
                              +
                              1
                           
                        
                     .


                     
                        Theorem 5
                        
                           The graph of the i-th component 
                           
                              
                                 
                                    ∇
                                 
                                 
                                    r
                                    ,
                                    i
                                 
                              
                              f
                            
                           of the intrinsic gradient is represented by the parametric surface
                           
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          ˜
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          ,
                                          −
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                 
                              
                            
                           where
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    det
                                    ⁡
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             f
                                          
                                          
                                             ˜
                                          
                                       
                                       ,
                                       
                                          
                                             ∂
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             ˜
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             ∂
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             ˜
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             d
                                          
                                       
                                       )
                                    
                                    
                                    
                                       with
                                    
                                    
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        


                     
                        Proof
                        Applying Theorem 3 to the extended graph 
                              
                                 
                                    F
                                 
                                 
                                    ˜
                                 
                              
                            gives
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          F
                                       
                                       
                                          ˜
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          ,
                                          −
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                 
                              
                            with
                              
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    det
                                    ⁡
                                    (
                                    
                                       
                                          
                                             
                                                e
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          ˜
                                       
                                    
                                    ,
                                    
                                       
                                          ∂
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          F
                                       
                                       
                                          ˜
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          ∂
                                       
                                       
                                          d
                                       
                                    
                                    
                                       
                                          F
                                       
                                       
                                          ˜
                                       
                                    
                                    )
                                    .
                                 
                              
                            The hypersurface 
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    F
                                 
                                 
                                    ˜
                                 
                              
                            represents the i-th component of the gradient 
                              
                                 
                                    ∇
                                 
                                 
                                    x
                                 
                              
                              F
                           . Restricting the gradient 
                              
                                 
                                    ∇
                                 
                                 
                                    x
                                 
                              
                              F
                            to the patch r is equivalent to restricting the parameter value to 
                              (
                              u
                              ,
                              
                                 
                                    u
                                 
                                 
                                    +
                                 
                              
                              )
                              =
                              (
                              u
                              ,
                              0
                              )
                           . Hence,
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          F
                                       
                                       
                                          ˜
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          {
                                          
                                             
                                                u
                                             
                                             
                                                +
                                             
                                          
                                          =
                                          0
                                          }
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          ,
                                          −
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                 
                              
                            with
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          {
                                          
                                             
                                                u
                                             
                                             
                                                +
                                             
                                          
                                          =
                                          0
                                          }
                                       
                                    
                                    =
                                    det
                                    ⁡
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             f
                                          
                                          
                                             ˜
                                          
                                       
                                       ,
                                       
                                          
                                             ∂
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             ˜
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             ∂
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             ˜
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             d
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                            The gradient 
                              
                                 
                                    ∇
                                 
                                 
                                    x
                                 
                              
                              F
                            can be decomposed as
                              
                                 
                                    
                                       
                                          ∇
                                       
                                       
                                          x
                                       
                                    
                                    F
                                    =
                                    
                                       
                                          Π
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    
                                       
                                          ∇
                                       
                                       
                                          x
                                       
                                    
                                    F
                                    )
                                    +
                                    
                                       
                                          Π
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    
                                       
                                          ∇
                                       
                                       
                                          x
                                       
                                    
                                    F
                                    )
                                    ,
                                 
                              
                            where 
                              
                                 
                                    Π
                                 
                                 
                                    r
                                 
                              
                            and 
                              
                                 
                                    Π
                                 
                                 
                                    n
                                 
                              
                            are the orthogonal projections into the tangent space and into the normal space, respectively. The extended function F is constant in any normal direction. Hence, the normal component 
                              
                                 
                                    Π
                                 
                                 
                                    n
                                 
                              
                              (
                              
                                 
                                    ∇
                                 
                                 
                                    x
                                 
                              
                              F
                              )
                            vanishes and
                              
                                 
                                    
                                       
                                          ∇
                                       
                                       
                                          x
                                       
                                    
                                    F
                                    =
                                    
                                       
                                          Π
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    
                                       
                                          ∇
                                       
                                       
                                          x
                                       
                                    
                                    F
                                    )
                                    =
                                    
                                       
                                          ∇
                                       
                                       
                                          r
                                       
                                    
                                    f
                                    ,
                                 
                              
                            which concludes the proof.  □

Consider an isogeometric function 
                        f
                        ∈
                        
                           
                              V
                           
                           
                              p
                              ,
                              s
                           
                        
                     . If the homogeneous normal vectors 
                        
                           
                              
                                 
                                    n
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              j
                           
                        
                      can be represented as polynomials of degree 
                        
                           
                              p
                           
                           
                              n
                           
                        
                     , then the degree of the derivative patches is bounded by 
                        (
                        d
                        −
                        n
                        )
                        
                           
                              p
                           
                           
                              n
                           
                        
                        +
                        (
                        n
                        +
                        2
                        )
                        p
                        −
                        1
                     .

Higher order derivatives of f can be computed recursively. The Hessian of f, as a tensor in 
                        
                           
                              R
                           
                           
                              d
                              ×
                              d
                           
                        
                      can be computed by applying the gradient operator 
                        
                           
                              ∇
                           
                           
                              r
                           
                        
                      again to each component of 
                        
                           
                              ∇
                           
                           
                              r
                           
                        
                        f
                     .

When considering a surface in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                     , the normal space in u is spanned by the normal vector 
                        n
                        (
                        u
                        )
                        =
                        
                           
                              ∂
                           
                           
                              1
                           
                        
                        r
                        (
                        u
                        )
                        ×
                        
                           
                              ∂
                           
                           
                              2
                           
                        
                        r
                        (
                        u
                        )
                     . In homogeneous coordinates this leads to
                        
                           
                              
                                 
                                    m
                                 
                                 
                                    ˜
                                 
                              
                              =
                              −
                              
                                 (
                                 
                                    
                                       
                                          0
                                       
                                    
                                    
                                       
                                          det
                                          ⁡
                                          (
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                ˜
                                             
                                          
                                          ,
                                          
                                             
                                                ∂
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                ˜
                                             
                                          
                                          ,
                                          
                                             
                                                ∂
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          det
                                          ⁡
                                          (
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                ˜
                                             
                                          
                                          ,
                                          
                                             
                                                ∂
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                ˜
                                             
                                          
                                          ,
                                          
                                             
                                                ∂
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          det
                                          ⁡
                                          (
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                ˜
                                             
                                          
                                          ,
                                          
                                             
                                                ∂
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                ˜
                                             
                                          
                                          ,
                                          
                                             
                                                ∂
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                 
                                 )
                              
                              .
                           
                        
                      Hence the degree of the normal vector is bounded by 
                        
                           
                              p
                           
                           
                              n
                           
                        
                        =
                        3
                        p
                        −
                        1
                     , leading to 
                        
                           
                              p
                           
                           
                              n
                           
                        
                        +
                        4
                        p
                        −
                        1
                        =
                        7
                        p
                        −
                        2
                      as a bound on the degree of the gradient patches. We analyze the smoothness of isogeometric functions on several singular surface patches which are embedded in the three-dimensional space 
                        
                           
                              R
                           
                           
                              3
                           
                        
                     .

Patches of type S1 contain a singularity caused by an edge collapsing to a point in physical space (similar to P1). Patches of type S2 possess parallel tangents at the corner points (similar to P2).

The first example from type S1 is an octant of the unit sphere (cf. Piegl and Tiller, 1995), while the second one is a polynomial approximation of the same patch.

We consider an isogeometric function f represented by its graph surface as in (8) with the control points given in Table 2
                              . Using Theorem 5, we conclude that 
                                 f
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                               if and only if
                                 
                                    (19)
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                0
                                                ,
                                                0
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                0
                                                ,
                                                1
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                0
                                                ,
                                                2
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                1
                                                ,
                                                2
                                                )
                                             
                                          
                                          −
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                1
                                                ,
                                                1
                                                )
                                             
                                          
                                          +
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                1
                                                ,
                                                0
                                                )
                                             
                                          
                                          −
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                0
                                                ,
                                                0
                                                )
                                             
                                          
                                          =
                                          0
                                          .
                                       
                                    
                                 
                               Similar to the results for type P1, Eq. (19) expresses the condition that the points 
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       0
                                       ,
                                       0
                                       )
                                    
                                 
                              , 
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       0
                                       ,
                                       1
                                       )
                                    
                                 
                              , 
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       0
                                       ,
                                       2
                                       )
                                    
                                 
                              , 
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       1
                                       ,
                                       0
                                       )
                                    
                                 
                              , 
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       1
                                       ,
                                       1
                                       )
                                    
                                 
                               and 
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       1
                                       ,
                                       2
                                       )
                                    
                                 
                               are contained in a 2-plane in 
                                 
                                    
                                       R
                                    
                                    
                                       4
                                    
                                 
                              .

When considering 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                               smoothness, we obtain a more restrictive result. We apply Theorem 5 to each component of the intrinsic gradient. The isogeometric function satisfies 
                                 f
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                               if and only if Eq. (19) and
                                 
                                    (20)
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                2
                                                ,
                                                1
                                                )
                                             
                                          
                                          −
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                1
                                                ,
                                                1
                                                )
                                             
                                          
                                          +
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                2
                                                ,
                                                0
                                                )
                                             
                                          
                                          −
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                1
                                                ,
                                                0
                                                )
                                             
                                          
                                          =
                                          0
                                       
                                    
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                2
                                                ,
                                                2
                                                )
                                             
                                          
                                          −
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                2
                                                ,
                                                0
                                                )
                                             
                                          
                                          +
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                1
                                                ,
                                                0
                                                )
                                             
                                          
                                          −
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                1
                                                ,
                                                2
                                                )
                                             
                                          
                                          =
                                          0
                                          .
                                       
                                    
                                 
                               Consequently, the space of 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               smooth isogeometric functions of this type has dimension 4.

Now we modify the previous patch by setting the denominator to 1, i.e., we omit the factors in front of the homogeneous coordinate vectors in Table 2. This gives a polynomial approximation to the octant of the sphere. Similar to the previous example, 
                                 f
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                               if and only if Eq. (19) is satisfied. The conditions
                                 
                                    (21)
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                0
                                                ,
                                                0
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                0
                                                ,
                                                1
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                0
                                                ,
                                                2
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                1
                                                ,
                                                0
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                1
                                                ,
                                                1
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                1
                                                ,
                                                2
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                2
                                                ,
                                                0
                                                )
                                             
                                          
                                          +
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                2
                                                ,
                                                1
                                                )
                                             
                                          
                                          =
                                          2
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                0
                                                ,
                                                0
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                2
                                                ,
                                                2
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                f
                                             
                                             
                                                (
                                                2
                                                ,
                                                0
                                                )
                                             
                                          
                                       
                                    
                                 
                               for 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                               smoothness, however, are now far more restrictive and leave only 2 degrees of freedom. This is due to the lack of smoothness of the surface itself at the singularity.

Finally we consider the two surface patches shown in Fig. 6
                               with the control points listed in Table 3
                              . The boundary of the first patch is a circle, and the boundary of the second one is a smooth curve.

The space of 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                               smooth isogeometric functions of the degree 
                                 (
                                 2
                                 ,
                                 2
                                 )
                               has dimension 4 for the first patch, but only 1 for the second one. Both patches admit only constant 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               smooth isogeometric functions.

For these examples, perturbations of the control points change the surfaces themselves. In the second example, the conditions do not depend on the position and the weight of the control point with index 
                                 (
                                 1
                                 ,
                                 1
                                 )
                              . Comparing the two surfaces of type S1 leads to the conclusion that even minor changes of a surface can reduce the dimension of smooth function spaces dramatically. This has to be taken into account when dealing with singular patches in isogeometric analysis, where it is crucial to have sufficient degrees of freedom locally in order to maintain sufficient approximation power.

@&#CONCLUSION@&#

We derived a closed form representation of the derivatives of an isogeometric function using homogeneous coordinates. We took advantage of the fact that the graph of an isogeometric function defined on an n-dimensional NURBS patch in 
                        
                           
                              R
                           
                           
                              d
                           
                        
                      can be interpreted as an n-dimensional patch in 
                        
                           
                              R
                           
                           
                              d
                              +
                              1
                           
                        
                     . The graphs of the partial derivatives of an isogeometric function are again given as NURBS patches, which are defined with respect to the same NURBS geometry mapping. Hence the space of isogeometric functions is closed with respect to differentiation.

We used the representation of the derivatives to obtain smoothness conditions for isogeometric functions on patches containing singularities. The method provides a systematic approach to derive smoothness conditions of arbitrary order. The presented analysis of various models indicates that the smoothness conditions depend heavily on perturbations of the geometry mapping. The results developed here are related to the 
                        
                           
                              H
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              H
                           
                           
                              2
                           
                        
                      regularity results from Takacs and Jüttler (2011, 2012).

Future work will be devoted to isogeometric vector fields. Consider a vector field that is defined on a surface r in space, i.e. 
                        n
                        =
                        2
                      and 
                        d
                        =
                        3
                     , and assume that the vector field is tangential to the surface. Hence the vector field is orthogonal to the surface normal 
                        
                           
                              n
                           
                           
                              r
                           
                        
                     . To represent such a vector field one may define a general vector-valued isogeometric function 
                        V
                        ∈
                        
                           
                              R
                           
                           
                              3
                           
                        
                      on the surface patch and enforce the orthogonality condition weakly via 
                        ‖
                        
                           
                              V
                           
                           
                              T
                           
                        
                        
                           
                              n
                           
                           
                              r
                           
                        
                        ‖
                        ≈
                        0
                     . This approach can then be used to compute a vector field fulfilling certain properties, such as interpolating given data. In that case a regularization of the vector field may be necessary. Using the approach proposed in this paper, a regularization functional based on the covariant derivatives of the vector field can be constructed. We refer to Kirisits et al. (2013), where a similar approach was employed to approximate the optical flow of an image on a moving surface.

More generally, we plan to use the results presented in this paper to formulate regularization methods based on coefficient norms for the derivatives. Since all norms on finite-dimensional spaces are equivalent, the 
                        
                           
                              H
                           
                           
                              1
                           
                        
                      or 
                        
                           
                              H
                           
                           
                              2
                           
                        
                      semi-norm on an isogeometric function space of given degree can be replaced by suitable coefficient norms obtained from the closed-form representations of the derivatives. These norms should be quite useful for regularization in the context of inverse problems, e.g., for applications in image processing on manifolds (cf. Dong, 2014).

@&#ACKNOWLEDGEMENTS@&#

This work was partially supported by the FWF via the NFN Geometry and Simulation (NFN S117).

@&#REFERENCES@&#

