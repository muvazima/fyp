@&#MAIN-TITLE@&#Robust shape optimization of continuous structures via the level set method

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Robust shape optimization considering uncertainty in loads and material is proposed.


                        
                        
                           
                           Stochastic shape derivatives of continuous structures are obtained.


                        
                        
                           
                           The existence of a solution for the robust shape optimization problem is proved.


                        
                        
                           
                           Different probability distributions and random fields are considered in experiments.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Robust structural shape optimization

Random fields

Adaptive sparse grid

Level-set method

Existence theory

@&#ABSTRACT@&#


               
               
                  This work proposes a stochastic shape optimization method for continuous structures using the level-set method. Such a method aims to minimize the expected compliance and its variance as measures of the structural robustness. The behavior of continuous structures is modeled by linear elasticity equations with uncertain loading and material. This uncertainty can be modeled using random variables with different probability distributions as well as random fields. The proper problem formulation is ensured by the proof of the existence colorrev of solution under certain geometrical constraints on the set of admissible shapes. The proposed method addresses the stochastic linear elasticity problem in its weak form obtaining the explicit expressions for the continuous shape derivatives. Some numerical examples are presented to show the effectiveness of the proposed approach.
               
            

@&#INTRODUCTION@&#

Shape structural optimization aims to obtain the optimal layout of material within the design domain by performing variations in its boundary and connectivity  [1–3]. This technique has been successfully applied to improve the design of many complex industrial problems, such as in aeronautical, aerospace and naval applications. Its relevance for real-world applications has greatly increased the interest in this research field giving rise to multitude of studies  [4,3] until today [5,6]. Most of these works assume deterministic conditions for the input data, obviating the different sources of uncertainty which may affect significantly the structural performance. These sources of uncertainty include aleatory uncertainties, e.g. manufacturing imperfections, unknown loading conditions and variations of the material properties, and epistemic uncertainties due to the lack of knowledge. Ideally, the shape structural optimization methods should consider these sources of uncertainty to ensure the robustness and reliability of the final designs.

The robust shape structural optimization methods can be broadly divided, according to the representation and treatment of uncertainties, into non-probabilistic and probabilistic approaches. The former methods  [7] do not require the statistical information about the uncertainty of the phenomenon but a qualitative notion about its magnitude. The worst-case approach  [8–10], taking the form of a min–max optimization problem, and fuzzy techniques  [11], making use of fuzzy set theory, are methods included in this category. The main drawback of these approaches is that they are often too conservative, due to overestimation of uncertainty, leading to optimal designs with poor structural performance. The latter methods make use of the stochastic characterization of the uncertainty of the phenomenon. These methods can consider the statistical moments of the structural response to perform robust design optimization. They also can take into account the probabilities of failure to perform risk-averse optimization and reliability-based design optimization  [12]. Robust design optimization aims at obtaining optimal designs less sensitive to variations in the input data  [13]. Reliability-based design optimization deals with extreme or rare events and aims to ensure a given level of reliability by means of probabilistic constraints  [14,15]. Risk-averse optimization minimizes a risk function that quantifies the expected loss related with the damages caused by catastrophic failures  [16,17]. This work deals with the robust shape structural optimization problem adopting a probabilistic approach, in which the mean and the variance of the structural performance are considered as a measure of robustness.

A key point in stochastic structural optimization is the discretization process of the physical and the stochastic domains. The most common process consists of firstly discretizing the state law of the problem with respect to the spatial (physical) variable (e.g. by using finite elements), and then incorporate uncertainty in the spatially discretized model  [18]. The mean and/or variance of the cost function, typically compliance or total strain energy, is then minimized using some optimization method, which applies to the governing Finite Element (FE) system of equations. Several works addressing the robust shape and/or topology structural optimization problem, whether using the SIMP method  [19–21] or the level-set method  [22–25], have adopted this approach. However, some examples have shown that the optima of the spatially discretized model may not converge, as the parameter of discretization tends to zero, to the optimum of the continuous counterpart  [26]. On the other hand, the process can incorporate uncertainty in the PDE-constrained optimization problem before discretizing the spatial domain. This is done adopting Stochastic Partial Differential Equations (SPDEs) with random input data for the linear system of elasticity. The use of the linear elasticity system in its weak form permits to obtain the explicit expressions for the continuous shape derivatives without being limited by the discretization method used for the physical and the stochastic domains.

Different works have addressed the robust shape and topology optimization problem using the continuous weak form of the SPDE. The shape optimization of diffusion problems with uncertainty in its input data is addressed in  [27]; in particular, the uncertainty is introduced in the force term, the diffusion coefficient and the boundary conditions. The direct and adjoint equations are solved numerically using stochastic finite element methods. For the system of elasticity, the work  [28] proposes a two-stage stochastic programming and level-set based algorithm for shape structural optimization under stochastic loading. The shape optimization problem under uncertainty is formulated as the minimization of the expected value of a functional cost. Recently, Carrasco et al.  [29] propose a continuous approach to the multi-objective robust topology optimization under uncertain loads conditions with point, surface and/or volume loads represented by dependent and independent random variables. The multi-objective problem is transformed into a single objective problem using an average approach, in which the variance of the compliance is included as a measure of robustness.

This work extends the development of  [27] to the robust shape optimization of continuous structures using the level-set method for the SPDE of linear elasticity with random input data. The proper stochastic problem formulation is guaranteed by the proof of the existence of solution under the well-known 
                        ε
                     -cone geometric condition  [30]; in particular, an existence result of the robust compliance for the linear system of elasticity with random Lamé coefficients and volume and surface loadings is proved. The robust shape optimization of continuous structures is then addressed in its weak form and explicit expressions for the continuous shape derivatives are obtained. These expressions require the resolution of the stochastic linear system of elasticity and its associated adjoint system. The stochastic collocation finite element method is then used to solve the direct and adjoint systems. The proposed development provides a general framework to consider uncertainties in loads and material properties with diverse probability distributions and random fields.

The paper is organized as follows. Section  2 is devoted to the problem statement, which includes the proper stochastic problem formulation providing the proof of an existence result under certain geometrical constraints on the set of admissible shapes. The proposed development for addressing the robust shape optimization for continuous structures using the level-set method is presented in Section  3. Section  4 is devoted to the uncertainty modeling and the stochastic collocation approach used for the numerical approximation of integrals in the random domain. Some numerical examples are presented in Section  5 to verify the effectiveness of the proposed development. Such experiments include uncertainty in loads and material properties with different probability distributions and random fields. Finally, some conclusion and concluding remarks are presented in Section  6.

Let 
                           
                              (
                              Ω
                              ,
                              F
                              ,
                              P
                              )
                           
                         be a complete probability space, and let 
                           D
                           ⊂
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                         (
                           d
                           =
                           2
                         or 3) be a bounded Lipschitz domain whose boundary 
                           ∂
                           D
                         is decomposed into the following three disjoint parts 
                           
                              
                                 ∂
                                 D
                                 =
                                 
                                    
                                       Γ
                                    
                                    
                                       D
                                    
                                 
                                 ∪
                                 
                                    
                                       Γ
                                    
                                    
                                       N
                                    
                                 
                                 ∪
                                 
                                    
                                       Γ
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                 
                                    |
                                    
                                       
                                          Γ
                                       
                                       
                                          D
                                       
                                    
                                    |
                                 
                                 >
                                 0
                                 ,
                              
                           
                         where 
                           
                              |
                              ⋅
                              |
                           
                         stands for the Lebesgue measure and 
                           
                              
                                 Γ
                              
                              
                                 D
                              
                           
                         and 
                           
                              
                                 Γ
                              
                              
                                 N
                              
                           
                         are the parts of 
                           ∂
                           D
                         where Dirichlet and Neumann boundary conditions are applied, respectively. For any symmetric matrix 
                           ζ
                        , the Hooke’s law 
                           A
                         of a linear isotropic elastic material is defined by 
                           
                              
                                 A
                                 ζ
                                 =
                                 2
                                 μ
                                 ζ
                                 +
                                 λ
                                 
                                    (
                                    
                                       Tr
                                    
                                    ζ
                                    )
                                 
                                 
                                    Id
                                 
                                 ,
                              
                           
                         where 
                           λ
                           =
                           λ
                           
                              (
                              x
                              ,
                              ω
                              )
                           
                         and 
                           μ
                           =
                           μ
                           
                              (
                              x
                              ,
                              ω
                              )
                           
                         are the Lamé moduli of the material, which are assumed to depend on both 
                           x
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    d
                                 
                              
                              )
                           
                           ∈
                           D
                         and 
                           ω
                           ∈
                           Ω
                        . Given a random displacement field 
                           u
                           =
                           u
                           
                              (
                              x
                              ,
                              ω
                              )
                           
                           =
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 ω
                                 )
                              
                              ,
                              …
                              ,
                              
                                 
                                    u
                                 
                                 
                                    d
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 ω
                                 )
                              
                              )
                           
                           ∈
                           
                              
                                 L
                              
                              
                                 P
                              
                              
                                 2
                              
                           
                           
                              (
                              Ω
                              ;
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       (
                                       D
                                       )
                                    
                                 
                                 
                                    d
                                 
                              
                              )
                           
                        , consider the linearized strain tensor 
                           
                              
                                 e
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    ∇
                                    u
                                    +
                                    
                                       (
                                       ∇
                                       
                                          
                                             u
                                          
                                          
                                             t
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                ∂
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                ∂
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       1
                                       ≤
                                       i
                                       ,
                                       j
                                       ≤
                                       d
                                    
                                 
                                 .
                              
                           
                        
                     

The following system of linear elasticity with random input data is considered 
                           
                              (1)
                              
                                 
                                    {
                                    
                                       
                                          
                                             −
                                             
                                                div
                                             
                                             
                                                (
                                                A
                                                e
                                                
                                                   (
                                                   u
                                                   
                                                      (
                                                      x
                                                      ,
                                                      ω
                                                      )
                                                   
                                                   )
                                                
                                                )
                                             
                                             =
                                             f
                                          
                                          
                                             in
                                             
                                             D
                                             ×
                                             Ω
                                             ,
                                          
                                       
                                       
                                          
                                             u
                                             
                                                (
                                                x
                                                ,
                                                ω
                                                )
                                             
                                             =
                                             0
                                          
                                          
                                             on
                                             
                                             
                                                
                                                   Γ
                                                
                                                
                                                   D
                                                
                                             
                                             ×
                                             Ω
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                (
                                                A
                                                e
                                                
                                                   (
                                                   u
                                                   
                                                      (
                                                      x
                                                      ,
                                                      ω
                                                      )
                                                   
                                                   )
                                                
                                                )
                                             
                                             ⋅
                                             n
                                             =
                                             g
                                          
                                          
                                             on
                                             
                                             
                                                
                                                   Γ
                                                
                                                
                                                   N
                                                
                                             
                                             ×
                                             Ω
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                (
                                                A
                                                e
                                                
                                                   (
                                                   u
                                                   
                                                      (
                                                      x
                                                      ,
                                                      ω
                                                      )
                                                   
                                                   )
                                                
                                                )
                                             
                                             ⋅
                                             n
                                             =
                                             0
                                          
                                          
                                             on
                                             
                                             
                                                
                                                   Γ
                                                
                                                
                                                   0
                                                
                                             
                                             ×
                                             Ω
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           n
                         is the unit outward normal vector to 
                           ∂
                           D
                        . The divergence operator (
                           
                              div
                           
                        ) involves derivatives with respect to the spatial variable 
                           x
                           ∈
                           D
                        . The following assumptions on the uncertain input parameters of the system (1) are made:


                        
                           
                              (A1)
                              
                                 
                                    λ
                                    
                                       (
                                       x
                                       ,
                                       ω
                                       )
                                    
                                    ,
                                    μ
                                    
                                       (
                                       x
                                       ,
                                       ω
                                       )
                                    
                                    ∈
                                    
                                       
                                          L
                                       
                                       
                                          P
                                       
                                       
                                          ∞
                                       
                                    
                                    
                                       (
                                       Ω
                                       ;
                                       
                                          
                                             L
                                          
                                          
                                             ∞
                                          
                                       
                                       
                                          (
                                          
                                             D
                                          
                                          )
                                       
                                       )
                                    
                                  and there exist positive constants 
                                    
                                       
                                          μ
                                       
                                       
                                          min
                                       
                                    
                                 , 
                                    
                                       
                                          μ
                                       
                                       
                                          max
                                       
                                    
                                 , 
                                    
                                       
                                          λ
                                       
                                       
                                          min
                                       
                                    
                                 , 
                                    
                                       
                                          λ
                                       
                                       
                                          max
                                       
                                    
                                  such that 
                                    
                                       
                                          0
                                          <
                                          
                                             
                                                μ
                                             
                                             
                                                min
                                             
                                          
                                          ≤
                                          μ
                                          
                                             (
                                             x
                                             ,
                                             ω
                                             )
                                          
                                          ≤
                                          
                                             
                                                μ
                                             
                                             
                                                max
                                             
                                          
                                          <
                                          ∞
                                          
                                          a.e.  
                                          x
                                          ∈
                                          D
                                          ,
                                          
                                          a.s.  
                                          ω
                                          ∈
                                          Ω
                                          ,
                                       
                                    
                                  and 
                                    
                                       
                                          0
                                          <
                                          
                                             
                                                λ
                                             
                                             
                                                min
                                             
                                          
                                          ≤
                                          2
                                          μ
                                          
                                             (
                                             x
                                             ,
                                             ω
                                             )
                                          
                                          +
                                          d
                                          λ
                                          
                                             (
                                             x
                                             ,
                                             ω
                                             )
                                          
                                          ≤
                                          
                                             
                                                λ
                                             
                                             
                                                max
                                             
                                          
                                          <
                                          ∞
                                          
                                          a.e.  
                                          x
                                          ∈
                                          D
                                          ,
                                          
                                          a.s.  
                                          ω
                                          ∈
                                          Ω
                                          ,
                                       
                                    
                                 
                              


                                 
                                    f
                                    =
                                    f
                                    
                                       (
                                       x
                                       ,
                                       ω
                                       )
                                    
                                    ∈
                                    
                                       
                                          L
                                       
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       Ω
                                       ;
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                (
                                                D
                                                )
                                             
                                          
                                          
                                             d
                                          
                                       
                                       )
                                    
                                 ,


                                 
                                    g
                                    =
                                    g
                                    
                                       (
                                       x
                                       ,
                                       ω
                                       )
                                    
                                    ∈
                                    
                                       
                                          L
                                       
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       Ω
                                       ;
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      Γ
                                                   
                                                   
                                                      N
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             d
                                          
                                       
                                       )
                                    
                                 .

To introduce an appropriate functional framework for problem (1), consider the Hilbert spaces 
                           
                              
                                 
                                    
                                       V
                                    
                                    
                                       D
                                    
                                 
                                 =
                                 
                                    {
                                    v
                                    ∈
                                    
                                       
                                          H
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             (
                                             D
                                             )
                                          
                                       
                                       
                                          d
                                       
                                    
                                    :
                                    v
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                Γ
                                             
                                             
                                                D
                                             
                                          
                                       
                                    
                                    =
                                    0
                                      in the sense of traces
                                    }
                                 
                                 ,
                              
                           
                         equipped with the 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           
                              
                                 
                                    (
                                    D
                                    )
                                 
                              
                              
                                 d
                              
                           
                        -norm, and 
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    Ω
                                    ;
                                    
                                       
                                          V
                                       
                                       
                                          D
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    f
                                    :
                                    Ω
                                    →
                                    
                                       
                                          V
                                       
                                       
                                          D
                                       
                                    
                                    ,
                                    
                                    f
                                    
                                    is  
                                    F
                                    -measurable
                                    
                                    and
                                    
                                    
                                       
                                          
                                             ‖
                                             f
                                             ‖
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                P
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             Ω
                                             ;
                                             
                                                
                                                   V
                                                
                                                
                                                   D
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             f
                                             
                                                (
                                                ω
                                                )
                                             
                                             ‖
                                          
                                       
                                       
                                          
                                             
                                                V
                                             
                                             
                                                D
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    d
                                    P
                                    
                                       (
                                       ω
                                       )
                                    
                                    <
                                    ∞
                                    }
                                 
                                 .
                              
                           
                        
                     

A weak solution of (1) is a random function 
                           u
                           ∈
                           
                              
                                 L
                              
                              
                                 P
                              
                              
                                 2
                              
                           
                           
                              (
                              Ω
                              ;
                              
                                 
                                    V
                                 
                                 
                                    D
                                 
                              
                              )
                           
                         such that 
                           
                              (2)
                              
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       D
                                    
                                 
                                 A
                                 e
                                 
                                    (
                                    u
                                    
                                       (
                                       x
                                       ,
                                       ω
                                       )
                                    
                                    )
                                 
                                 :
                                 e
                                 
                                    (
                                    v
                                    
                                       (
                                       x
                                       ,
                                       ω
                                       )
                                    
                                    )
                                 
                                 
                                 d
                                 x
                                 d
                                 P
                                 
                                    (
                                    ω
                                    )
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    [
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    f
                                    ⋅
                                    v
                                    
                                    d
                                    x
                                    +
                                    
                                       
                                          ∫
                                       
                                       
                                          
                                             
                                                Γ
                                             
                                             
                                                N
                                             
                                          
                                       
                                    
                                    g
                                    ⋅
                                    v
                                    
                                    d
                                    s
                                    ]
                                 
                                 
                                 d
                                 P
                                 
                                    (
                                    ω
                                    )
                                 
                                 ,
                                 
                                 ∀
                                 v
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    Ω
                                    ;
                                    
                                       
                                          V
                                       
                                       
                                          D
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

The Lax–Milgram lemma permits to state the well-posedness of (1). Moreover, there exists 
                           c
                           >
                           0
                         such that


                        
                           
                              
                                 
                                    
                                       
                                          ‖
                                          u
                                          ‖
                                       
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          Ω
                                          ;
                                          
                                             
                                                V
                                             
                                             
                                                D
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ≤
                                 c
                                 
                                    (
                                    
                                       
                                          
                                             ‖
                                             f
                                             ‖
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                P
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             Ω
                                             ;
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      D
                                                      )
                                                   
                                                
                                                
                                                   d
                                                
                                             
                                             )
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ‖
                                             g
                                             ‖
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                P
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             Ω
                                             ;
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            Γ
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   d
                                                
                                             
                                             )
                                          
                                       
                                    
                                    )
                                 
                              
                           
                         and 
                           
                              (3)
                              
                                 
                                    
                                       
                                          ‖
                                          u
                                          
                                             (
                                             ω
                                             )
                                          
                                          ‖
                                       
                                    
                                    
                                       
                                          
                                             V
                                          
                                          
                                             D
                                          
                                       
                                    
                                 
                                 ≤
                                 c
                                 
                                    (
                                    
                                       
                                          
                                             ‖
                                             f
                                             
                                                (
                                                ω
                                                )
                                             
                                             ‖
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   D
                                                   )
                                                
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ‖
                                             g
                                             
                                                (
                                                ω
                                                )
                                             
                                             ‖
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         Γ
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 a.s.
                                 
                                 ω
                                 ∈
                                 Ω
                                 .
                              
                           
                        
                     

Notice that, considering the assumption (A1), the constant 
                           c
                           =
                           c
                           
                              (
                              D
                              ,
                              
                                 
                                    μ
                                 
                                 
                                    min
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    min
                                 
                              
                              )
                           
                         in (3) does not depend on 
                           ω
                           ∈
                           Ω
                        .

The 
                           ε
                        -cone property, introduced by Chenais  [30], is presented as follows. Let a point 
                           y
                           ∈
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                        , a vector 
                           ξ
                           ∈
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                         and 
                           ε
                           >
                           0
                         be given. Consider the cone 
                           
                              
                                 C
                                 
                                    (
                                    y
                                    ,
                                    ξ
                                    ,
                                    ε
                                    )
                                 
                                 =
                                 
                                    {
                                    z
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          d
                                       
                                    
                                      :  
                                    
                                       (
                                       z
                                       −
                                       y
                                       ,
                                       ξ
                                       )
                                    
                                    ≥
                                    cos
                                    ε
                                    
                                       |
                                       z
                                       −
                                       y
                                       |
                                    
                                    ,
                                    
                                    0
                                    <
                                    
                                       |
                                       z
                                       −
                                       y
                                       |
                                    
                                    <
                                    ε
                                    }
                                 
                                 .
                              
                           
                        
                     

An open set 
                           O
                           ⊂
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                         is said to have the 
                           ε
                        -cone property if for all 
                           x
                           ∈
                           ∂
                           O
                         there exists a unit vector 
                           
                              
                                 ξ
                              
                              
                                 x
                              
                           
                         such that 
                           ∀
                           y
                           ∈
                           
                              
                                 O
                              
                              ¯
                           
                           ∩
                           B
                           
                              (
                              x
                              ,
                              ε
                              )
                           
                        , the property 
                           C
                           
                              (
                              y
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    x
                                 
                              
                              ,
                              ε
                              )
                           
                           ⊂
                           O
                         holds.

Consider the class 
                           
                              
                                 
                                    
                                       O
                                    
                                    
                                       ε
                                    
                                 
                                 =
                                 
                                    {
                                    O
                                    
                                    open
                                    ,
                                    O
                                    ⊂
                                    D
                                    ,
                                    
                                    O
                                    
                                    has the
                                    
                                    ε
                                    -cone property
                                    }
                                 
                                 .
                              
                           
                        
                     

For instance, the bounded, open and convex sets are some of the domains in the class 
                           
                              
                                 O
                              
                              
                                 ε
                              
                           
                        . It can be proved ([31, Th. 2.4.7]) that the 
                           ε
                        -cone property is equivalent to the fact that 
                           ∂
                           O
                         is uniformly Lipschitz. Imposing a volume constraint 
                           
                              
                                 V
                              
                              
                                 ∗
                              
                           
                         on an admissible domain, the class of admissible domains is 
                           
                              
                                 
                                    
                                       U
                                    
                                    
                                       a
                                       d
                                    
                                 
                                 =
                                 
                                    {
                                    O
                                    ∈
                                    
                                       
                                          O
                                       
                                       
                                          ε
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          Γ
                                       
                                       
                                          D
                                       
                                    
                                    ∪
                                    
                                       
                                          Γ
                                       
                                       
                                          N
                                       
                                    
                                    ⊂
                                    ∂
                                    O
                                    ,
                                    
                                    
                                       |
                                       O
                                       |
                                    
                                    =
                                    
                                       
                                          V
                                       
                                       
                                          ∗
                                       
                                    
                                    }
                                 
                                 ,
                                 
                                 with
                                 
                                 0
                                 <
                                 
                                    
                                       V
                                    
                                    
                                       ∗
                                    
                                 
                                 <
                                 
                                    |
                                    D
                                    |
                                 
                                 .
                              
                           
                        
                     

For a given 
                           O
                           ∈
                           
                              
                                 U
                              
                              
                                 a
                                 d
                              
                           
                        , let 
                           
                              
                                 u
                              
                              
                                 O
                              
                           
                           =
                           
                              
                                 u
                              
                              
                                 O
                              
                           
                           
                              (
                              x
                              ,
                              ω
                              )
                           
                         be the weak solution of (1) posed in the spatial domain 
                           O
                        . For each realization 
                           ω
                           ∈
                           Ω
                        , consider the compliance 
                           
                              (4)
                              
                                 J
                                 
                                    (
                                    O
                                    ,
                                    ω
                                    )
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       O
                                    
                                 
                                 f
                                 
                                    (
                                    x
                                    ,
                                    ω
                                    )
                                 
                                 ⋅
                                 
                                    
                                       u
                                    
                                    
                                       O
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    ω
                                    )
                                 
                                 
                                 d
                                 x
                                 +
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             N
                                          
                                       
                                    
                                 
                                 g
                                 
                                    (
                                    x
                                    ,
                                    ω
                                    )
                                 
                                 ⋅
                                 
                                    
                                       u
                                    
                                    
                                       O
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    ω
                                    )
                                 
                                 
                                 d
                                 s
                                 .
                              
                           
                        
                     

The following cost function is considered 
                           
                              (5)
                              
                                 
                                    
                                       J
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             α
                                          
                                       
                                    
                                 
                                 
                                    (
                                    O
                                    )
                                 
                                 =
                                 E
                                 
                                    (
                                    J
                                    
                                       (
                                       O
                                       ,
                                       ω
                                       )
                                    
                                    )
                                 
                                 +
                                 α
                                 Var
                                 
                                    (
                                    J
                                    
                                       (
                                       O
                                       ,
                                       ω
                                       )
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           α
                           ≥
                           0
                         is a weighting parameter, 
                           
                              
                                 E
                                 
                                    (
                                    J
                                    
                                       (
                                       O
                                       ,
                                       ω
                                       )
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 J
                                 
                                    (
                                    O
                                    ,
                                    ω
                                    )
                                 
                                 
                                 d
                                 P
                                 
                                    (
                                    ω
                                    )
                                 
                              
                           
                         is the expectation of the compliance, and 
                           
                              
                                 Var
                                 
                                    (
                                    J
                                    
                                       (
                                       O
                                       ,
                                       ω
                                       )
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 J
                                 
                                    
                                       
                                          (
                                          O
                                          ,
                                          ω
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                 d
                                 P
                                 
                                    (
                                    ω
                                    )
                                 
                                 −
                                 
                                    
                                       
                                          (
                                          
                                             
                                                ∫
                                             
                                             
                                                Ω
                                             
                                          
                                          J
                                          
                                             (
                                             O
                                             ,
                                             ω
                                             )
                                          
                                          
                                          d
                                          P
                                          
                                             (
                                             ω
                                             )
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         is its variance. In the sequel, the cost functional 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       R
                                    
                                    
                                       α
                                    
                                 
                              
                           
                         is referred to as the robust compliance. Such a cost functional 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       R
                                    
                                    
                                       α
                                    
                                 
                              
                           
                         is an averaged approach, commonly used in the field of robust optimization  [20,24,23], that combines lower statistical moments of the structural performance to find a trade-off between performance and robustness. The expectation of the compliance 
                           E
                           
                              (
                              J
                              
                                 (
                                 O
                                 ,
                                 ω
                                 )
                              
                              )
                           
                         is considered as an indicator of the structural performance, whereas the variance of the compliance 
                           Var
                           
                              (
                              J
                              
                                 (
                                 O
                                 ,
                                 ω
                                 )
                              
                              )
                           
                         is used as an indicator of the structural robustness.


                        
                           Remark 1
                           Notice that in order for the variance to be well-defined it should be assumed that 
                                 f
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                    
                                       4
                                    
                                 
                                 
                                    (
                                    Ω
                                    ;
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             (
                                             D
                                             )
                                          
                                       
                                       
                                          d
                                       
                                    
                                    )
                                 
                               and 
                                 g
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                    
                                       4
                                    
                                 
                                 
                                    (
                                    Ω
                                    ;
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   Γ
                                                
                                                
                                                   N
                                                
                                             
                                             )
                                          
                                       
                                       
                                          d
                                       
                                    
                                    )
                                 
                              .

The following optimization problem is considered 
                           
                              
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          α
                                       
                                    
                                    )
                                 
                                 
                                 min
                                 
                                    {
                                    
                                       
                                          J
                                       
                                       
                                          
                                             
                                                R
                                             
                                             
                                                α
                                             
                                          
                                       
                                    
                                    
                                       (
                                       O
                                       )
                                    
                                    :
                                    O
                                    ∈
                                    
                                       
                                          U
                                       
                                       
                                          a
                                          d
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

It is well known that if an admissible domain is assumed to be only Lebesgue measurable the deterministic shape optimization problem is ill-posed due to the lack of closure of the set of admissible domains with respect to the 
                           weak -
                           ⋆
                         topology in 
                           
                              
                                 L
                              
                              
                                 ∞
                              
                           
                           
                              (
                              D
                              ;
                              
                                 {
                                 0
                                 ,
                                 1
                                 }
                              
                              )
                           
                        . To overcome this difficulty, additional conditions, such as smoothness, geometrical or topology, are imposed on the class of admissible designs. In this work, the standard 
                           ε
                        -cone assumption [30] on the uniform geometry of the shapes has been considered. To prove the existence of a solution for 
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    α
                                 
                              
                              )
                           
                        , the set of admissible domains 
                           
                              
                                 U
                              
                              
                                 a
                                 d
                              
                           
                         is equipped with an appropriate topology so that the compactness of 
                           
                              
                                 U
                              
                              
                                 a
                                 d
                              
                           
                         and the continuity of 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       R
                                    
                                    
                                       α
                                    
                                 
                              
                           
                           
                              (
                              O
                              )
                           
                         are ensured. Following  [31, Definition 2.2.3], let 
                           
                              
                                 
                                    {
                                    
                                       
                                          O
                                       
                                       
                                          n
                                       
                                    
                                    }
                                 
                              
                              
                                 n
                                 ≥
                                 1
                              
                           
                         and 
                           O
                         be Lebesgue measurable sets of 
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                        . It is said that 
                           
                              {
                              
                                 
                                    O
                                 
                                 
                                    n
                                 
                              
                              }
                           
                         converges to 
                           O
                         in the sense of characteristic functions as 
                           n
                           →
                           ∞
                         if 
                           
                              
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             O
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                                 ⟶
                                 
                                    
                                       1
                                    
                                    
                                       O
                                    
                                 
                                 
                                 in
                                 
                                 
                                    
                                       L
                                    
                                    
                                       l
                                       o
                                       c
                                    
                                    
                                       p
                                    
                                 
                                 
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          d
                                       
                                    
                                    )
                                 
                                 
                                 ∀
                                 p
                                 ∈
                                 
                                    [
                                    1
                                    ,
                                    ∞
                                    [
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 1
                              
                              
                                 B
                              
                           
                         stands for the characteristic function of a measurable set 
                           B
                           ⊂
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                        .

The class of domains 
                           
                              
                                 O
                              
                              
                                 ε
                              
                           
                         enjoys the following compactness property ([31, Th. 2.4.10]): let 
                           
                              
                                 
                                    {
                                    
                                       
                                          O
                                       
                                       
                                          n
                                       
                                    
                                    }
                                 
                              
                              
                                 n
                                 ≥
                                 1
                              
                           
                         be a sequence in 
                           
                              
                                 O
                              
                              
                                 ε
                              
                           
                        . Then, there exists 
                           O
                           ∈
                           
                              
                                 O
                              
                              
                                 ε
                              
                           
                         and a subsequence, still labeled by 
                           n
                        , such that 
                           
                              
                                 O
                              
                              
                                 n
                              
                           
                         converges to 
                           O
                         in the sense of characteristic functions.


                        
                           Theorem 2.1
                           
                              The problem 
                              
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          α
                                       
                                    
                                    )
                                 
                               
                              has, at least, one solution.
                           


                        
                           Proof
                           Let 
                                 
                                    
                                       O
                                    
                                    
                                       n
                                    
                                 
                               be a minimizing sequence. Due to the compactness property of 
                                 
                                    
                                       O
                                    
                                    
                                       ε
                                    
                                 
                              , there exist 
                                 
                                    
                                       O
                                    
                                    
                                       ⋆
                                    
                                 
                                 ∈
                                 
                                    
                                       O
                                    
                                    
                                       ε
                                    
                                 
                               and a subsequence, still labeled by 
                                 n
                              , such that 
                                 
                                    
                                       O
                                    
                                    
                                       n
                                    
                                 
                               converges to 
                                 
                                    
                                       O
                                    
                                    
                                       ⋆
                                    
                                 
                              . Moreover, the convergence in the sense of characteristic functions permits 
                                 
                                    
                                       O
                                    
                                    
                                       ⋆
                                    
                                 
                               to satisfy the volume constraint, and hence 
                                 
                                    
                                       O
                                    
                                    
                                       ⋆
                                    
                                 
                                 ∈
                                 
                                    
                                       O
                                    
                                    
                                       a
                                       d
                                    
                                 
                              . The domain 
                                 
                                    
                                       O
                                    
                                    
                                       ⋆
                                    
                                 
                               is the candidate to be the minimizer. Similarly to the deterministic case (see  [31, Th. 4.3.1] for a related deterministic shape optimization problem for the conductivity equation) 
                                 
                                    (6)
                                    
                                       J
                                       
                                          (
                                          
                                             
                                                O
                                             
                                             
                                                n
                                             
                                          
                                          ,
                                          ω
                                          )
                                       
                                       →
                                       J
                                       
                                          (
                                          
                                             
                                                O
                                             
                                             
                                                ⋆
                                             
                                          
                                          ,
                                          ω
                                          )
                                       
                                       
                                       as
                                       
                                       n
                                       →
                                       ∞
                                       ,
                                         a.s.  
                                       ω
                                       ∈
                                       Ω
                                       .
                                    
                                 
                              
                           

Indeed, let 
                                 
                                    
                                       u
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    ω
                                    )
                                 
                               and 
                                 
                                    
                                       u
                                    
                                    
                                       
                                          
                                             O
                                          
                                          
                                             ⋆
                                          
                                       
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    ω
                                    )
                                 
                               be the solutions of (1) associated to 
                                 
                                    
                                       O
                                    
                                    
                                       n
                                    
                                 
                               and 
                                 
                                    
                                       O
                                    
                                    
                                       ⋆
                                    
                                 
                              , respectively. Since the domains in 
                                 
                                    
                                       O
                                    
                                    
                                       ε
                                    
                                 
                               enjoy the uniform extension property  [30], there exists a uniformly, w.r.t. 
                                 O
                                 ∈
                                 
                                    
                                       O
                                    
                                    
                                       ε
                                    
                                 
                              , bounded extension operator 
                                 
                                    (7)
                                    
                                       
                                          
                                             P
                                          
                                          
                                             O
                                          
                                       
                                       :
                                       
                                          
                                             H
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                (
                                                O
                                                )
                                             
                                          
                                          
                                             d
                                          
                                       
                                       →
                                       
                                          
                                             H
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                (
                                                D
                                                )
                                             
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       
                                       
                                          ‖
                                          
                                             
                                                P
                                             
                                             
                                                O
                                             
                                          
                                          ‖
                                       
                                       ≤
                                       k
                                       .
                                    
                                 
                              
                           

Let 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    ⋅
                                    ,
                                    ω
                                    )
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             O
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    ⋅
                                    ,
                                    ω
                                    )
                                 
                               be the extension of 
                                 
                                    
                                       u
                                    
                                    
                                       n
                                    
                                 
                               to 
                                 D
                              . By (3) and (7), 
                                 
                                    
                                       
                                          
                                             
                                                ‖
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                
                                                   (
                                                   ω
                                                   )
                                                
                                                ‖
                                             
                                          
                                          
                                             
                                                
                                                   V
                                                
                                                
                                                   D
                                                
                                             
                                          
                                       
                                       ≤
                                       
                                          ‖
                                          
                                             
                                                P
                                             
                                             
                                                
                                                   
                                                      O
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                          ‖
                                       
                                       
                                          
                                             
                                                ‖
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      n
                                                   
                                                
                                                
                                                   (
                                                   ω
                                                   )
                                                
                                                ‖
                                             
                                          
                                          
                                             
                                                
                                                   V
                                                
                                                
                                                   
                                                      
                                                         O
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ≤
                                       k
                                       c
                                       
                                          (
                                          
                                             
                                                
                                                   ‖
                                                   f
                                                   
                                                      (
                                                      ω
                                                      )
                                                   
                                                   ‖
                                                
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         D
                                                         )
                                                      
                                                   
                                                   
                                                      d
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ‖
                                                   g
                                                   
                                                      (
                                                      ω
                                                      )
                                                   
                                                   ‖
                                                
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               Γ
                                                            
                                                            
                                                               N
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      d
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                         a.s.  
                                       ω
                                       ∈
                                       Ω
                                    
                                 
                               and thus, by extracting a subsequence, 
                                 
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      (
                                                      ω
                                                      )
                                                   
                                                   →
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ⋆
                                                      
                                                   
                                                   
                                                      (
                                                      ω
                                                      )
                                                   
                                                
                                                
                                                     weakly in  
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         D
                                                      
                                                   
                                                     a.s.  
                                                   ω
                                                   ∈
                                                   Ω
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      (
                                                      ω
                                                      )
                                                   
                                                   →
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ⋆
                                                      
                                                   
                                                   
                                                      (
                                                      ω
                                                      )
                                                   
                                                
                                                
                                                     strongly in  
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            D
                                                            )
                                                         
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                     a.s.  
                                                   ω
                                                   ∈
                                                   Ω
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Let us prove that 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ⋆
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             
                                                
                                                   O
                                                
                                                
                                                   ⋆
                                                
                                             
                                          
                                       
                                       
                                          (
                                          ω
                                          )
                                       
                                       =
                                       
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   O
                                                
                                                
                                                   ⋆
                                                
                                             
                                          
                                       
                                       
                                          (
                                          ω
                                          )
                                       
                                       
                                       a.s.  
                                       ω
                                       ∈
                                       Ω
                                       .
                                    
                                 
                              
                           

From the definition of 
                                 
                                    
                                       u
                                    
                                    
                                       n
                                    
                                 
                              , it follows that 
                                 
                                    
                                       
                                          
                                             ∫
                                          
                                          
                                             
                                                
                                                   O
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       A
                                       e
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                n
                                             
                                          
                                          )
                                       
                                       :
                                       e
                                       
                                          (
                                          v
                                          )
                                       
                                       
                                       d
                                       x
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             
                                                
                                                   O
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       f
                                       ⋅
                                       v
                                       
                                       d
                                       x
                                       +
                                       
                                          
                                             ∫
                                          
                                          
                                             
                                                
                                                   Γ
                                                
                                                
                                                   N
                                                
                                             
                                          
                                       
                                       g
                                       ⋅
                                       v
                                       
                                       d
                                       x
                                       
                                       ∀
                                       v
                                       ∈
                                       
                                          
                                             V
                                          
                                          
                                             D
                                          
                                       
                                       ,
                                         a.s.  
                                       ω
                                       ∈
                                       Ω
                                       ,
                                    
                                 
                               which is equivalent to 
                                 
                                    
                                       
                                          
                                             ∫
                                          
                                          
                                             D
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   O
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       A
                                       e
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                n
                                             
                                          
                                          )
                                       
                                       :
                                       e
                                       
                                          (
                                          v
                                          )
                                       
                                       
                                       d
                                       x
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             D
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   O
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       f
                                       ⋅
                                       v
                                       
                                       d
                                       x
                                       +
                                       
                                          
                                             ∫
                                          
                                          
                                             
                                                
                                                   Γ
                                                
                                                
                                                   N
                                                
                                             
                                          
                                       
                                       g
                                       ⋅
                                       v
                                       
                                       d
                                       x
                                       
                                       ∀
                                       v
                                       ∈
                                       
                                          
                                             V
                                          
                                          
                                             D
                                          
                                       
                                       ,
                                         a.s.  
                                       ω
                                       ∈
                                       Ω
                                       .
                                    
                                 
                              
                           

The weak convergence of 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                               and the strong convergence in 
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    D
                                    )
                                 
                               of the characteristic functions permit to take the limit to get 
                                 
                                    
                                       
                                          
                                             ∫
                                          
                                          
                                             D
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   O
                                                
                                                
                                                   ⋆
                                                
                                             
                                          
                                       
                                       A
                                       e
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                ⋆
                                             
                                          
                                          )
                                       
                                       :
                                       e
                                       
                                          (
                                          v
                                          )
                                       
                                       
                                       d
                                       x
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             D
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   O
                                                
                                                
                                                   ⋆
                                                
                                             
                                          
                                       
                                       f
                                       ⋅
                                       v
                                       
                                       d
                                       x
                                       +
                                       
                                          
                                             ∫
                                          
                                          
                                             
                                                
                                                   Γ
                                                
                                                
                                                   N
                                                
                                             
                                          
                                       
                                       g
                                       ⋅
                                       v
                                       
                                       d
                                       x
                                       
                                       ∀
                                       v
                                       ∈
                                       
                                          
                                             V
                                          
                                          
                                             D
                                          
                                       
                                       ,
                                         a.s.  
                                       ω
                                       ∈
                                       Ω
                                       .
                                    
                                 
                              
                           

This proves that 
                                 
                                    
                                       u
                                    
                                    
                                       ⋆
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       
                                          
                                             O
                                          
                                          
                                             ⋆
                                          
                                       
                                    
                                 
                                 
                                    (
                                    ω
                                    )
                                 
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       
                                          
                                             O
                                          
                                          
                                             ⋆
                                          
                                       
                                    
                                 
                                 
                                    (
                                    ω
                                    )
                                 
                                   a.s.  
                                 ω
                                 ∈
                                 Ω
                              . Since this is valid for any subsequence, the whole sequence also satisfies this property.

Let us consider the compliance in the form 
                                 
                                    
                                       J
                                       
                                          (
                                          
                                             
                                                O
                                             
                                             
                                                n
                                             
                                          
                                          ,
                                          ω
                                          )
                                       
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             
                                                
                                                   O
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       f
                                       ⋅
                                       
                                          
                                             u
                                          
                                          
                                             n
                                          
                                       
                                       
                                       d
                                       x
                                       +
                                       
                                          
                                             ∫
                                          
                                          
                                             
                                                
                                                   Γ
                                                
                                                
                                                   N
                                                
                                             
                                          
                                       
                                       g
                                       ⋅
                                       
                                          
                                             u
                                          
                                          
                                             n
                                          
                                       
                                       
                                       d
                                       s
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             D
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   O
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       f
                                       ⋅
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             n
                                          
                                       
                                       
                                       d
                                       x
                                       +
                                       
                                          
                                             ∫
                                          
                                          
                                             
                                                
                                                   Γ
                                                
                                                
                                                   N
                                                
                                             
                                          
                                       
                                       g
                                       ⋅
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             n
                                          
                                       
                                       
                                       d
                                       s
                                       .
                                    
                                 
                              
                           

Due to the strong convergence of 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             O
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                               (and using the compactness of the trace operator [32]), the limit in this expression can be taken to obtain (6).

The parts of the cost functional are studied separately as follows


                              
                                 
                                    •
                                    Expectation of the compliance: by the Cauchy–Schwarz inequality, the continuity of the trace operator and (3), 
                                          
                                             (8)
                                             
                                                J
                                                
                                                   (
                                                   
                                                      
                                                         O
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   ,
                                                   ω
                                                   )
                                                
                                                =
                                                
                                                   
                                                      ∫
                                                   
                                                   
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                
                                                f
                                                
                                                   (
                                                   x
                                                   ,
                                                   ω
                                                   )
                                                
                                                ⋅
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   ω
                                                   )
                                                
                                                
                                                d
                                                x
                                                +
                                                
                                                   
                                                      ∫
                                                   
                                                   
                                                      
                                                         
                                                            Γ
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                   
                                                
                                                g
                                                
                                                   (
                                                   x
                                                   ,
                                                   ω
                                                   )
                                                
                                                ⋅
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   ω
                                                   )
                                                
                                                
                                                d
                                                s
                                                ≤
                                                
                                                   
                                                      
                                                         ‖
                                                         f
                                                         
                                                            (
                                                            ω
                                                            )
                                                         
                                                         ‖
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               D
                                                               )
                                                            
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ‖
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               
                                                                  
                                                                     O
                                                                  
                                                                  
                                                                     n
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            (
                                                            ω
                                                            )
                                                         
                                                         ‖
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     O
                                                                  
                                                                  
                                                                     n
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ‖
                                                         g
                                                         
                                                            (
                                                            ω
                                                            )
                                                         
                                                         ‖
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     Γ
                                                                  
                                                                  
                                                                     N
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ‖
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               
                                                                  
                                                                     O
                                                                  
                                                                  
                                                                     n
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            (
                                                            ω
                                                            )
                                                         
                                                         ‖
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     Γ
                                                                  
                                                                  
                                                                     N
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                   
                                                
                                                ≤
                                                c
                                                
                                                   
                                                      
                                                         ‖
                                                         f
                                                         
                                                            (
                                                            ω
                                                            )
                                                         
                                                         ‖
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               D
                                                               )
                                                            
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            ‖
                                                            f
                                                            
                                                               (
                                                               ω
                                                               )
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  D
                                                                  )
                                                               
                                                            
                                                            
                                                               d
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ‖
                                                            g
                                                            
                                                               (
                                                               ω
                                                               )
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        Γ
                                                                     
                                                                     
                                                                        N
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               d
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                +
                                                c
                                                
                                                   
                                                      
                                                         ‖
                                                         g
                                                         
                                                            (
                                                            ω
                                                            )
                                                         
                                                         ‖
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     Γ
                                                                  
                                                                  
                                                                     N
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            ‖
                                                            f
                                                            
                                                               (
                                                               ω
                                                               )
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  D
                                                                  )
                                                               
                                                            
                                                            
                                                               d
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ‖
                                                            g
                                                            
                                                               (
                                                               ω
                                                               )
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        Γ
                                                                     
                                                                     
                                                                        N
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               d
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ∈
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      P
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   Ω
                                                   )
                                                
                                                .
                                             
                                          
                                        Combining (6) and (8), by dominated convergence, it follows that 
                                          
                                             
                                                E
                                                
                                                   (
                                                   J
                                                   
                                                      (
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      ,
                                                      ω
                                                      )
                                                   
                                                   )
                                                
                                                =
                                                
                                                   
                                                      ∫
                                                   
                                                   
                                                      Ω
                                                   
                                                
                                                J
                                                
                                                   (
                                                   
                                                      
                                                         O
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   ,
                                                   ω
                                                   )
                                                
                                                
                                                d
                                                P
                                                
                                                   (
                                                   ω
                                                   )
                                                
                                                →
                                                E
                                                
                                                   (
                                                   J
                                                   
                                                      (
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            ⋆
                                                         
                                                      
                                                      ,
                                                      ω
                                                      )
                                                   
                                                   )
                                                
                                                =
                                                
                                                   
                                                      ∫
                                                   
                                                   
                                                      Ω
                                                   
                                                
                                                J
                                                
                                                   (
                                                   
                                                      
                                                         O
                                                      
                                                      
                                                         ⋆
                                                      
                                                   
                                                   ,
                                                   ω
                                                   )
                                                
                                                
                                                d
                                                P
                                                
                                                   (
                                                   ω
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    

Variance of the compliance: from (6) it follows that 
                                          
                                             
                                                J
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               O
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         ,
                                                         ω
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                →
                                                J
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               O
                                                            
                                                            
                                                               ⋆
                                                            
                                                         
                                                         ,
                                                         ω
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                a.s.
                                                
                                                ω
                                                ∈
                                                Ω
                                                .
                                             
                                          
                                        Hence, by Remark 1 and (8), 
                                          
                                             
                                                
                                                   
                                                      ∫
                                                   
                                                   
                                                      Ω
                                                   
                                                
                                                J
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               O
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         ,
                                                         ω
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                d
                                                P
                                                
                                                   (
                                                   ω
                                                   )
                                                
                                                →
                                                
                                                   
                                                      ∫
                                                   
                                                   
                                                      Ω
                                                   
                                                
                                                J
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               O
                                                            
                                                            
                                                               ⋆
                                                            
                                                         
                                                         ,
                                                         ω
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                d
                                                P
                                                
                                                   (
                                                   ω
                                                   )
                                                
                                             
                                          
                                        and 
                                          
                                             
                                                Var
                                                
                                                   (
                                                   J
                                                   
                                                      (
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      ,
                                                      ω
                                                      )
                                                   
                                                   )
                                                
                                                =
                                                
                                                   
                                                      ∫
                                                   
                                                   
                                                      Ω
                                                   
                                                
                                                J
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               O
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         ,
                                                         ω
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                d
                                                P
                                                
                                                   (
                                                   ω
                                                   )
                                                
                                                −
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               ∫
                                                            
                                                            
                                                               Ω
                                                            
                                                         
                                                         J
                                                         
                                                            (
                                                            
                                                               
                                                                  O
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                            ,
                                                            ω
                                                            )
                                                         
                                                         
                                                         d
                                                         P
                                                         
                                                            (
                                                            ω
                                                            )
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                →
                                                Var
                                                
                                                   (
                                                   J
                                                   
                                                      (
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            ⋆
                                                         
                                                      
                                                      ,
                                                      ω
                                                      )
                                                   
                                                   )
                                                
                                                =
                                                
                                                   
                                                      ∫
                                                   
                                                   
                                                      Ω
                                                   
                                                
                                                J
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               O
                                                            
                                                            
                                                               ⋆
                                                            
                                                         
                                                         ,
                                                         ω
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                d
                                                P
                                                
                                                   (
                                                   ω
                                                   )
                                                
                                                −
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               ∫
                                                            
                                                            
                                                               Ω
                                                            
                                                         
                                                         J
                                                         
                                                            (
                                                            
                                                               
                                                                  O
                                                               
                                                               
                                                                  ⋆
                                                               
                                                            
                                                            ,
                                                            ω
                                                            )
                                                         
                                                         
                                                         d
                                                         P
                                                         
                                                            (
                                                            ω
                                                            )
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                .
                                             
                                          
                                       
                                       □


                        
                           Remark 2
                           Although the existence result of Theorem 2.1 applies to the minimization of compliance, it can be extended to other types of objective functionals. Consider a function 
                                 
                                    
                                       j
                                       =
                                       j
                                       
                                          (
                                          x
                                          ,
                                          r
                                          )
                                       
                                       :
                                       D
                                       ×
                                       
                                          
                                             R
                                          
                                          
                                             d
                                          
                                       
                                       →
                                       R
                                       ,
                                    
                                 
                               which is assumed to be measurable w.r.t. 
                                 x
                                 ∈
                                 D
                              , continuous w.r.t. 
                                 r
                               for a.e. 
                                 x
                                 ∈
                                 D
                              , and such that there exists a positive constant 
                                 C
                               such that 
                                 
                                    (9)
                                    
                                       
                                          |
                                          j
                                          
                                             (
                                             x
                                             ,
                                             r
                                             )
                                          
                                          |
                                       
                                       ≤
                                       C
                                       
                                          (
                                          1
                                          +
                                          
                                             
                                                
                                                   |
                                                   r
                                                   |
                                                
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                       ∀
                                       
                                          (
                                          x
                                          ,
                                          r
                                          )
                                       
                                       ∈
                                       D
                                       ×
                                       
                                          
                                             R
                                          
                                          
                                             d
                                          
                                       
                                       .
                                    
                                 
                              
                           

Following similar notations, set 
                                 
                                    (10)
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ˆ
                                          
                                       
                                       
                                          (
                                          O
                                          ,
                                          ω
                                          )
                                       
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             O
                                          
                                       
                                       j
                                       
                                          (
                                          x
                                          ,
                                          
                                             
                                                u
                                             
                                             
                                                O
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             ω
                                             )
                                          
                                          )
                                       
                                       
                                       d
                                       x
                                       .
                                    
                                 
                              
                           

In the same vein of the cost functional 
                                 
                                    
                                       J
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             α
                                          
                                       
                                    
                                 
                              , defined in (5), the following cost functional is considered 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   α
                                                
                                             
                                          
                                       
                                       
                                          (
                                          O
                                          )
                                       
                                       =
                                       E
                                       
                                          (
                                          
                                             
                                                J
                                             
                                             
                                                ˆ
                                             
                                          
                                          
                                             (
                                             O
                                             ,
                                             ω
                                             )
                                          
                                          )
                                       
                                       +
                                       α
                                       Var
                                       
                                          (
                                          
                                             
                                                J
                                             
                                             
                                                ˆ
                                             
                                          
                                          
                                             (
                                             O
                                             ,
                                             ω
                                             )
                                          
                                          )
                                       
                                       ,
                                       
                                       α
                                       ≥
                                       0
                                       ,
                                    
                                 
                               which, making use of (9), is well-defined provided 
                                 f
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                    
                                       4
                                    
                                 
                                 
                                    (
                                    Ω
                                    ;
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             (
                                             D
                                             )
                                          
                                       
                                       
                                          d
                                       
                                    
                                    )
                                 
                               and 
                                 g
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                    
                                       4
                                    
                                 
                                 
                                    (
                                    Ω
                                    ;
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   Γ
                                                
                                                
                                                   N
                                                
                                             
                                             )
                                          
                                       
                                       
                                          d
                                       
                                    
                                    )
                                 
                              . In these conditions, the proof of Theorem 2.1 can be used to prove that the existence result holds for the cost functional 
                                 
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             α
                                          
                                       
                                    
                                 
                                 
                                    (
                                    O
                                    )
                                 
                              .

Following the notation in  [33], 
                           θ
                           ∈
                           
                              
                                 W
                              
                              
                                 1
                                 ,
                                 ∞
                              
                           
                           
                              (
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                              ;
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                              )
                           
                         is the deformation vector field. The boundary of an admissible domain 
                           O
                         is composed of three disjoint parts, namely 
                           ∂
                           O
                           =
                           
                              
                                 Γ
                              
                              
                                 D
                              
                           
                           ∪
                           
                              
                                 Γ
                              
                              
                                 N
                              
                           
                           ∪
                           
                              
                                 Γ
                              
                              
                                 0
                              
                           
                        , where 
                           
                              
                                 Γ
                              
                              
                                 D
                              
                           
                         and 
                           
                              
                                 Γ
                              
                              
                                 N
                              
                           
                         are fixed and 
                           
                              
                                 Γ
                              
                              
                                 0
                              
                           
                         is the part of the boundary to be optimized. Accordingly, the vector field 
                           θ
                         satisfies the constraint 
                           θ
                           ⋅
                           n
                           =
                           0
                         on 
                           
                              
                                 Γ
                              
                              
                                 D
                              
                           
                           ∪
                           
                              
                                 Γ
                              
                              
                                 N
                              
                           
                        . The volume constraint, as given in the definition of 
                           
                              
                                 U
                              
                              
                                 a
                                 d
                              
                           
                        , is incorporated in the cost functional through an augmented Lagrangian method. According to the approach described in  [34], an augmented Lagrangian function is constructed as 
                           
                              (11)
                              
                                 
                                    
                                       J
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             α
                                          
                                       
                                    
                                    
                                       L
                                    
                                 
                                 
                                    (
                                    O
                                    )
                                 
                                 =
                                 
                                    
                                       J
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             α
                                          
                                       
                                    
                                 
                                 
                                    (
                                    O
                                    )
                                 
                                 +
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ∫
                                       
                                       
                                          O
                                       
                                    
                                    
                                    d
                                    x
                                    −
                                    
                                       
                                          V
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                ∫
                                             
                                             
                                                O
                                             
                                          
                                          
                                          d
                                          x
                                          −
                                          
                                             
                                                V
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         where 
                           L
                           =
                           
                              (
                              
                                 
                                    L
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        , being 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                         the Lagrange multiplier and the penalty parameter, respectively, used to enforce the volume constraint at convergence. The Lagrange multiplier is updated at each iteration 
                           n
                         according to 
                           
                              
                                 L
                              
                              
                                 1
                              
                              
                                 
                                    (
                                    n
                                    +
                                    1
                                    )
                                 
                              
                           
                           =
                           
                              
                                 L
                              
                              
                                 1
                              
                              
                                 n
                              
                           
                           +
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    ∫
                                 
                                 
                                    O
                                 
                              
                              
                              d
                              x
                              −
                              
                                 
                                    V
                                 
                                 
                                    ∗
                                 
                              
                              )
                           
                        . Furthermore, the penalty multiplier is augmented, after every five iterations, multiplying its previous value by 1.2.

A formal computation of the shape derivative of the cost functional 
                           
                              (12)
                              
                                 
                                    
                                       J
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             α
                                          
                                       
                                    
                                    
                                       L
                                    
                                 
                                 
                                    (
                                    O
                                    )
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    [
                                    
                                       
                                          ∫
                                       
                                       
                                          O
                                       
                                    
                                    f
                                    ⋅
                                    u
                                    
                                    d
                                    x
                                    +
                                    
                                       
                                          ∫
                                       
                                       
                                          
                                             
                                                Γ
                                             
                                             
                                                N
                                             
                                          
                                       
                                    
                                    g
                                    ⋅
                                    u
                                    
                                    d
                                    s
                                    ]
                                 
                                 
                                 d
                                 P
                                 
                                    (
                                    ω
                                    )
                                 
                                 +
                                 α
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       
                                          [
                                          
                                             
                                                ∫
                                             
                                             
                                                O
                                             
                                          
                                          f
                                          ⋅
                                          u
                                          
                                          d
                                          x
                                          +
                                          
                                             
                                                ∫
                                             
                                             
                                                
                                                   
                                                      Γ
                                                   
                                                   
                                                      N
                                                   
                                                
                                             
                                          
                                          g
                                          ⋅
                                          u
                                          
                                          d
                                          s
                                          ]
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                 d
                                 P
                                 
                                    (
                                    ω
                                    )
                                 
                                 −
                                 α
                                 
                                    
                                       
                                          (
                                          
                                             
                                                ∫
                                             
                                             
                                                Ω
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   ∫
                                                
                                                
                                                   O
                                                
                                             
                                             f
                                             ⋅
                                             u
                                             
                                             d
                                             x
                                             +
                                             
                                                
                                                   ∫
                                                
                                                
                                                   
                                                      
                                                         Γ
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                             
                                             g
                                             ⋅
                                             u
                                             
                                             d
                                             s
                                             ]
                                          
                                          
                                          d
                                          P
                                          
                                             (
                                             ω
                                             )
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ∫
                                       
                                       
                                          O
                                       
                                    
                                    
                                    d
                                    x
                                    −
                                    
                                       
                                          V
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                ∫
                                             
                                             
                                                O
                                             
                                          
                                          
                                          d
                                          x
                                          −
                                          
                                             
                                                V
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         is presented below. For the definition and main properties of shape derivative for shape functionals, the author is referred to [1].


                        
                           Proposition 3.1
                           
                              The shape derivative of the cost functional 
                              
                                 
                                    
                                       J
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             α
                                          
                                       
                                    
                                    
                                       L
                                    
                                 
                                 
                                    (
                                    O
                                    )
                                 
                               
                              is given by
                              
                                 
                                    (13)
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            α
                                                         
                                                      
                                                   
                                                   
                                                      L
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          O
                                          )
                                       
                                       
                                          (
                                          θ
                                          )
                                       
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             
                                                
                                                   Γ
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       θ
                                       ⋅
                                       n
                                       
                                          [
                                          
                                             
                                                ∫
                                             
                                             
                                                Ω
                                             
                                          
                                          
                                             (
                                             2
                                             f
                                             ⋅
                                             u
                                             −
                                             A
                                             e
                                             
                                                (
                                                u
                                                )
                                             
                                             :
                                             e
                                             
                                                (
                                                u
                                                )
                                             
                                             )
                                          
                                          
                                          d
                                          P
                                          
                                             (
                                             ω
                                             )
                                          
                                          ]
                                       
                                       
                                       d
                                       s
                                       +
                                       α
                                       
                                          
                                             ∫
                                          
                                          
                                             
                                                
                                                   Γ
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       θ
                                       ⋅
                                       n
                                       
                                          [
                                          
                                             
                                                ∫
                                             
                                             
                                                Ω
                                             
                                          
                                          
                                             (
                                             2
                                             J
                                             
                                                (
                                                O,ω
                                                )
                                             
                                             f
                                             ⋅
                                             u
                                             −
                                             f
                                             ⋅
                                             p
                                             +
                                             A
                                             e
                                             
                                                (
                                                u
                                                )
                                             
                                             :
                                             e
                                             
                                                (
                                                p
                                                )
                                             
                                             )
                                          
                                          
                                          d
                                          P
                                          
                                             (
                                             ω
                                             )
                                          
                                          ]
                                       
                                       
                                       d
                                       s
                                       −
                                       2
                                       α
                                       E
                                       
                                          (
                                          J
                                          
                                             (
                                             O
                                             ,
                                             ω
                                             )
                                          
                                          )
                                       
                                       
                                          
                                             ∫
                                          
                                          
                                             
                                                
                                                   Γ
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       θ
                                       ⋅
                                       n
                                       
                                          [
                                          
                                             
                                                ∫
                                             
                                             
                                                Ω
                                             
                                          
                                          
                                             (
                                             2
                                             f
                                             ⋅
                                             u
                                             −
                                             A
                                             e
                                             
                                                (
                                                u
                                                )
                                             
                                             :
                                             e
                                             
                                                (
                                                u
                                                )
                                             
                                             )
                                          
                                          
                                          d
                                          P
                                          
                                             (
                                             ω
                                             )
                                          
                                          ]
                                       
                                       
                                       d
                                       s
                                       +
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             ∫
                                          
                                          
                                             
                                                
                                                   Γ
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       θ
                                       ⋅
                                       n
                                       
                                       d
                                       s
                                       +
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                ∫
                                             
                                             
                                                O
                                             
                                          
                                          
                                          d
                                          x
                                          −
                                          
                                             
                                                V
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                       
                                          
                                             ∫
                                          
                                          
                                             
                                                
                                                   Γ
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       θ
                                       ⋅
                                       n
                                       
                                       d
                                       s
                                    
                                 
                              
                              where 
                              
                                 J
                                 
                                    (
                                    O
                                    ,
                                    ω
                                    )
                                 
                               
                              is given by   (4)   and the adjoint state 
                              
                                 p
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    Ω
                                    ;
                                    
                                       
                                          V
                                       
                                       
                                          O
                                       
                                    
                                    )
                                 
                               
                              solves the system
                              
                                 
                                    (14)
                                    
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       
                                          
                                             ∫
                                          
                                          
                                             O
                                          
                                       
                                       A
                                       e
                                       
                                          (
                                          p
                                          )
                                       
                                       :
                                       e
                                       
                                          (
                                          v
                                          )
                                       
                                       
                                       d
                                       x
                                       d
                                       P
                                       
                                          (
                                          ω
                                          )
                                       
                                       =
                                       −
                                       2
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       
                                          (
                                          
                                             
                                                ∫
                                             
                                             
                                                O
                                             
                                          
                                          f
                                          ⋅
                                          u
                                          
                                          d
                                          x
                                          +
                                          
                                             
                                                ∫
                                             
                                             
                                                
                                                   
                                                      Γ
                                                   
                                                   
                                                      N
                                                   
                                                
                                             
                                          
                                          g
                                          ⋅
                                          u
                                          
                                          d
                                          s
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                ∫
                                             
                                             
                                                O
                                             
                                          
                                          f
                                          ⋅
                                          v
                                          
                                          d
                                          x
                                          +
                                          
                                             
                                                ∫
                                             
                                             
                                                
                                                   
                                                      Γ
                                                   
                                                   
                                                      N
                                                   
                                                
                                             
                                          
                                          g
                                          ⋅
                                          v
                                          
                                          d
                                          s
                                          )
                                       
                                       
                                       d
                                       P
                                       
                                          (
                                          ω
                                          )
                                       
                                       ,
                                    
                                 
                              
                              for all 
                              
                                 v
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    Ω
                                    ;
                                    
                                       
                                          V
                                       
                                       
                                          O
                                       
                                    
                                    )
                                 
                              
                              .
                           


                        
                           Sketch of the proof
                           A rigorous proof of (13) should address the existence of the Gâteaux or Fréchet derivative of (12). This issue has been analyzed in  [1,31] for the case of the Laplace equation. To simplify, a brief formal proof using the Lagrange method due to Céa  [35] is provided in this work for the sake of completeness. Recall that for a generic shape functional as 
                                 
                                    (15)
                                    
                                       
                                          
                                             J
                                          
                                          
                                             1
                                          
                                       
                                       
                                          (
                                          O
                                          )
                                       
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             O
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             1
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       
                                       d
                                       x
                                       +
                                       
                                          
                                             ∫
                                          
                                          
                                             ∂
                                             O
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       
                                       d
                                       s
                                       ,
                                    
                                 
                               its shape derivative is explicitly given by 
                                 
                                    (16)
                                    
                                       
                                          
                                             J
                                          
                                          
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          O
                                          )
                                       
                                       
                                          (
                                          θ
                                          )
                                       
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             ∂
                                             O
                                          
                                       
                                       θ
                                       ⋅
                                       n
                                       
                                          (
                                          
                                             
                                                F
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                ∂
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                ∂
                                                n
                                             
                                          
                                          +
                                          H
                                          
                                             
                                                F
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                       d
                                       s
                                       ,
                                    
                                 
                               where 
                                 H
                                 =
                                 
                                    div
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              . See  [1, Propositions 6.22 and 6.24] for a proof.

The first term on the right hand side (RHS) of (13), which is the one associated to the expectation of the compliance, is obtained from (16) following  [33]. The only difference with respect to  [33] is that 
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                               take the form 
                                 
                                    (17)
                                    
                                       
                                          
                                             F
                                          
                                          
                                             1
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       f
                                       ⋅
                                       u
                                       
                                       d
                                       P
                                       
                                          (
                                          ω
                                          )
                                       
                                       
                                       and
                                       
                                       
                                          
                                             F
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       g
                                       ⋅
                                       u
                                       
                                       d
                                       P
                                       
                                          (
                                          ω
                                          )
                                       
                                       .
                                    
                                 
                               Notice that a change in the order of integration has been carried out.

For the second term in (13), the Lagrangian 
                                 
                                    (18)
                                    
                                       L
                                       
                                          (
                                          O
                                          ,
                                          
                                             
                                                u
                                             
                                             
                                                ˆ
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                ˆ
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      ∫
                                                   
                                                   
                                                      O
                                                   
                                                
                                                f
                                                ⋅
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                
                                                d
                                                x
                                                +
                                                
                                                   
                                                      ∫
                                                   
                                                   
                                                      
                                                         
                                                            Γ
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                   
                                                
                                                g
                                                ⋅
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                
                                                d
                                                s
                                                ]
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                       d
                                       P
                                       
                                          (
                                          ω
                                          )
                                       
                                       +
                                       
                                          
                                             ∫
                                          
                                          
                                             O
                                          
                                       
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       A
                                       e
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                ˆ
                                             
                                          
                                          )
                                       
                                       :
                                       e
                                       
                                          (
                                          
                                             
                                                p
                                             
                                             
                                                ˆ
                                             
                                          
                                          )
                                       
                                       
                                       d
                                       P
                                       
                                          (
                                          ω
                                          )
                                       
                                       
                                       d
                                       x
                                       −
                                       
                                          
                                             ∫
                                          
                                          
                                             O
                                          
                                       
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             ˆ
                                          
                                       
                                       ⋅
                                       f
                                       
                                       d
                                       P
                                       
                                          (
                                          ω
                                          )
                                       
                                       
                                       d
                                       x
                                       −
                                       
                                          
                                             ∫
                                          
                                          
                                             
                                                
                                                   Γ
                                                
                                                
                                                   N
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             ˆ
                                          
                                       
                                       ⋅
                                       g
                                       
                                       d
                                       P
                                       
                                          (
                                          ω
                                          )
                                       
                                       
                                       d
                                       s
                                    
                                 
                               is considered, where 
                                 
                                    
                                       u
                                    
                                    
                                       ˆ
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       ˆ
                                    
                                 
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    Ω
                                    ;
                                    
                                       
                                          H
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             d
                                          
                                       
                                       ;
                                       
                                          
                                             R
                                          
                                          
                                             d
                                          
                                       
                                       )
                                    
                                    )
                                 
                               satisfy 
                                 
                                    
                                       u
                                    
                                    
                                       ˆ
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       ˆ
                                    
                                 
                                 =
                                 0
                               on 
                                 
                                    
                                       Γ
                                    
                                    
                                       D
                                    
                                 
                              . For a given 
                                 O
                              , denoting by 
                                 
                                    (
                                    u
                                    ,
                                    p
                                    )
                                 
                               a stationary point of 
                                 L
                              , the derivative of 
                                 L
                               with respect to 
                                 
                                    
                                       u
                                    
                                    
                                       ˆ
                                    
                                 
                               in the direction 
                                 v
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    Ω
                                    ;
                                    
                                       
                                          H
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             d
                                          
                                       
                                       ;
                                       
                                          
                                             R
                                          
                                          
                                             d
                                          
                                       
                                       )
                                    
                                    )
                                 
                              , with 
                                 v
                                 =
                                 0
                               on 
                                 
                                    
                                       Γ
                                    
                                    
                                       D
                                    
                                 
                              , yields 
                                 
                                    (19)
                                    
                                       0
                                       =
                                       
                                          〈
                                          
                                             
                                                ∂
                                                L
                                             
                                             
                                                ∂
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             O
                                             ,
                                             u
                                             ,
                                             p
                                             )
                                          
                                          ,
                                          v
                                          〉
                                       
                                       =
                                       2
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       
                                          (
                                          
                                             
                                                ∫
                                             
                                             
                                                O
                                             
                                          
                                          f
                                          ⋅
                                          u
                                          
                                          d
                                          x
                                          +
                                          
                                             
                                                ∫
                                             
                                             
                                                
                                                   
                                                      Γ
                                                   
                                                   
                                                      N
                                                   
                                                
                                             
                                          
                                          g
                                          ⋅
                                          u
                                          
                                          d
                                          s
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                ∫
                                             
                                             
                                                O
                                             
                                          
                                          f
                                          ⋅
                                          v
                                          
                                          d
                                          x
                                          +
                                          
                                             
                                                ∫
                                             
                                             
                                                
                                                   
                                                      Γ
                                                   
                                                   
                                                      N
                                                   
                                                
                                             
                                          
                                          g
                                          ⋅
                                          v
                                          
                                          d
                                          s
                                          )
                                       
                                       
                                       d
                                       P
                                       
                                          (
                                          ω
                                          )
                                       
                                       +
                                       
                                          
                                             ∫
                                          
                                          
                                             O
                                          
                                       
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       A
                                       e
                                       
                                          (
                                          v
                                          )
                                       
                                       :
                                       e
                                       
                                          (
                                          p
                                          )
                                       
                                       
                                       d
                                       P
                                       
                                          (
                                          ω
                                          )
                                       
                                       
                                       d
                                       x
                                       .
                                    
                                 
                               After integrating by parts and by taking 
                                 v
                               with compact support in 
                                 O
                                 ×
                                 Ω
                               gives 
                                 
                                    (20)
                                    
                                       −
                                       
                                          div
                                       
                                       
                                          (
                                          A
                                          e
                                          
                                             (
                                             p
                                             )
                                          
                                          )
                                       
                                       =
                                       −
                                       2
                                       
                                          (
                                          
                                             
                                                ∫
                                             
                                             
                                                O
                                             
                                          
                                          f
                                          ⋅
                                          u
                                          
                                          d
                                          x
                                          +
                                          
                                             
                                                ∫
                                             
                                             
                                                
                                                   
                                                      Γ
                                                   
                                                   
                                                      N
                                                   
                                                
                                             
                                          
                                          g
                                          ⋅
                                          v
                                          
                                          d
                                          s
                                          )
                                       
                                       f
                                       
                                       in
                                       
                                       D
                                       ×
                                       Ω
                                       .
                                    
                                 
                               Similarly, varying the trace of 
                                 v
                                 
                                    (
                                    ⋅
                                    ,
                                    ω
                                    )
                                 
                               on 
                                 
                                    
                                       Γ
                                    
                                    
                                       N
                                    
                                 
                               and on 
                                 
                                    
                                       Γ
                                    
                                    
                                       0
                                    
                                 
                              , the following boundary conditions 
                                 
                                    (21)
                                    
                                       A
                                       e
                                       
                                          (
                                          p
                                          )
                                       
                                       ⋅
                                       n
                                       =
                                       −
                                       2
                                       
                                          (
                                          
                                             
                                                ∫
                                             
                                             
                                                O
                                             
                                          
                                          f
                                          ⋅
                                          u
                                          
                                          d
                                          x
                                          +
                                          
                                             
                                                ∫
                                             
                                             
                                                
                                                   
                                                      Γ
                                                   
                                                   
                                                      N
                                                   
                                                
                                             
                                          
                                          g
                                          ⋅
                                          v
                                          
                                          d
                                          s
                                          )
                                       
                                       g
                                       
                                       on
                                       
                                       
                                          
                                             Γ
                                          
                                          
                                             N
                                          
                                       
                                       ×
                                       Ω
                                    
                                 
                               and 
                                 
                                    (22)
                                    
                                       A
                                       e
                                       
                                          (
                                          p
                                          )
                                       
                                       ⋅
                                       n
                                       =
                                       0
                                       
                                       on
                                       
                                       
                                          
                                             Γ
                                          
                                          
                                             0
                                          
                                       
                                       ×
                                       Ω
                                    
                                 
                               are obtained. The variational or weak formulation of (20)–(22) is given by (14).

The third term on the RHS of (13) is obtained by applying the chain rule theorem to the third term on the RHS of (12). The fourth term in (13) is obtained from (16), taking 
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 1
                               and 
                                 
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                              . Notice that in the present case 
                                 θ
                                 ⋅
                                 n
                                 =
                                 0
                               on 
                                 
                                    
                                       Γ
                                    
                                    
                                       D
                                    
                                 
                                 ∪
                                 
                                    
                                       Γ
                                    
                                    
                                       N
                                    
                                 
                              . Finally, the fifth term in (13) is obtained by applying the chain rule theorem to the fifth term on the RHS of (12). □

The shape of the unknown domain 
                           O
                         is described through the zero level set of a function 
                           ψ
                           =
                           ψ
                           
                              (
                              t
                              ,
                              x
                              )
                           
                         defined on the working domain 
                           D
                         as follows 
                           
                              (23)
                              
                                 ∀
                                 x
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ∈
                                 
                                    (
                                    0
                                    ,
                                    T
                                    )
                                 
                                 
                                    {
                                    
                                       
                                          
                                             ψ
                                             
                                                (
                                                x
                                                ,
                                                t
                                                )
                                             
                                             <
                                             0
                                          
                                          
                                             
                                                if
                                             
                                             
                                             x
                                             ∈
                                             O
                                             ,
                                          
                                       
                                       
                                          
                                             ψ
                                             
                                                (
                                                x
                                                ,
                                                t
                                                )
                                             
                                             =
                                             0
                                          
                                          
                                             
                                                if
                                             
                                             
                                             x
                                             ∈
                                             ∂
                                             O
                                             ,
                                          
                                       
                                       
                                          
                                             ψ
                                             
                                                (
                                                x
                                                ,
                                                t
                                                )
                                             
                                             >
                                             0
                                          
                                          
                                             
                                                if
                                             
                                             
                                             x
                                             ∉
                                             O
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Following the original idea by Osher and Sethian  [36], which was incorporated to the topology optimization framework in  [37,33], the evolution of the shape during the optimization process is controlled by the Hamilton–Jacobi equation 
                           
                              (24)
                              
                                 
                                    
                                       ∂
                                       ψ
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 +
                                 
                                    (
                                    θ
                                    ⋅
                                    n
                                    )
                                 
                                 
                                    |
                                    ∇
                                    ψ
                                    |
                                 
                                 =
                                 0
                                 ,
                                 
                                 t
                                 ∈
                                 
                                    (
                                    0
                                    ,
                                    T
                                    )
                                 
                                 ,
                                 
                                 x
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                                 ,
                              
                           
                         where 
                           t
                         stands for a fictitious time that accounts for the step-size parameter in the descent algorithm. The chosen descent direction is then 
                           θ
                           =
                           −
                           v
                           n
                        , where 
                           
                              (25)
                              
                                 v
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    (
                                    2
                                    f
                                    ⋅
                                    u
                                    −
                                    A
                                    e
                                    
                                       (
                                       u
                                       )
                                    
                                    :
                                    e
                                    
                                       (
                                       u
                                       )
                                    
                                    )
                                 
                                 
                                 d
                                 P
                                 
                                    (
                                    ω
                                    )
                                 
                                 +
                                 α
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    (
                                    2
                                    J
                                    
                                       (
                                       O,ω
                                       )
                                    
                                    f
                                    ⋅
                                    u
                                    −
                                    f
                                    ⋅
                                    p
                                    +
                                    A
                                    e
                                    
                                       (
                                       u
                                       )
                                    
                                    :
                                    e
                                    
                                       (
                                       p
                                       )
                                    
                                    )
                                 
                                 
                                 d
                                 P
                                 
                                    (
                                    ω
                                    )
                                 
                                 −
                                 2
                                 α
                                 E
                                 
                                    (
                                    J
                                    
                                       (
                                       O
                                       ,
                                       ω
                                       )
                                    
                                    )
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    (
                                    2
                                    f
                                    ⋅
                                    u
                                    −
                                    A
                                    e
                                    
                                       (
                                       u
                                       )
                                    
                                    :
                                    e
                                    
                                       (
                                       u
                                       )
                                    
                                    )
                                 
                                 
                                 d
                                 P
                                 
                                    (
                                    ω
                                    )
                                 
                                 +
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ∫
                                       
                                       
                                          O
                                       
                                    
                                    
                                    d
                                    x
                                    −
                                    
                                       
                                          V
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                              
                           
                         is the advection velocity in the Hamilton–Jacobi equation (24). Following  [33,38], a regularization procedure for the level set function, which implies a smooth evolution of the shape during the optimization process, is carried out. Once 
                           v
                           =
                           v
                           
                              (
                              x
                              )
                           
                         is computed, solving the stochastic elasticity systems for the state 
                           u
                           =
                           u
                           
                              (
                              x
                              ,
                              ω
                              )
                           
                         and the adjoint state 
                           p
                           =
                           p
                           
                              (
                              x
                              ,
                              ω
                              )
                           
                         and approximating the integrals in the probabilistic space 
                           Ω
                         which appears in (25), the level-set method, as proposed in  [33], applies to this context.

The uncertainties acting in the PDE input data with spatial variations are characterized by random fields. A random field is completely characterized by an infinite number of random variables, which poses a computational challenge. To address this issue, the following assumption is considered:


                        
                           
                              (A4)
                              
                                 Finite dimensional noise: the random input data of (1), i.e. Lamé coefficients and loads, depends on a finite number 
                                    N
                                  of real-valued random variables 
                                    
                                       
                                          
                                             {
                                             
                                                
                                                   Y
                                                
                                                
                                                   n
                                                
                                             
                                             }
                                          
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 .

One choice to fulfill the assumption (A4) is the truncated lognormal Karhunen–Loève (K–L) expansion  [39] of a second-order random field of the form 
                           
                              (26)
                              
                                 a
                                 
                                    (
                                    x
                                    ,
                                    ω
                                    )
                                 
                                 −
                                 
                                    
                                       a
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 exp
                                 
                                    (
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          n
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          n
                                       
                                    
                                    
                                       (
                                       ω
                                       )
                                    
                                    )
                                 
                                 ,
                                 
                                 with
                                 
                                 a
                                 =
                                 μ
                                   or  
                                 λ
                                 ,
                              
                           
                         where 
                           
                              
                                 Y
                              
                              
                                 n
                              
                           
                         are pairwise uncorrelated random variables with zero mean and unit variance, 
                           
                              
                                 a
                              
                              
                                 0
                              
                           
                           ∈
                           
                              
                                 L
                              
                              
                                 ∞
                              
                           
                           
                              (
                              D
                              )
                           
                         such that 
                           
                              
                                 a
                              
                              
                                 0
                              
                           
                           
                              (
                              x
                              )
                           
                           ≥
                           
                           
                              
                                 a
                              
                              
                                 min
                              
                           
                           >
                           0
                         a.e. 
                           x
                           ∈
                           D
                        , and 
                           
                              
                                 γ
                              
                              
                                 n
                              
                           
                         and 
                           
                              
                                 b
                              
                              
                                 n
                              
                           
                         are the eigenvalues and eigenvectors, respectively, of the compact and self-adjoint operator 
                           
                              
                                 ψ
                                 ↦
                                 
                                    
                                       ∫
                                    
                                    
                                       D
                                    
                                 
                                 C
                                 
                                    (
                                    x
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 ψ
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 
                                 d
                                 
                                    
                                       x
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                 ψ
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    D
                                    )
                                 
                                 ,
                              
                           
                         being 
                           C
                           
                              (
                              x
                              ,
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         the correlation function. If the random field is Gaussian, then 
                           
                              
                                 Y
                              
                              
                                 n
                              
                           
                           ∼
                           N
                           
                              (
                              0
                              ,
                              1
                              )
                           
                         are independent and identically distributed standard Gaussian variables. From the theoretical point of view, Gaussian variables cannot be used for modeling the uncertainty of Lamé coefficients. This is due to the lower and upper uniform boundedness condition imposed in (A1). However, in practice a Gaussian variable may be accurately approximated considering its truncation at some large enough lower and upper points. Another choice is to take 
                           
                              
                                 a
                                 
                                    (
                                    x
                                    ,
                                    ω
                                    )
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 +
                                 β
                                 tanh
                                 
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          N
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       ω
                                       )
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           β
                         is a given constant such that 
                           a
                           
                              (
                              x
                              ,
                              ω
                              )
                           
                         lies within the prescribed bounds, and 
                           
                              
                                 U
                              
                              
                                 N
                              
                           
                           
                              (
                              x
                              ,
                              ω
                              )
                           
                         is a truncated K–L expansion of a random field. In addition, some regularity on the eigenfunctions 
                           
                              
                                 b
                              
                              
                                 n
                              
                           
                           
                              (
                              x
                              )
                           
                         should be imposed. In the case of Gaussian random fields with a covariance function continuous in 
                           
                              
                                 D
                              
                              ¯
                           
                           ×
                           
                              
                                 D
                              
                              ¯
                           
                        , the eigenfunctions 
                           
                              
                                 b
                              
                              
                                 n
                              
                           
                           
                              (
                              x
                              )
                           
                         are continuous and bounded in 
                           D
                           ×
                           D
                           [40]. Consequently, the conditions (A1–A3) are satisfied, and thus second-order random fields, in particular Gaussian fields, are allowed to model the uncertainty of 
                           f
                         and 
                           g
                        .

Under the finite dimensional noise assumption (A4), and since the random variables 
                           
                              
                                 
                                    {
                                    
                                       
                                          Y
                                       
                                       
                                          n
                                       
                                    
                                    }
                                 
                              
                              
                                 n
                                 =
                                 1
                              
                              
                                 N
                              
                           
                         are mapped from the sample space 
                           Ω
                         to 
                           R
                        , the variational formulation of (1) can be rewritten as: 
                           
                              (27)
                              
                                 
                                    
                                       ∫
                                    
                                    
                                       Λ
                                    
                                 
                                 ρ
                                 
                                    (
                                    y
                                    )
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       D
                                    
                                 
                                 A
                                 e
                                 
                                    (
                                    u
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    )
                                 
                                 :
                                 e
                                 
                                    (
                                    v
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    )
                                 
                                 
                                 d
                                 x
                                 d
                                 y
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Λ
                                    
                                 
                                 ρ
                                 
                                    (
                                    y
                                    )
                                 
                                 
                                    [
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    f
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    ⋅
                                    v
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    
                                    d
                                    x
                                    +
                                    
                                       
                                          ∫
                                       
                                       
                                          
                                             
                                                Γ
                                             
                                             
                                                N
                                             
                                          
                                       
                                    
                                    g
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    ⋅
                                    v
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    
                                    d
                                    s
                                    ]
                                 
                                 
                                 d
                                 y
                                 ,
                                 
                                 ∀
                                 v
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       ρ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    Λ
                                    ;
                                    
                                       
                                          V
                                       
                                       
                                          D
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           Λ
                           =
                           Y
                           
                              (
                              Ω
                              )
                           
                           ⊂
                           
                              
                                 R
                              
                              
                                 N
                              
                           
                         and 
                           ρ
                           =
                           ρ
                           
                              (
                              y
                              )
                           
                         is the joint probability density function of 
                           Y
                           =
                           
                              (
                              
                                 
                                    Y
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    Y
                                 
                                 
                                    N
                                 
                              
                              )
                           
                        , which is assumed to exist. By a standard localization argument, (27) is equivalent to 
                           
                              (28)
                              
                                 
                                    
                                       ∫
                                    
                                    
                                       D
                                    
                                 
                                 A
                                 e
                                 
                                    (
                                    u
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    )
                                 
                                 :
                                 e
                                 
                                    (
                                    φ
                                    
                                       (
                                       x
                                       )
                                    
                                    )
                                 
                                 
                                 d
                                 x
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       D
                                    
                                 
                                 f
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 ⋅
                                 φ
                                 
                                    (
                                    x
                                    )
                                 
                                 
                                 d
                                 x
                                 +
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             N
                                          
                                       
                                    
                                 
                                 g
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 ⋅
                                 φ
                                 
                                    (
                                    x
                                    )
                                 
                                 
                                 d
                                 s
                                 ,
                                 
                                 ∀
                                 φ
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       D
                                    
                                 
                                 ,
                                 
                                 ρ
                                 −
                                 a
                                 .
                                 e
                                 .
                                   in  
                                 Λ
                                 .
                              
                           
                         Thus, the stochastic boundary-value problem (1) has been transformed into a deterministic PDE system with an 
                           N
                        -dimensional parameter.

The stochastic collocation method leads to a set of uncoupled deterministic sub-problems (28) collocated at some stochastic nodes 
                           
                              
                                 y
                              
                              
                                 k
                              
                           
                           ∈
                           Λ
                        . The shape of the unknown domain 
                           O
                         for each sub-problem is constrained to a bounding box 
                           D
                         tessellated using a fixed grid of finite elements. The fixed grid approximation, also referred as “ersatz material” approach [33], classifies the elements as inside 
                           I
                        , outside 
                           O
                         and boundary 
                           B
                         elements according to their position with respect to the level set function 
                           ψ
                        . (See  [41] for more details.) The Hooke’s law is then modified as 
                           
                              (
                              
                                 
                                    χ
                                 
                                 
                                    e
                                 
                              
                              +
                              Δ
                              
                                 (
                                 1
                                 −
                                 
                                    
                                       χ
                                    
                                    
                                       e
                                    
                                 
                                 )
                              
                              )
                           
                           A
                        , where 
                           Δ
                           =
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 3
                              
                           
                         and 
                           
                              
                                 χ
                              
                              
                                 e
                              
                           
                           =
                        
                        
                           
                              
                                 V
                              
                              
                                 I
                              
                              
                                 e
                              
                           
                           /
                           
                              
                                 V
                              
                              
                                 e
                              
                           
                         is the volume ratio between the volume of element 
                           
                              
                                 V
                              
                              
                                 I
                              
                              
                                 e
                              
                           
                         enclosed by 
                           O
                         and the total volume of element 
                           
                              
                                 V
                              
                              
                                 e
                              
                           
                        . From this point on, 
                           
                              
                                 V
                              
                              
                                 D
                              
                              
                                 h
                              
                           
                         denotes a finite element space approximating the Sobolev space 
                           
                              
                                 V
                              
                              
                                 D
                              
                           
                         introduced in Section  2.1, where 
                           h
                         stands for the size of the spatial mesh. Quadrangular meshes and Lagrange 
                           
                              
                                 Q
                              
                              
                                 1
                              
                           
                         finite elements are used in the experiments of Section  5.

The number of terms required by the K–L expansion in (26) depends on the decay rate of its eigenvalues. The required terms in (26) can lead to unaffordable computational problem when full tensor product rules are used for uncertainty propagation. Conversely, the isotropic sparse grid approaches  [42–44] permit to reduce the number of collocation points keeping the level of accuracy for problems whose random variables weigh equally in the solution. However, the convergence rate is deteriorated for highly anisotropic problems  [44]. This is the case of K–L expansions in which random variables corresponding to large eigenvalues have more influence than those associated to low eigenvalues. In this case, an anisotropic sparse tensor product can lead to highly accurate solutions while reducing drastically the computational requirements. Finally, the level of the quadrature rule used for the numerical approximation of integrals in the probability space should be adaptively chosen as to comply with a prescribed accuracy level.

The numerical approximation in the random domain is performed using the adaptive anisotropic sparse grid collocation method described in [45]. For an integer 
                           ℓ
                           ∈
                           
                              
                                 N
                              
                              
                                 +
                              
                           
                        , called the level, and a vector of weights for the different stochastic directions 
                           
                              β
                           
                           =
                           
                              (
                              
                                 
                                    β
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    β
                                 
                                 
                                    N
                                 
                              
                              )
                           
                        , consider the index set 
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                    
                                    
                                       
                                          β
                                       
                                    
                                 
                                 
                                    (
                                    ℓ
                                    ,
                                    N
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       i
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             N
                                          
                                       
                                       )
                                    
                                    ∈
                                    
                                       
                                          N
                                       
                                       
                                          +
                                       
                                       
                                          N
                                       
                                    
                                    ,
                                    
                                       i
                                    
                                    ≥
                                    
                                       1
                                    
                                    :
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             n
                                          
                                       
                                       −
                                       1
                                       )
                                    
                                    
                                       
                                          β
                                       
                                       
                                          n
                                       
                                    
                                    ≤
                                    ℓ
                                    
                                       
                                          β
                                       
                                       ¯
                                    
                                    }
                                 
                                 ,
                              
                           
                         with 
                           
                              
                                 β
                              
                              ¯
                           
                           ≔
                           
                              
                                 min
                              
                              
                                 1
                                 ≤
                                 n
                                 ≤
                                 N
                              
                           
                           
                              
                                 β
                              
                              
                                 n
                              
                           
                        . Similarly to the isotropic Smolyak quadrature rule  [46], the anisotropic Smolyak quadrature formula applied to a generic function 
                           F
                           :
                           Λ
                           →
                           R
                         is given by 
                           
                              (29)
                              
                                 
                                    
                                       A
                                    
                                    
                                       
                                          β
                                       
                                    
                                 
                                 
                                    (
                                    ℓ
                                    ,
                                    N
                                    )
                                 
                                 F
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          i
                                       
                                       ∈
                                       
                                          
                                             
                                                X
                                             
                                          
                                          
                                             
                                                β
                                             
                                          
                                       
                                       
                                          (
                                          ℓ
                                          ,
                                          N
                                          )
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ⊗
                                    ⋯
                                    ⊗
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                N
                                             
                                          
                                       
                                    
                                    )
                                 
                                 F
                                 ,
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 ⋯
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             r
                                          
                                          
                                             N
                                          
                                       
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   N
                                                
                                             
                                          
                                       
                                    
                                 
                                 F
                                 
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          1
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          N
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                N
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                    
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ⋯
                                 
                                    
                                       w
                                    
                                    
                                       N
                                    
                                    
                                       
                                          
                                             r
                                          
                                          
                                             N
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 Δ
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                              
                           
                           =
                           
                              
                                 Q
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                              
                           
                           −
                           
                              
                                 Q
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                                 −
                                 1
                              
                           
                        , with 
                           
                              
                                 Q
                              
                              
                                 0
                              
                           
                           =
                           0
                        , is a quadrature rule in which the coordinates 
                           
                              
                                 y
                              
                              
                                 n
                              
                              
                                 
                                    
                                       r
                                    
                                    
                                       n
                                    
                                 
                              
                           
                         of the nodes are those for the 1D quadrature formula 
                           
                              
                                 Q
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                              
                           
                         and its associated weights 
                           
                              
                                 w
                              
                              
                                 n
                              
                              
                                 
                                    
                                       r
                                    
                                    
                                       n
                                    
                                 
                              
                           
                         are the difference between those for the 
                           
                              
                                 i
                              
                              
                                 n
                              
                           
                         and 
                           
                              
                                 i
                              
                              
                                 n
                              
                           
                           −
                           1
                         levels. The number of collocation points in 
                           n
                        th direction is denoted by 
                           
                              
                                 R
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        . The numerical experiments presented in Section  5 make use of Gauss–Legendre and Gauss–Hermite 1D-quadrature rules. The vector of weights 
                           
                              β
                           
                         depends on the analyticity properties of the solution 
                           u
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         with respect to 
                           y
                           ∈
                           Λ
                        . For the case of Gaussian random variables  [47,48], the 
                           n
                        th term of the vector 
                           
                              β
                           
                         takes the following form 
                           
                              (30)
                              
                                 
                                    
                                       β
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                       
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   γ
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ‖
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ‖
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   ∞
                                                
                                             
                                             
                                                (
                                                D
                                                )
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         with 
                           
                              (
                              
                                 
                                    γ
                                 
                                 
                                    n
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    n
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                              )
                           
                         the eigenpair in the K–L expansion.

The level 
                           ℓ
                         of the quadrature rule is adaptively chosen as to comply with a prescribed accuracy level 
                           0
                           <
                           ε
                           ≪
                           1
                        . This is done as follows:


                        
                           
                              (i)
                              Calculate the vector of weights 
                                    
                                       β
                                    
                                  according to (30).

Initialize the level 
                                    ℓ
                                    =
                                    1
                                  and a positive, large enough, integer 
                                    
                                       
                                          ℓ
                                       
                                       ¯
                                    
                                 .

Determine the discrete numerical approximation 
                                    
                                       
                                          A
                                       
                                       
                                          
                                             β
                                          
                                       
                                    
                                    
                                       (
                                       ℓ
                                       ,
                                       N
                                       )
                                    
                                    
                                       
                                          J
                                       
                                       
                                          h
                                       
                                    
                                    
                                       (
                                       O
                                       )
                                    
                                 , where 
                                    
                                       
                                          J
                                       
                                       
                                          h
                                       
                                    
                                    
                                       (
                                       O
                                       )
                                    
                                  is the compliance associated to 
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                  (numerical approximation of 
                                    u
                                 ; precisely, 
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                  is obtained by solving, via finite elements, (28) at the stochastic nodes 
                                    
                                       
                                          y
                                       
                                       
                                          k
                                       
                                    
                                  which come from the quadrature rule (29)) and 
                                    
                                       
                                          A
                                       
                                       
                                          
                                             β
                                          
                                       
                                    
                                    
                                       (
                                       ℓ
                                       ,
                                       N
                                       )
                                    
                                    
                                       
                                          J
                                       
                                       
                                          h
                                       
                                    
                                    
                                       (
                                       O
                                       )
                                    
                                  is given by (29), with 
                                    F
                                    =
                                    
                                       
                                          J
                                       
                                       
                                          h
                                       
                                    
                                    
                                       (
                                       O
                                       )
                                    
                                 .

Calculate the norm over 
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       D
                                       )
                                    
                                  of the mean and the variance of 
                                    
                                       
                                          J
                                       
                                       
                                          h
                                       
                                    
                                    
                                       (
                                       O
                                       )
                                    
                                  denoted by 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                
                                                   β
                                                
                                                ,
                                                ℓ
                                                ,
                                                N
                                             
                                             
                                                h
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         
                                                            β
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      ℓ
                                                      ,
                                                      N
                                                      )
                                                   
                                                   
                                                      
                                                         J
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   
                                                      (
                                                      O
                                                      )
                                                   
                                                   ‖
                                                
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   D
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             
                                                V
                                             
                                             
                                                
                                                   β
                                                
                                                ,
                                                ℓ
                                                ,
                                                N
                                             
                                             
                                                h
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         
                                                            β
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      ℓ
                                                      ,
                                                      N
                                                      )
                                                   
                                                   
                                                      
                                                         J
                                                      
                                                      
                                                         h
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      (
                                                      O
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         
                                                            β
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      ℓ
                                                      ,
                                                      N
                                                      )
                                                   
                                                   
                                                      
                                                         J
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            O
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ‖
                                                
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   D
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          .
                                       
                                    
                                 
                              

Calculate the numerical approximation of an enriched solution given by 
                                    
                                       (31)
                                       
                                          
                                             
                                                A
                                             
                                             
                                                
                                                   
                                                      
                                                         β
                                                      
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   ℓ
                                                
                                                
                                                   ̄
                                                
                                             
                                             +
                                             1
                                             ,
                                             N
                                             )
                                          
                                          
                                             
                                                J
                                             
                                             
                                                h
                                             
                                          
                                          
                                             (
                                             O
                                             )
                                          
                                          ,
                                          
                                          with
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                n
                                             
                                          
                                          =
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         β
                                                      
                                                      ,
                                                      
                                                         
                                                            ℓ
                                                         
                                                         ¯
                                                      
                                                      )
                                                   
                                                   −
                                                   1
                                                
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         β
                                                      
                                                      ,
                                                      
                                                         
                                                            ℓ
                                                         
                                                         ¯
                                                      
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      ¯
                                                   
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                  where the maximum index in each direction 
                                    
                                       
                                          I
                                       
                                       
                                          n
                                       
                                    
                                    
                                       (
                                       β
                                       ,
                                       
                                          
                                             ℓ
                                          
                                          ¯
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          max
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                X
                                             
                                             
                                                
                                                   β
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   ℓ
                                                
                                                ¯
                                             
                                             ,
                                             N
                                             )
                                          
                                       
                                    
                                    
                                       {
                                       
                                          
                                             i
                                          
                                          
                                             n
                                          
                                       
                                       }
                                    
                                  is introduced.

Compute the norm over 
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       D
                                       )
                                    
                                  of the mean and the variance of the enriched solution as follows 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                
                                                   
                                                      
                                                         β
                                                      
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                ,
                                                
                                                   
                                                      ℓ
                                                   
                                                   
                                                      ̄
                                                   
                                                
                                                ,
                                                N
                                             
                                             
                                                h
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            ℓ
                                                         
                                                         
                                                            ̄
                                                         
                                                      
                                                      +
                                                      1
                                                      ,
                                                      N
                                                      )
                                                   
                                                   
                                                      
                                                         J
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   
                                                      (
                                                      O
                                                      )
                                                   
                                                   ‖
                                                
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   D
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             
                                                V
                                             
                                             
                                                
                                                   
                                                      
                                                         β
                                                      
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                ,
                                                
                                                   
                                                      ℓ
                                                   
                                                   
                                                      ̄
                                                   
                                                
                                                ,
                                                N
                                             
                                             
                                                h
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            ℓ
                                                         
                                                         
                                                            ̄
                                                         
                                                      
                                                      +
                                                      1
                                                      ,
                                                      N
                                                      )
                                                   
                                                   
                                                      
                                                         J
                                                      
                                                      
                                                         h
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      (
                                                      O
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            ℓ
                                                         
                                                         
                                                            ̄
                                                         
                                                      
                                                      +
                                                      1
                                                      ,
                                                      N
                                                      )
                                                   
                                                   
                                                      
                                                         J
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            O
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ‖
                                                
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   D
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          .
                                       
                                    
                                 
                              

Finally, the level 
                                    ℓ
                                  is increased linearly (from 
                                    ℓ
                                    =
                                    1
                                  to 
                                    ℓ
                                    =
                                    
                                       
                                          ℓ
                                       
                                       
                                          o
                                          p
                                          t
                                       
                                    
                                    ≤
                                    
                                       
                                          ℓ
                                       
                                       ¯
                                    
                                 ) up to the stopping criterion 
                                    
                                       (32)
                                       
                                          max
                                          
                                             {
                                             
                                                
                                                   
                                                      |
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            
                                                               β
                                                            
                                                            ,
                                                            ℓ
                                                            ,
                                                            N
                                                         
                                                         
                                                            h
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     β
                                                                  
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  ℓ
                                                               
                                                               
                                                                  ̄
                                                               
                                                            
                                                            ,
                                                            N
                                                         
                                                         
                                                            h
                                                         
                                                      
                                                      |
                                                   
                                                
                                                
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               ℓ
                                                            
                                                            
                                                               ̄
                                                            
                                                         
                                                         ,
                                                         N
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      |
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            
                                                               β
                                                            
                                                            ,
                                                            ℓ
                                                            ,
                                                            N
                                                         
                                                         
                                                            h
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     β
                                                                  
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  ℓ
                                                               
                                                               
                                                                  ̄
                                                               
                                                            
                                                            ,
                                                            N
                                                         
                                                         
                                                            h
                                                         
                                                      
                                                      |
                                                   
                                                
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               ℓ
                                                            
                                                            
                                                               ̄
                                                            
                                                         
                                                         ,
                                                         N
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             }
                                          
                                          ≤
                                          ε
                                       
                                    
                                  is satisfied.

The resolution of the adjoint problem (14) follows the same stages as for solving the direct problem. After projecting Eq. (14) onto the finite element space 
                           
                              
                                 V
                              
                              
                                 D
                              
                              
                                 h
                              
                           
                        , the resulting equation is collocated at the nodes 
                           
                              
                                 y
                              
                              
                                 k
                              
                           
                         of the random domain 
                           Λ
                         leading to 
                           
                              
                                 
                                    
                                       ∫
                                    
                                    
                                       D
                                    
                                 
                                 A
                                 e
                                 
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          h
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 :
                                 e
                                 
                                    (
                                    
                                       
                                          φ
                                       
                                       
                                          h
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    )
                                 
                                 
                                 d
                                 x
                                 =
                                 −
                                 2
                                 
                                    (
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    f
                                    
                                       (
                                       x
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    
                                    d
                                    x
                                    +
                                    
                                       
                                          ∫
                                       
                                       
                                          
                                             
                                                Γ
                                             
                                             
                                                N
                                             
                                          
                                       
                                    
                                    g
                                    
                                       (
                                       x
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    
                                    d
                                    s
                                    )
                                 
                                 ⋅
                                 
                                    (
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    f
                                    
                                       (
                                       x
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    
                                       
                                          φ
                                       
                                       
                                          h
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    
                                    d
                                    x
                                    +
                                    
                                       
                                          ∫
                                       
                                       
                                          
                                             
                                                Γ
                                             
                                             
                                                N
                                             
                                          
                                       
                                    
                                    g
                                    
                                       (
                                       x
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    
                                       
                                          φ
                                       
                                       
                                          h
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    
                                    d
                                    s
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 u
                              
                              
                                 h
                              
                           
                           
                              (
                              x
                              ,
                              
                                 
                                    y
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         is the numerical approximation of (28), 
                           
                              
                                 p
                              
                              
                                 h
                              
                           
                           
                              (
                              x
                              ,
                              
                                 
                                    y
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         is the solution of the projected equation and 
                           
                              
                                 φ
                              
                              
                                 h
                              
                           
                           
                              (
                              x
                              )
                           
                         are the shape functions in 
                           
                              
                                 V
                              
                              
                                 D
                              
                              
                                 h
                              
                           
                        . Notice that by exploiting the linear nature of tensor 
                           A
                        , the solution of the adjoint problem is as follows 
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       h
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 =
                                 −
                                 2
                                 
                                    
                                       c
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         with 
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       D
                                    
                                 
                                 f
                                 
                                    (
                                    x
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 ⋅
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                 d
                                 x
                                 +
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             N
                                          
                                       
                                    
                                 
                                 g
                                 
                                    (
                                    x
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 ⋅
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                 d
                                 s
                                 .
                              
                           
                        
                     

The use of stochastic collocation methods during the optimization process can notably increase the computational cost. However, these methods are considered embarrassingly parallel because they have no shared state and can be executed in complete isolation. For that reason, stochastic collocation methods become an attractive tool for uncertainty propagation tasks with the advent of High Performance Computing (HPC). Task-level parallelism is used for implementing the resolution of the direct and adjoint state equations at each 
                           
                              
                                 y
                              
                              
                                 k
                              
                           
                           ∈
                           Λ
                         stochastic node in clustering. This is done adopting a Master–Worker Pattern, which permits to perform simultaneous processing across multiple machines or processes via a Master and multiple Workers. The Master creates a set of tasks at each 
                           
                              
                                 y
                              
                              
                                 k
                              
                           
                           ∈
                           Λ
                        , which consist of the resolution of the direct and adjoint states using finite element analysis. The Workers calculate these works in clustering, taking work after work until the set of tasks has been calculated. After receiving all samples at the stochastic nodes, the Master evaluates the statistical moments involved in the objective function and the shape derivative.

The effectiveness of the proposed development for robust shape optimization of continuous structures is evaluated using three benchmarks; in particular, the designs of “beam-to-cantilever”, “electric mast” and “half-wheel” problems. The first two problems aim to optimize a design domain under uncertain loading whereas the last problem is concerned with the optimization under uncertain material properties. These experiments aim to show that the proposed development is able to consider different probability distributions as well as random fields as input uncertain loading and material properties. All the benchmarks make use of a fixed grid of 
                        
                           
                              Q
                           
                           
                              1
                           
                        
                      quadrangular plane stress finite elements with Young’s modulus 
                        E
                        =
                        1
                      and Poisson’s ratio 
                        ν
                        =
                        0.3
                     . The level set function 
                        ψ
                        
                           (
                           t
                           ,
                           x
                           )
                        
                      is discretized at the nodes of such a fixed grid. The Lagrange multiplier and the penalty parameter of the augmented Lagrangian function (12) are initialized heuristically according to 
                        
                           
                              L
                           
                           
                              1
                           
                        
                        =
                        0.1
                        ⋅
                        
                           
                              J
                           
                           
                              
                                 
                                    R
                                 
                                 
                                    α
                                 
                              
                           
                        
                        
                           (
                           O
                           )
                        
                        /
                        
                           
                              V
                           
                           
                              ∗
                           
                        
                      and 
                        
                           
                              L
                           
                           
                              2
                           
                        
                        =
                        
                           abs
                        
                        
                           (
                           0.01
                           ⋅
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                           /
                           
                              
                                 V
                              
                              
                                 ∗
                              
                           
                           )
                        
                     . The resolution of the direct and adjoint state equations at each stochastic node is computed using a cluster with 8 nodes. Such nodes are equipped with 2 Intel Xeon E5-2620 at 2 GHz and 32 GB of RAM memory.

In all the numerical experiments the algorithm stops at the first 
                        n
                        ∈
                        N
                      for which the two following conditions are satisfied: 
                        
                           
                              max
                           
                           
                              1
                              ≤
                              i
                              ≤
                              5
                           
                        
                        
                           {
                           
                              |
                              
                                 
                                    
                                       (
                                       
                                          
                                             J
                                          
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   α
                                                
                                             
                                          
                                          
                                             L
                                          
                                       
                                       )
                                    
                                 
                                 
                                    n
                                 
                              
                              −
                              
                                 
                                    
                                       (
                                       
                                          
                                             J
                                          
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   α
                                                
                                             
                                          
                                          
                                             L
                                          
                                       
                                       )
                                    
                                 
                                 
                                    n
                                    −
                                    i
                                 
                              
                              |
                           
                           ≤
                           0.01
                           
                              
                                 
                                    (
                                    
                                       
                                          J
                                       
                                       
                                          
                                             
                                                R
                                             
                                             
                                                α
                                             
                                          
                                       
                                       
                                          L
                                       
                                    
                                    )
                                 
                              
                              
                                 n
                              
                           
                           }
                        
                      and 
                        
                           |
                           
                              
                                 V
                              
                              
                                 n
                              
                           
                           −
                           
                              
                                 V
                              
                              
                                 ∗
                              
                           
                           |
                        
                        ≤
                        0.005
                     .

The beam-to-cantilever problem consists in the shape optimization of a two-dimensional cantilever under uncertain loading conditions. Such a benchmark is widely used  [10,20,29] to show the effects of uncertain loading in the robust optimal design. The left edge of the cantilever is anchored and a unit force with uncertainty in direction, centered in the horizontal line, is applied at the middle of the right edge. The design domain is a 1×2 rectangle which is tessellated using a 60×120 quadrangular mesh (
                           
                              
                                 h
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 h
                              
                              
                                 2
                              
                           
                           =
                           0.016
                        ). The uncertain loading, the boundary conditions and the tessellation of the design domain are depicted in Fig. 1
                        (a), whereas the initialization of the level-set function is shown in Fig. 1(b).

The configuration and the numerical resolution of the robust shape optimization problem is as follows. The target volume is set to 30% of the initial design domain. The direction 
                           ϕ
                         of the unit-load follows a probabilistic distribution centered at the horizontal line, 
                           ϕ
                           =
                           0
                        , with the deterministic loading state as the mean value 
                           
                              
                                 μ
                              
                              
                                 ϕ
                              
                           
                           =
                           0
                        . The influence of the level of uncertainty on the robust shape design is shown by the consideration of 
                           
                              
                                 σ
                              
                              
                                 ϕ
                              
                           
                           =
                           
                              {
                              π
                              /
                              6
                              ,
                              π
                              /
                              12
                              ,
                              π
                              /
                              24
                              ,
                              π
                              /
                              32
                              ,
                              π
                              /
                              42
                              }
                           
                         standard deviation values. In the same vein, three different probability distributions of 
                           ϕ
                         are considered to study the effect of the skewness of stochastic distribution on the robust shape design; in particular, Gaussian, Uniform and Gumbel probabilistic distributions are evaluated. Non-normal stochastic distributions are transformed into a Gaussian distribution, and then the Gauss–Hermite quadrature rule with a level 
                           ℓ
                           =
                           5
                         is used to obtain the statistical moments of the compliance.

The deterministic optimization required 69 iterations to convergence whereas the robust optimization (for case 
                           α
                           =
                           1
                        ) required 57 iterations to converge. Each iteration of the robust optimization required to solve 5 different occurrences of the state equation, which were performed concurrently at each worker of the cluster. The time per iteration of the robust optimization using 5 workers was 2.568 s, which is very close to the required by the deterministic optimization 2.256 s. The deterministic shape optimization design (classical beam) for the horizontal (
                           ϕ
                           =
                           0
                        ) unit-load is depicted in Fig. 2
                        (a). The robust optimized designs for the minimization of the functional cost 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       R
                                    
                                    
                                       α
                                    
                                 
                              
                              
                                 L
                              
                           
                         are shown from Fig. 2(b) to (f) for various magnitudes of the parameter 
                           α
                        . The resulting robust designs incorporate stiffness in the vertical direction where the uncertain loading is introduced. Higher values of the parameter 
                           α
                        , increasing the weight of the variance in the functional cost, lead to more robust structural designs at the cost of decreasing their optimality. One can observe how the increase in robustness is firstly achieved by means of topology modifications, increasing the redundancy by adding paths to transmit the load to the support, and then by thickening the cantilever members. The trade-off between structural robustness and structural performance is shown in the Pareto front depicted in Fig. 10(a).

The effect of the amount of uncertainty using a Gaussian probability distribution for the direction 
                           ϕ
                         of the unit-load is shown in Fig. 3
                        . This experiment shows the different shape optimal designs of the functional cost 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       R
                                    
                                    
                                       α
                                    
                                 
                              
                              
                                 L
                              
                           
                         for a given value of 
                           α
                        . One can observe how the increment in the uncertainty of the direction 
                           ϕ
                         of the unit-load increases the span between supports and the thickness of members, which increment the vertical stiffness. The effect of the probability distribution used to model the uncertainty of the direction 
                           ϕ
                         of the unit-load is shown in Fig. 4
                        . One can conclude that the modeling of uncertainty using different probability distributions has a notable influence in the optimal design. The robust shape optimization using Gaussian and Uniform distributions for the direction 
                           ϕ
                         of the unit-load leads to symmetric optimal designs, whereas the resulting optimal design using Gumbel distribution for the direction 
                           ϕ
                         is asymmetric by a diversification of the load path in the direction of the skew.

The electric mast benchmark consists in finding the best structural design for a T-shaped design domain where the bottom part of the T-leg is simply-supported and two “symmetric” vertical unit loads (
                           g
                           =
                           1
                        ) are applied in the bottom middle part of T-shafts. The uncertain loading is modeled by introducing horizontal uncertain loads in the points where the vertical unit loads are applied. These horizontal uncertain loads are modeled as independent random variables following a uniform distribution 
                           U
                           
                              (
                              0
                              ,
                              1
                              )
                           
                        . The uncertain loading represents the force applied by the wires on the mast. This problem has also been widely studied in the context of robust topology optimization with different loading conditions. In particular, vertical force perturbations are considered in  [10] whereas lateral force perturbations are considered in  [25].

The uncertain loading, the boundary conditions and the tessellation of the design domain are depicted in Fig. 5
                        (a). The design domain is discretized by 6400 square elements (
                           
                              
                                 h
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 h
                              
                              
                                 2
                              
                           
                           =
                           0.05
                        ). A non-nested quadrature rule whose collocation nodes 
                           
                              
                                 y
                              
                              
                                 k
                              
                           
                         are determined by the roots of Legendre polynomials are used. Due to the symmetry of the design domain and boundary conditions, an isotropic vector of weights 
                           β
                           =
                           
                              [
                              1
                              ,
                              1
                              ]
                           
                         is considered in this problem. The nodes and weights of the isotropic sparse grid are computed adaptively as described in Section  4 with 
                           N
                           =
                           2
                        , 
                           
                              
                                 ℓ
                              
                              
                                 ̄
                              
                           
                           =
                           12
                        , 
                           ε
                           =
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 3
                              
                           
                         and 
                           
                              
                                 ℓ
                              
                              
                                 o
                                 p
                                 t
                              
                           
                           =
                           3
                        . The Sparse grids Matlab toolbox  [49] was used to implement the adaptive sparse grid algorithm presented above. The initialization of the level-set function is shown in Fig. 5(b). The target volume is set to 30% of the initial design domain.

The deterministic optimization required 86 iterations to convergence whereas the robust optimization (for case 
                           α
                           =
                           1
                        ) required 99 iterations to converge. Each iteration of the robust optimization required to solve 13 different occurrences of the state equation, which were performed concurrently at each worker of the cluster. The time per iteration of the robust optimization using 13 workers was 3.945 s, which is slightly greater than the time required by the deterministic optimization 3.512 s. Fig. 6
                        (a) shows the deterministic optimal solution obviating the horizontal uncertain loading and Fig. 6(b–d) depict the robust optimal shapes for several magnitudes of the parameter 
                           α
                         of the cost functional 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       R
                                    
                                    
                                       α
                                    
                                 
                              
                              
                                 L
                              
                           
                        . One can observe how the robust designs differ meaningfully from the deterministic optimal design. The robust designs show a larger span between supports than the deterministic optimal solution. Besides, the material distribution of stochastic designs is further from the symmetry axis than the deterministic optimal solution, which provides a higher lateral stiffness to such robust designs. In the same vein, the number of members of the robust designs is higher than the deterministic design, which diversifies the load paths.

Regarding the robust designs, all of them share the same topology (number of holes). However, the shape of the holes and the thickness of the members are adapted to fulfill the robustness requirements. The increment of the parameter 
                           α
                         causes a redistribution of the material from the T-shafts to the cross bars of the T-leg, which increases the lateral stiffness. Fig. 10(b) shows the Pareto front of the different robust designs balancing the mean and standard deviation of the compliance.

The half-wheel experiment unfolds in the two-dimensional structural configuration shown in Fig. 7
                        (a). The design domain is a bounding box of dimension 16×12 tessellated using a 100×75 fixed grid (
                           
                              
                                 h
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 h
                              
                              
                                 2
                              
                           
                           =
                           0.16
                        ). Such a design domain has a roller support in the bottom right-hand corner and a fixed support in the bottom left-hand corner. A vertical unit load is applied at the center of the bottom edge. The uncertainty in the Young’s modulus is modeled by a 2D lognormal random field through the transformation 
                           
                              (33)
                              
                                 F
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 exp
                                 
                                    (
                                    η
                                    
                                       (
                                       x
                                       )
                                    
                                    +
                                    ξ
                                    
                                       (
                                       x
                                       )
                                    
                                    
                                    U
                                    
                                       (
                                       x
                                       )
                                    
                                    )
                                 
                                 ,
                              
                           
                         with 
                           
                              (34)
                              
                                 
                                    
                                       
                                          η
                                          
                                             (
                                             x
                                             )
                                          
                                          =
                                       
                                       
                                          log
                                          
                                             (
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            1
                                                            +
                                                            
                                                               Var
                                                            
                                                            
                                                               (
                                                               x
                                                               )
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         1
                                                         /
                                                         2
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          ξ
                                          
                                             (
                                             x
                                             )
                                          
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   log
                                                   
                                                      (
                                                      1
                                                      +
                                                      
                                                         Var
                                                      
                                                      
                                                         (
                                                         x
                                                         )
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                             
                                                1
                                                /
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             Var
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   0.0054
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   0.0857
                                                   x
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                         where 
                           η
                           
                              (
                              x
                              )
                           
                         and 
                           ξ
                           
                              (
                              x
                              )
                           
                         are the location and scale parameters of the lognormal distribution. The random field 
                           U
                         is assumed to have zero mean, unit variance and the following isotropic squared exponential correlation function 
                           
                              (35)
                              
                                 C
                                 
                                    (
                                    x
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 =
                                 exp
                                 
                                    [
                                    −
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                         where 
                           x
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           ,
                           
                              
                                 x
                              
                              
                                 ′
                              
                           
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                           ∈
                           D
                         and 
                           l
                           =
                           8
                         is the correlation length. The Gaussian random field 
                           U
                         is discretized through the truncated K–L expansion (26). Fig. 7(c) shows a realization of the lognormal discretized random field 
                           F
                        . According to the decay rate of the eigenvalues, the K–L expansion is truncated at its ninth term to capture 90% of the energy field. Since the considered random variables 
                           
                              
                                 Y
                              
                              
                                 n
                              
                           
                         are Gaussian, a non-nested quadrature rule, whose collocation nodes 
                           
                              
                                 y
                              
                              
                                 k
                              
                           
                         are determined by the roots of Hermite polynomials, are used. The nodes and weights of the anisotropic sparse grid are computed adaptively as described above with 
                           N
                           =
                           9
                        , 
                           
                              
                                 ℓ
                              
                              
                                 ̄
                              
                           
                           =
                           14
                        , 
                           ε
                           =
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 3
                              
                           
                         and 
                           
                              
                                 ℓ
                              
                              
                                 o
                                 p
                                 t
                              
                           
                           =
                           8
                        . The level-set function initialization is depicted in Fig. 7(b). Similarly to previous problems, the target volume is set to 30% of the initial design domain.


                        Table 1
                         shows the values of the maximum indices 
                           
                              I
                           
                           
                              (
                              
                                 β
                              
                              ,
                              ℓ
                              )
                           
                         obtained through the adaptive process for computing 
                           
                              
                                 A
                              
                              
                                 
                                    β
                                 
                              
                           
                           
                              (
                              ℓ
                              ,
                              N
                              )
                           
                        . Additionally, the values of the maximum indices 
                           
                              
                                 
                                    I
                                 
                              
                              
                                 ˆ
                              
                           
                           
                              (
                              
                                 
                                    
                                       β
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    ℓ
                                 
                                 
                                    ̄
                                 
                              
                              +
                              1
                              )
                           
                         for computing the enriched solution are shown. The convergence rate, depicted in Fig. 8
                        , reveals a (sub)-exponential decay of the error as the number of points increases linearly. It also shows that the level, and also the number of points, of the anisotropic sparse grid are governed by the error of the variance of the compliance, which has the slowest rate of convergence.

The deterministic optimization required 148 iterations to convergence whereas the robust optimization (for case 
                           α
                           =
                           1
                        ) required 134 iterations to converge. Each iteration of the robust optimization required to solve 5627 different occurrences of the state equation, which were performed concurrently at each worker of the cluster. The time per iteration of the robust optimization using 96 workers was 121.38 s, which is significantly greater than the 3.15 s required by the deterministic optimization. The optimal designs minimizing the functional cost 
                           
                              
                                 J
                              
                              
                                 
                                    
                                       R
                                    
                                    
                                       α
                                    
                                 
                              
                              
                                 L
                              
                           
                         for several magnitudes of the parameter 
                           α
                         are shown in Fig. 9
                        . One can observe that the structural robustness is increased modifying the topology design. Such topology modifications introduce new elements that diversify the load paths increasing the structural redundancy. This diversification requires increasing the height of the arch for large values of 
                           α
                        . Fig. 10(c) shows the trade-off between the mean and standard deviation for this robust shape structural optimization problem. One can observe that the increment of structural robustness implies a degradation of the structural performance in terms of compliance.

@&#CONCLUSION@&#

This work has presented a stochastic framework to address the robust shape structural optimization problem in the continuous weak form of linear system of elasticity with random input data. Such a framework is therefore not limited by the discretization method. The uncertainty of input data can be modeled using random variables and random fields. The proper stochastic problem formulation is ensured by the proof of the existence of result on the set of admissible shapes. The robust shape optimization process makes use of the analytic expressions for the continuous shape derivatives, which require the resolution of the stochastic linear system of elasticity and its adjoint system. These systems are solved numerically using the sparse grid stochastic collocation finite element method. The parallelization potential of this approach is exploited to efficiently solve problems with relatively large number of random variables. The effectiveness of the proposed approach is verified using benchmarks subjected to loading and material uncertainties, including Gaussian and non-Gaussian uncertainties, as well as random variables and smooth random fields.

@&#ACKNOWLEDGMENTS@&#

This work has been supported by the 19274/PI/14 project, from “Fundación Séneca-Agencia de Ciencia y Tecnología de la Región de Murcia”, and the MTM2013-47053-P project, from “Ministerio de Economía y Competitividad”.

@&#REFERENCES@&#

