@&#MAIN-TITLE@&#Spatio-temporal modeling of roof-top photovoltaic panels for improved technical potential assessment and electricity peak load offsetting at the municipal scale

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present a methodology for improved roof-top PV deployment decision-making.


                        
                        
                           
                           We calculate solar radiation time series for every potential roof-top using FOSS4G.


                        
                        
                           
                           We compare 15min time step PV electricity generation load against local demand.


                        
                        
                           
                           We demonstrate how demand and supply can be matched in small geographical areas.


                        
                        
                           
                           We propose and evaluate strategies for selecting convenient potential PV plants.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Integrated spatial and energy planning

Solar cadastre

Roof-top photovoltaic

Energy balance time series

Open source GIS

@&#ABSTRACT@&#


               
               
                  Integrated spatial and energy planning has become a major field of interest to meet the current renewable energy share expansion and CO2 emissions reduction targets. Geographic Information Systems (GIS) play a considerable role in supporting decision making in this field. Solar potential maps are a popular strategy to promote renewable energy generation through photovoltaic (PV) panel installations at city and municipal scales. They indicate the areas of roofs that would provide the maximum amount of energy in kWh per year. These are often used to suggest “optimal locations” for PV-panels and/or recommend system sizes to achieve a certain level of yearly autarchy. This approach is acceptable if PVs have only a minor share in the local energy supply system. However, increased PV-penetration can lead to instability of the local grid, create hazards for the security of the supply, and considerably escalate the storage and system back-up requirements. To obtain a proper understanding of the consequences for the local energy balance when selecting or rejecting a certain installation, examining the hourly and intra-hourly time series of the potential energy generation from PVs is necessary. This paper introduces a GIS-based procedure to estimate the potential PV-electricity generation time series for every roof-top section within a study area using open source software. This procedure is complemented by a series of strategies to select suitable PV-installations considering the time series analysis of supply and demand. Furthermore, thirteen technical indicators are considered to evaluate the PV-installation sets selected with every strategy. The capabilities of the procedure are tested using data from a German rural municipality. The proposed procedure constitutes an efficient and accessible way to assess solar potentials at the municipal scale and to design roof-top PV exploitation plans, which are more appropriate to fulfill the local energy requirements.
               
            

@&#INTRODUCTION@&#

A shift in the energy supply system from fossil to renewable energy sources requires integration of the spatial and energy planning processes (Stoeglehner, Niemetz, & Kettl, 2011). In contrast to fossil and nuclear energy sources that concentrate high amounts of energy in reduced volume and are found in specific locations, renewable energy sources (RES) can only be obtained in a relatively low energy density and are dispersed throughout the earth’s surface (Biberacher, Gadocha, & Zocher, 2008; Stoeglehner et al., 2011). When replacing fossil sources by RES, space becomes a precious object, not only for residential, commercial, industrial and transport uses but also for the energy supply infrastructure and resource land (Stoeglehner & Narodoslawsky, 2009). Optimal solutions for these requirements can only be found if the problem is treated in a holistic way. Geographic Information Systems (GIS) offer a solution. They have become essential for determining renewable energy potentials and demonstrating their local impacts (Angelis-Dimakis et al., 2011), as the continuously increasing number of GIS-based studies indicates. They assess the energy generation potential of renewable sources considering environmental, technical, economic, social and/or political criteria (Calvert, Pearce, & Mabee, 2013).

Solar potential maps, also called solar cadastres, have become popular tools to promote renewable energy generation through roof-top PV-installations at the city and municipal scales (Agugiaro et al., 2012; Theodoridou, Karteris, Mallinis, Papadopoulos, & Hegger, 2012). In general, these maps provide information about the annual solar irradiation on a surface (kWh/m2/year) and estimate the yearly electricity production from roof-top photovoltaic systems in kWh. The most basic versions are grounded on measurements of the average usable yearly solar radiation in a particular region. The potential areas are the building areas reduced by typical average factors (e.g., average areas of the roof that cannot be used due to the presence of dormers). At the final stage, the total potential energy production is determined by multiplying the remaining area of every building by the amount of solar radiation and an average discount rate to consider the efficiency rates of PV-installations. This type of calculation is prescribed as the minimum requirement for developing municipal energy use plans in Bavaria, Germany (Bayerisches Staatsministerium für Umwelt und Gesundheit, Infrastruktur, & Oberste Baubehörde im Bayerischen Staatsministerium des Innern, 2011). Cities worldwide use digital elevation models gained from LiDAR data and GIS tools. These allow consideration of the shadowing effects of the local topography, near buildings and vegetation in the calculation of the global solar radiation. The most advanced versions provide information including solar-thermal systems, system installation costs, system payback times, potential reduction of CO2 emissions and even the local availability of installers (Kanters, Wall, & Kjellsson, 2014). Furthermore, roof surfaces that are suitable for PV are explicitly shown in online Web-GIS platforms. Thus, building owners can inform themselves quickly and easily about their possibilities for using solar energy. Additionally, the information provided helps public administrations in developing sustainable regional energy supply programs and setting PV-penetration goals.

Although rooftop PVs are the best example of spatial multiple-shift use, their fluctuating power output is a serious disadvantage that has received minor attention in the design of solar cadastres. In many cases, the roof area of single and multi-family houses is suitable for installations, which can produce more power than the internal yearly consumption. PV-electricity is generated without causing any sealing or emissions and with minimal visual impact. However, not all energy produced can be used if the generation time does not match the demand periods. With stand-alone systems, this issue can be solved by installing storage capacity. For grid-connected PV-installations, storage can be installed locally, but the grid itself also serves as storage. The grid relocates the excess production to places with actual demand and provides the required electricity when the PV-system does not generate enough. Yet, there are limits to the amount of energy that can be handled by the grid; most parts of the existent infrastructure are not designed to cope with high amounts of reverse loads (U.S. Department of Energy, 2007). A high PV-penetration level affects the stability of the energy supply and the power quality (Azadian & Radzi, 2013; Paatero & Lund, 2007; Passey, Spooner, MacGill, Watt, & Syngellakis, 2011). Moreover, the temporal gaps of the supply and demand reduce the value of investments and increase the payback time of PV-systems (Orioli & Di Gangi, 2013). This problem is ignored when potential locations are rated by taking only the maximum yearly energy production into account, as is the case with solar cadastres. The consideration of the temporal variability of the electricity generation should be part of the decision making process for adequate levels of PV-penetration in sustainable local and regional energy systems. The adequate level of PV-penetration depends both on the mix of energy sources aspired and the local factors affecting rooftop PV-generation, such as rooftop PV orientation, inclination, share of self-consumption and system costs (Lang, Gloerfeld, & Girod, 2015). Although some methodologies were proposed to assess the roof-top PV-potential based on its spatial and temporal aspects, they are either performed in a low resolution such that very important local factors must be neglected (see e.g., Zeyringer et al., 2013) or they provide a very detailed prediction of PV-generation potentials without addressing the local demand (see e.g., Jakubiec & Reinhart, 2013 and Lukač, Seme, Žlaus, Štumberger, & Žalik, 2014).

Therefore, the methodology is still missing to model the spatial and temporal features of roof-top PV-electricity generation potentials and electricity demand on the local scale so that peak load offsetting and energy storage can be planned on the municipal level. In this paper, we introduce a methodology to fill this gap and apply the data gained to the strategic planning of renewable local energy systems based on open source GIS solutions.

Our approach includes the following steps: first, a procedure to obtain potential PV-electricity generation time series for every roof-top section within a study area is described. Second, three strategies are proposed to select “optimal locations” for roof-top PV-plants using the PV-output time series and considering temporal demand patterns. Third, thirteen technical indicators to evaluate the results of the strategies are presented so that the advantages and disadvantages of every strategy can be discussed and an appropriate roof-top PV-penetration goal can be set.

The paper is structured as follows: In Section 2, we describe the methodology used to generate the electricity demand and PV-output time series for all rooftops in a study area and to analyze them. Section 3 describes the case study where the methodology is tested. The results of the case study are presented in Section 4 and discussed in Section 5. Finally, the last section of the paper is devoted to the conclusions.

@&#METHODOLOGY@&#

The methodology is divided into four subsequent stages (see Fig. 1
                     ). First, a workflow combining several open source GIS and image processing tools is used to estimate the time series of solar radiation hitting the roof-tops of the district’s buildings at every desired time step within a year. Second, these results are the input for a PV-power output model, which delivers the power generation estimations per square meter of installed capacity for every time period. Third, a series of strategies following different optimization criteria are used to constitute sets of PV-panels to fulfill certain shares of the local demand. Fourth, the impact on the local energy balance of the load resulting from the different roof-top PV-sets is evaluated using a pool of thirteen indicators.

The core element of the workflow to calculate the solar radiation time series is the module r.sun of the open-source environment GRASS GIS developed by Hofierka and Šúri (2002). The module can calculate the global, direct, diffuse and/or reflected solar radiation for a certain territory (Hofierka & Šúri, 2002). The module has been widely tested and presents advantages over other well-known GIS based tools. The implemented algorithm delivers more accurate results than the algorithms implemented in other GIS tools (Gueymard, 2012; Ruiz-Arias, Tovar-Pescador, Pozo-Vázquez, & Alsamamra, 2009), and it achieves a good level of accuracy compared with more advanced solar radiation algorithms (Badescu et al., 2013). The further capabilities of r.sun, such as its calculation speed, flexibility and convenient scripting, have been discussed by Jakubiec and Reinhart (2013) and Ruiz-Arias et al. (2009). Examples of the use of r.sun to compute PV-yields in different locations around the world and with different resolutions in the input data can be found in Agugiaro et al. (2012), Hofierka and Kaňuk (2009), Nguyen and Pearce (2010) and Šúri and Hofierka (2004).

The r.sun module includes two different modes: Mode 1 is used to calculate the irradiance or instantaneous energy falling on a unit area per time, and Mode 2 is used to calculate the irradiation or summed amount of solar energy hitting a surface on a certain day (Hofierka & Šúri, 2002). The main input parameters required for r.sun to estimate the solar radiation under the real-sky conditions of a certain study area are
                           
                              (a)
                              A digital elevation model (DEM).

Raster aspect and slope maps.

Linke turbidity factor raster maps.

Raster maps with the beam and diffuse radiation coefficients.

To calculate the irradiance in intra-hourly time steps within a year, Mode 1 must be used. The computational efforts and the data storage capacity requirements can be reduced by avoiding time steps where the solar altitude in relation to the study area is lower than zero – these are the time steps during the night. The input parameters (a) and (b) are generated from the LiDAR data of the study region. The Linke turbidity factor can be obtained for every location in Europe with a monthly temporal resolution from the SoDa data bank (Wald et al., 2002). The beam and diffuse radiation coefficients can be calculated as factors between the measured solar radiation and the estimated solar radiation under clear sky conditions (Hofierka & Šúri, 2002). The measured values for both beam and diffuse radiation can be gathered by decomposing the global radiation measurements from a weather station close to the study area, or they can be directly taken from a suitable meteorological test reference year (TRY) data set (also known as a typical meteorological year –TMY). A TRY represents an average distribution “regarding both the occurrence and the persistence of warm/cold, sunny/overcast and/or dry/wet periods in all months or seasons” (Festa & Ratto, 1993).

The first alternative is interesting in the case that a particular year must be simulated and is common for accuracy assessments of models. TRYs are widely accepted as data sources for the sizing of PV-power plants (Zhou, Lou, Li, Lu, & Yang, 2010) and are therefore selected for the proposed workflow. The denominator of the factor to obtain the beam and diffuse radiation coefficients – the beam and diffuse solar radiation under clear sky conditions – is calculated with r.sun. In this case, only (a)–(c) are required.

The part of the calculation with the highest computational requirements concerns the shadowing effects of surrounding objects. These requirements depend on the size of the study area and the resolution of the DEM. The shadowing effects can be either calculated internally by the module r.sun or pre-computed using the GRASS GIS module r.horizon (in which the horizon height angle in a certain azimuth direction for each raster cell is calculated). When using this additional module, it is possible not only to speed up the calculation of the output maps for every time step but also to reduce the computational time for the whole workflow while improving the accuracy. The reasons for these improvements are twofold. First, although the computation in r.horizon is performed only for the survey area, the surrounding areas can still be considered in the results by defining a buffer. The influence of distant large objects (e.g., mountains and hills) on the study area can be considered using a larger DEM with a lower resolution. Nearby small objects can be incorporated by using a DEM of a higher resolution for the survey area. When using r.sun without pre-computed horizon maps, only one resolution can be set, and no buffer can be defined. As a consequence, the inclusion of distant larger objects will calculate solar radiation for uninteresting areas and will massively increase the required computational time. Second, the module r.sun is run twice for every time step: once to calculate the beam and diffuse solar radiation maps under clear-sky conditions and again to obtain the final results – the global solar radiation maps under real-sky conditions. However, the same pre-computed horizon maps can be used in both cases, and a significant reduction in the computational effort can be achieved.

After calculating the global solar radiation maps under real-sky conditions by applying pre-computed horizon maps and the TRY data set, the radiation values that correspond to the roof-tops in the studied municipality are extracted. This step is performed using the modules PKextract und PKdumpogr in the open source toolkit for geospatial data PKtools (McInerney & Kempeneers, 2015). PKextract requires a raster image with the information that is to be extracted (the global radiation maps) and a vector map where the areas of the image to be extracted are defined (vector maps with the roof-top surfaces classified by their aspect). The output of this module is a vector map with an additional field in the attribute table where the average/sum/proportion/mode or maximum of the extracted values is stored. PKdumpogr exports the new field of the attribute tables in the polygon maps to a text file. These text files are then consolidated into a single file where the time series for a whole year of global solar radiation (for all selected surfaces of the roof-tops) are stored. To consolidate the time series, time steps without calculation of maps (night-times) are completed with zeros.

Finally, a correction factor is included to calculate the actual global solar radiation incident on inclined roofs. Whereas the extraction process is performed using 2D polygons, the solar radiation maps have the same characteristics of the DEM (2.5D grid), and some of the surfaces may be inclined. Raster cells with some inclination represent a larger area than cells with no inclination. The average inclination of the cells that correspond to a certain polygon is also extracted. The area of the polygon and the solar radiation time series are divided by the cosine of the inclination. This factor is used to calculate the actual area represented by the polygon and the actual amount of solar irradiance falling on the roof in every time step.

Though solar global radiation should be considered a main factor when estimating the final yield of a PV-power plant (Šúri, Huld, Dunlop, & Ossenbrink, 2007), it is not the only one. The technical characteristics and operational conditions must also be taken into account to obtain a reasonably accurate result. Almost all city/municipality-wide potential estimations on a yearly basis use constant efficiency factors for PV-modules and inverters. In the best cases, yearly fixed efficiency losses are included to consider the effects of the ambient air temperature on the performance of the PV-modules. The exceptions to the use of constant factors are the works of Jakubiec and Reinhart (2013) and Lukač et al. (2014). These improvements are only possible due to the simulations performed at a higher temporal resolution. Lukač et al. (2014) estimated non-linear efficiency factors for the modules and the inverters based on measured data from a PV-power plant in the city of Maribor, Slovenia. The daily estimations delivered satisfactory results. However, the functions and coefficients fit only the punctual local conditions and require further testing to confirm similar performance in other locations. Jakubiec and Reinhart (2013) increased the temporal resolution to hours and calculated the reduction in the PV-power production due to changes in the ambient air temperature (Tamb
                        ) for every time step. This approach can be used in other locations because only two additional parameters are necessary: a temperature correction factor (αPMPP
                        ), which is normally provided by the module manufacturer, and a reduction factor (kT
                        ) expressing the changes in module performance due to differences in the module’s actual and nominal operating temperatures (T
                        0). kT
                         can be calculated if the irradiance on the cell surface and the air temperature used to determine T
                        0 are known. The values assumed by Jakubiec and Reinhart (2013) are 800W/m2 and 20°C, which are compatible with the kT
                        
                        =0.035°C/(W/m2) used in the PV-GIS web service for free-standing PV-systems and a T
                        0
                        =48°C. kT
                         is, however, higher for building integrated systems because the module temperature is increased by the heat absorbed by the roofs. Jakubiec and Reinhart (2013) take this increment into account by calculating the “urban ambient temperature” as input to estimate the module temperature.

Calculating the urban ambient temperature requires detailed knowledge about the materials of the roofs, which is not always available. To consider this higher temperature, we use kT
                        
                        =0.05°C/(W/m2), as suggested in the PV-GIS web service for building integrated systems (DG Joint Research Center, 2005). Eq. (1) is used to calculate the PV-output at a certain moment. The calculation of the yield for every time step is performed by assuming that the ambient temperature and the global irradiance remain unchanged throughout the time step:
                           
                              (1)
                              
                                 
                                    
                                       P
                                    
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       G
                                    
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 ∗
                                 
                                    
                                       η
                                    
                                    
                                       PV
                                    
                                 
                                 ∗
                                 
                                    
                                       
                                          1
                                          +
                                          
                                             
                                                α
                                             
                                             
                                                PMPP
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         amb
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   /
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   )
                                                   -
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    P
                                 
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                           
                         is the photovoltaic power output of the nth PV-power plant at time step t, 
                           
                              
                                 
                                    G
                                 
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                           
                         is the global irradiance, ηPV
                         is the photovoltaic panel efficiency, αPMPP
                         is the temperature correction factor, 
                           
                              
                                 
                                    T
                                 
                                 
                                    t
                                 
                                 
                                    amb
                                 
                              
                           
                         is the ambient air temperature at time step t, kT
                         is the reduction factor due to installation type, An
                         is the area of the nth PV-plant, and T
                        0 is the nominal operating temperature.

The typical basic indicator to select optimal roof-tops for PV-installations in urban environments is the sum of the solar global radiation per square meter over a year (“MaxYearlyProd”). A higher sum indicates that the location is better, and the amount of produced energy per area unit can thus be maximized. Moreover, when comparing locations, the area required to fulfill a certain yearly demand and the installed capacity can be minimized. This concept relies on the assumption that all of the produced energy can either be used for self-supply or can be sold through the grid. However, this is not necessarily true if PV-penetration is high: if the amount of generated energy is beyond the local demand and the grid capacity, energy curtailment is necessary to avoid instability of the grid and risks for the security of the supply.

To illustrate to what extent a strategy is best-suited for the energy balance of a certain location, we propose three alternative strategies to select locations based on different optimal criteria. The first strategy, “MinVariability”, consists of selecting locations based on the expected variability of a potential PV-system per average square meter. We understand variability as proposed in Hoff and Perez (2010), i.e., variability is the standard deviation of the change in the power output over time. They evaluated the variability of PV-fleets that consist of PV-power plants dispersed in large regions (the distance between plants could be hundreds of kilometers). In the case of municipalities, the major difference in the variability between installations is caused by the orientation and shadowing conditions of every plant and not by different weather conditions. The lower the variability is, the lower are the reserve requirements to meet reliability standards. Furthermore, Hoff and Perez (2010) proposed an equation to evaluate the variability of the whole fleet. To rate single power plants, we adapted the equation as presented in (2):
                           
                              (2)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       Δ
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       Var
                                       
                                          
                                             
                                                Δ
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      Δ
                                                      t
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              Δ
                              
                                 
                                    P
                                 
                                 
                                    Δ
                                    t
                                 
                                 
                                    n
                                 
                              
                           
                         is the time series of changes in supplied power at the potential system n occurring over a time interval of Δt.

The second strategy, “MaxYearlyProdOverMinVar”, rates potential PV-installations based on the factor between the total yearly production 
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             t
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                           
                         and the variability 
                           
                              
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             Δ
                                             t
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        . The higher the yearly production is and/or the lower the variability is, the better a certain location would perform. PV-plant sets selected considering this indicator deliver a balanced electricity output, where every Wh added to the yearly production is de-rated by the amount of variability that the potential PV-plant adds to the resulting load.

The third strategy, “ProperP”, consists of a sequential selection of plants based on the amount of energy that is properly supplied and the amount of excess energy generated during every time step in a year. Properly supplied energy 
                           
                              (
                              
                                 
                                    PrSu
                                 
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                           
                         is defined as the energy that is generated by the PV-plant n at the moment it is required. It is described in Eq. (3). Excess energy 
                           
                              (
                              
                                 
                                    Exc
                                 
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                           
                         is the amount of energy generated beyond the demand by the nth PV plant for every time step according to Eq. (4). To prevent plants from generating high levels of excess energy in a proposed solution, the amount of properly supplied energy is divided by the sum of excess energy for the whole year. This decision criterion is called ProperFn
                         and is presented in Eq. (5). The criterion rates installations based on the fit of their energy generation to the local demand. The larger the value of the criterion is, the better it is. A high value means that the amount of properly supplied energy is high compared to the amount of excess energy. This criterion has a value of 0 if the plant does not contribute to a proper energy supply. To avoid that the equation becomes undefined when the PV-installation is very small compared with the demand, which is the case for the initial selection rounds, the criterion is equal to the sum of properly supplied energy when there is no excess energy. In every selection round, ProperFn
                         is calculated for all of the not-yet-selected potential PV-plants against the remaining local demand. The best rated plant is selected, and the remaining unfulfilled demand is calculated by subtracting the output of the chosen plant. The selection loop continues until a certain desired PV-penetration level is achieved. The PV-plant set resulting from this strategy maximizes the amount of properly delivered energy and minimizes the amount of excess electricity.
                           
                              (3)
                              
                                 
                                    
                                       PrSu
                                    
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   ≥
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   <
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       Exc
                                    
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   >
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   if
                                                   
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   ≤
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       ProperF
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               t
                                                               =
                                                               1
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                         
                                                            
                                                               PrSu
                                                            
                                                            
                                                               t
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               t
                                                               =
                                                               1
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                         
                                                            
                                                               Exc
                                                            
                                                            
                                                               t
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   (
                                                   
                                                      
                                                         Exc
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   >
                                                   0
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            t
                                                            =
                                                            1
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         PrSu
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   (
                                                   
                                                      
                                                         Exc
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   =
                                                   0
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where Dt
                         is the local electricity demand at time step t.

To assess the technical aspects related to the local energy system, thirteen indicators are proposed to assess the PV-installation sets resulting from every strategy (see Table 1
                        ). An economic or environmental analysis is beyond the scope of this work. However, the information delivered by the indicators should bring new understanding about the technical issues that are usually ignored. They allow reduction of the amount of alternatives of PV-installation sets and facilitate the process of finding an optimal PV-penetration objective, as well as an optimal set of PV-installations. The indicators are calculated and juxtaposed in the proposed methodology. The weighting of the indicators has to be done by the local decision makers, planners and stakeholders.

The first indicator is the amount of PV-installations (NPVj
                        ) required in the solution set j to achieve a certain level of PV-penetration. The second indicator is the installed capacity (IkWpj
                        ) measured in kWp and described in Eq. (6):
                           
                              (6)
                              
                                 
                                    
                                       IkWp
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                NPV
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       kWP
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        where kWPn
                         is the installed capacity of the nth PV-plant.

To measure the total variability of a PV combination solution set we use the indicator proposed by Hoff and Perez (2010) as presented in Hoff and Perez (2012) and renamed TVarj
                        :
                           
                              (7)
                              
                                 
                                    
                                       TVar
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       σ
                                    
                                    
                                       Δ
                                       t
                                    
                                    
                                       fleet
                                    
                                 
                                 =
                                 
                                    
                                       Var
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               NPV
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                Δ
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      Δ
                                                      t
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    σ
                                 
                                 
                                    Δ
                                    t
                                 
                                 
                                    fleetj
                                 
                              
                           
                         is the energy generation variability in kWh of the hypothetical fleet composed of the installations of the jth solution set.

A reliable electrical power system has sufficient power to feed the load demand during a certain period. The fourth indicator, the loss of power supply probability (LPSP), is a widely accepted statistic to measure the reliability of hybrid systems (Yang, Lu, & Burnett, 2003). It accounts for the number of time steps during a certain period when the power system is unable to satisfy the load demand (Eq. (8)):
                           
                              (8)
                              
                                 
                                    
                                       LPSP
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             0
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               n
                                                               =
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     NPV
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               t
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                   
                                                
                                                <
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        where T is the number of time steps.

The values of this statistic range between 0 and 1. The desirable value for a system is 0, which means that the demand is satisfied at each time step. A system with an LPSP of 1 is permanently unable to supply sufficient power to meet the demand.

The next indicator, the total unfulfilled demand (TUD), is presented in Eq. (9):
                           
                              (9)
                              
                                 
                                    
                                       TUD
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          0
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         NPV
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                UD
                                             
                                             
                                                t
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    UD
                                 
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                           
                         is the unfulfilled demand considering the supply of the nth plant at time step t. Mathematically, we have
                           
                              (10)
                              
                                 
                                    
                                       UD
                                    
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   <
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   if
                                                   
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   ≥
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Indicators six and seven are the total excess energy (TExc) and total properly supplied electricity (TPrSu). These are calculated similarly to the strategy ProperP but are totalized for a whole solution set, as presented in Eqs. (11) and (12), respectively.
                           
                              (11)
                              
                                 
                                    
                                       TExc
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          0
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         NPV
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Exc
                                             
                                             
                                                t
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       TPrSu
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          0
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         NPV
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                PrSu
                                             
                                             
                                                t
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

To quantify the energy production peaks, the number of time steps is calculated, (a) when the supply is larger than the largest demand (HSDMax) and (b) when the supply exceeds demand by more than a factor 1.5 (HS1.5DMax). These conditions are defined formally in Eqs. (13) and (14):
                           
                              (13)
                              
                                 
                                    
                                       HSDMax
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          0
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            n
                                                            =
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  NPV
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                             
                                          
                                          >
                                          Dmax
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 HS
                                 1.5
                                 
                                    
                                       DMax
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          0
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         NPV
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                P
                                             
                                             
                                                t
                                             
                                             
                                                n
                                             
                                          
                                          >
                                          (
                                          
                                             
                                                1.5
                                             
                                             
                                                ∗
                                             
                                          
                                          Dmax
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

The last four indicators are related to storage capacity. Two of them, the required storage energy capacity (EC) and the required storage power capacity (PC), are used to identify the size that a storage system should have to allow for the exploitation of all of the energy produced by the jth set of PV-installations. The last two indicators, EC
                        ∗ and PC
                        ∗, also show the energy capacity and the power capacity, but in this case, they assume a storage system that makes the best possible use of the installed capacity. EC and PC are calculated using the procedure described in Appendix I in Solomon, Faiman, and Meron (2010). We assume a grid flexibility factor of 1 (all of the energy generated by the PV set is accepted regardless of the back-up capacity that would be required to ensure supply security) and that the only energy loss is due to storage inefficiencies. Solomon, Faiman, and Meron (2012) proposed a formulation to calculate EC
                        ∗ and PC
                        ∗ based on the storage usefulness index (UI), which is defined as “the ratio of energy delivered by storage in a year to the energy capacity of the storage”. The closer this value is to the total number of considered time steps, the better the use of the storage is. A value equal to 50% of the number of time steps indicates that the storage is charged and entirely discharged in the subsequent time step for the whole study period with 100% efficiency. These authors calculated combinations of the PV and storage system sizes to demonstrate that – as far as these combinations do not allow any energy dumping – an EC
                        ∗ can be found that maximizes the UI. However, we start from fixed PV-system sizes that remain unchanged because they are the solution sets of the strategies. The UI for fixed PV-system sizes and variable storage energy capacities compared with different ECs reaches a maximum when the storage is very small. This does not deliver any valuable information about the storage size. To calculate EC
                        ∗ and the respective PC
                        ∗, we added the excess energy as a balancing variable in the calculation of UI, as presented in Eq. (15). A larger amount of discharged energy compared with the amount of excess energy for a certain EC indicates that the EC is better. The EC maximizing UI
                        ∗ is EC
                        ∗, and the PC corresponding to EC
                        ∗ is PC
                        ∗.
                           
                              (15)
                              
                                 
                                    
                                       UI
                                    
                                    
                                       j
                                    
                                    
                                       ∗
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             TDQ
                                          
                                          
                                             j
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             TExc
                                          
                                          
                                             j
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             EC
                                          
                                          
                                             j
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    EC
                                 
                                 
                                    j
                                 
                                 
                                    i
                                 
                              
                           
                         is the ith possible storage energy capacity for the solution set j, which can take values between 0 and EC. 
                           
                              
                                 
                                    TDQ
                                 
                                 
                                    j
                                 
                                 
                                    i
                                 
                              
                           
                         is the total discharged energy from the storage, assuming that ith storage is built for the solution set j. Finally, 
                           
                              
                                 
                                    TExc
                                 
                                 
                                    j
                                 
                                 
                                    i
                                 
                              
                           
                         is the total excess energy from the jth solution set, assuming that the ith storage is installed.

The proposed methodology was tested with data from Waldthurn, a German municipality located in the northeast of Bavaria with 2019 inhabitants and a total area of 30.97km2. Waldthurn is rural and is characterized by a highly diverse topography. The built-up area of the most densely populated part of the municipality comprises an area of 4km2 and 438 residential buildings. The LiDAR data and vector maps for this area were provided by the Bavarian Surveying Agency (2014). The LiDAR data were used to generate a DEM with a resolution of 1m2 per pixel (DEM1) following the procedure explained by Neteler and Mitasova (2008). The DEM1 and the recently released DEM25 of the European Union were used to pre-calculate the horizon maps with a buffer of 230km in every cardinal direction. There are no horizons behind this distance due to the Earth’s curvature (Tabik, Romero, & Zapata, 2011). The values of direct and diffuse solar radiation that are needed to calculate the radiation coefficients were taken from the TRY data set for “region 10” (South-east medium mountains up to 1000m) provided by Deutscher Wetterdienst (2011).

The vector map containing the potentially usable areas was generated from the built-up areas and the DEM1 of the study area. All values stored in the aspect map generated with DEM1 were summarized into six categories: one category including surfaces oriented north, north east and north west is omitted from the further analysis due to the considerably lower expected yearly PV-yield; the five remaining categories are for surfaces oriented east, south east, south, south west and west, respectively. The exact division of the categories based on cardinal degrees, beginning in the north and increasing in the clockwise direction, is presented in Fig. 2
                     . The new aspect raster map with the summarized categories and the built-up areas vector layer were used to generate a new vector layer, where only potentially usable roof areas (with homogeneous orientation) in five different cardinal directions are compiled. Finally, polygons smaller than 15m2 were excluded so that considering objects in roofs, such as dormers and chimneys, could be avoided.

A 64bit AMD LINUX system and a multi-core implementation integrating GRASS GIS 7, PKtools-2.5.1 and Python in a BASH shell script were used to run the workflow to obtain the solar radiation time series. The temporal data framework of GRASS GIS 7 developed by Gebbert and Pebesma (2014) was selected to manage the numerous maps calculated for direct and diffuse radiation under clear-sky conditions and the maps of the factors for direct and diffuse radiation and the global solar radiation maps under real-sky conditions.

Data of an average monocrystalline silicon cell PV-module were employed for the PV-yield calculation: ηPV
                     
                     =0.144, αPMPP
                     
                     =−0.0045, and kT
                     
                     =0.035. The inverter and cable losses amounted to 14%. The ambient air temperatures for every hour in a typical meteorological year were also taken from the TRYs, and the intra-hourly values were interpolated.

In terms of demand, all households in the study area are considered as part of the same grid. This study uses standardized load profiles provided by the VDEW (Verband der Elektrizitätswirtschaft, since 2007 Bundesverband der Energie-und Wasserwirtschaft-BDEW). Applying standardized load profiles for single households can lead to major errors when looking at less than 150 objects. In our case study, we deliver reliable results (the maximum expected deviations are ±10%) because the number of considered households is higher than 400 (Esslinger & Witzmann, 2012). These load profiles consider not only daily but also seasonal variations. The time series are available for a whole year in 15min time steps. The values are normalized for a 1000kWh demand. A total of 3500kWh is assumed as the yearly power demand of every household.

The three strategies and the traditional approach were applied to select PV-sets that would achieve 20%, 40%, 50%, 60%, 80% and 100% PV-penetration. The thirteen indicators were calculated for these solution sets. Additionally, because the strategy ProperP re-calculates the demand in every single selection step (i.e., the selection order changes the selected plants) it is relevant to determine how far the proposed PV-sets change depending on the starting plant at the first selection step. The algorithm of this strategy was re-run for each of the potential plants selected at the first step. The first nine indicators were calculated for all solution sets. The last four indicators, those related to the storage capacity, were calculated only for the PV-sets following the strategies and for the best rating solution of ProperP in each of the previous nine indicators for all PV-penetration levels. The calculations of EC, PC, EC
                     ∗ and PC
                     ∗ assumed a charging and discharging efficiency for the storage technology of 75%, following the assumptions made by Denholm and Margolis (2007) and Solomon et al. (2012) when sizing storage systems for very large PV-systems. Finally, EC
                     ∗ was found with a brute-force search algorithm by increasing the storage energy capacity in 0.01% steps of EC, starting from zero until EC. No heuristics were used to confirm that there is only one possible EC
                     ∗ for every PV-solution set.

@&#RESULTS@&#

A total of 1,137 rooftop surfaces were considered, accounting for an area of 74,791.57m2. The total potential energy yield was 7,466,044kWh per year. This is 5.6 times the total demand of the households (1,316,000kWh). An example of the maps of the global solar radiation under real-sky conditions obtained for a single time step and a section of the study area is presented in Fig. 3
                     . This example includes the polygons used to extract the radiation information.

The first nine indicators for all strategies and all considered penetration levels as a percentage of the total yearly demand are presented in Fig. 4
                     . The results for ProperP, when using every potential plant as the starting point for the algorithm, are the cyan colored solid lines. These results are similar with each other. In almost all indicators, the figure looks as it would given only a single cyan line. The differences between the results can be perceived in the width of the line. For NPV, for example, this line is steadily wider than the lines connecting the results of the other indicators. In general, the results have a wider dispersion for lower penetration levels and become almost equal for high penetration rates.

The last four indicators (EC, EC
                     ∗, PC and PC∗
                     ) for the MaxYearlyProd, MinVariability, MaxYearlyProdOverMinVar and the best rating sets of ProperP for all evaluated penetration levels are presented in Fig. 5
                     . This figure also includes the corresponding state of charge of the storage that allows non energy dumping (S) and the state of charge of the optimally sized storage (S
                     ∗). The first is represented with solid red lines, and the last is represented with solid cyan lines. The S between EC and EC
                     ∗ shows the amount of energy that is to be dumped if a storage of the size EC
                     ∗ is built. A final time series added to this figure shows the difference between the total generated electricity from the PV-installations and the demand (A1). This is represented with a solid blue line. Values of A1 located below 0 are the unfulfilled demand. The difference between S and A1, when A1 is above 0, is the amount of energy that would be dumped at every time step if no storage is built. The change in the scale necessary to present S and EC for penetration levels above 60% in Fig. 5 creates the illusion that all of the other trends are horizontal lines very close to 0.

@&#DISCUSSION@&#

A rooftop PV-potential higher than the local requirements has to be related to the loss of power supply probability (LPSP) and the size of the storage that would be required to make use of all generated electricity. The calculation of the yearly values suggests that the total electricity demand can easily be covered with local solar resources. This is unusual for densely populated cities but normal in rural and suburban locations, such as our case study, where small households live in large single family houses with plenty of available roof area for PV-installations. However, in the absence of storage, the minimum theoretical loss of power supply probability that can be obtained is 0.5221, which corresponds to the time steps in which there is no solar radiation. Independently of the selected strategy, the minimum loss of power supply probability that can be achieved when reaching 100% PV-penetration lies slightly below 0.70. In other words, the output of these PV-system sets is able to entirely fulfill the energy demand only in approximately 30% of the time steps. Furthermore, using all of the produced energy is only possible when a storage system up to 100 times larger than the installed PV-capacity is built. In our analysis, a 100% PV-penetration does not seem plausible; 100% penetration in yearly terms means that in the best-case scenario, the total properly supplied electricity (TPrSu) reaches 43% of the total demand. Moreover, the hours with supply larger than 1.5 times the largest demand (HS1.5DMax) remains above 7.5% for all strategies, and the hours with supply larger than largest demand (HSDMax) are more than 15% of the yearly hour count. A conveniently sized storage system (a size approximately 1.5 times the installed PV-capacity) will allow dumping of at least 20% of the produced energy. These results do not change much for a roof-top PV-penetration of 80%.

Only penetration levels below 60% present better relations between the calculated indicators. When setting a penetration level of 60%, the total properly supplied electricity is 1.6 times the total excess energy (TExc), and the indicator hours with supply larger than the largest demand drop below 10% of the considered time steps. With 50% penetration, the optimal storage size (EC
                     ∗) approaches the installed PV-capacity, and the properly supplied electricity is 33% of the annual demand. For 40% penetration, the very high generation peaks disappear entirely (HS1.5DMax
                     
                     =
                     
                     0), and the required storage energy capacity is at worst 60% larger than the optimal storage size. A 20% penetration level shows the best relation for all indicators but loss of power supply probability. The indicator hours with supply larger than the largest demand is equal to 0; most part of the produced energy is instantly consumed (TPrSu is up to 19% of the yearly demand). The required storage energy capacity is below the installed PV-capacity, independent of the selected strategy, and for ProperP, the optimal storage size is only 18% of the installed capacity. If some larger total excess energy can be tolerated, the next best penetration level is 40%. At a 40% penetration level, the reduction in the loss of power supply probability is 3.6 times larger than at a 20% penetration level. This type of improvement takes place only at this penetration level. The improvements concerning the loss of power supply probability become proportionally lower as the penetration level increases.

The number of PV-installations (NPV), the installed capacity (IkWp) and the total variability (TVar) are indicators that do not provide much information for setting a PV-penetration goal, but they are appropriate to recognize the relevance of using a certain strategy. These indicators change almost directly proportionally to the penetration level. Nevertheless, these are the indicators where the highest differences can be identified between strategies. As expected, the installed capacity is consistently the lowest in all penetration levels when following MaxYearlyProd. MinVariability has the best results for total variability and is closely followed by MaxYearlyProdOverMinVar. The lowest number of PV-installations can be achieved when following ProperP. The only cases in which MaxYearlyProd achieves the best results are for hours with supply larger than the largest demand with 100% PV-penetration and for the required storage energy capacity at 40–100% penetration levels. The other strategies show results up to 15% better for all other indicators not related to storage. ProperP is always better for the optimal storage energy and power capacities. Moreover, for the penetration level of 40%, ProperP has an optimal storage capacity 14% lower than MaxYearlyProd. When the penetration level is 20%, this difference reaches 35%, in favor of ProperP. For higher penetration levels, this advantage remains below 5%.

This analysis based on technical indicators suggests that the idea of maximizing the yearly production in a municipality should be re-evaluated, if – depending on the local conditions – a penetration level higher than 40% is to be pursued. Following ProperP and setting a roadmap for optimized PV-installations in a municipality imagined as a single power plant can reduce the total back-up and storage requirements and enhance the technical efficiency of the local energy system.

@&#CONCLUSIONS@&#

Solar cadastres are a valuable tool for promoting roof-top PV-installations among the inhabitants of cities and municipalities. They are also used to calculate local PV-potentials and to support the development of regional energy supply programs to expand the penetration of renewable energy in the energy matrix. The methods, tools and data used to produce the solar maps have been improved. However, there is an important factor that is still missing. They do not offer information about the temporal variability of solar resources and their consequences on the local energy system.

This paper presented a methodology to gain time series of roof-top PV-potential using well-known open source GIS tools. The requirements in terms of input data are barely more demanding than is normally necessary to produce solar cadastres with summarized yearly information. Furthermore, the accuracy of the prediction is expected to increase because the reduction factor for the PV-electricity generation due to modules/surface temperature can be considered for every time step.

The methodology has been applied to data from a German rural municipality. There is a vast difference between the conclusions that could be made from examinations of the yearly and intra-hourly values of the energy generation potential. When analyzing time series, the amount of energy that can actually be exploited is only a minimum fraction of the total yearly potential. Trying to force the PV-penetration beyond 60% of the yearly demand would mean either dumping most part of the generated energy or building storage capacity many times larger than the installed PV-capacity. Only penetration levels below 40% would allow most of the energy to be consumed. Setting an optimal penetration level goal for a municipality depends on additional specific local technical and economic factors that are not considered here. However, using the proposed procedure contributes to concretizing the limits of technical possibility and meaningfulness.

It is usual to consider that the optimal roofs-tops for PV-installations are those receiving the maximum amount of solar global radiation per year. We proposed three strategies for rating PV-panels that illustrate to what extent this is true when considering all potential roof-top areas in the same grid. Even in a limited geographic area, where climatic differences between PV-installation locations do not play a role, there are combinations of roof-top PV-installations that can deliver better results than the combination selected when maximizing the energy production. It is possible to deliver more energy when it is actually required. It is also possible to reduce the over-production peaks and the required back-up and storage capacities for the whole area. The only drawback is the increment of required installed capacity. The analysis should be extended to further technical, economic and environmental factors to find an optimal strategy. Nevertheless, for penetration levels up to 40% and locations sharing similar conditions with our case study, the proposed strategy ProperP could bring a series of important advantages.

Future research should include improvements in the resolution of the digital elevation model and the consideration of a period of time longer than a year. These considerations will increase the confidence in the conclusions that can be made from the methodology. On the other hand, further RES and back-up technologies, not only for electricity generation but also for heating and warm water, should be included in the analysis at the same detail as we have proposed for PV. This will serve to evaluate the complementarity between energy sources and to properly define RES penetration goals.

Finally, PV-plants are not only built on rooftops with the maximum amount of expected energy production per year. In most locations, the public interest is to increase the PV-share, and the interest of private householders is to build plants that generate profit. There is not a specific strategy that is being followed. Setting an adequate penetration objective and having a concrete plan to achieve it, can, however, contribute to shaping the local energy system sustainably and to optimizing the use of space. Policy makers need tools to propose a roadmap and to make private householders aware of the actual effects that their potential installations cause in the local system. This is a precondition to make realistic economic evaluations of planned investments. Solar cadastres that also take the temporal variability of the energy generation potential into account are an important step to satisfy these requirements. The proposed methodology is a way to gain this information by using well-established open source GIS tools.

@&#ACKNOWLEDGMENT@&#

This research was developed in the project “Spatial Energy Manager” funded by the program “IngenieurNachwuchs des BMBF”, Germany (Grant number 03FH00712).

@&#REFERENCES@&#

