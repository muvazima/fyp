@&#MAIN-TITLE@&#Bicubic hierarchical B-splines: Dimensions, completeness, and bases

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We explore the topologic explanation of the dimension formula.


                        
                        
                           
                           The configuration of the T-mesh has been given to guarantee the completeness.


                        
                        
                           
                           We construct a basis.


                        
                        
                           
                           Some elementary applications have been given.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Spline spaces over T-meshes

Completeness

Basis

@&#ABSTRACT@&#


               
               
                  In this paper, we discuss the bicubic 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      spline spaces over hierarchical T-meshes in detail. The topological explanation of the dimension formula is further explored. We provide three necessary conditions for the completeness of the spline spaces. Based on the three conditions, the rule of the refinement of the hierarchical T-mesh is given, and a basis is constructed. The basis functions are linearly independent and complete, which provides a solution for the defects in the former literature.
               
            

@&#INTRODUCTION@&#

Splines, which can be adaptively locally refined, are an effective tool for both surface modeling and isogeometric analysis. Because of the special structure of T-mesh, adaptive local refinement is possible for splines defined on this type of mesh. The study of this type of splines appeared early. In 1988, hierarchical B-splines (Forsey and Bartels, 1988) were introduced by Forsey and Bartels. With the advent of isogeometric analysis, the study of this type of splines has increased.

In 2003, Sederberg et al. (2003) introduced T-splines. T-splines are a useful tool in surface modeling (Sederberg et al., 2004, 2008), and they have been used in isogeometric analysis (Bazilevs et al., 2010; Dorfel et al., 2010). However, in 2010, Buffa et al. (2010) discovered that the blending functions of T-splines are linearly dependent on some special T-meshes. Li et al. (2012), Li and Scott (2014) introduced analysis-suitable T-Splines (ASTS) to solve this problem. However, because of the refinement rule of T-splines, they act badly in the locality of the refinement (Dorfel et al., 2010). Therefore, researchers have begun to pay attention to other splines defined on T-meshes for isogeometric analysis.

PHT-splines (Deng et al., 2008), which usually refer to bicubic 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      polynomial splines defined on hierarchical T-meshes, have been used both in surface modeling (Li et al., 2007; Wang et al., 2011a) and isogeometric analysis (Nguyen-Thanh et al., 2011a, 2011b; Wang et al., 2011b). The main drawback of PHT-splines is that they are only 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      continuous, which restricts their applications somewhere. For example, in geometric modeling, 
                        
                           
                              G
                           
                           
                              2
                           
                        
                      continuity is required usually. In 2013, a new type of splines, LR-splines (Dokken et al., 2013), was constructed, and they have been used in IGA (Johannessen et al., 2014). However, their linear independence cannot be guaranteed. In Dokken et al. (2013), the authors provide some strategies to solve this problem. Hierarchical B-splines are also used in isogeometric analysis (Vuong et al., 2011). For the partition of unity, THB-splines are introduced in Giannelli et al. (2012). Because hierarchical B-splines are generated directly from the T-meshes rather than the spline spaces, the completeness cannot be guaranteed generally. Therefore, several articles (Berdinsky et al., 2014, 2015; Giannelli and Jüttler, 2013; Mokriš et al., 2014; Mokriš and Jüttler, 2014) were published to discuss this question.

However, these discussions are somewhat complex, and the rules that guarantee the completeness demand many additional cells to be refined beyond the ones we actually need. Actually, the choice of the basis functions of the traditional hierarchical B-splines leads to the incompleteness. In Fig. 1
                     , we show the procedure of generating a hierarchical T-mesh 
                        T
                      with the dyadic refinement in Giannelli et al. (2012), Vuong et al. (2011). There is a tensor-product B-spline defined on the tensor-product submesh consisting of the red lines. However, this B-spline is not considered in Giannelli et al. (2012), Vuong et al. (2011). Therefore, the hierarchical B-spline space is not complete in this simple hierarchical T-mesh. We believe adding this B-spline is reasonable.

In this paper, we consider this question directly from the spline spaces. As we know, cubic splines are the most considerable splines in both theory (Deng et al., 2008; Li et al., 2012; Li and Scott, 2014) and applications (Bai and Wang, 2010; Desquilbeta and Mariottib, 2010; Li, 2012; Mohanty and Gopal, 2011). We focus on the bicubic 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      spline spaces over hierarchical T-meshes in this paper as well. This question has been discussed preliminarily in Wu et al. (2012). In that paper, the T-mesh is a special hierarchical T-mesh denoted by 
                        
                           
                              T
                           
                           
                              3
                              ,
                              3
                           
                        
                      and a basis function may be the sum of several tensor-product B-splines. In this paper, the hierarchical T-mesh is more general and all of the basis functions are tensor-product B-splines. Unlike the traditional hierarchical B-splines in Vuong et al. (2011), the basis functions concerned include the B-splines we discussed in the last paragraph. We explore the topological explanation of the dimension formula of bicubic 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      spline spaces, which also cues the completeness of the traditional hierarchical B-splines. We give three rules of refinement to guarantee the completeness, and a basis is constructed.

The remainder of this paper consists of eight sections. In Section 2, we review the definitions and some results regarding T-meshes and spline spaces over T-meshes. Then, we review the dimension formula of bicubic 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      spline spaces over hierarchical T-meshes. In Section 4, the topological explanation of the dimension formula is further explored and the rules of refinement are elaborated. The basis is constructed in Section 5. In Section 6, we compare the new splines with HB-splines and T-splines. We give the proof of the linear independence in Section 7. Section 8 provides a number of applications. We end the paper with conclusions and future work in Section 9.


                        
                           Definition 2.1
                           Given two finite strictly increasing sequences of numbers 
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                                 }
                                 ,
                                 {
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       n
                                    
                                 
                                 }
                              , we obtain mn vertices 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                               
                              
                                 (
                                 1
                                 ⩽
                                 i
                                 ⩽
                                 m
                                 ,
                                 1
                                 ⩽
                                 j
                                 ⩽
                                 n
                                 )
                               in 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                              , where the coordinate of 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                               is 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 )
                              . Connecting 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                               and 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       +
                                       1
                                       ,
                                       j
                                    
                                 
                               
                              
                                 (
                                 1
                                 ⩽
                                 i
                                 ⩽
                                 m
                                 −
                                 1
                                 )
                               with line segment, and connecting 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                               and 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       j
                                       +
                                       1
                                    
                                 
                               
                              
                                 (
                                 1
                                 ⩽
                                 j
                                 ⩽
                                 n
                                 −
                                 1
                                 )
                               with line segment, we obtain a mesh, which is called a tensor-product mesh.

A T-mesh is a rectangular grid that allows T-junctions.


                        
                           Definition 2.2
                           (See Deng et al., 2006, 2013.) Suppose 
                                 T
                               is a set of axis-aligned rectangles and the intersection of any two distinct rectangles in 
                                 T
                               either is empty or consists of points on the boundaries of the rectangles. Then, 
                                 T
                               is called a T-mesh. Furthermore, if the entire domain occupied by 
                                 T
                               is a rectangle, 
                                 T
                               is called a regular T-mesh. If some edges of 
                                 T
                               also form a T-mesh 
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                              , 
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                               is called a submesh of 
                                 T
                              .

In this paper, we only consider regular T-meshes. The definitions of vertex, edge and cell are the same as in Deng et al. (2006). A T-junction is a vertex of one rectangle that lies in the interior of an edge of another rectangle. A crossing-vertex is a vertex of four rectangles. An l-edge is a line segment that consists of several edges. It is the longest possible line segment, the interior edges of which are connected and the two end points are T-junctions or boundary vertices. If an l-edge consists of some boundary edges, then it is called a boundary l-edge; otherwise, it is called an interior l-edge. Apparently, a regular T-mesh has four boundary l-edges.

A hierarchical T-mesh (Deng et al., 2008) is a special type of T-mesh that has a natural level structure. It is defined recursively. Generally, we start from a tensor-product mesh 
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                        , which can be non-uniform and the elements (vertices, edges, cells and l-edges) of which are called the level 0 elements. Then, some cells at level k are each divided into 
                           2
                           ×
                           2
                         subcells equally, where the new vertices, the new edges, the new cells and the new l-edges are of level 
                           k
                           +
                           1
                        , and the resulting T-mesh is called 
                           
                              
                                 T
                              
                              
                                 k
                                 +
                                 1
                              
                           
                        . Continuing this process several times, finally, we obtain a T-mesh 
                           T
                        , which is called a hierarchical T-mesh. Fig. 2
                         illustrates the process of generating a hierarchical T-mesh.

For a hierarchical T-mesh 
                           T
                        , when 
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                         is given, the maximal level number of the cells is called the level of the hierarchical T-mesh, which is denoted by 
                           
                              lev
                           
                           (
                           T
                           )
                        . Conversely, if 
                           
                              lev
                           
                           (
                           T
                           )
                         is given, 
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                         is also determined.

We use 
                           
                              
                                 T
                              
                              
                                 k
                              
                           
                         to denote the set of all of the level k l-edges. The set 
                           
                              
                                 T
                              
                              
                                 k
                              
                           
                         
                        
                           (
                           k
                           ⩾
                           1
                           )
                         can be divided into several subsets, 
                           
                              
                                 T
                              
                              
                                 k
                                 ,
                                 1
                              
                           
                           ,
                           
                              
                                 T
                              
                              
                                 k
                                 ,
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 T
                              
                              
                                 k
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        , such that the l-edges of 
                           
                              
                                 T
                              
                              
                                 k
                                 ,
                                 i
                              
                           
                         do not intersect with the l-edges of 
                           
                              
                                 T
                              
                              
                                 k
                                 ,
                                 j
                              
                           
                        , where 
                           i
                           ,
                           j
                           ∈
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           
                              
                                 m
                              
                              
                                 k
                              
                           
                           }
                         and 
                           i
                           ≠
                           j
                        . The subset 
                           
                              
                                 T
                              
                              
                                 k
                                 ,
                                 r
                              
                           
                         is called a connected component of 
                           
                              
                                 T
                              
                              
                                 k
                              
                           
                        , 
                           r
                           ∈
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           
                              
                                 m
                              
                              
                                 k
                              
                           
                           }
                        . For any l-edge l of 
                           
                              
                                 T
                              
                              
                                 k
                              
                           
                         
                        
                           (
                           k
                           ⩾
                           1
                           )
                         and any cell c of level 
                           k
                           −
                           1
                        , if 
                           l
                           ∩
                           c
                         is a line segment, we say l 
                        crosses 
                        c. We use 
                           N
                           (
                           l
                           )
                         to denote the number of cells of level 
                           k
                           −
                           1
                         that l crosses. For the convenience of the following discussion, we set 
                           N
                           (
                           l
                           )
                           =
                           +
                           ∞
                         for the l-edge l of level 0. In a hierarchical T-mesh which has more than one cell, at least one of the four vertices of a cell is a crossing-vertex. For a given crossing-vertex v, there are four cells 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 4
                              
                           
                         surrounding v. Suppose the smallest level number of the four cells is n. We call the level n cells of 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 4
                              
                           
                         the adjacent cells of v.

In Fig. 3
                        , 
                           T
                         is a hierarchical T-mesh and 
                           
                              lev
                           
                           (
                           T
                           )
                           =
                           1
                        ; 
                           
                              
                                 T
                              
                              
                                 1
                              
                           
                         has only one connected component; 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                         are the adjacent cells of 
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                         is the adjacent cell of 
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 c
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 5
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 6
                              
                           
                         are the adjacent cells of 
                           
                              
                                 v
                              
                              
                                 3
                              
                           
                        , and 
                           
                              
                                 c
                              
                              
                                 7
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 8
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 9
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 10
                              
                           
                         are the adjacent cells of 
                           
                              
                                 v
                              
                              
                                 4
                              
                           
                        ; 
                           N
                           (
                           
                              
                                 l
                              
                              
                                 1
                              
                           
                           )
                           =
                           2
                         and 
                           N
                           (
                           
                              
                                 l
                              
                              
                                 2
                              
                           
                           )
                           =
                           3
                         for the two l-edges 
                           
                              
                                 l
                              
                              
                                 1
                              
                           
                         (between 
                           
                              
                                 v
                              
                              
                                 5
                              
                           
                         and 
                           
                              
                                 v
                              
                              
                                 6
                              
                           
                        ) and 
                           
                              
                                 l
                              
                              
                                 2
                              
                           
                         (between 
                           
                              
                                 v
                              
                              
                                 7
                              
                           
                         and 
                           
                              
                                 v
                              
                              
                                 8
                              
                           
                        ).

Given a T-mesh 
                           T
                        , we use Ω to denote the region occupied by all of the cells in 
                           T
                        , which is called the domain of 
                           T
                        . In Deng et al. (2006), the following spline space definition is proposed:
                           
                              
                                 S
                                 (
                                 m
                                 ,
                                 n
                                 ,
                                 α
                                 ,
                                 β
                                 ,
                                 T
                                 )
                                 :
                                 =
                                 
                                    
                                       {
                                       f
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       ∈
                                       
                                          
                                             C
                                          
                                          
                                             α
                                             ,
                                             β
                                          
                                       
                                       (
                                       Ω
                                       )
                                       :
                                       f
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       |
                                    
                                    
                                       ϕ
                                    
                                 
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       m
                                       n
                                    
                                 
                                 ,
                                 ∀
                                 ϕ
                                 ∈
                                 T
                                 }
                                 ,
                              
                           
                         where 
                           
                              
                                 P
                              
                              
                                 m
                                 n
                              
                           
                           =
                           {
                           p
                           (
                           x
                           ,
                           y
                           )
                           :
                           p
                           (
                           x
                           ,
                           y
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 0
                              
                              
                                 m
                              
                           
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 0
                              
                              
                                 n
                              
                           
                           
                              
                                 c
                              
                              
                                 i
                                 j
                              
                           
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           
                              
                                 y
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 i
                                 j
                              
                           
                           ∈
                           R
                           }
                        , 
                           
                              
                                 C
                              
                              
                                 α
                                 ,
                                 β
                              
                           
                         is the space consisting of all of the bivariate functions continuous in Ω with order α along the x-direction and with order β along the y-direction, and that 
                           ϕ
                           ∈
                           T
                         means ϕ is a cell of 
                           T
                        . It is obvious that 
                           S
                           (
                           m
                           ,
                           n
                           ,
                           α
                           ,
                           β
                           ,
                           T
                           )
                         is a linear space. In this paper, we only discuss 
                           S
                           (
                           3
                           ,
                           3
                           ,
                           2
                           ,
                           2
                           ,
                           T
                           )
                        , which is denoted as 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                           (
                           T
                           )
                         for convenience.

For a T-mesh 
                           T
                         of 
                           S
                           (
                           m
                           ,
                           n
                           ,
                           m
                           −
                           1
                           ,
                           n
                           −
                           1
                           ,
                           T
                           )
                        , we can obtain an extended T-mesh in the following fashion. Produce a tensor-product mesh 
                           M
                         with 
                           2
                           (
                           m
                           +
                           1
                           )
                         vertical lines and 
                           2
                           (
                           n
                           +
                           1
                           )
                         horizontal lines, the central rectangle of which is identical to the region occupied by 
                           T
                        . Then extend the edges with one end point on the boundary of 
                           T
                         to the boundary of 
                           M
                        . The resulting mesh, which is denoted by 
                           
                              
                                 T
                              
                              
                                 ε
                              
                           
                        , is called the extended T-mesh of 
                           T
                         associated with 
                           S
                           (
                           m
                           ,
                           n
                           ,
                           m
                           −
                           1
                           ,
                           n
                           −
                           1
                           ,
                           T
                           )
                        . Fig. 4
                         is an example of the extended T-mesh.

A spline space over a given T-mesh 
                           T
                         with homogeneous boundary conditions is defined by Deng et al. (2013)
                        
                           
                              
                                 
                                    S
                                    ‾
                                 
                                 (
                                 m
                                 ,
                                 n
                                 ,
                                 α
                                 ,
                                 β
                                 ,
                                 T
                                 )
                                 :
                                 =
                                 
                                    
                                       {
                                       f
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       ∈
                                       
                                          
                                             C
                                          
                                          
                                             α
                                             ,
                                             β
                                          
                                       
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       :
                                       f
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       |
                                    
                                    
                                       ϕ
                                    
                                 
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       m
                                       n
                                    
                                 
                                 ,
                                 ∀
                                 ϕ
                                 ∈
                                 T
                                 ,
                                 
                                 and
                                 
                                 f
                                 
                                    
                                       |
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                       ∖
                                       Ω
                                    
                                 
                                 ≡
                                 0
                                 }
                                 ,
                              
                           
                         where 
                           
                              
                                 P
                              
                              
                                 m
                                 n
                              
                           
                           ,
                           Ω
                         and 
                           
                              
                                 C
                              
                              
                                 α
                                 ,
                                 β
                              
                           
                         are defined as before. One important observation in Deng et al. (2013) is that the two spline spaces 
                           S
                           (
                           m
                           ,
                           n
                           ,
                           m
                           −
                           1
                           ,
                           n
                           −
                           1
                           ,
                           T
                           )
                         and 
                           
                              S
                              ‾
                           
                           (
                           m
                           ,
                           n
                           ,
                           m
                           −
                           1
                           ,
                           n
                           −
                           1
                           ,
                           
                              
                                 T
                              
                              
                                 ε
                              
                           
                           )
                         are closely related.


                        
                           Theorem 2.3
                           
                              (See 
                              
                                 Deng et al., 2013
                              
                              .) Given a T-mesh 
                              
                                 T
                              
                              , let 
                              
                                 
                                    
                                       T
                                    
                                    
                                       ε
                                    
                                 
                               
                              be the extended T-mesh associated with 
                              
                                 S
                                 (
                                 m
                                 ,
                                 n
                                 ,
                                 m
                                 −
                                 1
                                 ,
                                 n
                                 −
                                 1
                                 ,
                                 T
                                 )
                              
                              . Then
                              
                                 
                                    
                                       S
                                       (
                                       m
                                       ,
                                       n
                                       ,
                                       m
                                       −
                                       1
                                       ,
                                       n
                                       −
                                       1
                                       ,
                                       T
                                       )
                                       =
                                       
                                          S
                                          ‾
                                       
                                       (
                                       m
                                       ,
                                       n
                                       ,
                                       m
                                       −
                                       1
                                       ,
                                       n
                                       −
                                       1
                                       ,
                                       
                                          
                                             T
                                          
                                          
                                             ε
                                          
                                       
                                       )
                                       
                                          
                                             |
                                          
                                          
                                             Ω
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       dim
                                       ⁡
                                       S
                                       (
                                       m
                                       ,
                                       n
                                       ,
                                       m
                                       −
                                       1
                                       ,
                                       n
                                       −
                                       1
                                       ,
                                       T
                                       )
                                       =
                                       dim
                                       ⁡
                                       
                                          S
                                          ‾
                                       
                                       (
                                       m
                                       ,
                                       n
                                       ,
                                       m
                                       −
                                       1
                                       ,
                                       n
                                       −
                                       1
                                       ,
                                       
                                          
                                             T
                                          
                                          
                                             ε
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           

With the above theorem, to consider the spline space over a T-mesh, we need only to consider the corresponding spline space with homogeneous boundary conditions over its extended T-mesh. In this paper, we only discuss the spline space 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                           (
                           T
                           )
                         with homogeneous boundary conditions, which is denoted by 
                           
                              
                                 
                                    S
                                    ‾
                                 
                              
                              
                                 3
                              
                           
                           (
                           T
                           )
                        .


                     
                        Definition 3.1
                        Given a hierarchical T-mesh 
                              T
                            with 
                              
                                 lev
                              
                              (
                              T
                              )
                              ⩾
                              1
                           , suppose 
                              
                                 
                                    T
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              (
                              i
                              ,
                              j
                              ⩾
                              1
                              )
                            is a connected component. If 
                              
                                 
                                    T
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                            only divides the 
                              2
                              ×
                              2
                            neighbor cells in 
                              
                                 
                                    T
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                            (Fig. 5
                           ), we call 
                              
                                 
                                    T
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                            a minimal connected component.


                     
                        Theorem 3.2
                        
                           (See 
                           
                              Zeng et al., 2015
                           
                           .) Suppose 
                           
                              T
                            
                           is a hierarchical T-mesh with 
                           
                              
                                 
                                    V
                                 
                                 
                                    +
                                 
                              
                            
                           crossing-vertices and E interior l-edges, 
                           
                              
                                 lev
                              
                              (
                              T
                              )
                              =
                              n
                           
                           , any l-edge t satisfies 
                           
                              N
                              (
                              t
                              )
                              ⩾
                              2
                           
                           , and there are 
                           
                              
                                 
                                    δ
                                 
                                 
                                    4
                                    i
                                 
                              
                            
                           minimal connected components in 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                            
                           (
                           
                              i
                              ⩾
                              1
                           
                           ), where 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                            
                           is the set of all of the level i l-edges (see Section 
                           
                              2.1
                           
                           ). Let 
                           
                              
                                 
                                    δ
                                 
                                 
                                    4
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    δ
                                 
                                 
                                    4
                                    i
                                 
                              
                           
                           . If 
                           
                              
                                 
                                    T
                                 
                                 
                                    0
                                 
                              
                            
                           has at least 4 horizontal l-edges and 4 vertical l-edges, then
                           
                              
                                 
                                    dim
                                    ⁡
                                    
                                       
                                          
                                             S
                                             ‾
                                          
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    T
                                    )
                                    =
                                    
                                       
                                          V
                                       
                                       
                                          +
                                       
                                    
                                    −
                                    2
                                    E
                                    +
                                    4
                                    +
                                    
                                       
                                          δ
                                       
                                       
                                          4
                                       
                                    
                                    .
                                 
                              
                           
                        

In the following, the hierarchical T-mesh 
                        T
                      we discuss satisfies that 
                        
                           
                              T
                           
                           
                              0
                           
                        
                      has at least 4 horizontal l-edges and 4 vertical l-edges.

In Deng et al. (2013), the following definition is introduced to propose a topological explanation to the dimension formulae. 
                        Definition 3.3
                        (See Deng et al., 2013.) Given a hierarchical T-mesh 
                              T
                           , retaining all of the edges that are a part of a line segment with two end points that are crossing-vertices and removing the other edges, we obtain a submesh 
                              G
                           . From the construction, we know that 
                              G
                            consists of all of the line segments whose two end points are crossing-vertices in 
                              T
                            and the vertices of 
                              G
                            are the crossing-vertices of 
                              T
                           . The submesh 
                              G
                            is called the crossing-vertex-relationship mesh (CVR mesh for short) of 
                              T
                           .

There two examples in Fig. 6
                     .

In 
                        G
                     , we can define cell, edge and l-edge similarly to that in the T-mesh. The difference is that a cell of 
                        G
                      may not be a rectangle.


                     
                        Proposition 3.4
                        
                           For a hierarchical T-mesh 
                           
                              T
                           
                           , with the restriction of 
                           
                              N
                              (
                              t
                              )
                              ⩾
                              2
                            
                           for any l-edge t, the CVR mesh is connected (i.e., if we treat the CVR mesh as a graph, the graph is connected).
                        

Suppose 
                              
                                 lev
                              
                              (
                              T
                              )
                              =
                              n
                           . Consider a connected component 
                              
                                 
                                    T
                                 
                                 
                                    n
                                    ,
                                    1
                                 
                              
                            of 
                              
                                 
                                    T
                                 
                                 
                                    n
                                 
                              
                           . Because 
                              N
                              (
                              t
                              )
                              ⩾
                              2
                           , every l-edge t of 
                              
                                 
                                    T
                                 
                                 
                                    n
                                    ,
                                    1
                                 
                              
                            has at least three crossing-vertices. Therefore, t corresponds to a line segment (denoted by 
                              
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                           ) whose two end points are both crossing-vertices. That is, 
                              
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                            will present in 
                              G
                           . Therefore, the number of the l-edges in 
                              G
                            is the same as in 
                              T
                           , and the l-edges of 
                              G
                            are also hierarchical. The level number of an l-edge of 
                              G
                            is equal to the level number of the l-edge it corresponds to in 
                              T
                           .

Moreover, for two l-edge 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                            in 
                              T
                           , if 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                            intersects with 
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                            at a crossing-vertex, then 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                            intersects with 
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                           , where 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                            and 
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                            are the l-edges that 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                            corresponds to in 
                              G
                           , respectively. Since 
                              
                                 
                                    T
                                 
                                 
                                    0
                                 
                              
                            has at least 4 horizontal l-edges and 4 vertical l-edges, the CVR mesh 
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                            of 
                              
                                 
                                    T
                                 
                                 
                                    0
                                 
                              
                            is a tensor-product mesh which has at least 2 horizontal l-edges and 2 vertical l-edges. That is, 
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                            is a connected mesh. For any l-edge l at level 1, because 
                              N
                              (
                              l
                              )
                              ⩾
                              2
                           , l intersects with at least one l-edge 
                              
                                 
                                    l
                                 
                                 
                                    0
                                 
                              
                            of level 0 at a crossing-vertex. Therefore, 
                              
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                            intersects with 
                              
                                 
                                    l
                                 
                                 
                                    0
                                 
                                 
                                    ′
                                 
                              
                           , where 
                              
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                            and 
                              
                                 
                                    l
                                 
                                 
                                    0
                                 
                                 
                                    ′
                                 
                              
                            are the l-edges that l and 
                              
                                 
                                    l
                                 
                                 
                                    0
                                 
                              
                            correspond to in 
                              G
                           , respectively. That is, the CVR mesh of the mesh obtained by adding l to 
                              
                                 
                                    T
                                 
                                 
                                    0
                                 
                              
                            is a connected mesh. Similarly analyzing for other l-edges at level 1, we obtain that 
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                            is connected.

By induction on the level of the T-mesh, we know the conclusion is right.  □

In the following, the hierarchical T-mesh 
                        T
                      we discussed is with the restriction of 
                        N
                        (
                        t
                        )
                        ⩾
                        2
                      for any l-edge t.

We use 
                        
                           
                              V
                           
                           
                              G
                           
                        
                      to denote the number of the vertices of the CVR mesh. Therefore, 
                        
                           
                              V
                           
                           
                              G
                           
                        
                        =
                        
                           
                              V
                           
                           
                              +
                           
                        
                     . In 
                        G
                     , a vertex is the intersection of two l-edges. We distinguish vertices of 
                        G
                      into six types as follows:
                        
                           1.
                           Type 1: a boundary vertex of 
                                 G
                              , which is an end point of an l-edge and an interior vertex of another l-edge,

Type 2: a boundary vertex of 
                                 G
                              , which is the end points of two l-edges,

Type 3: a boundary vertex of 
                                 G
                              , which is the interior vertices of two l-edges,

Type T: an interior vertex of 
                                 G
                              , which is a T-junction of 
                                 G
                              ,

Type +: an interior vertex of 
                                 G
                              , which is a crossing-vertex of 
                                 G
                              ,

Type L: an interior vertex of 
                                 G
                              , which is the end points of two l-edges.


                     
                        Theorem 3.5
                        
                           (See 
                           
                              Zeng et al., 2015
                           
                           .) Suppose 
                           
                              T
                            
                           is a hierarchical T-mesh, 
                           
                              
                                 lev
                              
                              (
                              T
                              )
                              =
                              n
                           
                           , 
                           
                              N
                              (
                              t
                              )
                              ⩾
                              2
                            
                           for any l-edge t, its CVR mesh is 
                           
                              G
                           
                           , and there are 
                           
                              
                                 
                                    δ
                                 
                                 
                                    4
                                    i
                                 
                              
                            
                           minimal connected components in 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                            
                           (
                           
                              i
                              ⩾
                              1
                           
                           ). Let 
                           
                              
                                 
                                    δ
                                 
                                 
                                    4
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    δ
                                 
                                 
                                    4
                                    i
                                 
                              
                           
                           . If 
                           
                              
                                 
                                    T
                                 
                                 
                                    0
                                 
                              
                            
                           has at least 4 horizontal l-edges and 4 vertical l-edges, then
                           
                              
                                 (1)
                                 
                                    dim
                                    ⁡
                                    
                                       
                                          
                                             S
                                             ‾
                                          
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    T
                                    )
                                    =
                                    
                                       
                                          V
                                       
                                       
                                          G
                                       
                                       
                                          +
                                       
                                    
                                    −
                                    
                                       
                                          V
                                       
                                       
                                          G
                                       
                                       
                                          L
                                       
                                    
                                    +
                                    
                                       
                                          δ
                                       
                                       
                                          4
                                       
                                    
                                    .
                                 
                              
                           
                        

There are several ways to construct a basis, such as the smoothing co-factor method (Wang, 2001), B-net method (Schumaker and Wang, 2012), and finding B-splines over local tensor-product meshes (Deng et al., 2008; Dokken et al., 2013; Sederberg et al., 2003). From the viewpoint of application, the last method is the best choice. Therefore, the first task is to determine the configuration of the hierarchical T-mesh to guarantee that all the tensor-product B-splines can span the whole spline space.

A tensor-product B-spline in 
                           
                              
                                 
                                    S
                                    ‾
                                 
                              
                              
                                 3
                              
                           
                           (
                           T
                           )
                         is defined on a 
                           5
                           ×
                           5
                         tensor-product submesh whose CVR mesh is a 
                           3
                           ×
                           3
                         tensor-product mesh. We want to construct the basis with the help of the CVR mesh of 
                           T
                        . We call the 
                           3
                           ×
                           3
                         tensor-product submesh of 
                           G
                         a basic mesh, and call the center vertex of the basic mesh an anchor. We use 
                           A
                         to denote the set of all the anchors of 
                           G
                        . A vertex may be the anchor of several basic meshes.

In Fig. 7
                        , there are 5 basic meshes; 
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 v
                              
                              
                                 4
                              
                           
                         are all of the anchors; 
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                         is the anchor of 2 basic meshes.

Every 
                           5
                           ×
                           5
                         tensor-product submesh of 
                           T
                         corresponds to a basic mesh of 
                           G
                        , whereas a basic mesh of 
                           G
                         does not necessarily correspond to a 
                           5
                           ×
                           5
                         tensor-product submesh of 
                           T
                        . See Fig. 8
                         for an example. For the basic mesh in red in 
                           G
                        , we cannot find a 
                           5
                           ×
                           5
                         tensor-product submesh corresponding to it in 
                           T
                        .

The reason is that the level-difference of some adjacent cells is bigger than 1. In Fig. 8, the cell in light-gray is of level 0, while one of its adjacent cells in blue is of level 2. The level-difference of the two adjacent cells is 2. We have the following lemma.


                        
                           Lemma 4.1
                           
                              For a hierarchical T-mesh 
                              
                                 T
                              
                              , if the level-difference of the adjacent cells is at most one, a basic mesh of 
                              
                                 G
                               
                              corresponds to a 
                              
                                 5
                                 ×
                                 5
                               
                              tensor-product submesh of 
                              
                                 T
                              
                              .
                           

To clarify this fact, we should classify the basic meshes.

We consider the basic mesh in the refinement process. Suppose the old T-mesh is 
                                 T
                              ; we refine some cells of 
                                 T
                               and obtain a new mesh 
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                              . The anchor of the new basic mesh could be the center of a cell of 
                                 T
                              , the center of an edge of 
                                 T
                               or a crossing-vertex of 
                                 T
                              . With the restriction of the level-difference less than 2, all types of basic meshes and their corresponding 
                                 5
                                 ×
                                 5
                               tensor-product meshes are discussed in the following. In Figs. 9, 10 and 11
                              
                              
                              , the basic meshes are bounded by the red lines and the corresponding 
                                 5
                                 ×
                                 5
                               tensor-product meshes are bounded by the dashed lines.
                                 
                                    1.
                                    The anchor is the center of a cell of 
                                          T
                                       . See Fig. 9.
                                          
                                             (a)
                                             If cells 1, 2, 3 and 4 are not all refined, the situation is as in Fig. 9.a.

If cells 1, 2, 3 and 4 are all refined, the situation is as in Fig. 9.b.

The anchor is the center of an edge of 
                                          T
                                       . See Fig. 10.A. Here we only consider the horizontal edge; the vertical edge can be discussed similarly.
                                          
                                             (a)
                                             If cells 3, 4, 5 and 6 are all refined, the situation is as in Fig. 10.a.

If cells 5 and 6 are both refined, cells 3 and 4 are not both refined, and cell 1 is refined, then the situation is as in Fig. 10.b.

If cells 5 and 6 are not both refined, cells 3 and 4 are both refined, and cell 2 is refined, the situation is similar.

If cells 5 and 6 are not both refined, cells 3 and 4 are not both refined, and cells 1 and 2 are both refined, then the situation is as in Fig. 10.c.

The anchor is a crossing vertex of 
                                          T
                                       , the situation is as in Fig. 11. □

A basic mesh is a 
                           3
                           ×
                           3
                         tensor-product mesh, and its edges belong to 6 l-edges in 
                           G
                        . The maximal level number of the 6 l-edges is called the level of the basic mesh, and so is its corresponding 
                           5
                           ×
                           5
                         tensor-product submesh in 
                           T
                        . For example, in Fig. 9, if cells 1, 2, 3 and 4 are of level k, then the new basic meshes are of level 
                           k
                           +
                           1
                        .

Every 
                           5
                           ×
                           5
                         tensor-product submesh 
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                         is divided into 16 parts by its edges, which are called the cells of 
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                        . Fig. 12
                         is the mesh of case 1(a), and the 16 cells have been marked 
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           16
                        . Every basic mesh 
                           
                              
                                 G
                              
                              
                                 0
                              
                           
                         is divided into 4 parts, which are called the cells of 
                           
                              
                                 G
                              
                              
                                 0
                              
                           
                        . In Fig. 12, the four cells are the cells 6, 7, 10 and 11.

If 
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                         is of level 
                           k
                           +
                           1
                        , we can see that a cell of 
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                         is a cell of 
                           T
                         at level k, consists of two cells of 
                           T
                         at level 
                           k
                           +
                           1
                        , or is a cell of 
                           T
                         at level 
                           k
                           +
                           1
                        . We call the three types of cells of 
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                         are of level k, level 
                           k
                           +
                           1
                           /
                           2
                        , level 
                           k
                           +
                           1
                        , respectively. In Fig. 12, the cells 1, 4, 13, 16 are of level k, and all the cells 2, 3, 5, 8, 9, 12, 14, 15 are of level 
                           k
                           +
                           1
                           /
                           2
                        . For the case 1(b), the 16 cells of 
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                         are all of level 
                           k
                           +
                           1
                        . A cell of 
                           
                              
                                 G
                              
                              
                                 0
                              
                           
                         consists of two cells of 
                           T
                         at level 
                           k
                           +
                           1
                        , or is a cell of 
                           T
                         at level 
                           k
                           +
                           1
                        . We call the two types of cells of 
                           
                              
                                 G
                              
                              
                                 0
                              
                           
                         are of level 
                           k
                           +
                           1
                           /
                           2
                        , level 
                           k
                           +
                           1
                        , respectively. In Fig. 12, the cells 6, 7, 10, 11 are of level 
                           k
                           +
                           1
                        . For the case 2(c), all of the 4 cells of 
                           
                              
                                 G
                              
                              
                                 0
                              
                           
                         are of level 
                           k
                           +
                           1
                           /
                           2
                        . We call the 
                           5
                           ×
                           5
                         tensor-product mesh that consists of 16 cells at the same level a standard tensor-product mesh. For example, the 
                           5
                           ×
                           5
                         tensor-product meshes of case 1(b), case 2(b), and case 3 are all standard tensor-product meshes. The tensor-product B-spline defined on the standard tensor-product mesh is called a standard B-spline, and the CVR mesh of a standard tensor-product mesh is called a standard basic mesh.


                        
                           Remark 4.2
                           For the hierarchical B-splines in Vuong et al. (2011), all of the basis functions are standard B-splines.

With the restriction of the level-difference less than 2, we discuss when the type L points appear. In Fig. 13
                        , dividing the cell 
                           
                              
                                 c
                              
                              
                                 0
                              
                           
                         (bounded by red lines), we want the vertex v to be a type L point in the CVR mesh. Cell 
                           
                              
                                 c
                              
                              
                                 0
                              
                           
                         must be an interior cell, whose adjacent cells are 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 4
                              
                           
                        . When 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                         are divided and 
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 4
                              
                           
                         are not divided, or 
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                         are divided and 
                           
                              
                                 c
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                         are not divided, or 
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 4
                              
                           
                         are divided and 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                         are divided, or 
                           
                              
                                 c
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                         are divided and 
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                         are not divided, v is a type L point in the CVR mesh.

Our first rule is: the level-difference of the adjacent cells is at most one. In the following, the hierarchical T-mesh we discuss satisfies this rule.

We have the following two facts about the CVR mesh.
                           
                              1.
                              The adjacent points of a type L point are type + or type 3 points of 
                                    G
                                 ;

A type + point is either an anchor or the adjacent point of some type L points.


                        
                           Definition 4.3
                           
                              L 
                              chain: the longest chain consisting of 
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                       n
                                    
                                 
                              , where 
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                       n
                                    
                                 
                               are type + or type 3 points, 
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                       n
                                       −
                                       1
                                    
                                 
                               are type L points, and 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                               is adjacent to 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                              . Because the level-difference is less than 2, the vertices in an L chain are of the same level.

Because an L chain is the longest chain, a type + or type 3 point could only be in one L chain.

If 
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                               or 
                                 
                                    
                                       v
                                    
                                    
                                       2
                                       n
                                    
                                 
                               is type 3, the chain is called a boundary 
                              L 
                              chain; otherwise it is called an interior 
                              L 
                              chain.

For a boundary L chain, if 
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                               and 
                                 
                                    
                                       v
                                    
                                    
                                       2
                                       n
                                    
                                 
                               are both type 3, the chain is called a type 1 chain; otherwise, it is called a type 2 chain. For an interior L chain, if 
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       2
                                       n
                                    
                                 
                              , it is called a type 3 chain; otherwise, it is called a type 4 chain.

If two L chains have the same vertices, we regard the two chains as the same chain. For example, 
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                       n
                                    
                                 
                               and 
                                 
                                    
                                       v
                                    
                                    
                                       2
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                       n
                                       −
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                               are the same chain.

In Fig. 14
                        , there are 6 L chains: 
                           
                              
                                 v
                              
                              
                                 20
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 21
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 22
                              
                           
                         and 
                           
                              
                                 v
                              
                              
                                 30
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 31
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 32
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 33
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 34
                              
                           
                         are type 1 chains; 
                           
                              
                                 v
                              
                              
                                 50
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 51
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 52
                              
                           
                         is a type 2 chain; 
                           
                              
                                 v
                              
                              
                                 40
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 41
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 v
                              
                              
                                 48
                              
                           
                         is a type 3 chain; 
                           
                              
                                 v
                              
                              
                                 00
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 01
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 02
                              
                           
                         and 
                           
                              
                                 v
                              
                              
                                 10
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 11
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 v
                              
                              
                                 16
                              
                           
                         are type 4 chains.


                        
                           Lemma 4.4
                           
                              Type 1 chains and type 3 chains appear if and only if they are in the basic meshes corresponding to the minimal connected components (
                              
                                 Fig. 5
                              
                              ).
                           

This fact could be proved by analyzing the mesh. We only prove the conclusion for type 3 chains, and the case of type 1 chains could be proved similarly.

The sufficiency is obvious. For the necessity, consider a part of a hierarchical T-mesh in Fig. 15
                              .a. Suppose all of the cells 
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       16
                                    
                                 
                               are of level k. We divide some of them to construct a type 3 chain of level 
                                 k
                                 +
                                 1
                              . From the analysis above, the type L points in the CVR mesh appear at the center of the cells that will be divided. Suppose the top-right type L point 
                                 
                                    
                                       v
                                    
                                    
                                       L
                                    
                                 
                               of the type 3 chain appears at the center of 
                                 
                                    
                                       c
                                    
                                    
                                       7
                                    
                                 
                              . Here “top-right” means that in this type 3 chain, there is not a type L point above 
                                 
                                    
                                       v
                                    
                                    
                                       L
                                    
                                 
                              , and among all of the type L points which are in the same height as 
                                 
                                    
                                       v
                                    
                                    
                                       L
                                    
                                 
                               is, 
                                 
                                    
                                       v
                                    
                                    
                                       L
                                    
                                 
                               is the rightmost one. Then 
                                 
                                    
                                       c
                                    
                                    
                                       6
                                    
                                 
                              , 
                                 
                                    
                                       c
                                    
                                    
                                       7
                                    
                                 
                               and 
                                 
                                    
                                       c
                                    
                                    
                                       11
                                    
                                 
                               will be divided, and 
                                 
                                    
                                       c
                                    
                                    
                                       3
                                    
                                 
                               and 
                                 
                                    
                                       c
                                    
                                    
                                       8
                                    
                                 
                               will not be divided. See Fig. 15.b. Because we will construct a type 3 chain, the center of 
                                 
                                    
                                       c
                                    
                                    
                                       6
                                    
                                 
                               will also be a type L point in the CVR mesh, otherwise, this chain will terminate. Then 
                                 
                                    
                                       c
                                    
                                    
                                       10
                                    
                                 
                               will be divided, and 
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                               and 
                                 
                                    
                                       c
                                    
                                    
                                       5
                                    
                                 
                               will not be divided. See Fig. 15.c. Similarly, the center of 
                                 
                                    
                                       c
                                    
                                    
                                       10
                                    
                                 
                               and 
                                 
                                    
                                       c
                                    
                                    
                                       11
                                    
                                 
                               will also be type L points in the CVR mesh, then 
                                 
                                    
                                       c
                                    
                                    
                                       9
                                    
                                 
                              , 
                                 
                                    
                                       c
                                    
                                    
                                       14
                                    
                                 
                              , 
                                 
                                    
                                       c
                                    
                                    
                                       15
                                    
                                 
                               and 
                                 
                                    
                                       c
                                    
                                    
                                       12
                                    
                                 
                               will not be divided.

Therefore, the connected component in Fig. 15.c is just the connected component that the type 3 chain corresponds to, which is a minimal connected component.  □


                        
                           Theorem 4.5
                           
                              Suppose 
                              
                                 T
                               
                              is a hierarchical T-mesh, 
                              
                                 N
                                 (
                                 t
                                 )
                                 ⩾
                                 2
                               
                              for any l-edge t, the level-difference of the adjacent cells is at most one, and the numbers of type 3 chains and type 4 chains in 
                              
                                 G
                               
                              are 
                              
                                 
                                    
                                       C
                                    
                                    
                                       3
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       4
                                    
                                 
                              
                              , respectively, where 
                              
                                 G
                               
                              is the CVR mesh of 
                              
                                 T
                              
                              . Then,
                              
                                 
                                    (2)
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             
                                                S
                                                ‾
                                             
                                          
                                          
                                             3
                                          
                                       
                                       (
                                       T
                                       )
                                       =
                                       #
                                       A
                                       +
                                       
                                          
                                             C
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       
                                          
                                             C
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                    
                                 
                               
                              where 
                              
                                 #
                                 A
                               
                              is the number of the elements of 
                              
                                 A
                              
                              .
                           

Suppose the numbers of type 1 chains and type 2 chains in 
                                 G
                               are 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                              , respectively. By Lemma 4.4, we have
                                 
                                    (3)
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             4
                                          
                                       
                                       =
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             C
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                    
                                 
                               where 
                                 
                                    
                                       δ
                                    
                                    
                                       4
                                    
                                 
                               has the same meaning as in Theorem 3.5.

For a type 2 chain or a type 3 chain, the numbers of type + and type L points are the same. For a type 1 chain, there is one more type L point than type + points. For a type 4 chain, there is one less type L point than type + points. Therefore,
                                 
                                    (4)
                                    
                                       
                                          
                                             V
                                          
                                          
                                             G
                                          
                                          
                                             +
                                          
                                       
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             G
                                          
                                          
                                             L
                                          
                                       
                                       =
                                       #
                                       A
                                       +
                                       
                                          
                                             C
                                          
                                          
                                             4
                                          
                                       
                                       −
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           

Combining Equations (1), (3) and (4), we obtain Equation (2).  □

We want all of the basis functions to be tensor-product B-splines. From Equation (2), we know that every type 4 chain must correspond to a basic mesh, that is, every type L point should be in a basic mesh. To explain this phenomenon simply, consider the hierarchical T-mesh 
                           
                              
                                 T
                              
                              
                                 2
                              
                           
                         in Fig. 6. By Equation (1) or Equation (2), we have 
                           dim
                           ⁡
                           
                              
                                 
                                    S
                                    ‾
                                 
                              
                              
                                 3
                              
                           
                           (
                           
                              
                                 T
                              
                              
                                 2
                              
                           
                           )
                           =
                           5
                        . However, there are only 4 basic meshes in the CVR mesh of 
                           
                              
                                 T
                              
                              
                                 2
                              
                           
                        . That is, all of the tensor-product B-splines cannot span the space of 
                           
                              
                                 
                                    S
                                    ‾
                                 
                              
                              
                                 3
                              
                           
                           (
                           
                              
                                 T
                              
                              
                                 2
                              
                           
                           )
                        . Therefore, our second rule is: every type 4 chain must correspond to a basic mesh.

From Equation (2), we know that different interior L chains should correspond to different basic meshes. In Fig. 16
                        , the L chain 
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                         and the L chain 
                           
                              
                                 v
                              
                              
                                 0
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                         are in the same basic mesh. By Theorem 3.5, we have 
                           dim
                           ⁡
                           
                              
                                 
                                    S
                                    ‾
                                 
                              
                              
                                 3
                              
                           
                           (
                           T
                           )
                           =
                           7
                        , but we can only find 6 basic meshes.

To prevent the occurrence of such a situation, we set the third rule: two different L chains cannot be in the same (standard) basic mesh.

Now we collect all the restrictions of the hierarchical T-mesh here:
                           
                              1.
                              the hierarchical T-mesh 
                                    T
                                  is regular;

the initial tensor-product mesh 
                                    
                                       
                                          T
                                       
                                       
                                          0
                                       
                                    
                                  has at least 4 horizontal l-edges and 4 vertical l-edges;


                                 
                                    N
                                    (
                                    t
                                    )
                                    ⩾
                                    2
                                  for any l-edge t;

the level-difference of the adjacent cells is at most one;

every type 4 chain corresponds to a basic mesh;

two different L chains are not in the same (standard) basic mesh.

Then we can define the multiplicity of the anchor under these restrictions. For an anchor v, if there are m type 3 and type 4 chains, the anchors of which are all v, then the multiplicity of v is 
                           m
                           +
                           1
                        , denoted by 
                           
                              mul
                           
                           (
                           v
                           )
                           =
                           m
                           +
                           1
                        . Combining with Equation (2), we have
                           
                              (5)
                              
                                 dim
                                 ⁡
                                 
                                    
                                       
                                          S
                                          ‾
                                       
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 T
                                 )
                                 =
                                 
                                    ∑
                                    
                                       v
                                       ∈
                                       A
                                    
                                 
                                 
                                    mul
                                 
                                 (
                                 v
                                 )
                                 .
                              
                           
                        
                     

For example, in Fig. 7, 
                           
                              mul
                           
                           (
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           )
                           =
                           2
                           ,
                           
                              mul
                           
                           (
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           )
                           =
                           
                              mul
                           
                           (
                           
                              
                                 v
                              
                              
                                 3
                              
                           
                           )
                           =
                           
                              mul
                           
                           (
                           
                              
                                 v
                              
                              
                                 4
                              
                           
                           )
                           =
                           1
                        .

In this section, we introduce the algorithm for the refinement briefly. Usually, we choose a 
                           5
                           ×
                           5
                         tensor-product mesh as 
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                        , no matter whether it is uniform or not.

To ensure the second rule, we set the refinement style: we refine the mesh around the crossing vertices. If we want to refine around a crossing vertex 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                           , we divide the adjacent cells of 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                           . In Fig. 17
                           , the crossing vertices of 
                              T
                            that will be refined around have been marked and 
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                            is the resulting T-mesh. Under this refinement style, every type 3 or type 4 chain is in a standard basic mesh. We call the anchor of the basic mesh the anchor of this L chain. With this refinement style, we have 
                              N
                              (
                              t
                              )
                              ⩾
                              2
                            for any l-edge t as well.

Different from other types of splines, we refine the mesh based on crossing-vertices instead of cells. Now we give the algorithm for finding the crossing-vertices that will be refined around.

We compute the error around every crossing vertex. For a given crossing vertex 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                           , suppose the adjacent cells of 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                            are of level k. There are four cells of level k in 
                              
                                 
                                    T
                                 
                                 
                                    k
                                 
                              
                            that are around 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                           . For example, in Fig. 17, the four cells are in light-gray for the crossing vertex v. We compute the error on the area occupied by the four cells. If the error is greater than a given tolerance ε, this crossing-vertex should be refined around.

To guarantee that the level-difference is at most one, we should refine around more crossing-vertices.

See Fig. 18
                           . There are three situations that we should refine around more crossing-vertices. If we want to refine around 
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                           , because either the cell 
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                            or 
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                            is not divided, we should refine around 
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                            first. If we want to refine around 
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                           , because neither of the cell 
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    c
                                 
                                 
                                    3
                                 
                              
                            is divided, we should refine around 
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                            first. If we want to refine around 
                              
                                 
                                    v
                                 
                                 
                                    3
                                 
                              
                           , because the cell 
                              
                                 
                                    c
                                 
                                 
                                    5
                                 
                              
                            is not divided, we should refine around 
                              
                                 
                                    v
                                 
                                 
                                    3
                                 
                                 
                                    ′
                                 
                              
                            or 
                              
                                 
                                    v
                                 
                                 
                                    3
                                 
                                 
                                    ″
                                 
                              
                            first. Our principle is to divide as few cells as possible. Therefore, if the cell 
                              
                                 
                                    c
                                 
                                 
                                    4
                                 
                              
                            has been divided already, we choose 
                              
                                 
                                    v
                                 
                                 
                                    3
                                 
                                 
                                    ′
                                 
                              
                            to refine around, which means we should only divide 
                              
                                 
                                    c
                                 
                                 
                                    5
                                 
                              
                           . Similarly, if the cell 
                              
                                 
                                    c
                                 
                                 
                                    4
                                 
                              
                            has not been divided and the cell 
                              
                                 
                                    c
                                 
                                 
                                    6
                                 
                              
                            has been divided already, we choose 
                              
                                 
                                    v
                                 
                                 
                                    3
                                 
                                 
                                    ″
                                 
                              
                            to refine around, which means we should only divide 
                              
                                 
                                    c
                                 
                                 
                                    5
                                 
                              
                            as well. If neither of 
                              
                                 
                                    c
                                 
                                 
                                    4
                                 
                              
                            and 
                              
                                 
                                    c
                                 
                                 
                                    6
                                 
                              
                            has been divided, we can choose either of 
                              
                                 
                                    v
                                 
                                 
                                    3
                                 
                                 
                                    ′
                                 
                              
                            and 
                              
                                 
                                    v
                                 
                                 
                                    3
                                 
                                 
                                    ″
                                 
                              
                            to refine around.

A standard basic mesh can have one, two, three or four type L points. The situation where two different L chains appear in the same (standard) basic mesh occurs only when the standard basic mesh has two type L points that are not in two different L chains.

We use Fig. 19
                            to illustrate when this situation occurs. The red lines correspond to the boundary lines of a standard basic mesh in the CVR mesh. We pay attention to the four vertices 
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    4
                                 
                              
                            that can be type L points. It is easy to check that this situation occurs when 
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    v
                                 
                                 
                                    3
                                 
                              
                            are both type L points and neither of 
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    v
                                 
                                 
                                    4
                                 
                              
                            is a type L point, or 
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    v
                                 
                                 
                                    4
                                 
                              
                            are both type L points and neither of 
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    v
                                 
                                 
                                    3
                                 
                              
                            is a type L point.

Here we suppose 
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    v
                                 
                                 
                                    3
                                 
                              
                            are both type L points in the CVR mesh and neither of 
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    v
                                 
                                 
                                    4
                                 
                              
                            is a type L point in the CVR mesh. Therefore, none of the cells 
                              a
                              ,
                              b
                              ,
                              e
                            and f is divided, c or d is divided, and g or h is divided. To avoid this situation, we divide more cells to change 
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                            or 
                              
                                 
                                    v
                                 
                                 
                                    3
                                 
                              
                            to a type + point or a type T point. The refinement style tells us that we should refine around the crossing vertex. We choose an appropriate crossing vertex to avoid dividing more cells. For example, in Fig. 19, c is divided. Therefore, we choose 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                            to refine around. Then, we should only divide b.

If we want to refine around a vertex v, Algorithm 1
                            is a simple process for finding a sequence of cross-vertices that should be refined around to ensure the first rule and the third rule. Here we use the recursion of functions. This algorithm is always guaranteed to terminate, because the worst case is that the mesh will become a tensor-product mesh after refining around all the crossing-vertices in RefineListAt(v).

In the actual operation, we should refine around more than one cross-vertex. Algorithm 2
                            is a simple process of the refinement of a hierarchical T-mesh.

In this section, we provide a detailed construction process for the bicubic hierarchical basis. Suppose 
                        
                           lev
                        
                        (
                        T
                        )
                        =
                        N
                     . Now that we refined around a crossing vertex v, we divide some cells at level 
                        k
                        +
                        1
                     . The chosen cells are the adjacent cells of v.

In Fig. 20
                        , we divide the cell bounded by red lines. The crossing vertices (if they exist) upon this cell that will be influenced have been marked 
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 v
                              
                              
                                 7
                              
                           
                        . We only consider these crossing vertices, and the crossing vertices in other directions can be dealt with in the same manner.

We can analyze every vertex of 
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 v
                              
                              
                                 7
                              
                           
                         as the classification of anchors in Section 4. If the vertex satisfies one of the cases, we add the corresponding tensor-product B-spline to the original basis. After treating all of the vertices surrounding the divided cell, we deal with the crossing vertex 
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                        .

We use 
                           
                              lev
                           
                           (
                           f
                           )
                         to represent the level of the basis function f and 
                           
                              
                                 F
                              
                              
                                 i
                              
                              
                                 0
                              
                           
                         to represent the set of all of the basis functions at level i, and 
                           
                              
                                 F
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 ⋃
                              
                              
                                 i
                                 =
                                 0
                              
                              
                                 N
                              
                           
                           
                              
                                 F
                              
                              
                                 i
                              
                              
                                 0
                              
                           
                        , where 
                           
                              
                                 F
                              
                              
                                 0
                              
                              
                                 0
                              
                           
                         is the tensor-product basis functions of 
                           
                              
                                 
                                    S
                                    ‾
                                 
                              
                              
                                 3
                              
                           
                           (
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                           )
                         as in Vuong et al. (2011).

An anchor can be the center of several basic meshes at different levels.

We delete the basis function at level k if the domain of its basic mesh is covered by the domains of the basic meshes of some basis functions at level 
                           k
                           +
                           1
                        . Because the level difference is less than 2, this only occurs to the standard basis functions (i.e., standard B-splines). Now we discuss when this situation appears.

In Fig. 21
                        .a, the 
                           5
                           ×
                           5
                         tensor-product mesh is the domain of a standard B-spline g at level k. First, the cells 
                           a
                           ,
                           b
                           ,
                           c
                         and d should all be divided. This is because the cells of the basic mesh at level 
                           k
                           +
                           1
                         are at least at level 
                           k
                           +
                           1
                           /
                           2
                        . In Fig. 21.b, the four cells have been divided. In Fig. 21.c, the red lines compose the CVR mesh of the mesh in Fig. 21.b.

Second, the four crossing vertices 
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 v
                              
                              
                                 4
                              
                           
                         should all be anchors. It is easy to verify that when this is true, the domain of the basic mesh of g is covered. To prove the necessity, look at the CVR mesh in Fig. 21.c. The edge 
                           
                              
                                 l
                              
                              
                                 i
                              
                           
                         or 
                           
                              
                                 l
                              
                              
                                 i
                                 +
                                 1
                              
                           
                        , where 
                           i
                           =
                           1
                           ,
                           3
                           ,
                           5
                           ,
                           7
                        , should exist in the CVR mesh. Otherwise, suppose neither of 
                           
                              
                                 l
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 l
                              
                              
                                 2
                              
                           
                         exists. Then, there is a cell (the light-gray cell) that is neither at level 
                           k
                           +
                           1
                           /
                           2
                         nor at level 
                           k
                           +
                           1
                        , thus it cannot be contained in any basic mesh of level 
                           k
                           +
                           1
                        , a contradiction. When 
                           
                              
                                 l
                              
                              
                                 1
                              
                           
                         or 
                           
                              
                                 l
                              
                              
                                 2
                              
                           
                         exists, and 
                           
                              
                                 l
                              
                              
                                 7
                              
                           
                         or 
                           
                              
                                 l
                              
                              
                                 8
                              
                           
                         exists, 
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                         is an anchor. Similarly, 
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 v
                              
                              
                                 4
                              
                           
                         are all anchors. This conclusion is equivalent to none of 
                           
                              
                                 v
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 3
                              
                              
                                 ′
                              
                           
                         or 
                           
                              
                                 v
                              
                              
                                 4
                              
                              
                                 ′
                              
                           
                         is a type L point.

After deleting, we use 
                           
                              
                                 F
                              
                              
                                 i
                              
                           
                         to represent the basis functions remaining at level i. The final basis we obtain is denoted by 
                           F
                           =
                           
                              
                                 ⋃
                              
                              
                                 i
                                 =
                                 0
                              
                              
                                 N
                              
                           
                           
                              
                                 F
                              
                              
                                 i
                              
                           
                        .


                        
                           Lemma 5.1
                           
                              After the process above, we have
                              
                                 
                                    (6)
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             
                                                S
                                                ‾
                                             
                                          
                                          
                                             3
                                          
                                       
                                       (
                                       T
                                       )
                                       =
                                       #
                                       F
                                       .
                                    
                                 
                              
                           

After this process, for ∀ anchor v, we claim that there are 
                                 
                                    mul
                                 
                                 (
                                 v
                                 )
                               basis functions whose anchor is v.

We use Fig. 21 to prove this claim. The crossing-vertex 
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                               is an anchor. Without losing generality, we can assume 
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                               is of level 0. There is one basis function 
                                 
                                    
                                       f
                                    
                                    
                                       0
                                    
                                 
                               whose anchor is 
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                               in 
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                 
                              . After dividing the cells 
                                 a
                                 ,
                                 b
                                 ,
                                 c
                               and d, v is the anchor of a basic mesh of level 1. If 
                                 
                                    
                                       f
                                    
                                    
                                       0
                                    
                                 
                               is not deleted, then at least one of 
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       4
                                    
                                    
                                       ′
                                    
                                 
                               is a type L point. That is, this basic mesh corresponds to a type 3 or type 4 chain of level 1. Therefore, 
                                 
                                    mul
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 2
                               in 
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                              . If 
                                 
                                    
                                       f
                                    
                                    
                                       0
                                    
                                 
                               is deleted, none of 
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       3
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       4
                                    
                                    
                                       ′
                                    
                                 
                               is a type L point. That is, this basic mesh does not correspond to a type 3 or type 4 chain of level 1. Therefore, 
                                 
                                    mul
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 1
                               in 
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                              . By induction on the level, we know this claim is right.

Combing with Equation (5), we complete the proof.  □

In this section, we give an example to illustrate the process above. We use 
                           N
                           [
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 4
                              
                           
                           ]
                           (
                           x
                           )
                         to denote the cubic B-spline basis function associated with the knot vector 
                           [
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 4
                              
                           
                           ]
                         in x-direction, 
                           N
                           [
                           
                              
                                 y
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 4
                              
                           
                           ]
                           (
                           y
                           )
                         to denote the cubic B-spline basis function associated with the knot vector 
                           [
                           
                              
                                 y
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 4
                              
                           
                           ]
                         in y-direction, and 
                           
                              
                                 f
                              
                              
                                 v
                              
                              
                                 i
                              
                           
                         to denote the basis function at level i whose anchor is v.

In Fig. 22
                        , 
                           T
                         is the initial T-mesh and 
                           G
                         is its CVR mesh. The vertices 
                           
                              
                                 v
                              
                              
                                 1
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 3
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 4
                              
                              
                                 0
                              
                           
                         are all the anchors. Therefore, 
                           #
                           
                              
                                 F
                              
                              
                                 0
                              
                              
                                 0
                              
                           
                           =
                           4
                        . The basis function whose anchor is 
                           
                              
                                 v
                              
                              
                                 1
                              
                              
                                 0
                              
                           
                         is
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             1
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 N
                                 [
                                 0
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 ]
                                 (
                                 x
                                 )
                                 N
                                 [
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 ,
                                 5
                                 ]
                                 (
                                 y
                                 )
                                 .
                              
                           
                        
                     

Now we refine around 
                           
                              
                                 v
                              
                              
                                 4
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 5
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 6
                              
                              
                                 0
                              
                           
                         and obtain a new mesh 
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                         whose CVR mesh is 
                           
                              
                                 G
                              
                              
                                 ′
                              
                           
                        . By Lemma 4.1, three basis functions whose anchors are 
                           
                              
                                 v
                              
                              
                                 4
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 5
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 6
                              
                              
                                 0
                              
                           
                         are added for case 3, one basis function whose anchor is 
                           
                              
                                 v
                              
                              
                                 3
                              
                              
                                 1
                              
                           
                         is added for case 2(a), one basis function whose anchor is 
                           
                              
                                 v
                              
                              
                                 2
                              
                              
                                 1
                              
                           
                         is added for case 2(b), and one basis function whose anchor is 
                           
                              
                                 v
                              
                              
                                 1
                              
                              
                                 1
                              
                           
                         is added for case 2(c). Because the adjacent cells of 
                           
                              
                                 v
                              
                              
                                 1
                              
                              
                                 0
                              
                           
                         are not all divided in the refinement process, 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 0
                              
                           
                         will not change. So do 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       3
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 0
                              
                           
                        . For 
                           
                              
                                 v
                              
                              
                                 4
                              
                              
                                 0
                              
                           
                        , because the vertex 
                           
                              
                                 v
                              
                              
                                 ′
                              
                           
                         is a type L point, 
                           
                              mul
                           
                           (
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           )
                           =
                           2
                         and 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       4
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 0
                              
                           
                         will not change as well. We have
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             4
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 N
                                 [
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 ,
                                 5
                                 ]
                                 (
                                 x
                                 )
                                 N
                                 [
                                 0
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 ]
                                 (
                                 y
                                 )
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             4
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 N
                                 [
                                 2
                                 ,
                                 2.5
                                 ,
                                 3
                                 ,
                                 3.5
                                 ,
                                 4
                                 ]
                                 (
                                 x
                                 )
                                 N
                                 [
                                 1
                                 ,
                                 1.5
                                 ,
                                 2
                                 ,
                                 2.5
                                 ,
                                 3
                                 ]
                                 (
                                 y
                                 )
                                 .
                              
                           
                        
                     

Now we refine around 
                           
                              
                                 v
                              
                              
                                 7
                              
                              
                                 0
                              
                           
                         and obtain a new mesh 
                           
                              
                                 T
                              
                              
                                 ″
                              
                           
                         whose CVR mesh is 
                           
                              
                                 G
                              
                              
                                 ″
                              
                           
                        . By Lemma 4.1, one basis function whose anchor is 
                           
                              
                                 v
                              
                              
                                 7
                              
                              
                                 0
                              
                           
                         is added for case 3, one basis function whose anchor is 
                           
                              
                                 v
                              
                              
                                 ′
                              
                           
                         is added for case 1(a), two basis functions whose anchors are 
                           
                              
                                 v
                              
                              
                                 4
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 5
                              
                              
                                 1
                              
                           
                         are added for case 2(b). Because 
                           
                              
                                 v
                              
                              
                                 ′
                              
                           
                         is no longer a type L point in 
                           
                              
                                 G
                              
                              
                                 ″
                              
                           
                        , 
                           
                              mul
                           
                           (
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           )
                           =
                           1
                         and 
                           
                              
                                 f
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       4
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 0
                              
                           
                         will be deleted.

Finally, we have 
                           
                              
                                 F
                              
                              
                                 0
                              
                           
                           =
                           {
                           
                              
                                 f
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       3
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 0
                              
                           
                           }
                        , 
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                           =
                           {
                           
                              
                                 f
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       5
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       6
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       7
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       4
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                    
                                       1
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       3
                                    
                                    
                                       1
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       4
                                    
                                    
                                       1
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       5
                                    
                                    
                                       1
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       ′
                                    
                                 
                              
                              
                                 1
                              
                           
                           }
                        .

In this section, we discuss some properties of the basis obtained in Section 5. The support set of any function f is
                        
                           
                              
                                 supp
                              
                              (
                              f
                              )
                              =
                              {
                              (
                              x
                              ,
                              y
                              )
                              ∈
                              Ω
                              :
                              f
                              (
                              x
                              ,
                              y
                              )
                              ≠
                              0
                              }
                              ,
                           
                        
                      where Ω is the region occupied by the cells in 
                        T
                     .

First, we give three lemmas about the basis.


                        
                           Lemma 6.1
                           
                              For two basis functions 
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                              
                              , suppose 
                              
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                               
                              are the tensor-product meshes which 
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                               
                              are defined on, respectively. In 
                              
                                 Fig. 23
                              
                              
                              , 
                              
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                               
                              are bounded by solid lines and dashed lines, respectively. The points 
                              
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       A
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       A
                                    
                                    
                                       3
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       A
                                    
                                    
                                       4
                                    
                                 
                               
                              are the four corner points of 
                              
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                              
                              . If 
                              
                                 
                                    supp
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ∩
                                 
                                    supp
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ≠
                                 ∅
                              
                              , 
                              
                                 
                                    supp
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ⊈
                                 
                                    supp
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 )
                               
                              and 
                              
                                 
                                    supp
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ⊈
                                 
                                    supp
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              , then 
                              
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                               
                              cannot be the corner point of 
                              
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                              
                              , where 
                              
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                              
                              .
                           


                        
                           Proof
                           This lemma can be proved by checking all of the types of the basis functions. If 
                                 
                                    lev
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 >
                                 
                                    lev
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 )
                              , suppose 
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                               is also the corner point of 
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                              . Then, 
                                 
                                    supp
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ⊆
                                 
                                    supp
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 )
                              , a contradiction. Conversely, if 
                                 
                                    lev
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 <
                                 
                                    lev
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 )
                              , then 
                                 
                                    supp
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ⊆
                                 
                                    supp
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 )
                              , also a contradiction.

If 
                                 
                                    lev
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    lev
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 )
                              , this conclusion is also correct. We omit the proof here.  □


                        
                           Lemma 6.2
                           
                              Suppose 
                              
                                 
                                    
                                       F
                                    
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       m
                                    
                                 
                                 }
                              
                              . For any basis function f at level 
                              
                                 k
                                 +
                                 1
                              
                              , 
                              
                                 ∃
                                 
                                 i
                                 ,
                                 i
                                 ∈
                                 {
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 m
                                 }
                              
                              , such that 
                              
                                 
                                    supp
                                 
                                 (
                                 f
                                 )
                                 ⊆
                                 
                                    supp
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              .
                           

We should check this conclusion for all of the types of the basis functions. Here, we only check this lemma for the first type (in Fig. 9.a) of the basis functions. The others can be verified similarly.

The set 
                                 
                                    supp
                                 
                                 (
                                 f
                                 )
                               consists of 9 cells at level k, which have been marked in Fig. 24
                              .a. The cells at level k are obtained by dividing the cells at level 
                                 k
                                 −
                                 1
                              . Therefore, the cells 
                                 1
                                 ,
                                 2
                                 ,
                                 4
                               and 5, or 
                                 2
                                 ,
                                 3
                                 ,
                                 5
                               and 6, or 
                                 4
                                 ,
                                 5
                                 ,
                                 7
                               and 8, or 
                                 5
                                 ,
                                 6
                                 ,
                                 8
                               and 9 are from the same cell at level 
                                 k
                                 −
                                 1
                              . Here, we suppose the cells 
                                 4
                                 ,
                                 5
                                 ,
                                 7
                               and 8 are from the same cell at level 
                                 k
                                 −
                                 1
                              . In Fig. 24.b, the cells at level 
                                 k
                                 −
                                 1
                               have been bounded by red lines. The standard B-spline whose support is occupied by the four cells at level 
                                 k
                                 −
                                 1
                               is the one we are looking for.  □


                        
                           Lemma 6.3
                           
                              Suppose 
                              
                                 f
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       k
                                    
                                 
                              
                              , 
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       m
                                    
                                 
                               
                              are all of the basis functions at level 
                              
                                 k
                                 +
                                 1
                               
                              whose support is a subset of 
                              
                                 
                                    supp
                                 
                                 (
                                 f
                                 )
                              
                              . Then,
                              
                                 
                                    
                                       
                                          supp
                                       
                                       (
                                       f
                                       )
                                       \
                                       
                                          ⋃
                                          
                                             i
                                             =
                                             1
                                          
                                          m
                                       
                                       
                                          supp
                                       
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ≠
                                       ∅
                                    
                                 
                              
                           

If f is not a standard basis function, 
                                 
                                    supp
                                 
                                 (
                                 f
                                 )
                               consists of at least one cell at level 
                                 k
                                 −
                                 1
                              . However, the support set of the basis functions at level 
                                 k
                                 +
                                 1
                               cannot contain the cells at level 
                                 k
                                 −
                                 1
                              . Therefore, the conclusion is correct for this situation.

If f is a standard basis function, see Fig. 25
                              .a. If not all of the cells 
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       3
                                    
                                 
                               and 
                                 
                                    
                                       c
                                    
                                    
                                       4
                                    
                                 
                               are divided, we can suppose 
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                               is not divided. Then we can check that the cell 
                                 a
                                 ⊈
                                 
                                    
                                       ⋃
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 
                                    supp
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                                 )
                              . If all of 
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       3
                                    
                                 
                               and 
                                 
                                    
                                       c
                                    
                                    
                                       4
                                    
                                 
                               are divided, see Fig. 25.b. Because f is not deleted in the refinement, at least one of 
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       3
                                    
                                 
                               or 
                                 
                                    
                                       v
                                    
                                    
                                       4
                                    
                                 
                               is a type L point in the CVR mesh. Suppose 
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                               is a type L point in the CVR mesh. Then, both 
                                 
                                    
                                       c
                                    
                                    
                                       5
                                    
                                 
                               and 
                                 
                                    
                                       c
                                    
                                    
                                       6
                                    
                                 
                               are not divided. We can also check that the cell 
                                 a
                                 ⊈
                                 
                                    
                                       ⋃
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 
                                    supp
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                                 )
                              .  □


                        
                           Theorem 6.4
                           
                              The functions in 
                              
                                 F
                               
                              are linearly independent.
                           

Suppose 
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       m
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       m
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       n
                                    
                                 
                                 }
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       m
                                    
                                 
                                 }
                              , and 
                                 
                                    lev
                                 
                                 (
                                 T
                                 )
                                 =
                                 N
                              .

For any function f at level 1, from Lemma 6.2, we know that 
                                 
                                    supp
                                 
                                 (
                                 f
                                 )
                               is a subset of the support sets of some functions at level 0. We only choose one of them and call it the mother function of f, which is denoted by 
                                 
                                    
                                       mot
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 f
                                 )
                              . Similarly, we can define 
                                 
                                    
                                       mot
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                                 )
                               for a function 
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                               at level i, where 
                                 1
                                 ⩽
                                 i
                                 ⩽
                                 N
                              . For a function g at level k, we denote 
                                 
                                    
                                       mot
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 
                                    
                                       mot
                                    
                                    
                                       1
                                    
                                 
                                 ⋯
                                 (
                                 
                                    
                                       mot
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 (
                                 g
                                 )
                                 )
                                 ⋯
                                 )
                               as 
                                 
                                    
                                       mot
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 g
                                 )
                              .

Suppose
                                 
                                    (7)
                                    
                                       
                                          ∑
                                          
                                             f
                                             ∈
                                             F
                                          
                                       
                                       c
                                       (
                                       f
                                       )
                                       f
                                       =
                                       0
                                       ,
                                       
                                       c
                                       (
                                       f
                                       )
                                       ∈
                                       R
                                    
                                 
                               We should only prove 
                                 c
                                 (
                                 f
                                 )
                                 =
                                 0
                               for all the 
                                 f
                                 ∈
                                 F
                              .

Let
                                 
                                    
                                       
                                          
                                             g
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   c
                                                   (
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         f
                                                         ∈
                                                         
                                                            
                                                               F
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               mot
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         (
                                                         f
                                                         )
                                                         =
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   c
                                                   (
                                                   f
                                                   )
                                                   f
                                                   +
                                                   ⋯
                                                   +
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         f
                                                         ∈
                                                         
                                                            
                                                               F
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               mot
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         (
                                                         f
                                                         )
                                                         =
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   c
                                                   (
                                                   f
                                                   )
                                                   f
                                                   ,
                                                
                                                
                                                   1
                                                   ⩽
                                                   i
                                                   ⩽
                                                   m
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         f
                                                         ∈
                                                         
                                                            
                                                               F
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               mot
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         (
                                                         f
                                                         )
                                                         =
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   c
                                                   (
                                                   f
                                                   )
                                                   f
                                                   +
                                                   ⋯
                                                   +
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         f
                                                         ∈
                                                         
                                                            
                                                               F
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               mot
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         (
                                                         f
                                                         )
                                                         =
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   c
                                                   (
                                                   f
                                                   )
                                                   f
                                                   ,
                                                
                                                
                                                   m
                                                   +
                                                   1
                                                   ⩽
                                                   i
                                                   ⩽
                                                   n
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                               Equation (7) becomes
                                 
                                    (8)
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          
                                             g
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       0
                                       .
                                    
                                 
                              
                           

From the definition, we know 
                                 
                                    supp
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 
                                    supp
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                                 )
                              . Consider the bottom-left cell α of the mesh 
                                 T
                              . Here “bottom-left” means that there is not a cell whose bottom edge is below α, and among the cells whose bottom edges are in the same horizontal line as α is, α is the leftmost cell. From Lemma 6.1, there is only one function 
                                 
                                    
                                       f
                                    
                                    
                                       j
                                    
                                 
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                 
                               satisfying 
                                 α
                                 ∈
                                 
                                    supp
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       j
                                    
                                 
                                 )
                              , namely 
                                 α
                                 ∈
                                 
                                    supp
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       j
                                    
                                 
                                 )
                              . Therefore, 
                                 
                                    
                                       g
                                    
                                    
                                       j
                                    
                                 
                               is the only non-zero function acting on α. By Equation (8), we obtain 
                                 
                                    
                                       g
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 0
                              .

Excluding 
                                 
                                    
                                       g
                                    
                                    
                                       j
                                    
                                 
                               from Equation (8), we consider the bottom-left cell of the region given by 
                                 T
                                 \
                                 α
                              . Also from Lemma 6.1, there is only one function of 
                                 
                                    
                                       g
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 k
                                 ≠
                                 j
                               that can be non-zero on this cell, and it is zero. Continuing this argument, we obtain 
                                 
                                    
                                       g
                                    
                                    
                                       l
                                    
                                 
                                 =
                                 0
                               for all 
                                 1
                                 ⩽
                                 l
                                 ⩽
                                 n
                              .

From the definition, we know that 
                                 
                                    
                                       ⋃
                                    
                                    
                                       f
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             mot
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       f
                                       )
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    supp
                                 
                                 (
                                 f
                                 )
                                 ⊆
                                 
                                    
                                       ⋃
                                    
                                    
                                       f
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             k
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             mot
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       f
                                       )
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    supp
                                 
                                 (
                                 f
                                 )
                              . Therefore, by Lemma 6.3, we have
                                 
                                    
                                       
                                          supp
                                       
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       \
                                       
                                          ⋃
                                          
                                             k
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          ⋃
                                          
                                             f
                                             ∈
                                             
                                                
                                                   F
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             
                                                
                                                   mot
                                                
                                                
                                                   0
                                                
                                             
                                             (
                                             f
                                             )
                                             =
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          supp
                                       
                                       (
                                       f
                                       )
                                       ⊇
                                       
                                          supp
                                       
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       \
                                       
                                          ⋃
                                          
                                             k
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          ⋃
                                          
                                             f
                                             ∈
                                             
                                                
                                                   F
                                                
                                                
                                                   k
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             
                                                
                                                   mot
                                                
                                                
                                                   0
                                                
                                             
                                             (
                                             f
                                             )
                                             =
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          supp
                                       
                                       (
                                       f
                                       )
                                       =
                                       
                                          supp
                                       
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       \
                                       
                                          ⋃
                                          
                                             f
                                             ∈
                                             
                                                
                                                   F
                                                
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             
                                                
                                                   mot
                                                
                                                
                                                   0
                                                
                                             
                                             (
                                             f
                                             )
                                             =
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          supp
                                       
                                       (
                                       f
                                       )
                                       ≠
                                       ∅
                                       ,
                                    
                                 
                               where 
                                 1
                                 ⩽
                                 i
                                 ⩽
                                 m
                              . Because 
                                 
                                    
                                       g
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 0
                              , we obtain 
                                 c
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 0
                                 ,
                                 1
                                 ⩽
                                 i
                                 ⩽
                                 m
                              .

Now every 
                                 
                                    
                                       g
                                    
                                    
                                       i
                                    
                                 
                               has become:
                                 
                                    
                                       
                                          
                                             g
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             f
                                             ∈
                                             
                                                
                                                   F
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   mot
                                                
                                                
                                                   0
                                                
                                             
                                             (
                                             f
                                             )
                                             =
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       c
                                       (
                                       f
                                       )
                                       f
                                       +
                                       ⋯
                                       +
                                       
                                          ∑
                                          
                                             f
                                             ∈
                                             
                                                
                                                   F
                                                
                                                
                                                   n
                                                
                                             
                                             ,
                                             
                                                
                                                   mot
                                                
                                                
                                                   0
                                                
                                             
                                             (
                                             f
                                             )
                                             =
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       c
                                       (
                                       f
                                       )
                                       f
                                       .
                                    
                                 
                               We can repeat the discussion on every 
                                 
                                    
                                       g
                                    
                                    
                                       i
                                    
                                 
                              , and obtain 
                                 c
                                 (
                                 f
                                 )
                                 =
                                 0
                               when 
                                 f
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       mot
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 f
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                              .

Continuing this process, we prove this theorem.  □

The basis functions are all tensor-product B-splines, so they inherit some properties, such as nonnegativity and local support. From Equation (6) and the linear independence, we know they are complete. Therefore, 
                           F
                         is a basis of 
                           
                              
                                 
                                    S
                                    ‾
                                 
                              
                              
                                 3
                              
                           
                           (
                           T
                           )
                        .

Our new splines are somewhat similar to HB-splines in Vuong et al. (2011), but the two types of splines are different in essence:
                        
                           1.
                           The starting points are different. The starting point of HB-splines is that we first construct the basis, and then add some restrictions to guarantee the completeness. The starting point of our new splines is that we first analyze the spline spaces and the topological explanation of the dimension formula, and then construct the basis.

The basis is different. We have discussed this difference in Section 4. The tensor-product mesh that a basis function is defined on in HB-splines consists of cells from the same level, while the tensor-product mesh that a basis function is defined on in our new splines may consist of cells from different levels.

The starting point of T-splines is the same as HB-splines. The basis (blending functions for more accurate) were constructed as early as in 2003 (Sederberg et al., 2003), while the analysis of the basis begun from 2010 (Buffa et al., 2010). The biggest difference between T-splines and our new splines is that the method of the construction is different. For the same (hierarchical) T-mesh, every vertex is an anchor for T-splines, while only a small part of the vertices are anchors for our new splines.

In this section, we attempt to solve a two-dimensional elliptic boundary value problem (BVP) 
                           −
                           Δ
                           u
                           =
                           f
                         defined on 
                           [
                           0
                           ,
                           1
                           ]
                           ×
                           [
                           0
                           ,
                           1
                           ]
                         with homogeneous conditions. Here 
                           f
                           =
                           −
                           {
                           40
                           
                           000
                           [
                           
                              
                                 (
                                 2
                                 x
                                 −
                                 1
                                 )
                              
                              
                                 2
                              
                           
                           
                              
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 y
                                 )
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 x
                                 )
                              
                              
                                 2
                              
                           
                           
                              
                                 (
                                 2
                                 y
                                 −
                                 1
                                 )
                              
                              
                                 2
                              
                           
                           ]
                           +
                           400
                           (
                           
                              
                                 y
                              
                              
                                 2
                              
                           
                           −
                           y
                           +
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           −
                           x
                           )
                           }
                           
                              
                                 e
                              
                              
                                 200
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 x
                                 )
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 y
                                 )
                              
                           
                        . The exact solution is 
                           u
                           =
                           
                              
                                 e
                              
                              
                                 200
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 x
                                 )
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 y
                                 )
                              
                           
                           −
                           1
                        .

The exact solution is depicted in Fig. 26
                        . Fig. 27
                         shows the adaptive hierarchical T-meshes after 1, 4, 9 and 13 refinements. Fig. 28
                         gives the convergence results for 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                           (
                           T
                           )
                         over hierarchical T-meshes and for 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                           (
                           T
                           )
                         over tensor-product meshes. In Table 1
                         we show the iteration number (n), dimensions of the spline spaces, the CPU time, and the error 
                           
                              
                                 ‖
                                 
                                    
                                       u
                                    
                                    
                                       exact
                                    
                                 
                                 −
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 ‖
                              
                              
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           /
                           
                              
                                 ‖
                                 
                                    
                                       u
                                    
                                    
                                       exact
                                    
                                 
                                 ‖
                              
                              
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         for 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                           (
                           T
                           )
                         over hierarchical T-meshes and for 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                           (
                           T
                           )
                         over tensor-product meshes.

In this section, we give two examples of the application on IGA.

This problem is a benchmark problem: an infinite plate with a circular hole under constant in-plane tension in the x-direction in IGA and can be described as follows. The infinite plate is modeled by a finite quarter plate. The setup is illustrated in Fig. 29
                           . The exact solution evaluated at the boundary of the finite quarter plate is applied as a Neumann boundary condition. Here, 
                              
                                 
                                    T
                                 
                                 
                                    x
                                 
                              
                            is the magnitude of the applied stress for the infinite plate case (we let 
                              
                                 
                                    T
                                 
                                 
                                    x
                                 
                              
                              =
                              10
                            here), R is the radius of the hole, L is the length of the finite quarter plate, E is Young's modulus, and ν is Poisson's ratio.

At the initial tensor-product mesh, the geometry is represented exactly with two patches by rational bicubic B-splines. The geometrical representation remains the same as divisions are being performed. Fig. 30
                            shows the adaptive hierarchical T-meshes after 1, 5, 10, 14 and 18 refinements. Fig. 31
                            is the xy-direction stress error 
                              
                                 
                                    ‖
                                    
                                       
                                          σ
                                       
                                       
                                          exact
                                       
                                    
                                    −
                                    
                                       
                                          σ
                                       
                                       
                                          h
                                       
                                    
                                    ‖
                                 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            after 1, 5 and 10 refinements. Fig. 32
                            gives the convergence results for 
                              
                                 
                                    S
                                 
                                 
                                    3
                                 
                              
                              (
                              T
                              )
                            over hierarchical T-meshes and for 
                              
                                 
                                    S
                                 
                                 
                                    3
                                 
                              
                              (
                              T
                              )
                            over tensor-product meshes. In Table 2
                           , we show the iteration number (n), the dimensions of the spline spaces, the CPU time and the xy-direction stress error 
                              
                                 
                                    ‖
                                    
                                       
                                          σ
                                       
                                       
                                          exact
                                       
                                    
                                    −
                                    
                                       
                                          σ
                                       
                                       
                                          h
                                       
                                    
                                    ‖
                                 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            for 
                              
                                 
                                    S
                                 
                                 
                                    3
                                 
                              
                              (
                              T
                              )
                            over T-meshes and 
                              
                                 
                                    S
                                 
                                 
                                    3
                                 
                              
                              (
                              T
                              )
                            over tensor-product meshes.


                           Fig. 32 and Table 2 both show that the adaptive refinement reaches a given tolerance with slightly fewer degrees of freedom than the uniform refinement with NURBS. This phenomenon has be shown in Dorfel et al. (2010), Vuong et al. (2011), Wang et al. (2011b).

We consider a conduction equation in this part. The geometry of the domain is illustrated in Fig. 33
                           , where 
                              Ω
                              =
                              [
                              −
                              1
                              ,
                              1
                              ]
                              ×
                              [
                              −
                              1
                              ,
                              1
                              ]
                              \
                              [
                              0
                              ,
                              1
                              ]
                              ×
                              [
                              0
                              ,
                              1
                              ]
                           . The heat conduction equation is 
                              −
                              Δ
                              u
                              =
                              0
                            in Ω with a homogeneous condition on 
                              
                                 
                                    Γ
                                 
                                 
                                    D
                                 
                              
                           , and Neumann boundary condition 
                              
                                 
                                    ∂
                                    u
                                 
                                 
                                    ∂
                                    n
                                 
                              
                              =
                              
                                 
                                    ∂
                                    f
                                 
                                 
                                    ∂
                                    n
                                 
                              
                            on 
                              
                                 
                                    Γ
                                 
                                 
                                    N
                                 
                              
                           , where n is outer normal direction, f is an exact solution of the problem and is given here for reference.
                              
                                 
                                    f
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         1
                                                         3
                                                      
                                                   
                                                
                                                sin
                                                ⁡
                                                (
                                                (
                                                2
                                                θ
                                                −
                                                π
                                                )
                                                /
                                                3
                                                )
                                                ,
                                             
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                                ≠
                                                (
                                                0
                                                ,
                                                0
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                             
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                                =
                                                (
                                                0
                                                ,
                                                0
                                                )
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                            where
                              
                                 
                                    θ
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                arccos
                                                ⁡
                                                (
                                                x
                                                /
                                                r
                                                )
                                                ,
                                             
                                             
                                                x
                                                ≤
                                                0
                                                
                                                and
                                                
                                                y
                                                ≥
                                                0
                                                ,
                                             
                                          
                                          
                                             
                                                π
                                                −
                                                arcsin
                                                ⁡
                                                (
                                                y
                                                /
                                                r
                                                )
                                                ,
                                             
                                             
                                                x
                                                ≤
                                                0
                                                
                                                and
                                                
                                                y
                                                ≤
                                                0
                                                ,
                                             
                                          
                                          
                                             
                                                2
                                                π
                                                +
                                                arcsin
                                                ⁡
                                                (
                                                y
                                                /
                                                r
                                                )
                                                ,
                                             
                                             
                                                x
                                                ≥
                                                0
                                                
                                                and
                                                
                                                y
                                                ≤
                                                0
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                           Fig. 34
                            shows the adaptive hierarchical T-meshes after 1, 6 and 12 refinements. Fig. 35
                            gives the convergence results for 
                              
                                 
                                    S
                                 
                                 
                                    3
                                 
                              
                              (
                              T
                              )
                            over hierarchical T-meshes and for 
                              
                                 
                                    S
                                 
                                 
                                    3
                                 
                              
                              (
                              T
                              )
                            over tensor-product meshes. In Table 3
                           , we show the iteration number (n), the dimensions of the spline spaces, the CPU time and the error 
                              
                                 
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          exact
                                       
                                    
                                    −
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    ‖
                                 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            for 
                              
                                 
                                    S
                                 
                                 
                                    3
                                 
                              
                              (
                              T
                              )
                            over T-meshes and 
                              
                                 
                                    S
                                 
                                 
                                    3
                                 
                              
                              (
                              T
                              )
                            over tensor-product meshes.

For this example, the advantage of the adaptive refinement is distinct. From the two examples of the application on IGA, we know that whether the advantage of the adaptive refinement is distinct or not is based on the property of the solution.

Given an open surface triangulation with vertices 
                           
                              
                                 V
                              
                              
                                 j
                              
                           
                        , 
                           j
                           =
                           1
                           ,
                           …
                           ,
                           N
                         in 3D space, the corresponding parameter values 
                           (
                           
                              
                                 u
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           )
                        , 
                           j
                           =
                           1
                           ,
                           …
                           ,
                           N
                         are obtained from shape-preserving parametrization in Floater (1997), and the parameter domain is assumed to be 
                           [
                           0
                           ,
                           1
                           ]
                           ×
                           [
                           0
                           ,
                           1
                           ]
                        . To construct a spline to fit the given surface, we need only to compute all the control points 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        , 
                           i
                           =
                           1
                           ,
                           …
                           ,
                           m
                         associated with all the basis functions 
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                        , 
                           i
                           =
                           1
                           ,
                           …
                           ,
                           m
                        . We denote the fitting spline 
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 m
                              
                           
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                           (
                           u
                           ,
                           v
                           )
                         as 
                           S
                           (
                           u
                           ,
                           v
                           )
                        . To find the control points, we just need to solve an over-determined linear system 
                           S
                           (
                           
                              
                                 u
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           )
                           =
                           
                              
                                 V
                              
                              
                                 j
                              
                           
                        , 
                           j
                           =
                           1
                           ,
                           …
                           ,
                           N
                         using least squares fitting. The surface fitting scheme repeats the following two steps until the fitting error in each cell is less than the given tolerance ε:
                           
                              1.
                              Compute all the control points for all the basis functions.

Find all the 
                                    
                                       
                                          V
                                       
                                       
                                          j
                                       
                                    
                                  whose errors are greater than the given error tolerance ε and the nearest crossing vertices in the T-mesh of 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 . Refine around these crossing vertices to form a new mesh, and construct the basis for the new mesh. We use 
                                    ‖
                                    S
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          V
                                       
                                       
                                          j
                                       
                                    
                                    ‖
                                  to define the fitting error of 
                                    
                                       
                                          V
                                       
                                       
                                          j
                                       
                                    
                                 .


                        Fig. 36
                         is the fitting result of the female head. The iteration number (n), the dimensions of the spline spaces, the max error and the CPU time are shown in Table 4
                        .

@&#CONCLUSIONS AND FUTURE WORK@&#

We discuss the completeness of the bicubic spline spaces over hierarchical T-meshes. The rules of refinement to guarantee the completeness are obtained. Under these rules, the basis are constructed, which have many useful properties for application. The new splines are compared with HB-splines and T-splines. We give three examples for the preliminary applications, which show the efficiency of the new basis.

Although we only discuss bicubic splines in this paper, with the conclusions in Deng et al. (2013), we can analyze biquadratic splines similarly. The difference is that the anchors of the basis functions of biquadratic splines are cells.

In the future, more applications will be explored. The 3-variate case is also a considerable question.

@&#ACKNOWLEDGEMENTS@&#

The authors are supported by a NKBRPC (2011CB302400), the National Natural Science Foundation of China (11426236 and 11371341), and the 111 Project (No. b07033).

@&#REFERENCES@&#

