@&#MAIN-TITLE@&#A new active contour remote sensing river image segmentation algorithm inspired from the cross entropy

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A new active contour image segmentation model is proposed in this paper which measures the cross entropy of the given image and the segmented image.


                        
                        
                           
                           A level set implementation of the new active model is proposed and a distance regularized term is added to the objective functional.


                        
                        
                           
                           A fast global minimization of the new active model is proposed, and the implementation speed of this formulation is fast.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image segmentation

Piecewise constant approximation

CV model

Minimum within-class variance

Cross entropy

Distance regularized term

@&#ABSTRACT@&#


               Graphical abstract
               
                  
               
               
                  
               
            

@&#INTRODUCTION@&#

Image segmentation is one of the most fundamental problems in image processing and computer vision. Among various image segmentation algorithms, level set based image segmentation algorithms have several advantages and various image segmentation algorithms based on level set have been proposed [1–4]. The image segmentation problem is represented as an energy minimization problem and the objective functional is solved by variational methods. The Euler–Lagrange equation of the objective functional can be obtained which guides the evolution of the level set function. The object contour is embedded as the zero level set of an implicit higher dimensional level set function and the evolution of the object contour is realized through the evolution of the level set function. The topology changes can be handled naturally by this method and the segmentation result is achieved when the object functional is minimized.

The existing level set based image segmentation algorithms can roughly be divided into three categories: the edge based level set image segmentation algorithms [1–5], the region based level set image segmentation algorithms [6–11] and the hybrid level set image segmentation algorithms [12–14]. The most typical edge based method is geodesic active contour model [2]. The level set evolves according to an edge indicator function and stops at high contrast image gradients. There are obvious disadvantages of the edge based method such that it is very sensitive to the initial level set position and the level set can easily leak through weak edges. The region based method is thus proposed and the most typical region based method is the CV model [7]. It approximates the original image with two regions with constant grayscale so it is also called piecewise constant model. The region based method is not sensitive to the initial level set position and since the objective functional does not depend on image gradients, it can segment regions with weak edges. The evolution speed is also faster than edge based method. The hybrid method combines the two previous methods and the objective functional depends both on image gradients and region homogeneity.

The basic assumption of CV model is that each segmented region has constant grayscale. The objective functional of CV model can be divided into two parts which contain a smoothness constraint term and a region term. The region term measures the integral of the squared difference between the mean value of the current segmented regions and the grayscale of the original image inside the current segmented regions. When this objective functional gets its minimum, the integral of the squared difference between the mean value and the grayscale of the two segmented regions is minimized. Actually, the integral of the squared difference between the mean value and the grayscale is the variance of that region. The variance of each region must get its minimum when the objective functional is minimized. This procedure is quite similar to the Otsu image thresholding algorithm. The Otsu image thresholding algorithm [15] is also known as maximum between-class variance thresholding algorithm or minimum within-class variance thresholding algorithm which means that a threshold is chosen such that the two segmented regions have maximum between-class variance or minimum within-class variance. From the above analysis, we can see that both methods aim to minimize the variance of the segmented regions and the only difference is the method of determination of the region. In CV model, the method of determination of the region is through a level set function and in Otsu thresholding algorithm, the determination is through a threshold. Through numerical experimentation, we also find that the segmentation results of the two methods are very similar. Since CV model also takes into consideration of the smoothness of the level set and Otsu method does not, their segmentation results are not exactly the same but are very similar. The segmentation results of CV model are always better than those obtained by Otsu method because of the smoothness constraint considered.

In the image thresholding community, there is another widely used image thresholding algorithm which is called cross entropy based image thresholding algorithm [16]. The cross entropy measures an information theoretic distance between two probability distributions. The cross entropy image thresholding algorithm measures the probability distributions of the original image and segmented image. A threshold is chosen such that the distance is minimized. The cross entropy based image thresholding algorithm is similar to Otsu image threshold algorithm. In many cases, to minimize the distribution between the original image and the segmented image is more accurate than minimizing the variance of each segmented regions. The measurement of the distribution can be incorporated in the level set based framework. Inspired from the cross entropy, a new level set image segmentation algorithm is proposed where the region term is based on the measurement of the probability distribution. This new segmentation model can get similar results with cross entropy based image segmentation algorithm but better results can be obtained since the smoothness constraint is taken into consideration in the proposed level set based segmentation model. During the evolution of the level set function, the level set can deviate from the signed distance function and reinitialization is usually needed. To avoid reinitialize the level set function periodically, a distance regularized term [17,18] is added to the objective functional and level set function will tend to be a signed distance function during evolution. Another global minimization algorithm of the objective functional based on a dual formulation of the TV norm [19] is also proposed and the geodesic edge term can be incorporated naturally in the objective functional. Thus this formulation not only measures the probability distributions but also considers image gradient based energy. The implementation speed of the fast global minimization algorithm is very fast compared to the level set based method [20].

The rest of the paper is organized as follows: Section 2 introduces CV model and its relationship with Otsu image thresholding algorithm. Section 3 describes a new image segmentation algorithm and its relationship with cross entropy based image thresholding algorithm. The fast global minimization algorithm of the proposed method is introduced in Section 4. Some experiments applying the proposed method and some closely related level set based methods including CV model [7], minimization of region-scalable fitting energy level set model [8], bias field correction level set model [9], fast global minimization of the geodesic active contour model [20] and fast global minimization of the CV model [20] in segmenting remote sensing river images are presented in Section 5 followed by some concluding remarks in Section 6.

Suppose a given 
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                           ×
                           
                              
                                 N
                              
                              
                                 y
                              
                           
                         image has L grayscale levels represented by [
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           L
                           −
                           1
                        ]. The number of pixels whose grayscale intensity value equals i is 
                           
                              
                                 h
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 0
                              
                              
                                 L
                                 −
                                 1
                              
                           
                           
                              
                                 h
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                           ×
                           
                              
                                 N
                              
                              
                                 y
                              
                           
                        . 
                           
                              
                                 h
                              
                              
                                 i
                              
                           
                         is called the occurring frequency of grayscale i and 
                           
                              
                                 {
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 L
                                 −
                                 1
                              
                           
                         is the grayscale histogram of the given image. The probability of a pixel whose grayscale intensity value equals i is 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                                 ×
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                 
                              
                           
                        . 
                           
                              
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 L
                                 −
                                 1
                              
                           
                         is the normalized grayscale histogram of the given image. Suppose that we segment the pixels into two classes 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         (background and objects, or vice versa) by a threshold at level t
                        Otsu; 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         denotes pixels with levels [
                           0
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 Otsu
                              
                           
                        ], and 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         denotes pixels with levels [
                           
                              
                                 t
                              
                              
                                 Otsu
                              
                           
                           +
                           1
                           ,
                           …
                           ,
                           L
                           −
                           1
                        ]. Then the probabilities of class occurrence and the class mean values, respectively, are given by
                           
                              (1)
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          
                                             t
                                          
                                          
                                             Otsu
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          
                                             
                                                t
                                             
                                             
                                                Otsu
                                             
                                          
                                          +
                                          1
                                       
                                       
                                          L
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         and
                           
                              (3)
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          
                                             t
                                          
                                          
                                             Otsu
                                          
                                       
                                    
                                    i
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                    
                                    /
                                    
                                       
                                          ω
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          
                                             t
                                          
                                          
                                             Otsu
                                          
                                       
                                    
                                    i
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                    
                                    /
                                    
                                       ∑
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          
                                             t
                                          
                                          
                                             Otsu
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          
                                             
                                                t
                                             
                                             
                                                Otsu
                                             
                                          
                                          +
                                          1
                                       
                                       
                                          L
                                          −
                                          1
                                       
                                    
                                    i
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                    
                                    /
                                    
                                       
                                          ω
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          
                                             
                                                t
                                             
                                             
                                                Otsu
                                             
                                          
                                          +
                                          1
                                       
                                       
                                          L
                                          −
                                          1
                                       
                                    
                                    i
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                    
                                    /
                                    
                                       ∑
                                       
                                          j
                                          =
                                          
                                             
                                                t
                                             
                                             
                                                Otsu
                                             
                                          
                                          +
                                          1
                                       
                                       
                                          L
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           
                         are the zeroth-order and the first-order cumulative moments of the normalized histogram up to the 
                           
                              
                                 t
                              
                              
                                 Otsu
                              
                           
                        th level, respectively.

The class variances are given by
                           
                              (5)
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          0
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          
                                             t
                                          
                                          
                                             Otsu
                                          
                                       
                                    
                                    
                                       
                                          (
                                          i
                                          −
                                          
                                             
                                                μ
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                    
                                    /
                                    
                                       
                                          ω
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          
                                             t
                                          
                                          
                                             Otsu
                                          
                                       
                                    
                                    
                                       
                                          (
                                          i
                                          −
                                          
                                             
                                                μ
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                    
                                    /
                                    
                                       ∑
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          
                                             t
                                          
                                          
                                             Otsu
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             =
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         Otsu
                                                      
                                                   
                                                   +
                                                   1
                                                
                                                
                                                   L
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   (
                                                   i
                                                   −
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   p
                                                
                                                
                                                   i
                                                
                                             
                                             /
                                             
                                                
                                                   ω
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         Otsu
                                                      
                                                   
                                                   +
                                                   1
                                                
                                                
                                                   L
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   (
                                                   i
                                                   −
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   p
                                                
                                                
                                                   i
                                                
                                             
                                             /
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         Otsu
                                                      
                                                   
                                                   +
                                                   1
                                                
                                                
                                                   L
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   p
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         which are second-order cumulative moments.

In order to evaluate the “goodness” of the threshold (at level 
                           
                              
                                 t
                              
                              
                                 Otsu
                              
                           
                        ), we shall introduce the following discriminant criterion measure (or measure of class separability)
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                Otsu
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                Otsu
                                             
                                          
                                          )
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                0
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                ω
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   Otsu
                                                
                                             
                                          
                                          
                                             
                                                (
                                                i
                                                −
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                p
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      Otsu
                                                   
                                                
                                                +
                                                1
                                             
                                             
                                                L
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                (
                                                i
                                                −
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                p
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                         which is the within-class variance. Then our problem is reduced to an optimization problem to search for a threshold 
                           
                              
                                 t
                              
                              
                                 Otsu
                              
                           
                         that minimizes the criterion measure [15]. This can be stated as follows
                           
                              (8)
                              
                                 
                                    
                                       t
                                    
                                    
                                       Otsu
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 
                                    
                                       argmin
                                    
                                    
                                       
                                          t
                                       
                                       
                                          Otsu
                                       
                                    
                                 
                                 
                                 
                                    {
                                    
                                       
                                          σ
                                       
                                       
                                          Otsu
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          Otsu
                                       
                                    
                                    )
                                    }
                                 
                              
                           
                         the threshold 
                           
                              
                                 t
                              
                              
                                 Otsu
                              
                              
                                 ⁎
                              
                           
                         can be used to segment the given image into two regions.

Let us define the evolving curve C in Ω, as the boundary of a closed subset 
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                         of Ω (i.e. 
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                           ⊂
                           Ω
                         and 
                           C
                           =
                           ∂
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                        ). Ω is the image domain. Then the given image can be segmented into two regions which are 
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                         and 
                           Ω
                           \
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                        . The objective functional of the piecewise constant active contour model is given as follows
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                PC
                                             
                                          
                                          (
                                          
                                             
                                                Ω
                                             
                                             
                                                C
                                             
                                          
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          λ
                                          ,
                                          μ
                                          )
                                       
                                    
                                    
                                       
                                          
                                          =
                                          μ
                                          Per
                                          (
                                          
                                             
                                                Ω
                                             
                                             
                                                C
                                             
                                          
                                          )
                                          +
                                          λ
                                          
                                             [
                                             
                                                ∫
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      C
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   f
                                                   (
                                                   x
                                                   )
                                                   −
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             d
                                             x
                                             +
                                             
                                                ∫
                                                
                                                   Ω
                                                   \
                                                   
                                                      
                                                         Ω
                                                      
                                                      
                                                         C
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   f
                                                   (
                                                   x
                                                   )
                                                   −
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             d
                                             x
                                             ]
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 E
                              
                              
                                 PC
                              
                           
                         is the energy of the piecewise constant active contour model, f is the given image, 
                           Per
                           (
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                           )
                         is the perimeter of the set 
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                        , λ and μ are two arbitrary positive parameters which control the tradeoff between the regularization process and the fidelity of the solution with respect to the original image f and 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                           ∈
                           R
                        . The variational model (9) determines the best approximation, in the 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                         sense of the image f as a set of (non-connected) regions with only two different values, 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                        . If 
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                         is fixed, the values of 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                         which minimize the energy 
                           
                              
                                 E
                              
                              
                                 PC
                              
                           
                         are the mean values inside and outside 
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                        . The term 
                           Per
                           (
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                           )
                         imposes a smoothness constraint on the geometry of the set 
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                         which separates the piecewise constant regions. 
                           Per
                           (
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                           )
                         can be chosen to be the length of the evolving curve C. The objective is to find the region 
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                         such that the objective functional is minimized
                           
                              (10)
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       C
                                    
                                 
                                 =
                                 
                                    
                                       argmin
                                    
                                    
                                       
                                          Ω
                                       
                                       
                                          C
                                       
                                    
                                 
                                 
                                 
                                    {
                                    
                                       
                                          E
                                       
                                       
                                          PC
                                       
                                    
                                    (
                                    
                                       
                                          Ω
                                       
                                       
                                          C
                                       
                                    
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    λ
                                    ,
                                    μ
                                    )
                                    }
                                 
                              
                           
                         and 
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                         can be used to segment the given image into two regions.

Chan and Vese proposed in [7] a solution to determine an evolution equation for the region 
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                         based on a level set based approach. They represent the regions 
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                         and 
                           Ω
                           \
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                         with the Heaviside function of a level set function (which models a characteristic function). Hence the energy 
                           
                              
                                 E
                              
                              
                                 PC
                              
                           
                         can be written according to a level set function ϕ
                        
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ϕ
                                                ;
                                                
                                                   PC
                                                
                                             
                                          
                                          (
                                          ϕ
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          λ
                                          ,
                                          μ
                                          )
                                       
                                    
                                    
                                       
                                          
                                          =
                                          μ
                                          
                                             ∫
                                             Ω
                                          
                                          
                                             |
                                             ∇
                                             
                                                
                                                   H
                                                
                                                
                                                   ε
                                                
                                             
                                             (
                                             ϕ
                                             )
                                             |
                                          
                                          d
                                          x
                                          +
                                          λ
                                          
                                             ∫
                                             Ω
                                          
                                          
                                             
                                                H
                                             
                                             
                                                ε
                                             
                                          
                                          (
                                          ϕ
                                          )
                                          
                                             
                                                (
                                                f
                                                (
                                                x
                                                )
                                                −
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          +
                                          
                                             (
                                             1
                                             −
                                             
                                                
                                                   H
                                                
                                                
                                                   ε
                                                
                                             
                                             (
                                             ϕ
                                             )
                                             )
                                          
                                          
                                             
                                                (
                                                f
                                                (
                                                x
                                                )
                                                −
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          d
                                          x
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 H
                              
                              
                                 ε
                              
                           
                           (
                           ϕ
                           )
                         is a regularization of the Heaviside function. The flow minimizing energy (11) is the following one
                           
                              (12)
                              
                                 
                                    
                                       ∂
                                       ϕ
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       H
                                    
                                    
                                       ε
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 ϕ
                                 )
                                 
                                    [
                                    μ
                                    div
                                    
                                    
                                       (
                                       
                                          
                                             ∇
                                             ϕ
                                          
                                          
                                             |
                                             ∇
                                             ϕ
                                             |
                                          
                                       
                                       )
                                    
                                    −
                                    λ
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   (
                                                   f
                                                   (
                                                   x
                                                   )
                                                   −
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   (
                                                   f
                                                   (
                                                   x
                                                   )
                                                   −
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          ︸
                                       
                                       
                                          =
                                          
                                             
                                                r
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          x
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                    ]
                                 
                              
                           
                         Equation (12) can be solved by finite difference method iteratively and the final segmentation can be obtained as the steady state solution of the above equation.

Comparing the objective functional (7) of Otsu image thresholding algorithm and the objective functional (9) of CV model, we can find that there are several similarities between them. First, both the objective functionals segment the given image into two regions. Specifically, in the Otsu image thresholding algorithm, a threshold 
                           
                              
                                 t
                              
                              
                                 Otsu
                              
                           
                         is chosen and the image is segmented according to the relationship between the grayscale of the given image with the threshold 
                           
                              
                                 t
                              
                              
                                 Otsu
                              
                           
                        
                        
                           
                              (13)
                              
                                 x
                                 ∈
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                          
                                          
                                             f
                                             (
                                             x
                                             )
                                             ≤
                                             
                                                
                                                   t
                                                
                                                
                                                   Otsu
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                          
                                          
                                             f
                                             (
                                             x
                                             )
                                             >
                                             
                                                
                                                   t
                                                
                                                
                                                   Otsu
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         While in CV model, a set 
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                         is defined and the pixels are segmented according to whether the pixel belongs to the set 
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                         or not
                           
                              (14)
                              
                                 x
                                 ∈
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                          
                                          
                                             x
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   C
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                          
                                          
                                             x
                                             ∈
                                             Ω
                                             \
                                             
                                                
                                                   Ω
                                                
                                                
                                                   C
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         Second, both the objective functionals aim to minimize a discriminant criterion which is the within-class variance. Specially, in Otsu method, the within-class variance is represented by the right hand side of equation (7) through normalized grayscale histogram while in CV model, the within-class variance is represented by the following region term through the set 
                           
                              
                                 Ω
                              
                              
                                 C
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       PC
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          Ω
                                       
                                       
                                          C
                                       
                                    
                                 
                                 
                                    
                                       (
                                       f
                                       (
                                       x
                                       )
                                       −
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 d
                                 x
                                 +
                                 
                                    ∫
                                    
                                       Ω
                                       \
                                       
                                          
                                             Ω
                                          
                                          
                                             C
                                          
                                       
                                    
                                 
                                 
                                    
                                       (
                                       f
                                       (
                                       x
                                       )
                                       −
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 d
                                 x
                              
                           
                         Comparing the right hand side of equation (7) and equation (15), we can see that they are actually equivalent except that they are represented by different formulations. Though the above analysis, we can say that Otsu image thresholding method is nearly equivalent to CV model and both methods find a segmentation of the given image such that the within-class variance is minimized. We will further analyze their similarity in Section 5.

Cross entropy measures the distance between two probability distributions. Let 
                           P
                           =
                           {
                           
                              
                                 p
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 p
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 p
                              
                              
                                 n
                              
                           
                           }
                         and 
                           Q
                           =
                           {
                           
                              
                                 q
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 q
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 q
                              
                              
                                 n
                              
                           
                           }
                         be two probability distributions, then the cross entropy, 
                           D
                           (
                           P
                           ,
                           Q
                           )
                         is defined as follows
                           
                              (16)
                              
                                 D
                                 (
                                 P
                                 ,
                                 Q
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 log
                                 ⁡
                                 
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        
                     

Suppose we choose a threshold 
                           
                              
                                 t
                              
                              
                                 cross
                              
                           
                         to segment the pixels into two class 
                           
                              
                                 C
                              
                              
                                 0
                                 ;
                                 cross
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 1
                                 ;
                                 cross
                              
                           
                         where 
                           
                              
                                 C
                              
                              
                                 0
                                 ;
                                 cross
                              
                           
                         denotes pixels with grayscale levels [
                           0
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 cross
                              
                           
                        ] and 
                           
                              
                                 C
                              
                              
                                 1
                                 ;
                                 cross
                              
                           
                         denotes pixels with grayscale levels [
                           
                              
                                 t
                              
                              
                                 cross
                              
                           
                           +
                           1
                           ,
                           …
                           ,
                           L
                           −
                           1
                        ]. We can formulate the given image and the segmented image by two probability distributions which are
                           
                              (17)
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          {
                                          
                                             
                                                f
                                                (
                                                x
                                                )
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      0
                                                   
                                                   
                                                      L
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      i
                                                   
                                                
                                                i
                                             
                                          
                                          }
                                       
                                       
                                          x
                                          ∈
                                          Ω
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      s
                                                   
                                                
                                                (
                                                x
                                                )
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      0
                                                   
                                                   
                                                      L
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      i
                                                   
                                                
                                                i
                                             
                                          
                                          }
                                       
                                       
                                          x
                                          ∈
                                          Ω
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         are the probability distributions of the given image and the segmented image respectively, 
                           
                              
                                 f
                              
                              
                                 s
                              
                           
                           (
                           x
                           )
                         is the segmented image and can be represented as follows
                           
                              (19)
                              
                                 
                                    
                                       f
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                          
                                          
                                             f
                                             (
                                             x
                                             )
                                             ≤
                                             
                                                
                                                   t
                                                
                                                
                                                   cross
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                          
                                          
                                             f
                                             (
                                             x
                                             )
                                             >
                                             
                                                
                                                   t
                                                
                                                
                                                   cross
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 μ
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 μ
                              
                              
                                 1
                              
                           
                         are the mean values of 
                           
                              
                                 C
                              
                              
                                 0
                                 ;
                                 cross
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 1
                                 ;
                                 cross
                              
                           
                         which can be calculated similarly as in equations (3) and (4). Using these two probability distributions, the cross entropy between the given image and the segmented image can be computed as follows
                           
                              (20)
                              
                                 
                                    
                                       
                                          D
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                P
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          =
                                       
                                       
                                          
                                             ∑
                                             
                                                f
                                                (
                                                x
                                                )
                                                ≤
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      cross
                                                   
                                                
                                             
                                          
                                          
                                             
                                                f
                                                (
                                                x
                                                )
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      0
                                                   
                                                   
                                                      L
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      i
                                                   
                                                
                                                i
                                             
                                          
                                          log
                                          ⁡
                                          
                                             (
                                             
                                                
                                                   f
                                                   (
                                                   x
                                                   )
                                                   /
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         0
                                                      
                                                      
                                                         L
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   i
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                   /
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         0
                                                      
                                                      
                                                         L
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             ∑
                                             
                                                f
                                                (
                                                x
                                                )
                                                >
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      cross
                                                   
                                                
                                             
                                          
                                          
                                             
                                                f
                                                (
                                                x
                                                )
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      0
                                                   
                                                   
                                                      L
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      i
                                                   
                                                
                                                i
                                             
                                          
                                          log
                                          ⁡
                                          
                                             (
                                             
                                                
                                                   f
                                                   (
                                                   x
                                                   )
                                                   /
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         0
                                                      
                                                      
                                                         L
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   i
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                   /
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         0
                                                      
                                                      
                                                         L
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   cross
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      i
                                                   
                                                
                                                i
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      0
                                                   
                                                   
                                                      L
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      i
                                                   
                                                
                                                i
                                             
                                          
                                          log
                                          ⁡
                                          
                                             (
                                             
                                                i
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      cross
                                                   
                                                
                                                +
                                                1
                                             
                                             
                                                L
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      i
                                                   
                                                
                                                i
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      0
                                                   
                                                   
                                                      L
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      i
                                                   
                                                
                                                i
                                             
                                          
                                          log
                                          ⁡
                                          
                                             (
                                             
                                                i
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             1
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      0
                                                   
                                                   
                                                      L
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      i
                                                   
                                                
                                                i
                                             
                                          
                                          
                                             [
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      cross
                                                   
                                                
                                             
                                             
                                                
                                                   h
                                                
                                                
                                                   i
                                                
                                             
                                             i
                                             log
                                             ⁡
                                             
                                                (
                                                
                                                   i
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      cross
                                                   
                                                
                                                +
                                                1
                                             
                                             
                                                L
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          i
                                          log
                                          ⁡
                                          
                                             (
                                             
                                                i
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             )
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                         Using the above formula, a threshold selection criterion can be defined as follows
                           
                              (21)
                              
                                 η
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       cross
                                    
                                 
                                 )
                                 =
                                 
                                    [
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          
                                             t
                                          
                                          
                                             cross
                                          
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    i
                                    log
                                    ⁡
                                    
                                       (
                                       
                                          i
                                          
                                             
                                                μ
                                             
                                             
                                                0
                                             
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       ∑
                                       
                                          i
                                          =
                                          
                                             
                                                t
                                             
                                             
                                                cross
                                             
                                          
                                          +
                                          1
                                       
                                       
                                          L
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    i
                                    log
                                    ⁡
                                    
                                       (
                                       
                                          i
                                          
                                             
                                                μ
                                             
                                             
                                                1
                                             
                                          
                                       
                                       )
                                    
                                    ]
                                 
                              
                           
                         The threshold is chosen such that the criterion is minimized which means the cross entropy of the given image and the segmented image is minimized
                           
                              (22)
                              
                                 
                                    
                                       t
                                    
                                    
                                       cross
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 
                                    
                                       argmin
                                    
                                    
                                       
                                          t
                                       
                                       
                                          cross
                                       
                                    
                                 
                                 
                                 
                                    (
                                    η
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          cross
                                       
                                    
                                    )
                                    )
                                 
                              
                           
                        
                     

The cross entropy based image thresholding algorithm is similar to the Otsu image segmentation method but they are different from their definition. The Otsu image thresholding method finds a threshold such that the within-class variance is minimized while the cross entropy based image thresholding algorithm finds a threshold such that the cross entropy between the given image and the segmented image is minimized. In many situations, the cross entropy based method can segment image more accurately.

Inspired from the similarity between the Otsu image thresholding algorithm and CV model, we can define a new active contour image segmentation algorithm based on the definition of the cross entropy. The objective functional of the new active contour model is defined as follows
                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                cross
                                             
                                          
                                          (
                                          
                                             
                                                Ω
                                             
                                             
                                                C
                                             
                                          
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          λ
                                          ,
                                          μ
                                          )
                                       
                                    
                                    
                                       
                                          
                                          =
                                          μ
                                          Per
                                          (
                                          
                                             
                                                Ω
                                             
                                             
                                                C
                                             
                                          
                                          )
                                          +
                                          λ
                                          
                                             [
                                             
                                             
                                                ∫
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      C
                                                   
                                                
                                             
                                             f
                                             (
                                             x
                                             )
                                             
                                                |
                                                log
                                                ⁡
                                                
                                                   (
                                                   
                                                      
                                                         f
                                                         (
                                                         x
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         +
                                                         δ
                                                      
                                                   
                                                   )
                                                
                                                |
                                             
                                             d
                                             x
                                          
                                       
                                    
                                    
                                       
                                          
                                          +
                                          
                                             ∫
                                             
                                                Ω
                                                \
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      C
                                                   
                                                
                                             
                                          
                                          f
                                          (
                                          x
                                          )
                                          
                                             |
                                             log
                                             ⁡
                                             
                                                (
                                                
                                                   
                                                      f
                                                      (
                                                      x
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      δ
                                                   
                                                
                                                )
                                             
                                             |
                                          
                                          d
                                          x
                                          ]
                                       
                                    
                                 
                              
                           
                         where the small constant δ is chosen to prevent the denominate to be 0 and in all the experiments in this paper, δ is chosen to be 
                           
                              
                                 10
                              
                              
                                 −
                                 4
                              
                           
                        . This is the active contour model based on cross entropy and we can see the difference between CV model and the similarity between the cross entropy based image thresholding algorithm. The region term in the CV model which computes the variance is replaced by a term which computes the cross entropy. This new active contour model aims to minimize the cross entropy between the given image and the segmented image just as CV model aims to minimize the within-class variance. Similar to [7], this objective functional can be represented by a level set formulation as follows
                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ϕ
                                                ;
                                                cross
                                             
                                          
                                          (
                                          
                                             
                                                Ω
                                             
                                             
                                                C
                                             
                                          
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          λ
                                          ,
                                          μ
                                          )
                                       
                                    
                                    
                                       
                                          
                                          =
                                          μ
                                          
                                             ∫
                                             Ω
                                          
                                          
                                             |
                                             ∇
                                             
                                                
                                                   H
                                                
                                                
                                                   ε
                                                
                                             
                                             (
                                             ϕ
                                             )
                                             |
                                          
                                          d
                                          x
                                          +
                                          λ
                                          
                                             ∫
                                             Ω
                                          
                                          
                                             
                                                H
                                             
                                             
                                                ε
                                             
                                          
                                          (
                                          ϕ
                                          )
                                          f
                                          (
                                          x
                                          )
                                          
                                             |
                                             log
                                             ⁡
                                             
                                                (
                                                
                                                   
                                                      f
                                                      (
                                                      x
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      δ
                                                   
                                                
                                                )
                                             
                                             |
                                          
                                       
                                    
                                    
                                       
                                          
                                          +
                                          
                                             (
                                             1
                                             −
                                             
                                                
                                                   H
                                                
                                                
                                                   ε
                                                
                                             
                                             (
                                             ϕ
                                             )
                                             )
                                          
                                          f
                                          (
                                          x
                                          )
                                          
                                             |
                                             log
                                             ⁡
                                             
                                                (
                                                
                                                   
                                                      f
                                                      (
                                                      x
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      δ
                                                   
                                                
                                                )
                                             
                                             |
                                          
                                          d
                                          x
                                       
                                    
                                 
                              
                           
                         The flow minimizing energy (24) is the following one
                           
                              (25)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                ϕ
                                             
                                             
                                                ∂
                                                t
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ε
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          ϕ
                                          )
                                          
                                             [
                                             μ
                                             div
                                             
                                             
                                                (
                                                
                                                   
                                                      ∇
                                                      ϕ
                                                   
                                                   
                                                      |
                                                      ∇
                                                      ϕ
                                                      |
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          −
                                          λ
                                          
                                             
                                                
                                                   (
                                                   f
                                                   (
                                                   x
                                                   )
                                                   
                                                      |
                                                      log
                                                      ⁡
                                                      
                                                         (
                                                         
                                                            
                                                               f
                                                               (
                                                               x
                                                               )
                                                            
                                                            
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               +
                                                               δ
                                                            
                                                         
                                                         )
                                                      
                                                      |
                                                   
                                                   −
                                                   f
                                                   (
                                                   x
                                                   )
                                                   
                                                      |
                                                      log
                                                      ⁡
                                                      
                                                         (
                                                         
                                                            
                                                               f
                                                               (
                                                               x
                                                               )
                                                            
                                                            
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               +
                                                               δ
                                                            
                                                         
                                                         )
                                                      
                                                      |
                                                   
                                                   )
                                                
                                                ︸
                                             
                                             
                                                =
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                x
                                                ,
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                         It can be solved iteratively and the steady state solution of the above equation can be used to segment the given image.

The initial level set function is usually chosen as a signed distance function and during the evolution of the level set function, it can deviate from the signed distance function. To make the evolution of the level set function stable, reinitialization is usually needed. The level set function is reinitialized to the signed distance function periodically during the evolution process. To avoid the reinitialization process, a distance regularized term is added to the objective functional (24) and can be given as follows
                           
                              (26)
                              
                                 
                                    
                                       E
                                    
                                    
                                       ϕ
                                       ;
                                       cross
                                    
                                    
                                       r
                                    
                                 
                                 =
                                 
                                    
                                       E
                                    
                                    
                                       ϕ
                                       ;
                                       cross
                                    
                                 
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    ∫
                                    Ω
                                 
                                 p
                                 
                                    (
                                    |
                                    ∇
                                    ϕ
                                    |
                                    )
                                 
                                 d
                                 x
                              
                           
                         where the potential function p is given as follows [18]
                        
                           
                              (27)
                              
                                 p
                                 (
                                 s
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                1
                                                
                                                   
                                                      (
                                                      2
                                                      π
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             (
                                             1
                                             −
                                             cos
                                             ⁡
                                             (
                                             2
                                             π
                                             s
                                             )
                                             )
                                             ,
                                          
                                          
                                             if
                                             
                                             s
                                             ≤
                                             1
                                          
                                       
                                       
                                          
                                             
                                                1
                                                2
                                             
                                             
                                                
                                                   (
                                                   s
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                          
                                          
                                             if
                                             
                                             s
                                             ≥
                                             1
                                          
                                       
                                    
                                 
                              
                           
                         This potential 
                           p
                           (
                           s
                           )
                         has two minimum points at 
                           s
                           =
                           0
                         and 
                           s
                           =
                           1
                         and it can regularize the level set function through a forward and backward diffusion process. The regularization principle can be explained briefly as follows. The Gateaux derivative of the functional 
                           
                              
                                 R
                              
                              
                                 p
                              
                           
                           (
                           ϕ
                           )
                           =
                           
                              
                                 μ
                              
                              
                                 2
                              
                           
                           
                              
                                 ∫
                              
                              
                                 Ω
                              
                           
                           p
                           (
                           |
                           ∇
                           ϕ
                           |
                           )
                           d
                           x
                         is
                           
                              (28)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             R
                                          
                                          
                                             p
                                          
                                       
                                       (
                                       ϕ
                                       )
                                    
                                    
                                       ∂
                                       ϕ
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                                 div
                                 
                                 
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          p
                                       
                                    
                                    
                                       (
                                       |
                                       ∇
                                       ϕ
                                       |
                                       )
                                    
                                    ∇
                                    ϕ
                                    )
                                 
                              
                           
                         where 
                           div
                           (
                           ⋅
                           )
                         is the divergence operator and 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                         is a function defined by
                           
                              (29)
                              
                                 
                                    
                                       d
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       s
                                       )
                                    
                                    s
                                 
                              
                           
                         The distance regularization effect can be seen from the gradient flow of the energy
                           
                              (30)
                              
                                 
                                    
                                       ∂
                                       ϕ
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                                 div
                                 
                                 
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          p
                                       
                                    
                                    
                                       (
                                       |
                                       ∇
                                       ϕ
                                       |
                                       )
                                    
                                    ∇
                                    ϕ
                                    )
                                 
                              
                           
                        
                     

The sign of the function 
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           (
                           s
                           )
                         indicates the property of the forward and backward diffusion in the following cases: for 
                           |
                           ∇
                           ϕ
                           |
                           >
                           1
                        , the diffusion rate 
                           
                              
                                 μ
                              
                              
                                 2
                              
                           
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           (
                           |
                           ∇
                           ϕ
                           |
                           )
                         is positive, and the diffusion (30) is forward, which decreases 
                           |
                           ∇
                           ϕ
                           |
                        ; for 
                           (
                           1
                           /
                           2
                           )
                           <
                           |
                           ∇
                           ϕ
                           |
                           <
                           1
                        , the diffusion rate 
                           
                              
                                 μ
                              
                              
                                 2
                              
                           
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           (
                           |
                           ∇
                           ϕ
                           |
                           )
                         is negative, and the diffusion (30) becomes backward, which increases 
                           |
                           ∇
                           ϕ
                           |
                        , for 
                           |
                           ∇
                           ϕ
                           |
                           <
                           1
                           /
                           2
                        , the diffusion rate 
                           
                              
                                 μ
                              
                              
                                 2
                              
                           
                           
                              
                                 d
                              
                              
                                 p
                              
                           
                           (
                           |
                           ∇
                           ϕ
                           |
                           )
                         is positive, and the diffusion (30) is forward, which further decreases 
                           |
                           ∇
                           ϕ
                           |
                         down to zero. After adding this distance regularized term, equation (25) changes to
                           
                              (31)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                ϕ
                                             
                                             
                                                ∂
                                                t
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ε
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          ϕ
                                          )
                                          
                                             [
                                             μ
                                             div
                                             
                                             
                                                (
                                                
                                                   
                                                      ∇
                                                      ϕ
                                                   
                                                   
                                                      |
                                                      ∇
                                                      ϕ
                                                      |
                                                   
                                                
                                                )
                                             
                                             −
                                             λ
                                             
                                                
                                                   r
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             x
                                             ,
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             ]
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             
                                                μ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             [
                                             div
                                             
                                             
                                                (
                                                
                                                   
                                                      sin
                                                      ⁡
                                                      (
                                                      2
                                                      π
                                                      |
                                                      ∇
                                                      ϕ
                                                      (
                                                      x
                                                      )
                                                      |
                                                      )
                                                   
                                                   
                                                      2
                                                      π
                                                      |
                                                      ∇
                                                      ϕ
                                                      (
                                                      x
                                                      )
                                                      |
                                                   
                                                
                                                ∇
                                                ϕ
                                                (
                                                x
                                                )
                                                )
                                             
                                             H
                                             
                                                (
                                                1
                                                −
                                                
                                                   |
                                                   ∇
                                                   ϕ
                                                   (
                                                   x
                                                   )
                                                   |
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          div
                                          
                                          
                                             (
                                             ∇
                                             ϕ
                                             (
                                             x
                                             )
                                             −
                                             
                                                
                                                   ∇
                                                   ϕ
                                                   (
                                                   x
                                                   )
                                                
                                                
                                                   |
                                                   ∇
                                                   ϕ
                                                   (
                                                   x
                                                   )
                                                   |
                                                
                                             
                                             )
                                          
                                          H
                                          
                                             (
                                             
                                                |
                                                ∇
                                                ϕ
                                                (
                                                x
                                                )
                                                |
                                             
                                             −
                                             1
                                             )
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                        
                     

Using equation (31) to solve for the level set evolution, the level set will tend to be a signed distance function and it will not be reinitialized periodically thus reducing the computation time.

In [20], the authors propose a fast global minimization algorithm of CV model based on a dual formulation of the TV-norm. The objective functional can be written as
                        
                           (32)
                           
                              
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             global
                                             ;
                                             
                                                PC
                                             
                                          
                                       
                                       (
                                       u
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       λ
                                       )
                                    
                                 
                                 
                                    
                                       
                                       =
                                       
                                          
                                             TV
                                          
                                          
                                             g
                                          
                                       
                                       (
                                       u
                                       )
                                       +
                                       λ
                                       
                                          ∫
                                          Ω
                                       
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       x
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       u
                                       d
                                       x
                                       
                                       
                                          (
                                          0
                                          ≤
                                          u
                                          (
                                          x
                                          )
                                          ≤
                                          L
                                          −
                                          1
                                          )
                                       
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              TV
                           
                           
                              g
                           
                        
                        (
                        u
                        )
                        =
                        
                           
                              ∫
                           
                           
                              Ω
                           
                        
                        g
                        (
                        x
                        )
                        |
                        ∇
                        u
                        |
                        d
                        x
                      is the weighed TV-norm and 
                        g
                        (
                        x
                        )
                        =
                        
                           1
                           
                              1
                              +
                              β
                              
                                 
                                    |
                                    ∇
                                    f
                                    (
                                    x
                                    )
                                    |
                                 
                                 
                                    2
                                 
                              
                           
                        
                      is an edge indicator function that vanishes at object boundaries and β is an arbitrary positive constant. In all the experiments in this paper, β is chosen to be 1. The condition 
                        0
                        ≤
                        u
                        (
                        x
                        )
                        ≤
                        L
                        −
                        1
                      must be obeyed and the above minimization problem is actually a constraint minimization problem. The weighed TV-norm equals the energy functional of the geodesic active contour (GAC) model when g is an edge indicator function and the function u is a characteristic function 
                        
                           
                              1
                           
                           
                              
                                 
                                    Ω
                                 
                                 
                                    C
                                 
                              
                           
                        
                     , of a closed set 
                        
                           
                              Ω
                           
                           
                              C
                           
                        
                        ⊂
                        Ω
                     . Their equivalence can be shown as follows
                        
                           (33)
                           
                              
                                 
                                    TV
                                 
                                 
                                    g
                                 
                              
                              (
                              u
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          Ω
                                       
                                       
                                          C
                                       
                                    
                                 
                              
                              )
                              =
                              
                                 ∫
                                 Ω
                              
                              g
                              (
                              x
                              )
                              |
                              ∇
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          Ω
                                       
                                       
                                          C
                                       
                                    
                                 
                              
                              |
                              d
                              x
                              =
                              
                                 ∫
                                 C
                              
                              g
                              (
                              s
                              )
                              d
                              s
                              =
                              
                                 
                                    E
                                 
                                 
                                    GAC
                                 
                              
                              (
                              C
                              )
                           
                        
                      Hence, minimizing energy (32) is equivalent to
                        
                           
                              
                                 minimize
                                 
                                 
                                    ∫
                                    C
                                 
                                 g
                                 d
                                 s
                                 =
                                 
                                    
                                       E
                                    
                                    
                                       GAC
                                    
                                 
                                 (
                                 C
                                 )
                                 
                                 (the GAC energy)
                              
                           
                        
                      while approximating f (in the 
                        
                           
                              L
                           
                           
                              2
                           
                        
                      sense) by two regions 
                        
                           
                              Ω
                           
                           
                              C
                           
                        
                      and 
                        Ω
                        \
                        
                           
                              Ω
                           
                           
                              C
                           
                        
                      with two values 
                        
                           
                              c
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              c
                           
                           
                              2
                           
                        
                     . The authors then convert the constraint minimization problem (32) to a convex and unconstrained minimization problem and use an alternate minimization method to get the global minimization solution. Since the proposed energy functional (23) is similar to CV model, a fast global minimization algorithm based on a dual formulation of the TV-norm can be also given for the proposed energy functional. The global minimization objective functional can be given as follows
                        
                           (34)
                           
                              
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             global
                                             ;
                                             cross
                                          
                                       
                                       (
                                       u
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       λ
                                       )
                                    
                                 
                                 
                                    
                                       
                                       =
                                       
                                          
                                             TV
                                          
                                          
                                             g
                                          
                                       
                                       (
                                       u
                                       )
                                       +
                                       λ
                                       
                                          ∫
                                          Ω
                                       
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       x
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       u
                                       d
                                       x
                                       
                                       
                                          (
                                          0
                                          ≤
                                          u
                                          (
                                          x
                                          )
                                          ≤
                                          L
                                          −
                                          1
                                          )
                                       
                                    
                                 
                              
                           
                        
                      The only difference between equation (34) and equation (32) is that 
                        
                           
                              r
                           
                           
                              1
                           
                        
                        (
                        x
                        ,
                        
                           
                              c
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              c
                           
                           
                              2
                           
                        
                        )
                      is replaced by 
                        
                           
                              r
                           
                           
                              2
                           
                        
                        (
                        x
                        ,
                        
                           
                              c
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              c
                           
                           
                              2
                           
                        
                        )
                     . Hence, minimizing energy (34) is equivalent to
                        
                           
                              
                                 minimize
                                 
                                 
                                    ∫
                                    C
                                 
                                 g
                                 d
                                 s
                                 =
                                 
                                    
                                       E
                                    
                                    
                                       GAC
                                    
                                 
                                 (
                                 C
                                 )
                                 
                                 (the GAC energy)
                              
                           
                        
                      while approximating f (in the probability distribution sense) by two regions 
                        
                           
                              Ω
                           
                           
                              C
                           
                        
                      and 
                        Ω
                        \
                        
                           
                              Ω
                           
                           
                              C
                           
                        
                      with the probability distribution 
                        
                           
                              P
                           
                           
                              2
                           
                        
                        =
                        
                           
                              {
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    x
                                    )
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          L
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    i
                                 
                              
                              }
                           
                           
                              x
                              ∈
                              Ω
                           
                        
                     , where 
                        
                           
                              f
                           
                           
                              s
                           
                        
                        (
                        x
                        )
                      equals 
                        
                           
                              c
                           
                           
                              1
                           
                        
                      when 
                        x
                        ∈
                        
                           
                              Ω
                           
                           
                              C
                           
                        
                      and 
                        
                           
                              f
                           
                           
                              s
                           
                        
                        (
                        x
                        )
                      equals 
                        
                           
                              c
                           
                           
                              2
                           
                        
                      when 
                        x
                        ∈
                        Ω
                        \
                        
                           
                              Ω
                           
                           
                              C
                           
                        
                     .

Following the steps in [20], the constraint minimization problem is converted to the following unconstraint minimization problem
                        
                           (35)
                           
                              
                                 min
                                 u
                              
                              ⁡
                              
                                 {
                                 
                                    
                                       TV
                                    
                                    
                                       g
                                    
                                 
                                 (
                                 u
                                 )
                                 +
                                 
                                    ∫
                                    Ω
                                 
                                 λ
                                 
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 u
                                 +
                                 α
                                 υ
                                 (
                                 u
                                 )
                                 d
                                 x
                                 }
                              
                           
                        
                      where 
                        υ
                        (
                        ξ
                        )
                        =
                        max
                        ⁡
                        {
                        0
                        ,
                        2
                        |
                        ξ
                        −
                        1
                        /
                        2
                        |
                        −
                        1
                        }
                      and the constant α must be chosen large enough compared to λ such as 
                        α
                        >
                        
                           λ
                           2
                        
                        
                           
                              ‖
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              (
                              x
                              )
                              ‖
                           
                           
                              
                                 
                                    L
                                 
                                 
                                    ∞
                                 
                              
                              (
                              Ω
                              )
                           
                        
                     .

The variational problem (35) is regularized as a minimization problem containing two variables as follows
                        
                           (36)
                           
                              
                                 
                                    
                                       
                                          min
                                          
                                             u
                                             ,
                                             v
                                          
                                       
                                       ⁡
                                       
                                          {
                                          
                                             
                                                E
                                             
                                             
                                                global
                                                ;
                                                cross
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          u
                                          ,
                                          v
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          λ
                                          ,
                                          α
                                          ,
                                          θ
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                       =
                                       
                                          
                                             TV
                                          
                                          
                                             g
                                          
                                       
                                       (
                                       u
                                       )
                                       +
                                       
                                          1
                                          
                                             2
                                             θ
                                          
                                       
                                       
                                          
                                             ‖
                                             u
                                             −
                                             v
                                             ‖
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          ∫
                                          Ω
                                       
                                       λ
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       x
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       v
                                       +
                                       α
                                       υ
                                       (
                                       v
                                       )
                                       d
                                       x
                                       }
                                    
                                 
                              
                           
                        
                      where the parameter 
                        θ
                        >
                        0
                      is chosen to be small. Since functional 
                        
                           
                              E
                           
                           
                              global
                              ;
                              cross
                           
                           
                              r
                           
                        
                      is convex, its minimizer can be computed by minimizing 
                        
                           
                              E
                           
                           
                              global
                              ;
                              cross
                           
                           
                              r
                           
                        
                      with respect to u and v separately, and to iterate until convergence. Thus the following minimization problems are considered
                        
                           (1)
                           
                              v being fixed, we search for u as a solution of
                                 
                                    (37)
                                    
                                       
                                          min
                                          u
                                       
                                       ⁡
                                       
                                          {
                                          
                                             
                                                TV
                                             
                                             
                                                g
                                             
                                          
                                          (
                                          u
                                          )
                                          +
                                          
                                             1
                                             
                                                2
                                                θ
                                             
                                          
                                          
                                             
                                                ‖
                                                u
                                                −
                                                v
                                                ‖
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          }
                                       
                                    
                                 
                              
                           


                              u being fixed, we search for v as a solution of
                                 
                                    (38)
                                    
                                       
                                          min
                                          v
                                       
                                       ⁡
                                       
                                          {
                                          
                                             1
                                             
                                                2
                                                θ
                                             
                                          
                                          
                                             
                                                ‖
                                                u
                                                −
                                                v
                                                ‖
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             ∫
                                             Ω
                                          
                                          λ
                                          
                                             
                                                r
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          x
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          v
                                          +
                                          α
                                          υ
                                          (
                                          v
                                          )
                                          d
                                          x
                                          }
                                       
                                    
                                 
                              
                           

The iteration scheme (39) is straightforward to implement. The discrete divergence operator div is given by [21]
                     
                        
                           
                              
                                 
                                    
                                       
                                          
                                             (
                                             div
                                             
                                             p
                                             )
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   x
                                                
                                             
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         −
                                                         1
                                                         ,
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   1
                                                   <
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   <
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   =
                                                   1
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         −
                                                         1
                                                         ,
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       +
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                         −
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   1
                                                   <
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   <
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   =
                                                   1
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                         −
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                      and the discrete gradient operator is as follows [21]
                     
                        
                           
                              
                                 
                                    (
                                    ∇
                                    u
                                    )
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          x
                                       
                                    
                                    ,
                                    
                                       
                                          i
                                       
                                       
                                          y
                                       
                                    
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       (
                                       ∇
                                       u
                                       )
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             y
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       (
                                       ∇
                                       u
                                       )
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             y
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           
                        
                      with
                        
                           
                              
                                 
                                    
                                       (
                                       ∇
                                       u
                                       )
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             y
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   +
                                                   1
                                                   ,
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             if
                                             
                                             
                                                
                                                   i
                                                
                                                
                                                   x
                                                
                                             
                                             <
                                             
                                                
                                                   N
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             if
                                             
                                             
                                                
                                                   i
                                                
                                                
                                                   x
                                                
                                             
                                             =
                                             
                                                
                                                   N
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       (
                                       ∇
                                       u
                                       )
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             y
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   +
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             if
                                             
                                             
                                                
                                                   i
                                                
                                                
                                                   y
                                                
                                             
                                             <
                                             
                                                
                                                   N
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             if
                                             
                                             
                                                
                                                   i
                                                
                                                
                                                   y
                                                
                                             
                                             =
                                             
                                                
                                                   N
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                      Thus (39) and (40) are iterated in order to minimize energy (38). Of course, the constants 
                        
                           
                              c
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              c
                           
                           
                              2
                           
                        
                      are updated every iterations. In all experiments, initial values are 
                        
                           
                              u
                           
                           
                              0
                           
                        
                        =
                        
                           
                              v
                           
                           
                              0
                           
                        
                        =
                        L
                        /
                        2
                        ⋅
                        
                           
                              1
                           
                           
                              
                                 
                                    N
                                 
                                 
                                    x
                                 
                              
                              ×
                              
                                 
                                    N
                                 
                                 
                                    y
                                 
                              
                           
                        
                     , 
                        
                           
                              p
                           
                           
                              0
                              ;
                              1
                           
                        
                        =
                        
                           
                              p
                           
                           
                              0
                              ;
                              2
                           
                        
                        =
                        0
                     , where 
                        
                           
                              1
                           
                           
                              
                                 
                                    N
                                 
                                 
                                    x
                                 
                              
                              ×
                              
                                 
                                    N
                                 
                                 
                                    y
                                 
                              
                           
                        
                      represents a matrix whose elements are all 1, the temporal step is equal to 
                        δ
                        t
                        =
                        1
                        /
                        8
                      and the stopping criteria is 
                        max
                        ⁡
                        (
                        |
                        
                           
                              u
                           
                           
                              n
                              +
                              1
                           
                        
                        −
                        
                           
                              u
                           
                           
                              n
                           
                        
                        |
                        ,
                        |
                        
                           
                              v
                           
                           
                              n
                              +
                              1
                           
                        
                        −
                        
                           
                              v
                           
                           
                              n
                           
                        
                        |
                        )
                        ≤
                        
                           
                              ε
                           
                           
                              ⁎
                           
                        
                     . The fast global minimization of the proposed method not only considers the cross entropy between the given image and the segmented image, but also considers the geodesic edge term. Besides, the implementation speed of the fast global minimization method is always faster compared to the level set based implementation method.

In order to verify the effectiveness of the proposed method, a large number of experiments have been done. Two versions of the proposed method have been applied which are the level set implementation method (denoted by LS implementation for short) and the fast global minimization implementation method (denoted by FG implementation for short). The proposed method is applied to segment several remote sensing river images and the proposed method is compared to CV model [7], minimization of region-scalable fitting (RSF) energy level set model [8] (denoted by RSF energy model for short), bias field correction level set model [9] (denoted by BFC model for short), fast global minimization of geodesic active contour model [20] (denoted by global GAC model for short) and fast global minimization of CV model [20] (denoted by global CV model for short). We also give the segmented images obtained by Otsu image thresholding algorithm and cross entropy based image thresholding algorithm as reference images. The experimental setting is Intel(R) Atom(TM) CPU D2700 2.13 GHz/ 2.00 GB RAM/ MATLAB 7.6.0. We use 6 remote sensing river images to demonstrate the experimental results. The size of the 6 images are 
                        173
                        ×
                        166
                     , 
                        145
                        ×
                        147
                     , 
                        135
                        ×
                        205
                     , 
                        214
                        ×
                        216
                     , 
                        215
                        ×
                        216
                     , 
                        214
                        ×
                        215
                      respectively. The parameters used in the proposed method are follows: in the level set implementation, 
                        μ
                        =
                        
                           
                              10
                           
                           
                              −
                              4
                           
                        
                        ⋅
                        
                           
                              255
                           
                           
                              2
                           
                        
                     , 
                        λ
                        =
                        10
                     , 
                        
                           
                              μ
                           
                           
                              2
                           
                        
                        =
                        0.05
                     , in the fast global implementation, 
                        θ
                        =
                        0.5
                     , 
                        λ
                        =
                        0.2
                     . The parameters for other methods are respectively set to their best. The image segmentation results are given in Figs. 1–6
                     
                     
                     
                     
                     
                     . The original images are shown in (a), the segmentation results of CV model are shown in (b), the segmentation results of RSF model are shown in (c), the segmentation results of BFC model are shown in (d), the segmentation results of global GAC model are shown in (e), the segmentation results of global CV model are shown in (f), the segmentation results of LS implementation of the proposed method are shown in (g), the segmentation results of FG implementation of the proposed method are shown in (h), the Otsu image segmentation results and the cross entropy based image segmentation results are shown in (i) and (j) respectively.

The characteristic of the remote sensing river images can be described as follows after observing the original river images presented in Figs. 1–6 (a). First, the pixel intensities of the river region are very low compared to the background. Second, the area inside river region presents intensity homogeneity while the area inside background presents intensity inhomogeneity. Third, there are many non-river targets presented inside the background and they have similar intensity values and intensity homogeneity properties as river region. These non-river targets are hard to identify when only pixel intensities are considered in the segmentation algorithm.

From the experimental results we can find the following important facts. First, comparing Figs. 1–6 (b) and Figs. 1–6 (i), we can see that they are quite similar to each other. Figs. 1–6 (b) are the segmentation results of CV model and Figs. 1–6 (i) are the segmentation results of Otsu image thresholding algorithm. This fact verifies the analysis presented in Section 2.2 where we point out that both methods aim to find a segmentation of the given image whose within-class variance is minimized. Second, comparing Figs. 1–6 (g) and Figs. 1–6 (j), we also find that they are similar to each other. Figs. 1–6 (g) are the segmentation results from the level set implementation of the proposed method and Figs. 1–6 (j) are the segmentation results of cross entropy based image thresholding algorithm. Since we formulate the objective functional based on the cross entropy, both methods aim to find a segmentation of the given image where the cross entropy is minimized. This similarity also verifies the correctness of the proposed objective functional. Third, comparing Figs. 1–6 (i) and Figs. 1–6 (j), we can see that the results obtained by cross entropy are always better than the results from Otsu method. More background pixels and non-river targets are incorrectly classified as the river region in the Otsu method. The criterion which is to minimize the within-class variance cannot identify whether the pixel belongs to background or river but the criterion which measures the cross entropy somewhat can. Correspondingly, comparing Figs. 1–6 (b) and Figs. 1–6 (g), the method proposed can get better results than CV model.

We further analyze the segmentation results obtained from other methods. Through observing Figs. 1–6 (c), we find that the segmented images cannot correctly reflect the river region and the background. Figs. 1–6 (c) are the segmentation results obtained from RSF energy model. This model is initially proposed to overcome the intensity inhomogeneity presented in each region. This model can easily be trapped in local minima during the evolution process and the segmentation results are incorrect. The BFC model is very similar to the RSF energy model and this model also has the problem of local minima. The segmentation results of BFC model are shown in Figs. 1–6 (d) and we find that the segmentation results are similar to the results obtained by RSF energy model. Next we compare the results obtained from fast global minimization methods. Figs. 1–6 (f) are results obtained from fast global minimization of CV model. From these figures we can see that the segmentation results are more accurate than original CV model. The geodesic energy term is considered in this fast implementation version and the active contour will tend to stop at positions with high image gradients. However, this method has some drawbacks. First, there are two parameters θ and λ in this method. The choice of the parameters will affect the final segmentation results in a great extent and the choices of the parameters are most heuristic during the implementation. Second, the iteration number is not easily determined since the solution generally does not convert to a fixed point. The iteration number must be chosen manually. Third, from the segmentation results we can find that the river region is not complete which means some parts of the river region are segmented as background. The fast implementation of the proposed method has similar drawbacks but the solution generally converges and the parameters are more easily chosen than fast global minimization of CV model. The segmentation results are correct as we can see from Figs. 1–6 (h). The results shown in Figs. 1–6 (e) are fast global implementation of GAC model. The segmentation results are also good but are not as accurate as the method proposed.

In order to compare more explicitly the Otsu image thresholding algorithm and cross entropy based image thresholding algorithm when applied to this set of test images, we list the thresholds in Table 1
                     . From Table 1 we can see that the thresholds obtained by cross entropy based method are always lower than Otsu method. In fact, when segmenting this set of test images, choosing a lower threshold is better than choosing a higher threshold since the pixel intensity of the river region is generally very low compared to the background region. The small non-river targets belonging to the background will not be segmented to the river region when the threshold is chosen relatively low. Table 2
                      lists the iteration number of the 7 methods. The iteration number of global GAC model, global CV model and FG implementation of the proposed method is set manually. The iteration number of LS implementation of the proposed method is generally larger compared to CV model, RSF energy model and BFC model. The iteration number of RSF energy model and BFC model is small since these two models will be easily trapped in local minima and then the evolution process will stop before the final global minima is reached. CV model is generally faster than the LS implementation but is not accurate. The number of iteration of FG implementation is comparable to the global CV model. Global GAC model generally needs more iteration number. The running time of each image segmentation method is listed in Table 3
                     . From Table 3 we can see the following four points. First, the running time of each image segmentation method is dependent on the size of the image. When the size of image grows, the running time also grows. The size of Figs. 4–6 is larger than that of Figs. 1–3 and we can see from the table that the running time of Figs. 4–6 is also longer than that of Figs. 1–3. Second, the running time of the proposed method is longer than that of CV model. The reason is that the computation involved in the proposed method is more complex. Third, the running time of the fast implementation is far less than that of the level set implementation. Forth, the running time of RSF energy model and BFC model is very long compared to that of CV model and the proposed method since there is convolution operation in computing the results of those methods.

Finally, we make some comparisons between the two methods proposed in this paper which are the LS implementation method and the FG implementation method. The main drawback of the LS implementation method is that the level set can be trapped in local minima and the final segmentation result is not correct. This phenomenon can be observed from Figs. 2–3 (g). The segmentation results are wrong since the level set stops at local minima. In contrast, the FG implementation method will always get the right segmentation result. The only drawback of the FG implementation method is that the parameters and the iteration number have to be set manually and this process is heuristic.

@&#CONCLUSIONS@&#

In this paper a new active contour segmentation method based on cross entropy is proposed. Based on the fact that CV model and Otsu image thresholding method both find a segmentation of a given image whose within-class variance is minimized, the new active contour segmentation method aims to find a segmentation of a given image where the cross entropy of the original image and the segmented image is minimized just as cross entropy based image thresholding algorithm. Two implementation methods are proposed which are the level set implementation and the fast global minimization implementation and these two methods both have some advantages and disadvantages. The similarity between CV model and Otsu image thresholding algorithm and the similarity between the proposed method and cross entropy based image thresholding algorithm is demonstrated in the experiments. The proposed method is compared to several closely related methods including CV model, RSF energy model, BFC model, global GAC model and global CV model. Experimental results show that the proposed method can get better segmentation results compared to these methods and the number of miss classified pixels is the least when applying the proposed method.

There are some future research directions we want to point out. First, the equivalence of CV model and Otsu image thresholding algorithm may be proved mathematically from their definition. Second, other image thresholding algorithms may be incorporated in the level set based framework and fast global minimization of the objective functional may be used. Third, inspired from the similarity between level set based framework and image thresholding based framework, the objective functional of image thresholding may be modified such as adding a geodesic edge term which considers image gradients.

@&#ACKNOWLEDGEMENTS@&#

This work is partially supported by the Yellow River Sediment Key Laboratory of Ministry of Water Resources under Grant 2014006; Key Laboratory of Rivers and Lakes Governance and Flood Protection of Yangtse River Water Conservancy Committee under Grant CKWV2013225/KY; and State Key Laboratory of Urban Water Resource and Environment under Grant ES201409.

@&#REFERENCES@&#

