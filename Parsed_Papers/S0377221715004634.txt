@&#MAIN-TITLE@&#High-speed railway scheduling based on user preferences

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The high-speed railway model represents the behaviour of the passengers.


                        
                        
                           
                           The supply is represented as a discrete event simulation model.


                        
                        
                           
                           The demand is defined as a nested logit model which considers user preferences.


                        
                        
                           
                           A hybridization of PSO and NM methods is applied for solving the model.


                        
                        
                           
                           A numerical experiment has been conducted on a real high-speed railway network.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Timetabling

High-speed railway

Constrained nested logit model

Utility theory

Metaheuristics

@&#ABSTRACT@&#


               
               
                  This paper proposes an optimization model for high-speed railway scheduling. The model is composed of two sub-models. The first is a discrete event simulation model which represents the supply of the railway services whereas the second is a constrained logit-type choice model which takes into account the behaviour of users. This discrete choice model evaluates the attributes of railway services such as the timetable, fare, travel time and seat availability (capacity constraints) and computes the High-Speed railway demand for each planned train service.
                  A hybridisation of a Standard Particle Swarm Optimisation and Nealder–Mead methods has been applied for solving the proposed model and a real case study of the High-Speed corridor Madrid–Seville in Spain has been analysed. Furthermore, parallel computation strategies are used to speed up the proposed approach.
               
            

@&#INTRODUCTION@&#

European Union competition policy is promoting an ongoing liberalisation process in the rail market and the setting up of an EU air market. In this single transport market, the low-cost air carriers and the high-speed railway (HSR) operators are competitors on routes that are interchangeable within a certain distance range, especially in point-to-point routes. Currently HSR systems are expanding their rail networks in the EU and incrementing their demand share. However, in order to meet the new scenario of competition between transport operators, the rail industry should focus the railway service on addressing passenger needs.


                     The Train Timetabling Problem (TTP) consists of the establishment of a set of conflict-free train routes with respect to given train requirements. TTP has received a great deal of attention in the scientific literature in recent years. The literature focuses on minimizing parameters related to train company operations (operations-centric models) but so-called passenger-centric models have also been developed but they are much sparser. These analytical models are crucial in improving the competitiveness of the rail industry.

HSR systems are an emergent technology whose singular features have not yet been widely discussed in the current literature on TTP modelling. The departure time choice, travel time, the pricing regime and the competition of these systems with the traditional or low-cost air, rail and private vehicles should be taken into account in the TTP models. Motivated by this need, this paper proposes a high-speed passenger-centric TTP model that uses a high-speed demand forecasting model to learn the behaviour of passengers with respect to the attributes (departure time, travel time, ticket cost and travel comfort) of the proposed timetable.

The remainder of this paper is structured as follows. Section 2 reviews related research papers. Section 3 describes the proposed HSR–TTP model in detail. Section 4 explains the algorithms used for solving this model, in Section 5 several computational experiments are reported, and finally Section 6 concludes with a discussion of our findings and future work.

@&#LITERATURE REVIEW@&#

TTP has been addressed widely in the literature in the last thirty years. A rough taxonomy of TTP may be classified, see Cacchiani and Toth (2012), according to application: (i) freight or passenger transportation, (ii) railway network or single one-way line (corridor) linking two major stations with intermediate stations, (iii) cyclic (periodic) or non-cyclic timetables and (iv) objective function. In this section we focus exclusively on HSR–TTP approaches.


                     Cascetta and Coppola (2014) consider that a high-speed-generated demand obeys three main factors:

                        
                           (1)
                           The diverted demand, which represents the choice of a passenger between other means of transport (plane, car, other rail services, etc.) and HSR.

The induced demand, which depends directly on the characteristics of the HSR services offered (ticket cost, travel time, timetable, etc.), or indirectly due to modifications of the travellers’ mobility or lifestyle choices.

The economy-based demand growth, which is linked to the trends of the economic system, considering that people travel more when they are wealthy.

Diverted demand and directly induced demand are considered as endogenous factors of the HSR system. Indirectly induced demand and economy-based demand growth are considered as exogenous factors of the HSR system. Numerous HSR demand-forecasting models have been developed to predict rail passenger flows. Some of these involve short-term forecasting (Jiang, Zhang, & Chen, 2014) and their aim is to provide daily user estimates that account for day-to-day demand variations in the near future. These models have been applied to problems of revenue management, improvement of facilities, operation mode, etc. and predictions are made considering the HSR system as a black box. A model which tries to solve the TTP for HSR systems must be capable of forecasting high-speed rail demand as a function of the endogenous factors of the system.

HSR demand forecasting models can be classified as aggregate or disaggregate. Aggregate models are based on aggregate demand elasticity values and make use of large data sets obtained from ticket sales and surveys. They are useful for rail demand growth predictions (see Wardman, 2006) or policy simulation, such as the estimation of the effects of CO2 emissions taxes on the demands for airline and HSR travel (see Fu, Oum, & Yan, 2014) or to forecast the demand for a proposed new HSR service (see Börjesson, 2014). The fundamental limit on incorporating these models into TTP models is that they cannot simulate flows on individual rail segments or trains. Disaggregate models consider the individual as the basic unit of observation, dividing the passengers into different types depending on different factors. These models are consistent with travel choice theory using data at the level of individual travellers.


                     Cascetta and Coppola (2014) creates a taxonomy of HSR disaggregate demand forecasting models (see Table 1). The two essential classification criteria which apply are the type of transport network (multi-modal or mono-modal) and the way the range of services is represented (frequency-based or schedule-based). This classification is very useful for properly situating the model given in this study in its place in the literature. This is line of thought followed here.


                     Mono-modal models are focused on a specific transport mode and forecast the demand based on the operational improvement of this mode (for some examples see Couto and Graham (2008) and Hsu and Chung (1997)). These models are typically conceived to represent the behaviour of the passengers in an urban context. Multi-modal models include the competition between HSR and other modes of transports available for the same trip. Most of these models focus on the competition between HSR and air transportation (see Fröidh, 2008; Park & Ha, 2006; Román, Espino, & Martín, 2007), some include cars (see Mandel, Gaudry, & Rothengatter, 1997; Martín & Nombela, 2007; Yao & Morikawa, 2005) and very few add the competition between HSR operators (see Ben-Akiva, Cascetta, Coppola, Papola, & Velardi, 2010; Cascetta & Coppola, 2012).

The frequency-based approaches are focused on defining a frequency for each type of service over given time intervals. Greater flexibility in the modelling is given by scheduling-based approaches which allow scheduled services to be represented as individual trips following a timetable (see Wilson & Nuzzolo, 2004). The majority of the models presented in the literature to forecast HSR demand follow a frequency-based demand approach. The choice of one or other approach conditions the output of the TTP model, directing it towards establishing frequency o defining a timetable. For low-frequency transport systems the schedule-based approach reflects user choice in a specific service better.

Schedule-based studies like Espinosa-Aranda, García-Ródenas, López-García, and Angulo-Herrera (2014) where a constrained nested logit model is proposed with the objective of predicting the demand in an HSR system are scarce. This model considers the timetable, price of the ticket, travel time and capacity of the trains in the selection process. These authors use Reproducing Kernel Hilbert spaces to consider dynamic utilities, which is an essential issue for modelling the departure time choice.

The other main issue in TTP is the modelling of the railway services supplied. Traditionally to represent this problem several types of constraints like block capacity constraints, flow constraints, priority constraints, train service capacity constraints and rolling stock constraints have been considered (see Cordeau, Toth, & Vigo, 1998). HSR systems have received a great deal of investment which eases the operational control of these systems allowing the simplification of the traditional regional or intercity railway systems modelling. This paper proposes a discrete event simulation model for representing the supply of the network. This approach has been applied successfully in transportation (see Espinosa-Aranda & García-Ródenas, 2012; Sánchez-Rico, García-Ródenas, & Espinosa-Aranda, 2014). Furthermore, it is possible to extend the HSR model by changing the proposed supply model with previous approaches defined in the literature, such as methods based on the alternative graph model (see Corman, D’Ariano, Pacciarelli, & Pranzo, 2010; D’Ariano, 2008; D’Ariano, Pacciarelli, & Pranzo, 2008; Espinosa-Aranda & García-Ródenas, 2013), or including real-time optimisation methods for rescheduling rolling stock (see Almodóvar & García-Ródenas, 2013).

The proposed HSR–TTP approach can be classified as a disaggregate multi-modal schedule-based model and focuses on the endogenous factors (travel time, fare and departure time) associated with HSR passenger behaviour. The contributions of this paper can be summarized as follows:

                           
                              –
                              A novel HSR–TTP model is proposed. The model is able to accommodate the following two key features: (i) the interaction between demand and supplied capacity, explicitly considering the effect that a given set of services may be at capacity has on user choice and (ii) competition between means of transport (low-cost air carriers, other railway (HSR) operators or private car).

An optimisation framework for the HSR–TTP model is analysed. The HSR–TTP model presents a bilevel structure which integrates a simulation approach (supply-side modelling) and an optimisation model (demand model) at lower level. The resulting model is implicitly defined and exact methods become inapplicable. Moreover, the evaluation of the objective function is expensive. This model poses a special challenge, since existing heuristic methods often require more function evaluations than can be comfortably afforded. In this paper, the way to address this challenge is to use parallelisation strategies in an accelerated Particle Swarm Optimisation algorithm. We have shown in a real case that this strategy is suitable from the point of view of computational cost and of global optimisation search.

This section sets out a TTP model focused on the HSR operator’s profits. This model, whose structure is depicted in Fig. 1
                     , optimizes the timetable, taking into account the behaviour of the passengers.

This HSR–TTP model comprises three modules

                        
                           (1)
                           
                              Supply model. This model represents the movements of trains on the HS railway network.

A model for computing the utilities of the scheduled services as a function of their attributes.


                              HSR demand model. This model defines the choices of the users on the HSR network.

For convenience, the list of variables, sets and indices used is shown in Table 2.

The set of constraints defined in this section models railway operations and overtaking between trains. A discrete event model is formulated to obtain the complete timetable assuming that initial times, speeds and stop times at stations are known. Some assumptions are made about the generic
                         HSR system

                           Assumption 1
                           Double-tracked line. Each section is separated by nodes (stations) and all the trains in the same section must travel in the same direction.

The route of each service is fixed and defined by a sequence of stations. It is not necessary to stop at all stations. A function 
                                 
                                    j
                                    =
                                    J
                                    (
                                    s
                                    ,
                                    m
                                    )
                                 
                               which indicates the mth station visited by service s is assumed to be known. Also a dummy station jF
                              , which represents the end of the service, is defined.

The speed of each train is fixed if there is no type of conflict with another train. In case of conflict, the following train must reduce its speed maintaining the minimum dwell time defined by controllers in each track segment.

A train which does not stop in a station could overtake a train stopped in this station. This constraint allows the system to operate express services which do not stop in each station they go through, contributing to the improvement in the performance of the system.

Two of the most important factors in the competitiveness of HSR systems are reduced travel times and punctuality. Because of this the only time considered to be added to the travel time of each train is the necessary stop time in stations, so the following assumptions are made:

                           Assumption 5
                           A train can stop only the time necessary for passenger alighting/boarding, without considering the possibility of connections between trains.

There is no priority between trains reaching a station at practically the same time, following a First Come First Served (FCFS) policy.

Thus the essential variables of the problem are the departure times of each train from their initial station. The supply model aims to determine the complete timetable of the HSR network.

The supply model receives the train departure times and simulates their behaviour taking into account the operational constraints. Finally the complete conflict-free timetable is calculated.

We denote by Ts
                            the start time of service 
                              
                                 s
                                 ∈
                                 S
                              
                            and we call

                              
                                 
                                    
                                       T
                                       =
                                       (
                                       
                                          T
                                          1
                                       
                                       ,
                                       ⋯
                                       ,
                                       
                                          T
                                          n
                                       
                                       )
                                    
                                 
                              
                           the vector which contains the initial departure times of planned services, where n is the cardinal of the set 
                              S
                           .

Each train 
                              
                                 k
                                 ∈
                                 K
                              
                            is constrained to a feasible number of services in a given period. To describe the model, denote as 
                              
                                 s
                                 =
                                 S
                                 (
                                 k
                                 ,
                                 m
                                 )
                              
                            a function capable of obtaining the mth service, that is s, of train k.

                              Definition 1
                              An event 
                                 e represents the instant in which a train k performing service s leaves a station j and is defined by the triplet:

                                    
                                       
                                          
                                             e
                                             =
                                             (
                                             k
                                             ,
                                             
                                                s
                                                k
                                             
                                             ,
                                             
                                                j
                                                k
                                             
                                             )
                                          
                                       
                                    
                                 where k is a train, sk
                                  and jk
                                  are respectively the ordinal number of the service and the position of the station in which train k stops. The respective service and station are obtained as follows:

                                    
                                       (1)
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                      =
                                                      S
                                                      (
                                                      k
                                                      ,
                                                      
                                                         s
                                                         k
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (2)
                                       
                                          
                                             
                                                
                                                   
                                                      j
                                                      =
                                                      J
                                                      (
                                                      s
                                                      ,
                                                      
                                                         j
                                                         k
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

The simulation model updates the events produced in the system dynamically. Fig. 2 shows a real railway network at a certain instant. The example represents three trains with their associated events to be processed.

The event instants δe
                            correspond with the departure from a station, and determine the processing sequence of all the events.

Therefore the basic implementation of the discrete event simulation model is shown in the flow chart depicted in Fig. 3. To process each event it is necessary to consider the two main constraints of the system, the dwell time and the rolling stock. The dwell time constraint is related to a section of the track and models the movement of a train in a track segment. Consider Fig. 4
                           . It shows track segment i → j and two trains. Denote by 
                              
                                 T
                                 
                                    s
                                    i
                                 
                                 d
                              
                            the departure time of service s performed by train k from station i. Denote 
                              
                                 T
                                 
                                    s
                                    j
                                 
                                 a
                              
                            as the instant in which service s arrives at station j. The system must satisfy:

                              
                                 (3)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   T
                                                   
                                                      s
                                                      j
                                                   
                                                   a
                                                
                                                ≥
                                                
                                                   τ
                                                   j
                                                   a
                                                
                                                +
                                                
                                                   d
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (4)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   T
                                                   
                                                      s
                                                      j
                                                   
                                                   a
                                                
                                                ≥
                                                
                                                   T
                                                   
                                                      s
                                                      i
                                                   
                                                   d
                                                
                                                +
                                                
                                                   c
                                                   
                                                      i
                                                      j
                                                   
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

where dij
                            is the dwell time of section i → j, 
                              
                                 τ
                                 j
                                 a
                              
                            is the instant when the last train with respect to the previous moment of the system arrives at station j (k′ in Fig. 4) and 
                              
                                 c
                                 
                                    i
                                    j
                                 
                                 k
                              
                            is the travel time of the train k in the track segment i → j.


                           Eq. (3) imposes a constraint which could lead to a speed reduction for maintaining the minimum security time between trains. Eq. (4) indicates the minimum instant 
                              
                                 T
                                 
                                    s
                                    j
                                 
                                 a
                              
                            in which train k may arrive at station j considering the departure time 
                              
                                 T
                                 
                                    s
                                    i
                                 
                                 d
                              
                            from station i.

Taking into account both constraints (3) and (4) and that the TTP is focused on an HSR system, the main objective is to reduce the travel time to the minimum. Therefore:

                              
                                 (5)
                                 
                                    
                                       
                                          T
                                          
                                             s
                                             j
                                          
                                          a
                                       
                                       =
                                       max
                                       
                                          {
                                          
                                             T
                                             
                                                s
                                                i
                                             
                                             d
                                          
                                          +
                                          
                                             c
                                             
                                                i
                                                j
                                             
                                             k
                                          
                                          ,
                                          
                                             τ
                                             j
                                             a
                                          
                                          +
                                          
                                             d
                                             
                                                i
                                                j
                                             
                                          
                                          }
                                       
                                    
                                 
                              
                           
                        

Moreover, it is necessary to consider the stop times of services:

                              
                                 (6)
                                 
                                    
                                       
                                          T
                                          
                                             s
                                             j
                                          
                                          d
                                       
                                       ≥
                                       
                                          T
                                          
                                             s
                                             j
                                          
                                          a
                                       
                                       +
                                       
                                          p
                                          
                                             s
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        

where psj
                            is the stop time of service s in station j. This approach represents the behaviour of the trains, following a FCFS policy when a train makes a stop in a station.

The model considers an overtaking situation in stations. If a train does not stop in a given station, it could pass the stopped trains in this station. Next, this situation is analysed for service s.

Denote by 
                              
                                 τ
                                 j
                                 d
                              
                            the programmed departure instant from station j before the arrival of service s at station j. The overtaking situation is addressed by calculating:

                              
                                 (7)
                                 
                                    
                                       
                                          τ
                                          j
                                          d
                                       
                                       =
                                       min
                                       
                                          {
                                          
                                             τ
                                             j
                                             d
                                          
                                          ,
                                          
                                             T
                                             
                                                s
                                                j
                                             
                                             d
                                          
                                          }
                                       
                                    
                                 
                              
                           
                        

Finally when train k departs from station j, the value of 
                              
                                 τ
                                 j
                                 a
                              
                            is updated with the value 
                              
                                 T
                                 
                                    s
                                    j
                                 
                                 a
                              
                           .

This constraint considers that a planned service for a train cannot start until the previous service of this same train has ended, with a minimum security time and set-up time between them. Suppose there is a train which carries out services s and s′ consecutively, then

                              
                                 (8)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                      ˜
                                                   
                                                   
                                                      s
                                                      ′
                                                   
                                                
                                                =
                                                max
                                                
                                                   {
                                                   
                                                      T
                                                      
                                                         s
                                                         ′
                                                      
                                                   
                                                   ,
                                                   
                                                      δ
                                                      s
                                                   
                                                   +
                                                   
                                                      r
                                                      
                                                         s
                                                         
                                                            s
                                                            ′
                                                         
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

where 
                              
                                 
                                    T
                                    ˜
                                 
                                 
                                    s
                                    ′
                                 
                              
                            is the real instant when s′ starts, 
                              
                                 T
                                 
                                    s
                                    ′
                                 
                              
                            is the planned initial time, δs
                            is the end time of service s and 
                              
                                 r
                                 
                                    s
                                    
                                       s
                                       ′
                                    
                                 
                              
                            is the rolling stock turnaround time until the train can start service s′.

The discrete event algorithm selects the next event to be processed by determining the train k associated with this event and calculates the arrival time at the next station j given the operational constraints. The arrival of train k at station j updates the last arrival time 
                              
                                 τ
                                 j
                                 a
                              
                            at this station, allowing overtaking if the constraints associated with 
                              
                                 τ
                                 j
                                 d
                              
                            are met.

The algorithm ends by generating the new event e
                           * of train k, considering the rolling stock constraints and ending the service.

The complete discrete event algorithm can be seen in Table 3.

The methods of discrete choice analysis have been widely applied to modelling of transportation systems. These methods provide a framework to use the maximum likelihood estimation technique for calibrating and contrasting the parameters of these models. In the multinomial logit and nested logit models, the choice probability can be calculated exactly from the closed-form formula and this has attracted a lot of attention from researchers. Hensher, Rose, and Greene (2005), Louviere, Hensher, and Swait (2000), or Ben-Akiva and Lerman (1995) can be referred to for a more detailed overview of these methods.


                        Wang, Li, Wang, Moore, Staley, and Li (2014) apply multinomial logit models and nested logit models to analyse traveller mode choice behaviour in a new high-speed rail corridor. In a revealed preference data context, this study reports a high consistency level between the actual and predicted modal splits for business and personal/recreational trips. These models yield reliable estimates and this is a key motivation to use them.

The utilities for the passengers are calculated following the approach proposed in Espinosa-Aranda et al. (2014). In this subsection we describe this approach and give an illustrative example. Suppose we are analysing a demand pair 
                              
                                 ω
                                 =
                                 (
                                 i
                                 ,
                                 j
                                 )
                              
                            between station i and j. We assume that for the pair ω there exists a set of rail services 
                              
                                 D
                                 ω
                              
                            that can satisfy this type of journey. We assume that each service is characterized by a set of attributes, and in this example we consider only two: departure time from i and ticket price of the service s to make the journey ω. Fig. 5 shows, on the left, a set 
                              
                                 D
                                 ω
                              
                            of 11 services of which 6 have a cost of 50 euros and the other 5 have a cost of 40 euros. Furthermore, they all have different departure times from station i, ranging from 6 in the morning to 18. The attribute vector of service s for demand ω is 
                              
                                 
                                    x
                                    
                                       ω
                                       ,
                                       s
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       b
                                       
                                          ω
                                          ,
                                          s
                                       
                                    
                                    ,
                                    
                                       T
                                       
                                          s
                                          ,
                                          i
                                       
                                       d
                                    
                                    )
                                 
                              
                            where b
                           
                              ω, s
                            is the ticket price and 
                              
                                 T
                                 
                                    s
                                    ,
                                    i
                                 
                                 d
                              
                            the departure time of service s from station i.

We assume that the systematic component of the utility function is given by 
                              
                                 
                                    V
                                    ω
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 :
                                 X
                                 ↦
                                 
                                    l
                                    
                                    R
                                 
                                 ,
                              
                            and belonging to a Reproducing Kernel Hilbert Space (RKHS). The RKHS are uniquely determined by the function 
                              
                                 K
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 :
                                 X
                                 ×
                                 X
                                 ↦
                                 
                                    l
                                    
                                    R
                                 
                              
                            called Mercer kernel. The set of functions {K(x, y)}
                              y ∈ X
                            forms an RKHS basis and thus a utility function Vω
                            may be expressed as a linear combination of the elements of the basis

                              
                                 (18)
                                 
                                    
                                       
                                          V
                                          ω
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       
                                          ∑
                                          
                                             y
                                             ∈
                                             X
                                          
                                       
                                       
                                          α
                                          y
                                       
                                       K
                                       
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                       ,
                                       
                                       for
                                       
                                       all
                                       
                                       x
                                       ∈
                                       X
                                    
                                 
                              
                           
                        

To make the definition (18) work, we consider a finite number of elements of the basis, specifically those elements associated with services 
                              
                                 
                                    D
                                    ω
                                 
                                 ,
                              
                            whose corresponding functions are 
                              
                                 
                                    {
                                    K
                                    
                                       (
                                       x
                                       ,
                                       
                                          x
                                          
                                             ω
                                             ,
                                             s
                                          
                                       
                                       )
                                    
                                    }
                                 
                                 
                                    s
                                    ∈
                                    
                                       D
                                       ω
                                    
                                 
                              
                            and this leads to the following approximation:

                              
                                 (19)
                                 
                                    
                                       
                                          V
                                          ω
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       ≅
                                       
                                          ∑
                                          
                                             s
                                             ∈
                                             
                                                D
                                                ω
                                             
                                          
                                       
                                       
                                          α
                                          
                                             ω
                                             ,
                                             s
                                          
                                       
                                       K
                                       
                                          (
                                          x
                                          ,
                                          
                                             x
                                             
                                                ω
                                                s
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                       for
                                       
                                       all
                                       
                                       x
                                       ∈
                                       X
                                    
                                 
                              
                           Typically (see for instance Ben-Akiva and Lerman (1995)) the systematic utilities are expressed as a linear combination of the attributes, by means of parameters which can be interpreted as the weights that users give to each attribute. In the proposed approach, each utility is expressed as a linear combination of known utilities, given by the parameters α
                           
                              ω, s
                           , and the function K(x, x
                           
                              ω, s
                           ) gauges the similarity between an arbitrary timetable and the known timetables.


                           Espinosa-Aranda et al. (2014) develop an estimation procedure for these functions (19) based on estimating the utilities 
                              
                                 
                                    {
                                    
                                       V
                                       ω
                                    
                                    
                                       (
                                       
                                          x
                                          
                                             ω
                                             ,
                                             s
                                          
                                       
                                       )
                                    
                                    }
                                 
                                 
                                    s
                                    ∈
                                    
                                       D
                                       ω
                                    
                                 
                              
                            of the set of services involved, and from these estimations calculating the coefficients α
                           
                              ω, s
                            using Theory of Tikhonov Regularisation. In this study we assume that the estimation procedure has already been carried out and so the functions Vω
                           (x) are known.

This paper uses the Gaussian kernel 
                              
                                 K
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 =
                                 
                                    e
                                    
                                       
                                          −
                                          a
                                          ∥
                                          x
                                          −
                                          y
                                          ∥
                                       
                                       2
                                    
                                 
                              
                            in which ‖·‖ is the Euclidean norm 
                              
                                 a
                                 ∈
                                 
                                    
                                       l
                                       
                                       R
                                    
                                    +
                                 
                              
                           . If we apply the estimation procedure to this example of 11 services we obtain an analytical expression of the form:

                              
                                 (20)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   V
                                                   ω
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      1
                                                   
                                                   ,
                                                   
                                                      x
                                                      2
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             ≅
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      s
                                                      =
                                                      1
                                                   
                                                   11
                                                
                                                
                                                   α
                                                   
                                                      ω
                                                      ,
                                                      s
                                                   
                                                
                                                exp
                                                
                                                   {
                                                   −
                                                   a
                                                   
                                                      (
                                                      
                                                         
                                                            (
                                                            
                                                               T
                                                               
                                                                  s
                                                                  ,
                                                                  i
                                                               
                                                               d
                                                            
                                                            −
                                                            
                                                               x
                                                               1
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         (
                                                         
                                                            b
                                                            
                                                               ω
                                                               ,
                                                               s
                                                            
                                                         
                                                         −
                                                         
                                                            x
                                                            2
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                   }
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                for
                                                
                                                all
                                                
                                                x
                                                ∈
                                                X
                                             
                                          
                                       
                                    
                                 
                              
                           where the coefficients α
                           
                              ω, s
                           , b
                           
                              ω, s
                            and 
                              
                                 T
                                 
                                    s
                                    ,
                                    i
                                 
                                 d
                              
                            are known and fixed. The variables are the attributes x
                           1 and x
                           2 of the service whose utility we wish to calculate. The graph of function (20) of the example is shown on the right of Fig. 5. This expression allows new utilities to be calculated if certain attributes of the service are varied. For example new tariffs may be considered, taking 
                              
                                 
                                    x
                                    2
                                 
                                 =
                                 43
                                 ,
                                 48
                              
                            or 53 the utility seen as a function of departure time. Fig. 6 shows the three utility functions Vω
                           (x
                           1, 43), Vω
                           (x
                           1, 48) and Vω
                           (x
                           1, 53). This paper uses the functions Vω
                            to calculate the utility of the service 
                              
                                 s
                                 ^
                              
                            when the schedule is modified to 
                              
                                 
                                    x
                                    1
                                 
                                 =
                                 
                                    T
                                    
                                       ω
                                       ,
                                       
                                          s
                                          ^
                                       
                                    
                                    d
                                 
                              
                           .

The formulation of the utility functions considers a single type of user. The definition can be easily broadened to the situation where there are a number of user types 
                              
                                 ℓ
                                 ∈
                                 L
                              
                            and each group has its own utility function 
                              
                                 
                                    V
                                    ω
                                    ℓ
                                 
                                 
                                    (
                                    x
                                    )
                                 
                              
                           . The inclusion of multiple user types in the HSR–TTP model is important not only to be able to consider different sociological characteristics of the population, but also to address one of the key elements of schedule-based dynamic transit assignment for low frequency transit systems (see Wilson & Nuzzolo, 2004), that is, the segmentation of the OD demand flows according to Desired Departure Times (DDT). The functions 
                              
                                 V
                                 ω
                                 ℓ
                              
                            account for time-varying demand profiles and express when it is most useful for users of type ℓ to travel. For example, Fig. 6, shows a user type whose greatest utility is to travel first thing in the morning, but there may be other user types, with their corresponding utility function, where the greatest utility is reached in the afternoon. Each type of user will thus choose their most suitable rail services.

The demand model used for this HSR is a Constrained Nested Multinomial Logit (CNMNL) model which solves the problem of calculating the behaviour of the passengers. In the HSR–TTP model, the proposed demand model allows us to establish implicitly a relation between the attributes of the timetable and travel behaviour and mode choice. The complete definition and the process by which it was calibrated is described in Espinosa-Aranda et al. (2014).

This model supposes there are various types of users defined by different reasons for travelling, economic and social characteristics and origin-destination (Fig. 7).
                        

The types of users ℓ are disaggregated into two components 
                              
                                 ℓ
                                 =
                                 (
                                 
                                    ℓ
                                    1
                                 
                                 ,
                                 
                                    ℓ
                                    2
                                 
                                 )
                              
                           . The first member includes the socio-economic characteristics and reason for travel; the second component represents the origin and destination of the trip. Each type of user is denoted as (ℓ, ω). Index 
                              
                                 ℓ
                                 ∈
                                 L
                              
                            refers to the first factors and 
                              
                                 ω
                                 =
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 W
                              
                            is a trip from station i to station j.

The model assumes a potential demand 
                              
                                 
                                    {
                                    
                                       
                                          g
                                          ^
                                       
                                       ω
                                       ℓ
                                    
                                    }
                                 
                                 
                                    ω
                                    ∈
                                    W
                                 
                              
                            for a demand type ω for users 
                              
                                 ℓ
                                 ∈
                                 L
                              
                           . The total demand is disaggregated in two alternatives

                              
                                 (a)
                                 (high-speed) train trips.

Other modes: another means of transport.

Considering this fact, a logit model which divides the potential demand between alternatives (a) and (b) is defined:

                              
                                 (21)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   g
                                                   ω
                                                   
                                                      
                                                      m
                                                      ℓ
                                                   
                                                
                                                =
                                                
                                                   
                                                      exp
                                                      (
                                                      
                                                         λ
                                                         1
                                                         ℓ
                                                      
                                                      
                                                         V
                                                         ω
                                                         
                                                            m
                                                            ℓ
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            m
                                                            ∈
                                                            {
                                                            a
                                                            ,
                                                            b
                                                            }
                                                         
                                                      
                                                      exp
                                                      
                                                         (
                                                         
                                                            λ
                                                            1
                                                            ℓ
                                                         
                                                         
                                                            V
                                                            ω
                                                            
                                                               m
                                                               ℓ
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                ·
                                                
                                                   
                                                      g
                                                      ^
                                                   
                                                   ω
                                                   
                                                      
                                                      ℓ
                                                   
                                                
                                                
                                                m
                                                ∈
                                                
                                                   {
                                                   a
                                                   ,
                                                   b
                                                   }
                                                
                                                ,
                                                ℓ
                                                ∈
                                                L
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 V
                                 ω
                                 
                                    m
                                    ℓ
                                 
                              
                            is the utility of alternative m for user type ℓ and demand type ω.

The model considers a nested logit model for disaggregating demand considering the feasible timetable for a trip type ω. 
                              
                                 S
                                 ω
                              
                            represents the feasible set of services for making a trip type ω. The second level of the nested logit model disaggregates the demand between the different services

                              
                                 (22)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   g
                                                   
                                                      ω
                                                      ,
                                                      s
                                                   
                                                   
                                                      
                                                      a
                                                      ℓ
                                                   
                                                
                                                =
                                                
                                                   
                                                      exp
                                                      (
                                                      
                                                         λ
                                                         2
                                                         ℓ
                                                      
                                                      
                                                         V
                                                         
                                                            ω
                                                            ,
                                                            s
                                                         
                                                         
                                                            a
                                                            ℓ
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            
                                                               s
                                                               ′
                                                            
                                                            ∈
                                                            
                                                               S
                                                               ω
                                                            
                                                         
                                                      
                                                      exp
                                                      
                                                         (
                                                         
                                                            λ
                                                            2
                                                            ℓ
                                                         
                                                         
                                                            V
                                                            
                                                               ω
                                                               ,
                                                               
                                                                  s
                                                                  ′
                                                               
                                                            
                                                            
                                                               a
                                                               ℓ
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                ·
                                                
                                                   g
                                                   ω
                                                   
                                                      
                                                      a
                                                      ℓ
                                                   
                                                
                                                
                                                s
                                                ∈
                                                
                                                   S
                                                   ω
                                                
                                                ,
                                                ℓ
                                                ∈
                                                L
                                             
                                          
                                       
                                    
                                 
                              
                           Nested logit models calculate the utility of alternative 
                              
                                 V
                                 ω
                                 
                                    a
                                    ℓ
                                 
                              
                            as the “log-sum” of the utilities of each service

                              
                                 (23)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   V
                                                   ω
                                                   
                                                      a
                                                      ℓ
                                                   
                                                
                                                =
                                                
                                                   1
                                                   
                                                      λ
                                                      2
                                                      ℓ
                                                   
                                                
                                                ln
                                                
                                                   (
                                                   
                                                      ∑
                                                      
                                                         s
                                                         ∈
                                                         
                                                            S
                                                            ω
                                                         
                                                      
                                                   
                                                   exp
                                                   
                                                      (
                                                      
                                                         λ
                                                         2
                                                         ℓ
                                                      
                                                      
                                                         V
                                                         
                                                            ω
                                                            ,
                                                            s
                                                         
                                                         
                                                            a
                                                            ℓ
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Note that within set 
                              
                                 S
                                 ω
                              
                            it is possible to include other HSR services offered by another company, or even air services, to model competition between these means of transport. In this case, these services could not change their planned schedules. Alternative b represents any other alternative not considered in a, such as using a private vehicle, not making the journey, going by air (without considering the schedules in disaggregated form), etc.

The above nested logit model is combined with the capacity constraints of the trains. When a train reaches station j the vehicle has picked up passengers from preceding stations. The number of passengers that can take the train is then restricted by the capacity of the vehicle. 
                              
                                 
                                    W
                                 
                                 
                                    s
                                    j
                                 
                                 +
                              
                            represents the set of origin–destination pairs whose users take the service s before station j and leave the vehicle after station j. Also 
                              
                                 W
                                 
                                    s
                                    j
                                 
                              
                            represents the origin–destination pairs ω whose origin is station j and use s. The capacity constraint of the service s in station j is formulated as:

                              
                                 (24)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         ω
                                                         ′
                                                      
                                                      ∈
                                                      
                                                         W
                                                         
                                                            s
                                                            j
                                                         
                                                      
                                                   
                                                
                                                
                                                   g
                                                   
                                                      ω
                                                      ,
                                                      s
                                                   
                                                   
                                                      
                                                      a
                                                   
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      ω
                                                      ∈
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            s
                                                            j
                                                         
                                                         +
                                                      
                                                   
                                                
                                                
                                                   g
                                                   
                                                      ω
                                                      ,
                                                      s
                                                   
                                                   
                                                      
                                                      a
                                                   
                                                
                                                ≤
                                                
                                                   K
                                                   s
                                                
                                                
                                                for
                                                
                                                all
                                                
                                                s
                                                ∈
                                                S
                                                ,
                                                
                                                j
                                                ∈
                                                
                                                   J
                                                   s
                                                
                                                ;
                                             
                                          
                                       
                                    
                                 
                              
                           where Ks
                            is the capacity of train s, 
                              S
                            is the set of services and Js
                            represents the set of stations in which the service s will stop.


                           Eq. (24) is reformulated, disaggregated by users

                              
                                 (25)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      ℓ
                                                      ∈
                                                      L
                                                   
                                                
                                                
                                                   [
                                                   
                                                      ∑
                                                      
                                                         
                                                            ω
                                                            ′
                                                         
                                                         ∈
                                                         
                                                            W
                                                            
                                                               s
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      g
                                                      
                                                         ω
                                                         ,
                                                         s
                                                      
                                                      
                                                         
                                                         a
                                                         ℓ
                                                      
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         ω
                                                         ∈
                                                         
                                                            
                                                               W
                                                            
                                                            
                                                               s
                                                               j
                                                            
                                                            +
                                                         
                                                      
                                                   
                                                   
                                                      g
                                                      
                                                         ω
                                                         ,
                                                         s
                                                      
                                                      
                                                         
                                                         a
                                                         ℓ
                                                      
                                                   
                                                   ]
                                                
                                                ≤
                                                
                                                   K
                                                   s
                                                
                                                
                                                for
                                                
                                                all
                                                
                                                s
                                                ∈
                                                S
                                                ,
                                                
                                                j
                                                ∈
                                                
                                                   J
                                                   s
                                                
                                                ;
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The theory of consumer behaviour uses the law of utility maximizing to explain how users choose among their alternatives. Anas (1983) demonstrated that information minimizing (or entropy-maximizing modelling) and utility maximizing should be seen as two equivalent views of the same problem.

CNMNL adopts the information-minimizing approach, which makes possible the addition of constraints such as (25) into its formulation. These constraints introduce new information in the forecasting process in order to represent the complex issue of externalities of the decisions of an individual. This approach leads to the following optimisation problem:

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         minimize
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  ω
                                                                  ∈
                                                                  W
                                                               
                                                            
                                                            
                                                               ∑
                                                               
                                                                  ℓ
                                                                  ∈
                                                                  L
                                                               
                                                            
                                                            
                                                               [
                                                               
                                                                  ∑
                                                                  
                                                                     m
                                                                     ∈
                                                                     {
                                                                     a
                                                                     ,
                                                                     b
                                                                     }
                                                                  
                                                               
                                                               
                                                                  η
                                                                  
                                                                     m
                                                                     ℓ
                                                                  
                                                               
                                                               
                                                                  g
                                                                  ω
                                                                  
                                                                     
                                                                     m
                                                                     ℓ
                                                                  
                                                               
                                                               
                                                                  (
                                                                  ln
                                                                  
                                                                  
                                                                     g
                                                                     ω
                                                                     
                                                                        
                                                                        m
                                                                        ℓ
                                                                     
                                                                  
                                                                  −
                                                                  1
                                                                  )
                                                               
                                                               +
                                                               
                                                                  η
                                                                  
                                                                     c
                                                                     ℓ
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            ×
                                                            
                                                               ∑
                                                               
                                                                  s
                                                                  ∈
                                                                  
                                                                     S
                                                                     w
                                                                  
                                                               
                                                            
                                                            
                                                               g
                                                               
                                                                  ω
                                                                  ,
                                                                  s
                                                               
                                                               
                                                                  
                                                                  a
                                                                  ℓ
                                                               
                                                            
                                                            
                                                               (
                                                               ln
                                                               
                                                               
                                                                  g
                                                                  
                                                                     ω
                                                                     ,
                                                                     s
                                                                  
                                                                  
                                                                     
                                                                     a
                                                                     ℓ
                                                                  
                                                               
                                                               −
                                                               1
                                                               )
                                                            
                                                            −
                                                            
                                                               V
                                                               ω
                                                               
                                                                  b
                                                                  ℓ
                                                               
                                                            
                                                            
                                                               g
                                                               ω
                                                               
                                                                  b
                                                                  ℓ
                                                               
                                                            
                                                            −
                                                            
                                                               ∑
                                                               
                                                                  s
                                                                  ∈
                                                                  
                                                                     S
                                                                     w
                                                                  
                                                               
                                                            
                                                            
                                                               V
                                                               
                                                                  ω
                                                                  ,
                                                                  s
                                                               
                                                               
                                                                  a
                                                                  ℓ
                                                               
                                                            
                                                            
                                                               g
                                                               
                                                                  ω
                                                                  ,
                                                                  s
                                                               
                                                               
                                                                  
                                                                  a
                                                                  ℓ
                                                               
                                                            
                                                            ]
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            subject
                                                            
                                                            to:
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               g
                                                               ω
                                                               
                                                                  
                                                                  a
                                                                  ℓ
                                                               
                                                            
                                                            +
                                                            
                                                               g
                                                               ω
                                                               
                                                                  b
                                                                  ℓ
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  g
                                                                  ^
                                                               
                                                               ω
                                                               ℓ
                                                            
                                                            ,
                                                            ω
                                                            ∈
                                                            W
                                                            ,
                                                            ℓ
                                                            ∈
                                                            L
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               g
                                                               ω
                                                               
                                                                  
                                                                  a
                                                                  ℓ
                                                               
                                                            
                                                            =
                                                            
                                                               ∑
                                                               
                                                                  s
                                                                  ∈
                                                                  
                                                                     S
                                                                     ω
                                                                  
                                                               
                                                            
                                                            
                                                               g
                                                               
                                                                  ω
                                                                  ,
                                                                  s
                                                               
                                                               
                                                                  
                                                                  a
                                                                  ℓ
                                                               
                                                            
                                                            ,
                                                            ω
                                                            ∈
                                                            W
                                                            ,
                                                            ℓ
                                                            ∈
                                                            L
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  ℓ
                                                                  ∈
                                                                  L
                                                               
                                                            
                                                            
                                                               [
                                                               
                                                                  ∑
                                                                  
                                                                     
                                                                        ω
                                                                        ′
                                                                     
                                                                     ∈
                                                                     
                                                                        W
                                                                        
                                                                           s
                                                                           j
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  g
                                                                  
                                                                     ω
                                                                     ,
                                                                     s
                                                                  
                                                                  
                                                                     
                                                                     a
                                                                     ℓ
                                                                  
                                                               
                                                               +
                                                               
                                                                  ∑
                                                                  
                                                                     ω
                                                                     ∈
                                                                     
                                                                        
                                                                           W
                                                                        
                                                                        
                                                                           s
                                                                           j
                                                                        
                                                                        +
                                                                     
                                                                  
                                                               
                                                               
                                                                  g
                                                                  
                                                                     ω
                                                                     ,
                                                                     s
                                                                  
                                                                  
                                                                     
                                                                     a
                                                                     ℓ
                                                                  
                                                               
                                                               ]
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            ≤
                                                            
                                                               K
                                                               s
                                                            
                                                            ,
                                                            s
                                                            ∈
                                                            S
                                                            ,
                                                            
                                                            j
                                                            ∈
                                                            
                                                               J
                                                               s
                                                            
                                                            ;
                                                            
                                                            
                                                               [
                                                               CNMNL
                                                               ]
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    η
                                    
                                       a
                                       ℓ
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       λ
                                       1
                                       ℓ
                                    
                                 
                                 −
                                 
                                    1
                                    
                                       λ
                                       2
                                       ℓ
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    η
                                    
                                       b
                                       ℓ
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       λ
                                       1
                                       ℓ
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    η
                                    
                                       c
                                       ℓ
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       λ
                                       2
                                       ℓ
                                    
                                 
                              
                           .

CNMNL represents an equilibrium game among rail service users. Users choose the service to make a trip in order to maximize expected utility. Two users who compete for the capacity of the train (there is no capacity for both to travel at once) take part in a form of bidding process. The multipliers of the active capacity restrictions (24) impose (through a mechanism implicit in the optimisation model) a reduction of the utility of full trains. This causes some users (depending on their alternatives) to reject the choice of full trains for other possible alternatives. This mechanism means that in an equilibrium situation the capacity constraints can be satisfied. In other words, there is a nominal utility V
                           
                              ω, s
                            for each service, and a lower effective utility 
                              
                                 
                                    V
                                    ˜
                                 
                                 
                                    ω
                                    ,
                                    s
                                 
                              
                            caused by the capacity constraints, which is the utility experienced by users, and is used by them to take decisions. It should be noted that in this process all users compete against one another to get tickets, and users who board the train first have no advantage over those who board later (we assume on-line systems for ticket sales in which seats are allocated for all journeys).

This model considers the maximisation of profit, that is, income of ticket sales minus operating costs.

The income of ticket sales is defined as 
                           
                              
                                 ∑
                                 
                                    ω
                                    ∈
                                    W
                                 
                              
                              
                                 ∑
                                 
                                    s
                                    ∈
                                    
                                       S
                                       w
                                    
                                 
                              
                              
                                 g
                                 
                                    ω
                                    ,
                                    s
                                 
                                 
                                    
                                    a
                                    ℓ
                                 
                              
                              
                                 b
                                 
                                    ω
                                    ,
                                    s
                                 
                              
                           
                         where 
                           
                              g
                              
                                 ω
                                 ,
                                 s
                              
                              
                                 
                                 a
                                 ℓ
                              
                           
                         is the number of passengers of demand ω who use the service s and b
                        
                           ω, s
                         is the price of the ticket for a demand ω using service s.

Let πs
                        (Ts
                        ) be the operating costs of service s at instant Ts
                         and Ks
                         the capacity of the train that operates service s, we define the effective capacity as:

                           
                              (26)
                              
                                 
                                    
                                       
                                          K
                                          ^
                                       
                                       s
                                    
                                    
                                       (
                                       
                                          T
                                          s
                                       
                                       )
                                    
                                    :
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   K
                                                   s
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                      T
                                                      s
                                                   
                                                   <
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

and the effective operating cost as:

                           
                              (27)
                              
                                 
                                    
                                       
                                          π
                                          ^
                                       
                                       s
                                    
                                    
                                       (
                                       
                                          T
                                          s
                                       
                                       )
                                    
                                    :
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      π
                                                      s
                                                   
                                                   
                                                      (
                                                      
                                                         T
                                                         s
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                      T
                                                      s
                                                   
                                                   <
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

These definitions represent the fact that if a service s is operated in the planned period 
                           
                              [
                              0
                              ,
                              T
                              ]
                           
                         then the cost of this service is πs
                         with a capacity Ks
                        . Otherwise, the operating cost of this service is 0 and it cannot serve the demand.

Thus the objective function is stated as:

                           
                              (28)
                              
                                 
                                    Z
                                    =
                                    
                                       ∑
                                       
                                          ℓ
                                          ∈
                                          L
                                       
                                    
                                    
                                       ∑
                                       
                                          ω
                                          ∈
                                          W
                                       
                                    
                                    
                                       ∑
                                       
                                          s
                                          ∈
                                          
                                             S
                                             w
                                          
                                       
                                    
                                    
                                       g
                                       
                                          ω
                                          ,
                                          s
                                       
                                       
                                          
                                          a
                                          ℓ
                                       
                                    
                                    
                                       b
                                       
                                          ω
                                          ,
                                          s
                                       
                                    
                                    −
                                    
                                       ∑
                                       
                                          s
                                          ∈
                                          S
                                       
                                    
                                    
                                       
                                          π
                                          ^
                                       
                                       s
                                    
                                    
                                       (
                                       
                                          T
                                          s
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

It is worth noting that if a service s satisfies 
                           
                              
                                 T
                                 s
                              
                              >
                              T
                           
                         then it is not profitable to operate this service. If 
                           
                              T
                              =
                              +
                              ∞
                           
                         all the planned services will be scheduled, and the operating costs of the HSR network will be constant with respect to the decision vector T. In this case the intention is to align the timetable with the desired trip of each user.

The optimisation model shown in Fig. 1 represents a bi-level structure. The higher level designs the rail schedules and at the lower level users who are aware of the rail services offered, choose a specific means of transport to make the trip. Conceptually the model can be given as:

                           
                              
                                 
                                    
                                       
                                          maximize
                                       
                                       
                                          
                                             Z
                                             =
                                             
                                                ∑
                                                
                                                   ℓ
                                                   ∈
                                                   L
                                                
                                             
                                             
                                                ∑
                                                
                                                   ω
                                                   ∈
                                                   W
                                                
                                             
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   
                                                      S
                                                      w
                                                   
                                                
                                             
                                             
                                                g
                                                
                                                   ω
                                                   ,
                                                   s
                                                
                                                
                                                   
                                                   a
                                                   ℓ
                                                
                                             
                                             
                                                b
                                                
                                                   ω
                                                   ,
                                                   s
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                
                                                   π
                                                   ^
                                                
                                                s
                                             
                                             
                                                (
                                                
                                                   T
                                                   s
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             subject
                                             
                                             to:
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                
                                                d
                                             
                                             =
                                             Simulation
                                             
                                                (
                                                
                                                   T
                                                
                                                )
                                             
                                             
                                             
                                             
                                             
                                                HSR
                                                −
                                                TTP
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                V
                                             
                                             =
                                             
                                                
                                                   V
                                                
                                                *
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         T
                                                      
                                                   
                                                   d
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   K
                                                   ^
                                                
                                                s
                                             
                                             =
                                             
                                                
                                                   K
                                                   ^
                                                
                                                s
                                             
                                             
                                                (
                                                
                                                   
                                                      T
                                                      ˜
                                                   
                                                   s
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                
                                                a
                                             
                                             =
                                             CNMNL
                                             
                                                (
                                                
                                                   V
                                                
                                                ,
                                                
                                                   
                                                      K
                                                   
                                                   ^
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                T
                                             
                                             ∈
                                             
                                                
                                                   l
                                                   
                                                   R
                                                
                                                
                                                   |
                                                   S
                                                   |
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The HSR–TTP model has, as decision variables, the vector of departure times of the services T from the initial stations. This variable can, in principle, take any value. The simulation model calculates the complete timetable T
                        
                           d
                         (using Table 3), solving any conflict that might appear and modifying the planned schedules to satisfy the rolling stock constraints. From the schedule T
                        
                           d
                         the utilities of the services available are calculated for each journey pair ω. Each service s which lies outside the planning horizon 
                           
                              [
                              0
                              ,
                              T
                              ]
                           
                         will not, in the end, be run, so its effective capacity will be 
                           
                              
                                 
                                    K
                                    ^
                                 
                                 s
                              
                              =
                              0
                           
                         and the running cost 
                           
                              
                                 
                                    π
                                    ^
                                 
                                 s
                              
                              =
                              0
                           
                        . Finally, from the effective capacities 
                           
                              
                                 K
                              
                              ^
                           
                         and the utilities V the demand for the set of services is calculated with the CNMNL model.

This process: (i) running a simulation model to calculate the complete timetable, (ii) evaluating the non-linear utilities and (iii) solving a convex program for estimating the demand disaggregation per service, can be represented mathematically as 
                           
                              
                                 g
                                 
                                    ω
                                    ,
                                    s
                                 
                                 
                                    
                                    a
                                    ℓ
                                 
                              
                              
                                 (
                                 
                                    T
                                 
                                 )
                              
                           
                         to show that there exists an (implicit) function which allows the demand of users of type ℓ of service s making journey ω to be calculated. This allows the model to be formulated as the following unconstrained optimisation problem:

                           
                              
                                 
                                    
                                       
                                          
                                             maximize
                                             
                                             
                                             
                                             
                                             
                                                Z
                                                
                                                   (
                                                   
                                                      T
                                                   
                                                   )
                                                
                                                =
                                                
                                                   ∑
                                                   
                                                      ℓ
                                                      ∈
                                                      L
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      ω
                                                      ∈
                                                      W
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      s
                                                      ∈
                                                      
                                                         S
                                                         w
                                                      
                                                   
                                                
                                                
                                                   g
                                                   
                                                      ω
                                                      ,
                                                      s
                                                   
                                                   
                                                      
                                                      a
                                                      ℓ
                                                   
                                                
                                                
                                                   (
                                                   
                                                      T
                                                   
                                                   )
                                                
                                                
                                                   b
                                                   
                                                      ω
                                                      ,
                                                      s
                                                   
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      s
                                                      ∈
                                                      S
                                                   
                                                
                                                
                                                   
                                                      π
                                                      ^
                                                   
                                                   s
                                                
                                                
                                                   (
                                                   
                                                      T
                                                      s
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             subject
                                             
                                             to:
                                             
                                             
                                             
                                             
                                             
                                             
                                                
                                                   T
                                                
                                                ∈
                                                
                                                   
                                                      l
                                                      
                                                      R
                                                   
                                                   
                                                      |
                                                      S
                                                      |
                                                   
                                                
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                                HSR
                                                −
                                                TTP
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The choice of the solution method should be based on the following three key features of the HSR–TTP timetable model:

                        
                           –
                           
                              Unconstrained nonlinear optimisation and derivative-free methods. The HSR–TTP model is an unconstrained nonlinear optimisation problem. Obtaining closed formulae for the derivatives of the objective function Z(T) is impossible because they are implicitly defined, or they do not exist and so any choice of a resolution method should be made from among the existing unconstrained nonlinear optimisation derivative-free methods.


                              Computational cost. The computational cost of evaluating the objective function is high because it requires a simulation model to be run and the optimisation model CNMNL to be solved; this should be considered and parallel computing strategies sought.


                              The 
                              HSR–TTP 
                              model presents multiple local optima.
                           

These characteristics make it impossible to use exact methods and require the use of metaheuristic algorithms. Nowadays there are many algorithm options available (ver Boussaïd, Lepagnot, & Siarry, 2013). This paper considers the Nelder–Mead method (NM, see Nelder and Mead (1965)), Standard Particle Swarm Optimisation (SPSO, see Zambrano-Bigiarini, Clerc, and Rojas (2013)) and a hybridisation of both methods (SPSO+NM, see Espinosa-Aranda, Garcia-Rodenas, and Angulo (2013)). The SPSO+NM algorithm has demonstrated good performance on various unconstrained benchmark functions (see Espinosa-Aranda et al., 2013) and it has also been applied successfully to cluster analysis (Lopez-García, García-Ródenas, & González Gómez, 2014). The HSR–TTP model is computationally demanding and it requires parallelisation strategies to obtain satisfactory solutions in real instances. The SPSO and SPSO+NM algorithms allow these strategies and this is a key motive for its choice. This is a new feature with respect to the implementation used in Espinosa-Aranda et al. (2013).


                        Particle Swarm Optimisation (PSO, Kennedy and Eberhart (1995)) is a global optimisation technique based on the metaphors of social interaction and communications. PSO has been shown to be effective in solving difficult and complex optimisation problems in a wide range of fields.

The PSO method is probabilistic and maintains a population of candidates. This algorithm uses collaboration among a population of simple search agents called particles (potential solutions to the problem) to find optima in some search space. The use of population sets helps the algorithm avoid being trapped at a local optimum. In this paper, the Standard PSO 2011
                           1
                        
                        
                           1
                           Several SPSO 2011 programs have been put on line at Particle Swarm Central, URL http://www.particleswarm.info/Programs.htm.
                         is applied, but it includes parallel computing for the particle performance.

In the initialisation phase of the PSO algorithm, the position and velocities of the particles are randomly generated. In every iteration, each particle is updated by following two “best” values. The first, the so-called pbest, is achieved by self experience (Step 3) and the second, the so-called lbest, through the experience of a subset of particles (Step 4). The set of particles that informs a particle is called its neighbourhood . After finding these two values, the position and velocity of each particle will be updated in Step 5.

The complete computational procedure of the Standard PSO algorithm for solving HSR–TTP timetable model is summarized in Table 4
                        
                        .

The Nelder–Mead simplex method (NM) was introduced in Nelder and Mead (1965) and is a technique for minimizing an objective function in a many-dimensional space. The NM method is commonly used in unconstrained nonlinear optimisation, which is a well-defined numerical method for twice differentiable and unimodal problems. However, the NM technique is a heuristic search method that may converge to non-stationary points. This method is a direct search method that does not use numerical or analytic derivatives and has very pronounced local convergence. It is therefore an algorithm with no local random component.

The NM method uses the concept of a simplex, which is a special polytope of 
                           
                              n
                              +
                              1
                           
                         vertices in n dimensions. The NM algorithm initializes the procedure with a non-degenerate simplex whose vertices approach the global optimum. This simplex is modified either by changing any of its vertices for another in which the objective function has increased, or going around the polyhedron if it has not improved the objective function. Candidate replacement points are obtained by transforming the worst vertex through reflection, expansion, contraction and shrinkage operations on the centroid of the current simplex.

The main advantage of this method is that it frequently gives significant improvements in the first few iterations and quickly produces quite satisfactory results. This property is very useful in applications where the objective function is too expensive to evaluate Table 5.
                     

Metaheuristics often incorporate an exploration (diversification) stage and an exploitation (intensification) stage. Exploration is needed to identify parts of the feasible region with high quality solutions. In the exploitation stage the metaheuristic intensifies the search in some promising areas previously detected.


                        Espinosa-Aranda et al. (2013) propose a framework to hybridize two metaheuristics by using each in the exploration and exploitation stages. In this paper, we apply an instance of this algorithmic class, called SPSO + NM. The SPSO + NM algorithm applies the SPSO method until nc
                         improvements of the objective function are obtained (exploration phase). Then the NM algorithm performs nr
                         iterations starting from the best solution found by the SPSO algorithm (exploitation phase). Finally, the best solution in the population set is replaced with the solution found in the exploitation stage and the process is repeated. The parameters nc
                         and nr
                         play the role of providing a trade-off between the processes of global and local search, i.e. between exploration stage and exploration stage.


                        Espinosa-Aranda et al. (2013) show that SPSO+NM achieves a faster convergence than SPSO. This is because SPSO+NM detects that the search neighbourhood has changed and so applies a local search based on NM. This search is systematic, with no random component, unlike the original SPSO, which accelerates the process.

The SPSO+NM algorithm applied to the HSR–TTP timetable model is shown in Table 6.

This section tries to test the proposed methodology based on derivative free methods focusing on two main objectives: (i) studying the quality of the solution found and (ii) studying the computational efficiency of the algorithms.

This model has been implemented in a software application called dhAVE (which can be seen running in http://youtu.be/K9mAoo__5Uk), and run in MATLAB 2013, while the demand model has been solved using CONOPT. The computer used to perform the computational experiments has the following characteristics: Windows 7 64 bits, processor: 2 × AMD Opteron 4226, 12 cores 2.7 gigahertz, RAM: 12 gigibyte 1600 megahertz.

To test the HSR–TTP model, a case study has been generated. This numerical example is focused on the Madrid–Seville corridor of the HSR network of Spain. This corridor is formed by 5 stations [Madrid(MAD), Ciudad Real(CR), Puertollano(PU), Cordoba(COR), Seville(SEV)] which produces 20 origin-destination demand pairs (10 per direction of travel) serving 15115 passengers/day. Currently this demand is completely covered by 100 services. The data used for the experiment can be downloaded from http://bit.ly/1gCFw5e. Fig. 8
                        
                         depicts the corridor used by these services, Table 7
                         indicates the route of each type of service and Table 8
                        
                         shows the characteristics of each type of train.

The origin–destination matrix (different potential trips between stations) on a working day is shown in Table 9.

The baseline in order to compare the timetable obtained consists of the current schedule used by RENFE after running the current planned schedule in the simulation module. The simulated time-station diagram is shown in Fig. 9. To compare the solution obtained with the actual schedule of RENFE avoiding distortions, the operation of all services has been forced, that is 
                           
                              T
                              =
                              +
                              ∞
                           
                        .

The demand model computes the utility for each train and each demand. In this example only one type of user (
                           
                              ℓ
                              =
                              1
                           
                        ) is considered with regard to economic characteristics, but taking into account the trip of each traveller (origin–destination pair ω), there will be 20 types of user. Each user type ω can travel using a set of services s ∈ Sω
                        . Considering the planned schedule, the set of alternatives 
                           
                              (
                              ω
                              ,
                              s
                              )
                              ∈
                              A
                           
                         consists of 298 alternatives.

In this computational experiment we have considered the utility functions based on Gaussian kernels estimated in Espinosa-Aranda et al. (2014). The attributes considered for each possible alternative (ω, s) are: (i) 
                           
                              
                                 T
                                 
                                    s
                                    j
                                 
                                 d
                              
                              ,
                           
                         the departure time from station 
                           
                              j
                              ∈
                              J
                           
                         of service s, (ii) b
                        
                           ω, s
                        , the price for demand ω using service s and (iii) 
                           
                              
                                 c
                                 w
                                 s
                              
                              ,
                           
                         the travel time of service s for demand w and . The vector of attributes is denoted as 
                           
                              
                                 x
                                 
                                    ω
                                    s
                                 
                              
                              =
                              
                                 (
                                 
                                    T
                                    
                                       s
                                       j
                                    
                                    d
                                 
                                 ,
                                 
                                    b
                                    
                                       ω
                                       ,
                                       s
                                    
                                 
                                 ,
                                 
                                    c
                                    w
                                    s
                                 
                                 )
                              
                           
                        . To simplify, Espinosa-Aranda et al. (2014) set 
                           
                              
                                 V
                                 ω
                              
                              
                                 (
                                 x
                                 )
                              
                              =
                              
                                 V
                                 *
                              
                              
                                 (
                                 x
                                 )
                              
                              
                              for
                              
                              all
                              
                              pairs
                              
                              ω
                              .
                           
                         So the utility 
                           
                              V
                              
                                 ω
                                 ,
                                 s
                              
                              
                                 a
                                 ℓ
                              
                           
                         for each type of users ℓ (in this case, 
                           
                              ℓ
                              =
                              1
                           
                        ) using service s for the demand ω is calculated using Eq. (19) as follows:

                           
                              (32)
                              
                                 
                                    
                                       V
                                       
                                          ω
                                          ,
                                          s
                                       
                                       
                                          a
                                          ℓ
                                       
                                    
                                    =
                                    
                                       V
                                       *
                                    
                                    
                                       (
                                       
                                          T
                                          
                                             s
                                             j
                                          
                                          d
                                       
                                       ,
                                       
                                          b
                                          
                                             ω
                                             ,
                                             s
                                          
                                       
                                       ,
                                       
                                          c
                                          w
                                          s
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

It is worth noting that the value of 
                           
                              T
                              
                                 s
                                 j
                              
                              d
                           
                         is calculated by the optimisation model and the attributes 
                           
                              
                                 b
                                 
                                    ω
                                    ,
                                    s
                                 
                              
                              ,
                              
                                 c
                                 w
                                 s
                              
                           
                         are fixed.

The baseline value is calculated using the current RENFE schedule with an objective value of 3, 64, 180 euros/day.

This section shows a set of 11 experiments using the NM, SPSO and SPSO+NM algorithms. Each algorithm has been run for 10, 000 objective function evaluations. The NM algorithm starts from the planned schedule to obtain its proposed solution. SPSO and SPSO+NM methods start with an initial swarm of 40 particles calculated randomly on the interval [0:00, 23:59] hours. The parameters w, c
                        1 and c
                        2 for updating velocity are defined as 
                           
                              w
                              =
                              1
                              /
                              (
                              2
                              ln
                              (
                              2
                              )
                              )
                              ,
                           
                        
                        
                           
                              
                                 c
                                 1
                              
                              =
                              0.5
                              +
                              ln
                              
                                 (
                                 2
                                 )
                              
                           
                         and 
                           
                              
                                 c
                                 2
                              
                              =
                              
                                 c
                                 1
                              
                           
                         (see Zambrano-Bigiarini et al., 2013). SPSO+NM values nc
                         and nr
                         are set to 1, 5, 25 and 1, 5, 10 percent of the total iterations respectively, combining all the possibilities.

The results obtained are shown in Table 10
                        
                        . The first column indicates the algorithm used and its configuration. Also the solution found and the CPU time of the algorithm can be shown in the second and third columns respectively. The last column contains the improvement obtained with respect to the baseline value using the following equation:

                           
                              (33)
                              
                                 
                                    Improvement
                                    =
                                    
                                       
                                          Z
                                          −
                                          
                                             baseline
                                             
                                             value
                                          
                                       
                                       
                                          baseline
                                          
                                          value
                                       
                                    
                                    *
                                    100
                                 
                              
                           
                        
                     

As can be seen, the computational time of the optimisation algorithms is between 6.1 and 7.5 hours producing an improvement percentage around 1 percent in the NM case and more than 2 percent in SPSO-related algorithms. It is worth noting that the SPSO+NM approach obtained in all cases a better solution than NM and SPSO algorithms alone.

Moreover, Fig. 10 shows the objective value versus the number of evaluations of the objective function.

This section analyses the possibility of reducing the computational time of the proposed optimisation algorithms. SPSO and SPSO+NM algorithms can be improved because parts of them can be parallelized. There is software code that can be changed from sequential (see Fig. 11
                        ) to parallel mode (see Fig. 12
                        ). This part then changes its behaviour and several evaluations of the objective function can be done at the same time.

Using this idea, the speed up-ratio is obtained for each algorithm using the following equation:

                           
                              (34)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   speed
                                                   up
                                                   −
                                                   ratio
                                                
                                                n
                                             
                                             =
                                             
                                                
                                                   sequential
                                                   
                                                   runtime
                                                
                                                
                                                   parallel
                                                   
                                                   
                                                      runtime
                                                      
                                                      
                                                         with
                                                         
                                                         n
                                                         
                                                         cores
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

This experiment has been carried out running the SPSO and SPSO+NM (
                           
                              
                                 n
                                 c
                              
                              =
                              25
                              ,
                           
                        
                        
                           
                              
                                 n
                                 r
                              
                              =
                              10
                           
                        ) algorithms in parallel mode with 2, 4, 8 and 12 parallel threads. This configuration of the algorithm has been selected because it is the one which found the better solution. The results of the computational cost and speed-up ratio of the algorithms can be seen in Table 11
                         and Fig. 13.

The results show that the improvement of each algorithm depends on the number of parallel threads. However it is worth noting that the speed up-ratio in the SPSO+NM algorithm does not increase with the number of parallel threads. This occurs because of the random nature of the algorithm, in which the NM algorithm, which is non-parallelizable, was run an indeterminate number of times depending on the solutions found by the SPSO stage. The case with 2 and 4 parallel threads only ran the NM algorithm once, performing 1000 function evaluations, while with 8 and 12 cores the NM algorithm is run twice, performing 2000 function evaluations.

In conclusion, the best algorithm is the SPSO+NM hybridisation which achieves an improvement of 2.46 percent and the parallelisation strategies are capable of reducing the computational time of this algorithm to 2 hours.

The goal of this subsection is to analyse the impact of problem size and characteristics on computing times and solution quality. In this experiment we have modified the size of the instances by adding/removing trains from the timetable baseline, and we have solved these examples with the NM, SPSO and SPSO+NM(
                           
                              
                                 n
                                 c
                              
                              =
                              25
                              ,
                              
                                 n
                                 r
                              
                              =
                              10
                           
                        ) methods, using the same set of parameters as in the previous experiments. We have also considered the parallelized version with 12 cores of the SPSO and the SPSO+NM.


                        Fig. 14
                         shows the CPU times. The significant facts are that, on the one hand the SPSO in its sequential version tends not to be applicable in big problems, while the parallel version, having a higher performance as shown in Experiment II, is the one that behaves best with respect to computational cost.

However, since metaheuristics do not provide upper bounds, to assess solution quality, Fig. 15
                         shows a comparison between the solutions. It can be seen that all the methods except NM converge to solutions with the same value in the objective function. The sole exception is the NM which appears to converge to a worse solution when the size of the problem grows. These results may be explained because the algorithms based on SPSO methods are global optimisation methods whereas the NM has local convergence.

@&#CONCLUSION@&#

This paper proposes a disaggregated multi-modal schedule-based HSR model focused on endogenous factors, to determine the HSR demand. This model is divided into two modules. The first is a discrete event simulation model which calculates the whole timetable considering the departure time of the trains from the origin station and several operational constraints. After this, a novel constrained nested logit model obtains the number of passengers that will use the services based on the calculated departure times, the travel times, the ticket price and the capacity constraints of each service.

The proposed HRS–TTP model aims at maximizing the profits of the railway operator. It is solved using derivative free algorithms, hybridisation techniques and parallelisation techniques in a computational experiment based on real data from the Madrid–Seville High-Speed corridor.

The results show the applicability of the proposed approach to a real scenario in an acceptable computational time and how the model generated represents the behaviour of the users of the railway network considering the timetable calculated, achieving an improvement in the benefits obtained by the railway operator of 2.46 percent with respect to the original schedule. The numerical experiments show also how parallelisation strategies may become essential when addressing large scale instances of the HSR–TTP model.

@&#ACKNOWLEDGEMENTS@&#

This research has been financed by the 
                     Ministerio de Economía y Competitividad
                   of Spain with the TRA-2011-27791-C03-03 research project.

@&#REFERENCES@&#

