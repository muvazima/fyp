@&#MAIN-TITLE@&#Approximation algorithms for solving the constrained arc routing problem in mixed graphs

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We consider the constrained arc routing problem in mixed graphs.


                        
                        
                           
                           It is to determine a shortest tour T traversing each e between l(e) and u(e) times.


                        
                        
                           
                           We design an (1+1/l_0)-approximation algorithm in 
                                 
                                    O
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          m
                                       
                                       
                                          3
                                       
                                    
                                    log
                                    
                                    n
                                    )
                                 
                               to solve this problem.


                        
                        
                           
                           We also present two optimal algorithms to solve its special versions, respectively.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Combinatorial optimization

Arc routing

Lower/upper demand bound

Approximation algorithm

Combinatorial algorithm

@&#ABSTRACT@&#


               
               
                  Given a mixed graph G with vertex set V, let E and A denote the sets of edges and arcs, respectively. We use 
                        
                           
                              
                                 Q
                              
                              
                                 +
                              
                           
                        
                      and 
                        
                           
                              
                                 Z
                              
                              
                                 +
                              
                           
                        
                      to denote the sets of positive rational numbers and positive integers, respectively. For any connected mixed graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           ∪
                           A
                           ;
                           w
                           ;
                           l
                           ,
                           u
                           )
                        
                      with a length function 
                        
                           w
                           :
                           E
                           ∪
                           A
                           →
                           
                              
                                 Q
                              
                              
                                 +
                              
                           
                        
                      and two integer functions 
                        
                           l
                           ,
                           u
                           :
                           E
                           ∪
                           A
                           →
                           
                              
                                 Z
                              
                              
                                 +
                              
                           
                        
                      satisfying 
                        
                           l
                           (
                           e
                           )
                           ⩽
                           u
                           (
                           e
                           )
                        
                      for each 
                        
                           e
                           ∈
                           E
                           ∪
                           A
                        
                     , we are asked to determine a minimum length tour T traversing each 
                        
                           e
                           ∈
                           E
                           ∪
                           A
                        
                      at least 
                        
                           l
                           (
                           e
                           )
                        
                      and at most 
                        
                           u
                           (
                           e
                           )
                        
                      times. This new constrained arc routing problem generalizes the mixed Chinese postman problem. Let 
                        
                           n
                           =
                           |
                           V
                           |
                        
                      and 
                        
                           m
                           =
                           |
                           E
                           ∪
                           A
                           |
                        
                      denote the number of vertices and edges (including arcs), respectively. Using network flow techniques, we design a 
                        
                           (
                           1
                           +
                           1
                           /
                           
                              
                                 l
                              
                              
                                 0
                              
                           
                           )
                        
                     -approximation algorithm in time 
                        
                           O
                           (
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           
                              
                                 m
                              
                              
                                 3
                              
                           
                           log
                           
                           n
                           )
                        
                      to solve this constrained arc routing problem such that 
                        
                           l
                           (
                           e
                           )
                           <
                           u
                           (
                           e
                           )
                        
                      holds for each edge 
                        
                           e
                           ∈
                           E
                           ,
                           l
                           (
                           e
                           )
                           ⩽
                           u
                           (
                           e
                           )
                        
                      holds for each arc 
                        
                           e
                           ∈
                           A
                        
                      and 
                        
                           
                              
                                 l
                              
                              
                                 0
                              
                           
                           =
                           min
                           {
                           l
                           (
                           e
                           )
                           |
                           e
                           ∈
                           E
                           }
                        
                     . In addition, we present two optimal combinatorial algorithms in times 
                        
                           O
                           (
                           
                              
                                 n
                              
                              
                                 3
                              
                           
                           )
                        
                      and 
                        
                           O
                           (
                           
                              
                                 nm
                              
                              
                                 2
                              
                           
                           log
                           
                           n
                           )
                        
                      to solve this problem for the cases 
                        
                           A
                           =
                           ∅
                        
                      and 
                        
                           E
                           =
                           ∅
                        
                     , respectively.
               
            

@&#INTRODUCTION@&#

In most arc routing problems, the objective is to determine a least-cost traversal of a set of specified edges or arcs of a mixed graph. Such problems occur in a variety of practical contexts and have attracted attention from both mathematicians and operations researchers. The earliest arc routing problem was the Königsberg seven bridges problem, which is to determine whether there exists a closed tour traversing exactly once each of the seven bridges on the Pregel river through Königsberg. After Euler solved the Königsberg seven bridges problem in the negative, he was concerned almost exclusively with the existence of a tour. The question of determining such a tour was addressed and solved by Hierholzer and Wiener (1873). The reader is referred to Fleischner (1991) for an interesting account of this problem.

Another closely related well-known problem is the so-called Chinese postman problem (CPP) posed by Guan (1960). In contrast to the Königsberg seven bridges problem, Guan addressed a natural question that is to determine a minimum length tour traversing each edge of a weighted graph at least once. The CPP is a version of the arc routing problem specialized to graphs. Using Edmonds’ combinatorial algorithm for solving the maximum weighted matching problem (Edmonds, 1965), Edmonds and Johnson (1973) designed an optimal combinatorial algorithm to solve the CPP.

Closely related to the CPP is the directed Chinese postman problem (DCPP), which is a version of the arc routing problem specialized to directed graphs, or simply digraphs. Using a combinatorial algorithm in Ford and Fulkerson (1962) for solving the transportation problem, Edmonds and Johnson (1973) also designed another optimal combinatorial algorithm to solve the DCPP.

The mixed Chinese postman problem (MCPP), listed in Garey and Johnson (1979) as the problem ND25, is a common generalization of the CPP and the DCPP. In the MCPP, an input graph may contain both undirected and directed edges. A directed edge is also referred to as an arc. The objective is to determine a tour that traverses at least once every edge in either direction and every arc in the direction of that arc. Even though the CPP and the DCPP are both polynomially solvable (Edmonds & Johnson, 1973), Papadimitriou (1976) showed that the MCPP becomes NP-complete. Because a number of practical applications, such as mail delivery, snow removal, and trash pick-up, can be modeled as instances of the MCPP, it is important to design good approximation algorithms for this problem.

Quite a few papers about the MCPP have appeared in the literature over the past four decades. Edmonds and Johnson (1973) presented the first approximation algorithm for the MCPP. Christofides, Benavent, Campos, Corberan, and Mota (1984) designed an exact algorithm for the MCPP based on a branch-and-bound algorithm using Lagrangian bounds. Afterwards, Frederickson (1979) showed that the approximation algorithm due to Edmonds and Johnson (1973) is indeed a 2-approximation algorithm to solve the MCPP. Frederickson provided a mixed strategy algorithm for the MCPP that is a 5/3-approximation algorithm. As far as we know, the best approximation algorithm to solve the MCPP is a 3/2-approximation algorithm due to Raghavachari and Veerasamy (1999). Comprehensive surveys, latest advances and new challenges on the MCPP are available in Dror (2000), Golden et al. (2008) and Toth and Vigo (2002). Integer and linear programming formulations of the postman problems have generated great interest in recent years (Nobert & Picard, 1996; Ralphs, 1993). Ralphs (1993) showed that a linear relaxation of the MCPP has optimal solutions that are half-integral. One can use this fact to derive a 2-approximation algorithm for the MCPP. It is interesting to note that the implementation of Nobert and Picard (1996) has been used for scheduling snow removal in Montreal. Corberan, Marti, and Sanchis (2002) presented a heuristic algorithm for the MCPP, using greedy randomized adaptive search procedure techniques. Goel and Gruhn (2008) recently considered a general vehicle routing problem (GVRP) that generalizes the MCPP, where the GVRP is a rich vehicle routing problem incorporating various complexities found in real-life applications. Other interesting materials related to the GVRP are referred to Ghiani and Improta (2000) and Jozefowiez, Semet, and Talbi (2008).

In the literature, one may either traverse some required edges or arcs exactly once in a minimum length feasible tour of a mixed graph or show the non-existence of such a tour. This becomes a variant of the MCPP. In order to widen the scope of possible applications for arc routing models, the times that an edge or arc is traversed should be given a reasonable range rather limited to at least once. We should consider a generalization of the MCPP for which some required edges or arcs would be traversed at least 
                        
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                        
                      and at most 
                        
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                        
                      times (
                        
                           1
                           ⩽
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ⩽
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                        
                     ) in a tour. This new model generalizes the above-mentioned variant of the MCPP. In this paper, we consider the constrained arc routing problem in connected mixed graphs (CARM) defined as follows. Let 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           ∪
                           A
                           ;
                           w
                           ;
                           l
                           ,
                           u
                           )
                        
                      be a connected mixed graph defined on vertex set V such that E is the set of all edges and A is the set of all arcs. Let 
                        
                           n
                           =
                           |
                           V
                           |
                        
                      and 
                        
                           m
                           =
                           |
                           E
                           ∪
                           A
                           |
                        
                      denote the number of vertices and edges (including arcs), respectively. Let 
                        
                           
                              
                                 Q
                              
                              
                                 +
                              
                           
                        
                      and 
                        
                           
                              
                                 Z
                              
                              
                                 +
                              
                           
                        
                      denote the set of positive rational numbers and the set of positive integers, respectively. For a length function 
                        
                           w
                           :
                           E
                           ∪
                           A
                           →
                           
                              
                                 Q
                              
                              
                                 +
                              
                           
                        
                      and two integer functions 
                        
                           l
                           ,
                           u
                           :
                           E
                           ∪
                           A
                           →
                           
                              
                                 Z
                              
                              
                                 +
                              
                           
                        
                      satisfying 
                        
                           l
                           (
                           e
                           )
                           ⩽
                           u
                           (
                           e
                           )
                        
                      for each 
                        
                           e
                           ∈
                           E
                           ∪
                           A
                        
                     , we are asked to determine a tour T traversing each 
                        
                           e
                           ∈
                           E
                           ∪
                           A
                        
                      at least 
                        
                           l
                           (
                           e
                           )
                        
                      and at most 
                        
                           u
                           (
                           e
                           )
                        
                      times such that the objective is to minimize the total length 
                        
                           w
                           (
                           T
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 e
                                 ∈
                                 E
                                 ∪
                                 A
                              
                           
                           t
                           (
                           e
                           )
                           w
                           (
                           e
                           )
                        
                     , where 
                        
                           t
                           (
                           e
                           )
                        
                      denotes the number of times that the edge or arc e is traversed by the tour T.

There are two special cases to note. (1) If 
                        
                           l
                           (
                           e
                           )
                           =
                           u
                           (
                           e
                           )
                           =
                           1
                        
                      for each edge e of the required subset of 
                        
                           E
                           ∪
                           A
                        
                     , then the CARM problem for this version becomes the above-mentioned variant. (2) If 
                        
                           l
                           (
                           e
                           )
                           =
                           1
                        
                      and 
                        
                           u
                           (
                           e
                           )
                           =
                           +
                           ∞
                        
                      for each edge 
                        
                           e
                           ∈
                           E
                           ∪
                           A
                        
                     , then the CARM problem for this version specializes to the MCPP. It follows that the CARM problem is also NP-complete.

A capacitated Chinese postman problem (CCPP) was posed by Golden and Wong (1981) as follows. Consider a mixed graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           ∪
                           A
                           ;
                           q
                           ;
                           c
                           )
                        
                     . Vertex 
                        
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                        
                      represents a depot where identical vehicles of capacity L are based. Each 
                        
                           e
                           ∈
                           E
                           ∪
                           A
                        
                      has a positive demand 
                        
                           q
                           (
                           e
                           )
                        
                      and a cost 
                        
                           c
                           (
                           e
                           )
                        
                      and can be traversed any number of times by any number of vehicles. A vehicle route is said to be feasible if it starts and ends at the depot 
                        
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                        
                      and the total demand of the edges and arcs traversed by the vehicle does not exceed L. The CCPP looks for a set of feasible vehicle routes of least total cost such that each edge or arc appears in at least one route and is traversed by exactly one vehicle. Beullens, Muyldermans, Cattrysse, and Oudheusden (2003), Golden et al. (2008), Mourão and Amado (2005) and Zachariadis and Kiranoudis (2011) studied the capacitated arc routing problem (CARP) that is an extension of the CCPP. Recently, Lysgaard and Wohlk (2014) also considered a variant of the CARP where the objective is to minimize the sum of arrival times at the customers, for a fixed starting time of each route.

It is easy to see that the CCPP restricted to the case of one vehicle of capacity 
                        
                           L
                           ⩾
                           
                              
                                 ∑
                              
                              
                                 e
                                 ∈
                                 E
                                 ∪
                                 A
                              
                           
                           q
                           (
                           e
                           )
                        
                      becomes the MCPP. Christofides et al. (1984) proposed a heuristic procedure for obtaining a reasonable solution to the CCPP. Golden and Wong (1981) showed that even finding a 3/2-approximation algorithm to solve the CCPP remains NP-complete.

We know that the CARM problem and the CCPP generalize the MCPP, but each of them does not follow from the other. Since the CCPP can be formulated as a set covering problem (Golden, 1978), Theorem 4.4 in Feige (1998) implies that the CCPP would not be approximated within 
                        
                           (
                           1
                           -
                           ε
                           )
                           log
                           n
                        
                      unless 
                        
                           NP
                           ⊆
                           TIME
                           (
                           
                              
                                 n
                              
                              
                                 O
                                 (
                                 log
                                 log
                                 n
                                 )
                              
                           
                           )
                        
                     , where 
                        
                           ε
                           ∈
                           (
                           0
                           ,
                           1
                           )
                        
                     . However, the CARM problem can be approximated within a constant performance ratio as shown in the following text. We will show that two special versions of the CARM problem can be optimally solved in polynomial times.

The remainder of this paper is organized as follows. In Section 2, we present terminology for the description of our algorithms, and then establish some key lemmas to ensure the correctness of our algorithms. In Section 3, we study the CARM problem that can be approximated within performance ratio 
                        
                           1
                           +
                           1
                           /
                           
                              
                                 l
                              
                              
                                 0
                              
                           
                        
                      and in time 
                        
                           O
                           (
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           
                              
                                 m
                              
                              
                                 3
                              
                           
                           log
                           
                           n
                           )
                        
                     , where 
                        
                           l
                           (
                           e
                           )
                           <
                           u
                           (
                           e
                           )
                        
                      holds for each edge 
                        
                           e
                           ∈
                           E
                           ,
                           l
                           (
                           e
                           )
                           ⩽
                           u
                           (
                           e
                           )
                        
                      holds for each arc 
                        
                           e
                           ∈
                           A
                        
                      and 
                        
                           
                              
                                 l
                              
                              
                                 0
                              
                           
                           =
                           min
                           {
                           l
                           (
                           e
                           )
                           |
                           e
                           ∈
                           E
                           }
                        
                     . In Section 4, we study the CARM problem for the case 
                        
                           A
                           =
                           ∅
                        
                      that can be solved optimally by our combinatorial algorithm in time 
                        
                           O
                           (
                           
                              
                                 n
                              
                              
                                 3
                              
                           
                           )
                        
                     . In Section 5, we study the CARM problem for the case 
                        
                           E
                           =
                           ∅
                        
                      that can be solved optimally by our combinatorial algorithm in time 
                        
                           O
                           (
                           
                              
                                 nm
                              
                              
                                 2
                              
                           
                           log
                           
                           n
                           )
                        
                     . In Section 6, we summarize our conclusions.

A mixed graph 
                     
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           ∪
                           A
                           )
                        
                      contains both edges (unordered pairs of vertices in E) and arcs (ordered pairs of vertices in A). A mixed graph G is called a multigraph if G contains parallel edges or arcs, but no self-loops. Parallel edges (or arcs) are called multi-edges (or multi-arcs). In this case, the set E (or A) is a multiset of edges (or arcs). A mixed graph G is called a simple mixed graph if G contains neither self-loops nor parallel edges or arcs, but G may have an edge and an arc with the same end-vertices. The term “edge” is also used to refer both edge and arc of a mixed graph. Thus, an arc is regarded as a directed edge. A mixed graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           ∪
                           A
                           )
                        
                      is said to be an undirected graph (or simply, graph) if 
                        
                           A
                           =
                           ∅
                        
                      and a directed graph (or simply, digraph) if 
                        
                           E
                           =
                           ∅
                        
                     , respectively.

In the sequel, G always denotes a mixed graph. A walk in G is an alternating sequence 
                        
                           W
                           =
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                           ⋯
                           
                              
                                 x
                              
                              
                                 k
                                 -
                                 1
                              
                           
                           
                              
                                 e
                              
                              
                                 k
                                 -
                                 1
                              
                           
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                        
                      of vertices 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        
                      and edges or arcs 
                        
                           
                              
                                 e
                              
                              
                                 j
                              
                           
                        
                      from G such that either the two end-vertices of the edge 
                        
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                        
                      are 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        
                      and 
                        
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 1
                              
                           
                        
                      or the tail of the arc 
                        
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                        
                      is 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        
                      and the head of the arc 
                        
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                        
                      is 
                        
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 1
                              
                           
                        
                      for every 
                        
                           1
                           ⩽
                           i
                           ⩽
                           k
                           -
                           1
                        
                     . This means that this walk W traverses every edge 
                        
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                        
                      in either direction and every arc 
                        
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                        
                      in the direction of that arc. We say that W is a walk from 
                        
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                        
                      to 
                        
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                        
                      or an 
                        
                           (
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           )
                        
                     -walk. A walk W is closed if 
                        
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                        
                     , and we always refer such a closed walk as a tour or circuit.

If the vertices of a walk W are distinct, then W is called as a path. If the vertices 
                        
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 k
                                 -
                                 1
                              
                           
                        
                      are distinct and 
                        
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                        
                     , where 
                        
                           k
                           ⩾
                           3
                           ,
                           W
                        
                      is called as a cycle. Two paths 
                        
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        
                      are said to be vertex-disjoint (or edge-disjoint) if their vertex sets (or edge sets) are disjoint, respectively. Similarly, we can define two directed paths being arc-disjoint.

A mixed graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           ∪
                           A
                           )
                        
                      is connected if, for any two vertices x and y in G, there exists a path 
                        
                           
                              
                                 P
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                        
                      from x to y, where each edge 
                        
                           e
                           =
                           uv
                        
                      on 
                        
                           
                              
                                 P
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                        
                      may be traversed in either direction of this edge, but each arc 
                        
                           e
                           =
                           (
                           u
                           ,
                           v
                           )
                        
                      on 
                        
                           
                              
                                 P
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                        
                      may only be traversed from u to v. In addition, when G is a (mixed) weighted graph and 
                        
                           
                              
                                 P
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                        
                      is a path from x to y in G, we denote 
                        
                           w
                           (
                           
                              
                                 P
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                           )
                        
                      to be the sum of weights of all edges and arcs in the path 
                        
                           
                              
                                 P
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                        
                     , and we refer 
                        
                           
                              
                                 d
                              
                              
                                 G
                              
                           
                           (
                           x
                           ,
                           y
                           )
                        
                      as the weight of a shortest path from x to y, i.e., 
                        
                           
                              
                                 d
                              
                              
                                 G
                              
                           
                           (
                           x
                           ,
                           y
                           )
                           =
                           min
                           {
                           w
                           (
                           
                              
                                 P
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                           )
                        
                      
                     
                        
                           |
                        
                      
                     
                        
                           
                              
                                 P
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                        
                      is a path from x to y in 
                        
                           G
                           }
                        
                     . On the other hand, a digraph 
                        
                           D
                           =
                           (
                           V
                           ,
                           A
                           )
                        
                      is strongly connected if, for any two vertices x and y in D, there exists a directed path 
                        
                           
                              
                                 P
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                        
                      from x to y and at the same time a directed path 
                        
                           
                              
                                 P
                              
                              
                                 y
                                 ,
                                 x
                              
                              
                                 ′
                              
                           
                        
                      from y to x.

For any vertex v in a mixed graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           ∪
                           A
                           )
                        
                     , the degree of the vertex v, denoted by 
                        
                           
                              
                                 d
                              
                              
                                 G
                              
                           
                           (
                           v
                           )
                        
                      or 
                        
                           d
                           (
                           v
                           )
                        
                     , is the number of edges and arcs that are incident to v. For any vertex v in a mixed graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           ∪
                           A
                           )
                        
                     , the vertex v is even if its degree 
                        
                           
                              
                                 d
                              
                              
                                 G
                              
                           
                           (
                           v
                           )
                        
                      is even, otherwise the vertex v is odd. For any vertex v in a digraph 
                        
                           D
                           =
                           (
                           V
                           ,
                           A
                           )
                        
                     , denote 
                        
                           
                              
                                 δ
                              
                              
                                 D
                              
                              
                                 +
                              
                           
                           (
                           v
                           )
                        
                      the set of arcs leaving v and 
                        
                           
                              
                                 δ
                              
                              
                                 D
                              
                              
                                 -
                              
                           
                           (
                           v
                           )
                        
                      the set of arcs entering v, respectively. The out-degree of a vertex v, denoted by 
                        
                           
                              
                                 d
                              
                              
                                 D
                              
                              
                                 +
                              
                           
                           (
                           v
                           )
                        
                     , is the number of arcs that have v as their common tail, and the in-degree of a vertex v, denoted by 
                        
                           
                              
                                 d
                              
                              
                                 D
                              
                              
                                 -
                              
                           
                           (
                           v
                           )
                        
                     , is the number of arcs that have v as their common head. Equivalently, 
                        
                           
                              
                                 d
                              
                              
                                 D
                              
                              
                                 +
                              
                           
                           (
                           v
                           )
                           =
                           |
                           
                              
                                 δ
                              
                              
                                 D
                              
                              
                                 +
                              
                           
                           (
                           v
                           )
                           |
                        
                      and 
                        
                           
                              
                                 d
                              
                              
                                 D
                              
                              
                                 -
                              
                           
                           (
                           v
                           )
                           =
                           |
                           
                              
                                 δ
                              
                              
                                 D
                              
                              
                                 -
                              
                           
                           (
                           v
                           )
                           |
                        
                     , then the number 
                        
                           
                              
                                 d
                              
                              
                                 D
                              
                              
                                 +
                              
                           
                           (
                           v
                           )
                           +
                           
                              
                                 d
                              
                              
                                 D
                              
                              
                                 -
                              
                           
                           (
                           v
                           )
                        
                      is the degree of a vertex v.

In a mixed graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           ∪
                           A
                           )
                        
                     , an Eulerian tour is a closed walk that starts at some vertex 
                        
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                        
                     , traverses each edge or arc exactly once, and returns to the same vertex 
                        
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                        
                     . A mixed graph is Eulerian if it contains such an Eulerian tour. In addition, if a digraph 
                        
                           D
                           =
                           (
                           V
                           ,
                           A
                           )
                        
                      contains a directed Eulerian tour, then this digraph 
                        
                           D
                           =
                           (
                           V
                           ,
                           A
                           )
                        
                      is called a directed Eulerian graph, or simply an Eulerian digraph.

A matching in a graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           )
                        
                      is a set M of pairwise disjoint edges (i.e., the end-vertices of edges are all distinct), and each edge in M is called a matching edge. In addition, M is called a perfect matching if all vertices in V are covered by M, i.e., the matching M satisfies 
                        
                           |
                           M
                           |
                           =
                           |
                           V
                           |
                           /
                           2
                        
                     . Moreover, for a weighted graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           ;
                           w
                           )
                           ,
                           M
                        
                      is called a maximum matching in G if the weight 
                        
                           w
                           (
                           M
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 e
                                 ∈
                                 M
                              
                           
                           w
                           (
                           e
                           )
                        
                      is maximized among all matchings in G. Similarly, for a weighted graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           ;
                           w
                           )
                        
                      and a matching M of 
                        
                           G
                           ,
                           M
                        
                      is called a minimum cost perfect matching if M is a perfect matching such that the weight 
                        
                           w
                           (
                           M
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 e
                                 ∈
                                 M
                              
                           
                           w
                           (
                           e
                           )
                        
                      is minimized among all perfect matchings in G.

For any network, a synonym of digraph, 
                        
                           N
                           =
                           (
                           V
                           ,
                           A
                           ;
                           u
                           ;
                           c
                           ;
                           s
                           ,
                           t
                           )
                        
                      with a capacity function 
                        
                           u
                           :
                           A
                           →
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                        
                     , a cost function 
                        
                           c
                           :
                           A
                           →
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                        
                     , a source s and a sink t, a flow from s to t (briefly, an 
                        
                           (
                           s
                           ,
                           t
                           )
                        
                     
                     -flow) is a function f from A to the set 
                        
                           
                              
                                 R
                              
                              
                                 0
                              
                              
                                 +
                              
                           
                        
                      of non-negative real numbers, i.e., 
                        
                           f
                           :
                           A
                           →
                           
                              
                                 R
                              
                              
                                 0
                              
                              
                                 +
                              
                           
                        
                     , satisfying the following conditions:
                        
                           (1)
                           (the capacity constraint) 
                                 
                                    0
                                    ⩽
                                    f
                                    (
                                    e
                                    )
                                    ⩽
                                    u
                                    (
                                    e
                                    )
                                 
                               for each arc 
                                 
                                    e
                                    ∈
                                    A
                                 
                              ;

(the flow conservation) 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                D
                                             
                                             
                                                +
                                             
                                          
                                          (
                                          v
                                          )
                                       
                                    
                                    f
                                    (
                                    e
                                    )
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                D
                                             
                                             
                                                -
                                             
                                          
                                          (
                                          v
                                          )
                                       
                                    
                                    f
                                    (
                                    e
                                    )
                                 
                               for each vertex 
                                 
                                    v
                                    ∈
                                    V
                                    -
                                    {
                                    s
                                    ,
                                    t
                                    }
                                 
                              ;


                              
                                 
                                    v
                                    (
                                    f
                                    )
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                D
                                             
                                             
                                                +
                                             
                                          
                                          (
                                          s
                                          )
                                       
                                    
                                    f
                                    (
                                    e
                                    )
                                    -
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                D
                                             
                                             
                                                -
                                             
                                          
                                          (
                                          s
                                          )
                                       
                                    
                                    f
                                    (
                                    e
                                    )
                                    ⩾
                                    0
                                 
                               for the source s.

We call 
                        
                           v
                           (
                           f
                           )
                        
                      the value of an 
                        
                           (
                           s
                           ,
                           t
                           )
                        
                     -flow f, and we define its cost 
                        
                           c
                           (
                           f
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 e
                                 ∈
                                 A
                              
                           
                           c
                           (
                           e
                           )
                           f
                           (
                           e
                           )
                        
                     . In addition, if the value 
                        
                           f
                           (
                           e
                           )
                        
                      is integral for each arc 
                        
                           e
                           ∈
                           A
                        
                     , we call an 
                        
                           (
                           s
                           ,
                           t
                           )
                        
                     -flow f as an integral 
                     
                        
                           (
                           s
                           ,
                           t
                           )
                        
                     -flow.

For a network 
                        
                           N
                           =
                           (
                           V
                           ,
                           A
                           ;
                           l
                           ,
                           u
                           ;
                           s
                           ,
                           t
                           )
                        
                      with a demand function 
                        
                           l
                           :
                           A
                           →
                           
                              
                                 R
                              
                              
                                 0
                              
                              
                                 +
                              
                           
                        
                      and a capacity function 
                        
                           u
                           :
                           A
                           →
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                        
                     , a function 
                        
                           f
                           :
                           A
                           →
                           
                              
                                 R
                              
                              
                                 0
                              
                              
                                 +
                              
                           
                        
                      is called a circulation in N if the function f satisfies 
                        
                           l
                           (
                           e
                           )
                           ⩽
                           f
                           (
                           e
                           )
                           ⩽
                           u
                           (
                           e
                           )
                        
                      for each arc 
                        
                           e
                           ∈
                           A
                        
                      and the flow conservation rule (2) holds at every vertex v in N. When f is a circulation in N, the cost of f is defined to be the value 
                        
                           c
                           (
                           f
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 e
                                 ∈
                                 A
                              
                           
                           c
                           (
                           e
                           )
                           f
                           (
                           e
                           )
                        
                     . Similarly, we call a circulation f to be integral if 
                        
                           f
                           (
                           e
                           )
                        
                      is integral for each arc 
                        
                           e
                           ∈
                           A
                        
                     .

For any real number r, let 
                        
                           ⌊
                           r
                           ⌋
                        
                      (or 
                        
                           ⌈
                           r
                           ⌉
                        
                     ) denote the greatest (or smallest) integer less (or greater) than or equal to r.

The following key lemmas are needed to design our algorithms later on.
                        Lemma 1
                        
                           Hierholzer and Wiener, 1873
                        


                        
                           Suppose that 
                           
                              
                                 G
                                 =
                                 (
                                 V
                                 ,
                                 E
                                 )
                              
                            
                           is a connected graph. Then G is an Eulerian graph if and only if every vertex v of G has even degree.
                        

If a graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           )
                        
                      is Eulerian, we use an algorithm due to Edmonds and Johnson (1973) in time 
                        
                           O
                           (
                           m
                           )
                        
                      to determine an Eulerian tour on G. We call such an algorithm the Eulerian-Cycle algorithm.
                        Lemma 2
                        
                           Fleischner, 1991
                        


                        
                           Suppose that 
                           
                              
                                 D
                                 =
                                 (
                                 V
                                 ,
                                 A
                                 )
                              
                            
                           is a strongly connected digraph. Then D is an Eulerian digraph if and only if every vertex v of D has equal in- and out-degrees.
                        

If a digraph 
                        
                           D
                           =
                           (
                           V
                           ,
                           A
                           )
                        
                      is Eulerian, we use another algorithm due to Edmonds and Johnson (1973) in time 
                        
                           O
                           (
                           nm
                           )
                        
                      to determine a directed Eulerian circuit on D. We call such an algorithm the Eulerian-Circuit algorithm.
                        Lemma 3
                        
                           Goldberg and Tarjan, 1989
                        


                        
                           Let 
                           
                              
                                 N
                                 =
                                 (
                                 V
                                 ,
                                 A
                                 ;
                                 l
                                 ,
                                 u
                                 ;
                                 c
                                 )
                              
                            
                           be a network with a demand function 
                           
                              
                                 l
                                 :
                                 A
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       0
                                    
                                    
                                       +
                                    
                                 
                              
                           
                           , a capacity function 
                           
                              
                                 u
                                 :
                                 A
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       +
                                    
                                 
                              
                            
                           and a cost function 
                           
                              
                                 c
                                 :
                                 A
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       +
                                    
                                 
                              
                           
                           . A minimum cost circulation f in N can be determined in time 
                           
                              
                                 O
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       3
                                    
                                 
                                 log
                                 n
                                 )
                              
                           
                           . In addition, if the demand function 
                           
                              
                                 l
                                 (
                                 ·
                                 )
                              
                            
                           and the capacity function 
                           
                              
                                 u
                                 (
                                 ·
                                 )
                              
                            
                           are both integral, then a minimum cost circulation f in N is integral, and it can be determined with the same running time.
                        

We refer a combinatorial algorithm due to Goldberg and Tarjan (1989) to solve the minimum cost circulation problem as the Cycle-Canceling algorithm.
                        Lemma 4
                        
                           Ford and Fulkerson, 1962
                        


                        
                           Suppose that 
                           
                              
                                 N
                                 =
                                 (
                                 V
                                 ,
                                 A
                                 ;
                                 u
                                 ,
                                 c
                                 ;
                                 s
                                 ,
                                 t
                                 )
                              
                            
                           is an instance of the minimum cost flow problem. Let 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                              
                            
                           be a minimum cost 
                           
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                           
                           -flow of value 
                           
                              
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                              
                            
                           in N and 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                              
                            
                           an 
                           
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                           
                           -flow of value 1 along an augmentation 
                           
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                           
                           -path P in 
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            
                           of least cost, where 
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            
                           is the incremental weighted flow network of the flow 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           . Then 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                              
                            
                           is a minimum cost 
                           
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                           
                           -flow of value 
                           
                              
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 1
                              
                            
                           in N. In addition, if the capacity function 
                           
                              
                                 u
                                 (
                                 ·
                                 )
                              
                            
                           is integral and 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                              
                            
                           is a minimum cost integral 
                           
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                           
                           -flow of value 
                           
                              
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                              
                            
                           in N, then 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                              
                            
                           is a minimum cost integral 
                           
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                           
                           -flow of value 
                           
                              
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 1
                              
                            
                           in N.
                        

By Lemma 4 and the Belleman–Ford algorithm (Bellman, 1958) in time 
                        
                           O
                           (
                           nm
                           )
                        
                      to determine an augmentation 
                        
                           (
                           s
                           ,
                           t
                           )
                        
                     -path P in 
                        
                           
                              
                                 N
                              
                              
                                 ′
                              
                           
                           (
                           
                              
                                 f
                              
                              
                                 1
                              
                           
                           )
                        
                      of least cost, we can design an algorithm in time 
                        
                           O
                           (
                           
                              
                                 nmk
                              
                              
                                 1
                              
                           
                           )
                        
                      to determine a minimum cost 
                        
                           (
                           s
                           ,
                           t
                           )
                        
                     -flow of integral value 
                        
                           
                              
                                 k
                              
                              
                                 1
                              
                           
                        
                      in N. We call such an algorithm the Successive-Shortest-Path algorithm.

The Successive-Shortest-Path algorithm is not a polynomial-time algorithm to solve the minimum cost flow problem. The capacity scaling algorithm in Orlin (1988) is a variant of the Successive-Shortest-Path algorithm, and it solves the minimum cost flow problem in time 
                        
                           O
                           (
                           
                              
                                 nm
                              
                              
                                 2
                              
                           
                           log
                           
                              
                                 k
                              
                              
                                 1
                              
                           
                           )
                        
                     . In this paper, we need a more efficient algorithm in Orlin (1993) to solve the integral minimum cost 
                        
                           (
                           s
                           ,
                           t
                           )
                        
                     -flow problem, that is a variant of the capacity scaling algorithm. We call such an algorithm the Enhanced-Capacity-Scaling algorithm.
                        Lemma 5
                        
                           Orlin, 1993
                        


                        
                           The Enhanced
                           -Capacity
                           -Scaling
                           
                           algorithm solves the capacitated minimum cost flow problem in time 
                           
                              
                                 O
                                 (
                                 m
                                 log
                                 nS
                                 (
                                 n
                                 ,
                                 m
                                 )
                                 )
                              
                           
                           , where 
                           
                              
                                 S
                                 (
                                 n
                                 ,
                                 m
                                 )
                              
                            
                           is the time required to solve a shortest path problem with n vertices and m arcs. In addition, if the capacity function 
                           
                              
                                 u
                                 (
                                 ·
                                 )
                              
                            
                           is integral, then a minimum cost integral 
                           
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                           
                           -flow can be determined with the same running time.
                        

The constrained arc routing problem in mixed graphs (CARM) was defined in the introduction section. We first give an integer programming formulation of the CARM problem as follows. Each mixed graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           A
                           ∪
                           E
                           )
                        
                      is associated with a digraph 
                        
                           
                              
                                 G
                              
                              
                                 ↔
                              
                           
                           =
                           (
                           V
                           ,
                           A
                           ∪
                           B
                           )
                        
                      such that 
                        
                           B
                           =
                           
                              
                                 E
                              
                              
                                 +
                              
                           
                           ∪
                           
                              
                                 E
                              
                              
                                 -
                              
                           
                        
                      and each edge 
                        
                           e
                           ∈
                           E
                        
                      is replaced by two arcs 
                        
                           
                              
                                 e
                              
                              
                                 +
                              
                           
                           ∈
                           
                              
                                 E
                              
                              
                                 +
                              
                           
                        
                      and 
                        
                           
                              
                                 e
                              
                              
                                 -
                              
                           
                           ∈
                           
                              
                                 E
                              
                              
                                 -
                              
                           
                        
                      of opposite direction with the same weight 
                        
                           w
                           (
                           
                              
                                 e
                              
                              
                                 +
                              
                           
                           )
                           =
                           w
                           (
                           
                              
                                 e
                              
                              
                                 -
                              
                           
                           )
                           =
                           w
                           (
                           e
                           )
                        
                     . Since G is a connected mixed graph, we can obtain a necessary and sufficient condition for any instance of the CARM problem as follows. A non-negative integral circulation x in 
                        
                           
                              
                                 G
                              
                              
                                 ↔
                              
                           
                        
                      corresponds to an arc routing of G (i.e., a feasible solution to the instance G of the CARM problem) if and only if (1) 
                        
                           l
                           (
                           e
                           )
                           ⩽
                           x
                           (
                           e
                           )
                           ⩽
                           u
                           (
                           e
                           )
                        
                      for each arc 
                        
                           e
                           ∈
                           A
                        
                     , and (2) 
                        
                           l
                           (
                           e
                           )
                           ⩽
                           x
                           (
                           
                              
                                 e
                              
                              
                                 +
                              
                           
                           )
                           +
                           x
                           (
                           
                              
                                 e
                              
                              
                                 -
                              
                           
                           )
                           ⩽
                           u
                           (
                           e
                           )
                        
                      for each edge 
                        
                           e
                           ∈
                           E
                        
                     , where 
                        
                           x
                           (
                           e
                           )
                        
                      is the number of times that the arc 
                        
                           e
                           ∈
                           A
                        
                      is traversed in the arc routing of G and 
                        
                           x
                           (
                           
                              
                                 e
                              
                              
                                 +
                              
                           
                           )
                           +
                           x
                           (
                           
                              
                                 e
                              
                              
                                 -
                              
                           
                           )
                        
                      is the number of times that edge 
                        
                           e
                           ∈
                           E
                        
                      is traversed in the arc routing of G for the CARM problem, respectively.

Thus, we can establish an integer program, denoted by CARM(G), which is equivalent to the CARM problem for the instance 
                        
                           G
                           =
                           (
                           V
                           ,
                           A
                           ∪
                           E
                           ;
                           w
                           ;
                           l
                           ,
                           u
                           )
                        
                     .
                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          CARM
                                          (
                                          G
                                          )
                                          
                                          min
                                       
                                    
                                    
                                       
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   e
                                                   ∈
                                                   A
                                                   ∪
                                                   B
                                                
                                             
                                          
                                          w
                                          (
                                          e
                                          )
                                          x
                                          (
                                          e
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          s.t.
                                       
                                    
                                    
                                       
                                          
                                          
                                             
                                                
                                             
                                          
                                          
                                          for each
                                          
                                          v
                                          ∈
                                          V
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                              l
                              (
                              e
                              )
                              ⩽
                              x
                              (
                              e
                              )
                              ⩽
                              u
                              (
                              e
                              )
                              
                              for each
                              
                              e
                              ∈
                              A
                           
                        
                     
                     
                        
                           (3)
                           
                              
                              l
                              (
                              e
                              )
                              ⩽
                              x
                              (
                              
                                 
                                    e
                                 
                                 
                                    +
                                 
                              
                              )
                              +
                              x
                              (
                              
                                 
                                    e
                                 
                                 
                                    -
                                 
                              
                              )
                              ⩽
                              u
                              (
                              e
                              )
                              
                              for each
                              
                              e
                              ∈
                              E
                           
                        
                     
                     
                        
                           (4)
                           
                              
                              x
                              (
                              e
                              )
                              ⩾
                              0
                              
                              for each
                              
                              e
                              ∈
                              A
                              ∪
                              B
                           
                        
                     
                     
                        
                           (5)
                           
                              
                              x
                              (
                              e
                              )
                              
                              integer
                              
                              for each
                              
                              e
                              ∈
                              A
                              ∪
                              B
                           
                        
                     
                  

Now, we construct a new weighted digraph 
                        
                           
                              
                                 G
                              
                              
                                 ^
                              
                           
                           =
                           (
                           
                              
                                 V
                              
                              
                                 ^
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 ^
                              
                           
                           )
                        
                      from the mixed graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           ∪
                           A
                           ;
                           w
                           ;
                           l
                           ,
                           u
                           )
                        
                      as follows. At the beginning, let 
                        
                           
                              
                                 V
                              
                              
                                 ^
                              
                           
                           ≔
                           V
                        
                      and 
                        
                           
                              
                                 A
                              
                              
                                 ^
                              
                           
                           ≔
                           A
                        
                     . We replace each edge 
                        
                           e
                           =
                           ab
                           ∈
                           E
                        
                     , by a directed subgraph 
                        
                           
                              
                                 D
                              
                              
                                 e
                              
                           
                        
                      consisting of four vertices 
                        
                           a
                           ,
                           b
                           ,
                           
                              
                                 y
                              
                              
                                 e
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 e
                              
                           
                        
                      and five arcs 
                        
                           (
                           a
                           ,
                           
                              
                                 y
                              
                              
                                 e
                              
                           
                           )
                        
                     , 
                        
                           (
                           b
                           ,
                           
                              
                                 y
                              
                              
                                 e
                              
                           
                           )
                           ,
                           (
                           
                              
                                 y
                              
                              
                                 e
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 e
                              
                           
                           )
                           ,
                           (
                           
                              
                                 z
                              
                              
                                 e
                              
                           
                           ,
                           a
                           )
                           ,
                           (
                           
                              
                                 z
                              
                              
                                 e
                              
                           
                           ,
                           b
                           )
                        
                      (see Fig.1
                     ), where we add the two new vertices 
                        
                           
                              
                                 y
                              
                              
                                 e
                              
                           
                        
                      and 
                        
                           
                              
                                 z
                              
                              
                                 e
                              
                           
                        
                      into 
                        
                           
                              
                                 V
                              
                              
                                 ^
                              
                           
                        
                      and the five new arcs into 
                        
                           
                              
                                 A
                              
                              
                                 ^
                              
                           
                        
                     , and we define lower and upper bounds and length weights on these five arcs as follows: 
                        
                           l
                           (
                           a
                           ,
                           
                              
                                 y
                              
                              
                                 e
                              
                           
                           )
                           =
                           l
                           (
                           b
                           ,
                           
                              
                                 y
                              
                              
                                 e
                              
                           
                           )
                           =
                           l
                           (
                           
                              
                                 z
                              
                              
                                 e
                              
                           
                           ,
                           a
                           )
                           =
                           l
                           (
                           
                              
                                 z
                              
                              
                                 e
                              
                           
                           ,
                           b
                           )
                           =
                           0
                           ,
                           l
                           (
                           
                              
                                 y
                              
                              
                                 e
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 e
                              
                           
                           )
                           =
                           l
                           (
                           e
                           )
                        
                     , 
                        
                           u
                           (
                           a
                           ,
                           
                              
                                 y
                              
                              
                                 e
                              
                           
                           )
                           =
                           u
                           (
                           b
                           ,
                           
                              
                                 y
                              
                              
                                 e
                              
                           
                           )
                           =
                           u
                           (
                           
                              
                                 y
                              
                              
                                 e
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 e
                              
                           
                           )
                           =
                           u
                           (
                           
                              
                                 z
                              
                              
                                 e
                              
                           
                           ,
                           a
                           )
                           =
                           u
                           (
                           
                              
                                 z
                              
                              
                                 e
                              
                           
                           ,
                           b
                           )
                           =
                           u
                           (
                           e
                           )
                        
                     , and 
                        
                           w
                           (
                           a
                           ,
                           
                              
                                 y
                              
                              
                                 e
                              
                           
                           )
                           =
                           w
                           (
                           b
                           ,
                           
                              
                                 y
                              
                              
                                 e
                              
                           
                           )
                           =
                           w
                           (
                           
                              
                                 z
                              
                              
                                 e
                              
                           
                           ,
                           a
                           )
                           =
                           w
                           (
                           
                              
                                 z
                              
                              
                                 e
                              
                           
                           ,
                           b
                           )
                           =
                           0
                           ,
                           w
                           (
                           
                              
                                 y
                              
                              
                                 e
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 e
                              
                           
                           )
                           =
                           w
                           (
                           e
                           )
                        
                     . Thus, each arc in 
                        
                           
                              
                                 A
                              
                              
                                 ^
                              
                           
                        
                      of the new weighted digraph 
                        
                           
                              
                                 G
                              
                              
                                 ^
                              
                           
                        
                      belongs to A or to a directed subgraph 
                        
                           
                              
                                 D
                              
                              
                                 e
                              
                           
                        
                      for some 
                        
                           e
                           ∈
                           E
                        
                     , but not both.

For each new arc 
                        
                           e
                           ∈
                           
                              
                                 A
                              
                              
                                 ^
                              
                           
                        
                      of the network 
                        
                           
                              
                                 G
                              
                              
                                 ^
                              
                           
                           =
                           (
                           
                              
                                 V
                              
                              
                                 ^
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 ^
                              
                           
                           ;
                           w
                           ;
                           l
                           ,
                           u
                           )
                        
                     , the values 
                        
                           l
                           (
                           e
                           )
                           ,
                           u
                           (
                           e
                           )
                        
                      and 
                        
                           w
                           (
                           e
                           )
                        
                      may be regarded as demand, capacity and unit cost of e, respectively.
                        Lemma 6
                        
                           Let 
                           
                              
                                 G
                                 =
                                 (
                                 V
                                 ,
                                 E
                                 ∪
                                 A
                                 ;
                                 w
                                 ;
                                 l
                                 ,
                                 u
                                 )
                              
                            
                           be an instance of the CARM problem such that 
                           
                              
                                 l
                                 (
                                 e
                                 )
                                 <
                                 u
                                 (
                                 e
                                 )
                              
                            
                           holds for each edge 
                           
                              
                                 e
                                 ∈
                                 E
                              
                            
                           and 
                           
                              
                                 l
                                 (
                                 e
                                 )
                                 ⩽
                                 u
                                 (
                                 e
                                 )
                              
                            
                           holds for each arc 
                           
                              
                                 e
                                 ∈
                                 A
                              
                           
                           . There exists a feasible tour T in G if and only if there exists an integral circulation f in the network 
                           
                              
                                 
                                    
                                       G
                                    
                                    
                                       ^
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       ^
                                    
                                 
                                 ,
                                 
                                    
                                       A
                                    
                                    
                                       ^
                                    
                                 
                                 ;
                                 w
                                 ;
                                 l
                                 ,
                                 u
                                 )
                              
                           
                           .
                        

A feasible tour T to the instance G of the CARM problem can be transformed into a feasible solution x of the corresponding integer program CARM(G), and vice versa. We only need to prove that there exists a feasible solution x of the integer program CARM(G) if and only if there exists an integral circulation f in the network 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ^
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       ^
                                    
                                 
                                 ,
                                 
                                    
                                       A
                                    
                                    
                                       ^
                                    
                                 
                                 ;
                                 w
                                 ;
                                 l
                                 ,
                                 u
                                 )
                              
                           .

Necessity. Suppose that x is a feasible solution of the integer program CARM(G). We construct an integral circulation f in the network 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ^
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       ^
                                    
                                 
                                 ,
                                 
                                    
                                       A
                                    
                                    
                                       ^
                                    
                                 
                                 ;
                                 w
                                 ;
                                 l
                                 ,
                                 u
                                 )
                              
                            as follows. For each arc 
                              
                                 e
                                 ∈
                                 A
                              
                           , let 
                              
                                 f
                                 (
                                 e
                                 )
                                 =
                                 x
                                 (
                                 e
                                 )
                              
                           . And for each edge 
                              
                                 e
                                 =
                                 ab
                                 ∈
                                 E
                              
                           , without loss of generality, we may assume 
                              
                                 
                                    
                                       e
                                    
                                    
                                       +
                                    
                                 
                                 =
                                 (
                                 a
                                 ,
                                 b
                                 )
                              
                            and 
                              
                                 
                                    
                                       e
                                    
                                    
                                       -
                                    
                                 
                                 =
                                 (
                                 b
                                 ,
                                 a
                                 )
                              
                           , then let 
                              
                                 f
                                 (
                                 a
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 =
                                 f
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 b
                                 )
                                 =
                                 x
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 ,
                                 
                                 f
                                 (
                                 b
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 =
                                 f
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 a
                                 )
                                 =
                                 x
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       -
                                    
                                 
                                 )
                              
                            and 
                              
                                 f
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 =
                                 x
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 +
                                 x
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       -
                                    
                                 
                                 )
                              
                           . It is easy to verify that f is an integral circulation in 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ^
                                    
                                 
                              
                           .

Sufficiency. Suppose that f is an integral circulation in 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ^
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       ^
                                    
                                 
                                 ,
                                 
                                    
                                       A
                                    
                                    
                                       ^
                                    
                                 
                                 ;
                                 w
                                 ;
                                 l
                                 ,
                                 u
                                 )
                              
                           . First, we may construct a new integral circulation 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                              
                            from f in 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ^
                                    
                                 
                              
                            that satisfies further properties.

For each arc 
                              
                                 e
                                 ∈
                                 A
                              
                           , let 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 e
                                 )
                                 =
                                 f
                                 (
                                 e
                                 )
                              
                           . For each edge 
                              
                                 e
                                 =
                                 ab
                                 ∈
                                 E
                              
                           , we examine either the pair 
                              
                                 f
                                 (
                                 a
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                              
                            and 
                              
                                 f
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 b
                                 )
                              
                            or the pair 
                              
                                 f
                                 (
                                 b
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                              
                            and 
                              
                                 f
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 a
                                 )
                              
                           . If 
                              
                                 f
                                 (
                                 a
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 =
                                 f
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 b
                                 )
                              
                            (implying 
                              
                                 f
                                 (
                                 b
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 =
                                 f
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 a
                                 )
                              
                           ), let 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 f
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                            for each arc 
                              
                                 
                                    
                                       e
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 {
                                 (
                                 a
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 ,
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 b
                                 )
                                 ,
                                 (
                                 b
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 ,
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 a
                                 )
                                 ,
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 }
                              
                           . If 
                              
                                 f
                                 (
                                 a
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 
                                 ≠
                                 
                                 f
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 b
                                 )
                              
                           , we may assume 
                              
                                 f
                                 (
                                 a
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 >
                                 f
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 b
                                 )
                              
                           , then we denote 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                f
                                                (
                                                a
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      e
                                                   
                                                
                                                )
                                                -
                                                f
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      e
                                                   
                                                
                                                ,
                                                b
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                f
                                                (
                                                a
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      e
                                                   
                                                
                                                )
                                                -
                                                f
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      e
                                                   
                                                
                                                ,
                                                b
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           . We consider two possibilities.

(1) If 
                              
                                 f
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 =
                                 l
                                 (
                                 e
                                 )
                              
                           , let 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 a
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 =
                                 f
                                 (
                                 a
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                              
                           , 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 b
                                 )
                                 =
                                 f
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 b
                                 )
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                              
                           , 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 b
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 =
                                 f
                                 (
                                 b
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                              
                           , 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 a
                                 )
                                 =
                                 f
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 a
                                 )
                                 -
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 =
                                 f
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                              
                           . It follows that
                              
                                 
                                    l
                                    (
                                    e
                                    )
                                    =
                                    f
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          e
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          e
                                       
                                    
                                    )
                                    ⩽
                                    
                                       
                                          f
                                       
                                       
                                          ̃
                                       
                                    
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          e
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          e
                                       
                                    
                                    )
                                    ⩽
                                    f
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          e
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          e
                                       
                                    
                                    )
                                    +
                                    1
                                    =
                                    l
                                    (
                                    e
                                    )
                                    +
                                    1
                                    ⩽
                                    u
                                    (
                                    e
                                    )
                                 
                              
                           
                        

(2) If 
                              
                                 f
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 >
                                 l
                                 (
                                 e
                                 )
                              
                           , let 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 a
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 =
                                 f
                                 (
                                 a
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                              
                           , 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 b
                                 )
                                 =
                                 f
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 b
                                 )
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                              
                           , 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 b
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 =
                                 f
                                 (
                                 b
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                              
                           , 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 a
                                 )
                                 =
                                 f
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 a
                                 )
                                 -
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 =
                                 f
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                              
                           . It follows that
                              
                                 
                                    l
                                    (
                                    e
                                    )
                                    ⩽
                                    f
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          e
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          e
                                       
                                    
                                    )
                                    -
                                    1
                                    ⩽
                                    
                                       
                                          f
                                       
                                       
                                          ̃
                                       
                                    
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          e
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          e
                                       
                                    
                                    )
                                    ⩽
                                    f
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          e
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          e
                                       
                                    
                                    )
                                    ⩽
                                    u
                                    (
                                    e
                                    )
                                 
                              
                           
                        

It is easy to verify that 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                              
                            is also an integral circulation in 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ^
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 a
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 b
                                 )
                              
                            for each edge 
                              
                                 e
                                 =
                                 ab
                                 ∈
                                 E
                              
                           .

Now, we can construct a feasible solution x to the integer program CARM(G) as follows. For each arc 
                              
                                 e
                                 ∈
                                 A
                              
                           , let 
                              
                                 x
                                 (
                                 e
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 e
                                 )
                              
                           . For each edge 
                              
                                 e
                                 =
                                 ab
                                 ∈
                                 E
                              
                           , without loss of generality, we may assume 
                              
                                 
                                    
                                       e
                                    
                                    
                                       +
                                    
                                 
                                 =
                                 (
                                 a
                                 ,
                                 b
                                 )
                              
                            and 
                              
                                 
                                    
                                       e
                                    
                                    
                                       -
                                    
                                 
                                 =
                                 (
                                 b
                                 ,
                                 a
                                 )
                              
                           , then we let 
                              
                                 x
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 a
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                              
                            and 
                              
                                 x
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       -
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 b
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 )
                              
                           . Since 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                              
                            is an integral circulation in 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ^
                                    
                                 
                              
                           , it is easy to see that the constraint condition (1) in the integer program CARM(G) holds. The constraint condition (2) holds obviously. For each edge 
                              
                                 e
                                 ∈
                                 E
                              
                           , the constraint condition (3) also holds since 
                              
                                 l
                                 (
                                 e
                                 )
                                 ⩽
                                 x
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 +
                                 x
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       -
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 ⩽
                                 u
                                 (
                                 e
                                 )
                              
                           . The constraint conditions (4) and (5) clearly hold. Thus, x is a feasible solution of the integer program CARM(G).□


                     Edmonds and Karp (1972) designed an algorithm to solve the minimum cost circulation problem, but their algorithm is based on a capacity scaling method and it can be implemented to run in time 
                        
                           O
                           (
                           m
                           (
                           m
                           +
                           n
                           log
                           n
                           )
                           log
                           U
                           )
                        
                     , where 
                        
                           U
                           =
                           max
                           {
                           u
                           (
                           e
                           )
                           |
                           e
                           ∈
                           A
                           }
                        
                     . Tardos (1985) was the first to design a strongly polynomial-time algorithm to solve the minimum cost circulation problem. In this paper, we invoke a simpler and more efficient combinatorial algorithm due to Goldberg and Tarjan (1989) to solve the minimum cost circulation problem. It is stated in Lemma 3 and referred to as the Cycle-Canceling algorithm.

Using Lemmas 3 and 6, we can design an approximation algorithm to solve the CARM problem as follows.
                        Algorithm 1
                        CARM 
                              
                                 
                                    
                                    
                                       
                                          Input: A connected mixed graph 
                                                
                                                   G
                                                   =
                                                   (
                                                   V
                                                   ,
                                                   E
                                                   ∪
                                                   A
                                                   ;
                                                   w
                                                   ;
                                                   l
                                                   ,
                                                   u
                                                   )
                                                
                                              with a length function 
                                                
                                                   w
                                                   :
                                                   E
                                                   ∪
                                                   A
                                                   →
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                
                                              and two integer functions 
                                                
                                                   l
                                                   ,
                                                   u
                                                   :
                                                   E
                                                   ∪
                                                   A
                                                   →
                                                   
                                                      
                                                         Z
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                
                                              satisfying 
                                                
                                                   l
                                                   (
                                                   e
                                                   )
                                                   ⩽
                                                   u
                                                   (
                                                   e
                                                   )
                                                
                                              for each 
                                                
                                                   e
                                                   ∈
                                                   E
                                                   ∪
                                                   A
                                                
                                             .
                                       
                                       
                                          Output: A constrained arc routing T and its total length.
                                       
                                       
                                          Begin
                                       
                                       
                                          Step 1 Construct a new weighted digraph 
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                   =
                                                   (
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                   )
                                                
                                              from the mixed graph 
                                                
                                                   G
                                                   =
                                                   (
                                                   V
                                                   ,
                                                   E
                                                   ∪
                                                   A
                                                   ;
                                                   w
                                                   ;
                                                   l
                                                   ,
                                                   u
                                                   )
                                                
                                              as above.
                                       
                                       
                                          Step 2 Using the Cycle-Cancelling algorithm in Goldberg and Tarjan (1989), determine a minimum cost integral circulation f in 
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                             . If no such circulation exists, then output “no feasible solution to this instance of the CARM problem”, and stop.
                                       
                                       
                                          Step 3 Construct a new integral circulation 
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                              in 
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                              associated with the integral circulation f as follows
                                       
                                       
                                          
                                             (1)For each arc 
                                                
                                                   e
                                                   ∈
                                                   A
                                                
                                             , let 
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   e
                                                   )
                                                   =
                                                   f
                                                   (
                                                   e
                                                   )
                                                
                                             .
                                       
                                       
                                          
                                             (2)For each edge 
                                                
                                                   e
                                                   =
                                                   ab
                                                   ∈
                                                   E
                                                
                                             , let 
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   )
                                                   =
                                                   f
                                                   (
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   )
                                                   -
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             , where 
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  |
                                                                  f
                                                                  (
                                                                  a
                                                                  ,
                                                                  
                                                                     
                                                                        y
                                                                     
                                                                     
                                                                        e
                                                                     
                                                                  
                                                                  )
                                                                  -
                                                                  f
                                                                  (
                                                                  
                                                                     
                                                                        y
                                                                     
                                                                     
                                                                        e
                                                                     
                                                                  
                                                                  ,
                                                                  b
                                                                  )
                                                                  |
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                              and 
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  |
                                                                  f
                                                                  (
                                                                  a
                                                                  ,
                                                                  
                                                                     
                                                                        y
                                                                     
                                                                     
                                                                        e
                                                                     
                                                                  
                                                                  )
                                                                  -
                                                                  f
                                                                  (
                                                                  
                                                                     
                                                                        y
                                                                     
                                                                     
                                                                        e
                                                                     
                                                                  
                                                                  ,
                                                                  b
                                                                  )
                                                                  |
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             ; and
                                       
                                       
                                          
                                             
                                             if (
                                                
                                                   f
                                                   (
                                                   a
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   )
                                                   >
                                                   f
                                                   (
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   ,
                                                   b
                                                   )
                                                
                                             ) then
                                       
                                       
                                          
                                             
                                             
                                             denote 
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   a
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   )
                                                   =
                                                   f
                                                   (
                                                   a
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   )
                                                   -
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   ,
                                                   b
                                                   )
                                                   =
                                                   f
                                                   (
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   ,
                                                   b
                                                   )
                                                   +
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             ,
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   b
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   )
                                                   =
                                                   f
                                                   (
                                                   b
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   )
                                                   +
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                              and 
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   ,
                                                   a
                                                   )
                                                   =
                                                   f
                                                   (
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   ,
                                                   a
                                                   )
                                                   -
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          
                                             
                                             else
                                       
                                       
                                          
                                             
                                             denote 
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   a
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   )
                                                   =
                                                   f
                                                   (
                                                   a
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   )
                                                   +
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   ,
                                                   b
                                                   )
                                                   =
                                                   f
                                                   (
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   ,
                                                   b
                                                   )
                                                   -
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             ,
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   b
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   )
                                                   =
                                                   f
                                                   (
                                                   b
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   )
                                                   -
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                              and 
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   ,
                                                   a
                                                   )
                                                   =
                                                   f
                                                   (
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   ,
                                                   a
                                                   )
                                                   +
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          Step 4 Construct a feasible solution x to the integer program CARM(G) as follows
                                       
                                       
                                          
                                             (1)For each arc 
                                                
                                                   e
                                                   ∈
                                                   A
                                                
                                             , let 
                                                
                                                   x
                                                   (
                                                   e
                                                   )
                                                   =
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   e
                                                   )
                                                
                                             .
                                       
                                       
                                          
                                             (2)For each edge 
                                                
                                                   e
                                                   =
                                                   ab
                                                   ∈
                                                   E
                                                
                                             , do
                                       
                                       
                                          
                                             
                                             if (
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   =
                                                   (
                                                   a
                                                   ,
                                                   b
                                                   )
                                                
                                              and 
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                   =
                                                   (
                                                   b
                                                   ,
                                                   a
                                                   )
                                                
                                             ) then
                                       
                                       
                                          
                                             
                                             
                                             denote 
                                                
                                                   x
                                                   (
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   )
                                                   =
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   a
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   )
                                                
                                              and 
                                                
                                                   x
                                                   (
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                   )
                                                   =
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   b
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   )
                                                
                                             .
                                       
                                       
                                          
                                             
                                             else
                                       
                                       
                                          
                                             
                                             
                                             denote 
                                                
                                                   x
                                                   (
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                   )
                                                   =
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   a
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   )
                                                
                                              and 
                                                
                                                   x
                                                   (
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   )
                                                   =
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   b
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   )
                                                
                                             .
                                       
                                       
                                          Step 5 Construct a digraph 
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         D
                                                      
                                                   
                                                   =
                                                   (
                                                   V
                                                   ,
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                   )
                                                
                                              so that there are 
                                                
                                                   x
                                                   (
                                                   e
                                                   )
                                                
                                              multi-arcs from the vertex a to the vertex b in 
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         D
                                                      
                                                   
                                                
                                              for each arc 
                                                
                                                   e
                                                   =
                                                   (
                                                   a
                                                   ,
                                                   b
                                                   )
                                                
                                              in 
                                                
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            ↔
                                                         
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          Step 6 Using the Eulerian-Circuit algorithm in Edmonds and Johnson (1973), find a directed Eulerian tour 
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         D
                                                      
                                                   
                                                
                                              on 
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         D
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          Step 7 For each arc e in 
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         D
                                                      
                                                   
                                                
                                             , remove its direction only if 
                                                
                                                   e
                                                   
                                                   ∉
                                                   
                                                   A
                                                
                                             , and then construct a (mixed) tour T in G.
                                       
                                       
                                          Step 8 Output the tour T and the value 
                                                
                                                   w
                                                   (
                                                   T
                                                   )
                                                   =
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         e
                                                         ∈
                                                         A
                                                         ∪
                                                         B
                                                      
                                                   
                                                   w
                                                   (
                                                   e
                                                   )
                                                   x
                                                   (
                                                   e
                                                   )
                                                
                                             .
                                       
                                       
                                          End
                                       
                                    
                                 
                              
                           
                        

For an instance 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           ∪
                           A
                           ;
                           w
                           ;
                           l
                           ,
                           u
                           )
                        
                      of the CARM problem, let OPT denote the optimal value and OUT the output value of the algorithm CARM, respectively.
                        Theorem 1
                        
                           For any instance 
                           
                              
                                 G
                                 =
                                 (
                                 V
                                 ,
                                 E
                                 ∪
                                 A
                                 ;
                                 w
                                 ;
                                 l
                                 ,
                                 u
                                 )
                              
                            
                           of the CARM problem, if 
                           
                              
                                 l
                                 (
                                 e
                                 )
                                 <
                                 u
                                 (
                                 e
                                 )
                              
                            
                           holds for each edge 
                           
                              
                                 e
                                 ∈
                                 E
                              
                            
                           and 
                           
                              
                                 l
                                 (
                                 e
                                 )
                                 ⩽
                                 u
                                 (
                                 e
                                 )
                              
                            
                           holds for each arc 
                           
                              
                                 e
                                 ∈
                                 A
                              
                           
                           , then the algorithm CARM can produce a feasible arc routing to satisfy 
                           
                              
                                 OUT
                                 ⩽
                                 (
                                 1
                                 +
                                 1
                                 /
                                 
                                    
                                       l
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ·
                                 OPT
                              
                           
                           , where 
                           
                              
                                 
                                    
                                       l
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 min
                                 {
                                 l
                                 (
                                 e
                                 )
                                 |
                                 e
                                 ∈
                                 E
                                 }
                              
                           
                           , and the running time of the algorithm CARM is 
                           
                              
                                 O
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       3
                                    
                                 
                                 log
                                 n
                                 )
                              
                           
                           .
                        

We first obtain a minimum cost integral circulation f in 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ^
                                    
                                 
                              
                            by executing the Cycle-Canceling algorithm (Goldberg & Tarjan, 1989) on the weighted digraph 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ^
                                    
                                 
                              
                           . From the proof of Lemma 6, we know that 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                              
                            constructed at Step 3 is an integral circulation in 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ^
                                    
                                 
                              
                            and x constructed at Step 4 is a feasible solution to the integer program CARM(G). By the definitions of x and the digraph 
                              
                                 
                                    
                                       G
                                    
                                    
                                       D
                                    
                                 
                              
                           , we obtain 
                              
                                 w
                                 (
                                 T
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       e
                                       ∈
                                       A
                                       ∪
                                       B
                                    
                                 
                                 w
                                 (
                                 e
                                 )
                                 x
                                 (
                                 e
                                 )
                                 =
                                 w
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 )
                              
                           .

Since an optimal solution for the instance G of the CARM problem must correspond to an integral circulation in 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ^
                                    
                                 
                              
                           , then Step 2 works correctly. Because f is a minimum cost integral circulation in the weighted digraph 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ^
                                    
                                 
                              
                           , we have
                              
                                 
                                    w
                                    (
                                    f
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             e
                                             ∈
                                             
                                                
                                                   A
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                       
                                    
                                    w
                                    (
                                    e
                                    )
                                    f
                                    (
                                    e
                                    )
                                    ⩽
                                    OPT
                                    .
                                 
                              
                           
                        

On the other hand, by Step 3 of the algorithm CARM, we have the facts 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 e
                                 )
                                 =
                                 f
                                 (
                                 e
                                 )
                              
                            for each arc 
                              
                                 e
                                 ∈
                                 A
                              
                            and the inequalities 
                              
                                 f
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 ⩽
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 =
                                 f
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 ⩽
                                 f
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 +
                                 1
                              
                            for each edge 
                              
                                 e
                                 =
                                 uv
                                 ∈
                                 E
                              
                           . Thus, we can obtain
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                w
                                                (
                                                T
                                                )
                                                =
                                                w
                                                (
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                                )
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         e
                                                         ∈
                                                         A
                                                      
                                                   
                                                
                                                w
                                                (
                                                e
                                                )
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                                (
                                                e
                                                )
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         e
                                                         ∈
                                                         E
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         ∈
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               e
                                                            
                                                         
                                                      
                                                   
                                                
                                                w
                                                (
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                                (
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         e
                                                         ∈
                                                         A
                                                      
                                                   
                                                
                                                w
                                                (
                                                e
                                                )
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                                (
                                                e
                                                )
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         e
                                                         ∈
                                                         E
                                                      
                                                   
                                                
                                                w
                                                (
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      e
                                                   
                                                
                                                ,
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      e
                                                   
                                                
                                                )
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                                (
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      e
                                                   
                                                
                                                ,
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      e
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                ⩽
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         e
                                                         ∈
                                                         A
                                                      
                                                   
                                                
                                                w
                                                (
                                                e
                                                )
                                                f
                                                (
                                                e
                                                )
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         e
                                                         ∈
                                                         E
                                                      
                                                   
                                                
                                                w
                                                (
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      e
                                                   
                                                
                                                ,
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      e
                                                   
                                                
                                                )
                                                (
                                                f
                                                (
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      e
                                                   
                                                
                                                ,
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      e
                                                   
                                                
                                                )
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         e
                                                         ∈
                                                         A
                                                      
                                                   
                                                
                                                w
                                                (
                                                e
                                                )
                                                f
                                                (
                                                e
                                                )
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         e
                                                         ∈
                                                         E
                                                      
                                                   
                                                
                                                w
                                                (
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      e
                                                   
                                                
                                                ,
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      e
                                                   
                                                
                                                )
                                                f
                                                (
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      e
                                                   
                                                
                                                ,
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      e
                                                   
                                                
                                                )
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         e
                                                         ∈
                                                         E
                                                      
                                                   
                                                
                                                w
                                                (
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      e
                                                   
                                                
                                                ,
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      e
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         e
                                                         ∈
                                                         A
                                                      
                                                   
                                                
                                                w
                                                (
                                                e
                                                )
                                                f
                                                (
                                                e
                                                )
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         e
                                                         ∈
                                                         E
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         ∈
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               e
                                                            
                                                         
                                                      
                                                   
                                                
                                                w
                                                (
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                f
                                                (
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         e
                                                         ∈
                                                         E
                                                      
                                                   
                                                
                                                w
                                                (
                                                e
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                =
                                                w
                                                (
                                                f
                                                )
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         e
                                                         ∈
                                                         E
                                                      
                                                   
                                                
                                                w
                                                (
                                                e
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                ⩽
                                                w
                                                (
                                                f
                                                )
                                                +
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         e
                                                         ∈
                                                         E
                                                      
                                                   
                                                
                                                w
                                                (
                                                e
                                                )
                                                l
                                                (
                                                e
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                ⩽
                                                OPT
                                                +
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                ·
                                                OPT
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                =
                                                
                                                   
                                                      
                                                         1
                                                         +
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ·
                                                OPT
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       l
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 min
                                 {
                                 l
                                 (
                                 e
                                 )
                                 |
                                 e
                                 ∈
                                 E
                                 }
                              
                           .

It is obvious to see that the running time of the algorithm CARM heavily depends on the running time of the Cycle-Canceling algorithm (Goldberg & Tarjan, 1989). According to Lemma 3, we know that the running time of the algorithm CARM is 
                              
                                 O
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       3
                                    
                                 
                                 log
                                 n
                                 )
                              
                           .

This establishes the theorem.□

The following special version of the CARM problem can be derived from the proof of Theorem 1.
                        Corollary 1
                        
                           Given a digraph 
                           
                              
                                 D
                                 =
                                 (
                                 V
                                 ,
                                 A
                                 ;
                                 w
                                 ;
                                 l
                                 ,
                                 u
                                 )
                              
                            
                           with two integer functions 
                           
                              
                                 l
                                 ,
                                 u
                                 :
                                 A
                                 →
                                 
                                    
                                       Z
                                    
                                    
                                       +
                                    
                                 
                              
                            
                           satisfying 
                           
                              
                                 l
                                 (
                                 e
                                 )
                                 ⩽
                                 u
                                 (
                                 e
                                 )
                              
                            
                           for each arc 
                           
                              
                                 e
                                 ∈
                                 A
                              
                            
                           and a length function 
                           
                              
                                 w
                                 :
                                 A
                                 →
                                 
                                    
                                       Q
                                    
                                    
                                       +
                                    
                                 
                              
                           
                           , the algorithm CARM produces an optimal arc routing for D and its running time is 
                           
                              
                                 O
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       3
                                    
                                 
                                 log
                                 n
                                 )
                              
                           
                           .
                        

It is well known that Raghavachari and Veerasamy (1999) designed a 3/2-approximation algorithm to solve the mixed Chinese postman problem. We propose a conjecture for the CARM problem to conclude this section.
                        Conjecture 1
                        
                           It would admit a 3/2-approximation algorithm to solve the CARM problem.
                        

In this section, we consider the constrained edge routing problem in graphs (CERG), i.e., a special version of the constrained arc routing problem in mixed graphs (CARM) for the case 
                        
                           A
                           =
                           ∅
                        
                     . The CERG problem is a generalization of the Chinese postman problem (CPP).

It is known that the CPP is solvable in polynomial time by the following strategy.
                        
                           (1)
                           When a graph G is Eulerian, the Eulerian-Cycle algorithm due to Edmonds and Johnson in Edmonds and Johnson (1973) produces an Eulerian tour as an optimal solution.

When a graph G is not Eulerian, we must add some edges from G to create a new Eulerian graph 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . The edges added to create 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ′
                                       
                                    
                                 
                               must be of least total length, and an Eulerian tour in the augmented graph 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ′
                                       
                                    
                                 
                               is an optimal solution. As shown in Edmonds and Johnson (1973), these edges of least total length can be determined by solving a minimum cost perfect matching problem on the complete graph H whose vertices are the odd-degree vertices of G.

It is known that each edge in a graph G is used at most twice in any optimal solution for the CPP. A similar argument can establish the following.
                        Lemma 7
                        
                           For any graph 
                           
                              
                                 G
                                 =
                                 (
                                 V
                                 ,
                                 E
                                 ;
                                 w
                                 ;
                                 l
                                 ,
                                 u
                                 )
                              
                            
                           as an instance of the CERG problem, each edge e in G is used at most 
                           
                              
                                 l
                                 (
                                 e
                                 )
                                 +
                                 1
                              
                            
                           times in any optimal solution.
                        

For convenience, we may assume 
                        
                           u
                           (
                           e
                           )
                           =
                           l
                           (
                           e
                           )
                           +
                           1
                        
                      when 
                        
                           l
                           (
                           e
                           )
                           <
                           u
                           (
                           e
                           )
                        
                      for each edge 
                        
                           e
                           ∈
                           E
                        
                      of any instance 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           ;
                           w
                           ;
                           l
                           ,
                           u
                           )
                        
                      for the CERG problem.

In order to describe our combinatorial algorithm to optimally solve the CERG problem, we need two auxiliary constructions. We construct a multigraph 
                        
                           
                              
                                 G
                              
                              
                                 l
                              
                           
                           =
                           (
                           V
                           ,
                           
                              
                                 E
                              
                              
                                 l
                              
                           
                           )
                        
                     , where the multiset 
                        
                           
                              
                                 E
                              
                              
                                 l
                              
                           
                        
                      contains each edge e of E exactly 
                        
                           l
                           (
                           e
                           )
                        
                      times. Let 
                        
                           
                              
                                 E
                              
                              
                                 u
                              
                           
                           =
                           {
                           e
                           ∈
                           E
                           |
                           l
                           (
                           e
                           )
                           <
                           u
                           (
                           e
                           )
                           }
                        
                     . Then we construct a weighted graph 
                        
                           
                              
                                 G
                              
                              
                                 u
                              
                           
                           =
                           (
                           V
                           ,
                           
                              
                                 E
                              
                              
                                 u
                              
                           
                           ;
                           
                              
                                 w
                              
                              
                                 u
                              
                           
                           )
                        
                     , where the length function 
                        
                           
                              
                                 w
                              
                              
                                 u
                              
                           
                           :
                           
                              
                                 E
                              
                              
                                 u
                              
                           
                           →
                           
                              
                                 Q
                              
                              
                                 +
                              
                           
                        
                      satisfies 
                        
                           
                              
                                 w
                              
                              
                                 u
                              
                           
                           (
                           e
                           )
                           =
                           w
                           (
                           e
                           )
                        
                      for each edge 
                        
                           e
                           ∈
                           
                              
                                 E
                              
                              
                                 u
                              
                           
                        
                     .

By Lemma 7, we can design a combinatorial algorithm to solve the CERG problem by the following strategy.
                        
                           (1)
                           If needed, find a subset 
                                 
                                    
                                       
                                          E
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                 
                               of 
                                 
                                    
                                       
                                          E
                                       
                                       
                                          u
                                       
                                    
                                 
                               such that the augmented multigraph 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    (
                                    V
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          l
                                       
                                    
                                    ∪
                                    
                                       
                                          E
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               is an Eulerian graph, having the minimum total length 
                                 
                                    w
                                    (
                                    
                                       
                                          E
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                          ∈
                                          
                                             
                                                E
                                             
                                             
                                                u
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    w
                                    (
                                    e
                                    )
                                 
                              .

Construct an Eulerian tour on 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . We may call the set 
                                 
                                    
                                       
                                          E
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                 
                               as in Guan (1960) a priority set to the instance 
                                 
                                    G
                                    =
                                    (
                                    V
                                    ,
                                    E
                                    ;
                                    w
                                    ;
                                    l
                                    ,
                                    u
                                    )
                                 
                               of the CERG problem, or simply a priority set.

In our algorithm to solve the CERG problem, we need an algorithm due to Floyd (1962) in running time 
                        
                           O
                           (
                           
                              
                                 n
                              
                              
                                 3
                              
                           
                           )
                        
                      to find all shortest paths among all odd-degree vertices and another algorithm due to Edmonds (1965) in running time 
                        
                           O
                           (
                           
                              
                                 n
                              
                              
                                 3
                              
                           
                           )
                        
                      to find a minimum cost perfect matching in an appropriate graph. We refer these two algorithms the Floyd algorithm (Floyd, 1962) and the Edmonds algorithm (Edmonds, 1965), respectively.

An algorithm to solve the CERG problem is designed as follows.
                        Algorithm 2
                        CERG 
                              
                                 
                                    
                                    
                                       
                                          Input: A connected graph 
                                                
                                                   G
                                                   =
                                                   (
                                                   V
                                                   ,
                                                   E
                                                   ;
                                                   w
                                                   ;
                                                   l
                                                   ,
                                                   u
                                                   )
                                                
                                              with a length function 
                                                
                                                   w
                                                   :
                                                   E
                                                   →
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                
                                              and two integer functions 
                                                
                                                   l
                                                   ,
                                                   u
                                                   :
                                                   E
                                                   →
                                                   
                                                      
                                                         Z
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                
                                              satisfying 
                                                
                                                   l
                                                   (
                                                   e
                                                   )
                                                   ⩽
                                                   u
                                                   (
                                                   e
                                                   )
                                                
                                              for each 
                                                
                                                   e
                                                   ∈
                                                   E
                                                
                                             .
                                       
                                       
                                          Output: A minimum length edge routing T on G to satisfy the constraint.
                                       
                                       
                                          Begin
                                       
                                       
                                          Step 1 Define 
                                                
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                
                                              to be a multiset consisting of each edge e of E exactly 
                                                
                                                   l
                                                   (
                                                   e
                                                   )
                                                
                                              times. And construct the multigraph 
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   =
                                                   (
                                                   V
                                                   ,
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   )
                                                
                                             .
                                       
                                       
                                          Step 2 If (the connected multigraph 
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                
                                              is Eularian) then
                                       
                                       
                                          
                                             Determine an Eulerian tour T on 
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                
                                              by means of the Eulerian-Cycle algorithm (Edmonds and Johnson, 1973), and stop. The tour T corresponds to an optimal solution on G.
                                       
                                       
                                          Step 3 Construct a graph 
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   =
                                                   (
                                                   V
                                                   ,
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ;
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   )
                                                
                                             , where 
                                                
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   =
                                                   {
                                                   e
                                                   ∈
                                                   E
                                                
                                              
                                             
                                                
                                                   |
                                                
                                              
                                             
                                                
                                                   l
                                                   (
                                                   e
                                                   )
                                                   <
                                                   u
                                                   (
                                                   e
                                                   )
                                                   }
                                                
                                              and 
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   :
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   →
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                
                                              satisfies 
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   (
                                                   e
                                                   )
                                                   =
                                                   w
                                                   (
                                                   e
                                                   )
                                                
                                              for each edge 
                                                
                                                   e
                                                   ∈
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          Step 4 Determine the set 
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                
                                              of odd-degree vertices in 
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                
                                             . Construct a graph 
                                                
                                                   H
                                                   =
                                                   (
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         H
                                                      
                                                   
                                                   ;
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         H
                                                      
                                                   
                                                   )
                                                
                                              with vertex set 
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                
                                              and edge set 
                                                
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         H
                                                      
                                                   
                                                
                                             , where an edge 
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         H
                                                      
                                                   
                                                
                                              if and only if there exists a path in 
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                              to connect the two odd-degree vertices 
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                              and 
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             , and then define the cost 
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         H
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                
                                              of edge 
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                              in H to be the length of a shortest path 
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                              between 
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                              and 
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                              in 
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          Step 5 If (there exists no perfect matching of cardinality 
                                                
                                                   |
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                   |
                                                   /
                                                   2
                                                
                                              in H) then
                                       
                                       
                                          
                                             Output “no feasible solution on G”, and stop.
                                       
                                       
                                          Step 6 Use the Edmonds algorithm (Edmonds, 1965) to find a minimum cost perfect matching M of cardinality 
                                                
                                                   |
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                   |
                                                   /
                                                   2
                                                
                                              in H.
                                       
                                       
                                          Step 7 Set 
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ≔
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                
                                             . For each edge 
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                              in the minimum cost perfect matching M, add to 
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                              all edges that lie on the shortest path 
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                              between 
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                              and 
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                              in 
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          Step 8 Determine an Eulerian tour T on 
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                              by means of the Eulerian-Cycle algorithm (Edmonds and Johnson, 1973), and stop. The tour T corresponds to an optimal solution on G.
                                       
                                       
                                          End
                                       
                                    
                                 
                              
                           
                        

Using the algorithm CERG, we obtain the following result for the CERG problem.
                        Theorem 2
                        
                           The algorithm CERG works correctly to solve the CERG problem and its running time is 
                           
                              
                                 O
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                           
                           .
                        

We first prove that the algorithm CERG produces a feasible solution to the instance 
                              
                                 G
                                 =
                                 (
                                 V
                                 ,
                                 E
                                 ;
                                 w
                                 ;
                                 l
                                 ,
                                 u
                                 )
                              
                            of the CERG problem. Any two shortest paths produced at Step 4 corresponding to two distinct edges in the minimum cost perfect matching M must be edge-disjoint, for otherwise another perfect matching 
                              
                                 
                                    
                                       M
                                    
                                    
                                       ′
                                    
                                 
                              
                            in H can be constructed satisfying 
                              
                                 
                                    
                                       w
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 <
                                 
                                    
                                       w
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 M
                                 )
                              
                           , a contradiction (the proof in details is similar to that in Edmonds (1965), we omit it here). Then we add to the augmented graph 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                              
                            all edges that lie on the shortest paths 
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                            between 
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       v
                                    
                                    
                                       j
                                    
                                 
                              
                            in 
                              
                                 
                                    
                                       G
                                    
                                    
                                       u
                                    
                                 
                              
                           , where 
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       j
                                    
                                 
                              
                            corresponds to a matching edge in M. Thus, 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                              
                            becomes an Eulerian graph and the Eulerian tour T on 
                              
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                              
                            produced at Step 8 is a feasible solution to the instance 
                              
                                 G
                                 =
                                 (
                                 V
                                 ,
                                 E
                                 ;
                                 w
                                 ;
                                 l
                                 ,
                                 u
                                 )
                              
                           .

Next, we prove that the Eulerian tour T produced at Step 8 is a minimum total length solution to the instance 
                              
                                 G
                                 =
                                 (
                                 V
                                 ,
                                 E
                                 ;
                                 w
                                 ;
                                 l
                                 ,
                                 u
                                 )
                              
                            of the CERG problem. We may assume that 
                              
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 (
                                 V
                                 ,
                                 
                                    
                                       E
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                              
                            is an optimal tour to G. We shall prove 
                              
                                 w
                                 (
                                 T
                                 )
                                 ⩽
                                 w
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                              
                           , equivalently, 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       M
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       e
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   v
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                                 w
                                 (
                                 e
                                 )
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 M
                                 )
                                 ⩽
                                 w
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                                 -
                                 
                                    
                                       E
                                    
                                    
                                       l
                                    
                                 
                                 )
                              
                           .

We may assume that the multigraph 
                              
                                 
                                    
                                       G
                                    
                                    
                                       l
                                    
                                 
                                 =
                                 (
                                 V
                                 ,
                                 
                                    
                                       E
                                    
                                    
                                       l
                                    
                                 
                                 )
                              
                            contains exactly 
                              
                                 2
                                 k
                              
                            vertices of odd degree, namely 
                              
                                 
                                    
                                       v
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           , 
                              
                                 
                                    
                                       v
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             2
                                             k
                                             -
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             2
                                             k
                                          
                                       
                                    
                                 
                              
                           , and the vertex set 
                              
                                 
                                    
                                       V
                                    
                                    
                                       o
                                    
                                 
                              
                            of the graph H at Step 4 consists of precisely these 
                              
                                 2
                                 k
                              
                            vertices, hence 
                              
                                 2
                                 k
                                 =
                                 |
                                 
                                    
                                       V
                                    
                                    
                                       o
                                    
                                 
                                 |
                              
                           . We consider the reduced graph 
                              
                                 
                                    
                                       H
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                                 -
                                 
                                    
                                       E
                                    
                                    
                                       l
                                    
                                 
                              
                           , where each vertex of odd degree in 
                              
                                 
                                    
                                       H
                                    
                                    
                                       ′
                                    
                                 
                              
                            is also a vertex in 
                              
                                 
                                    
                                       V
                                    
                                    
                                       o
                                    
                                 
                              
                           .

Since 
                              
                                 
                                    
                                       E
                                    
                                    
                                       l
                                    
                                 
                                 ⊆
                                 
                                    
                                       E
                                    
                                    
                                       ∗
                                    
                                 
                                 ⊆
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       l
                                    
                                 
                                 ∪
                                 
                                    
                                       E
                                    
                                    
                                       u
                                    
                                 
                                 )
                              
                            and 
                              
                                 
                                    
                                       ⋃
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       M
                                    
                                 
                                 E
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 )
                                 ⊆
                                 
                                    
                                       E
                                    
                                    
                                       u
                                    
                                 
                              
                           , the graph 
                              
                                 
                                    
                                       H
                                    
                                    
                                       ′
                                    
                                 
                              
                            contains no cycle. To the contrary, we may suppose that if C were a cycle in 
                              
                                 
                                    
                                       H
                                    
                                    
                                       ′
                                    
                                 
                              
                           , then the reduced graph 
                              
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                                 -
                                 E
                                 (
                                 C
                                 )
                              
                           , satisfying 
                              
                                 w
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                                 -
                                 E
                                 (
                                 C
                                 )
                                 )
                                 <
                                 w
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                              
                           , would be another feasible solution to the instance G of the CERG problem, which contradicts the optimality of 
                              
                                 w
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                              
                           .

Since the graph 
                              
                                 
                                    
                                       H
                                    
                                    
                                       ′
                                    
                                 
                              
                            contains no cycle, we obtain the fact that 
                              
                                 
                                    
                                       H
                                    
                                    
                                       ′
                                    
                                 
                              
                            is a forest. Then the edges in 
                              
                                 
                                    
                                       H
                                    
                                    
                                       ′
                                    
                                 
                              
                            can be decomposed into k edge-disjoint simple paths by modifying graph searching algorithm (Papadimitriou & Steiglitz, 1998) in the following recursive steps (note that 
                              
                                 
                                    
                                       H
                                    
                                    
                                       ′
                                    
                                 
                              
                            contains at least two vertices of degree 1).
                              
                                 (1)
                                 For 
                                       
                                          r
                                          =
                                          1
                                       
                                    , choose any vertex of degree 1 in 
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    , namely 
                                       
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      2
                                                      r
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    , and by using the similar graph searching algorithm in Papadimitriou and Steiglitz (1998) to find the next vertex of odd degree along sole path from 
                                       
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      2
                                                      r
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                     in 
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    , namely 
                                       
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      2
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                    , we can construct a simple path 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            2
                                                            r
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            2
                                                            r
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                       
                                     to connect 
                                       
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      2
                                                      r
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      2
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                     in 
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    .

Let 
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ′
                                             
                                          
                                          ≔
                                          
                                             
                                                H
                                             
                                             
                                                ′
                                             
                                          
                                          -
                                          E
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            2
                                                            r
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            2
                                                            r
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                    . Using the similar argument in (1), we can choose two new vertices of odd degree in the new graph 
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    , namely 
                                       
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      2
                                                      r
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      2
                                                      r
                                                      +
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    , and then construct a simple path 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            2
                                                            r
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            2
                                                            r
                                                            +
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                       
                                     to connect 
                                       
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      2
                                                      r
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      2
                                                      r
                                                      +
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                     in 
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    . Let 
                                       
                                          r
                                          ≔
                                          r
                                          +
                                          1
                                       
                                     and execute (2) repeatedly until 
                                       
                                          r
                                          =
                                          k
                                       
                                    .

Now, without loss of generality, we assume that the edges in 
                              
                                 
                                    
                                       H
                                    
                                    
                                       ′
                                    
                                 
                              
                            are decomposed into k edge-disjoint simple paths 
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   2
                                                   r
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   2
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 r
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 k
                              
                           , such that the edge set 
                              
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             4
                                          
                                       
                                    
                                 
                                 ,
                                 …
                              
                           , 
                              
                                 
                                    
                                       v
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             2
                                             k
                                             -
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             2
                                             k
                                          
                                       
                                    
                                 
                                 }
                              
                            is a perfect matching in H. It follows that 
                              
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             G
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             2
                                             r
                                             -
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             2
                                             r
                                          
                                       
                                    
                                 
                                 )
                                 ⩽
                                 w
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   2
                                                   r
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   2
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ,
                                 r
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 k
                              
                           , and 
                              
                                 w
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       r
                                       =
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 w
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   2
                                                   r
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   2
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                           .

Since M is a minimum cost perfect matching in 
                              
                                 H
                                 =
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       o
                                    
                                 
                                 ,
                                 
                                    
                                       E
                                    
                                    
                                       H
                                    
                                 
                                 ;
                                 
                                    
                                       w
                                    
                                    
                                       H
                                    
                                 
                                 )
                              
                           , we obtain
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          H
                                       
                                    
                                    (
                                    M
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   j
                                                
                                             
                                             ∈
                                             M
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             e
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    w
                                    (
                                    e
                                    )
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             =
                                             1
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          
                                             
                                                G
                                             
                                             
                                                u
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                2
                                                r
                                                -
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                2
                                                r
                                             
                                          
                                       
                                    
                                    )
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             =
                                             1
                                          
                                          
                                             k
                                          
                                       
                                    
                                    w
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      2
                                                      r
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      2
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    =
                                    w
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          ∗
                                       
                                    
                                    -
                                    
                                       
                                          E
                                       
                                       
                                          l
                                       
                                    
                                    )
                                    .
                                 
                              
                           It implies 
                              
                                 w
                                 (
                                 T
                                 )
                                 =
                                 w
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       l
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       H
                                    
                                 
                                 (
                                 M
                                 )
                                 ⩽
                                 w
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       l
                                    
                                 
                                 )
                                 +
                                 w
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                                 -
                                 
                                    
                                       E
                                    
                                    
                                       l
                                    
                                 
                                 )
                                 =
                                 w
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                              
                           . This shows that the Eulerian tour T produced at Step 8 has a minimum total length to the instance 
                              
                                 G
                                 =
                                 (
                                 V
                                 ,
                                 E
                                 ;
                                 w
                                 ;
                                 l
                                 ,
                                 u
                                 )
                              
                            of the CERG problem.

Finally, the running time of the algorithm CERG can be determined as follows.
                              
                                 (1)
                                 Since each of the 
                                       
                                          l
                                          (
                                          e
                                          )
                                       
                                     multi-edges of G can be constructed within a constant time, the multigraph 
                                       
                                          
                                             
                                                G
                                             
                                             
                                                l
                                             
                                          
                                          =
                                          (
                                          V
                                          ,
                                          
                                             
                                                E
                                             
                                             
                                                l
                                             
                                          
                                          )
                                       
                                     at Step 1 needs time 
                                       
                                          O
                                          (
                                          m
                                          )
                                       
                                     to be constructed.

Since each of the 
                                       
                                          l
                                          (
                                          e
                                          )
                                       
                                     multi-edges of G can be traversed within a constant time, an Eulerian tour T on G at Step 2 needs at most time 
                                       
                                          O
                                          (
                                          m
                                          )
                                       
                                     to be determined.

The graph 
                                       
                                          
                                             
                                                G
                                             
                                             
                                                u
                                             
                                          
                                          =
                                          (
                                          V
                                          ,
                                          
                                             
                                                E
                                             
                                             
                                                u
                                             
                                          
                                          )
                                       
                                     at Step 3 needs time 
                                       
                                          O
                                          (
                                          m
                                          )
                                       
                                     to be constructed.

The graph H at Step 4 needs time 
                                       
                                          O
                                          (
                                          
                                             
                                                n
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                     to be constructed, by using the Floyd algorithm (Floyd, 1962).

A minimum cost perfect matching M in H at Steps 5 and 6 needs time 
                                       
                                          O
                                          (
                                          
                                             
                                                n
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                     to be found.

The augmented graph 
                                       
                                          
                                             
                                                G
                                             
                                             
                                                ′
                                             
                                          
                                       
                                     at Step 7 needs at most time 
                                       
                                          O
                                          (
                                          
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                     to be constructed.

An Eulerian tour T on 
                                       
                                          
                                             
                                                G
                                             
                                             
                                                ′
                                             
                                          
                                       
                                     at Step 8 needs at most time 
                                       
                                          O
                                          (
                                          
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                     to be determined.

Hence, the total running time of the algorithm CERG is 
                              
                                 O
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                           . This establishes the theorem.□

Using the algorithm CERG, we can obtain the following immediately.
                        Corollary 2
                        
                           For any connected graph 
                           
                              
                                 G
                                 =
                                 (
                                 V
                                 ,
                                 E
                                 ;
                                 w
                                 ;
                                 u
                                 )
                              
                           
                           , where a length function 
                           
                              
                                 w
                                 :
                                 E
                                 →
                                 
                                    
                                       Q
                                    
                                    
                                       +
                                    
                                 
                              
                            
                           and an integer function 
                           
                              
                                 u
                                 :
                                 E
                                 →
                                 
                                    
                                       Z
                                    
                                    
                                       +
                                    
                                 
                              
                           
                           , the algorithm CERG can either produce a minimum length tour traversing each edge e at least once and at most 
                           
                              
                                 u
                                 (
                                 e
                                 )
                              
                            
                           times or determine that there is none.
                        

In this section, we consider the constrained arc routing problem in digraphs (CARD), that is the constrained arc routing problem in mixed graphs specialized to the case 
                        
                           E
                           =
                           ∅
                        
                     . This problem is a generalization of the directed Chinese postman problem (DCPP).

We know that the DCPP is solvable in polynomial time. A solution exists if and only if the digraph D is strongly connected. The techniques used to solve the DCPP are similar to those used for the undirected case. If D is symmetric, i.e., each vertex in D has equal in- and out-degrees, then the directed Chinese postman tour constructed by the Eulerian-Circuit algorithm (Edmonds & Johnson, 1973) corresponds to a directed Eulerian circuit in D.

If D is not symmetric, then copies of some arcs of D must be added to D so that the augmented digraph 
                        
                           
                              
                                 D
                              
                              
                                 ′
                              
                           
                        
                      becomes symmetric. A directed Eulerian circuit in 
                        
                           
                              
                                 D
                              
                              
                                 ′
                              
                           
                        
                      corresponds to a directed Chinese postman tour in D. The digraph 
                        
                           
                              
                                 D
                              
                              
                                 ′
                              
                           
                        
                      can be obtained from D by solving a transportation problem described in Ford and Fulkerson (1962).

In order to describe our algorithm to optimally solve the CARD problem, we need two auxiliary constructions. First, we construct a multidigraph 
                        
                           
                              
                                 D
                              
                              
                                 l
                              
                           
                           =
                           (
                           V
                           ,
                           
                              
                                 A
                              
                              
                                 l
                              
                           
                           )
                        
                     , where the multiset 
                        
                           
                              
                                 A
                              
                              
                                 l
                              
                           
                        
                      contains each arc e of A exactly 
                        
                           l
                           (
                           e
                           )
                        
                      times. Let 
                        
                           
                              
                                 A
                              
                              
                                 u
                              
                           
                        
                      denote the subset 
                        
                           {
                           e
                           ∈
                           A
                           |
                           l
                           (
                           e
                           )
                           <
                           u
                           (
                           e
                           )
                           }
                        
                     . Next, we construct a weighted digraph 
                        
                           
                              
                                 D
                              
                              
                                 u
                              
                           
                           =
                           (
                           V
                           ,
                           
                              
                                 A
                              
                              
                                 u
                              
                           
                           ;
                           
                              
                                 w
                              
                              
                                 u
                              
                           
                           )
                        
                     , where the length function 
                        
                           
                              
                                 w
                              
                              
                                 u
                              
                           
                           :
                           
                              
                                 A
                              
                              
                                 u
                              
                           
                           →
                           
                              
                                 Q
                              
                              
                                 +
                              
                           
                        
                      satisfies 
                        
                           
                              
                                 w
                              
                              
                                 u
                              
                           
                           (
                           e
                           )
                           =
                           w
                           (
                           e
                           )
                        
                      for each arc 
                        
                           e
                           ∈
                           
                              
                                 A
                              
                              
                                 u
                              
                           
                        
                     . For any feasible solution for the CARD problem, find some multi-arcs from 
                        
                           
                              
                                 A
                              
                              
                                 u
                              
                           
                        
                      to create the multiset 
                        
                           
                              
                                 A
                              
                              
                                 u
                              
                              
                                 ′
                              
                           
                        
                      such that the augmented multidigraph 
                        
                           
                              
                                 D
                              
                              
                                 ′
                              
                           
                           =
                           (
                           V
                           ,
                           
                              
                                 A
                              
                              
                                 l
                              
                           
                           ∪
                           
                              
                                 A
                              
                              
                                 u
                              
                              
                                 ′
                              
                           
                           )
                        
                      is Eulerian.

Modifying the steps to solve the DCPP, we can solve the CARD problem by the following strategy.
                        
                           (1)
                           If needed, find a multiset 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                 
                               of 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          u
                                       
                                    
                                 
                               such that the augmented multidigraph 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    (
                                    V
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          l
                                       
                                    
                                    ∪
                                    
                                       
                                          A
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               is Eulerian, having the minimum total length 
                                 
                                    w
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                u
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    w
                                    (
                                    e
                                    )
                                 
                              .

Construct a directed Eulerian circuit in 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          ′
                                       
                                    
                                 
                              .

In our algorithm to solve the CARD problem, we needed a combinatorial algorithm in Orlin (1993) to solve the minimum cost integral 
                        
                           (
                           s
                           ,
                           t
                           )
                        
                     -flow problem, that was referred the Enhanced-Capacity-Scaling algorithm in Lemma 5.

We design an algorithm to solve the CARD problem as follows.
                        Algorithm 3
                        CARD 
                              
                                 
                                    
                                    
                                       
                                          Input: A strongly connected digraph 
                                                
                                                   D
                                                   =
                                                   (
                                                   V
                                                   ,
                                                   A
                                                   ;
                                                   w
                                                   ;
                                                   l
                                                   ,
                                                   u
                                                   )
                                                
                                              with a length function 
                                                
                                                   w
                                                   :
                                                   A
                                                   →
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                
                                              and two integer functions 
                                                
                                                   l
                                                   ,
                                                   u
                                                   :
                                                   A
                                                   →
                                                   
                                                      
                                                         Z
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                
                                              satisfying 
                                                
                                                   l
                                                   (
                                                   e
                                                   )
                                                   ⩽
                                                   u
                                                   (
                                                   e
                                                   )
                                                
                                              for all arcs 
                                                
                                                   e
                                                   ∈
                                                   A
                                                
                                             .
                                       
                                       
                                          Output: A minimum length arc routing T on D to satisfy the constraint.
                                       
                                       
                                          Begin
                                       
                                       
                                          Step 1 Let 
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                
                                              denote the multiset consisting of each arc e of A exactly 
                                                
                                                   l
                                                   (
                                                   e
                                                   )
                                                
                                              times. And construct the multidigraph 
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   =
                                                   (
                                                   V
                                                   ,
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   )
                                                
                                             .
                                       
                                       
                                          Step 2 For each vertex 
                                                
                                                   v
                                                   ∈
                                                   V
                                                
                                             , compute 
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               l
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   v
                                                   )
                                                   =
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               l
                                                            
                                                         
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                   (
                                                   v
                                                   )
                                                   -
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               l
                                                            
                                                         
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   (
                                                   v
                                                   )
                                                
                                             .
                                       
                                       
                                          Step 3 If (
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                
                                              is strongly connected and 
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               l
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   v
                                                   )
                                                   =
                                                   0
                                                
                                              for each vertex 
                                                
                                                   v
                                                   ∈
                                                   V
                                                
                                             ) then
                                       
                                       
                                          
                                             Determine a directed Eulerian circuit T on 
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                
                                              by using the Eulerian-Circuit algorithm in Edmonds and Johnson (1973), and stop. The tour T corresponds to an optimal solution on D.
                                       
                                       
                                          Step 4 Construct the digraph 
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   =
                                                   (
                                                   V
                                                   ,
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ;
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   )
                                                
                                             , where 
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   =
                                                   {
                                                   e
                                                   ∈
                                                   A
                                                   |
                                                   l
                                                   (
                                                   e
                                                   )
                                                   <
                                                   u
                                                   (
                                                   e
                                                   )
                                                   }
                                                
                                              and 
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   :
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   →
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                
                                              satisfies 
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   (
                                                   e
                                                   )
                                                   =
                                                   w
                                                   (
                                                   e
                                                   )
                                                
                                              for each arc 
                                                
                                                   e
                                                   ∈
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          Step 5 Let 
                                                
                                                   I
                                                   =
                                                   {
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ∈
                                                   V
                                                   |
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               l
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   >
                                                   0
                                                   }
                                                
                                              and 
                                                
                                                   J
                                                   =
                                                   {
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ∈
                                                   V
                                                   |
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               l
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   <
                                                   0
                                                   }
                                                
                                             .
                                       
                                       
                                          Step 6 Construct a network 
                                                
                                                   N
                                                   =
                                                   (
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ;
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ;
                                                   c
                                                   ;
                                                   s
                                                   ,
                                                   t
                                                   )
                                                
                                              from the digraph 
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   =
                                                   (
                                                   V
                                                   ,
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ;
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   )
                                                
                                              satisfying the following.
                                       
                                       
                                          
                                             
                                             (1)Let 
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   V
                                                   ∪
                                                   {
                                                   s
                                                   ,
                                                   t
                                                   }
                                                
                                              and 
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ∪
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                   ∪
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         J
                                                      
                                                   
                                                
                                             . The source s and the sink t are two vertices not belonging to V so that 
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                   =
                                                   {
                                                   (
                                                   s
                                                   ,
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   |
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ∈
                                                   I
                                                   }
                                                
                                              and 
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         J
                                                      
                                                   
                                                   =
                                                   {
                                                   (
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ,
                                                   t
                                                   )
                                                
                                              
                                             
                                                
                                                   |
                                                
                                              
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ∈
                                                   J
                                                   }
                                                
                                             .
                                       
                                       
                                          
                                             
                                             (2)Define the capacity function 
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   :
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   →
                                                   
                                                      
                                                         Z
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                
                                              as follows
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      (
                                                      e
                                                      )
                                                      =
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        u
                                                                        (
                                                                        e
                                                                        )
                                                                        -
                                                                        l
                                                                        (
                                                                        e
                                                                        )
                                                                     
                                                                     
                                                                        if the arc
                                                                        
                                                                        e
                                                                        ∈
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              u
                                                                           
                                                                        
                                                                        ,
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              σ
                                                                           
                                                                           
                                                                              
                                                                                 
                                                                                    D
                                                                                 
                                                                                 
                                                                                    l
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        (
                                                                        
                                                                           
                                                                              v
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        if the arc
                                                                        
                                                                        e
                                                                        =
                                                                        (
                                                                        s
                                                                        ,
                                                                        
                                                                           
                                                                              v
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        )
                                                                        ∈
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              I
                                                                           
                                                                        
                                                                        ,
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        -
                                                                        
                                                                           
                                                                              σ
                                                                           
                                                                           
                                                                              
                                                                                 
                                                                                    D
                                                                                 
                                                                                 
                                                                                    l
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        (
                                                                        
                                                                           
                                                                              v
                                                                           
                                                                           
                                                                              j
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        if the arc
                                                                        
                                                                        e
                                                                        =
                                                                        (
                                                                        
                                                                           
                                                                              v
                                                                           
                                                                           
                                                                              j
                                                                           
                                                                        
                                                                        ,
                                                                        t
                                                                        )
                                                                        ∈
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              J
                                                                           
                                                                        
                                                                        .
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             (3)Define the cost function 
                                                
                                                   c
                                                   :
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   →
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                
                                              as follows
                                                
                                                   
                                                      c
                                                      (
                                                      e
                                                      )
                                                      =
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        w
                                                                        (
                                                                        e
                                                                        )
                                                                     
                                                                     
                                                                        if the arc
                                                                        
                                                                        e
                                                                        ∈
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              u
                                                                           
                                                                        
                                                                        ,
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        0
                                                                     
                                                                     
                                                                        if the arc
                                                                        
                                                                        e
                                                                        =
                                                                        (
                                                                        s
                                                                        ,
                                                                        
                                                                           
                                                                              v
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        )
                                                                        ∈
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              I
                                                                           
                                                                        
                                                                        ,
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        0
                                                                     
                                                                     
                                                                        if the arc
                                                                        
                                                                        e
                                                                        =
                                                                        (
                                                                        
                                                                           
                                                                              v
                                                                           
                                                                           
                                                                              j
                                                                           
                                                                        
                                                                        ,
                                                                        t
                                                                        )
                                                                        ∈
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              J
                                                                           
                                                                        
                                                                        .
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             (4)Let 
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               l
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             .
                                       
                                       
                                          Step 7 If (there exists no 
                                                
                                                   (
                                                   s
                                                   ,
                                                   t
                                                   )
                                                
                                             -flow of value 
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             ) then
                                       
                                       
                                          
                                             
                                             Output “no feasible solution in D”, and stop.
                                       
                                       
                                          Step 8 Using the Enhanced-Capacity-Scaling algorithm in Orlin (1993), determine a minimum cost integral 
                                                
                                                   (
                                                   s
                                                   ,
                                                   t
                                                   )
                                                
                                             -flow f of value 
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                              in N.
                                       
                                       
                                          Step 9 Construct the multiset of arcs 
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         f
                                                      
                                                   
                                                   =
                                                   {
                                                   
                                                      
                                                         (
                                                         x
                                                         ,
                                                         y
                                                         )
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         (
                                                         x
                                                         ,
                                                         y
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         (
                                                         x
                                                         ,
                                                         y
                                                         )
                                                      
                                                      
                                                         f
                                                         (
                                                         x
                                                         ,
                                                         y
                                                         )
                                                      
                                                   
                                                   |
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                   ∈
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   
                                                   and
                                                   
                                                   f
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                   >
                                                   0
                                                   }
                                                
                                             .
                                       
                                       
                                          Step 10 Construct the multidigraph 
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         f
                                                      
                                                   
                                                   ≔
                                                   (
                                                   V
                                                   ,
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   ∪
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         f
                                                      
                                                   
                                                   )
                                                
                                             .
                                       
                                       
                                          Step 11 Determine a directed Eulerian circuit T on 
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         f
                                                      
                                                   
                                                
                                              by the Eulerian-Circuit algorithm in Edmonds and Johnson (1973), and stop. The tour T corresponds to an optimal solution on D.
                                       
                                       
                                          End
                                       
                                    
                                 
                              
                           
                        

Using the algorithm CARD, we obtain the following result for the CARD problem.
                        Theorem 3
                        
                           The algorithm CARD works correctly to solve the CARD problem, and its running time is 
                           
                              
                                 O
                                 (
                                 
                                    
                                       nm
                                    
                                    
                                       2
                                    
                                 
                                 log
                                 n
                                 )
                              
                           
                           .
                        

First, we prove the output tour T produced by the algorithm CARD is a feasible directed circuit to the digraph 
                              
                                 D
                                 =
                                 (
                                 V
                                 ,
                                 A
                                 ;
                                 w
                                 ;
                                 l
                                 ,
                                 u
                                 )
                              
                            of the CARD problem. If T is produced at Step 3, it is easy to verify that T is an optimal solution to the digraph 
                              
                                 D
                                 =
                                 (
                                 V
                                 ,
                                 A
                                 ;
                                 w
                                 ;
                                 l
                                 ,
                                 u
                                 )
                              
                           . Now, we assume that output T is produced at Step 11. Since f is a minimum cost integral 
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                           -flow of value 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                 
                              
                           , where 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                       ∈
                                       I
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             D
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           , we obtain the following three facts.


                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          x
                                          :
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          x
                                          )
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                u
                                             
                                          
                                       
                                    
                                    f
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    x
                                    )
                                    -
                                    
                                       
                                          ∑
                                       
                                       
                                          x
                                          :
                                          (
                                          x
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                u
                                             
                                          
                                       
                                    
                                    f
                                    (
                                    x
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    f
                                    (
                                    s
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                D
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                               for each vertex 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                 
                               of I;


                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          y
                                          :
                                          (
                                          y
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                u
                                             
                                          
                                       
                                    
                                    f
                                    (
                                    y
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          ∑
                                       
                                       
                                          y
                                          :
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          y
                                          )
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                u
                                             
                                          
                                       
                                    
                                    f
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    y
                                    )
                                    =
                                    f
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    t
                                    )
                                    =
                                    -
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                D
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                               for each vertex 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                 
                               of J;


                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          x
                                          :
                                          (
                                          x
                                          ,
                                          z
                                          )
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                u
                                             
                                          
                                       
                                    
                                    f
                                    (
                                    x
                                    ,
                                    z
                                    )
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          y
                                          :
                                          (
                                          z
                                          ,
                                          y
                                          )
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                u
                                             
                                          
                                       
                                    
                                    f
                                    (
                                    z
                                    ,
                                    y
                                    )
                                 
                               for each vertex z of 
                                 
                                    V
                                    -
                                    (
                                    I
                                    ∪
                                    J
                                    )
                                 
                              .

For each vertex 
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ∈
                           I
                        
                     , we have
                        
                           
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          f
                                       
                                    
                                 
                                 
                                    +
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    +
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              )
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       x
                                       :
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       x
                                       )
                                       ∈
                                       
                                          
                                             A
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                              f
                              (
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              ,
                              x
                              )
                              =
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    +
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              )
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       x
                                       :
                                       (
                                       x
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ∈
                                       
                                          
                                             A
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                              f
                              (
                              x
                              ,
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              )
                              +
                              
                                 
                                    σ
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          l
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    +
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              )
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       x
                                       :
                                       (
                                       x
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ∈
                                       
                                          
                                             A
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                              f
                              (
                              x
                              ,
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              )
                              +
                              (
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    -
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              )
                              -
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    +
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              )
                              )
                              =
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    -
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              )
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       x
                                       :
                                       (
                                       x
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ∈
                                       
                                          
                                             A
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                              f
                              (
                              x
                              ,
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          f
                                       
                                    
                                 
                                 
                                    -
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              )
                              .
                           
                        
                     
                  

For each vertex 
                        
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           ∈
                           J
                        
                     , we have
                        
                           
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          f
                                       
                                    
                                 
                                 
                                    -
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              )
                              =
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    -
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              )
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       y
                                       :
                                       (
                                       y
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       ∈
                                       
                                          
                                             A
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                              f
                              (
                              y
                              ,
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              )
                              =
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    -
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              )
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       y
                                       :
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       y
                                       )
                                       ∈
                                       
                                          
                                             A
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                              f
                              (
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              ,
                              y
                              )
                              -
                              
                                 
                                    σ
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          l
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              )
                              =
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    -
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              )
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       y
                                       :
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       y
                                       )
                                       ∈
                                       
                                          
                                             A
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                              f
                              (
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              ,
                              y
                              )
                              -
                              (
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    -
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              )
                              -
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    +
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              )
                              )
                              =
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    +
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              )
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       y
                                       :
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       y
                                       )
                                       ∈
                                       
                                          
                                             A
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                              f
                              (
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              ,
                              y
                              )
                              =
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          f
                                       
                                    
                                 
                                 
                                    +
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              )
                              .
                           
                        
                     For each vertex z of 
                        
                           V
                           -
                           (
                           I
                           ∪
                           J
                           )
                        
                     , we have
                        
                           
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          f
                                       
                                    
                                 
                                 
                                    +
                                 
                              
                              (
                              z
                              )
                              =
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    +
                                 
                              
                              (
                              z
                              )
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       y
                                       :
                                       (
                                       z
                                       ,
                                       y
                                       )
                                       ∈
                                       
                                          
                                             A
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                              f
                              (
                              z
                              ,
                              y
                              )
                              =
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    -
                                 
                              
                              (
                              u
                              )
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       x
                                       :
                                       (
                                       x
                                       ,
                                       z
                                       )
                                       ∈
                                       
                                          
                                             A
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                              f
                              (
                              x
                              ,
                              z
                              )
                              =
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          f
                                       
                                    
                                 
                                 
                                    -
                                 
                              
                              (
                              z
                              )
                              .
                           
                        
                     This shows that 
                        
                           
                              
                                 d
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       f
                                    
                                 
                              
                              
                                 +
                              
                           
                           (
                           z
                           )
                           =
                           
                              
                                 d
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       f
                                    
                                 
                              
                              
                                 -
                              
                           
                           (
                           z
                           )
                        
                      for each vertex z in 
                        
                           
                              
                                 D
                              
                              
                                 f
                              
                           
                        
                     . Since D is strongly connected, so is 
                        
                           
                              
                                 D
                              
                              
                                 f
                              
                           
                        
                     . Thus, 
                        
                           
                              
                                 D
                              
                              
                                 f
                              
                           
                        
                      is an Eulerian digraph. Obviously, the output tour T on 
                        
                           
                              
                                 D
                              
                              
                                 f
                              
                           
                        
                      produced at Step 11 is a feasible solution to the instance 
                        
                           D
                           =
                           (
                           V
                           ,
                           A
                           ;
                           w
                           ;
                           l
                           ,
                           u
                           )
                        
                      of the CARD problem.

Next, we prove that the Eulerian tour T produced at Step 11 is a minimum total length solution to the instance 
                        
                           D
                           =
                           (
                           V
                           ,
                           A
                           ;
                           w
                           ;
                           l
                           ,
                           u
                           )
                        
                     . We may assume that 
                        
                           
                              
                                 T
                              
                              
                                 ∗
                              
                           
                           =
                           (
                           V
                           ,
                           
                              
                                 A
                              
                              
                                 ∗
                              
                           
                           )
                        
                      is an optimal directed tour on 
                        
                           D
                           =
                           (
                           V
                           ,
                           A
                           ;
                           w
                           ;
                           l
                           ,
                           u
                           )
                        
                      such that each arc e in A appears in 
                        
                           
                              
                                 T
                              
                              
                                 ∗
                              
                           
                        
                      exactly 
                        
                           
                              
                                 l
                              
                              
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                           (
                           e
                           )
                        
                      times, where 
                        
                           l
                           (
                           e
                           )
                           ⩽
                           
                              
                                 l
                              
                              
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                           (
                           e
                           )
                           ⩽
                           u
                           (
                           e
                           )
                        
                     , and that 
                        
                           w
                           (
                           
                              
                                 T
                              
                              
                                 ∗
                              
                           
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 e
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                           w
                           (
                           e
                           )
                        
                      is minimized.

Let the directed subgraph 
                        
                           
                              
                                 H
                              
                              
                                 ′
                              
                           
                           =
                           D
                           [
                           
                              
                                 T
                              
                              
                                 ∗
                              
                           
                           -
                           
                              
                                 A
                              
                              
                                 l
                              
                           
                           ]
                        
                      be obtained from the multidigraph 
                        
                           H
                           =
                           
                              
                                 T
                              
                              
                                 ∗
                              
                           
                           -
                           
                              
                                 A
                              
                              
                                 l
                              
                           
                        
                      by replacing multi-arcs joining the same pair of end-vertices by one arc. Since 
                        
                           
                              
                                 T
                              
                              
                                 ∗
                              
                           
                        
                      is an optimal directed tour in D, by the fact that 
                        
                           
                              
                                 A
                              
                              
                                 l
                              
                           
                        
                      is a multiset of arcs of A, the multidigraph H contains no directed circuit, otherwise the optimal value 
                        
                           w
                           (
                           
                              
                                 T
                              
                              
                                 ∗
                              
                           
                           )
                        
                      would be reduced. It follows that the reduced digraph 
                        
                           
                              
                                 H
                              
                              
                                 ′
                              
                           
                        
                      is an acyclic subdigraph of the digraph 
                        
                           
                              
                                 D
                              
                              
                                 u
                              
                           
                        
                     .

Now, let 
                        
                           
                              
                                 I
                              
                              
                                 ′
                              
                           
                           =
                           {
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ∈
                           V
                           |
                           
                              
                                 d
                              
                              
                                 H
                              
                              
                                 +
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           )
                           >
                           
                              
                                 d
                              
                              
                                 H
                              
                              
                                 -
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           )
                           }
                        
                      and 
                        
                           
                              
                                 J
                              
                              
                                 ′
                              
                           
                           =
                           {
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           ∈
                           V
                           |
                           
                              
                                 d
                              
                              
                                 H
                              
                              
                                 -
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           )
                           >
                           
                              
                                 d
                              
                              
                                 H
                              
                              
                                 +
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           )
                           }
                        
                     . Since 
                        
                           
                              
                                 T
                              
                              
                                 ∗
                              
                           
                        
                      is an optimal directed tour in D and it traverses all arcs in 
                        
                           
                              
                                 A
                              
                              
                                 l
                              
                           
                        
                     , and for every vertex 
                        
                           v
                           ∈
                           V
                        
                     , we have 
                        
                           
                              
                                 d
                              
                              
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                              
                              
                                 +
                              
                           
                           (
                           v
                           )
                           =
                           
                              
                                 d
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       l
                                    
                                 
                              
                              
                                 +
                              
                           
                           (
                           v
                           )
                           +
                           
                              
                                 d
                              
                              
                                 H
                              
                              
                                 +
                              
                           
                           (
                           v
                           )
                        
                     , 
                        
                           
                              
                                 d
                              
                              
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                              
                              
                                 -
                              
                           
                           (
                           v
                           )
                           =
                           
                              
                                 d
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       l
                                    
                                 
                              
                              
                                 -
                              
                           
                           (
                           v
                           )
                           +
                           
                              
                                 d
                              
                              
                                 H
                              
                              
                                 -
                              
                           
                           (
                           v
                           )
                        
                      and 
                        
                           
                              
                                 d
                              
                              
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                              
                              
                                 +
                              
                           
                           (
                           v
                           )
                           =
                           
                              
                                 d
                              
                              
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                              
                              
                                 -
                              
                           
                           (
                           v
                           )
                        
                     . It follows that 
                        
                           
                              
                                 d
                              
                              
                                 H
                              
                              
                                 +
                              
                           
                           (
                           v
                           )
                           -
                           
                              
                                 d
                              
                              
                                 H
                              
                              
                                 -
                              
                           
                           (
                           v
                           )
                           =
                           
                              
                                 d
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       l
                                    
                                 
                              
                              
                                 -
                              
                           
                           (
                           v
                           )
                           -
                           
                              
                                 d
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       l
                                    
                                 
                              
                              
                                 +
                              
                           
                           (
                           v
                           )
                           =
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       l
                                    
                                 
                              
                           
                           (
                           v
                           )
                        
                     . In addition, we have known 
                        
                           
                              
                                 I
                              
                              
                                 ′
                              
                           
                           =
                           I
                        
                      and 
                        
                           
                              
                                 J
                              
                              
                                 ′
                              
                           
                           =
                           J
                        
                      such that 
                        
                           
                              
                                 ∑
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 I
                              
                           
                           (
                           
                              
                                 d
                              
                              
                                 H
                              
                              
                                 +
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           )
                           -
                           
                              
                                 d
                              
                              
                                 H
                              
                              
                                 -
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           )
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 I
                              
                           
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       l
                                    
                                 
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           )
                           =
                           
                              
                                 σ
                              
                              
                                 0
                              
                           
                        
                      and 
                        
                           
                              
                                 ∑
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       j
                                    
                                 
                                 ∈
                                 J
                              
                           
                           (
                           
                              
                                 d
                              
                              
                                 H
                              
                              
                                 +
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           )
                           -
                           
                              
                                 d
                              
                              
                                 H
                              
                              
                                 -
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           )
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       j
                                    
                                 
                                 ∈
                                 J
                              
                           
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       l
                                    
                                 
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           )
                           =
                           -
                           
                              
                                 σ
                              
                              
                                 0
                              
                           
                        
                     .

We define a network 
                        
                           
                              
                                 N
                              
                              
                                 ∗
                              
                           
                           =
                           (
                           V
                           (
                           
                              
                                 H
                              
                              
                                 ′
                              
                           
                           )
                           ∪
                           {
                           s
                           ,
                           t
                           }
                           ,
                           
                              
                                 A
                              
                              
                                 ″
                              
                           
                           ∪
                           
                              
                                 A
                              
                              
                                 I
                              
                           
                           ∪
                           
                              
                                 A
                              
                              
                                 J
                              
                           
                           ;
                           
                              
                                 u
                              
                              
                                 ∗
                              
                           
                           ;
                           c
                           ;
                           s
                           ,
                           t
                           )
                        
                      from 
                        
                           
                              
                                 H
                              
                              
                                 ′
                              
                           
                           =
                           D
                           [
                           
                              
                                 T
                              
                              
                                 ∗
                              
                           
                           -
                           
                              
                                 A
                              
                              
                                 l
                              
                           
                           ]
                        
                      so that 
                        
                           
                              
                                 A
                              
                              
                                 ″
                              
                           
                        
                      is the arc set of 
                        
                           
                              
                                 H
                              
                              
                                 ′
                              
                           
                        
                      (clearly, 
                        
                           
                              
                                 A
                              
                              
                                 ″
                              
                           
                           ⊆
                           
                              
                                 A
                              
                              
                                 u
                              
                           
                        
                     ), 
                        
                           
                              
                                 A
                              
                              
                                 I
                              
                           
                           =
                           {
                           (
                           s
                           ,
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           )
                           |
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ∈
                           I
                           }
                        
                      and 
                        
                           
                              
                                 A
                              
                              
                                 J
                              
                           
                           =
                           {
                           (
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           ,
                           t
                           )
                           |
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           ∈
                           J
                           }
                        
                     . The capacity function 
                        
                           
                              
                                 u
                              
                              
                                 ∗
                              
                           
                           :
                           
                              
                                 A
                              
                              
                                 ″
                              
                           
                           ∪
                           
                              
                                 A
                              
                              
                                 I
                              
                           
                           ∪
                           
                              
                                 A
                              
                              
                                 J
                              
                           
                           →
                           
                              
                                 Z
                              
                              
                                 +
                              
                           
                        
                      is defined as follows:
                        
                           
                              
                                 
                                    u
                                 
                                 
                                    ∗
                                 
                              
                              (
                              e
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                                (
                                                e
                                                )
                                                -
                                                l
                                                (
                                                e
                                                )
                                             
                                             
                                                if the arc
                                                
                                                e
                                                ∈
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ″
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             
                                                if the arc
                                                
                                                e
                                                =
                                                (
                                                s
                                                ,
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                ∈
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      I
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                -
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                             
                                                if the arc
                                                
                                                e
                                                =
                                                (
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ,
                                                t
                                                )
                                                ∈
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      J
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     and the cost function 
                        
                           c
                           :
                           
                              
                                 A
                              
                              
                                 ″
                              
                           
                           ∪
                           
                              
                                 A
                              
                              
                                 I
                              
                           
                           ∪
                           
                              
                                 A
                              
                              
                                 J
                              
                           
                           →
                           
                              
                                 Q
                              
                              
                                 +
                              
                           
                        
                      is defined as follows
                        
                           
                              c
                              (
                              e
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                                (
                                                e
                                                )
                                             
                                             
                                                if the arc
                                                
                                                e
                                                ∈
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ″
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                if the arc
                                                
                                                e
                                                =
                                                (
                                                s
                                                ,
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                ∈
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      I
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                if the arc
                                                
                                                e
                                                =
                                                (
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ,
                                                t
                                                )
                                                ∈
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      J
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Now, we can construct an integral 
                        
                           (
                           s
                           ,
                           t
                           )
                        
                     -flow of value 
                        
                           
                              
                                 σ
                              
                              
                                 0
                              
                           
                        
                      in 
                        
                           
                              
                                 N
                              
                              
                                 ∗
                              
                           
                        
                      as follows. For each arc 
                        
                           e
                           ∈
                           
                              
                                 A
                              
                              
                                 ″
                              
                           
                        
                     , we define 
                        
                           
                              
                                 f
                              
                              
                                 ∗
                              
                           
                           (
                           e
                           )
                           =
                           
                              
                                 l
                              
                              
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                           (
                           e
                           )
                           -
                           l
                           (
                           e
                           )
                        
                     , 
                        
                           
                              
                                 f
                              
                              
                                 ∗
                              
                           
                           (
                           s
                           ,
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           )
                           =
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       l
                                    
                                 
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           )
                        
                      for 
                        
                           (
                           s
                           ,
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           )
                           ∈
                           
                              
                                 A
                              
                              
                                 I
                              
                           
                        
                      and 
                        
                           
                              
                                 f
                              
                              
                                 ∗
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           ,
                           t
                           )
                           =
                           -
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       D
                                    
                                    
                                       l
                                    
                                 
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           )
                        
                      for 
                        
                           (
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           ,
                           t
                           )
                           ∈
                           
                              
                                 A
                              
                              
                                 J
                              
                           
                        
                     . Since 
                        
                           
                              
                                 T
                              
                              
                                 ∗
                              
                           
                        
                      is an optimal directed tour in D, it is easy to verify that 
                        
                           
                              
                                 f
                              
                              
                                 ∗
                              
                           
                        
                      is an integral 
                        
                           (
                           s
                           ,
                           t
                           )
                        
                     -flow of value 
                        
                           
                              
                                 σ
                              
                              
                                 0
                              
                           
                        
                      in 
                        
                           
                              
                                 N
                              
                              
                                 ∗
                              
                           
                        
                      (and in N) and its cost is 
                        
                           c
                           (
                           
                              
                                 f
                              
                              
                                 ∗
                              
                           
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 e
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       ″
                                    
                                 
                              
                           
                           w
                           (
                           e
                           )
                           ·
                           (
                           
                              
                                 l
                              
                              
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                           (
                           e
                           )
                           -
                           l
                           (
                           e
                           )
                           )
                        
                     . It follows that 
                        
                           c
                           (
                           
                              
                                 f
                              
                              
                                 ∗
                              
                           
                           )
                           +
                           
                              
                                 ∑
                              
                              
                                 e
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       l
                                    
                                 
                              
                           
                           w
                           (
                           e
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 e
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                           w
                           (
                           e
                           )
                        
                     .

Since f is a minimum cost integral 
                        
                           (
                           s
                           ,
                           t
                           )
                        
                     -flow of value 
                        
                           
                              
                                 σ
                              
                              
                                 0
                              
                           
                        
                      at Step 8 of the algorithm CARD, we have 
                        
                           w
                           (
                           
                              
                                 A
                              
                              
                                 f
                              
                           
                           )
                           =
                           c
                           (
                           f
                           )
                           ⩽
                           c
                           (
                           
                              
                                 f
                              
                              
                                 ∗
                              
                           
                           )
                        
                     . It follows that 
                        
                           w
                           (
                           T
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 e
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       u
                                    
                                 
                              
                           
                           w
                           (
                           e
                           )
                           f
                           (
                           e
                           )
                           +
                           
                              
                                 ∑
                              
                              
                                 e
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       l
                                    
                                 
                              
                           
                           w
                           (
                           e
                           )
                           =
                           c
                           (
                           f
                           )
                           +
                           
                              
                                 ∑
                              
                              
                                 e
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       l
                                    
                                 
                              
                           
                           w
                           (
                           e
                           )
                           ⩽
                           c
                           (
                           
                              
                                 f
                              
                              
                                 ∗
                              
                           
                           )
                           +
                           
                              
                                 ∑
                              
                              
                                 e
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       l
                                    
                                 
                              
                           
                           w
                           (
                           e
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 e
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                           w
                           (
                           e
                           )
                        
                     . Hence, the directed Eulerian tour T produced at Step 11 is a minimum total length solution to the instance 
                        
                           D
                           =
                           (
                           V
                           ,
                           A
                           ;
                           w
                           ;
                           l
                           ,
                           u
                           )
                        
                      of the CARD problem.

Finally, the running time of algorithm CARD can be determined as follows.
                        
                           (1)
                           For each arc e in D, the 
                                 
                                    l
                                    (
                                    e
                                    )
                                 
                               multi-arcs at Step 1 need a constant time to be constructed. Hence, the multidigraph 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          l
                                       
                                    
                                    =
                                    (
                                    V
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          l
                                       
                                    
                                    )
                                 
                               needs time 
                                 
                                    O
                                    (
                                    m
                                    )
                                 
                               to be constructed.

All 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                D
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                    (
                                    v
                                    )
                                 
                               at Step 2 need at most time 
                                 
                                    O
                                    (
                                    m
                                    )
                                 
                               to compute.

For each arc e in D, the 
                                 
                                    l
                                    (
                                    e
                                    )
                                 
                               multi-arcs at Step 3 need a constant time to traverse. A directed Eulerian tour T on D needs at most time 
                                 
                                    O
                                    (
                                    nm
                                    )
                                 
                               to be determined.

The digraph 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          u
                                       
                                    
                                    =
                                    (
                                    V
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          u
                                       
                                    
                                    )
                                 
                               at Step 4 needs time 
                                 
                                    O
                                    (
                                    m
                                    )
                                 
                               to be constructed.

The network N at Steps 5 and 6 can be constructed in time 
                                 
                                    O
                                    (
                                    m
                                    )
                                 
                              .

A minimum cost integral 
                                 
                                    (
                                    s
                                    ,
                                    t
                                    )
                                 
                              -flow f in N at Steps 7 and 8 needs time 
                                 
                                    O
                                    (
                                    
                                       
                                          nm
                                       
                                       
                                          2
                                       
                                    
                                    log
                                    n
                                    )
                                 
                               to be found. The Belleman–Ford algorithm (Bellman, 1958) used to solve the shortest path problem needs time 
                                 
                                    O
                                    (
                                    nm
                                    )
                                 
                              .

The augmented multidigraph 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          f
                                       
                                    
                                 
                               at Steps 9 and 10 needs at most time 
                                 
                                    O
                                    (
                                    m
                                    )
                                 
                               to be constructed.

For each arc e in D, the 
                                 
                                    l
                                    (
                                    e
                                    )
                                 
                               multi-arcs need a constant time to traverse. A directed Eulerian tour T on 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          f
                                       
                                    
                                 
                               at Step 11 needs at most time 
                                 
                                    O
                                    (
                                    nm
                                    )
                                 
                               to be determined.

Hence, the running time of algorithm CARD is 
                        
                           O
                           (
                           
                              
                                 nm
                              
                              
                                 2
                              
                           
                           log
                           n
                           )
                        
                     . This establishes the theorem.□

Using the algorithm CARD, we can obtain the following immediately.
                        Corollary 3
                        
                           For any strongly connected digraph 
                           
                              
                                 D
                                 =
                                 (
                                 V
                                 ,
                                 A
                                 ;
                                 w
                                 ;
                                 u
                                 )
                              
                           
                           , where a length function 
                           
                              
                                 w
                                 :
                                 A
                                 →
                                 
                                    
                                       Q
                                    
                                    
                                       +
                                    
                                 
                              
                            
                           and an integer function 
                           
                              
                                 u
                                 :
                                 A
                                 →
                                 
                                    
                                       Z
                                    
                                    
                                       +
                                    
                                 
                              
                           
                           , the algorithm CARD can either produce a minimum length directed tour traversing each arc e at least once and at most 
                           
                              
                                 u
                                 (
                                 e
                                 )
                              
                            
                           times or determine that there is none.
                        

@&#CONCLUSIONS@&#

In this paper, we considered the constrained arc routing problem in mixed graphs (CARM) and obtained the following three results.
                        
                           (1)
                           For any instance 
                                 
                                    G
                                    =
                                    (
                                    V
                                    ,
                                    E
                                    ∪
                                    A
                                    ;
                                    w
                                    ;
                                    l
                                    ,
                                    u
                                    )
                                 
                               of the CARM problem, where 
                                 
                                    l
                                    (
                                    e
                                    )
                                    <
                                    u
                                    (
                                    e
                                    )
                                 
                               holds for each edge 
                                 
                                    e
                                    ∈
                                    E
                                    ,
                                    l
                                    (
                                    e
                                    )
                                    ⩽
                                    u
                                    (
                                    e
                                    )
                                 
                               holds for each arc 
                                 
                                    e
                                    ∈
                                    A
                                 
                               and 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    min
                                    {
                                    l
                                    (
                                    e
                                    )
                                    |
                                    e
                                    ∈
                                    E
                                    }
                                 
                              , we have designed a 
                                 
                                    (
                                    1
                                    +
                                    1
                                    /
                                    
                                       
                                          l
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                              -approximation algorithm in time 
                                 
                                    O
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          m
                                       
                                       
                                          3
                                       
                                    
                                    log
                                    n
                                    )
                                 
                               to solve the CARM problem.

We presented a combinatorial algorithm in time 
                                 
                                    O
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                               to optimally solve the CARM problem for the case 
                                 
                                    A
                                    =
                                    ∅
                                 
                              .

We provided a combinatorial algorithm in time 
                                 
                                    O
                                    (
                                    
                                       
                                          nm
                                       
                                       
                                          2
                                       
                                    
                                    log
                                    n
                                    )
                                 
                               to optimally solve the CARM problem for the case 
                                 
                                    E
                                    =
                                    ∅
                                 
                              .

@&#ACKNOWLEDGMENTS@&#

We are very grateful to the two anonymous reviewers for giving us good suggestions and comments so that we are able to improve our manuscript substantially.

H.L. Ding and J.P. Li are supported by the National Natural Science Foundation of China (No. 61063011), the Project of First 100 High-level Overseas Talents of Yunnan Province and IRTSTYN. K.W. Lih is supported by NSC (No.102-2115-M-001-010) of Taiwan.

@&#REFERENCES@&#

