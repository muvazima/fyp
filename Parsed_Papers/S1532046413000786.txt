@&#MAIN-TITLE@&#Enabling the use of hereditary information from pedigree tools in medical knowledge-based systems

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Risk assessment of developing an inherited illness using pedigree information.


                        
                        
                           
                           Methods, structured and statistic indices are defined for knowledge-based systems.


                        
                        
                           
                           Real information from a breast cancer database is used for experimentation.


                        
                        
                           
                           Implemented and integrated into eXiT∗CBR experimentation framework as a plugin.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Decision support

Structured data

Feature construction

Modeling

Medical applications

Knowledge-based system

@&#ABSTRACT@&#


               
               
                  The use of family information is a key issue to deal with inheritance illnesses. This kind of information use to come in the form of pedigree files, which contain structured information as tree or graphs, which explains the family relationships. Knowledge-based systems should incorporate the information gathered by pedigree tools to assess medical decision making. In this paper, we propose a method to achieve such a goal, which consists on the definition of new indicators, and methods and rules to compute them from family trees. The method is illustrated with several case studies. We provide information about its implementation and integration on a case-based reasoning tool. The method has been experimentally tested with breast cancer diagnosis data. The results show the feasibility of our methodology.
               
            

@&#INTRODUCTION@&#

Family history has been important for preventing several inheritance diseases, as it is one of the key variables in the Gail model [1] for breast cancer diagnosis. Family information is usually gathered thanks to pedigree software (as Cyrillic [2]), which allows to annotate relationships, healthy states, genetic markers, and much more data on patients and relatives, in a tree structured way. Thus, to improve medical care, a knowledge-based system (KBS) should incorporate the information about families collected thanks to this kind of tools.

Data processing on pedigree software has been traditionally faced from a statistical point of view. However, statistics are not easy in this kind of structured scenarios, most popular statistics tools can conduct to inappropriate or absurd conclusions, and other methods for compositional data are required. On the other hand, expert physicians can evaluate at a glance, from the structure, density and another heuristic knowledge, the risk of a member of the family for suffering an inheritance illness. The skill of evaluating the information of the family is something that is acquired by experience, and difficult to transmit to other, novice physicians. Our research concerns the development of tools that capture the heuristic knowledge of expert physicians, finding out measures from the tree structure that conducts as close as possible to the predictions made by them. Providing a method to extract the relevant information from family trees enables the integration of pedigree tools with medical KBSs so other physicians can also use inheritance data in their decision making.

The contribution of this paper is our methodology towards achieving such integration. It includes the definition of structured data-based indicators which are computed by analyzing the information contained in pedigree files. The methodology is presented first under the assumption of a simple, hierarchical family, and then is extended to cover more complex situations (second marriages, and so on). Our research is constrained to the data we have on breast cancer, an illness in which inheritance has been proved to be a key factor. Nevertheless, we believe that other inheritance illnesses can benefit from our results.

This paper is organized as follows. First we provide information about the structured data on Section 2. Next, in Section 3, we describe our methodology to evaluate a set of indicators from pedigree files. In Section 5 case studies are provided, and in Section 6 the experimentation performed so far is shown and discussed. Then, in Section 7 we expose some related work and, finally, we end the paper in Section 8 with some conclusions and future work.

Our starting point is the family information gathered in the very well-known standard that nowadays is one of the most used for pedigree information sharing: the GEDCOM format (GEnealogy Data COMmunication) [3]. This format consists of a header section, records, and a trailer section. Within these sections, records represent people, families, sources of information, and other miscellaneous records, including notes. In our case, the information we require is the family relationships and the people’s relevant medical data records such as if she is affected by a disease or has some results on a previously performed genetic test.

As shown in Fig. 1
                     , the representation of a GEDCOM file allows physicians to quickly understand the family structure and also the inherited factors on the members. Squares/circles represent males/females members of the family respectively; members in the same horizontal level belong to the same generation, horizontal lines between members in the same generation represents marriage relations, and vertical lines between members who belong to different generations represent parenthood and childhood relations. Regarding the individual information, a crossed line over the member means she is deceased; when the member is in black it means that she is affected by the illness, a plus next to the member means that the member has been genetically tested and has the disease causing mutation, a minus means the member does not have the mutation and nothing implies that he has not been tested correspondingly.

@&#METHODOLOGY@&#

With the information included in the pedigrees, we can extract information in the form of indicators and use them into a KBS to estimate the risk of suffering the illness. Several indicators can be defined, depending if we want to evaluate the family as a whole or at the individual level. In the former case, statistics-based indicators can be used, while in the second case, the value of an indicator assigned to an individual depends on its position on the family tree. Then, the structure of the family tree is important, and new, structure data-based methods are required. Regarding the interpretation of the family structure, an extension to the method is required to appropriately compute the indicators in complex pedigrees with multiple roots.


                     Fig. 2
                      shows the different indicators presented in this paper. They can be combined or not depending on the particularities of the medical application. All of the indicators can feed a medical KBS to support medical decision making, as presented at the end of this section.

Statistics-based indicators are the ones currently used by physicians and provide general information about the pedigree. They can be estimated without having any knowledge on the pedigree structure. We have considered three of them: the global affectation, the global mutation, and the global penetration indicator.

The global affectation indicator is one of the most basic statistic-based indicators, because it represents the probability of affected family members regarding the whole population (in our case, the family). The global affectation indicator A
                           
                              g
                            is formally defined as follows:
                              
                                 (1)
                                 
                                    
                                       
                                          A
                                       
                                       
                                          g
                                       
                                    
                                    =
                                    
                                       
                                          A
                                       
                                       
                                          T
                                       
                                    
                                 
                              
                           where
                              
                                 •
                                 
                                    A stands for the total amount of people who had or have suffered the illness.


                                    T stands for the total amount of family members in the pedigree (family) under study.

For example, suppose the pedigree shown at Fig. 3
                            composed by 10 members, two of them having developed the illness (members 4 and 7). Therefore, the global affectation indicator is A
                           
                              g
                           
                           =2/10=0.2).

The global mutation indicator estimates the probability of being a carrier of the mutated gene responsible of the disease, regarding the population. The global mutation indicator, M
                           
                              g
                            is defined as follow:
                              
                                 (2)
                                 
                                    
                                       
                                          M
                                       
                                       
                                          g
                                       
                                    
                                    =
                                    
                                       
                                          M
                                       
                                       
                                          T
                                       
                                    
                                 
                              
                           where
                              
                                 •
                                 
                                    M stands for the total of people who had or have mutated genes responsible of the inheritance disease.

Following the example of Fig. 3, in this case there are four family members who have been tested positive for the genetic predisposition (2, 4, 6 and 8), so the global mutation indicator is M
                           
                              g
                           
                           =4/10=0.4).

The global penetration indicator represents how aggressive is the specific mutation which affects the pedigree. Specifically, the global penetration indicator P
                           
                              g
                            informs about how many of the mutations have actually become an affectation. It is computed as follows:
                              
                                 (3)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          g
                                       
                                    
                                    =
                                    
                                       
                                          A
                                       
                                       
                                          M
                                       
                                    
                                 
                              
                           With this indicator, we can know how probable is that a carrier becomes an affected. Again, in the example of Fig. 3, there are four members who carry the responsible gene (members 2, 4, 6 and 8) but actually just two of them developed the illness (members 4 and 7), hence the global penetration indicator is P
                           
                              g
                           
                           =2/4=0.5.

Statistics-based indicators can be few discriminative, since they provide the same information to all of the members of the family independently of the branch of the family. Our proposal is to complement it with the structured data-based indicators.

Structured data-based indicators include information about the pedigree structure. This kind of indicators allows differentiating between members of two pedigrees with the same amount of affected and mutated members by considering where these mutations and affectations are and how are they related to the other members. The indicators are defined at individual and family levels, both, for affectation and mutation information. The former analyze the information concerning a single member of the family, while the latter aggregates the individual indicators for a given family.

This indicator defines the ratio regarding the amount of family members that are or were affected by the illness taking into account their relationships.

To estimate the inherited affectation indicator of a member of a pedigree we need two information pieces: the ancestor’s history and the indirect diversification factor. First, the ancestor’s history of a member δ(m) is based on the generation era: the oldest family member, the one at the top of the family tree, is assigned the era zero, his sons the era one, his grandsons the era two and so on. Then, δ(m) estimates the history of the healthy/affected ancestors of a node, according to the following equation:
                              
                                 (4)
                                 
                                    δ
                                    (
                                    m
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             era
                                             (
                                             m
                                             )
                                          
                                       
                                    
                                    
                                       
                                          state
                                       
                                       
                                          k
                                       
                                    
                                    ×
                                    
                                       
                                          2
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           where
                              
                                 •
                                 
                                    era(m) is the generation era of the m member.


                                    state
                                    
                                       k
                                     is 0 if the k ancestor of m is healthy; 1 otherwise

Marriages are managed as a unity; the healthy state of marriage node is computed as the worst case of the couple. It is no less worthy to observe that δ assigns the same importance to the information of the closer relatives than oldest ones. On the other hand, it is possible to handle relatives relevance by defining state
                           
                              k
                            as a function of the distance between relatives, for example, thus when ∣era(m)−
                           k∣ is large, then state
                           
                              k
                            is close to 0.

To illustrate this indicator, let us suppose the situation of Fig. 4
                           . The era values are shown at the left of the Figure. Members A to F are leaf nodes, while N1 to N5 are inner nodes with offspring. The ancestors of node A are: N4 (era 2), N2 (era 1), N1 (era 0). Since there is a single affected ancestor in the history of A, N1, the ancestor history of A is finally computed as δ(A)=(1×20)+(0×21)+(0×22)=1. Analogously, nodes B, D, and F have δ(B)=
                           δ(D)=
                           δ(F)=1, and the inner nodes δ(N4)=
                           δ(N2)=1. Leaf node C is also affected so its value is δ(C)=20
                           +22
                           =5. Node E is affected as well as its two first ancestors, therefore δ(E)=20
                           +21
                           +23
                           =11. Finally, node F is the same case as node E regarding their common ancestors but it is not affected, so the value is δ(F)=20
                           +21
                           =3.
                              Algorithm 1
                              
                                 A
                                 
                                    I
                                 (node,era,idf,delta) 
                                    
                                       
                                          
                                          
                                             
                                                1: if node is affected then
                                                
                                             
                                             
                                                2: 
                                                   newDelta
                                                   =
                                                   delta
                                                   +2
                                                      era
                                                   
                                                
                                             
                                             
                                                3: else
                                                
                                             
                                             
                                                4: 
                                                   newDelta
                                                   =
                                                   delta
                                                
                                             
                                             
                                                5: end if
                                                
                                             
                                             
                                                6: if node has offspring then
                                                
                                             
                                             
                                                7: 
                                                   indicator
                                                   =0
                                             
                                             
                                                8: 
                                                   
                                                      
                                                         newSegment
                                                         =
                                                         
                                                            
                                                               idf
                                                            
                                                            
                                                               offspring
                                                               
                                                               size
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                9: 
                                                   newEra
                                                   =
                                                   era
                                                   +1
                                             
                                             
                                                10: 
                                                   forall 
                                                   p in node’s offspring do
                                                
                                             
                                             
                                                11: 
                                                   indicator
                                                   +=
                                                   A
                                                   
                                                      I
                                                   (p,
                                                   newEra,
                                                   newSegment,
                                                   newDelta)
                                             
                                             
                                                12: 
                                                   end for
                                                
                                             
                                             
                                                13: 
                                                   return 
                                                   indicator
                                                
                                             
                                             
                                                14: else
                                                
                                             
                                             
                                                15: 
                                                   return 
                                                   newDelta
                                                   ×
                                                   idf
                                                
                                             
                                             
                                                16: end if
                                                
                                             
                                          
                                       
                                    
                                 
                              

Second, the indirect diversification factor represents how many times the precedence branch of a node has been split. The more a branch splits, the less value it has. To compute it, we assign a unitary length segment to the top node representing the tree root. Then the segment is split into equal sub-segments, one for each descendant node. The descendant nodes repeat this process (but just with the sub-segment they were assigned, not the whole 1-length segment) until the node under study is reached. The indirect diversification factor of a node, IDF(m), is computed as the length of his corresponding sub-segment.

To illustrate the IDF, an example is provided in Fig. 4. The top node (N1) has been assigned a 1-length line segment. Since it has two descendant nodes, those have a 1/2-length segment each one. Then, on the left tree branch (i.e., following down N2) there are three descendants, therefore the 1/2-length on the left is split into three 1/6-length segments; as C and D are leaves, then IDF(C)=
                           IDF(D)=1/6. Since the left node is still not a leaf, the 1/6-length is again split into two sub-segments attaching a 1/2-length line segment to nodes A and B (i.e., IDF(A)=
                           IDF(B)=1/12). The right tree branch proceeds in the same way, obtaining IDF(E)=
                           IDF(F)=1/4. In the example we can see how IDF is capturing the diversity of each branch in a reverse (indirect) relation, being lower in pedigree branches that have been split more times (A and B) than in branches that do not (E and F).

Finally, the inherited affectation indicator of a node A
                           
                              I
                           (m) is computed as a function of its ancestors δ(m) and its IDF(m). Inspired in grounded mathematical models [4], we have chosen the times function to combine both components, as follows:
                              
                                 (5)
                                 
                                    
                                       
                                          A
                                       
                                       
                                          I
                                       
                                    
                                    (
                                    m
                                    )
                                    =
                                    IDF
                                    (
                                    m
                                    )
                                    ×
                                    δ
                                    (
                                    m
                                    )
                                 
                              
                           
                           Algorithm 1 summarizes the method to compute the individual inherited affectation indicator.

The inherited mutation indicator represents the probability with which a concrete family member could inherit a mutation by considering her ancestors information.

Given a member m of the family, the inherited mutation indicator, M
                           
                              I
                           (m), is defined as follows:
                              
                                 (6)
                                 
                                    
                                       
                                          M
                                       
                                       
                                          I
                                       
                                    
                                    (
                                    m
                                    )
                                    =
                                    
                                       
                                          |
                                          MA
                                          (
                                          m
                                          )
                                          |
                                       
                                       
                                          |
                                          Anc
                                          (
                                          m
                                          )
                                          |
                                       
                                    
                                 
                              
                           where
                              
                                 •
                                 
                                    Anc(m) is the set of valid ancestors of m (see below).


                                    MA(m)⊆
                                    Anc(m) is the set containing all the family ancestors of m who have the mutated gene.

Physicians know how to explore appropriately the ancestors of a given member. After several interviews, we have acquired a set of rules to be applicable in the search of the ancestor of a given member. They are provided in Table 1
                           . A graphic example for each rule is provided in Fig. 5
                           . Then, the set of valid ancestors, Anc(m), is computed according to these rules.

For example, suppose we want know the M
                           
                              I
                            of the member 9 of Fig. 3. The immediate ancestors of 9 are 3 and 4. They trigger rule 7 condition (node 4 is female with positive testing, and father is unknown); thus node 4 is selected according to the rule’s consequent. Next, the ancestors of 4 are analyzed: 1 and 2. They trigger rule 7 again, and then the female 2 is selected. Since there is no more information about 2 ancestors, the bottom-up search is stopped. The set of valid ancestors carrying out information about the illness that can influence the member under study is Anc(9)={4,2}. Both ancestors have the mutation proved positive, so MA(9)={4,2}. Therefore, M
                           
                              I
                           (9)=2/2=1. Note then the difference between the statistics-based indicator regarding mutation obtained in the previous section M
                           
                              g
                            and the new value computed for the individual member 9.

Finally, there are two key issues that concerns the applicability of the rules. First of all, observe that the application of the rules provides the same values no matters on the uncertainty handled. That is, it is not the same to obtain some information when applying rule 1 (both parents have genetic tests performed) than when applying rule 11 (the genetic information of both parents is unknown). And second, different mutation could follow different inheritance patterns (mother and fathers), as well as aggressiveness; moreover, there could be multiple mutations in a single individual. Our proposal only considers a single mutation by individual, guided by breast cancer physicians that agree with the National Cancer Institute information [5]. Although there are other several genes (TP53,PTEN,STK11) associated with hereditary breast/ovarian tumors, the majority of hereditary breast cancers can be accounted for by inherited mutations in BRCA1 and BRCA2. Thus, we can say that the rules proposed here to handle mutations are illness-dependent, or mutation dependent. Several rule sets can be defined, one per mutation, and then the different results be combined under a probabilistic framework. Dealing with probabilistic models either to propagate uncertainty or to combine evidence from several mutations is out of the scope of this paper and requires further research.

Previous individual indicators can be applied to all of the youngest members of the family, representing the current generation, in order to obtain a family indicator, both, for the affectation and the mutation information. Moreover, they could be combined in a single indicator (family integration indicator) to assess about the risk of a family member to suffer the illness.

The family inherited affectation indicator, FA
                              
                                 I
                              , regards the information of the inherited affectation indicator of the youngest members of a family, i.e., of the leaves of a family tree. It is computed by aggregating the results of all the leaves, as follows:
                                 
                                    (7)
                                    
                                       
                                          
                                             FA
                                          
                                          
                                             I
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                ∀
                                                l
                                                |
                                                l
                                                
                                                is
                                                
                                                leaf
                                             
                                          
                                       
                                       IDF
                                       (
                                       l
                                       )
                                       ×
                                       δ
                                       (
                                       l
                                       )
                                    
                                 
                              And following the example of Fig. 4 we obtain the following results:
                                 
                                    
                                       
                                          
                                             FA
                                          
                                          
                                             I
                                          
                                       
                                       =
                                       IDF
                                       (
                                       A
                                       )
                                       ×
                                       δ
                                       (
                                       A
                                       )
                                       +
                                       IDF
                                       (
                                       B
                                       )
                                       ×
                                       δ
                                       (
                                       B
                                       )
                                       +
                                       IDF
                                       (
                                       C
                                       )
                                       ×
                                       δ
                                       (
                                       C
                                       )
                                       +
                                       IDF
                                       (
                                       D
                                       )
                                       ×
                                       δ
                                       (
                                       D
                                       )
                                       +
                                       IDF
                                       (
                                       E
                                       )
                                       ×
                                       δ
                                       (
                                       E
                                       )
                                       +
                                       IDF
                                       (
                                       F
                                       )
                                       ×
                                       δ
                                       (
                                       F
                                       )
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             12
                                          
                                       
                                       +
                                       
                                          
                                             1
                                          
                                          
                                             12
                                          
                                       
                                       +
                                       
                                          
                                             5
                                          
                                          
                                             6
                                          
                                       
                                       +
                                       
                                          
                                             1
                                          
                                          
                                             6
                                          
                                       
                                       +
                                       
                                          
                                             11
                                          
                                          
                                             4
                                          
                                       
                                       +
                                       
                                          
                                             3
                                          
                                          
                                             4
                                          
                                       
                                       =
                                       4.67
                                    
                                 
                              
                           

Given the individual inherited mutation indicators of all of the youngest members of a family, the family inherited mutation indicator consists on the addition of all of them, as follow:
                                 
                                    (8)
                                    
                                       
                                          
                                             FM
                                          
                                          
                                             I
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                ∀
                                                l
                                                |
                                                l
                                                is
                                                
                                                leaf
                                             
                                          
                                       
                                       
                                          
                                             M
                                          
                                          
                                             I
                                          
                                       
                                       (
                                       l
                                       )
                                    
                                 
                              
                           

At this point we have provided ways of estimating different indicators which give us information about the mutation state and the affection rate in the family tree structure. As in the case of the global indicators, both kinds of indicators can be combined to set up a family integrator indicator relating the mutations and affectations evolution of the individuals over the tree, which provide a better indicator for representing the disease spreading in a given branch of the family.

Our proposal is based on a weighted average operator [6], thus given the individual affectation and mutation indicators of a family, the family integrator, FI is as follows:
                                 
                                    (9)
                                    
                                       FI
                                       =
                                       f
                                       (
                                       
                                          
                                             FA
                                          
                                          
                                             I
                                          
                                       
                                       ,
                                       
                                          
                                             FM
                                          
                                          
                                             I
                                          
                                       
                                       )
                                       =
                                       α
                                       
                                          
                                             FA
                                          
                                          
                                             I
                                          
                                       
                                       +
                                       β
                                       
                                          
                                             FM
                                          
                                          
                                             I
                                          
                                       
                                    
                                 
                              where
                                 
                                    •
                                    
                                       α, β
                                       ∈[0,1] are weights expressing the importance of affectation and mutation correspondingly, and α
                                       +
                                       β
                                       =1.

Along this section, we have assumed that the pedigree has a unique root (see Fig. 1), but there are situations where the specific family member who is being considered for the study has information from both, mother’s and father’s ancestors, like E in Fig. 6
                         top. In this situation, a topological sorting solution is required. Topological sorting concerns the definition of the order in which nodes should be traversed in a complex graph.

In our case, instead of forcing a single list of ancestors, we propose the division of the multi-rooted pedigrees into single-root pedigrees like the ones we have been working until now, evaluate the indicators in each single-root tree, and provide the results as a range. The extremes of the interval are the maximum and minim values obtained.

In order to do that, we first select all the family members without ancestors (pedigree’s roots), and create from them new, single-rooted pedigrees. Obviously, we avoid the repetition of the same pedigree that could be created by selecting the husband and the wife of the same root. They are considered as a unique entry point to the pedigree. For example, if we look again at Fig. 6, we can see that we have four family members from the top pedigree’s roots. Since the four root candidates represent two marriages (two real roots), just one of them for each relation is necessary. Two pedigrees like the ones at the bottom of Fig. 6 are created.

Then the indicators are estimated for each individual pedigree and instead of providing a final value, a value interval is provided. By this means, we assert that the family members that are the common branch of the different pedigrees have at least the worst estimated value and at maximum the best one.


                     Fig. 7
                      shows the integration framework of the information coming from a pedigree tool to a KBS by means of the risk calculator, a software component which implements our indicators.

The risk calculator is implemented in Java, and can be used alone or provided as a plug-in for eXiT∗CBR [7], a tool for case-based medical diagnosis support. The GUI of the risk calculator is simple (see Fig. 8
                     ), so that the user provides the information about:
                        
                           •
                           The indicators to be computed.

The comma separated value (CSV) file with the list of the individuals to be analyzed.

The directory where the GED files are located.

The name for the results file.

When choosing the inherited mutation option, both family indicators introduced in this paper are calculated. The family integrator indicator is computed as a post process, if both, affectation and mutation are chosen, since it is derived from them.

As a result, the risk calculator outputs a CSV file where each row contain the indicators of the individual in the input list. To know which individual corresponds to which family or GED file, an identifier is required, that must be unique.

When other information about individuals is also available, then, indicators can be aggregated to the knowledge of a KBS, so that the KBS can take them into account to assess about the risk of suffering an illness, for example, and according to a given decision method. In our case, we have used a case-based reasoning methodology, but other approaches can also take advantage of the risk calculator.

Case-based reasoning is a methodology to build knowledge based systems based on past experiences. In short, an experience or case is composed by the problem description (i.e., patient data) and solution (i.e., prognosis). Thus a case-based system bases its reasoning on a case base. When a problem should be solved, or a query case is posed to the system, the system obtains the solution in a four stage process: retrieve, reuse, revise and retain [8]. In the retrieve stage, the most similar cases are retrieved from memory. Next, the solutions of the past cases are used to compound the solution of the query case (reuse stage). In the revise stage, the solution is validated (often by a human expert), and the decision about retaining or not the case in memory is performed in the retain stage. Several techniques can be used to implement the different stages. As for example, using a similarity function or another in the retrieval phase. Thus, several tools are available to developers to test the different case-based system that could be configured out for a given application. eXiT∗CBR [7] is one of them.

eXiT∗CBR requires cases be entered via a CSV file, each row representing a case, and each column an attribute (age, IMC, number of children, etc.). Thus, the indicators can be easily integrated in a case by considering them as another attribute of the individual (or case).

To facilitate the integration, the risk calculator has been integrated as a plug-in in the eXiT∗CBR tool. Thus, when selecting that plug-in, the case base is traversed from the beginning to the end, and by means of the cases identifiers, adding the selected indicator to all of the cases. When the GED file for a case is not found, the indicator value is set to −9, meaning “unkown”.

This section shows real examples of pedigrees appropriately modified as case studies to visualize the utility of the indicators introduced in this paper. The first examples are simple and have been artificially generated to demonstrate the benefits of using structured data-based indicators. Fig. 9
                      shows three times the same tree structure where changes among trees rely on the position where an affected node is detected. The node target of the study is at the bottom, and it is highlighted inside a dashed box. As Table 2
                      shows, statistics-based indicators do not change independently on who the affected node is. Conversely, the individual inherited indicators depend directly on where the affected node is placed in the family.

Second case study is provided in Fig. 10
                     . It shows a simple family tree (Fig. 10a) to which more nodes are gradually added (Fig. 10b and c). The node under study is highlighted inside a dashed box. The amount of mutated/affected nodes is not increased from one tree to the other.

As Table 3
                      shows, A
                     
                        g
                      and M
                     
                        g
                      indicators decrease their value quickly when more nodes are added. P
                     
                        g
                      is static because, as previously exposed, the amount of mutated/affected is not modified. Regarding the structured data-based indicators, A
                     
                        I
                      shows a similar behavior as A
                     
                        g
                      and M
                     
                        g
                     , but in this case, it decreases proportionally slower. In contrast, M
                     
                        I
                      does not follow the same pattern as the other indicators. The reason rely on the exploration rules applied (Section 3.2.2). Fig. 10a follows Rules 9 and 7 so they only explore the father and the grandmother of the specified node. Then, in Fig. 10b, both father and mother have no information about mutations (neither + or −) so both are explored following Rule 11, and Rule 4 is used when the grandfather is explored. Finally, in Fig. 10c, since both parents contain the mutated gene, Rule 5 is triggered and next, when exploring the grandparents, we use again Rule 11.

About the family inherited affectation indicator, we expect to behave similarly than the global indicators since they summarize the information of the whole family. Thus let us suppose the pedigrees depicted in Fig. 11
                     . The first pedigree, Fig. 11a, is a simple tree which has been modified so it does not include any of the genetic nor affectation information. Since it does not contain any trace of information, the results are zero for all of the indicators. In Fig. 11b, affectation information is included, so the global affectation indicator grows until a 0.39. Fig. 11c includes genetic information; therefore, the global mutation indicator is 0.22. If both are considered (Fig. 11d), the global penetration escalates until 1.75, which represents a high level of penetration given that there are more affected nodes than mutated. The case study of Fig. 11e consists in a highly complex multi-rooted pedigree. All of the global indicators obtained are summarized in Table 4
                     , together with the family inherited indicators. It’s easy to see the evolution of the values according to the cases and the mutated/affected elements introduced, as in the global indicators. The family integrator indicator F
                     
                        I
                      in this case has been estimated using α
                     =
                     β
                     =0.5 and, as can be seen, the value depends directly in the era where the affected node is detected.

@&#EXPERIMENTAL RESULTS@&#

In this section we present the experiments performed to show the benefits and limits of our methodology.

To test the benefits of our methodology we have used our breast cancer data which consists of 347 families (GED files).
                           1
                           Unfortunately the data is not public due to medical constraints. Any researcher interested can send an e-mail to the authors, to ask for permission to the medical staff.
                        
                        
                           1
                         Among all of the individuals, we have clinical information from 554 members to validate the results obtained; that is, we know if the individual has suffered or not the illness (155 and 399 correspondingly). To test the integration framework, we have additional clinical data from the individuals, concerning the age, gender, weight, height, and education. This information is provided in a CSV file.

Two experimental scenarios have been analyzed:
                           
                              •
                              Indicators alone, in which the information provided in the GED files are used to predict the illness. All of the indicators have been computed for the 554 individuals. Regarding the parameters of the family integration indicator they are set to 0.5 each (i.e., α
                                 =
                                 β
                                 =0.5 in Eq. (9)).

Integrated framework, in which the indicators are combined with other clinical data according to Fig. 7.

To measure the experiments we use the confusion matrix and the true positive and true negative rates that can be derived from it. The confusion matrix relates the number of false positive (FP, healthy people detected as ill sufferers), false negatives (FN, ill sufferers predicted as healthy), true positives (TP, ill sufferers predicted correctly) and true negatives (TN, healthy people with right prognosis). The true positive (tp) rate relates the number of ill sufferers detected with the indicators regarding the total of known patients (i.e., TP/(TP+FN)); the true negative (tn) rates the number of individuals with indicators given zero information with all healthy people (that is, TN/(TN+FP)).

Next, the tp-rate and fp-rate (FP/(TN+FP) are plotted in a receiver operating characteristic (ROC, [9]). This is a graphical plot which shows the performance of a binary classifier as a threshold is varied from 0 to 1. In our case, the KBS classifies persons into two groups: having or not having risk of suffering an illness. Moreover, the threshold is related to the ratio of past cases supporting the evidence (reuse step of case-based reasoning), that we vary from 0 to 1, obtaining different tp and fp-rate for each value. The tp-rate is plotted in the Y-axis and the fp-rate in the X-axis, so that the resulting graph depicts relative trade-off between benefits (true positives) and costs (false positives). The ideal result would be the one with a threshold in which TP=1 and FP=0. The quality of the classifier could also be measured by using the area under the curve (AUC) value of the ROC. An ideal classifier would have an AUC of 1.


                        Table 5
                         provides the results obtained. Analyzing the results, we observe that the global affectation indicator is not able to discriminate between patient suffering the illness and healthy people, labeling all members as possible candidates for suffering the illness. The individual inherited affectation indicator is able to discriminate up to 83.23% of the ill people; although the tp-rate does not achieve the 100% and this is a costly situation. An interesting result is the family inherited affectation indicator that results in an equivalent behavior than the global affectation indicator, as could be expected, since it covers all members of the family.

Regarding mutation, it is a weak indicator for illness risk assessment, as some physicians anticipate. There are a lot of people that could have a given mutation but it is not a definitive factor for developing the illness.

However, it is important to highlight the fact that the individual indicator (M
                        
                           I
                        ) reach up to the 91.98% for tn-rates, outperforming the global indicator in almost the double. Analyzing in detail mutations, we know that there were 36 proven mutations in the family tree; the global mutation indicator identifies 249 possible individuals who can have the mutation, close to the family inherited mutation indicator (240), while the individual inheritance only 60, thanks to the inheritance rules designed. So the rules seem to play a key issue on appropriately assigning mutation risks to individuals.

Concerning the FI index, the results show that it is dominated by the FA
                        
                           I
                         index, that is, FI depends on both, the family affectation (FA
                        
                           I
                        ) and mutation (FM
                        
                           I
                        ) indicators. The former varies from 0.15 to 17.0; while the latter from 0 to 7.17. Therefore, the scales in which they are defined are not comparable and their combination requires further research.

Finally, it is important to highlight that those indicators represent a first step towards the automation of the evaluation of the information stored in pedigrees, so that they can be available to be combined with other clinical data in order to achieve more accurate prognosis.

In this section we analyze how the information processed thanks to our methodology could be used in a KBS. Particularly, we used case-based reasoning to implement the KBS. Cases are composed by the clinical data. Then, several tests have been carried out with different case bases: one without any indicator, and the others have been enhanced with the information coming from an indicator (there are as many case bases as indicators, plus the plain one). Fig. 12
                         depicts the results for comparison. P
                        
                           g
                         has been omitted for clarity as giving the same results than M
                        
                           g
                        .

In the Figure, it is possible to observe that the worse results are obtained when no indicators are used. In this regard, we need to say that the information provided is quite poor to perform a prediction on the patient, but it serves to explain the benefits provided by the indicators, which enhance the information and achieve better outcomes. The AUC value for each experiment is given in Table 6
                        . Observe that the experiment with the best results is the one including the FMI index, meaning that thanks to our methodology mutation handled in an inheritance way (instead of statistic) can provide useful knowledge for KBS.

@&#RELATED WORK@&#

There are some methods that deal with inheritance information due to the interest of evaluating the disease risk factors by the aggregation of cases (i.e., persons suffering the illness). However, most of the works concerns the use of pedigree information in order to determine features of a particular population under study. In [10], for example, several approaches are studied to determine the right number of contributions that should be considered from the ancestors in a given population. Most of the analyzed methods are based on the inverse proportion to the addition of the square of all of the features under study. Our approach also takes into account this inverse proportion, but in this case, instead of using the square, we exponentially modify the information according to the distance of the ancestor to the current population.

Another interesting work is [11] that apply aggregation methods to evaluate cardiological risks taking into account fathers/soon exponential relationships. Our proposal also includes an exponential relation, but taking into account the complexity of the whole family, which includes hierarchical relationship of different generations, and different family trees as a consequence of marriages. Thus, our work contemplates different sources of risks, depending on the different paths that can be followed in a graph-representation of the family.

The most interesting insight of the [11] work is how the combination of the different induced information from the same pedigree can be performed. In particular, the authors propose several functions to combine risk and incidence factors. Thus, we leave for a future work to use this kind of aggregation methods, as well as other methods coming from the veterinarian field [12] and decision theory [6].

Regarding breast cancer diagnosis BRCAPro [13] also deals with the problem of analyzing ancestors in order to find a possible mutation. BRCAPro is limited in depth, analogously to the case of [11], but in this case up to 2 degrees of relationships are allowed (grandfather/mother, father/mother and son). BOADICEA [14] and Tyrer–Cuzick [15] are similar-purpose tools.

An interesting work is [16] which describe the complexity of deriving the individual risk from the population risk. Particularly the authors comment three factors to take into account: having a family history or not, contribution of the population model in the family predisposal, and how environmental risk factors affect individuals. Based on these factors, the authors propose a mathematical model to obtain individual values. Our work is related to provide support to such kind of mathematical models; in this first work, we are proposing the measure of the information contained in the family, but as a future work, more complex models as the ones proposed in [16] or [17] that merge population (statistics) models should be contemplated.

Finally, it is important to note that current pedigree tools, as PyPedal [18] are including different methodologies to analyze the data included, so as to summarize, as for example in the case of PyPedal, in eight different measures (similar as the ones previously related). Then, we should expect in a future that thus tools also incorporate the facility of analyzing pedigrees according to user-provided methods, or domain-dependent methods. Our method could be one of them.

@&#CONCLUSIONS@&#

The need of dealing with pedigree analysis is a must when dealing with inherited illnesses. However, most of the approaches to interpret data on family histories are statistics based on the number of individuals in the family instead of their relationships. In this work we presents a new way of computing family risk based on indicators that takes into account the structure of the family, as physicians use to do.

We provide a methodology based on three statistics-based indicators (global affectation, global mutation, and global penetration indicators), plus five structured data-based indicators (individual inheritance mutation, individual inheritance affectation, family inheritance affectation and mutation, and family integration indicators). To establish relationships among family members, a rule-based algorithm is provided for simple pedigrees (tree-like structures), while an interval based solution is provided for more complex situations (graphs due to second marriages, etc.).

We have illustrated our methodology on several case studies. Moreover, our method has been implemented and integrated in a case-based reasoning tool that supports medical decision making. The experimentation has been carried out in a breast cancer diagnosis domain, showing that the inheritance information computed with our indicators can be more discriminative than statistics approaches.

Having a way to compute indicators, the next step of our research is to discuss the results with physicians to enrich our methodology. This future work comprehends the combination of statistics and structured data based indicators (we have only tackled combinations among structured data based indicators). Our ultimate goal is to provide to the physicians with a powerful tool that supports their decision making taking into account the interrelationships among population values and individual information, that it is still an open problem.

@&#ACKNOWLEDGMENTS@&#

We would like to thank Judith Sanz and Joan Brunet for their assessment on pedigree information. This research has been partially supported by Spanish Government Project MoSHCA (Ref. IPT-2012-0943-300000, EUREKA ITEA2 11027), and Grants FPU-AP2009-2831 and UDG-BR10/18.

@&#REFERENCES@&#

