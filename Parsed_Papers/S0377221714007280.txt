@&#MAIN-TITLE@&#Formation of a strategic manufacturing and distribution network with transfer prices


@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Decision support model for location, production, shipping and pricing decision.


                        
                        
                           
                           Intuitive and efficient decomposition procedure to solve the model.


                        
                        
                           
                           Computational experiments to illustrate the potential valuable guidance the model can provide to a firm's supply chain design strategic planning process.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Supply chain network design

Transfer pricing

Decision support systems

Logistics

Production

@&#ABSTRACT@&#


               
               
                  We propose a profit maximization model for the decision support system of a firm that wishes to establish or rationalize a multinational manufacturing and distribution network to produce and deliver finished goods from sources to consumers. The model simultaneously evaluates all traditional location factors in a manufacturing and distribution network design problem and sets intra-firm transfer prices that take account of tax and exchange rate differentials between countries. Utilizing the generalized Benders decomposition approach, we exploit the partition between the product flow and the cash allocation (i.e., the pricing and revenue assignment) decisions in the supply chain to find near optimal model solutions. Our proposed profit maximizing strategic planning model produces intuitive results. We offer computational experiments to illustrate the potential valuable guidance the model can provide to a firm's supply chain design strategic planning process.
               
            

@&#INTRODUCTION@&#

The process of establishing a new manufacturing and distribution network or significantly modifying an existing supply chain represents a major challenge for both new or established firms alike. The global dimensions of 21st century business where sourcing, manufacturing and marketing options often exist worldwide compound the complexity of this problem. Consider a firm that wishes to establish a new manufacturing and distribution network (supply chain) to source, make and deliver a product or set of products to an international marketplace. To weigh its options, the firm must first evaluate a set of potential supply chain alternatives from a very high level, strategic vantage point. Then in the supply chain network design process, the firm will consider all traditional supply chain operations factors such as sourcing, manufacturing and distribution costs and capacities, and all freight, duty and tax costs. Additionally, the firm will incorporate the potential impact of exchange rates and intra-company internal prices between different countries and entities on this network. In this paper, we study this decision making process by evaluating all pertinent operational costs and capacities, as well as the impact of exchange rates and tax rates on profits in establishing a global manufacturing and distribution network.

To facilitate a quantitative perspective on this complex decision, we propose a mathematical optimization model that provides decision support and guidance on constructing a supply chain network from a wide assortment of sourcing, manufacturing, and country alternatives. Briefly, our modeling approach allows a firm to develop a set of major production and distribution activities (echelons) that will collectively comprise a complete supply chain from original sourcing locations to final market demand points. The firm can identify and propose as many alternative production and distribution activities as desired. Once the firm identifies all potential activities, the mathematical model generates the optimal supply chain to satisfy the market demand forecast and maximize the firm's profits (i.e., the model creates a comprehensive sourcing, manufacturing and delivery network). Plans generated by the model include a description of how the selected production and distribution activities collectively link together to form this supply chain, as well as the projected output levels of, and flows between all links on the network.

The model alsoconsiders the fixed cost of providing support services, for example, any access roads and loading or unloading capabilities that a firm may have to develop. Additionally, the model projects the optimal internal prices between the firm's affiliates in individual countries as they ship the intermediate products and finished goods across the supply chain to the ultimate market destination. Commonly referred to as a transfer price, the internal price is an instrument that the firm utilizes to manage its internal markets, coordinate decisions of autonomous subordinate divisions (often called affiliates), and track division performance. The internal transfer price is typically determined by using the actual cost of producing the product as a base, and then adding a markup or profit margin to this base to derive the intra-company selling price from one affiliate to another. The actual cost plus a markup is a natural choice to employ as the intra-company price because a market price often does not exist at intermediate stages of production and distribution. Through transfer prices, the firm not only can allocate global profits to its affiliates in producing countries, but also control where affiliates buy their intermediate products. The model's profit maximization methodology also incorporates the impact of exchange rates and local tax rates on the global profit of the firm as calculated at its home office (i.e., country of registry). Thus, our model integrates traditional supply chain network location design decisions with multi-national, corporate intra-company (i.e., inter-affiliate) pricing decisions.

In this study, we formulate the above problem as a mixed integer nonlinear programming (MINP) model. We develop a heuristic procedure to solve the problem. The procedure uses a Benders decomposition-based solution method. Our choice of Benders decomposition is motivated by an observation that there are two distinct but related decisions in our problem, namely the product flow and cash allocation decisions in the global supply chain. Specifically, the product flow pertains to the production and shipment of intermediate products between producing countries and the delivery of finished products to satisfy market demands. The cash allocation decision allocates the revenues to plants (i.e., affiliates) to meet all their costs and also provide them their operating profits. Such a problem structure naturally leads to a primal decomposition scheme which was originally developed by Benders (1962) to solve a linear program and extended by Geoffrion (1972) to solve a non linear program. Here we use Geoffrion's generalized Benders decomposition.

To evaluate the efficacy of our solution algorithm, we conducted a computational study of our model utilizing simulated and actual data based on the authors’ experience working with several firms. This study evaluates the performance of our solution procedure and investigates through sensitivity analysis the impact of factors such as currency depreciation, a reduction in the global production capacity, and high demand variability on the supply chain network design and transfer pricing solutions of the model.

Our study of numerous decision scenarios showed the supply chain formed by the profit maximization model was fairly robust under mild changes in the decision environment, and that the optimal transfer prices adjusted to those changes appropriately. Also, we compared the profit maximization solution that our model develops with the cost minimization solution.
                        1
                     
                     
                        1
                        Traditionally a supply chain network design problem is formulated as a cost minimization problem.
                      We found that large currency depreciations, capacity reductions or variability in demand can significantly impact the optimal design of the supply chain networks that are formed (when a profit maximization rather than cost minimization methodology is employed).

We now consider how the model proposed in this paper fits into the firm's overall planning process. As noted, we construct this model to provide decision support to the initial planning efforts of a firm wishing to establish a new supply chain. Alternatively this model could also support analyses of the impact of planned major revisions to an existing supply chain. The mathematical formulation of the Manufacturing and Distribution Network (MDN) model presented in this study reflects the intended “preliminary planning”, high level strategic role of this model. For example, we do not explicitly model individual production lines at potential plants or sources. Instead in this model, manufacturing capabilities are modeled as production activities that have a total output capacity, as well as fixed and variable costs associated with this capacity. These production activities can be pieced together to form a complete supply chain. Fig. 1 illustrates this model's strategic role and how it fits into the overall manufacturing and distribution planning framework. Note that at this stage of the planning process, firms typically consider many locations and geographies before determining both the eventual sites for their new facilities and the transportation links which will connect sources, plants and DCs. Our model facilitates the flexibility required at this stage of the decision-making process.

Once a firm determines the exact construction of its supply chain (using the MDN model), the firm would need to utilize more detailed planning models to support additional strategic and tactical planning activities. For example, the Global Profit Maximization (GPM) model described in Miller and De Matta (2008) explicitly models production lines (both their individual costs and capacities), as well as inventory levels by product family and location. The GPM model generates an integrated, detailed global production and distribution plan at the production line, plant and distribution center level. Thus, a firm can employ the GPM model in its more detailed strategic and even tactical (12–24 months) planning exercises. In contrast, the role of the MDN model formulated in this paper precedes the role of the GPM model, and the MDN model cannot and should not be used to formulate line level production plans for plants. To summarize, the MDN model assists in the process of developing new or significantly revised supply chain networks, and then other models that capture the network's operations in more detail would takeover to assist the more mature strategic and tactical planning processes (see the next section for other structural differences between GPM and MDN models).

@&#SUMMARY@&#

The contributions we will present in this paper are three fold: first, we offer a novel formulation of a supply chain network design model that a firm can utilize to optimally integrate manufacturing and distribution location and capacity decisions with transfer pricing decisions; all while simultaneously accounting for local country tax and exchange rates. Secondly we show how an additive price markup for setting transfer prices and revenue allotments to markups can be incorporated in a profit maximization supply chain network model. This contribution, to our knowledge, is absent in the existing supply chain optimization literature. Third, utilizing the generalized Benders decomposition approach, we demonstrate how to capitalize on the natural partition between the product flow and cash allocation decisions in the global supply chain to find model solutions.

Our model can be imbedded in a decision support system to help a firm with global operations design a supply chain that will generate increased profits and reduced tax liabilities. From the authors’ collective experience working with firms whose global operations span across multiple countries, this model offers a significant improvement over current approaches that frequently use spreadsheets for network design and pricing decision support.

The remainder of this paper is organized as follows: Section 2 reviews literature relevant to the model we propose; Section 3 describes the model; Section 4 provides the model formulation; Section 5 presents our solution procedure; Section 6 presents potential insights that our global profit maximization model can provide and investigates the performance of our solution procedure; finally Section 7 provides our concluding remarks.

In this section, we review selected literature on strategic planning models that integrate traditional supply chain design variables such as manufacturing, distribution and freight costs and capacities, with transfer prices, exchange rates and local taxes. To begin, we note that the major body of related literature on the management of a global supply chain of production plants either does not explicitly address transfer prices, or essentially considers transfer prices as given. For instance, the seminal work of Huchzermeier and Cohen (1996) gives a stochastic dynamic programming model formulation for the valuation of global manufacturing strategy options with switching costs. They determine the value of operational flexibility to be the difference between the option where no switching in supply chain production and distribution strategy is allowed and the firm's optimal discounted, expected global after tax profit or loss for each of the other options available. More recent studies of Goetchalckx, Vidal, and Dogan (2002) and Hammami, Frein, and Hadj-Alouane (2009) set transfer prices based on available market prices for existing intermediate products and finished goods. However, when market prices are not available for new products, the actual marginal cost of production as measured by the firm's accounting system can be used. Sometimes profit is added to this marginal cost which is taxed at different rates depending on the country where the plant is physically located. Because the transfer price influences where an affiliate buys the intermediate product, it can be an important factor in the formation of the supply chain network. Here we assume market prices are nonexistent (i.e., our firm does not sell its intermediate products to external firms).

Given a set of potential suppliers, manufacturing facilities, distribution centers and customers, Goetschalckx et al. (2002), Hammami et al. (2009), Miller and de Matta (2008), Peron et al. (2010), Villegas and Ouenniche (2008) determine the configuration of the production distribution system and transfer prices between corporate subsidiaries such that customer demand and requirements are met and corporate profits are maximized. Similar to our work, the aforementioned papers also demonstrate the savings potential of integrating in a profit maximizing model the design of strategic global supply chain networks with the determination of production distribution allocations and transfer prices. Like the model in Hammami et al. (2009), our model automatically recognizes that only positive profits are taxed. In contrast, Goetschalckx et al. (2002) and Peron et al. (2010) assess the losses in a problem preprocessing step and compute the Net Income After Tax (NIAT) depending on four disjoint cases relating NIAT with transfer pricing between two plants. NIAT in our model is simply the tax rate times the difference between the accumulated operating revenue and production and shipment cost. The model in Miller and de Matta (2008) avoids dealing with losses by using average unit costs and setting the profits as a percentage of these costs. Villegas and Ouenniche (2008) present an unconstrained optimization model where the total repatriated earnings of divisions to central headquarters are maximized. In their study, divisions that can achieve economies of scale are assumed to have a convex average unit production cost function. They show how transfer prices coordinate the decisions of partially decentralized divisions.

Optimization papers in the existing operations management literature that use the actual marginal cost of production of transferred goods in transfer pricing for centralized supply chain planning are hard to find. Miller and de Matta (2008) in a broad survey of the literature reveal that this method of transfer pricing is studied extensively in the managerial accounting literature, but not in the context of network optimization in the supply chain. They incorporate this method in their network optimization model specifically by expressing the transfer price as the marginal cost plus a multiplicative price markup which expresses profit as a percentage of the production cost. The markup structure yields a non linear model which is extremely difficult to optimize. In this paper, we utilize an additive price markup where the margin is a fixed amount that is added to the plant's production cost. Evidence of the use of the additive method appears in a 1984 survey of Fortune 500 companies which reveals that about 45 percent of companies maintain two pieces of information at each stage of the intra-company supply chain: the cost and markup (see Price Waterhouse, 1984). The result is also a non linear model, but with a special structure which can be exploited in developing a generalized Benders decomposition solution procedure (see Geoffrion, 1972) to find near optimal solutions.
                        2
                     
                     
                        2
                        Based on the authors’ experience in private industry, it is quite common practice for firms to use both markup “quantity” approaches (i.e., additive targets), as well as multiplicative approaches. For example, a firm may begin its planning process with a general percentage range of what it considers to be acceptable profit margins. Then based on market conditions, costs and other factors, the firm will eventually select a specific unit margin to add to its cost per unit. Therefore, additive and multiplicative models both have relevance for real world planning.
                     
                  

Both ourmodel and the Goetschalckx et al. (2002) model enforce the arms length restrictions which require a plant to charge the same price on every unit that it ships. While Goetschalckx et al. consider solutions with 10 percent difference in arms length transfer prices acceptable, our transfer prices in contrast strictly satisfy the arms length requirement. Our model has one single product, but can be extended easily to consider multiple products and multiple transportation modes.

The global profit maximization model of Miller and de Matta (2008) develops integrated strategic and tactical plans for a global supply chain network with a single production echelon. The models of Goetschalckx et al. (2002) and Hammami et al. (2009) have two production echelons. Here we focus on a firm with an elongated manufacturing and assembly supply chain, i.e. multiple production echelons producing products with various levels of completion. Unlike the Goetschalckx et al. (2002) and Peron et al. (2010) models, we present a model which can be easily adapted to solve problems with expansive bills of materials. Our model is similar to the Lakhal (2006) model, but the difference lies in that we consider the divisions as affiliates, i.e. firm owned, while Lakhal (2006) assumes independent firms forming manufacturing alliances. Specifically, our firm plans to establish a supply chain with spatially separated manufacturing and assembly operations assigned to several different countries. Similar to the Hammami et al. (2009) which considers technology selection when transferring certain production activities from developed to developing countries, the plants located in different countries in our model have processes of various vintages and levels of efficiency to select from. The distinction lies in that the Hammami et al. (2009) model includes how to finance the investment in technology. This financing decision is present also in the supply chain models developed by Nickel, Saldanha-da-Gama, and Ziegler (2012) and Longinidis and Gorgiadis (2011). The interest rates on loans can impact capital investments in those countries, but in our strategic planning model we assume costs are fixed over a single “amortized” planning period.
                        3
                     
                     
                        3
                        As is often done in strategic single period facility location models (e.g., see Miller, Friesz, and Tobin, 1996), we account for one-time major capital investments such as building manufacturing plants by amortizing the one-time fixed investment costs over the defined strategic planning horizon. The length of the planning horizon varies by firm, but typical criteria include the expected life of a facility, the number of years a firm plans to depreciate a facility over, required payback periods, and so on.
                      However, we consider the allocation of profits to selling divisions which can be a form of incentive to division managers to improve the efficiency of the production process by making discretionary investments.

Since our work in this paper focuses more on long-term strategic manufacturing and distribution decisions and less on short term period-by-period tactical and operational decisions, we assume that exchange rates are known in our model. For shorter-run level decisions, operational hedging may be necessary to minimize losses from exchange rate fluctuations. Related literature on tactical level decision models which account for exchange rate uncertainties can be found in Huchzermeier and Cohen (1996), Kouvelis and Gutierrez (1997), Kouvelis (1999), Sceller-Wolf and Tayur (1999), Kazaz et al. (2005) and Villegas and Ouenniche (2008). In contrast, for strategic planning purposes, to evaluate the sensitivity of long-term global plans to exchange rate variations, a firm utilizing our model would run multiple scenarios (i.e., separate model runs) with different assumptions on exchange rates. Here we run the model several times to study how the formation of a supply chain is impacted by variations in global currencies, production capacities and demands.


                     Shunko and Garvirnneni (2007) study how global firms can jointly leverage tax and cost differences through coordinated transfer pricing and off shoring decisions. They suggest that a fully centralized strategic planning approach works best for a multi-national, global firm when the tax differentials between its affiliate countries are large. However, when the tax differentials between a firm's affiliate countries are relatively small, they argue that a more decentralized approach which takes advantage of local cost information, and which allows more localized transfer pricing decision-making may lead to better decisions and higher profits. The model we propose in this paper is designed to provide decision support to a multi-national firm that makes centralized network location and transfer pricing decisions. Table 1 summarizes our survey of the relevant literature and our contributions.

In this study, we consider a firm that plans to establish a manufacturing and distribution network for intermediate (semi-finished) and finished products. The firm produces a single product
                        4
                     
                     
                        4
                        When a mix consisting of different products is produced from a facility, the output rates of the various products are converted to a common unit of output.
                      and for simplicity, we assume a unit of output at each facility requires a unit of input.
                        5
                     
                     
                        5
                        We note that our model can be easily adapted to problems with more expansive bill of materials.
                      We consider the intermediate products to be proprietary goods for which there are no close substitutes on external markets, and they are not sold to outside parties. The potential manufacturing plants and distribution centers (DCs) at selected country locations are subsidiaries or affiliates of the firm. Further, the different manufacturing and DC locations are physically located overseas in countries with different tax rates on profits.

Plants ship intermediate and finished products around the world. These flows include domestic shipments where a plant in a country delivers finished goods to a DC in the same country, e.g., a United States (US) plant ships to a US DC. DCs receive finished goods from plants and then subsequently ship products to the firm's external customers.  This flow from the DC to the external customer represents the actual sale by the firm to its paying customers.

The price or value of a unit of product increases as it moves through the network.  A plant ships a product to another country at an agreed upon price.
                        6
                     
                     
                        6
                        Note that in the case of a domestic (i.e., within country) plant to DC shipment, there is typically no selling price.
                      This price, at the minimum, includes the cost of production, as well as a markup on the production cost of the producing plant (country).  It typically includes additional cost components such as the variable administrative overhead. Finally, the transfer or intra-company price that a plant charges the local affiliate to which it delivers the product also includes a markup or profit margin.

After it acquires the finished product at an intra-company transfer price, the DC then sells this product to an external customer at the local selling price. The selling price is an exogenous, pre-determined value. The difference between the DC's acquisition price and its selling price consists of the distribution, sales, and other costs of the DC, as well as profits from sales.

Finally, the firm recognizes and evaluates the local taxes paid on the profits recorded by the plant selling an intermediate product to another plant or DC, and on the profits generated by the DC selling to the external customer.  The firm also utilizes the appropriate exchange rates between affiliates and the home country of the firm to project the total global profit.

We formulate the problem as a single period deterministic model. The fixed cost
                        7
                     
                     
                        7
                        As previously discussed, we amortized the fixed costs to facilitate a single period model as is often done in the traditional plant location model.
                      to build the service links and/or facilities needed to conduct production activities in certain countries is known as well as the transportation cost between locations (i.e., as part of the strategic planning process, the firm has evaluated these costs). We assume the firm's affiliates are legally separate entities and taxation occurs at the source. Therefore the tax liability of each affiliate is determined by its taxable income. We also consider the exchange rates between countries to project the total global profit of the firm. We assume that the plant or affiliate in every country can be assigned one or more production activities (echelons). Moreover, the finished product can be sold in every country. The assignment of production activities to plants in every specific country, as well as the markups on these production activities are decision variables. Finally, we assume capacitated plants, and uncapacitated shipments and DCs.
                        8
                     
                     
                        8
                        Additional shipment and DC capacities usually can be acquired in relatively much shorter term than plant capacity.
                      We now formulate the problem using the following notation. Let

                        
                           
                              m =
                           
                           number of value adding production activities (echelons). The activities are performed in a sequential order from 1 through m.
                           

the total number of countries with plant subsidiaries that can perform the production activities and/or which are potential markets for the finished products.

index on the production activity, i = 1, …, m.

predecessor of activity i, i = 2, …, m.

index on country, j = 1, …, n. Our model also utilizes the indices ℓ and k to represent a country.

The problem parameters are:

                        
                           
                              aij
                               =
                           the capacity usage of activity i in country j to produce a unit of output. For simplicity we assume aij
                               is independent of the destination country.
                                 9
                              
                              
                                 9
                                 Note that when destination plants require additional processing in country j, then the aij
                                     s can vary with the destination country.
                              
                           

the maximum available capacity in country j for activity i.

variable production cost per unit of activity i in country j. It includes the cost of direct material, labor and overhead.

the annual amortized fixed costs of opening or establishing and configuring the production facility in country j. Also the cost to build facility and service links to support any production activity in country j. This includes general services and administration (i.e., overhead) of the plant in country j.

fixed production cost of plant in country j to perform activity i. Also represents the annual one-time amortized cost that may be associated only with a particular production activity i not included in fj
                              .

unit shipment cost of intermediate and final outputs of plant's production activity i in country j which is shipped to country k.
                              
                                 10
                              
                              
                                 10
                                 Includes both actual freight costs, insurance on freight, and all appropriate duties, customs and other related costs.
                              
                           

the tax rate (percent) levied on profits recorded in country j.
                           

the exchange rate between country j and the country where the firm is registered (i.e. the country of registry where the multinational corporation is based for global earnings reporting purposes). Note that ej
                               = 1 in the firm's home country.

the exogenous market price of finished products in country j after deducting the DC's distribution and sales expenses.

the exogenous market demand for finished product in country j.

the aggregate market demand, i.e. 
                                 
                                    D
                                    =
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       d
                                       j
                                    
                                    .
                                 
                              
                           

the minimum percentage mark-up allowed when the plant in country j exports the intermediate or finished products of activity i to another country.

the maximum percentage mark-up allowed when country j exports intermediate and final outputs of activity i to another country.

The decision variables are:

                        
                           
                              Xijk
                               =
                           the amount of intermediate and finished products produced by activity i in country j and shipped to country k.
                           

the tax on the plant's net profit in country j.

1, if country j is selected as a plant location.

0, otherwise;

1, if plant in country j is assigned activity i,
                           

0, otherwise;

total (dollar) markup of intermediate and finished products produced by activity i in country j which are shipped to country k.
                              
                                 11
                              
                              
                                 11
                                 Markups on cost create profit margins and profits. These markups occur at the point of shipment (sale) from the producing country to the receiving local affiliate. Note that on a domestic, “within” country plant to plant/DC/local affiliate shipment, there is typically no markup.
                              
                           

the plant's total (dollar) cost of acquiring intermediate inputs (which include any importation costs and tariffs) and the plant's cost of production activity i to transform those inputs into semi-finished or finished product in country j which are shipped, distributed and sold to country k. Note the cost of goods sold in country j is the cumulative plant production costs and markups (excluding outbound shipment costs to country k).

the slack variable 
                                 
                                    S
                                    j
                                    +
                                 
                               representing the residual profit and 
                                 
                                    S
                                    j
                                    −
                                 
                               representing the residual loss from the distribution and sales of finished products in country j.
                           

annual variable contribution from production, distribution and selling in country j (i.e. annual profit contribution before fixed costs are accounted for).

The problem formulation is as follows:

Problem (P):

                        
                           (1)
                           
                              
                                 
                                    M
                                    a
                                    x
                                    i
                                    m
                                    i
                                    z
                                    e
                                 
                                 
                                 
                                 
                                 Z
                                 =
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    
                                       e
                                       j
                                    
                                    
                                       (
                                       
                                          A
                                          V
                                          
                                             C
                                             j
                                          
                                          −
                                          
                                          
                                          
                                          
                                             f
                                             j
                                          
                                          
                                             Y
                                             j
                                          
                                          −
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             
                                                g
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                V
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                          −
                                          
                                             U
                                             j
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     s.t.

                        
                           (2)
                           
                              
                                 
                                    U
                                    j
                                 
                                 ≥
                                 t
                                 a
                                 
                                    x
                                    j
                                 
                                 
                                    (
                                    
                                       A
                                       V
                                       
                                          C
                                          j
                                       
                                       −
                                       
                                       
                                       
                                       
                                          f
                                          j
                                       
                                       
                                          Y
                                          j
                                       
                                       −
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          m
                                       
                                       
                                          
                                             g
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             V
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 ∀
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    V
                                    
                                       i
                                       j
                                    
                                 
                                 ≤
                                 m
                                 
                                    Y
                                    j
                                 
                                 ,
                                 
                                 ∀
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    
                                       a
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       X
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                                 ≤
                                 
                                    q
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    V
                                    
                                       i
                                       j
                                    
                                 
                                 ,
                                 
                                 ∀
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 
                                 ∀
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 ,
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      X
                                                      
                                                         1
                                                         j
                                                         k
                                                      
                                                   
                                                   =
                                                   D
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   X
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                =
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   
                                                      X
                                                      
                                                         p
                                                         (
                                                         i
                                                         )
                                                         k
                                                         j
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   j
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   n
                                                   ,
                                                   
                                                   ∀
                                                   i
                                                   =
                                                   2
                                                   ,
                                                   …
                                                   ,
                                                   m
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   X
                                                   
                                                      m
                                                      k
                                                      j
                                                   
                                                
                                                =
                                                
                                                   d
                                                   j
                                                
                                                ,
                                                
                                                ∀
                                                j
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                ,
                                             
                                          
                                       
                                    
                                 
                                 }
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    COST
                                    
                                       1
                                       j
                                       k
                                    
                                 
                                 =
                                 
                                    c
                                    
                                       1
                                       j
                                    
                                 
                                 
                                    X
                                    
                                       1
                                       j
                                       k
                                    
                                 
                                 ,
                                 
                                 ∀
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 
                                 ∀
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                              
                           
                        
                     
                     
                        
                           (7)
                           
                              
                                 
                                    
                                       
                                          COST
                                          
                                             i
                                             j
                                             k
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                X
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      ℓ
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   X
                                                   
                                                      i
                                                      j
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                ℓ
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             (
                                             
                                                
                                                   COST
                                                   
                                                      p
                                                      (
                                                      i
                                                      )
                                                      ℓ
                                                      j
                                                   
                                                
                                                +
                                                
                                                   MARKUP
                                                   
                                                      p
                                                      (
                                                      i
                                                      )
                                                      ℓ
                                                      j
                                                   
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             c
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             X
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∀
                                          k
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          ,
                                          
                                          ∀
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          ,
                                          
                                          ∀
                                          i
                                          =
                                          2
                                          ,
                                          …
                                          m
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (8)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                ℓ
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             (
                                             
                                                
                                                   COST
                                                   
                                                      m
                                                      ℓ
                                                      j
                                                   
                                                
                                                +
                                                
                                                   MARKUP
                                                   
                                                      m
                                                      ℓ
                                                      j
                                                   
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             (
                                             
                                                
                                                   S
                                                   j
                                                   +
                                                
                                                −
                                                
                                                   S
                                                   j
                                                   −
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             ρ
                                             j
                                          
                                          
                                             d
                                             j
                                          
                                          ,
                                          
                                          ∀
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                
                                                   COST
                                                   
                                                      p
                                                      (
                                                      i
                                                      )
                                                      ℓ
                                                      j
                                                   
                                                
                                                +
                                                
                                                   MARKUP
                                                   
                                                      p
                                                      (
                                                      i
                                                      )
                                                      ℓ
                                                      j
                                                   
                                                
                                             
                                             
                                                X
                                                
                                                   p
                                                   (
                                                   i
                                                   )
                                                   ℓ
                                                   j
                                                
                                             
                                          
                                          
                                          ≤
                                          
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   (
                                                   
                                                      
                                                         COST
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      +
                                                      
                                                         MARKUP
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   X
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          ∀
                                          ℓ
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          ,
                                          
                                          ∀
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          ,
                                          
                                          ∀
                                          i
                                          =
                                          2
                                          ,
                                          …
                                          ,
                                          m
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (10)
                           
                              
                                 
                                    
                                       
                                          A
                                          V
                                          
                                             C
                                             j
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                MARKUP
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                          
                                          +
                                          
                                             (
                                             
                                                
                                                   S
                                                   j
                                                   +
                                                
                                                −
                                                
                                                   S
                                                   j
                                                   −
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   r
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                
                                                   X
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                          ∀
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (11)
                           
                              
                                 
                                    
                                       
                                          rmi
                                          
                                             n
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             
                                                MARKUP
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             
                                                COST
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                          
                                          ≤
                                          rma
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          ,
                                          
                                          ∀
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          n
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∀
                                          k
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          ,
                                          
                                          ∀
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          m
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (12)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                
                                                   COST
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                +
                                                
                                                   MARKUP
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                             
                                             
                                                X
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                
                                                   COST
                                                   
                                                      i
                                                      j
                                                      ℓ
                                                   
                                                
                                                +
                                                
                                                   MARKUP
                                                   
                                                      i
                                                      j
                                                      ℓ
                                                   
                                                
                                             
                                             
                                                X
                                                
                                                   i
                                                   j
                                                   ℓ
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          ∀
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          n
                                          ,
                                          
                                          ∀
                                          k
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          ,
                                          
                                          ∀
                                          ℓ
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          k
                                          ≠
                                          ℓ
                                          ,
                                          
                                          ∀
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          m
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (13)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             COST
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          +
                                          
                                             MARKUP
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          ≤
                                          M
                                          
                                             X
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          ∀
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          n
                                          ,
                                          
                                          ∀
                                          k
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          ,
                                          
                                          ∀
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          m
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (14)
                           
                              
                                 
                                    COST
                                    
                                       i
                                       j
                                    
                                 
                                 ,
                                 
                                 
                                    MARKUP
                                    
                                       i
                                       j
                                    
                                 
                                 ,
                                 A
                                 V
                                 
                                    C
                                    
                                       j
                                       
                                    
                                 
                                 ,
                                 
                                    U
                                    j
                                 
                                 ,
                                 
                                    S
                                    j
                                    +
                                 
                                 ,
                                 
                                 
                                    S
                                    j
                                    −
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 ∀
                                 j
                                 =
                                 1
                                 ,
                                 
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                              
                           
                        
                     
                     
                        
                           (15)
                           
                              
                                 
                                    X
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 ∀
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 
                                 ∀
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 
                                 ∀
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 ,
                              
                           
                        
                     
                     
                        
                           (16)
                           
                              
                                 
                                    Y
                                    j
                                 
                                 ∈
                                 
                                    (
                                    0
                                    ,
                                    1
                                    )
                                 
                                 ,
                                 
                                 ∀
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                              
                           
                        
                     
                     
                        
                           (17)
                           
                              
                                 
                                    V
                                    
                                       i
                                       j
                                    
                                 
                                 ∈
                                 
                                    (
                                    0
                                    ,
                                    1
                                    )
                                 
                                 ,
                                 
                                 ∀
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 
                                 ∀
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 .
                              
                           
                        
                     
                  

We now describe problem (P). The problem's objective is to maximize the total net after tax
                        12
                     
                     
                        12
                        The model recognizes and evaluates the local taxes paid on the profits recorded by the plant selling to another plant, and on the profits generated by the DC selling to the external customer.
                      annual profit.Note in the objective function, the net profit calculation includes the impact of exchange rates and indirectly tax rates (which will be explained later). Both rates may vary from country-to-country. Our formulation has some flexibility through gij
                      to capture any one-time amortized costs that may be associated only with a particular activity i. For example, assume that a location in a country could potentially perform 1, 2 or 3 activities. Also assume that a one-time fixed cost to open the plant facility in a country will be incurred regardless of whether the country performs 1, 2 or 3 activities. We have fj
                      represents this one-time (amortized) cost. However, if there are any one-time costs specifically associated with only one individual activity, then we incorporate this specific one-time amortized cost in the gij
                      of that activity for country j.

Problem (P)’s objective function assesses taxes only when the profit is larger than zero.
                        13
                     
                     
                        13
                        Note we do not consider tax credit for losses in our model which is realistic and valid in some countries (see also Goetschalckx et al., 2002).
                      Consider country j. If 
                        
                           A
                           V
                           
                              C
                              j
                           
                           −
                           
                              f
                              j
                           
                           
                              Y
                              j
                           
                           −
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              m
                           
                           
                              
                                 g
                                 
                                    i
                                    j
                                 
                              
                              
                                 V
                                 
                                    i
                                    j
                                 
                              
                           
                           >
                           0
                        
                     , then 
                        
                           
                              U
                              j
                           
                           =
                           t
                           a
                           
                              x
                              j
                           
                           
                              (
                              
                                 A
                                 V
                                 
                                    C
                                    j
                                 
                                 −
                                 
                                    f
                                    j
                                 
                                 
                                    Y
                                    j
                                 
                                 −
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    
                                       g
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       V
                                       
                                          i
                                          j
                                       
                                    
                                 
                              
                              )
                           
                        
                      (see constraints (2)). The objective function for country j becomes maximize 
                        
                           
                              e
                              j
                           
                           
                              (
                              1
                              −
                              t
                              a
                              
                                 x
                                 j
                              
                              )
                           
                           
                              (
                              
                                 A
                                 V
                                 
                                    C
                                    j
                                 
                                 −
                                 
                                    f
                                    j
                                 
                                 
                                    Y
                                    j
                                 
                                 −
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    
                                       g
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       V
                                       
                                          i
                                          j
                                       
                                    
                                 
                              
                              )
                           
                        
                      and tax will be assessed for country j. On the contrary, when 
                        
                           
                              (
                              
                                 A
                                 V
                                 
                                    C
                                    j
                                 
                                 −
                                 
                                    f
                                    j
                                 
                                 
                                    Y
                                    j
                                 
                                 −
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    
                                       g
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       V
                                       
                                          i
                                          j
                                       
                                    
                                 
                              
                              )
                           
                           <
                           0
                        
                     , then Uj
                      = 0 and we maximize 
                        
                           
                              e
                              j
                           
                           
                              (
                              
                                 A
                                 V
                                 
                                    C
                                    j
                                 
                                 −
                                 
                                    f
                                    j
                                 
                                 
                                    Y
                                    j
                                 
                                 −
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    
                                       g
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       V
                                       
                                          i
                                          j
                                       
                                    
                                 
                              
                              )
                           
                        
                      which is equivalent to minimizing loss (negative profit) and no tax is incurred.

A production activity can be assigned to country j only if the country is selected as a plant location (constraints (3)). If a country was selected and activity i is assigned to the plant, the plant must acquire qij
                      amount of a resource at a cost of gij
                      and use it at a rate aij
                      per unit of output (constraints (4)).

The flow of intermediate and finished products between countries can be modeled as a network (see Fig. 2 above). A node on this network represents country j and the production activity i assigned to the plant in that country. An arc represents the shipment to country k of intermediate and final products produced by the plant's production activity i in country j. We represent this flow by the decision variable Xijk
                     . The total inflow at the source node is D, i.e., 
                        
                           
                              ∑
                              
                                 j
                                 =
                                 1
                              
                              n
                           
                           
                              
                                 ∑
                                 
                                    k
                                    =
                                    1
                                 
                                 n
                              
                              
                                 X
                                 
                                    1
                                    j
                                    k
                                 
                              
                           
                           =
                           D
                        
                      in constraints (5). 
                        
                           
                              ∑
                              
                                 k
                                 =
                                 1
                              
                              n
                           
                           
                              X
                              
                                 i
                                 j
                                 k
                              
                           
                           =
                           
                              ∑
                              
                                 k
                                 =
                                 1
                              
                              n
                           
                           
                              X
                              
                                 p
                                 (
                                 i
                                 )
                                 k
                                 j
                              
                           
                        
                      are flow balance constraints. Finally, 
                        
                           
                              ∑
                              
                                 k
                                 =
                                 1
                              
                              n
                           
                           
                              X
                              
                                 m
                                 k
                                 j
                              
                           
                           =
                           
                              d
                              j
                           
                           ,
                           
                           ∀
                           j
                           =
                           1
                           ,
                           …
                           ,
                           n
                        
                      ensure satisfying every customer demand in each country.

Constraints (6) determine the cost of the intermediate product produced by activity 1 in country j which is shipped to country k. Similarly, constraints (7) compute the cost of producing the intermediate or finished product by activity i in country j and shipped to country k. This cost is the weighted average cost of the intermediate product inputs plus the plant processing cost. Note a plant's revenue from a production activity (i.e. production cost plus markup) is an expense for the plant downstream that is assigned the next production activity. Constraints (8) ensure that the overall cost of the finished product plus any residual profits from distribution and sales of those products must equal the sales revenues (after deducting distribution and sales expenses). Typically, the sales organization or business unit of a firm in a local market/country will establish this sales price to customers in a local market. Competition, product supply and demand relationships, and the other local conditions generally drive the development of customer sales prices. Constraints (8) also will allocate some of the revenues to plants to meet all their costs and also provide them their operating profits. The value of 
                        
                           (
                           
                              S
                              j
                              +
                           
                           −
                           
                           
                           
                              S
                              j
                              −
                           
                           )
                        
                      represents either the market revenues that are not allocated entirely to plants (i.e. when 
                        
                           
                              S
                              j
                              +
                           
                           >
                           0
                        
                      and 
                        
                           
                              S
                              j
                              −
                           
                           =
                           0
                        
                     ) or a deficit in the revenues which occurs when certain plant costs are unmet (i.e. when 
                        
                           
                              S
                              j
                              +
                           
                           =
                           0
                        
                      and 
                        
                           
                              S
                              j
                              −
                           
                           >
                           0
                        
                     ). Note 
                        
                           S
                           j
                           +
                        
                     and 
                        
                           S
                           j
                           −
                        
                      cannot be positive at the same time.

We define the unit transfer price of a product to be the sum of the variable production cost and the markup divided by the number units. It is important to note that our model and algorithm can also seamlessly accommodate a scenario where a firm includes some or all fixed costs, in addition to variable costs, in its transfer prices (i.e., transfer price per unit equals variable cost per unit + allocated fixed cost per unit + markup per unit). In actual practice, significant debate and variance exists in the accounting methods utilized to develop transfer prices, and in particular, whether fixed costs should be included in transfer prices.
                        14
                     
                     
                        14
                        For a detailed discussion of transfer pricing methods, we refer the reader to Hirschey (2009) as a good starting point. Because of the variance found in practice on whether or not (or how) to include fixed costs in transfer prices, we designed a model that can accommodate either approach (i.e., methods that both include and exclude fixed costs as a component of the transfer price).
                      Constraints (9) ensure that the transfer price of the plant's product is larger than or equal to the price of the intermediate input used to produce the product.

Constraints (10) compute the gross profit per country which is the total dollar markup for all activities assigned to the multinational firm's affiliate in country j (including gross profit from sales) less the shipment cost plus the residual profit 
                        
                           (
                           
                              S
                              j
                              +
                           
                           −
                           
                           
                           
                              S
                              j
                              −
                           
                           )
                        
                     . Constraints (11) restrict the ratio of markups to the respective costs to vary within a given range.
                        15
                     
                     
                        15
                        Often a multinational firm has internal guidelines or policies regarding the range of markup percentages it will allow on transactions between its plants and local markets around the world. In many cases, local country regulations heavily influence or dictate these corporate guidelines.
                      They also function as logical constraints which force plant markups to zero when plant costs are zero (i.e. when a plant has no production and shipment activity). Constraints (12) represent the “arms length” restrictions which ensure charging the same price to all receiving locations for an intermediate and finished product originating from the same source.
                        16
                     
                     
                        16
                        Note that some of these arms length constraints can be relaxed, if appropriate, depending upon the tax laws of the shipping and receiving countries, and/or the policy of the multinational firm.
                      We note that with constraints (12) in the model, for any fixed i, j, and ℓ, the right hand sides of constraints (9) can be simplified to (COSTijk
                      + MARKUPijk
                     )/Xijk
                      since by (12) this ratio is the same for any k. Constraints (13) ensure that the COST and MARKUP variables are set to zero when the corresponding product flow variable X is zero. The M in the right hand side of constraints (13) is any large constant. (In our computational experiment, we set 
                        
                           M
                           =
                           
                              ∑
                              
                                 j
                                 =
                                 1
                              
                              n
                           
                           
                              
                                 ρ
                                 j
                              
                              
                                 d
                                 j
                              
                           
                        
                     .) We note that without constraints (13), when Xijk
                      = 0, the corresponding COSTijk
                      and  MARKUPijk
                     variables are not automatically set to zero. Also note that with constraints (13) in the formulation, constraints (7), (9) and (12) are not violated when Xijk
                      = 0.

Constraints (6)–(13) can be viewed on the network model diagram shown in Fig. 2 as restrictions on the cash allocation and distribution flow moving opposite the direction of the product flow i.e. from the sink node to node 0. We note that with constraints (2) and (6)–(13), market revenues are allocated upstream to the supply chain network to cover the fixed costs of opening plants and the variable costs of production and shipment activities. Constraints (11) ensure that some of the market revenues are allotted to plant markups. Constraints (9) and (12) also regulate the revenue allotments to plant markups. Finally, the remaining constraints are integrality restrictions on the variables Y and V, and non negativity restrictions on the U, X, S, AVC, COST and MARKUP variables.

We develop a heuristic procedure to solve problem P. It is an iterative procedure that employs a generalized Benders decomposition approach developed by Geoffrion (1972). We have selected this approach instead of other competing decomposition approaches such as the original Benders decomposition and Lagrangian relaxation for the following reasons: (1) we capitalize on the natural partition between the product flow and cash allocation decisions in problem P; (2) when parameterized (i.e. when we fix certain variables), the cash allocation decision, which has nonlinear constraints, is transformed into a linear program. The linear program provides the dual prices to derive natural families of cuts corresponding to those in the original Benders decomposition; and (3) unlike Lagrangian relaxation, we do not have to relax any technical constraints, thus it is possible to obtain a feasible solution at each iteration. Additionally, the complicating constraints in problem P are non linear and replacing these constraints with penalty terms in the objective function yields a Lagrangian problem which may be as difficult to solve as the original problem. We note that if problem P can be reformulated into a linear program by some transformation, then competing decomposition approaches may be used in a heuristic procedure similar to that proposed in this paper. It has been shown that when solving a linear program, Benders decomposition, Dantzig Wolfe decomposition and Lagrangian optimization can be interpreted as equivalent techniques applied to different representations of the problem such as primal linear, dual linear and Lagrangian dual formulations (see Lim, 2011 for details).

Benders decomposition views a problem as a collection of several problems. They are the subproblem, which is formed by fixing the integer variables in the problem, and a restricted master problem. Specifically, problem P consists of two basic decisions, the product flow and cash allocation decisions, which are linked together by complicating side constraints and decision variables. By relaxing the complicating side constraints and/or fixing the complicating variables, the decisions can be separated and solved independently. We consider the product flow decision as our restricted master problem, and the cash allocation decision as our subproblem. When problem P is parameterized by fixing the product flow in the supply chain network, i.e., fixed values of variables X, Y and V, the problem reduces to a cash allocation problem and can be solved as a linear programming (LP) problem.

A similarity between Geoffrion's generalized Benders decomposition approach and our approach is that the parameterized problem is an LP problem. The decomposition creates a decentralized decision environment, where the dual prices coordinate the product flow decision with the cash allocation decision in the supply chain. Utilizing LP duality theory, the parameterized LP readily provides dual prices to be used to generate Benders cuts for the master problem.

Our heuristic approach iteratively solves the restricted master problem and then the subproblem. We find a solution to each subproblem using LP. The product flow from the restricted master problem and the cash allocation from the subproblem together form a feasible solution to problem P. When solved as an LP, the subproblem not only provides a cash allocation solution but are also our source of the dual prices needed for the formation of a Benders cut. These steps are repeated until a stopping criterion (to be specified later) is satisfied. The details of our solution approach are presented below.

We consider the variables (X, Y, V) to be the complicating variables in problem (P). Substituting in problem (P) a scalar vector for variables (X,Y,V) that satisfies constraints (3)–(5), (16) and (17) yields a subproblem (SP) that is a Linear Programming (LP) problem whose optimal solution is feasible to problem (P). Consider the formulation of problem (SP).

                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             Problem
                                             
                                             (
                                             SP
                                             )
                                             :
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          Z
                                          
                                             (
                                             X
                                             ,
                                             Y
                                             ,
                                             V
                                             )
                                          
                                          =
                                          
                                             
                                                M
                                                a
                                                x
                                                i
                                                m
                                                i
                                                z
                                                e
                                             
                                             
                                                A
                                                O
                                                P
                                                ,
                                                U
                                                ,
                                                C
                                                O
                                                S
                                                T
                                                ,
                                                M
                                                A
                                                R
                                                K
                                                U
                                                P
                                             
                                          
                                          
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                e
                                                j
                                             
                                             
                                                (
                                                
                                                   A
                                                   V
                                                   
                                                      C
                                                      j
                                                   
                                                   −
                                                   
                                                   
                                                      f
                                                      j
                                                   
                                                   
                                                      Y
                                                      j
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      m
                                                   
                                                   
                                                      
                                                         g
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                         V
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                   
                                                   −
                                                   
                                                      U
                                                      j
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          s
                                          u
                                          b
                                          j
                                          e
                                          c
                                          t
                                          
                                          t
                                          o
                                          :
                                          
                                          
                                          
                                          (
                                          2
                                          )
                                          ,
                                          
                                          
                                          (
                                          6
                                          )
                                          −
                                          (
                                          14
                                          )
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Note that constraints (7), (9) and (12) in problem SP are nonlinear. Also note that for any given value of (X, Y, V), the optimum of problem SP is bounded.

Next we develop an alternative formulation that is equivalent to problem (SP) and call it (SP’). Problem (SP’) has the same optimal solution and optimal value as problem (SP), but it has the structure we need to generate cuts that are linear in variables (X, Y, V) as will be shown soon. We construct Problem (SP’) by first replacing constraints (7) with three constraints:

                        
                           (7-1)
                           
                              
                                 
                                    
                                       
                                          C
                                          O
                                          S
                                          
                                             T
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             W
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          +
                                          
                                             c
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             X
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          ,
                                          
                                          ∀
                                          k
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∀
                                          j
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          ,
                                          
                                          ∀
                                          i
                                          =
                                          2
                                          ,
                                          …
                                          m
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (7-2)
                           
                              
                                 
                                    
                                       
                                          W
                                          
                                             i
                                             j
                                             k
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                X
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      ℓ
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   X
                                                   
                                                      i
                                                      j
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                ℓ
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             (
                                             C
                                             O
                                             S
                                             
                                                T
                                                
                                                   p
                                                   (
                                                   i
                                                   )
                                                   ℓ
                                                   j
                                                
                                             
                                             +
                                             M
                                             A
                                             R
                                             K
                                             U
                                             
                                                P
                                                
                                                   p
                                                   (
                                                   i
                                                   )
                                                   ℓ
                                                   j
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∀
                                          k
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          ,
                                          
                                          ∀
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          ,
                                          
                                          ∀
                                          i
                                          =
                                          2
                                          ,
                                          …
                                          m
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (7-3)
                           
                              
                                 
                                    W
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 ∀
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 
                                 ∀
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 
                                 ∀
                                 i
                                 =
                                 2
                                 ,
                                 …
                                 m
                                 .
                              
                           
                        
                     
                  

Then we eliminate the AVC variables by substituting (10) in (1) and (2). We also breakup constraints (11) into two constraints.

Thus, for any fixed values of variables (X, Y, V), the corresponding optimal solution (COST*, MARKUP*, W*, U*, AVC*, S*) can be determined efficiently. This solution is feasible to problem P because the cash allocation restrictions are satisfied. Hence, for any given values of (X, Y, V), the quantity 
                        
                           
                              ∑
                              
                                 j
                                 =
                                 1
                              
                              n
                           
                           
                              
                                 e
                                 j
                              
                              
                                 (
                                 
                                    A
                                    V
                                    
                                       C
                                       j
                                    
                                    −
                                    
                                       f
                                       j
                                    
                                    
                                       Y
                                       j
                                    
                                    −
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       m
                                    
                                    
                                       
                                          g
                                          
                                             i
                                             j
                                          
                                       
                                       
                                          V
                                          
                                             i
                                             j
                                          
                                       
                                    
                                    −
                                    
                                       U
                                       j
                                    
                                 
                                 )
                              
                           
                        
                      is a valid upper bound (UB) on the optimal objective function value of the original problem. Finally, the problem SP is solved to obtain the dual prices for the Benders cut.

Problem (SP’) is shown in this section. For ease of reference, we display the dual variables (represented by subscripted Greek letters) on the right side of each constraint of problem (SP’).


                     
                        
                           
                              
                              
                              
                              
                                 
                                    
                                       Problem (SP’):
                                    
                                    
                                       Dual variables
                                    
                                 
                                 
                                    
                                       
                                          
                                             Z
                                             
                                                (
                                                X
                                                ,
                                                Y
                                                ,
                                                V
                                                )
                                             
                                             =
                                             
                                                
                                                   M
                                                   a
                                                   x
                                                   i
                                                   m
                                                   i
                                                   z
                                                   e
                                                
                                                
                                                   U
                                                   ,
                                                   C
                                                   O
                                                   S
                                                   T
                                                   ,
                                                   M
                                                   A
                                                   R
                                                   K
                                                   U
                                                   P
                                                   ,
                                                   S
                                                   ,
                                                   W
                                                
                                             
                                             
                                             
                                             
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                e
                                                j
                                             
                                             
                                                (
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   (
                                                   
                                                      M
                                                      A
                                                      R
                                                      K
                                                      U
                                                      
                                                         P
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      −
                                                      
                                                         r
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      
                                                         X
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             −
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                
                                                   g
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                
                                                   V
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                             +
                                             
                                                (
                                                
                                                   S
                                                   j
                                                   +
                                                
                                                −
                                                
                                                
                                                
                                                   S
                                                   j
                                                   −
                                                
                                                )
                                             
                                             −
                                             
                                                f
                                                j
                                             
                                             
                                                Y
                                                j
                                             
                                             −
                                             
                                                U
                                                j
                                             
                                             
                                                )
                                             
                                          
                                       
                                    
                                    
                                    
                                 
                                 
                                    
                                       s.t.
                                    
                                    
                                    
                                 
                                 
                                    
                                       
                                          
                                             t
                                             a
                                             
                                                x
                                                j
                                             
                                             [
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   M
                                                   A
                                                   R
                                                   K
                                                   U
                                                   
                                                      P
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      (
                                                      
                                                         S
                                                         j
                                                         +
                                                      
                                                      −
                                                      
                                                      
                                                      
                                                         S
                                                         j
                                                         −
                                                      
                                                      )
                                                   
                                                   ]
                                                
                                             
                                             −
                                             
                                                U
                                                j
                                             
                                          
                                       
                                    
                                    
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                             ≤
                                             t
                                             a
                                             
                                                x
                                                j
                                             
                                             
                                                (
                                                
                                                   f
                                                   j
                                                
                                                
                                                   Y
                                                   j
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   m
                                                
                                                
                                                   
                                                      g
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   
                                                      V
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   m
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      
                                                         r
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      
                                                         X
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             ,
                                             
                                             ∀
                                             j
                                             =
                                             1
                                             …
                                             n
                                          
                                       
                                    
                                    (2)
                                    
                                       
                                          
                                             α
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             C
                                             O
                                             S
                                             
                                                T
                                                
                                                   1
                                                   j
                                                   k
                                                
                                             
                                             =
                                             
                                                c
                                                
                                                   1
                                                   j
                                                
                                             
                                             
                                                X
                                                
                                                   1
                                                   j
                                                   k
                                                
                                             
                                             ,
                                             
                                             ∀
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             ∀
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                          
                                       
                                    
                                    (6)
                                    
                                       
                                          
                                             β
                                             
                                                1
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             C
                                             O
                                             S
                                             
                                                T
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             =
                                             
                                                W
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             +
                                             
                                                c
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                X
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             ,
                                             
                                             ∀
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             ∀
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                          
                                       
                                    
                                    
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                             ∀
                                             i
                                             =
                                             2
                                             ,
                                             …
                                             m
                                             ,
                                          
                                       
                                    
                                    (7-1)
                                    
                                       
                                          
                                             β
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                W
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             =
                                             
                                                
                                                   X
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         ℓ
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      X
                                                      
                                                         i
                                                         j
                                                         ℓ
                                                      
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   ℓ
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                (
                                                C
                                                O
                                                S
                                                
                                                   T
                                                   
                                                      p
                                                      (
                                                      i
                                                      )
                                                      ℓ
                                                      j
                                                   
                                                
                                                +
                                                M
                                                A
                                                R
                                                K
                                                U
                                                
                                                   P
                                                   
                                                      p
                                                      (
                                                      i
                                                      )
                                                      ℓ
                                                      j
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                    
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                             ∀
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             ∀
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             ∀
                                             i
                                             =
                                             2
                                             ,
                                             …
                                             m
                                             ,
                                          
                                       
                                    
                                    (7-2)
                                    
                                       
                                          
                                             π
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                W
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             ≥
                                             0
                                             ,
                                             
                                             ∀
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             ∀
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             ∀
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             m
                                             .
                                          
                                       
                                    
                                    (7-3)
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   ℓ
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                (
                                                C
                                                O
                                                S
                                                
                                                   T
                                                   
                                                      m
                                                      ℓ
                                                      k
                                                   
                                                
                                                +
                                                M
                                                A
                                                R
                                                K
                                                U
                                                
                                                   P
                                                   
                                                      m
                                                      ℓ
                                                      j
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                (
                                                
                                                   S
                                                   j
                                                   +
                                                
                                                −
                                                
                                                   S
                                                   j
                                                   −
                                                
                                                )
                                             
                                             =
                                             
                                                ρ
                                                j
                                             
                                             
                                                d
                                                j
                                             
                                             ,
                                          
                                       
                                    
                                    
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                             ∀
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                          
                                       
                                    
                                    (8)
                                    
                                       
                                          
                                             ξ
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   C
                                                   O
                                                   S
                                                   
                                                      T
                                                      
                                                         p
                                                         (
                                                         i
                                                         )
                                                         ℓ
                                                         j
                                                      
                                                   
                                                   +
                                                   M
                                                   A
                                                   R
                                                   K
                                                   U
                                                   
                                                      P
                                                      
                                                         p
                                                         (
                                                         i
                                                         )
                                                         ℓ
                                                         j
                                                      
                                                   
                                                
                                                
                                                   X
                                                   
                                                      p
                                                      (
                                                      i
                                                      )
                                                      ℓ
                                                      j
                                                   
                                                
                                             
                                             ≤
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      (
                                                      C
                                                      O
                                                      S
                                                      
                                                         T
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      +
                                                      M
                                                      A
                                                      R
                                                      K
                                                      U
                                                      
                                                         P
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      X
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                             ∀
                                             ℓ
                                             =
                                             1
                                             ,
                                             …
                                             n
                                             ,
                                          
                                       
                                    
                                    
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                             ∀
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             ∀
                                             i
                                             =
                                             2
                                             ,
                                             …
                                             ,
                                             m
                                          
                                       
                                    
                                    (9)
                                    
                                       
                                          
                                             ψ
                                             
                                                i
                                                ℓ
                                                j
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             M
                                             A
                                             R
                                             K
                                             U
                                             
                                                P
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             -
                                             rma
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             C
                                             O
                                             S
                                             
                                                T
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             ≤
                                             0
                                             ,
                                          
                                       
                                    
                                    
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                             ∀
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             n
                                             ,
                                             
                                             ∀
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             ∀
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             m
                                             ,
                                          
                                       
                                    
                                    (11-1)
                                    
                                       
                                          
                                             τ
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             M
                                             A
                                             R
                                             K
                                             U
                                             
                                                P
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             -
                                             rmi
                                             
                                                n
                                                
                                                   i
                                                   j
                                                
                                             
                                             C
                                             O
                                             S
                                             
                                                T
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             ≥
                                             0
                                             ,
                                          
                                       
                                    
                                    
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                             ∀
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             n
                                             ,
                                             
                                             ∀
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             ∀
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             m
                                             ,
                                          
                                       
                                    
                                    (11-2)
                                    
                                       
                                          
                                             φ
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   C
                                                   O
                                                   S
                                                   
                                                      T
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                   
                                                   +
                                                   
                                                   M
                                                   A
                                                   R
                                                   K
                                                   U
                                                   
                                                      P
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                
                                                
                                                   X
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   C
                                                   O
                                                   S
                                                   
                                                      T
                                                      
                                                         i
                                                         j
                                                         ℓ
                                                      
                                                   
                                                   +
                                                   M
                                                   A
                                                   R
                                                   K
                                                   U
                                                   
                                                      P
                                                      
                                                         i
                                                         j
                                                         ℓ
                                                      
                                                   
                                                
                                                
                                                   X
                                                   
                                                      i
                                                      j
                                                      ℓ
                                                   
                                                
                                             
                                             ,
                                             
                                             ∀
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             n
                                             ,
                                             
                                          
                                       
                                    
                                    
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                             ∀
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             ∀
                                             ℓ
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             k
                                             ≠
                                             ℓ
                                             ,
                                             
                                             ∀
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             m
                                          
                                       
                                    
                                    (12)
                                    
                                       
                                          
                                             ϕ
                                             
                                                i
                                                j
                                                k
                                                ℓ
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             C
                                             O
                                             S
                                             
                                                T
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             +
                                             M
                                             A
                                             R
                                             K
                                             U
                                             
                                                P
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             ≤
                                             M
                                             
                                                X
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                             ∀
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             n
                                             ,
                                             
                                             ∀
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             ∀
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             m
                                             ,
                                          
                                       
                                    
                                    (13)
                                    
                                       
                                          
                                             γ
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             M
                                             A
                                             R
                                             K
                                             U
                                             
                                                P
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             ,
                                             C
                                             O
                                             S
                                             
                                                T
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             ,
                                             
                                                U
                                                j
                                             
                                             ,
                                             
                                                S
                                                j
                                                +
                                             
                                             ,
                                             
                                                S
                                                j
                                                −
                                             
                                             ≥
                                             0
                                             ,
                                          
                                       
                                    
                                    
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                             ∀
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             ∀
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             ∀
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             m
                                             ,
                                          
                                       
                                    
                                    (14)
                                    
                                 
                              
                           
                        
                     
                  

We note that for any (X, Y, V), problem (SP’) is a concave program with a finite optimal solution. This implies that for any given (X, Y, V), an optimal solution to the dual of problem (SP’) exists. Next we show how we employ the optimal primal and dual solutions of problem (SP’) to construct a cut. Let f(X, Y, V, COST, MARKUP, U, S, W) represent the objective function of problem (SP’) and G(X, Y, V, COST, MARKUP, S, W) ≥ 0 the constraint set of problem (SP’). Denote the LP dual of problem (SP’) by problem (DSP’) and also let the set of dual variables {α, β, π, ξ, ψ, τ, φ, ϕ, γ} be represented by μ for any given (X, Y, V). The dual problem can be formulated as:

                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          Problem
                                          (
                                          DSP
                                          "
                                          )
                                          :
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          Z
                                          
                                             (
                                             X
                                             ,
                                             Y
                                             ,
                                             V
                                             )
                                          
                                          =
                                          
                                             Minimize
                                             
                                                μ
                                                ≥
                                                0
                                             
                                          
                                          L
                                          
                                             (
                                             X
                                             ,
                                             Y
                                             ,
                                             V
                                             ,
                                             μ
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     where

                        
                           
                              
                                 
                                    
                                       
                                          L
                                          (
                                          X
                                          ,
                                          Y
                                          ,
                                          V
                                          ,
                                          μ
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             Maximize
                                             
                                                
                                                   COST
                                                   ,
                                                   MARKUP
                                                
                                                ,
                                                U
                                                ,
                                                S
                                                ,
                                                W
                                                ≥
                                                0
                                             
                                          
                                          
                                          f
                                          
                                             (
                                             X
                                             ,
                                             Y
                                             ,
                                             V
                                             ,
                                             
                                                COST
                                                ,
                                                MARKUP
                                             
                                             ,
                                             U
                                             ,
                                             S
                                             ,
                                             W
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          μ
                                          
                                          G
                                          (
                                          X
                                          ,
                                          Y
                                          ,
                                          V
                                          ,
                                          
                                             COST
                                             ,
                                             
                                             MARKUP
                                          
                                          ,
                                          U
                                          ,
                                          S
                                          ,
                                          W
                                          )
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Expanding L(X, Y, V, μ) yields:

                        
                           
                              
                                 
                                    
                                       
                                          L
                                          (
                                          X
                                          ,
                                          Y
                                          ,
                                          V
                                          ,
                                          μ
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          Maximize
                                          
                                             C
                                             O
                                             S
                                             T
                                             ,
                                             M
                                             A
                                             R
                                             K
                                             U
                                             P
                                             ,
                                             U
                                             ,
                                             S
                                             ,
                                             W
                                             ≥
                                             0
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ×
                                          {
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             e
                                             j
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   (
                                                   
                                                      MARKUP
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                   −
                                                   
                                                      r
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                   
                                                      X
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             
                                                g
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                V
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                          +
                                          
                                             (
                                             
                                                S
                                                j
                                                +
                                             
                                             −
                                             
                                                S
                                                j
                                                −
                                             
                                             )
                                          
                                          −
                                          
                                             f
                                             j
                                          
                                          
                                             Y
                                             j
                                          
                                          −
                                          
                                             U
                                             j
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             α
                                             j
                                          
                                          
                                             (
                                             t
                                             a
                                             
                                                x
                                                j
                                             
                                             
                                                [
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   m
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      MARKUP
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                
                                                +
                                                
                                                   (
                                                   
                                                      S
                                                      j
                                                      +
                                                   
                                                   −
                                                   
                                                      S
                                                      j
                                                      −
                                                   
                                                   )
                                                
                                                ]
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                          
                                             U
                                             j
                                          
                                          −
                                          t
                                          a
                                          
                                             x
                                             j
                                          
                                          
                                             (
                                             
                                                f
                                                j
                                             
                                             
                                                Y
                                                j
                                             
                                             +
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                
                                                   g
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                
                                                   V
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   
                                                      r
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                   
                                                      X
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   β
                                                   
                                                      1
                                                      j
                                                      k
                                                   
                                                
                                                
                                                   (
                                                   
                                                      COST
                                                      
                                                         1
                                                         j
                                                         k
                                                      
                                                   
                                                   −
                                                   
                                                      c
                                                      
                                                         1
                                                         j
                                                      
                                                   
                                                   
                                                      X
                                                      
                                                         1
                                                         j
                                                         k
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      2
                                                   
                                                   m
                                                
                                                
                                                   
                                                      β
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         COST
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      −
                                                      
                                                         W
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      −
                                                      
                                                         c
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                         X
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                2
                                             
                                             m
                                          
                                          
                                             π
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          (
                                          
                                             W
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             ∑
                                             
                                                ℓ
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             X
                                             
                                                i
                                                j
                                                ℓ
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                          
                                             X
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             ∑
                                             
                                                ℓ
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             (
                                             
                                                COST
                                                
                                                   p
                                                   (
                                                   i
                                                   )
                                                   ℓ
                                                   j
                                                
                                             
                                             +
                                             
                                                MARKUP
                                                
                                                   p
                                                   (
                                                   i
                                                   )
                                                   ℓ
                                                   j
                                                
                                             
                                             )
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ξ
                                             j
                                          
                                          [
                                          
                                             ∑
                                             
                                                ℓ
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             (
                                             
                                                COST
                                                
                                                   m
                                                   ℓ
                                                   k
                                                
                                             
                                             +
                                             
                                                MARKUP
                                                
                                                   m
                                                   ℓ
                                                   j
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             (
                                             
                                                S
                                                j
                                                +
                                             
                                             −
                                             
                                                S
                                                j
                                                −
                                             
                                             )
                                          
                                          −
                                          
                                             ρ
                                             j
                                          
                                          
                                             d
                                             j
                                          
                                          ]
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                2
                                             
                                             m
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                ℓ
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ψ
                                             
                                                i
                                                ℓ
                                                j
                                             
                                          
                                          [
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             X
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             (
                                             
                                                COST
                                                
                                                   p
                                                   (
                                                   i
                                                   )
                                                   ℓ
                                                   j
                                                
                                             
                                             +
                                             
                                                MARKUP
                                                
                                                   p
                                                   (
                                                   i
                                                   )
                                                   ℓ
                                                   j
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                             (
                                             
                                                X
                                                
                                                   p
                                                   (
                                                   i
                                                   )
                                                   ℓ
                                                   j
                                                
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                (
                                                
                                                   COST
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                +
                                                
                                                   MARKUP
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                )
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                τ
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             (
                                             
                                                MARKUP
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             −
                                             rma
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                COST
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   
                                                      φ
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                   
                                                      (
                                                      rmi
                                                      
                                                         n
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                         COST
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      −
                                                      
                                                         MARKUP
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                ℓ
                                                =
                                                1
                                                ,
                                                
                                                ℓ
                                                ≠
                                                k
                                             
                                             n
                                          
                                          
                                             ϕ
                                             
                                                i
                                                j
                                                k
                                                ℓ
                                             
                                          
                                          
                                             (
                                             (
                                          
                                          
                                             COST
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             MARKUP
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          
                                             )
                                             
                                                X
                                                
                                                   i
                                                   j
                                                   ℓ
                                                
                                             
                                             
                                             −
                                             
                                             
                                             
                                                (
                                                
                                                   COST
                                                   
                                                      i
                                                      j
                                                      ℓ
                                                   
                                                
                                                +
                                                
                                                   MARKUP
                                                   
                                                      i
                                                      j
                                                      ℓ
                                                   
                                                
                                                )
                                             
                                             
                                                X
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   
                                                      γ
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         COST
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      +
                                                      
                                                         MARKUP
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      −
                                                      M
                                                      
                                                         X
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          }
                                       
                                    
                                 
                              
                           
                        
                     
                  

Given (X, Y, V), let the primal optimal solution of problem (SP’) be represented by (COST*, MARKUP*, U*, S*, W*) and the optimal solution of problem (DSP’) by μ* = {α*, β*, π*, ξ*, ψ*, τ*, φ*, ϕ*, γ*}. These optimal solutions can be obtained easily by solving problem (SP’) directly with linear programming software (e.g. CPLEX). We substitute (COST*, MARKUP*, U*, S*, W*) and μ* in L(X, Y, V, μ). This yields a linear equation in variables X, Y and V. We note that with Geoffrion's (1972) generalized Benders decomposition, f(X, Y, V, COST, MARKUP, U, S, W) and G(X, Y, V, COST, MARKUP, U, S, W) need not be linearly separable in (X, Y, V) and (COST, MARKUP, U, S, W). Furthermore, the dual solution in the generalized Benders decomposition is dependent on the values of (X, Y, V). Next we discuss the master problem.

Define the set A = {(X, Y, V) such that (X, Y, V) satisfies constraints (3)–(5), (15), (16) and (17)}. In other words, set A represents the feasible set of product flows on our supply chain network. We can reformulate our original problem (P) by introducing in the objective function a variable θ such that θ ≤ L(X, Y, V, μ*) for every (X, Y, V) ∈ A(and (X, Y, V)’s associated μ*). The new model is called the master problem. It is given by:

                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          Problem
                                          
                                          (
                                          R
                                          )
                                          :
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                M
                                                a
                                                x
                                                i
                                                m
                                                i
                                                z
                                                e
                                             
                                             
                                                θ
                                                ≥
                                                0
                                             
                                          
                                          
                                          
                                          
                                          θ
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          s
                                          u
                                          b
                                          j
                                          e
                                          c
                                          t
                                          
                                          
                                          t
                                          o
                                          :
                                          
                                          
                                          (
                                          3
                                          )
                                          −
                                          (
                                          5
                                          )
                                          ,
                                          (
                                          15
                                          )
                                          ,
                                          (
                                          16
                                          )
                                          ,
                                          (
                                          17
                                          )
                                          
                                          and
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          θ
                                          ≤
                                          L
                                          
                                             (
                                             X
                                             ,
                                             Y
                                             ,
                                             V
                                             ,
                                             
                                                μ
                                                *
                                             
                                             )
                                          
                                          ,
                                          
                                          ∀
                                          
                                             (
                                             X
                                             ,
                                             Y
                                             ,
                                             V
                                             )
                                          
                                          ∈
                                          A
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

The linear constraint θ ≤ L(X, Y, V, μ*) formed by each product flow (X, Y, V) in set A and its corresponding optimal dual prices is a Benders cut. Because the number of (X, Y, V)’s in set A can be enormous, we shall solve a “restricted” master problem instead. We shall call it problem Rw
                     . In our proposed Benders decomposition procedure, a Benders cut is iteratively added to problem Rw
                     . The optimal value of problem Rw
                      is a lower bound (LB) to the optimal value of problem P. The optimal value of the parameterized problem P for any fixed product flow (X, Y, V) satisfying constraints (3)–(5), (15), (16) and (17) is an upper bound (UB) to the optimal value of problem P. It should be noted that the parameterized problem P, and therefore problem SP, is bounded and feasible (i.e., because the cash allocation restrictions are satisfied). It has been shown that when the Benders decomposition approach is run long enough, it would eventually lead to LB = UB (for further details about Benders decomposition, see Geoffrion, 1972). We now formulate problem Rw
                     . Define w = |B| where
B⊂A. Let Lt
                     (X, Y, V, μ*)be the linear cut generated at iteration t. The restricted master problem is stated as a network flow problem with linear side constraints. It is given by:

                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          Problem
                                          
                                          (
                                          
                                             R
                                             w
                                          
                                          )
                                          :
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                M
                                                a
                                                x
                                                i
                                                m
                                                i
                                                z
                                                e
                                             
                                             
                                                θ
                                                ≥
                                                0
                                             
                                          
                                          
                                          θ
                                          
                                          s
                                          u
                                          b
                                          j
                                          e
                                          c
                                          t
                                          
                                          
                                          t
                                          o
                                          :
                                          
                                          
                                          
                                             (
                                             3
                                             )
                                          
                                          −
                                          
                                             (
                                             5
                                             )
                                          
                                          ,
                                          
                                             (
                                             15
                                             )
                                          
                                          ,
                                          
                                             (
                                             16
                                             )
                                          
                                          ,
                                          
                                             (
                                             17
                                             )
                                          
                                          
                                          and
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          θ
                                          ≤
                                          
                                             L
                                             t
                                          
                                          
                                             (
                                             X
                                             ,
                                             Y
                                             ,
                                             V
                                             ,
                                             μ
                                             *
                                             )
                                          
                                          ,
                                          
                                          ∀
                                          t
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          w
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Finally, referring to Geoffrion (1972), the assumptions underlying the generalized Benders decomposition procedure presented above are easily verified as follows. First, a solution to problem (SP’) exists for any given feasible (X, Y, V). Second, problem (SP’) is a linear program with finite optimal primal and dual solutions. We note that from the physical interpretation of the primal problem, it is clear that the values of the decision variables are bounded, i.e. product flows are bounded by the plants’ production capacity, and costs and markups are also bounded by market revenues. We also note that solving a large problem (Rw
                     ) can be challenging, but our computational experiments show that a commercial integer programming software such as CPLEX (2002) is remarkably robust and fast in finding near optimal solutions to problem (Rw
                     ).


                     Fig. 3 outlinesthe steps of our procedure. The initial steps are to set UB to + infinity and then prime the procedure with an initial (X, Y, V) by finding a minimum cost feasible solution. Specifically we solve a cost minimization problem, i.e. the problem that minimizes the sum of the fixed and variable production and shipment costs subject to constraints (3)–(5), (15), (16) and (17). This gives an initial product flow solution (X, Y, V). Substitute (X, Y, V) in problem SP and solve it. (This is the first step of our procedure.) The total after tax profit of this solution is our initial LB. Utilizing problem SP’s optimal LP dual prices, we generate a Benders cut. We append this cut to the current problem Rw
                      and solve it. (This is the second step of our procedure.) We iterate by performing the first and second steps alternately until the stopping criterion is satisfied, i.e., either the relative gap between is less than or equal to a tolerance limit ɛ > 0 or the relative gap remains constant after η consecutive iterations, where ɛand η are pre-specified quantities.

In this section, we present insights that the global profit maximization model can provide, and investigate the performance of our solution algorithm. Utilizing a combination of simulated data
                        17
                     
                     
                        17
                        Simulated data are real data, but disguised to protect confidentiality. They include market demands, plant capacities and capacity consumptions, costs and revenues. Exchange rates and tax rates data were obtained from The Financial Times newspaper.
                      based on the authors’ experience working with several firms and actual data, we constructed a global supply chain problem with three production activities (i.e. echelons A, B and C) and a fourth echelon composed of markets (see Fig. 2). Each production activity can be assigned to multiple plants. This is our base case. The problem has 10 countries per echelon with finished goods shipped to markets in 10 different countries.

Consider the key attributes of the base case problem. The external market sales price of each finished product in each country is set exogenously. On intra-company sales from plants to affiliates, we assume “mark-ups” on costs must range between 10 percent and 40 percent.
                        18
                     
                     
                        18
                        The 10 percent and 40 percent markup limits are based on our familiarity with some firms that use them.
                      The tax rates of the 10 countries vary significantly. The demand coefficient of variation is 0.54, while the total global production capacity is 1.8 times the total demand. By varying the base case's objective function and/or parameter settings, we have created numerous scenarios that simulate different decision environments. They are as follows:


                     Scenario 1: 
                     Fixed versus variable markups. We assume “fixed” markups in the profit maximizing model and compare their solutions to a model solution where the markups are not fixed in advance. We investigate five cases:

                        
                           1.1
                           Markup fixed at 10 percent

Markup fixed at 20 percent

Markup fixed at 60 percent

Markup may range between 10 percent and 40 percent (This is the base case.)

Markup may range between 10 percentand 100 percent inclusive


                     Scenario 2: 
                     Simulating a decline in global currencies relative to the currency of the country where the multinational firm is based. This scenario illustrates how the supply chain solution (including locations selected) is impacted by changes in currency exchange rates. We lower the value of the currency of each producing country relative to the headquarters country (the US). Specifically we lower these countries currency values by 5 percent, 10 percent, 20 percent, 30 percent and 40 percent.
                  


                     Scenario 3: 
                     Simulating a reduction in global production capacity. We lower the global production capacity by reducing simultaneously the amount of resource available in each country by 10 percent, 20 percent, 30 percent, 40 percent and 50 percent. We study how the model's optimal solutions (i.e., the recommended supply chain network and transfer prices) are impacted by the decline in available global production capacity. Note we did not simulate increases in production capacity since in the base case the total global capacity is 1.8 times the total demand.


                     Scenario 4: 
                     Simulating demand variability. We generate random demands using the normal distribution. The mean is equal to the base case's average market demand. To simulate low, medium, high and very high demand variability, we set the demand standard deviations so that the coefficients of variations are 0.15, 0.54, 0.90 and 1.0 respectively. As mentioned earlier, our base case's coefficient of variation is 0.54.
                  


                     Scenario 5: Minimizing cost versus maximizing profit. We compare the cost minimization solution to the profit maximization solution that our model develops.

We solved problems representing these scenarios and report our findings. We highlight the following in our results:

                        
                           a.
                           The difference in the supply chains formed (e.g., the producing countries selected for each echelon).

The difference in production output levels by country.

The difference in the distribution (sourcing) plans (e.g., shipments flowing between countries).

The difference in the transfer prices.

The difference between the overall profitability of the “profit maximizing model” solution and the “profitability” of the “cost minimizing model” solution. We take the solution from the cost minimizing model (i.e., countries, quantities produced and flows) and compute its total after tax profit. We compare this profit to that of the profit maximization model. As explained earlier, our procedure naturally computes for the total after tax profit of the cost minimizing solution and uses it as the initial lower bound.

We coded our solution procedure in C++ and solved the test problems on a desktop computer with a 2.53 gigahertz Pentium 4 processor and 512 megabytes of RAM. We obtained the optimal dual prices by solving the LP problems using CPLEX (version 8.0). We also optimized the restricted master problem and subproblem in our solution procedure using CPLEX. For each test problem, we determined the relative percentage gap between the lower and upper bounds at each iteration, i.e., gap = (UB - LB)/LB × 100 percent. We terminated the computational process when the gap was at most 2 percent or when the gap remained constant for eight consecutive iterations.

We developed scenarios 1 through 5 because they simulate a number of the major factors (and uncertainties) that a firm evaluates when considering alternative supply chain networks. For example, when making facility location decisions and constructing global supply chains, managers must consider the potential impact of future currency fluctuations, changes and disruptions to capacity levels, as well as variations and changes in the level of demand (i.e., scenarios 2, 3 and 4).

The results of this computational study confirmed that our proposed model generates rationale, insightful solutions. For example, when we varied the percentage range of the profit markups allowed, the model correctly reacted with solutions recommending different transfer prices in response to variations in allowable margins (Table 3). We also found that a much wider markup range resulted in higher transfer prices and total after tax profit; as cost efficient plants located in countries with lower tax rates were allotted relatively higher margins. We observed that changes in the relative currency values between the headquarters country of our fictitious multinational firm and its affiliates’ countries resulted in significantly different facility location recommendations by our model (Tables 4a and 4b). Changes in currency relationships translate into changes in the relative costs of operations in individual countries – when product is being imported and exported across the globe – thus impacting the total global profits of a multinational firm. Therefore the changes in the model's locational solutions resulting from different currency relationship simulations were expected and appropriate. Similarly, the modeling solutions obtained under different global capacity level assumptions yielded significantly different locational solutions, as one would intuitively expect (Tables 5a and 5b). Finally, we observed moderate changes in transfer prices in response to demand variability (Tables 6a and 6b). In summary, we believe the results of our computational study demonstrate the potential utility of employing this model in actual supply chain management practice. More detailed results now follow and we refer the reader to the network model presented earlier in Fig. 2, to clarify further the results shown.
                     


                        Table 2 presents the base case solution. It shows the shipments from source countries to destination countries and transfer prices charged by the source countries. Notice that plants in destination countries paid one, identical price (excluding shipment cost) for intermediate products originating from the same source. Also displayed are the total shipment quantity and the average transfer price (weighted by the quantity produced and shipped). Note that the transfer prices are increasing from one echelon to the next as value is added to the intermediate product at each echelon. Also since a unit of output required one unit of input, the total shipment quantity is the same across the echelons. The echelons have the same producing countries, i.e. countries 3, 4, 5, 7, 9 and 10 with countries 4, 9 and 10 as the top 3 producing countries. Finally the percentage markups are either at the lower or upper bounds (i.e. either 10 percent or 40 percent). This is observed in all the problems that we ran.

For scenario 1, our results show that all the supply chains formed (i.e. the manufacturing and distribution networks) and their optimal production and shipment quantities are identical to those of the base case. However, the allocation of market revenues to provide profits to plants and their affiliates varies significantly. This is shown in Table 3 by the differences in the (weighted) average transfer prices with case 1.5 showing the highest transfer prices and case 1.1 showing the lowest transfer prices.

For scenario 2, 5 percent and 10 percent currency depreciations generate the same supply chains as the base case. However, the 20 percent, 30 percent and 40 percent currency depreciations produce supply chains that are significantly different from that of the base case. Table 4a shows the production echelons present in each country for each case of scenario 2. (The shipment quantities are not shown, but will be provided upon request.) The market revenue allocations to plants in different countries vary as shown by the disparity in transfer prices between the currency depreciation cases in Table 4b.

For scenario 3, global capacity reductions over 55 percent have no feasible solutions. Table 5a shows the production activities assigned to each country (identified by echelon numbers) for each case of scenario 3. No capacity reduction (0 percent) represents the base case.
                        
                     

Intuitively a tighter global production capacity implies generally higher transfer prices because not only will the cheap sources of capacity be utilized, but so will some of the more expensive sources of capacity in order to meet the demands. The results in Table 5b reflect this intuition.
                        
                     

Scenario 4 simulates low, medium, high and very high demand variability. We compared the supply chain formed and the transfer prices. Table 6a shows the production activities assigned to each country for different demand variability. As the level of demand variability changes, the optimal design of the firm's supply chain also changes. Further, the model's recommended efficient internal transfer prices for the firm also change in response to different levels of demand variability are shown in Table 6b.

Next we present the performance of our algorithm and results of scenario 5. Table 7 shows for scenario 1 through scenario 4 the best lower and upper bounds, the iterations at which these bounds were found, the relative percentage gap and the computation time. The average relative percentage gap was 1 percent and the averagecomputation time was 15 CPU seconds. The supply chain formed by the cost minimization solution is fairly robust on different scenarios under mild conditions (see cases where the best lower bounds were found in iteration 0). However, large currency depreciation, capacity reduction or high demand variability yielded supply chains that are significantly different from the supply chain formed from cost minimization.


                        Table 7 also shows the estimated profit for each scenario. The best lower bound represents a good conservative estimate of the profit of each scenario. A review of the table again displays that our model produces intuitive results. For example, as the currencies of the non-headquarter affiliates (countries) depreciate relative to the headquarters (country of registry) country, the projected profit decreases (scenario 3), as one would expect. Similarly, as available network production capacity decreases, and the firm must increase its utilization of relatively more expensive (less efficient) locations, projected profits decrease (scenario 4), again as expected. In summary, these numerical experiments suggest that the proposed profit maximization strategic planning model behaves both efficiently and intuitively, and can provide valuable guidance to a firm's supply chain design planning process.

In this study, we proposed a mathematical optimization model whose solution can be deployed to provide decision support and guidance in constructing and implementing a supply chain that uses a wide assortment of sourcing/manufacturing/country alternatives. Our modeling approach allows a firm to develop a set of major production activities that will collectively comprise a complete manufacturing and distribution network from original sourcing locations to final market demand points. Our approach also provides optimal internal transfer prices simultaneously with the formation of supply chains. Employing our model to find solutions to numerous market scenarios, the firm can identify, scrutinize and propose alternative physical supply chain structures as desired. In summary, the contributions of this paper are three fold: first, we offer a novel formulation of a supply chain network design model that a firm can utilize to optimally integrate manufacturing and distribution location and capacity decisions with transfer pricing decisions; all while simultaneously accounting for local country tax and exchange rates. Secondly we show how an additive price markup for setting transfer prices and revenue allotments to markups can be incorporated in a profit maximization supply chain network model. Finally, utilizing a generalized Benders decomposition approach, we demonstrate how to exploit the separation between the product flow and cash allocation decisions in a global supply chain model to find near optimal solutions to a challenging mixed integer, nonlinear programming formulation.
                  

The model projects the optimal transfer prices (i.e., production costs plus markups) between the firm's affiliates in individual countries as they ship product across the supply chain to the ultimate market destination. Through transfer prices, the firm can allocate global profits to plants in producing countries. We discussed in this paper how transfer prices are reacting intuitively and appropriately to changes in scenarios and its parameter settings. Potential future extensions of our work include the following. Although transfer prices in our computational study show a general trend as we vary the parameter settings of certain scenarios, studying the non-monotonic behavior in some of those prices and how this behavior could possibly relate to changes in the model's optimal solutions is an interesting extension of this paper. One can also expand our profit maximization model to evaluate a supply chain network and transfer prices for a variety of products, rather than just one product. Additionally, alternative transportation options (e.g., different freight modes) could be incorporated into our model to enhance its planning functionality. Finally, when external buyers have access to the firm's intermediate products, this can impact both the optimal design of the supply chain and the determination of the most efficient internal transfer prices. Thus, incorporating external buyers for intermediate products represents another potential future enhancement to our current model.

@&#ACKNOWLEDGEMENT@&#

The first author was supported in part by the Larry and Lori Wright Research Fellowship Grant.

@&#REFERENCES@&#

