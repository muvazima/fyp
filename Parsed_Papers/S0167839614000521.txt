@&#MAIN-TITLE@&#TDHB-splines: The truncated decoupled basis of hierarchical tensor-product splines

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The paper introduces a novel basis for multivariate hierarchical tensor-product spline spaces.


                        
                        
                           
                           It uses the truncation mechanism and the idea of decoupling.


                        
                        
                           
                           The truncation mechanism ensures the partition of unity property.


                        
                        
                           
                           The idea of decoupling allows us to obtain a richer set of basis functions than previous approaches.


                        
                        
                           
                           The construction guarantees the completeness property of the novel basis for large classes of multi-level spline spaces.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Hierarchical B-splines

T-mesh

Dimension of splines

Completeness

Truncation

Decoupling

@&#ABSTRACT@&#


               
               
                  We introduce a novel basis for multivariate hierarchical tensor-product spline spaces. Our construction combines the truncation mechanism (Giannelli et al., 2012) with the idea of decoupling basis functions (Mokriš et al., 2014). While the first mechanism ensures the partition of unity property, which is essential for geometric modeling applications, the idea of decoupling allows us to obtain a richer set of basis functions than previous approaches. Consequently, we can guarantee the completeness property of the novel basis for large classes of multi-level spline spaces. In particular, completeness is obtained for the multi-level spline spaces defined on T-meshes for hierarchical splines of (multi-)degree p for example (i) with single knots and p-adic refinement and (ii) with knots of multiplicity 
                        m
                        ≥
                        (
                        p
                        +
                        1
                        )
                        /
                        3
                      and dyadic refinement (where each cell to be refined is subdivided into 
                        
                           
                              2
                           
                           
                              d
                           
                        
                      cells, with d being the number of variables) without any further restriction on the mesh configuration. Both classes (i), (ii) include multivariate quadratic hierarchical tensor-splines with dyadic refinement.
               
            

@&#INTRODUCTION@&#

A subdivision of a domain in d-dimensional space into axis-aligned boxes is called a box-mesh, in particular a T-mesh for dimension 
                        d
                        =
                        2
                     . The analysis of the dimensions and the construction of bases of multivariate (with focus on bivariate) spline spaces on box meshes and T-meshes has been the topic of a substantial number of publications.

One of the earliest publications (Chui and Wang, 1983) included not only the dimension formula for splines on simple cross-cut grid partitions but also a detailed study on bivariate splines with rectangular grid partitions. More recently, Deng et al. (2006) proposed a method based on Bézier nets to calculate the dimension of a spline function space over a T-mesh, in particular in the case when the order of smoothness is less than half the degree of the spline functions, which corresponds to knot multiplicities satisfying 
                        m
                        ≥
                        (
                        p
                        +
                        1
                        )
                        /
                        2
                     . We will refer to this class of functions – that allows to decouple the degrees of freedom – as splines with reduced smoothness.

The dimension of bivariate splines with reduced smoothness was reconsidered by Huang et al. (2006a), who derived an equivalent dimension formula using the smoothing cofactor method. A further extension was presented by Huang et al. (2006b). The dimension of trivariate splines on hierarchical box meshes for the case of reduced smoothness was investigated by Li et al. (2006b). Considering again the bivariate case, Li et al. (2006a) used the method of smoothing cofactors to derive a dimension formula for splines with reduced smoothness.

The splines of reduced smoothness have been used for surface modeling and reconstruction by Li et al. (2007) and Deng et al. (2008), where they were called PHT splines (Polynomial splines over Hierarchical T-meshes). See also Li et al. (2009) for the bicubic splines on general T-meshes. The extension to surfaces of arbitrary topology (i.e., including vertices of arbitrary valency) has been presented by Li et al. (2010). Wang et al. (2011) described the generalization to the case of piecewise rational functions and presented an application to numerical simulation using the novel approach of isogeometric analysis (cf. Cottrell et al., 2009). Isogeometric analysis with PHT splines was also studied by Nguyen-Thanh et al. (2011). Schumaker and Wang (2012) studied the approximation power of polynomial splines on T-meshes. This includes PHT splines as a special case. Also the dimension formula from Deng et al. (2006) and Huang et al. (2006b) is confirmed there.

In the general case (i.e., non-reduced smoothness), Li and Chen (2011) and Berdinsky et al. (2012) observed that the dimension of the spline space may depend on the geometry of the T-mesh. Mourrain (2014) presented a general approach based on homological algebra to analyze the dimension of bivariate splines on T-meshes. The resulting formula includes certain correction terms that are difficult to evaluate in general. For a special class of meshes, which are called diagonalizable T-meshes, Li (2012) provided a general dimension result that depends only on the topology of the T-mesh but not on its geometry. Wu et al. (2013) studied another special class of T-meshes and used Mourrain's approach to obtain a dimension formula. Wu et al. (2012) proposed a method for the construction of hierarchical bases of a bivariate spline space with the highest order smoothness over a consistent hierarchical T-mesh. Deng et al. (2013) investigated the dimension of bivariate biquadratic spline spaces over T-meshes.

In these publications, the analysis of the spline space was performed independently on a specific construction of a basis (or, more generally, of a generating system). There exist three additional approaches, which start from the construction of a basis (or a generating system). These approaches are T-splines (see Scott et al., 2012 and the references cited therein), LR splines (Dokken et al., 2013) and hierarchical B-splines. We are interested in the latter approach, in particular we will consider the completeness question: Given a basis of a spline space, does the space spanned by it include all piecewise polynomial functions of the given degree and smoothness on the underlying T-mesh or box-mesh?

The construction of hierarchical splines was introduced by Forsey and Bartels (1988). About ten years later, Kraft (1997) presented a construction of a basis for this space. The completeness question for hierarchical B-splines was first investigated by Giannelli and Jüttler (2013) for bivariate splines of maximal smoothness. Meanwhile, these results have been extended to the trivariate case and to the case of non-uniform degrees and lower smoothness (Berdinsky et al., 2013, 2014a). A basis for bivariate spline spaces with maximal smoothness has been presented by Berdinsky et al. (2014b).

We summarize the development and the dependencies between some of these contributions in Fig. 1
                     . The arrows indicate the citations, where we omitted arrows that can be replaced by compositions of other arrows in order to keep the graph as simple as possible.

The present paper introduces a novel basis for multivariate hierarchical tensor-product spline spaces. Our construction combines the truncation mechanism (Giannelli et al., 2012) with the idea of decoupling the basis functions (Mokriš et al., 2014). Since the truncation mechanism may produce linearly dependent systems of functions, we use the novel framework for the truncation developed by Zore and Jüttler (2014) that applies to generating systems also. Moreover, we employ recent results on completeness obtained by Mokriš et al. (2014) and use them to characterize the completeness of the new basis.

The truncation mechanism ensures the partition of unity property, which is essential for geometric modeling applications. Using decoupling allows us to obtain a richer set of basis functions. Consequently we can guarantee the completeness property for large classes of multi-level spline spaces.

The remainder of this paper consists of five sections. First we introduce the notation and recall the notion of the multi-level spline space on the box mesh that is determined by a construction of hierarchical B-splines. Then we introduce decoupled splines, which form a new generating system for the spline functions on a multi-cell domain. Section 4 invokes the framework of Zore and Jüttler (2014) in order to obtain the basis of truncated decoupled hierarchical B-splines (TDHB-splines), which forms a nonnegative partition of unity. The following section identifies conditions that guarantee the completeness of TDHB splines. Finally, we conclude the paper.

We consider hierarchies of tensor-product spline functions defined on the d-dimensional space 
                        
                           
                              R
                           
                           
                              d
                           
                        
                      with coordinates 
                        x
                        =
                        (
                        
                           
                              x
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              x
                           
                           
                              d
                           
                        
                        )
                     . Given a number of levels N, we assume that a strictly increasing bi-infinite sequence of (grid) nodes
                     
                        
                           
                              
                                 
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          ℓ
                                       
                                    
                                    )
                                 
                                 
                                    j
                                    ∈
                                    Z
                                 
                              
                              ,
                              
                              
                                 
                                    g
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    ℓ
                                 
                              
                              <
                              
                                 
                                    g
                                 
                                 
                                    i
                                    ,
                                    j
                                    +
                                    1
                                 
                                 
                                    ℓ
                                 
                              
                           
                        
                      is given for each coordinate 
                        
                           
                              x
                           
                           
                              i
                           
                        
                     , 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        d
                      and for each level 
                        ℓ
                        =
                        0
                        ,
                        …
                        ,
                        N
                     . We require that these sequences are nested, i.e., 
                        
                           
                              (
                              
                                 
                                    g
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    ℓ
                                 
                              
                              )
                           
                           
                              j
                              ∈
                              Z
                           
                        
                      is a subsequence of 
                        
                           
                              (
                              
                                 
                                    g
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                              )
                           
                           
                              j
                              ∈
                              Z
                           
                        
                     . These nodes define grid hyperplanes of level ℓ,
                        
                           
                              
                                 {
                                 x
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       ℓ
                                    
                                 
                                 }
                              
                              
                              (
                              i
                              =
                              1
                              ,
                              …
                              ,
                              d
                              ;
                              
                              j
                              ∈
                              Z
                              )
                           
                        
                      that form the grid of level ℓ. Fig. 2
                      illustrates these notions by a bivariate example.

The grid nodes 
                        
                           
                              g
                           
                           
                              i
                              ,
                              j
                           
                           
                              ℓ
                           
                        
                      and the grid hyperplanes defined by them have associated multiplicities. In principle, these multiplicities could depend on the level ℓ, the index of the coordinate direction i and on the index j in the sequence of nodes. In order to keep the notation simple, we shall assume that the multiplicities are independent of j. Consequently, we denote them by 
                        
                           
                              m
                           
                           
                              ℓ
                           
                        
                        =
                        (
                        
                           
                              m
                           
                           
                              1
                           
                           
                              ℓ
                           
                        
                        ,
                        …
                        ,
                        
                           
                              m
                           
                           
                              d
                           
                           
                              ℓ
                           
                        
                        )
                     . However, most of the results presented in the remainder of the paper can be generalized to the case of non-uniform multiplicities.

The grid hyperplanes subdivide the d-dimensional space 
                        
                           
                              R
                           
                           
                              d
                           
                        
                      into cells of level ℓ,
                        
                           
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 ⨉
                                 
                                    i
                                    =
                                    1
                                 
                                 d
                              
                              
                                 [
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       
                                          
                                             j
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       1
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       i
                                       ,
                                       
                                          
                                             j
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       ℓ
                                    
                                 
                                 ]
                              
                              ,
                           
                        
                      where ⨉ denotes simply the Cartesian product and 
                        j
                        =
                        (
                        
                           
                              j
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              j
                           
                           
                              d
                           
                        
                        )
                        ∈
                        
                           
                              Z
                           
                           
                              d
                           
                        
                     . Let 
                        
                           
                              C
                           
                           
                              ℓ
                           
                        
                      be the set of all cells of level ℓ. Any union of finitely many cells from 
                        
                           
                              C
                           
                           
                              ℓ
                           
                        
                      will be called a multi-cell domain of level ℓ.

Let Ω be a bounded open domain in 
                        
                           
                              R
                           
                           
                              d
                           
                        
                      and consider open sets 
                        
                           
                              Ω
                           
                           
                              ℓ
                           
                        
                     , 
                        ℓ
                        =
                        0
                        ,
                        …
                        ,
                        N
                        +
                        1
                      satisfying
                        
                           
                              Ω
                              =
                              
                                 
                                    Ω
                                 
                                 
                                    0
                                 
                              
                              ⊇
                              
                                 
                                    Ω
                                 
                                 
                                    1
                                 
                              
                              ⊇
                              ⋯
                              ⊇
                              
                                 
                                    Ω
                                 
                                 
                                    N
                                    +
                                    1
                                 
                              
                              =
                              ∅
                              .
                           
                        
                      This nested sequence of open domains will be called the domain hierarchy. In addition, we will consider the complementary hierarchy of the so-called rings
                     
                        
                           
                              
                                 
                                    Δ
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          Ω
                                       
                                       
                                          0
                                       
                                    
                                    ∖
                                    
                                       
                                          Ω
                                       
                                       
                                          ℓ
                                          +
                                          1
                                       
                                    
                                 
                                 ¯
                              
                              
                              (
                              ℓ
                              =
                              0
                              ,
                              …
                              ,
                              N
                              )
                              ,
                           
                        
                      which satisfy 
                        
                           
                              Δ
                           
                           
                              ℓ
                           
                        
                        ⊆
                        
                           
                              Δ
                           
                           
                              ℓ
                              +
                              1
                           
                        
                     . The following assumption will be essential:
                        
                           (A1)
                           Each 
                                 
                                    
                                       Δ
                                    
                                    
                                       ℓ
                                    
                                 
                               is a multi-cell domain of level ℓ, i.e., a union of cells of level k with 
                                 k
                                 ≤
                                 ℓ
                              .

In order to define a hierarchy of spline spaces, we consider a sequence of (multi-)degrees 
                        
                           
                              p
                           
                           
                              ℓ
                           
                        
                        =
                        (
                        
                           
                              p
                           
                           
                              1
                           
                           
                              ℓ
                           
                        
                        ,
                        …
                        ,
                        
                           
                              p
                           
                           
                              d
                           
                           
                              ℓ
                           
                        
                        )
                      and multiplicities 
                        
                           
                              m
                           
                           
                              ℓ
                           
                        
                        =
                        (
                        
                           
                              m
                           
                           
                              1
                           
                           
                              ℓ
                           
                        
                        ,
                        …
                        ,
                        
                           
                              m
                           
                           
                              d
                           
                           
                              ℓ
                           
                        
                        )
                      that are assumed to satisfy
                        
                           (A2)
                           
                              
                                 1
                                 ≤
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                    
                                       ℓ
                                    
                                 
                                 ≤
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                    
                                       ℓ
                                    
                                 
                              , 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                    
                                       ℓ
                                       +
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                    
                                       ℓ
                                    
                                 
                                 ≤
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                    
                                       ℓ
                                       +
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                    
                                       ℓ
                                    
                                 
                              , and 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                    
                                       ℓ
                                    
                                 
                                 ≤
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                    
                                       ℓ
                                       +
                                       1
                                    
                                 
                              .

For each level ℓ and each coordinate direction 
                        
                           
                              x
                           
                           
                              i
                           
                        
                      we use the nodes 
                        
                           
                              g
                           
                           
                              i
                              ,
                              j
                           
                           
                              ℓ
                           
                        
                      and the associated multiplicities 
                        
                           
                              m
                           
                           
                              i
                           
                           
                              ℓ
                           
                        
                      to define a bi-infinite knot sequence, simply by repeating each node 
                        
                           
                              m
                           
                           
                              i
                           
                           
                              ℓ
                           
                        
                      times. Further we denote with 
                        
                           
                              B
                           
                           
                              i
                           
                           
                              ℓ
                           
                        
                      the basis of B-splines with variable 
                        
                           
                              x
                           
                           
                              i
                           
                        
                      that are defined on these knot sequences. More precisely, each tuple of 
                        
                           
                              p
                           
                           
                              i
                           
                           
                              ℓ
                           
                        
                        +
                        2
                      adjacent knots defines a B-spline, e.g., by the well-known B-spline recurrence formula (see Prautzsch et al., 2002). The collection of these B-splines forms the basis 
                        
                           
                              B
                           
                           
                              i
                           
                           
                              ℓ
                           
                        
                     . The knot multiplicities do not exceed the degrees, hence all B-splines are continuous.

For each level ℓ we denote with 
                        
                           
                              ⨂
                           
                           
                              i
                              =
                              1
                           
                           
                              d
                           
                        
                        
                           
                              B
                           
                           
                              i
                           
                           
                              ℓ
                           
                        
                      the set of tensor-product B-splines that are obtained by multiplying d univariate B-splines, one from each 
                        
                           
                              B
                           
                           
                              i
                           
                           
                              ℓ
                           
                        
                     . Moreover, we collect the tensor-product B-splines that are not equal to the null function on Ω,
                        
                           
                              
                                 {
                                 
                                    
                                       γ
                                    
                                    
                                       ℓ
                                    
                                 
                                 ∈
                                 
                                    ⨂
                                    
                                       i
                                       =
                                       1
                                    
                                    d
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                    
                                       ℓ
                                    
                                 
                                 |
                                 
                                    
                                       γ
                                    
                                    
                                       ℓ
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       Ω
                                    
                                 
                                 ≠
                                 0
                                 }
                              
                              .
                           
                        
                      In the remainder of the paper we will consider only the restrictions of these B-splines to Ω and denote them simply by 
                        
                           
                              γ
                           
                           
                              i
                           
                           
                              ℓ
                           
                        
                     . They form the (tensor-product) B-spline basis vector
                     
                        
                           
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                       
                                          ℓ
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          γ
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ℓ
                                             
                                          
                                       
                                       
                                          ℓ
                                       
                                    
                                    )
                                 
                                 
                                    T
                                 
                              
                           
                        
                      and we denote its size by 
                        
                           
                              n
                           
                           
                              ℓ
                           
                        
                      (note that ℓ is an upper index, not a power). The elements of this vector span the space
                        
                           
                              
                                 
                                    V
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              span
                              
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    Ω
                                 
                              
                              .
                           
                        
                      The assumption (A2) concerning degrees and multiplicities together with the nestedness of the sequences of grid nodes imply that these spaces are nested, 
                        
                           
                              V
                           
                           
                              ℓ
                           
                        
                        ⊆
                        
                           
                              V
                           
                           
                              ℓ
                              +
                              1
                           
                        
                     . Furthermore, there exist refinement matrices 
                     
                        
                           
                              R
                           
                           
                              ℓ
                           
                        
                        =
                        (
                        
                           
                              r
                           
                           
                              i
                              j
                           
                           
                              ℓ
                           
                        
                        )
                      such that
                        
                           (1)
                           
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 
                                    R
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                              
                              (
                              ℓ
                              =
                              0
                              ,
                              …
                              ,
                              N
                              )
                              .
                           
                        
                      These matrices can be generated with the help of the knot insertion algorithm for B-splines, see Prautzsch et al. (2002). Due to the linear independence and the partition of unity property of tensor-product B-splines, these matrices are left stochastic,
                        1
                     
                     
                        1
                        Here we extend the notion left stochastic to non-square matrices. Products of left stochastic matrices are again left stochastic.
                      i.e., all their entries are nonnegative and the column vectors sum to one. Indeed, Eq. (1) combined with
                        
                           (2)
                           
                              1
                              =
                              
                                 
                                    1
                                 
                                 
                                    ℓ
                                 
                              
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                           
                        
                      implies 
                        
                           
                              1
                           
                           
                              ℓ
                           
                        
                        
                           
                              R
                           
                           
                              ℓ
                              +
                              1
                           
                        
                        =
                        
                           
                              1
                           
                           
                              ℓ
                              +
                              1
                           
                        
                     , where 
                        
                           
                              1
                           
                           
                              k
                           
                        
                      denotes the row vector of dimension 
                        
                           
                              n
                           
                           
                              k
                           
                        
                      with all its elements being equal to 1.

Given an open set 
                        D
                        ⊂
                        
                           
                              R
                           
                           
                              d
                           
                        
                     , we denote with 
                        
                           
                              Π
                           
                           
                              p
                           
                        
                        (
                        
                           D
                           ¯
                        
                        )
                      the linear space of multivariate polynomials of degree p on its closure 
                        
                           D
                           ¯
                        
                      and with 
                        
                           
                              C
                           
                           
                              s
                           
                        
                        (
                        
                           D
                           ¯
                        
                        )
                      the linear space of all functions with the property that all their partial derivatives up to order 
                        s
                        =
                        (
                        
                           
                              s
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              s
                           
                           
                              d
                           
                        
                        )
                      exist at all points of D and they can be continuously extended to the closure 
                        
                           D
                           ¯
                        
                     .


                     
                        Definition 1
                        For each ring 
                              
                                 
                                    Δ
                                 
                                 
                                    ℓ
                                 
                              
                            we define the spline space of level ℓ,
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ℓ
                                       
                                    
                                    =
                                    
                                       {
                                       s
                                       :
                                       
                                          
                                             Δ
                                          
                                          
                                             ℓ
                                          
                                       
                                       →
                                       R
                                       |
                                       s
                                       ∈
                                       
                                          
                                             C
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   ℓ
                                                
                                             
                                             −
                                             
                                                
                                                   m
                                                
                                                
                                                   ℓ
                                                
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                Δ
                                             
                                             
                                                ℓ
                                             
                                          
                                          )
                                       
                                        and 
                                       ∀
                                       c
                                       ∈
                                       
                                          
                                             C
                                          
                                          
                                             ℓ
                                          
                                       
                                       ,
                                       
                                       c
                                       ⊆
                                       
                                          
                                             Δ
                                          
                                          
                                             ℓ
                                          
                                       
                                       :
                                       s
                                       
                                          
                                             |
                                          
                                          
                                             c
                                          
                                       
                                       ∈
                                       
                                          
                                             Π
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   ℓ
                                                
                                             
                                          
                                       
                                       (
                                       c
                                       )
                                       }
                                    
                                    .
                                 
                              
                            Further, we define the multi-level spline space
                           
                              
                                 
                                    S
                                    =
                                    
                                       {
                                       s
                                       :
                                       Ω
                                       →
                                       R
                                       |
                                       
                                          
                                             ∀
                                          
                                          
                                             ℓ
                                             =
                                             0
                                          
                                          
                                             N
                                          
                                       
                                       :
                                       
                                       s
                                       
                                          
                                             |
                                          
                                          
                                             
                                                
                                                   Δ
                                                
                                                
                                                   ℓ
                                                
                                             
                                          
                                       
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             ℓ
                                          
                                       
                                       }
                                    
                                    .
                                 
                              
                           
                        

The remainder of this paper discusses the construction and some properties of a basis for the multi-level spline space under certain assumptions concerning the domain hierarchy.

We enrich the B-spline bases by introducing a decoupling mechanism. This mechanism will allow us to split the B-splines in 
                        
                           
                              G
                           
                           
                              ℓ
                           
                        
                      into several independent components according to the connectivity of the intersection of their support with the corresponding ring 
                        
                           
                              Δ
                           
                           
                              ℓ
                           
                        
                     .

We consider the support of functions defined on Ω,
                        
                           (3)
                           
                              supp
                              
                              f
                              =
                              
                                 {
                                 x
                                 ∈
                                 
                                    Ω
                                    ¯
                                 
                                 |
                                 f
                                 (
                                 x
                                 )
                                 ≠
                                 0
                                 }
                              
                              .
                           
                        
                     
                  

Given a function 
                        
                           
                              γ
                           
                           
                              i
                           
                           
                              ℓ
                           
                        
                        ∈
                        
                           
                              G
                           
                           
                              ℓ
                           
                        
                     , we consider its representation with respect to the basis functions of the next level,
                        
                           (4)
                           
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    
                                       n
                                    
                                    
                                       ℓ
                                       +
                                       1
                                    
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    i
                                    j
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                              
                                 
                                    γ
                                 
                                 
                                    j
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                              .
                           
                        
                      The coefficient vector in this equation is the i-th row vector of the refinement matrix 
                        
                           
                              R
                           
                           
                              ℓ
                              +
                              1
                           
                        
                      in Eq. (1). The decoupling graph 
                     
                        
                           
                              Γ
                           
                           
                              i
                           
                           
                              ℓ
                           
                        
                      is defined as follows:
                        
                           •
                           The basis functions 
                                 
                                    
                                       γ
                                    
                                    
                                       j
                                    
                                    
                                       ℓ
                                       +
                                       1
                                    
                                 
                               with nonzero coefficients 
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       ℓ
                                       +
                                       1
                                    
                                 
                                 ≠
                                 0
                               are vertices of 
                                 
                                    
                                       Γ
                                    
                                    
                                       i
                                    
                                    
                                       ℓ
                                    
                                 
                              .

Two vertices 
                                 
                                    
                                       γ
                                    
                                    
                                       j
                                    
                                    
                                       ℓ
                                       +
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       γ
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       ℓ
                                       +
                                       1
                                    
                                 
                               are connected by an edge if and only if
                                 
                                    
                                       supp
                                       
                                       
                                          
                                             γ
                                          
                                          
                                             j
                                          
                                          
                                             ℓ
                                             +
                                             1
                                          
                                       
                                       ∩
                                       supp
                                       
                                       
                                          
                                             γ
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             ℓ
                                             +
                                             1
                                          
                                       
                                       ∩
                                       
                                          
                                             Δ
                                          
                                          
                                             ℓ
                                          
                                       
                                       ≠
                                       ∅
                                       .
                                    
                                 
                              
                           


                     Fig. 4
                      shows a decoupling graph of a quintic B-spline with uniform knots. In this example, the graph has 7 vertices, 7 edges and three connected components. Uniform dyadic refinement splits the quintic B-splines into 7 finer ones, thus the graph has 7 vertices. The supports of the first four finer B-splines (green dashed lines) mutually intersect each other within 
                        
                           
                              Δ
                           
                           
                              0
                           
                        
                     , hence the corresponding vertices are connected by edges and form a connected component of the graph. Similarly, the supports of the last two finer B-splines (blue and dashed) intersect each other within 
                        
                           
                              Δ
                           
                           
                              0
                           
                        
                     , hence the corresponding vertices are connected by edges and form another connected component of the graph. The remaining finer B-spline (red) corresponds to an isolated vertex of the decoupling graph. See also Example 3.


                     
                        Definition 2
                        We define the decoupled B-splines 
                           
                              
                                 
                                    δ
                                 
                                 
                                    i
                                    ,
                                    Φ
                                 
                                 
                                    ℓ
                                 
                              
                            of level ℓ by
                              
                                 (5)
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          ,
                                          Φ
                                       
                                       
                                          ℓ
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   ℓ
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   γ
                                                
                                                
                                                   j
                                                
                                                
                                                   ℓ
                                                   +
                                                   1
                                                
                                             
                                             ε
                                             
                                             Φ
                                          
                                       
                                    
                                    
                                       
                                          r
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          ℓ
                                          +
                                          1
                                       
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          j
                                       
                                       
                                          ℓ
                                          +
                                          1
                                       
                                    
                                    
                                    
                                       (
                                       ℓ
                                       =
                                       0
                                       ,
                                       …
                                       ,
                                       N
                                       ;
                                       
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             ℓ
                                          
                                       
                                       ;
                                       
                                       Φ
                                       ∈
                                       
                                          
                                             Ξ
                                          
                                          
                                             i
                                          
                                          
                                             ℓ
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        

A similar definition was presented in Mokriš et al. (2014). However, we did not consider the isolated vertices of the decoupling graph there.

Each of the B-splines of level ℓ is split into one or more decoupled B-splines, one for each connected component of the decoupling graph. Each decoupled B-spline is a linear combination of B-splines of level 
                        ℓ
                        +
                        1
                     , with coefficients inherited from the B-spline refinement equation. Note that the decoupled B-splines are not necessarily different from each other. In particular, each B-spline 
                        
                           
                              γ
                           
                           
                              j
                           
                           
                              ℓ
                              +
                              1
                           
                        
                      of level 
                        ℓ
                        +
                        1
                      with 
                        supp
                        
                        
                           
                              γ
                           
                           
                              j
                           
                           
                              ℓ
                              +
                              1
                           
                        
                        ∩
                        
                           
                              Δ
                           
                           
                              ℓ
                           
                        
                        =
                        ∅
                     , which is therefore an isolated vertex of the decoupling graphs, may be present as a decoupled B-spline (scaled differently) several times.


                     
                        Example 3
                        
                           Fig. 4 shows the decoupling graph and the decoupled B-splines which are obtained from a single quintic B-spline of degree 5 with uniform knots 
                              (
                              …
                              ,
                              −
                              0.2
                              ,
                              0
                              ,
                              0.2
                              ,
                              …
                              )
                            and dyadic refinement. Choosing the domain 
                              
                                 
                                    Ω
                                 
                                 
                                    1
                                 
                              
                              =
                              (
                              0.4
                              ,
                              1
                              )
                            leads to three decoupled B-splines.

In order to describe the relation between B-splines and decoupled B-splines in detail, we collect the decoupled B-splines of level ℓ in a column vector
                        
                           
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                       
                                       
                                          ℓ
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                ℓ
                                             
                                          
                                       
                                       
                                          ℓ
                                       
                                    
                                    )
                                 
                                 
                                    T
                                 
                              
                           
                        
                      of dimension
                        
                           
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    
                                       n
                                    
                                    
                                       ℓ
                                    
                                 
                              
                              
                                 |
                                 
                                    
                                       Ξ
                                    
                                    
                                       i
                                    
                                    
                                       ℓ
                                    
                                 
                                 |
                              
                              .
                           
                        
                      Here 
                        |
                        
                           
                              Ξ
                           
                           
                              i
                           
                           
                              ℓ
                           
                        
                        |
                      denotes the number of elements of the set 
                        
                           
                              Ξ
                           
                           
                              i
                           
                           
                              ℓ
                           
                        
                     , i.e., the number of connected components of the decoupling graph 
                        
                           
                              Γ
                           
                           
                              i
                           
                           
                              ℓ
                           
                        
                     .

Each of the functions 
                        
                           
                              δ
                           
                           
                              i
                              ,
                              Φ
                           
                           
                              ℓ
                           
                        
                      from Definition 2 defines exactly one element of the vector 
                        
                           
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              ℓ
                           
                        
                     ,
                        
                           
                              
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                    (
                                    i
                                    ,
                                    Φ
                                    )
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 
                                    δ
                                 
                                 
                                    i
                                    ,
                                    Φ
                                 
                                 
                                    ℓ
                                 
                              
                              ,
                           
                        
                      where the index 
                        k
                        =
                        k
                        (
                        i
                        ,
                        Φ
                        )
                      is determined by the index i of the original B-spline 
                        
                           
                              γ
                           
                           
                              i
                           
                           
                              ℓ
                           
                        
                      and by the connected component Φ of the decoupling graph. A suitable ordering of 
                        
                           
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              ℓ
                           
                        
                      will be suggested in the next section.


                     
                        Example 4
                        It is possible that the decoupled B-splines 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                            are linearly dependent. As an example, we consider bi-quartic B-splines with single knots on a uniform grid and dyadic refinement. Fig. 5
                            shows two functions (top left and top right; both represented by their supports). The refined grid has been omitted. For both functions, the decoupling graph consists of two connected components that possess edges and a number of isolated vertices (see Fig. 6
                           ). The supports of the decoupled functions obtained from the first two components are shown in the center of the top row and in the bottom row, left and right. The isolated vertices of both graphs produce 16 decoupled B-splines, which are the same (though scaled differently) for both functions; the union of their supports is shown in the center of the bottom row. Consequently, 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                            is linearly dependent.

The refinement equation between B-splines and decoupled B-splines,
                        
                           (6)
                           
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 
                                    D
                                 
                                 
                                    ℓ
                                 
                              
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                              ,
                           
                        
                      can be formulated with the help of a left stochastic matrix 
                        
                           
                              D
                           
                           
                              ℓ
                           
                        
                     ,
                        
                           (7)
                           
                              
                                 
                                    1
                                 
                                 
                                    ℓ
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              1
                           
                           
                              ℓ
                           
                        
                      and 
                        
                           
                              
                                 
                                    1
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              ℓ
                           
                        
                      denote the row vectors of dimensions 
                        
                           
                              n
                           
                           
                              ℓ
                           
                        
                      and 
                        
                           
                              
                                 
                                    n
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              ℓ
                           
                        
                     , respectively, with all elements equal to 1. Indeed, since any B-spline is split into a sum of decoupled B-splines, all entries of this matrix are zero except for one entry per column, which is equal to 1.

The refinement equation between the decoupled B-splines and the B-splines of the next finer level takes the form
                        
                           (8)
                           
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 
                                    X
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              X
                           
                           
                              ℓ
                              +
                              1
                           
                        
                      is a left stochastic matrix. Eqs. (2), (6) and (7) give
                        
                           
                              1
                              =
                              
                                 
                                    1
                                 
                                 
                                    ℓ
                                 
                              
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    ℓ
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    ℓ
                                 
                              
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                              ,
                           
                        
                      hence we conclude by comparing the coefficients that 
                        
                           
                              
                                 
                                    1
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              ℓ
                           
                        
                        
                           
                              X
                           
                           
                              ℓ
                              +
                              1
                           
                        
                        =
                        
                           
                              1
                           
                           
                              ℓ
                              +
                              1
                           
                        
                     , as the elements of 
                        
                           
                              G
                           
                           
                              ℓ
                              +
                              1
                           
                        
                      are linearly independent. In fact, the entries of each row of the refinement matrix in Eq. (1) are distributed into several rows of the matrix 
                        
                           
                              X
                           
                           
                              ℓ
                              +
                              1
                           
                        
                     , one for each connected component of the decoupling graph.

The next lemma summarizes several properties of decoupled B-splines.


                     
                        Lemma 5
                        
                           We consider the decoupled B-splines 
                           
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                            
                           of level ℓ.
                           
                              
                                 (i)
                                 
                                    The sum of the decoupled B-splines derived from a B-spline is the B-spline itself,
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   Φ
                                                   ∈
                                                   
                                                      
                                                         Ξ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   ,
                                                   Φ
                                                
                                                
                                                   ℓ
                                                
                                             
                                             =
                                             
                                                
                                                   γ
                                                
                                                
                                                   i
                                                
                                                
                                                   ℓ
                                                
                                             
                                             .
                                          
                                       
                                     
                                    In particular, if 
                                    
                                       supp
                                       
                                       
                                          
                                             γ
                                          
                                          
                                             i
                                          
                                          
                                             ℓ
                                          
                                       
                                       ⊆
                                       
                                          
                                             Δ
                                          
                                          
                                             ℓ
                                          
                                       
                                    
                                    , then 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             i
                                          
                                          
                                             ℓ
                                          
                                       
                                     
                                    decouples into exactly one function 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             i
                                             ,
                                             Φ
                                          
                                          
                                             ℓ
                                          
                                       
                                       =
                                       
                                          
                                             γ
                                          
                                          
                                             i
                                          
                                          
                                             ℓ
                                          
                                       
                                    
                                    .
                                 


                                    If 
                                    
                                       Φ
                                       ≠
                                       
                                          
                                             Φ
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    , then
                                    
                                       
                                          
                                             supp
                                             
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   ,
                                                   Φ
                                                
                                             
                                             ∩
                                             supp
                                             
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   ,
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             ∩
                                             
                                                
                                                   Δ
                                                
                                                
                                                   ℓ
                                                
                                             
                                             =
                                             ∅
                                             .
                                          
                                       
                                    
                                 


                                    The decoupled B-splines possess the property of local linear independence on 
                                       
                                          
                                             Δ
                                          
                                          
                                             ℓ
                                          
                                       
                                    
                                    . More precisely, for any open set 
                                    
                                       D
                                       ⊂
                                       
                                          
                                             Δ
                                          
                                          
                                             ℓ
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             0
                                             
                                                
                                                   |
                                                
                                                
                                                   D
                                                
                                             
                                             =
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                             
                                                
                                                   ξ
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   j
                                                
                                                
                                                   ℓ
                                                
                                             
                                             
                                                
                                                   |
                                                
                                                
                                                   D
                                                
                                             
                                             
                                             ⇒
                                             
                                             ∀
                                             j
                                             =
                                             0
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   ℓ
                                                
                                             
                                             :
                                             
                                             
                                                
                                                   ξ
                                                
                                                
                                                   j
                                                
                                             
                                             =
                                             0
                                             ∨
                                             supp
                                             
                                             
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   j
                                                
                                                
                                                   ℓ
                                                
                                             
                                             ∩
                                             D
                                             =
                                             ∅
                                             .
                                          
                                       
                                    
                                 


                     
                        Proof
                        The first two properties follow directly from Definition 2. In order to prove the third observation, we note that the decoupled B-splines form a decomposition of each B-spline into several functions with disjoint supports on 
                              
                                 
                                    Δ
                                 
                                 
                                    ℓ
                                 
                              
                           . Since the B-splines possess the property of local linear independence, this is also true for the decoupled B-splines on 
                              
                                 
                                    Δ
                                 
                                 
                                    ℓ
                                 
                              
                           .  □

Note that the local linear independence of 
                        
                           
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              ℓ
                           
                        
                      on 
                        
                           
                              Δ
                           
                           
                              ℓ
                           
                        
                      does not imply its linear independence on Ω, cf. Example 4.


                     
                        Proposition 6
                        
                           The decoupled B-splines form a nonnegative partition of unity,
                           
                              
                                 
                                    1
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ℓ
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          ℓ
                                       
                                    
                                    
                                    
                                       and
                                    
                                    
                                    ∀
                                    x
                                    ∈
                                    Ω
                                    :
                                    
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          ℓ
                                       
                                    
                                    (
                                    x
                                    )
                                    ≥
                                    0
                                 
                              
                           
                        


                     
                        Proof
                        Since the matrix 
                              
                                 
                                    X
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                            is left stochastic, we get
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ℓ
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          ℓ
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          ℓ
                                          +
                                          1
                                       
                                    
                                    .
                                 
                              
                            The B-splines of level 
                              ℓ
                              +
                              1
                            form a nonnegative partition of unity,
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          ℓ
                                          +
                                          1
                                       
                                    
                                    
                                       
                                          G
                                       
                                       
                                          ℓ
                                          +
                                          1
                                       
                                    
                                    =
                                    1
                                    .
                                 
                              
                            The proof can be completed by combining both observations.  □


                     
                        Proposition 7
                        
                           The vectors of decoupled B-splines satisfy the refinement equations
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ℓ
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ℓ
                                          +
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ℓ
                                          +
                                          1
                                       
                                    
                                    
                                    (
                                    ℓ
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    N
                                    −
                                    1
                                    )
                                    ,
                                 
                              
                            
                           where all matrices 
                           
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                            
                           are left stochastic.
                        


                     
                        Proof
                        Eqs. (6) and (8) imply
                              
                                 
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ℓ
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          X
                                       
                                       
                                          ℓ
                                          +
                                          1
                                       
                                    
                                    
                                       
                                          D
                                       
                                       
                                          ℓ
                                          +
                                          1
                                       
                                    
                                    .
                                 
                              
                            The product of two left stochastic matrices is again left stochastic.  □


                     
                        Example 8
                        In case of biquadratic splines with dyadic refinement and single knots each basis function from 
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                 
                              
                            has a support consisting of 
                              3
                              ×
                              3
                            cells. The possible shapes of the supports of decoupled functions are shown in Fig. 7
                            (up to rotations and symmetries). An example of a mesh with all these basis functions is shown in Fig. 8
                           .

We define hierarchical and truncated hierarchical decoupled splines. Our construction generalizes the results of Kraft (1997) and Giannelli et al. (2012). However, since the systems of decoupled B-splines are not guaranteed to be linearly independent, we use the approach that was developed in Zore and Jüttler (2014).

This approach is based on the observation that we may split each of the vectors 
                        
                           
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              ℓ
                           
                        
                      of decoupled B-splines into three sub-vectors 
                        
                           
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              A
                           
                           
                              ℓ
                           
                        
                     , 
                        
                           
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              B
                           
                           
                              ℓ
                           
                        
                      and 
                        
                           
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              C
                           
                           
                              ℓ
                           
                        
                     ,
                        
                           (9)
                           
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                1
                                             
                                             
                                                ℓ
                                             
                                          
                                       
                                    
                                    
                                       
                                          ⋮
                                       
                                    
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                             
                                                ℓ
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                             
                                                A
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                B
                                             
                                             
                                                ℓ
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                C
                                             
                                             
                                                ℓ
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        
                      such that
                        
                           
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                                 
                                    ℓ
                                 
                              
                               is an element of 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    A
                                 
                                 
                                    ℓ
                                 
                              
                              ⇔
                              supp
                              
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                                 
                                    ℓ
                                 
                              
                              ⊈
                              
                                 
                                    Ω
                                 
                                 
                                    ℓ
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                                 
                                    ℓ
                                 
                              
                               is an element of 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    C
                                 
                                 
                                    ℓ
                                 
                              
                              ⇔
                              supp
                              
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                                 
                                    ℓ
                                 
                              
                              ⊆
                              
                                 
                                    Ω
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                                 
                                    ℓ
                                 
                              
                               is an element of 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    B
                                 
                                 
                                    ℓ
                                 
                              
                               otherwise
                              .
                           
                        
                      More precisely, we assume that the order of the decoupled B-splines within the vectors 
                        
                           
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              ℓ
                           
                        
                      has been chosen so that this splitting into sub-vectors becomes feasible.

Clearly, the three sub-vectors have mutually different entries, since the domains 
                        
                           
                              Ω
                           
                           
                              ℓ
                           
                        
                      are assumed to be nested. Also, it should be noted that not all sub-vectors are present at all levels. For instance, both 
                        
                           
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              A
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              C
                           
                           
                              N
                           
                        
                      are void.

The elements of the two sub-vectors 
                        
                           
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              A
                           
                           
                              ℓ
                           
                        
                      and 
                        
                           
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              B
                           
                           
                              ℓ
                           
                        
                      are linearly independent. This is due to the fact that 
                        
                           
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              ℓ
                           
                        
                      possesses the property of local linear independence on 
                        
                           
                              Δ
                           
                           
                              ℓ
                           
                        
                      (see Lemma 5(iii)) and these two subvectors contain exactly the decoupled B-splines that do not vanish on 
                        
                           
                              Δ
                           
                           
                              ℓ
                           
                        
                     .

The refinement equation from Proposition 7 can now be formulated with a matrix consisting of 
                        3
                        ×
                        3
                      blocks,
                        
                           (10)
                           
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                             
                                                A
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                B
                                             
                                             
                                                ℓ
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                C
                                             
                                             
                                                ℓ
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                A
                                                A
                                             
                                             
                                                ℓ
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                R
                                             
                                             
                                                A
                                                B
                                             
                                             
                                                ℓ
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                R
                                             
                                             
                                                A
                                                C
                                             
                                             
                                                ℓ
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                B
                                                A
                                             
                                             
                                                ℓ
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                R
                                             
                                             
                                                B
                                                B
                                             
                                             
                                                ℓ
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                R
                                             
                                             
                                                B
                                                C
                                             
                                             
                                                ℓ
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          
                                             
                                                R
                                             
                                             
                                                C
                                                B
                                             
                                             
                                                ℓ
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                R
                                             
                                             
                                                C
                                                C
                                             
                                             
                                                ℓ
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                A
                                             
                                             
                                                ℓ
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                B
                                             
                                             
                                                ℓ
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                C
                                             
                                             
                                                ℓ
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    R
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                              .
                           
                        
                      The lower left block-matrix is a null matrix 0, since 
                        
                           
                              R
                           
                           
                              ℓ
                              +
                              1
                           
                        
                      has nonnegative entries, the decoupled B-splines are nonnegative, and 
                        supp
                        
                        
                           
                              
                                 
                                    G
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              C
                           
                           
                              ℓ
                           
                        
                        ⊆
                        
                           
                              Ω
                           
                           
                              ℓ
                              +
                              1
                           
                        
                     .


                     
                        Definition 9
                        We define the decoupled hierarchical B-splines
                           
                              
                                 
                                    K
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                B
                                             
                                             
                                                ℓ
                                             
                                          
                                          )
                                       
                                       
                                          ℓ
                                          =
                                          0
                                       
                                       
                                          N
                                       
                                    
                                 
                              
                            and the truncated decoupled hierarchical B-splines
                           
                              
                                 
                                    T
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                ℓ
                                             
                                          
                                          )
                                       
                                       
                                          ℓ
                                          =
                                          0
                                       
                                       
                                          N
                                       
                                    
                                    ,
                                 
                              
                            where
                              
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ℓ
                                       
                                    
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          B
                                          A
                                       
                                       
                                          ℓ
                                          +
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          ∏
                                          
                                             k
                                             =
                                             ℓ
                                             +
                                             2
                                          
                                          N
                                       
                                       
                                          
                                             R
                                          
                                          
                                             A
                                             A
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          A
                                       
                                       
                                          N
                                       
                                    
                                    
                                    (
                                    ℓ
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    N
                                    −
                                    1
                                    )
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    N
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    B
                                 
                                 
                                    N
                                 
                              
                           .

The following results have been derived in the general setting, see Zore and Jüttler (2014):
                        
                           •
                           The two systems of functions 
                                 K
                               and 
                                 T
                               have the same number of elements and they span the same space.

When restricted to 
                                 
                                    
                                       Δ
                                    
                                    
                                       ℓ
                                    
                                 
                              , the functions in 
                                 
                                    
                                       
                                          
                                             G
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       B
                                    
                                    
                                       ℓ
                                    
                                 
                               and 
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ℓ
                                    
                                 
                               are identical,
                                 
                                    
                                       
                                          
                                             
                                                
                                                   G
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             B
                                          
                                          
                                             ℓ
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             
                                                
                                                   Δ
                                                
                                                
                                                   ℓ
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ℓ
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             
                                                
                                                   Δ
                                                
                                                
                                                   ℓ
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

Both 
                                 K
                               and 
                                 T
                               are linearly independent. This follows directly from the fact that the decoupled B-splines 
                                 
                                    
                                       
                                          
                                             G
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ℓ
                                    
                                 
                               possess the property of local linear independence on 
                                 
                                    
                                       Δ
                                    
                                    
                                       ℓ
                                    
                                 
                              , see Lemma 5(iii).

The truncated decoupled hierarchical B-splines form a nonnegative partition of unity,
                                 
                                    
                                       
                                          ∑
                                          
                                             ℓ
                                             =
                                             0
                                          
                                          N
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                B
                                             
                                             
                                                ℓ
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   τ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                          
                                          
                                             ℓ
                                          
                                       
                                       =
                                       1
                                       
                                       and
                                       
                                       all 
                                       
                                          
                                             
                                                
                                                   τ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                          
                                          
                                             ℓ
                                          
                                       
                                       ≥
                                       0
                                       
                                       on 
                                       Ω
                                       ,
                                    
                                 
                               where 
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ℓ
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   τ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             1
                                          
                                          
                                             ℓ
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   τ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   B
                                                
                                                
                                                   ℓ
                                                
                                             
                                          
                                          
                                             ℓ
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                               and 
                                 
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       B
                                    
                                    
                                       ℓ
                                    
                                 
                               is the size of 
                                 
                                    
                                       
                                          
                                             G
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       B
                                    
                                    
                                       ℓ
                                    
                                 
                              . This fact is implied by Proposition 6.


                     
                        Example 10
                        We continue Example 3 and compare the effects of truncation and decoupling in Fig. 9
                           . First we apply only truncation, thus we obtain only one function. The upper picture shows the functions obtained after truncation with respect to level 1 (blue, dashed) and after truncation with respect to both levels 1 and 2 (blue, solid). The bottom picture shows the corresponding decoupled functions.

We identify conditions that guarantee the completeness of (truncated) decoupled hierarchical B-splines, i.e., conditions that allow to represent any piecewise polynomial function of the given degree and smoothness on the hierarchical grid determined by the hierarchies of spaces and domains. First we recall a result from Mokriš et al. (2014):


                     
                        Proposition 11
                        
                           Consider the sets 
                           
                              supp
                              
                              δ
                              ∩
                              
                                 
                                    Δ
                                 
                                 
                                    ℓ
                                 
                              
                           
                           , where δ is any element of 
                           
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    A
                                 
                                 
                                    ℓ
                                 
                              
                            
                           or 
                           
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    B
                                 
                                 
                                    ℓ
                                 
                              
                           
                           . If all these sets are connected, then the elements of the two vectors 
                           
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    A
                                 
                                 
                                    ℓ
                                 
                              
                            
                           and 
                           
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    B
                                 
                                 
                                    ℓ
                                 
                              
                            
                           form a basis of the spline space 
                           
                              
                                 
                                    S
                                 
                                 
                                    ℓ
                                 
                              
                           
                           .
                        


                     
                        Proof
                        Consider the decoupled basis functions that are derived from a given B-spline γ. When restricted to 
                              
                                 
                                    Δ
                                 
                                 
                                    ℓ
                                 
                              
                           , these functions have mutually disjoint supports. On each connected component of 
                              supp
                              
                              γ
                              ∩
                              
                                 
                                    Δ
                                 
                                 
                                    ℓ
                                 
                              
                           , exactly one of them is equal to the B-spline γ, while the remaining functions vanish identically. These properties are implied by Lemma 5(i) and (ii). Consequently, each of the decoupled B-splines from 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    A
                                 
                                 
                                    ℓ
                                 
                              
                            or 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    B
                                 
                                 
                                    ℓ
                                 
                              
                           , restricted to 
                              
                                 
                                    Δ
                                 
                                 
                                    ℓ
                                 
                              
                           , is equal to exactly one of the functions that form the basis described in Mokriš et al. (2014, Theorem 2.12).  □

Note that a ring 
                        
                           
                              Δ
                           
                           
                              ℓ
                           
                        
                      may contain kissing edges, kissing vertices, etc. If such a kissing feature is contained in the support of a decoupled function, then the intersection of the support with 
                        
                           
                              Δ
                           
                           
                              ℓ
                           
                        
                      is connected across that feature, since 
                        
                           
                              Δ
                           
                           
                              ℓ
                           
                        
                      is a closed set.

Now we formulate the main result of the paper.


                     
                        Theorem 12
                        
                           If the assumptions of 
                           
                              Proposition 11
                            
                           are satisfied for all 
                           
                              ℓ
                              =
                              0
                              ,
                              …
                              ,
                              N
                           
                           , then each of the systems 
                           
                              K
                            
                           and 
                           
                              T
                            
                           forms a basis of 
                           
                              S
                           
                           . Moreover, 
                           
                              T
                            
                           is a nonnegative partition of unity.
                        


                     
                        Proof
                        The proof is fairly similar to the proof of Theorem 20 in Giannelli and Jüttler (2013). Nevertheless, since there are a few subtle differences and in order to make this paper self-contained, we repeat it here in a compact form.

We consider a function 
                              s
                              ∈
                              S
                           . We will show that there exist 
                              N
                              +
                              1
                            functions
                              
                                 (11)
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ℓ
                                       
                                    
                                    ∈
                                    span
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  G
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                   
                                                   
                                                      A
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      B
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                    (
                                    ℓ
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    N
                                    )
                                 
                              
                            such that
                              
                                 (12)
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ℓ
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                Δ
                                             
                                             
                                                ℓ
                                             
                                          
                                       
                                    
                                    =
                                    
                                       (
                                       s
                                       −
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             ℓ
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                Δ
                                             
                                             
                                                ℓ
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                            using induction with respect to ℓ.

For 
                              ℓ
                              =
                              0
                            this follows directly from Proposition 11 and from the definition of 
                              S
                           . According to the latter, 
                              s
                              ∈
                              S
                            implies 
                              s
                              
                                 
                                    |
                                 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              ∈
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                              
                           . Recall that 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    A
                                 
                                 
                                    0
                                 
                              
                            is void. Now, in order to proceed from 
                              ℓ
                              −
                              1
                            to ℓ, we first prove that the right-hand side of Eq. (12) belongs to 
                              
                                 
                                    S
                                 
                                 
                                    ℓ
                                 
                              
                           . Once again, according to the definition of 
                              S
                           , 
                              s
                              ∈
                              S
                            implies 
                              s
                              
                                 
                                    |
                                 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          ℓ
                                       
                                    
                                 
                              
                              ∈
                              
                                 
                                    S
                                 
                                 
                                    ℓ
                                 
                              
                           . Consequently, Proposition 11 guarantees that 
                              s
                              
                                 
                                    |
                                 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          ℓ
                                       
                                    
                                 
                              
                            can be represented by a linear combination of functions from 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    A
                                 
                                 
                                    ℓ
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    B
                                 
                                 
                                    ℓ
                                 
                              
                           . In addition, since
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    ∈
                                    span
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  G
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      A
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      B
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                    (
                                    k
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    ℓ
                                    −
                                    1
                                    )
                                 
                              
                            there exist row vectors 
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                            such that
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          c
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          c
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    =
                                    ⋯
                                    =
                                    
                                       
                                          c
                                       
                                       
                                          k
                                       
                                    
                                    
                                       ∏
                                       
                                          j
                                          =
                                          k
                                          +
                                          1
                                       
                                       N
                                    
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ℓ
                                       
                                    
                                    .
                                 
                              
                            Here we used the refinement equations (7) in order to express each 
                              
                                 
                                    s
                                 
                                 
                                    k
                                 
                              
                            with respect to the decoupled B-splines of level ℓ. The definition of the sub-vectors in (9) now implies that
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                Δ
                                             
                                             
                                                ℓ
                                             
                                          
                                       
                                    
                                    ∈
                                    span
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        G
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  ℓ
                                                               
                                                            
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  G
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            B
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          |
                                       
                                       
                                          
                                             
                                                Δ
                                             
                                             
                                                ℓ
                                             
                                          
                                       
                                    
                                    
                                    (
                                    k
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    ℓ
                                    −
                                    1
                                    )
                                    .
                                 
                              
                            Thus, we can find 
                              
                                 
                                    s
                                 
                                 
                                    ℓ
                                 
                              
                            satisfying (11) and (12). This completes the induction step.

Analyzing the right-hand side of Eq. (12) confirms that 
                              
                                 
                                    s
                                 
                                 
                                    ℓ
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          ℓ
                                          −
                                          1
                                       
                                    
                                 
                              
                              =
                              0
                           . Therefore, the local linear independence of the decoupled B-splines (Lemma 5(ii)) and the definition of the sub-vectors in (9) imply that the coefficients with respect to 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    A
                                 
                                 
                                    ℓ
                                 
                              
                            are zero, and thus 
                              
                                 
                                    s
                                 
                                 
                                    ℓ
                                 
                              
                              ∈
                              span
                              
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    B
                                 
                                 
                                    ℓ
                                 
                              
                           .

Finally, if we rewrite (12) for 
                              ℓ
                              =
                              N
                           , we obtain
                              
                                 
                                    s
                                    =
                                    s
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                Δ
                                             
                                             
                                                N
                                             
                                          
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          ℓ
                                          =
                                          0
                                       
                                       N
                                    
                                    
                                       
                                          s
                                       
                                       
                                          ℓ
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                Δ
                                             
                                             
                                                N
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                            which proves that 
                              K
                              =
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          B
                                       
                                       
                                          ℓ
                                       
                                    
                                    )
                                 
                                 
                                    ℓ
                                    =
                                    0
                                 
                                 
                                    N
                                 
                              
                            spans 
                              S
                           . Both 
                              K
                            and 
                              T
                            are known to be linearly independent and to span the same space, see Section 4. Moreover 
                              T
                            is known to be a nonnegative partition of unity.  □

One of the motivations for introducing the decoupled basis is to relax the assumptions on the rings 
                        
                           
                              Δ
                           
                           
                              ℓ
                           
                        
                      that are sufficient to guarantee the completeness of 
                        K
                      and 
                        T
                     . More precisely, we obtain the following result.


                     
                        Theorem 13
                        
                           A sufficient condition for the assumption of 
                           
                              Proposition 11
                            
                           to be satisfied is that none of the basis functions from the finer level (i.e., from 
                           
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                           
                           ) intersects 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    ℓ
                                 
                              
                            
                           in more than one connected set.
                        


                     
                        Proof
                        The proof follows immediately from the fact that the support of each decoupled B-spline from 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    A
                                 
                                 
                                    ℓ
                                 
                              
                              ∪
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    B
                                 
                                 
                                    ℓ
                                 
                              
                            is the union of supports of B-splines from the next level that are vertices of one connected component of the decoupling graph obtained for one B-spline of level ℓ, see Lemma 5(i).  □

Now we are going to discuss several cases where this assumption is satisfied.


                     
                        Corollary 14
                        
                           Suppose that the degrees are independent of the level, 
                           
                              
                                 
                                    p
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              p
                           
                           , and all knots possess multiplicity 1. When using 
                           p
                           -adic refinement (i.e., each cell of level ℓ is split into 
                           
                              
                                 
                                    p
                                 
                                 
                                    1
                                 
                              
                              ×
                              ⋯
                              ×
                              
                                 
                                    p
                                 
                                 
                                    d
                                 
                              
                            
                           cells of level 
                           
                              ℓ
                              +
                              1
                           
                           ), the basis 
                           
                              T
                            
                           spans the entire space 
                           
                              S
                            
                           and this basis forms a nonnegative partition of unity.
                        


                     
                        Proof
                        Under this assumption, the support of each function from 
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                            is contained in 
                              (
                              
                                 
                                    p
                                 
                                 
                                    1
                                 
                              
                              +
                              1
                              )
                              ×
                              ⋯
                              ×
                              (
                              
                                 
                                    p
                                 
                                 
                                    d
                                 
                              
                              +
                              1
                              )
                            cells of level 
                              ℓ
                              +
                              1
                           . This guarantees that its intersection with 
                              
                                 
                                    Δ
                                 
                                 
                                    ℓ
                                 
                              
                            is always connected and the claim follows from Theorem 13. Alternatively, we may notice that the support of each function from 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                            is contained in 
                              2
                              ×
                              ⋯
                              ×
                              2
                            cells of level ℓ and refer directly to Theorem 12.  □

An example is shown in Fig. 10
                     .

The following corollary relaxes the assumption 
                        2
                        
                           
                              m
                           
                           
                              ℓ
                           
                        
                        ≥
                        
                           
                              p
                           
                           
                              ℓ
                           
                        
                        +
                        1
                     , 
                        1
                        =
                        
                           
                              (
                              1
                              ,
                              …
                              ,
                              1
                              )
                           
                           
                              T
                           
                        
                     , characterizing the case of reduced smoothness that is considered frequently in the literature, e.g., by Deng et al. (2006) or Schumaker and Wang (2012).


                     
                        Corollary 15
                        
                           If the cells in level ℓ are refined by splitting them into 
                           
                              
                                 
                                    2
                                 
                                 
                                    d
                                 
                              
                            
                           cells of level 
                           
                              ℓ
                              +
                              1
                            
                           (dyadic refinement) and the multiplicities satisfy
                           
                              
                                 
                                    3
                                    
                                       
                                          m
                                       
                                       
                                          ℓ
                                       
                                    
                                    ≥
                                    
                                       
                                          p
                                       
                                       
                                          ℓ
                                       
                                    
                                    +
                                    1
                                    ,
                                 
                              
                            
                           then 
                           
                              T
                            
                           is a basis of 
                           
                              S
                            
                           and it forms a nonnegative partition of unity.
                        


                     
                        Proof
                        Under this assumption concerning knot multiplicities, the support of each function from 
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                    +
                                    1
                                 
                              
                            is contained in 
                              3
                              ×
                              ⋯
                              ×
                              3
                            cells of level 
                              ℓ
                              +
                              1
                           . This implies that its intersection with 
                              
                                 
                                    Δ
                                 
                                 
                                    ℓ
                                 
                              
                            is always connected and we may again use Theorem 13.  □

See Fig. 11
                      for an example.


                     
                        Remark 16
                        Note that both results are valid for any dimension, but they apply only to box-meshes that are obtained by p-adic/dyadic refinement. More general configurations have also been studied in the literature, mostly in the bivariate case. We mention the recent results on bivariate splines on more general T-meshes (but with slightly lower smoothness) by Schumaker and Wang (2012). This analysis also includes results concerning the approximation power and the stability properties.

Finally we consider the case of maximum smoothness and uniform degrees.


                     
                        Corollary 17
                        
                           Consider the case 
                           
                              d
                              =
                              2
                            
                           or 
                           
                              d
                              =
                              3
                            
                           with dyadic refinement, uniform degrees 
                           
                              
                                 
                                    p
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              (
                              p
                              ,
                              …
                              ,
                              p
                              )
                            
                           and uniform knots of multiplicity 1 at all levels. If the offsets for all distances up to 
                           
                              
                                 
                                    p
                                    −
                                    1
                                 
                                 4
                              
                            
                           with respect to the grid size of level ℓ (that is, the offsets for all distances up to 
                           
                              
                                 
                                    p
                                    −
                                    1
                                 
                                 2
                              
                            
                           with respect to the gridsize of the finer mesh) of each ring 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    ℓ
                                 
                              
                            
                           do not have any self-intersections, then 
                           
                              T
                            
                           is a basis of 
                           
                              S
                            
                           and forms a nonnegative partition of unity.
                        

Here we consider the offset with respect to the maximum norm. We refer to Mokriš et al. (2014) for the precise definition. Fig. 12
                      shows an example for 
                        d
                        =
                        2
                     .


                     
                        Remark 18
                        Multivariate quadratic 
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                           -smooth splines on meshes with dyadic refinement (where each box is refined into 
                              
                                 
                                    2
                                 
                                 
                                    d
                                 
                              
                            smaller boxes) are covered by all three corollaries. The offset condition from Corollary 17 is then automatically fulfilled.

Interestingly, not all the edges (or, more generally, interfaces between adjacent edges) are necessarily being used by some of the basis functions. Fig. 13
                      shows an example of a T-mesh with “passive” edges.

@&#CONCLUSIONS AND FUTURE WORK@&#

We presented the construction of truncated decoupled hierarchical B-splines. It generalizes the classical hierarchical construction and it keeps some of the desirable properties of B-splines (e.g., linear independence, nonnegative partition of unity) while simultaneously providing a richer set of basis functions.

Further work may include investigation of approximation properties of this basis, derivation of an explicit dimension formula and practical applications in Isogeometric Analysis and Geometric Modeling.

@&#ACKNOWLEDGEMENTS@&#

The authors have been supported by the Austrian Science Fund (FWF), NFN S117 “Geometry + Simulation” and by the EC through the 7th Framework programme, project EXAMPLE, GA No. 324340.

@&#REFERENCES@&#

