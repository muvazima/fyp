@&#MAIN-TITLE@&#Interactive real-time physics

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Unified physics engine for both static–dynamic load analysis, structural optimization and form finding.


                        
                        
                           
                           The implementation combines dynamic relaxation and co-rotational formulation.


                        
                        
                           
                           Interactive structural analysis as a teaching and design aid.


                        
                        
                           
                           Interactive structural form-finding.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Interactive structural analysis

Interactive structural form finding

Co-rotational formulation

Dynamic relaxation

@&#ABSTRACT@&#


               
               
                  Real-time physics simulation has been extensively used in computer games, but its potential has yet to be fully realized in design and education. We present an interactive 3D physics engine with a wide variety of applications.
                  In common with traditional FEM, the use of a local element stiffness matrix is retained. However, unlike typical non-linear FEM routines elements forces, moments and inertia are appropriately lumped at nodes following the dynamic relaxation method. A semi-implicit time integration scheme updates linear and angular momentum, and subsequently the local coordinate frames of the nodes. A co-rotational approach is used to compute the resultant field of displacements in global coordinates including the effect of large deformations. The results obtained compare well against established commercial software.
                  We demonstrate that the method presented allows the making of interactive structural models that can be used in teaching to develop an intuitive understanding of structural behaviour. We also show that the same interactive physics framework allows real-time optimization that can be used for geometric and structural design applications.
               
            

@&#INTRODUCTION@&#

This paper describes the formulation of a physics engine which combines the principle aspects of Dynamic Relaxation [1] and those of the co-rotational formulation for the Finite Elements Method [2]. Our formulation draws on the work done by Williams [3] and shares similarities with recently published works in the literature [4]. Our contribution is to frame dynamic relaxation within the co-rotational approach in order to enable both the static and dynamic simulation of structures with geometrically non-linear behaviour (i.e. small strains, finite displacements and rotations). Such an approach aims at building a unified engine that can use linear formulations for conventional beams, shells/plates and 3D elements whilst being able to compute accurately displacement and stress fields in both static and dynamic problems.

The formulation lies at the core of software, implemented by the authors, which has been published online as a java applet (http://expeditionworkshed.org/) in 2011 and since then adopted in both design and education by several universities in the UK. A description of their applications such as geometric and structural optimization tasks and the development of interactive structural models for teaching aid are given in the last section of the paper.

Computational mechanics based on particle systems have been extensively used in computer graphics for realistic simulation of rigid and deformable bodies, elastoplastic deformation, fractures and fluids [5,6]. These applications frequently make use of the Verlet integration scheme [7], a method originally developed for simulation of molecular dynamics. This scheme can be shown to be very closely linked to the method of dynamic relaxation, a numerical method formulated as an alternative to other relaxation techniques such as Gauss–Seidel or successive over relaxation for solving systems of partial differential equations using finite difference approximation. Newmark [8] developed a method that used implicit integration and global stiffness, mass and damping matrices for both the static and dynamic solutions of structures with both material and geometric non-linear behaviour. Day [1] implemented an explicit solution method for the analysis of portal frames and plates and Otter for the analysis of pre-stressed concrete pressure vessels [9]. Later, these methods were adapted to finite elements problems [10] finally assuming the popular formulation in which equilibrium and compatibility relations are separated and no overall stiffness matrix of the structure is assembled. Successively, it was further improved by other authors amongst with Barnes [11] and Wakefield [12].

Dynamic Relaxation is based on the discretization of the continuum into a set of concentrated masses (called particles or nodes) linked by elements (which can be one, two or three dimensional) defining how forces and moments propagate through the system. The method has been mainly used to solve static problems which are converted into dynamic problems with the use of fictitious masses and viscous damping at nodes.

Non-linear FEM routines are usually implemented using implicit Newton–Raphson methods. Compared to Newton–Raphson methods dynamic relaxation needs less memory because there is no need to store and update the global structure stiffness matrix 
                           
                              (
                              N
                              ×
                              N
                              )
                           
                         but only the internal forces of the elements 
                           
                              (
                              N
                              ×
                              1
                              )
                           
                         where 
                           N
                         is the number of the nodal degrees of freedom. Since there is only need to derive the internal force vectors and the elements linear stiffness matrix, it is easier to include the higher order terms of the strain–displacement relations for the element [13]. In addition, it can be proven that for NR implicit methods the operation count is proportional to the number of elements 
                           O
                           
                              (
                              n
                              
                                 
                                    e
                                 
                                 
                                    7
                                    /
                                    3
                                 
                              
                              )
                           
                         while for DR is 
                           O
                           
                              (
                              n
                              
                                 
                                    e
                                 
                                 
                                    4
                                    /
                                    3
                                 
                              
                              )
                           
                         (
                           n
                           e
                         is the number of elements) thus making the latter better suited for systems with larger number of elements [14] cited in [4]. On the other hand, DR is conditionally stable and requires pre-computation to estimate optimum parameters such as the integration time step to ensure convergence and stability.

DR has been used for the design of grid-shells and tension structures such as those built with cable or fabrics, and more generally for the static solution of structures exhibiting material and geometrical non-linearity. A good review of applications of DR on building scale projects is given in [15]. Other recent examples of structural form-finding can be found in [16,17]. On-going work that adopts a force-based approach for purely geometric related optimization applications is the software called Kangaroo developed by Piker [18].

The co-rotational formulation was developed for the analysis of geometrically non-linear structures under the assumption of small strains but arbitrarily large displacements and rotations [19,20]. It can be considered the most recent kinematics description after the Total Lagrangian and Updated Lagrangian which have been used extensively in the FEM analysis of structures with non-linear behaviour.

The main idea behind the co-rotational approach is to separate the motion of the element into a rigid motion and a purely deformational part. Each element has a base (also called initial or rest) reference frame and its own co-rotated frame obtained as a rigid body motion (translations and rotations) of the base frame. When rotational degrees of freedom are involved, the nodes of the element have their own rigidly attached frames which move with the element. Deformations are measured with respect to the element co-rotated frame (Fig. 1
                        ).

The node frames are effectively utilized to describe the element orientations at its ends. During load analysis, the difference between the orientations at the element’s ends and the co-rotated element frame represent the rotational part of the deformation. In form-finding or geometric optimization, the node orientations can be used to measure the difference with respect to target orientations specified beforehand. Fig. 1 shows the different reference frames for a beam element.


                        Fig. 1 shows the kinematics for a co-rotated beam element in two dimensions; in Section  2.5 the main steps of the formulation for beam elements in 3 dimensions (6 degrees of freedom) are given; the same approach can be taken for 2D elements (i.e. plates, shells) [21] and 3D elements (i.e. tetrahedrons, bricks) [22].

Due to the fact that each element has its own co-rotated frame and that deformational displacements and rotations are measured with respect to it, for sufficiently small element sizes the small strains assumption holds while both rotations and displacements can be arbitrarily large [23].

Dynamic Relaxation is well suited to problems that are solved with the FEM formulation and can be implemented using standard element libraries [10].

The co-rotational formulation qualifies as “element independent”. This definition comes from the fact that the relations between the local and global element deformational displacements and rotations are defined by a transformation matrix and consequently the stiffness and the local forces and moments depend on the choice of the local coordinate system. However, the relation between the local and global deformation is independent of the particular strain definition used [24,21]. In simpler words, the addition and removal of the rigid body motion part from translational and rotational displacements can be implemented separately from the element and the solver sub-routines. In addition, the fact that each element has its own co-rotated frame allows keeping deformations small with respect to the frame. For these reasons, standard linear or geometric-non-linear FEM libraries can be adopted immediately without the need of new implementation.

A disadvantage of the co-rotational formulation is the involvement of relatively complex mathematics when rotational degrees of freedom are involved especially considering that finite rotations are not commutative and generally non-additive. However, several parameterizations of rotations are available that can be integrated in both explicit and implicit integration stepping routines [25].

@&#METHODOLOGY@&#

The main idea is to “follow” the movements of the nodes caused by the out of balance forces. Elements’ masses and rotational inertia are lumped at nodes. Information regarding position, velocity and acceleration of each node is computed iteratively. The system converges to an equilibrium position around which it oscillates and eventually settles when the out of balance forces and moments become very small/null. The simplest way to achieve convergence is to damp the nodal movements using artificial viscous damping.

Because each step is relatively simple to compute (and for moderate numbers of elements, many steps can be performed per second on consumer level computers) intermediate steps towards convergence correspond to actual physical dynamics, they can be shown. Thus a similar framework can be used as in an interactive physics engine, such as those used in games.

For some optimization and analysis purposes it is only the final equilibrium result which is of interest, and the intermediate steps need not be shown. In these cases the damping and mass coefficients may be chosen purely for the sake of convergence. A kinetic damping scheme [26] may also be used, which zeros the velocities whenever kinetic energy peaks are reached, achieving fast convergence, but more removed from the actual dynamic behaviour. However, if appropriate damping and mass values are set, the same system can also be used to model realistic dynamics [27].

The method can be considered as a simplified form of a standard FEM using a lumped mass matrix. It can be shown that the computation of the fundamental modes using a lumped mass matrix gives underestimated natural frequencies and vice versa for the consistent mass matrix. By increasing the number of elements of the mesh, the computation of the natural frequencies using both lumped and consistent mass matrices converges to the same result for simple elements (2nd order) [28].

For discretized systems the equation of motion can be written as: 
                           
                              
                                 (1)
                                 
                                    
                                       
                                          M
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       
                                          a
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          t
                                       
                                    
                                    +
                                    C
                                    
                                       
                                          v
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          t
                                       
                                    
                                    +
                                    
                                       
                                          K
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                i
                                                j
                                             
                                             
                                                t
                                             
                                          
                                          =
                                          P
                                       
                                       
                                          i
                                          j
                                       
                                    
                                 
                              
                              
                                 
                                    j
                                    =
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       )
                                    
                                    ;
                                    
                                    v
                                    =
                                    
                                       
                                          δ
                                       
                                       
                                          ̇
                                       
                                    
                                    ;
                                    
                                    a
                                    =
                                    
                                       
                                          δ
                                       
                                       
                                          ̈
                                       
                                    
                                 
                              
                           
                         where the subscript 
                           i
                         refers to the 
                           i
                        th node and the 
                           j
                         to the 
                           j
                        th direction 
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         in global coordinates and the super script 
                           t
                         is time. 
                           M
                         is the mass of the element lumped at node and 
                           C
                         is the damping factor. 
                           
                              
                                 K
                              
                              
                                 i
                                 j
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 i
                                 j
                              
                           
                         are the stiffness and the external loads respectively of the 
                           i
                        th node in the 
                           j
                        th direction. The total translational displacement, velocity and acceleration of the 
                           i
                        th node in the 
                           j
                        th direction 
                           j
                         at time step 
                           t
                         are represented by the symbols 
                           
                              
                                 δ
                              
                              
                                 i
                                 j
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 i
                                 j
                              
                              
                                 t
                              
                           
                         and 
                           
                              
                                 a
                              
                              
                                 i
                                 j
                              
                              
                                 t
                              
                           
                        . By defining the residuals as out of balance forces 
                           
                              
                                 F
                              
                              
                                 i
                                 j
                              
                              
                                 t
                              
                           
                         resulting from the difference between the internal forces 
                           
                              
                                 K
                              
                              
                                 i
                                 j
                              
                           
                           
                              
                                 δ
                              
                              
                                 i
                                 j
                              
                              
                                 t
                              
                           
                         and the external applied load vector 
                           
                              
                                 P
                              
                              
                                 i
                                 j
                              
                           
                        , Eq. (1) can be rewritten as: 
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       =
                                       M
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 C
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 .
                              
                           
                         The velocities and position of the nodes can be obtained by an explicit, implicit or semi-implicit time step integration scheme. Using Newton’s 2nd law and a simple modification of the forward Euler integration scheme, it is possible to obtain a simple yet very stable and 1st order accurate integration scheme called semi-implicit or symplectic Euler: 
                           
                              
                                 (3)
                                 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          t
                                          +
                                          Δ
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          v
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          t
                                       
                                    
                                    +
                                    Δ
                                    t
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                i
                                                j
                                             
                                             
                                                t
                                             
                                          
                                       
                                       
                                          
                                             
                                                M
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 (4)
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          t
                                          +
                                          Δ
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          r
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          t
                                       
                                    
                                    +
                                    Δ
                                    t
                                    
                                    
                                       
                                          v
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          t
                                          +
                                          Δ
                                          t
                                       
                                    
                                 
                              
                           
                         where 
                           Δ
                           t
                         is the time step and 
                           
                              
                                 r
                              
                              
                                 i
                                 j
                              
                              
                                 t
                              
                           
                         is the 
                           j
                        th coordinate position of the 
                           i
                        th node. The integration scheme is semi-implicit because it uses forward Euler to compute the velocity but backward Euler to obtain the position using the velocity at 
                           t
                           +
                           Δ
                           t
                        . For forces that do not depend on velocity (non-dissipative) the symplectic Euler is 2nd order accurate like the central difference or Stoermer–Verlet with global error 
                           O
                           
                              (
                              Δ
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        . Energy preservation features of the symplectic Euler and comparison with the velocity-Verlet scheme are discussed in Section  2.4. Eqs. (2)–(4) show that the velocity and position of the 
                           i
                        th node at next time step only depend on its own previous time step velocity and residuals. The system is decoupled meaning that the update of a node position at the next time step does not perturb the updates of the others.

Once the updated nodal positions are computed, it is then possible to separate the rigid from the deformational part of the displacements to obtain the residuals at next time step: 
                           
                              (5)
                              
                                 
                                    
                                       F
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       t
                                       +
                                       Δ
                                       t
                                    
                                 
                                 
                                    
                                       =
                                       P
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 −
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       K
                                    
                                    
                                       i
                                       j
                                       m
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       i
                                       j
                                       m
                                    
                                    
                                       t
                                       +
                                       Δ
                                       t
                                    
                                 
                              
                           
                         where 
                           m
                         is the number of elements connecting to the 
                           i
                        th node. Equilibrium of forces Eq. (5) is indeed separated from the compatibility conditions Eq. (4) which is one of the key features of the DR scheme. The updated internal forces 
                           
                              
                                 K
                              
                              
                                 i
                                 j
                              
                           
                           
                              
                                 δ
                              
                              
                                 i
                                 j
                              
                              
                                 t
                                 +
                                 Δ
                                 t
                              
                           
                         are obtained from the element stresses at time 
                           t
                         which are computed using the element stiffness matrix in local coordinates and then transforming those forces into global (nodal) coordinates (virtual work equivalence in the local and global systems). The resolved components of the residuals are then added as nodal forces. In Section  2.5 the computation of the nodal forces for a 6DOFs beam element is described in more details and references are given for its derivation and extension to other elements.

Following the co-rotational approach, when rotational degrees of freedom are involved the rigid translational motion of the nodes is de-coupled from the rotational part. As discussed in Section  1.2 each element has its own co-rotated frame and the nodes have their attached frames to compute the rotational part of the deformation with respect to the element’s co-rotated frame. In a DR scheme it is only necessary to keep track of the nodes’ orientations. In fact, once these are updated it is possible to compute the current co-rotated element orientation from the nodal position (within the small strains assumption).

A parameterization for finite rotations must be chosen to handle the rigid body part of the displacement. An intuitive parameterization is to describe a rotation from axis (unit vector 
                           
                              n
                           
                        ) and angle, often referred as rotational vector. That is the axis of the vector is the axis of the rotation and its magnitude represents the angle (Fig. 2
                        ): 
                           
                              (6)
                              
                                 
                                    θ
                                 
                                 =
                                 θ
                                 
                                    n
                                 
                                 ;
                                 
                                 θ
                                 =
                                 
                                    
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             
                                                T
                                             
                                          
                                       
                                       
                                          θ
                                       
                                    
                                 
                                 .
                              
                           
                         The relation between the rotational vector and its corresponding rotation matrix are given by the Rodriguez’s formula: 
                           
                              (7)
                              
                                 
                                    R
                                 
                                 
                                    (
                                    
                                       θ
                                    
                                    )
                                 
                                 =
                                 I
                                 cos
                                 θ
                                 +
                                 sin
                                 θ
                                 
                                    
                                       
                                          [
                                          n
                                          ]
                                       
                                    
                                    
                                       ×
                                    
                                 
                                 +
                                 
                                    (
                                    1
                                    −
                                    cos
                                    θ
                                    )
                                 
                                 n
                                 ⊗
                                 n
                              
                           
                         or in matrix form: 
                           
                              (8)
                              
                                 
                                    R
                                 
                                 
                                    (
                                    
                                       θ
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             cos
                                             θ
                                             +
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                cos
                                                θ
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                cos
                                                θ
                                                )
                                             
                                             −
                                             
                                                
                                                   n
                                                
                                                
                                                   z
                                                
                                             
                                             sin
                                             θ
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             
                                                
                                                   n
                                                
                                                
                                                   z
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                cos
                                                θ
                                                )
                                             
                                             +
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             sin
                                             θ
                                          
                                       
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                cos
                                                θ
                                                )
                                             
                                             +
                                             
                                                
                                                   n
                                                
                                                
                                                   z
                                                
                                             
                                             sin
                                             θ
                                          
                                          
                                             cos
                                             θ
                                             +
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                cos
                                                θ
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             
                                                
                                                   n
                                                
                                                
                                                   z
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                cos
                                                θ
                                                )
                                             
                                             −
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             sin
                                             θ
                                          
                                       
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             
                                                
                                                   n
                                                
                                                
                                                   z
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                cos
                                                θ
                                                )
                                             
                                             −
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             sin
                                             θ
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   z
                                                
                                             
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                cos
                                                θ
                                                )
                                             
                                             +
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             sin
                                             θ
                                          
                                          
                                             cos
                                             θ
                                             +
                                             
                                                
                                                   n
                                                
                                                
                                                   z
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                cos
                                                θ
                                                )
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                         where 
                           I
                         is the identity matrix, 
                           
                              
                                 
                                    [
                                    n
                                    ]
                                 
                              
                              
                                 ×
                              
                           
                         is the skew symmetric matrix from the components of the axis 
                           
                              n
                           
                         and 
                           ⊗
                         is the tensor product [29]. If the axis and the angle of the rotation are known, it is then possible to establish a relation between the current and time forwarded orientation of the node: 
                           
                              
                                 (9a)
                                 
                                    
                                       
                                          
                                             R
                                          
                                       
                                       
                                          
                                             t
                                          
                                          +
                                          Δ
                                          t
                                       
                                    
                                    =
                                    
                                       R
                                    
                                    
                                       (
                                       
                                          θ
                                       
                                       )
                                    
                                    ⋅
                                    
                                       
                                          
                                             R
                                          
                                       
                                       
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              
                                 (9b)
                                 
                                    θ
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   Δ
                                                   t
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                      
                                                      
                                                         
                                                            t
                                                         
                                                         +
                                                         Δ
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                T
                                             
                                          
                                          
                                             (
                                             Δ
                                             t
                                             
                                                
                                                   
                                                      ω
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                   +
                                                   Δ
                                                   t
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              R
                           
                         is used as both operator and to represent the node orientations [19]. As far as the update of the node orientation, it is intuitive to think the angle of rotations is given by Eq. (9b) where 
                           
                              
                                 
                                    ω
                                 
                              
                              
                                 
                                    t
                                 
                                 +
                                 Δ
                                 t
                              
                           
                         is the angular velocity computed from the updated angular momentum. With the current parameterization for finite rotations it is not possible to handle the change of angle of rotations bigger than 
                           2
                           π
                        . In fact, the relation between the variation of the node orientation and the rotational vector is not a bijection at 
                           θ
                           =
                           2
                           k
                           π
                           ,
                           
                           k
                           =
                           1
                           ,
                           2
                           ,
                           …
                        
                        [30]. However, for small increments of rotational vector, the node orientation update is possible and thus limited only within a time step (the incremental rotational vector) [31,23].

Newton’s 2nd law applied to torque and angular acceleration is: 
                           
                              (10)
                              
                                 
                                    τ
                                 
                                 =
                                 
                                    I
                                 
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       ω
                                    
                                    
                                       t
                                    
                                 
                                 ×
                                 
                                    I
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       t
                                    
                                 
                              
                           
                         where 
                           
                              τ
                           
                         is the total torque at node; 
                           
                              I
                           
                         the inertia tensor of the element lumped at node; 
                           
                              
                                 ω
                              
                              
                                 t
                              
                           
                         and 
                           
                              
                                 
                                    
                                       ω
                                    
                                    
                                       ̇
                                    
                                 
                              
                              
                                 t
                              
                           
                         the angular velocity and acceleration at time 
                           t
                         respectively. The second term represents the precession of a rotating body that is the change in the orientation of the rotational axis. The torque 
                           
                              τ
                           
                         can be computed using the local element stiffness matrix and then transforming into global coordinates as already discussed for the out of balance forces in Section  2.2 (virtual work equivalence local–global reference system). In order to derive a suitable stepping procedure to update the node orientation, the angular momentum is first computed. The angular momentum and its derivative are defined as: 
                           
                              (11)
                              
                                 
                                    L
                                 
                                 =
                                 
                                    I
                                 
                                 ω
                                 ;
                                 
                                 
                                    
                                       L
                                    
                                    
                                       ̇
                                    
                                 
                                 =
                                 
                                    I
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       ̇
                                    
                                 
                                 =
                                 
                                    τ
                                 
                              
                           
                         thus is possible to update the angular momentum and then compute the angular velocity multiplying it by the inverse of the inertia tensor: 
                           
                              
                                 (12)
                                 
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          
                                             t
                                          
                                          +
                                          Δ
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          
                                             t
                                          
                                       
                                    
                                    +
                                    
                                       Δ
                                    
                                    t
                                    
                                    
                                       
                                          
                                             τ
                                          
                                       
                                       
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              
                                 (13)
                                 
                                    
                                       
                                          
                                             ω
                                          
                                       
                                       
                                          
                                             t
                                          
                                          +
                                          Δ
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          
                                             I
                                          
                                       
                                       
                                          
                                             
                                                
                                                   t
                                                
                                             
                                             
                                                −
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          
                                             t
                                          
                                          +
                                          Δ
                                          t
                                       
                                    
                                    .
                                 
                              
                           
                         The inertia tensor is computed in the local element frame but the other quantities in Eq. (13) are instead expressed in world coordinates. An efficient way to get around this problem is to rotate the angular momentum in the element’s local frame, apply the inverse of the inertia tensor in local coordinates 
                           
                              
                                 
                                    I
                                 
                              
                              
                                 
                                    0
                                 
                              
                              
                                 −
                                 
                                    1
                                 
                              
                           
                         and then rotating back into world coordinates [22]: 
                           
                              (14)
                              
                                 
                                    
                                       
                                          ω
                                       
                                    
                                    
                                       
                                          t
                                       
                                       +
                                       Δ
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          I
                                       
                                    
                                    
                                       
                                          
                                             
                                                t
                                             
                                          
                                          
                                             −
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          L
                                       
                                    
                                    
                                       
                                          t
                                       
                                       +
                                       Δ
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          R
                                       
                                    
                                    
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          I
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                    
                                       −
                                       
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          R
                                       
                                    
                                    
                                       −
                                       
                                          
                                             
                                                1
                                             
                                          
                                          
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          L
                                       
                                    
                                    
                                       
                                          t
                                       
                                       +
                                       Δ
                                       t
                                    
                                 
                                 .
                              
                           
                         The complete sequence to update the node orientation can be summarized as: 
                           
                              (15)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      L
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                   +
                                                   Δ
                                                   t
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      L
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                
                                             
                                             +
                                             Δ
                                             t
                                             
                                             
                                                
                                                   
                                                      τ
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         −
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      R
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      I
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                
                                                
                                                   −
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      R
                                                   
                                                
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ω
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                   +
                                                   Δ
                                                   t
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      I
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         −
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                   +
                                                   Δ
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                   +
                                                   Δ
                                                   t
                                                
                                             
                                             =
                                             
                                                R
                                             
                                             
                                                (
                                                Δ
                                                t
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                   
                                                   
                                                      
                                                         t
                                                      
                                                      +
                                                      Δ
                                                      t
                                                   
                                                
                                                )
                                             
                                             ⋅
                                             
                                                
                                                   
                                                      R
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           Δ
                           t
                           
                              
                                 
                                    ω
                                 
                              
                              
                                 
                                    t
                                 
                                 +
                                 Δ
                                 t
                              
                           
                         represents the incremental rotational vector given by the axis of the angular velocity and whose magnitude represents the rotation of node frame. It is worth noting that the scheme in Eq. (15) is the symplectic Euler as the angular velocity is obtained through a forward step while the update of the node orientation is implicit.

Convergence is usually achieved by damping the nodal movements using kinetic damping or artificial viscous damping. The first can be used when there is no need to track the dynamic behaviour of the system and only stable equilibrium is of interest. The latter applies to both load analysis and form-finding. Kinetic damping involves tracking the kinetic energy of the system and setting the velocities of the nodes to zero whenever a maximum is detected [11]. Kinetic damping is based on the fact that for a system made of masses in harmonic motion, minimum potential energy corresponds to the maximum kinetic energy. The iterative application of kinetic damping gradually brings the system to the configuration of stable equilibrium.

Artificial viscous damping can be considered as a way of extracting energy from the system in order to bring it to a rest. The viscous damping factor only affects the way in which convergence is achieved. However, it must be chosen in order to avoid slow convergence due to either over or under damping.

If the damping factor is made proportional to the fundamental modes (critical damping) it is possible to trace the dynamic behaviour of the system. This involves solving the Eigenvalue problem for a system with multiple degrees of freedom. However, due to the fact that DR and co-rotational formulation can be well integrated with standard FEM libraries, the local element matrices are already conveniently implemented. For this reason, it is possible to use a standard assembly routine to pre-compute a global lumped mass and stiffness matrix and solve the eigenvalue problem: 
                           
                              (16)
                              
                                 
                                    λ
                                 
                                 =
                                 e
                                 i
                                 g
                                 
                                    (
                                    
                                       
                                          
                                             M
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       K
                                    
                                    )
                                 
                              
                           
                         where 
                           λ
                         is the vector of the eigenvalues thus providing the natural frequencies. The value of the damping factor can then be assigned as proportional to any of the natural frequencies or a fraction of the 1st natural frequency if experimental data are available: 
                           
                              (17)
                              
                                 C
                                 =
                                 4
                                 π
                                 m
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 ;
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 …
                              
                           
                         where 
                           m
                         is the total mass of the system. The computation of the eigenvalues can also be used to set a bound on the integration time step in order to guarantee stability. In fact, it can be proven that a first order approximation bound of 
                           Δ
                           t
                         for stability is [10]: 
                           
                              (18)
                              
                                 Δ
                                 t
                                 <
                                 
                                    
                                       2
                                    
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                         is the largest eigenvalue. Alternatively another approximation for a bound on the time integration step is given in [32] as: 
                           
                              (19)
                              
                                 Δ
                                 t
                                 <
                                 
                                    
                                       
                                          min
                                       
                                    
                                    
                                       i
                                       <
                                       N
                                    
                                 
                                 
                                    
                                       
                                          
                                             2
                                             
                                                
                                                   M
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                                 ;
                                 
                                 j
                                 =
                                 x
                                 ,
                                 y
                                 ,
                                 z
                              
                           
                         where, as described previously, the subscripts 
                           i
                           j
                         refer for the 
                           i
                        th node and the 
                           j
                        th direction, 
                           N
                         is the total number of nodes. Eq. (19) does not require any pre-computation but only the stiffness at nodes. For the automatic evaluation of DR parameters see also [33].

The integration used for both translational and rotational motion is the semi-implicit Euler (symplectic) for its energy preservation features. As already described the symplectic Euler is a simple modification of the forward Euler which inverts the computation of the velocity with respect to the position. In this way the velocity is computed using the forces at 
                           t
                         but the position is updated using the velocity and 
                           t
                           +
                           Δ
                           t
                        . Fig. 3
                         shows the difference between error accumulation between forward, implicit and semi-implicit Euler.

It can be seen that while the forward method (or even higher order method such as the RK4) accumulates the local error spiralling outwardly the ideal orbit whilst an implicit method accumulates error spiralling inwardly. On the contrary, the symplectic method remains stable thus preserving energy. The Stoermer–Verlet (velocity-Verlet) is a symplectic method 2nd order accurate 
                           O
                           
                              (
                              Δ
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         on position thus, in principle, should be preferable to the symplectic Euler 
                           O
                           
                              (
                              Δ
                              t
                              )
                           
                        . However, the former requires two updates of forces (i.e. compute twice forces and moments) each time step. Considering that most of the computational effort is spent computing the forces (especially when the rotational degree of freedom is involved), the gain that would be achieved by a stepping method 
                           O
                           
                              (
                              D
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         accurate is practically outweighed by the time it takes to perform double computations of forces and moments.

In this section, we present a synthetic description of a beam element model with 6 degrees of freedom (three translation and three rotation each node) which is integrated into the physics engine described in previous sections. The beam element can be taken directly from a standard FEM beam element matrix which can be derived either from Euler–Bernoulli or Timoshenko beam theory. The geometric non-linearity (large displacements and large rotations) are handled using the co-rotated element frame and nodes attached frames in order to separate the rigid from the deformational part of the translation and rotational total displacements. The element and the node orientations are updated using the parameterization for finite rotations explained in Section  2.3. Within the assumption of small-strains, the use of linear stress–strain relationships for the formulation of the elements stiffness matrix is allowed. The implementation of the beam model used in the interactive structural models (Section  3) is borrowed from [34] and its derivation can be found in [35].


                        Fig. 4
                         shows a deformed beam with co-rotated frame which has the 
                           z
                         axis aligned with the vector 
                           
                              p
                           
                         between the two ends’ attached frames. The relationship between the frame of the node and beam’s end frames is: 
                           
                              (20)
                              
                                 
                                    
                                       
                                          R
                                       
                                    
                                    
                                       
                                          j
                                       
                                    
                                    
                                       
                                          t
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          R
                                       
                                    
                                    
                                       n
                                       o
                                       d
                                       e
                                    
                                    
                                       
                                          t
                                       
                                    
                                 
                                 ⋅
                                 
                                    
                                       
                                          R
                                       
                                    
                                    
                                       j
                                    
                                    
                                       0
                                    
                                 
                                 ;
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                              
                           
                         where 
                           
                              
                                 
                                    R
                                 
                              
                              
                                 n
                                 o
                                 d
                                 e
                              
                              
                                 
                                    t
                                 
                              
                           
                         is the current orientation of the node obtained with Eq. (8) and 
                           
                              
                                 
                                    R
                                 
                              
                              
                                 j
                              
                              
                                 0
                              
                           
                         is the initial orientation of the beam end. The element end orientations rotate rigidly with the attached nodes and can be used to define how elements meet at the common node (rest orientation) or as target orientation for optimization tasks. Once the beam end orientations are updated, it is then possible to compute the rotational displacements that they make with the co-rotated element frame (the auxiliary 
                           
                              p
                           
                         vector): 
                           
                              
                                 (21)
                                 
                                    
                                       p
                                    
                                    =
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 (22)
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          x
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ⋅
                                          
                                             p
                                          
                                       
                                       
                                          L
                                       
                                    
                                    ;
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          x
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                
                                             
                                             
                                                2
                                             
                                          
                                          ⋅
                                          
                                             p
                                          
                                       
                                       
                                          L
                                       
                                    
                                 
                              
                              
                                 (23)
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          y
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ⋅
                                          
                                             p
                                          
                                       
                                       
                                          L
                                       
                                    
                                    ;
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          x
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                2
                                             
                                          
                                          ⋅
                                          
                                             p
                                          
                                       
                                       
                                          L
                                       
                                    
                                 
                              
                              
                                 (24)
                                 
                                    φ
                                    =
                                    
                                       
                                          θ
                                       
                                       
                                          z
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          θ
                                       
                                       
                                          z
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ⋅
                                          
                                             
                                                
                                                   y
                                                
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                2
                                             
                                          
                                          ⋅
                                          
                                             
                                                
                                                   y
                                                
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                         where 
                           φ
                         is the twist angle and 
                           
                              
                                 θ
                              
                              
                                 j
                                 i
                              
                           
                         angles to compute the bending moments and 
                           L
                         is the deformed length of the beam. The total elongation 
                           e
                         due to the ends relative displacements 
                           
                              
                                 e
                              
                              
                                 a
                              
                           
                         and the contribution due to bowing 
                           
                              
                                 e
                              
                              
                                 b
                              
                           
                         can be computed as: 
                           
                              
                                 (25)
                                 
                                    e
                                    =
                                    L
                                    A
                                    r
                                    c
                                    −
                                    
                                       
                                          L
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          e
                                       
                                       
                                          a
                                       
                                    
                                    +
                                    
                                       
                                          e
                                       
                                       
                                          b
                                       
                                    
                                 
                              
                              
                                 (26)
                                 
                                    
                                       
                                          e
                                       
                                       
                                          a
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                          
                                             
                                                L
                                             
                                             
                                                0
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          2
                                          
                                             
                                                L
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 (27)
                                 
                                    
                                       
                                          e
                                       
                                       
                                          b
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          60
                                       
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      x
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      x
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                4
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                −
                                                1
                                             
                                             
                                                4
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      x
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      x
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    +
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          60
                                       
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      y
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      y
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                4
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                −
                                                1
                                             
                                             
                                                4
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      y
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      y
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                 
                              
                           
                         where 
                           
                              
                                 L
                              
                              
                                 0
                              
                           
                         is the undeformed length and 
                           L
                           A
                           r
                           c
                         is the arc-length obtained by integrating a Hermite cubic shape function [36]. Using virtual work, the forces and moments with respect to the beam ends’ frames can be computed as the derivative of the total strain energy 
                           U
                        : 
                           
                              
                                 (28)
                                 
                                    T
                                    =
                                    
                                       
                                          ∂
                                          U
                                       
                                       
                                          ∂
                                          
                                             
                                                e
                                             
                                             
                                                a
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          E
                                          A
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             a
                                          
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             b
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 (29)
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      x
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      x
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      U
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            x
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      U
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            x
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       
                                          
                                             
                                                T
                                                L
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          30
                                       
                                    
                                    
                                       [
                                       
                                          
                                             
                                                4
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                −
                                                1
                                             
                                             
                                                4
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      x
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      x
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    +
                                    
                                       
                                          E
                                          
                                             
                                                I
                                             
                                             
                                                x
                                                x
                                             
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       [
                                       
                                          
                                             
                                                4
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                −
                                                1
                                             
                                             
                                                4
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      x
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      x
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                 
                              
                              
                                 (30)
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      y
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      y
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      U
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            y
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      U
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            y
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       
                                          
                                             
                                                T
                                                L
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          30
                                       
                                    
                                    
                                       [
                                       
                                          
                                             
                                                4
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                −
                                                1
                                             
                                             
                                                4
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      y
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      y
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    +
                                    
                                       
                                          E
                                          
                                             
                                                I
                                             
                                             
                                                y
                                                y
                                             
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       [
                                       
                                          
                                             
                                                4
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                −
                                                1
                                             
                                             
                                                4
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      y
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      y
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                 
                              
                              
                                 (31)
                                 
                                    
                                       
                                          M
                                       
                                       
                                          φ
                                       
                                    
                                    =
                                    
                                       
                                          ∂
                                          U
                                       
                                       
                                          ∂
                                          φ
                                       
                                    
                                    =
                                    
                                       
                                          G
                                          J
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    φ
                                 
                              
                           
                         where 
                           E
                         is Young’s modulus; 
                           G
                         the shear modulus; 
                           A
                         the cross-sectional area; 
                           
                              
                                 I
                              
                              
                                 x
                                 x
                              
                           
                           ,
                           
                              
                                 I
                              
                              
                                 y
                                 y
                              
                           
                         and 
                           J
                         the 2nd moment of area and the polar moment. The shear forces do not appear because the moments are computed with respect to the end frame and not to the element frame. In order to transform the forces and moments from local to global coordinates, it is possible to evaluate the infinitesimal increment in the total strain energy (i.e. equivalence of the internal virtual work in both the global and local systems): 
                           
                              (32)
                              
                                 δ
                                 U
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             δ
                                             
                                                
                                                   e
                                                
                                                
                                                   a
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   θ
                                                
                                                
                                                   x
                                                   1
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   θ
                                                
                                                
                                                   y
                                                   1
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   θ
                                                
                                                
                                                   x
                                                   2
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   θ
                                                
                                                
                                                   y
                                                   2
                                                
                                             
                                          
                                          
                                             ∂
                                             φ
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                
                                                   M
                                                
                                                
                                                   x
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   M
                                                
                                                
                                                   y
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   M
                                                
                                                
                                                   x
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   M
                                                
                                                
                                                   y
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   M
                                                
                                                
                                                   φ
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                         After expressing the derivative terms in Eq. (32) as a function of the beam end frames and the auxiliary vector 
                           
                              p
                           
                        , thus computing the derivatives of the rotation matrix 
                           
                              R
                           
                         Eq. (8)
                        [35], the resultant forces and moments in global coordinates can be written as: 
                           
                              
                                 (33)
                                 
                                    
                                       
                                          
                                             F
                                          
                                       
                                       
                                          1
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       (
                                       T
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             M
                                          
                                          
                                             x
                                             1
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             1
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             M
                                          
                                          
                                             y
                                             1
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             1
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             M
                                          
                                          
                                             x
                                             2
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             2
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             M
                                          
                                          
                                             y
                                             2
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             2
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 (34)
                                 
                                    
                                       
                                          
                                             F
                                          
                                       
                                       
                                          2
                                          i
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       (
                                       T
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             M
                                          
                                          
                                             x
                                             1
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             1
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             M
                                          
                                          
                                             y
                                             1
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             1
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             M
                                          
                                          
                                             x
                                             2
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             2
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             M
                                          
                                          
                                             y
                                             2
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             2
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 (35)
                                 
                                    
                                       
                                          
                                             τ
                                          
                                       
                                       
                                          1
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          −
                                          ε
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    
                                    
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             x
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   y
                                                
                                                
                                                   1
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             M
                                          
                                          
                                             y
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   x
                                                
                                                
                                                   1
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             M
                                          
                                          
                                             φ
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                      j
                                                   
                                                
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                      k
                                                   
                                                
                                                −
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      1
                                                      j
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 (36)
                                 
                                    
                                       
                                          
                                             τ
                                          
                                       
                                       
                                          2
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          −
                                          ε
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    
                                    
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             x
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   y
                                                
                                                
                                                   2
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             M
                                          
                                          
                                             y
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   x
                                                
                                                
                                                   2
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             M
                                          
                                          
                                             φ
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                      j
                                                   
                                                
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                      k
                                                   
                                                
                                                −
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      1
                                                      j
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if  
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                   )
                                                
                                                  is  
                                                
                                                   (
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   3
                                                   )
                                                
                                                ,
                                                
                                                   (
                                                   2
                                                   ,
                                                   1
                                                   ,
                                                   3
                                                   )
                                                
                                                ,
                                                
                                                   (
                                                   3
                                                   ,
                                                   1
                                                   ,
                                                   2
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                if  
                                                i
                                                =
                                                j
                                                ,
                                                
                                                j
                                                =
                                                k
                                                ,
                                                
                                                k
                                                =
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 ε
                              
                              
                                 i
                                 j
                                 k
                              
                           
                         is the Levi-Civita symbol taken only in the anticlockwise direction. Although not explicitly computed in the local frames, the total shear force can be recognized in the last 4 terms of Eq. (33). Forces and moments from each element that meet at a node are added to the residuals to obtain a resultant force and moment for each node. Once the residuals Eq. (5) are computed it is possible to use Eqs. (3) and (4) for the translational displacements and the system of equations in Eq. (15) for the rotational displacements to complete a time-step in Eq. (1).

Eqs. (28), (33) and (34) can also be utilized for bar and cable elements. In fact, the terms related to the deformation due to bowing and the moments are zero and the resultant force at node is only given by the axial term. 
                           
                              
                                 (37)
                                 
                                    T
                                    =
                                    
                                       
                                          ∂
                                          U
                                       
                                       
                                          ∂
                                          
                                             
                                                e
                                             
                                             
                                                a
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          E
                                          A
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             a
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 (38)
                                 
                                    
                                       
                                          
                                             F
                                          
                                       
                                       
                                          1
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                    
                                       (
                                       T
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 (39)
                                 
                                    
                                       
                                          
                                             F
                                          
                                       
                                       
                                          2
                                          i
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                    
                                       (
                                       T
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                         For cable elements the force is zeroed in the case of compression. The zero-length cable (usually called spring), only available for optimization tasks, is handled with a case structure in which the force becomes proportional to the length of the element which is also its extension. A recent publication [37] shows how to combine zero-length springs and variable mass proportional to the length of each spring to obtain zero bending moment at nodes for both shells and tension net forms under self-weight.

Since the implementation has been targeting primarily to applications where qualitative structural behaviour was of interest, rigorous and exhaustive validation of both stress and displacements obtained with the presented formulation is yet to be done. However, results obtained using configurations such as a cantilever beam subjected to end moment, end force or distributed load compare well against commercial FE software (Oasys GSA). The difference between tip displacements using the built-in non-linear analysis in GSA is less than 2%.

Based on discussions with engineering students and academics we believe that there is a significant opportunity to improve the qualitative understanding of structures through online gaming. In effect this would be a modern analogue for the way that people learnt engineering principles through games like Meccano [38]. Properly done this may also provide a useful way to engage with children at school. Precedents can be found in the work of Martini, Arcade [39].

This section describes the work carried out in developing the software “PushMePullMe”. PushMePullMe is part of an educational project, the Expedition Workshed, which aims at developing a set of tools and digital documents to ease and enrich the process of teaching structural mechanics, engineering and architecture. PushMePullMe offers non-experts the possibility of gaining a qualitative understanding of the behaviour of simple and complex structural topologies, for both static and dynamic systems. The application implements the physics engine described in Section  2 and particularly focuses on the interaction user-model.

The first software development of the physics engine is a game called “Catastrophe” implemented as a Java applet.
                           1
                        
                        
                           1
                           Catastrophe can be accessed at http://expeditionworkshed.org/workshed/catastrophe/.
                         The elements are limited to bars and cables and the displacements in 2 dimensions. (See Fig. 5
                        ).

The user is presented with a series of challenges designed around model representations of famous buildings. Initially designed as a student oriented game, Catastrophe challenges users to remove as many elements as possible without the structure collapsing. Through play, users develop an understanding of which elements are critical to system stability (Fig. 6
                        ) thanks to the real time feedback. Models can be built and tested under different loading scenarios while receiving immediate feedback on internal forces and constraints reactions. Fracture of highly stressed elements can be enabled (the yellow circle highlight elements fracture), Fig. 7
                        .


                        PushMePullMe implements a 3D environment with navigation where models can be drawn directly using the built-in CAD tools or alternatively geometry can be imported from other CAD packages. The physics engine uses the parameterization for finite rotations, the symplectic integration scheme and the 6DOFs beam element described in Section  2.

The software, implemented as Java applet,
                           2
                        
                        
                           2
                           The application can be accessed at http://expeditionworkshed.org/workshed/pmpm-3d/; demo movies can be viewed at https://vimeo.com/groups/pushmepullme.
                         allows the creation and interactive manipulation of the geometry of structural models. Interaction is enhanced by the usage of interactive frames [40] which are associated to each node and element of the structures. The interactive frames are objects that can be directly picked in 3D (Figs. 7–9
                        
                        ). Loading can be done by directly pulling or by applying point loads on the nodes and distributed loads on the elements. Pulling is implemented using zero rest-length cable-elements (springs) which are instantiated on the fly as soon as the mouse is within a certain distance from a node or an element. Point and distributed loads are instead vector fields.

To further enhance the interaction, an icon-based interface with sliders is implemented. The icons can be dragged and dropped from the interface tab onto the 3D canvas to apply/remove loads/constraints, create/change type of elements, release internal element degrees of freedom, plot internal force and moments and stress diagrams. The sliders can be used to modify section/material properties 
                           E
                           ,
                           G
                           ,
                           A
                           ,
                           I
                           x
                           x
                           ,
                           I
                           y
                           y
                           ,
                           J
                         (see Section  2.5), plot scales and other parameters for the integration such as the viscous damping factor 
                           C
                         and the time step 
                           Δ
                           
                              t
                           
                        .

Pre-stress is modelled by setting the rest-length of elements shorter than their initial length. This makes it possible to interrogate structures stable only in states of self-stress. Tension structures can be modelled by simply reducing the rest-length of the cable elements that can be changed interactively (Fig. 10
                        ).

Using the same logic, the rest-length can be set to simulate element expansion thus exerting both compression and tension forces. This can be used to simulate both determinate and indeterminate truss structures with embedded actuators which can respond actively to loads by redirecting internal forces [41] or morph into different shapes (Fig. 11
                        ).

A basic optimization routine is built-in to allow minimization of bending stresses while at the same time equalizing the length of the elements (Fig. 12
                        ). This is simply achieved by releasing the internal degrees of freedom of the beams and setting each element’s rest length the average length of the neighbouring elements iteratively. It is worth noting that due to the explicit nature of the physics engine, optimization tasks of this kind are implemented as straightforward extension of the main routine.

PushMePullMe is currently used in several universities in UK amongst which the University College London, Brunel, Strathclyde and East Anglia. Recent studies, which were carried out at the department of Architecture and Civil engineering at Bath University, provide some qualitative evidence of the benefit achieved after the introduction of PushMePullMe as a learning experience [42,43]. According to these studies PushMePullMe is perceived by the students as the most useful resource for learning and understanding the structural behaviour compared to other software and basic physical testing. However, quantitative data (i.e. increase in the pass rate on the exam) were difficult to attribute solely to the use of the software.

@&#CONCLUSIONS@&#

Conventional engineering education draws a neat separation between linear and non-linear methods for structural analysis. In addition, design through optimization whether for size, shape or geometry is regarded as an advanced topic and most often is not part of the students’ curriculum. Combining computational techniques developed in computer graphics and established numerical methods for structural analysis creates a platform that can be used by students and designers to gain a qualitative and quantitative understanding of the structural behaviour of simple and complex systems. Real-time feedback and the possibility to interact with the model offer tremendous potential in teaching.

Next steps will focus on expanding the range of elements available to plates/shells and 3d elements such as tetrahedrons and 8-node bricks. Further investigation to understand the benefits that such a platform can bring in teaching and design by means of analysis of performances in terms of structural efficiency, fabrication constraints and aesthetics will continue in order to gather stronger quantitative evidence.

@&#ACKNOWLEDGEMENTS@&#

The authors would like to thank Chris Williams for his input, advice and support throughout the research project and Expedition Engineering for funding the development of PushMePullMe software.

@&#REFERENCES@&#

