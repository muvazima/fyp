@&#MAIN-TITLE@&#High-quality vertex clustering for surface mesh segmentation using Student-
                  t
                mixture model

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a method for high-quality vertex clustering using Student-
                                 t
                               mixture model.


                        
                        
                           
                           Less redundant clusters, which have no small isolated fragments, have been obtained.


                        
                        
                           
                           High-quality clusters have been obtained which correspond to the underlying surfaces.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Segmentation

Underlying surface extraction

Vertex clustering

Student-




                        t




                      mixture model

Variational Bayes approximation

@&#ABSTRACT@&#


               
               
                  In order to robustly perform segmentation for industrial design objects measured by a 3-D scanning device, we propose a new method for high-quality vertex clustering on a noisy mesh. Using Student-
                     
                        t
                      
                     mixture model with the variational Bayes approximation, we develop a vertex clustering algorithm in the 9-D space composed of three kinds of principal curvature measures along with vertex position and normal component. The normal component is added, because it well describes the surface-features and is less influenced by noise, and the positional component suppresses redundant clusters due to the normal one. Furthermore, in order to enhance the robustness for noisy data, considering mesh topology as a spatial constraint and letting the vertices in its surroundings belong to the same cluster by diffusion process, we protect generating many small fragments due to noise. We demonstrate effectiveness of our method by applying it to the real-world scanned data.
               
            

@&#INTRODUCTION@&#

Surface mesh segmentation has been an important research item in areas such as computer vision, computer graphics and geometric modeling, and its goal is to partition a mesh into several patches that have a similar geometrical or consistent property corresponding to each practical purpose. Among considerable research papers,  [1–3] surveyed mesh segmentation techniques in detail. According to  [2], segmentation is classified into two categories: surface-type and part- (volumetric-) type.

In this paper, we focus on the surface-type segmentation which becomes a pre-image of the final CAD (underlying surface) model  [4], and treat industrial design objects measured by a 3-D scanning device. In reverse engineering, the scanned data are converted into a CAD model composed of underlying surfaces, which are classified into two types: analytic and free-form surfaces  [5]. The former is characterized by a quadric surface or constant curvature, and the latter by monotonically varying curvature. Since curvature analysis is an important clue to partitioning the data for both types of surfaces, the majority of the segmentation methods uses curvature-based descriptors, but has great drawbacks as follows:
                        
                           –
                           this approach may generate a lot of small isolated fragments, called over-segmentation, since curvature is a higher order differential invariant and very sensitive to noise;

it is difficult to find thresholds necessary for partitioning the data according to some levels of curvature value corresponding to the underlying surface.

Our research objective is to propose a robust and high-quality vertex clustering method for segmentation of noisy scanned data. Fig. 1
                     (a) and (b) show an input noisy mesh with a mean curvature map, and Fig. 1(d) indicates a segmentation result which is produced by a simple post-processing of our high-quality vertex clustering Fig. 1(c) in which the speckled pattern shown in Fig. 1(b) does not exist and the underlying surfaces are well extracted.

The main ideas behind our approach for tackling the above problems are based on the following three items: 
                        
                           (i)
                           
                              Student-
                                 t
                               
                              mixture model with the Bayesian statistical framework;

vertex clustering in a 9-D feature space: three kinds of principal curvature measures (3-D), vertex position (3-D) and its normal vector (3-D);

spatial constraint by a diffusion process in the 9-D space.

First, we apply the Student-
                        t
                      distribution, which has a heavy tail, to the vertex clustering for mesh segmentation. Gaussian distribution or Gaussian mixture model (GMM) is widely used in geometry processing for the ease of computation. Unfortunately, such assumption is not correct since usually data are distributed in different ways because of outliers from the normal distribution. Hence, we apply the Student-
                        t
                      
                     mixture model (SMM) to the vertex clustering and solve the SMM with the variational Bayes approximation, since the framework is robust to the over-segmentation problem and is able to automatically find the thresholds for partitioning the noisy data. Compared with the existing methods, we can perform the vertex clustering effectively for the subsequent region growing and merging process.

Second, we perform the vertex clustering in a 9-D space composed of three kinds of principal curvature measures along with a vertex position and its normal vector. Each mesh vertex is represented by a point in this space and clustered by the SMM. The normal vector is added, since it well describes surface-features and is less influenced by noise  [6,7]. And the positional component suppresses the redundant clusters in such a shape as a cylinder, which may be clustered due to the normal component. Thus, we can classify the features more robustly than the approach based only on curvature values.

Third, in order to protect generating many small fragments due to clustering in a high dimensional space in which local similarity of real space (i.e. mesh topology) makes less sense, we introduce a diffusion process in which cluster label (called responsibility) of each point in the 9-D space is diffused in neighborhoods of the corresponding 3-D mesh vertex.

The rest of the paper is organized as follows. Section  2 presents a brief overview of related works. Section  3 addresses our insistence on applying the SMM with the Bayesian framework. In Section  4, we introduce a clustering algorithm in the 9-D space. Experimental results are described in Section  5, and finally we conclude the paper in Section  6.

@&#RELATED WORK@&#

In surface-type segmentation for industrial design objects, it is important what kinds of features we use to reveal the underlying surfaces and how we partition the noisy data into consistent regions. At first, we review some representative descriptors for the surface-feature classification in Section  2.1, and then, explain some major clustering methods using the descriptors in Section  2.2.

The principal curvatures 
                           
                              
                                 k
                              
                              
                                 
                                    max
                                 
                              
                           
                         and 
                           
                              
                                 k
                              
                              
                                 
                                    min
                                 
                              
                           
                         enable us to estimate a local shape of a surface through different curvature coefficients: 
                           
                              
                                 (1)
                                 
                                    K
                                    =
                                    
                                       
                                          k
                                       
                                       
                                          
                                             max
                                          
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          
                                             min
                                          
                                       
                                    
                                    ,
                                      (Gaussian curvature)
                                 
                              
                              
                                 (2)
                                 
                                    H
                                    =
                                    
                                       
                                          
                                             
                                                k
                                             
                                             
                                                
                                                   max
                                                
                                             
                                          
                                          +
                                          
                                             
                                                k
                                             
                                             
                                                
                                                   min
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                      (Mean curvature)
                                 
                              
                              
                                 (3)
                                 
                                    A
                                    =
                                    
                                       |
                                       
                                          
                                             k
                                          
                                          
                                             
                                                max
                                             
                                          
                                       
                                       |
                                    
                                    +
                                    
                                       |
                                       
                                          
                                             k
                                          
                                          
                                             
                                                min
                                             
                                          
                                       
                                       |
                                    
                                    ,
                                      (Absolute curvature)
                                 
                              
                              
                                 (4)
                                 
                                    T
                                    =
                                    
                                       
                                          k
                                       
                                       
                                          
                                             max
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          k
                                       
                                       
                                          
                                             min
                                          
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    4
                                    
                                       
                                          H
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    2
                                    
                                    K
                                    ,
                                      (Total curvature)
                                 
                              
                              
                                 (5)
                                 
                                    S
                                    =
                                    −
                                    
                                       
                                          2
                                       
                                       
                                          π
                                       
                                    
                                    arctan
                                    
                                       
                                          
                                             
                                                k
                                             
                                             
                                                
                                                   max
                                                
                                             
                                          
                                          +
                                          
                                             
                                                k
                                             
                                             
                                                
                                                   min
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                
                                                   max
                                                
                                             
                                          
                                          −
                                          
                                             
                                                k
                                             
                                             
                                                
                                                   min
                                                
                                             
                                          
                                       
                                    
                                    
                                    
                                       (
                                       Shape index   [8]
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                         Furthermore, by the assumption that a smooth surface may be decomposed into a union of eight fundamental surface primitives, Besl and Jain  [9] proposed eight surface types using the signs of 
                           K
                         and 
                           H
                         or principal curvatures as shown in Table 1
                        .

On the other hand, Gumhold et al.  [10] proposed a feature extraction method with a covariance analysis in neighborhood of each point. Medioni et al.  [11] and Page et al.  [12] defined saliency maps from their normal-voting tensors, and the algorithm approximates the feature strength of each vertex based on the eigenvalues of the tensor  [13]. Recently, Wang et al.  [14] introduced weighted harmonic fields via the normal-voting tensor, and proposed a new feature classification method. Benkő and Várady  [15] proposed a segmentation method for conventional engineering objects by combining the other descriptors with the above ones.

Clustering methods are categorized into two cases: non-parametric, where the number of clusters is not given in advance, or parametric, where the number of clusters is specified upfront. We review some representative methods for each case below using the above mentioned descriptors.

The region growing algorithm, including the watershed one which is regarded as a region growing with multiple source seeds, is the most popular method and is widely used in many studies  [2]. Mangan and Whitaker  [16] extended it to 3-D meshes with the seeds defined by the vertex discrete curvature. The curvature type used as a surface descriptor from Eqs. (1) to (4) as well as accuracy of the curvature estimation is critical to the quality of the segmentation result as reported by Pulla et al.  [17], and involves a major drawback, i.e., the results depend on the initial seed selection or creation  [18]. Recently, Wang and Yu  [19] proposed a workaround for the drawback using Morse theory  [20,21] by extracting the critical points in the surface mesh.


                           Mean-shift   [22,23] is another method that uses the probability density function (pdf) at point 
                              
                                 x
                              
                            in a 
                              d
                           -dimensional space. Each mode defined by the peak of pdf is associated with a cluster, and is given by gradient ascent method iteratively. In mesh area, this method was applied to mesh normal clustering by Yamauchi et al.  [24] and to curvature (Eqs. (2) and (5)) clustering by Zhang et al.  [25], respectively. In both cases, the segmentation is performed via the region growing using their mean-shift results.

Vieira and Shimada  [26] classified the mesh vertices by one of eight types in Table 1 at first, then segmented the mesh by gathering the labeled vertices with region growing. Their target models are not CG-like or simple analytic-surface data as found in  [3,27] but industrial style-design objects composed of free-form surfaces, which are the same objectives as our study.

Foremost clustering can be formulated by iteratively searching the best one for the given number of clusters, 
                              M
                           . The basis of this approach is the 
                              k
                           -means algorithm  [28]: 
                              
                                 
                                    J
                                    =
                                    min
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      c
                                                   
                                                
                                                
                                                   m
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    n
                                 
                              
                            is the 
                              n
                           -th 
                              d
                           -dimensional data vector, 
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    m
                                 
                              
                            is the 
                              m
                           -th cluster centroid. Lavoué et al.  [29,30] applied this algorithm to the preprocessing of their segmentation, i.e., the vertices are labeled by the 1-of-
                              M
                            in the principal curvatures space using the 
                              k
                           -means result, then they are gathered by the region growing process in the real space.

In the 
                              k
                           -means algorithm, each data element belongs to exactly one cluster (hard clustering). On the other hand, in soft clustering   [31], data elements belong to more than one cluster, and each of which is represented by the responsibility (or fractional membership) as follows:
                              
                                 responsibility
                              
                              
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             n
                                             m
                                          
                                       
                                     indicates the strength of the association between a data element 
                                       
                                          (
                                          n
                                          )
                                       
                                     and a particular cluster 
                                       
                                          (
                                          m
                                          )
                                       
                                     and has the following properties: 
                                       
                                          (6)
                                          
                                             (i)  
                                             
                                                
                                                   ρ
                                                
                                                
                                                   n
                                                   m
                                                
                                             
                                             ∈
                                             
                                                [
                                                0
                                                ,
                                                1
                                                ]
                                             
                                             ,
                                             
                                             (ii)  
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                
                                                   ρ
                                                
                                                
                                                   n
                                                   m
                                                
                                             
                                             =
                                             1
                                             .
                                          
                                       
                                     For example, 
                                       
                                          
                                             ρ
                                          
                                          
                                             n
                                             m
                                          
                                       
                                       =
                                       1
                                     means that the data 
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             n
                                          
                                       
                                     perfectly belongs to 
                                       m
                                    -th cluster and 
                                       
                                          
                                             ρ
                                          
                                          
                                             n
                                             m
                                          
                                       
                                       =
                                       0
                                     does not do to it.


                           Fuzzy 
                           
                              c
                           -means algorithm  [32] given below is an extension of 
                              k
                           -means to soft clustering: 
                              
                                 
                                    
                                       J
                                       =
                                       min
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             m
                                             =
                                             1
                                          
                                          
                                             M
                                          
                                       
                                       
                                          
                                             ρ
                                          
                                          
                                             n
                                             m
                                          
                                          
                                             r
                                          
                                       
                                       
                                          
                                             
                                                ‖
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         c
                                                      
                                                   
                                                   
                                                      m
                                                   
                                                
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                       r
                                       >
                                       1
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             n
                                             m
                                          
                                       
                                       ≡
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             M
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         ‖
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                         ‖
                                                      
                                                   
                                                   
                                                      
                                                         ‖
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         ‖
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             −
                                             
                                                
                                                   2
                                                
                                                
                                                   r
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             m
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                
                                                   ρ
                                                
                                                
                                                   n
                                                   m
                                                
                                                
                                                   r
                                                
                                             
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                
                                                   ρ
                                                
                                                
                                                   n
                                                   m
                                                
                                                
                                                   r
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

Among soft clustering methods, a component mixture model usually formulated by the Gaussian distributions for the ease of computation gives a powerful solution for clustering tasks, since it can also evaluate the variance of data (see Fig. 2
                           ), whereas 
                              k
                           -means and Fuzzy 
                           
                              c
                           -means are only able to do the mean of it. Recently, Bayesian statistical approach for Gaussian mixture model (GMM) is widely used in the image segmentation because this approach does not suffer from over-fitting. But sufficient studies have not been performed in mesh segmentation, therefore, applying the framework to it, we develop a high-quality vertex clustering method, which extracts the underlying surfaces robustly.

In order to robustly perform segmentation for industrial design objects measured by a 3-D scanning device, we apply the Student-
                        t
                      mixture model (Section  3.1) based on the Bayesian framework (Section  3.2) to vertex clustering.


                        Gaussian mixture model (GMM) is commonly used for clustering tasks  [34], but sensitive to noise as shown in Fig. 3
                        (a). Therefore, instead of the Gaussian distribution, we use the Student-
                           t
                         distribution function defined by the following equation for constructing a robust mixture model:
                           
                              (7)
                              
                                 S
                                 
                                    (
                                    
                                       x
                                    
                                    |
                                    
                                       μ
                                    
                                    ,
                                    Λ
                                    ,
                                    ν
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          Γ
                                       
                                       
                                          (
                                          
                                             
                                                d
                                                +
                                                ν
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                |
                                                Λ
                                                |
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          Γ
                                       
                                       
                                          (
                                          
                                             
                                                ν
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                (
                                                ν
                                                π
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          (
                                          1
                                          +
                                          
                                             
                                                1
                                             
                                             
                                                ν
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      x
                                                   
                                                   −
                                                   
                                                      μ
                                                   
                                                   )
                                                
                                             
                                             
                                                T
                                             
                                          
                                          Λ
                                          
                                             (
                                             
                                                x
                                             
                                             −
                                             
                                                μ
                                             
                                             )
                                          
                                          )
                                       
                                    
                                    
                                       −
                                       
                                          
                                             d
                                             +
                                             ν
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           d
                         is the dimension of a feature space, 
                           
                              μ
                           
                         and 
                           Λ
                         are the component mean and the precision (inverse covariance) matrix, respectively. And 
                           
                              Γ
                           
                           
                              (
                              ⋅
                              )
                           
                         denotes the gamma function. 
                           ν
                           
                              (
                              >
                              0
                              )
                           
                         is called degree of freedom and is an important tuning parameter for robustness. The smaller 
                           ν
                         is, the heavier the tails are.

As shown in Fig. 3(c), Eq. (7) has heavier tails than the Gaussian, which means that it is able to capture the data that are far from its mean as noise. The Student-
                           t
                         mixture model (SMM) is then defined as a weighted sum of multivariate Student-
                           t
                         distributions, and can estimate the means and variances of the data robustly as shown in Fig. 3(b) which are the same as the noiseless data in GMM shown in Fig. 2(right), whereas the variances in GMM are enlarged due to noise shown in Fig. 3(a).

We apply the SMM with VB approximation by Archambeau and Verleysen  [35] to vertex clustering for mesh segmentation. The VB algorithm solves the mixture models based on the Bayesian inference. It estimates the posterior probability of parameters by maximizing the variational negative free-energy (defined by the lower bound of the marginal log-likelihood which approximated by the factorization of the latent and model parameters), using the iterative process called E–M algorithm   [33].

Compared with other statistical methods such as the maximum likelihood (ML) based on point-estimates that maximize the data likelihood, the Bayesian approach prevents the over-segmentation problem and gives a more accurate estimation and automatic model selection (i.e. the number of clusters).

We propose a high-quality vertex clustering algorithm in this section. At first, we explain the way how we construct the 9-D clustering space for applying the SMM in Section  4.1, and then, introduce a robust estimation scheme of a normal vector and principal curvatures using the normal tensor framework in Section  4.2. Next, in Section  4.3, we present a diffusion process in the 9-D space. Finally, we show our vertex clustering algorithm in Section  4.4.

We perform the vertex clustering in the 9-D space composed of three kinds of principal curvature measures along with the surface normal vector and the vertex position. Curvatures are very important descriptors to extract the underlying surfaces, and should be the principal component in the 9-D space. The other components are added in order to suppress the influence of noise and redundant clusters. Each component is processed as follows: 
                           
                              curvatures
                           
                           
                              vary exponentially, therefore, we use the log-curvature values instead of the curvatures (
                                    X
                                 ) themselves: 
                                    
                                       
                                          
                                             LOG
                                          
                                          
                                             |
                                             X
                                             |
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      log
                                                      
                                                         (
                                                         1
                                                         +
                                                         X
                                                         )
                                                      
                                                      ,
                                                   
                                                   
                                                      for  
                                                      X
                                                      ≥
                                                      0
                                                   
                                                
                                                
                                                   
                                                      −
                                                      log
                                                      
                                                         (
                                                         1
                                                         −
                                                         X
                                                         )
                                                      
                                                      ,
                                                   
                                                   
                                                      for  
                                                      X
                                                      <
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                  and nondimensionalizing them divided by their standard deviation. Thereafter, we multiply the values by a scale parameter 
                                    s
                                    
                                       (
                                       >
                                       1
                                       )
                                    
                                 . In our study, we adopt three kinds of curvature measures for 
                                    X
                                 : principal curvatures and total curvature by Eq. (4), and set 
                                    s
                                    =
                                    10
                                  as a default.

is normalized by rescaling the data to have zero mean and unit variance called whitening technique.

is normalized similarly to normal vector.

From the above settings, the high curvature values are located far from the origin in 9-D clustering space while the small curvature values and the other components are located around it. Therefore, high curvature points are clustered without being affected by the other components.

On the other hand, the points around the origin, the small isolated clusters due to noise with small curvature values are suppressed by the normal vector ingredient which well describes the feature saliencies  [6,7] and is less influenced by the noise partly because it is lower order differential invariant than the curvature. But the normal component may produce redundant clusters for such a case as a cylinder with a large radius. Hence, in order to overcome the side-effect of the normal component, we finally consider the 9-D clustering space adding 3-D of a normalized vertex position, and cancel the redundant clusters by the effect of the adjacency.

In order to construct the 9-D space, we introduce a principal curvature equation in the normal tensor framework for a noisy mesh. Our method can robustly estimate the principal curvatures via the surface normal filtering, whereas discrete approximations of the second order derivatives such as cotangent formula for mean curvature and angle deficit method for Gaussian one  [36] are very error-sensitive.

The principal curvatures are given by the eigenvalues of 2×2shape operator matrix  [37]: 
                           S
                           =
                           
                              
                                 
                                    (
                                    
                                       T
                                    
                                    
                                    
                                       B
                                    
                                    )
                                 
                              
                              
                                 T
                              
                           
                           
                              (
                              ∇
                              
                                 
                                    
                                       N
                                    
                                 
                                 
                                    T
                                 
                              
                              )
                           
                           
                              (
                              
                                 T
                              
                              
                              
                                 B
                              
                              )
                           
                        , where 
                           ∇
                         denotes the gradient, and 
                           
                              N
                           
                         and 
                           
                              (
                              
                                 T
                              
                              
                              
                                 B
                              
                              )
                           
                         are the surface normal and any two orthogonal basis to 
                           
                              N
                           
                        , respectively.

On the other hand, the normal tensor 
                           
                              
                                 A
                              
                              
                                 n
                              
                           
                        , which is defined as a weighted sum of a covariance matrix of the facet normals connecting to a mesh vertex 
                           
                              
                                 V
                              
                              
                                 n
                              
                           
                           [38], has real eigenvalues 
                           
                              
                                 σ
                              
                              
                                 1
                              
                           
                           ≥
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                           ≥
                           
                              
                                 σ
                              
                              
                                 3
                              
                           
                           ≥
                           0
                         with the corresponding eigenvectors 
                           
                              
                                 
                                    E
                                 
                              
                              
                                 i
                              
                           
                           
                           
                              (
                              i
                              =
                              1
                              ,
                              2
                              ,
                              3
                              )
                           
                        . The eigenvectors are mutually orthogonal 
                           
                              
                                 
                                    E
                                 
                              
                              
                                 i
                              
                           
                           ⋅
                           
                              
                                 
                                    E
                                 
                              
                              
                                 j
                              
                           
                           =
                           
                              
                                 δ
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        , and 
                           
                              
                                 
                                    E
                                 
                              
                              
                                 1
                              
                           
                         indicates surface normal, 
                           
                              
                                 
                                    E
                                 
                              
                              
                                 2
                              
                           
                           /
                           
                              
                                 
                                    E
                                 
                              
                              
                                 3
                              
                           
                         are the directions of principal curvatures 
                           
                              
                                 k
                              
                              
                                 
                                    max
                                 
                              
                           
                           /
                           
                              
                                 k
                              
                              
                                 
                                    min
                                 
                              
                           
                        . Hence, using these eigenvectors, we obtain the following shape operator matrix whose eigenvalues denote the principal curvatures: 
                           
                              (8)
                              
                                 S
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   E
                                                
                                             
                                             
                                                2
                                             
                                          
                                          
                                          
                                          
                                             
                                                
                                                   E
                                                
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    (
                                    ∇
                                    
                                       
                                          
                                             E
                                          
                                       
                                       
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          
                                             E
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                    
                                    
                                       
                                          
                                             E
                                          
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         In our study, the gradient of the normal vector is calculated by 
                           ∇
                           
                              
                                 
                                    N
                                 
                              
                              
                                 T
                              
                           
                           =
                           R
                           
                              
                                 W
                              
                              
                                 T
                              
                           
                           
                              
                                 
                                    (
                                    W
                                    
                                       
                                          W
                                       
                                       
                                          T
                                       
                                    
                                    )
                                 
                              
                              
                                 −
                                 1
                              
                           
                        , where 
                           R
                         and 
                           W
                         are the matrix form of the normalized difference vector of two vertices and normals, respectively. (See  [39] for details.)

In noisy data, we can robustly estimate the principal curvatures by using the eigenvectors 
                           
                              
                                 
                                    E
                                 
                              
                              
                                 i
                              
                           
                           
                           
                              (
                              i
                              =
                              1
                              ,
                              2
                              ,
                              3
                              )
                           
                         which are obtained via the anisotropic smoothing of normal tensor as follows: 
                           
                              (9)
                              
                                 
                                    
                                       A
                                    
                                    
                                       n
                                    
                                    
                                       
                                          (
                                          t
                                          +
                                          1
                                          )
                                       
                                    
                                 
                                 ←
                                 
                                    
                                       A
                                    
                                    
                                       n
                                    
                                    
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   ′
                                                
                                             
                                             ∈
                                             Λ
                                             
                                                (
                                                n
                                                )
                                             
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             n
                                             
                                                
                                                   n
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             A
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       ∈
                                       Λ
                                       
                                          (
                                          n
                                          )
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       n
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       A
                                    
                                 
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          n
                                       
                                       
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Here, 
                           
                              
                                 A
                              
                              
                                 n
                              
                              
                                 
                                    (
                                    t
                                    )
                                 
                              
                           
                         is normal tensor at vertex 
                           
                              
                                 V
                              
                              
                                 n
                              
                           
                         in the 
                           t
                        -th step and 
                           
                              
                                 w
                              
                              
                                 n
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                              
                              
                                 A
                              
                           
                         is the anisotropic weight  [38]: 
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       n
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       A
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             n
                                             
                                                
                                                   n
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       
                                          
                                             l
                                          
                                          
                                             n
                                             
                                                
                                                   n
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             ⊥
                                          
                                       
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             n
                                             
                                                
                                                   n
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             A
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       l
                                    
                                    
                                       n
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       A
                                    
                                 
                                 ≡
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                −
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      n
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   A
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          −
                                          
                                             
                                                V
                                             
                                             
                                                n
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 l
                              
                              
                                 n
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           =
                           
                              |
                              
                                 
                                    V
                                 
                                 
                                    n
                                 
                              
                              −
                              
                                 
                                    V
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              |
                           
                         and 
                           
                              
                                 l
                              
                              
                                 n
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                              
                              
                                 ⊥
                              
                           
                         is the projected distance of the edge 
                           
                              
                                 V
                              
                              
                                 n
                              
                           
                           
                              
                                 V
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                         on the tangent plane at 
                           
                              
                                 V
                              
                              
                                 n
                              
                           
                        .

We consider the mesh topology as a spatial constraint and let the vertex in its surroundings belong to the same cluster by diffusion in one neighborhood. The reason is as follows: the distance between two points in the clustering space does not explicitly reflect the proximity (or local similarity) of the related two vertices in the real space and this causes a over-segmentation problem.

In our study, the above idea can be realized by using the diffusion embedded E–M algorithm proposed by Boccignone et al. [40]. We let 
                           Λ
                           
                              (
                              n
                              )
                           
                         be the index set of 1-neighborhood vertex at 
                           
                              
                                 V
                              
                              
                                 n
                              
                           
                        , the responsibility 
                        
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 n
                                 m
                              
                           
                         in the SMM clustering, which has the properties of Eq. (6) and is defined by Eq. (11) in the Appendix, is smoothed by its surroundings 
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                                 m
                              
                           
                           
                           
                              (
                              
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              Λ
                              
                                 (
                                 n
                                 )
                              
                              )
                           
                         for each cluster 
                           m
                           
                           
                              (
                              1
                              ≤
                              m
                              ≤
                              M
                              )
                           
                         with the anisotropic weight 
                           
                              
                                 w
                              
                              
                                 n
                                 
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                              
                              
                                 A
                              
                           
                         above:
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       n
                                       m
                                    
                                    
                                       
                                          (
                                          t
                                          +
                                          1
                                          )
                                       
                                    
                                 
                                 ←
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       n
                                       m
                                    
                                    
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   ′
                                                
                                             
                                             ∈
                                             Λ
                                             
                                                (
                                                n
                                                )
                                             
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             n
                                             
                                                
                                                   n
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             A
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       ∈
                                       Λ
                                       
                                          (
                                          n
                                          )
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       n
                                       
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       A
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          n
                                          m
                                       
                                       
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          n
                                          m
                                       
                                       
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         In our experiments, we set 
                           λ
                           =
                           0.25
                        , and 3 iterations.

First, we construct the data points 
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          n
                                       
                                    
                                    }
                                 
                              
                              
                                 n
                                 =
                                 1
                              
                              
                                 N
                              
                           
                         in the 9-D space for each mesh vertex 
                           
                              
                                 V
                              
                              
                                 n
                              
                           
                         using the normal tensor framework. Next, we partition the data into 
                           M
                        -clusters by using the SMM technique twice. In the first time, we perform the clustering without diffusion process. In the second, using the result of the first trial as initial parameters in SMM, we do the clustering with diffusion process.

Algorithm 1 indicates our vertex clustering scheme. 
                           
                              
                           
                        
                     

@&#RESULTS AND DISCUSSION@&#

We have implemented our algorithm described in Algorithm 1 using MS VC++2012 on the mobile Intel/i7®  2620 M (2.7 GHz, 2 core) computer. To demonstrate the effectiveness of our method, we conduct some experiments using two familiar data: Fandisk and Blade in Section  5.1. In Section  5.2, we explain our segmentation process, and show some results for the real-world scanned data of automobile style-design objects in Section  5.3.

In all experiments with our implementation, we use the following conditions: 
                        
                           –
                           the degree of freedom (
                                 ν
                              ) which is the parameter of the Student-
                                 t
                               distribution explained in Section  3.1 was set to 1 for any component of mixtures, and the maximum number of iterations in the E–M algorithm is set to 100;

hyper-parameters of VB defined in  [35] where the resultant equations are listed in the Appendix, were set as follows: 
                                 
                                    
                                       κ
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 1.0
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 1
                                 
                                    
                                       0
                                    
                                    
                                       −
                                       5
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          m
                                       
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       data mean
                                    
                                    }
                                 
                              , 
                                 
                                    
                                       η
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    dim
                                 
                                 +
                                 2
                              , and 
                                 
                                    
                                       S
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0.01
                                 I
                              , where 
                                 
                                    dim
                                 
                               is the dimension of clustering space and 
                                 I
                               is the identity matrix;

to avoid local optimum solutions, we locate initial components whose means and valiances are set as follows: as for valiances, we set them to the ones of whole data of each ingredient (three curvatures, normal, and position); and for means, only curvature ingredients are dispersed in the range between 
                                 
                                    {
                                    
                                       each data mean
                                    
                                    }
                                 
                                 ±
                                 3
                                 ∗
                                 
                                    {
                                    
                                       each standard deviation
                                    
                                    }
                                 
                              , otherwise set to each data mean;

in the normal vector and curvature estimations, except for Fandisk data shown in Fig. 4
                              , we performed the normal tensor smoothing by 10 times iterations in 2-ring neighborhood for the all data.

In order to show the vertex clustering capability of our method, we compare our result with two standard methods: 
                           k
                        -means and mean-shift using Fandisk in Fig. 4 and Blade model in Fig. 5
                        . To compare the effectiveness of SMM with VB, we process clustering of the existing methods in a only 3-D curvature space composed of principal curvatures and total curvature. In this experiment, we set the number of clusters 
                           M
                         to 10 (Fandisk) and 12 (Blade) respectively, and set the bandwidth (Parzen-window size) 
                           h
                           =
                           0.1
                           σ
                         (Fandisk), 
                           σ
                        : standard deviation of the data, and 
                           0.05
                           σ
                         (Blade) in mean-shift with Gaussian kernel.

First, figures from Fig. 4(b) to (d) show the comparisons under the same 3-D clustering space, and our result (d) has less speckle clustered vertices among them. Next, Fig. 4(e) shows the result using our proposed 9-D clustering space, and we obtain clusters without speckles and with appropriate fillet regions. This is the same in the Blade model shown in Fig. 5. Note that, two flat surfaces with the opposite normal directions could be distinguished in Fig. 4(e) owing to the normal component in 9-D. It is important for the thin plate clustering.

High-quality clustering can facilitate a subsequent process for the segmentation. We implement a basic process from clustering to segmentation similar to  [29,30] as shown in Fig. 6
                        ; given a high-quality vertex clustering, 
                           
                              (i)
                              we can obtain regions by gathering facets with the same clustered vertices (i.e., region growing). Fig. 6(a) which is a part of Fig. 5(e), is the same to a result of region growing, since each facet is filled by assigning colors of the cluster to its vertices;

then, splitting disjoint regions and re-assigning the different colors individually (Fig. 6(b));

finally, a segmentation is accomplished (Fig. 6(c)).


                        Fig. 7
                         shows the result applying the segmentation process in Fig. 6 to the vertex clustering shown in Fig. 5. Our result (Fig. 7(c)) is almost the same to the final segmentation whereas Fig. 7(a) should be merged so as to reduce the small segments and Fig. 7(b) was merged too much and has lost edges and corners (fillets). Note that the merging process usually requires some threshold parameters whose tuning is often difficult and cumbersome.

In order to show the effectiveness of our method for industrial design objects measured by a 3-D scanning device, which is our main objective, we conducted experiments for three models in the 9-D clustering space specifying the number of clusters 
                           M
                           =
                           20
                         along with its segmentation.

First, we show the result of a car exterior model in Fig. 8
                        . The level of noise can be seen in the bottom of Fig. 8(a). The character-lines such as L1, L2 and L3 shown in Fig. 8(a) are well extracted as indicated in Fig. 8(b). Further, our method suggests some region boundaries such as B1 and B2 in Fig. 8(b), which consequently create regions R3 and R5 in Fig. 8(c). The data were measured for a car in the market, therefore the parting-lines, which were formed by concave grooves or lacking the data, exist in the door parts shown in Fig. 8(b). Fig. 8(d) shows an example of an underlying surface with our polynomial surface fitting.


                        Figs. 9 and 10
                        
                         show the results for interior design objects in a car; instrumental panel and door trim, respectively. We can see that our proposed clustering is almost equivalent to the final segmentation also in these cases.

Through the above experiments, our algorithm has shown it executes high-quality clustering for the segmentation. Table 2
                         lists the model size, input cluster size (
                           M
                        ), the number of regions after segmentation, and run-time for vertex clustering of each data in our method, and Table 3
                         indicates the run-time performance of Fandisk and Blade model by using other algorithms.

@&#DISCUSSION@&#

We demonstrate the robustness of SMM compared with GMM, and the validity of our proposed 9-D clustering space. First, Fig. 11
                        (a) and (b) shows the difference between GMM and SMM without the diffusion process. There exist many speckle noise in GMM, whereas SMM is almost the same as Fig. 5(e) done with diffusion process. Second, Fig. 11(b) and (c) shows the effect whether the clustering space includes a positional component or not. Owing to the positional component, some clustered vertices badly influenced by the normal component disappear in the 9-D space.

Next, in order to evaluate the capability of the extraction of the underlying surfaces in our method compared with those in the methods based on the non-clustering scheme, we conducted experiments using two softwares: EfPiSoft  [41] and Geomagic Studio  [42]. Fig. 12
                         shows their segmentation results: (a), (b), and (c) are the ones by  [41,43], and (d)–(f) are the ones by  [42,44]. In Geomagic Studio, we used three default parameters provided by the system (see the caption of Fig. 12). But in automobile exterior model, we changed only one parameter, i.e. curvature sensitivity so as to produce a similar result to ours, because the default value makes the data too smooth and produce only a coarse segmentation result. Comparing several regions marked with the dashed circles in Fig. 12 with our segmentation results shown in Fig. 7(c) and Fig. 8(c), our method has well extracted the underlying surfaces robustly not only in a mechanical model but also in a style-design object composed of free-from surfaces suppressing the over-segmentation.

Finally, we discuss on the model complexity (i.e. the number of clusters) 
                           M
                        , which should correspond with the number of kinds of underlying surfaces constituting the given model in this study. The values used in our study were chosen by the following strategies. In simple mechanical models such as Fandisk and Blade, considering signs of curvature values similarly as eight surface types as in Table 1   [9,45], we set 
                           M
                           ≃
                           10
                         for the 9-D space: for large curvature areas as fillets and those for smaller curvature areas adding several normal directions. In the industrial design objects, since changes for middle size curvature values are important, we chose 
                           M
                           =
                           20
                        . On the other hand, in Bayesian approach, we can select it from the several specified values of 
                           M
                         by comparing the variational lower bound for each 
                           M
                         [2, 10]. Although our experiments could not select reasonable 
                           M
                         corresponding to the lower bound, the above settings seem to show sufficient capability for extracting the underlying surfaces.

@&#CONCLUSIONS@&#

We have proposed a high-quality vertex clustering method for surface mesh segmentation using the Student-
                        t
                      distributions model with the variational Bayes approximation. In order to compensate the side-effect of the existing curvature-based clustering, we have constructed the 9-D clustering space of log-scaled standardized curvatures along with vertex normal and position components accompanying the diffusion process.

We have shown its effectiveness from some experimental results, comparing with the representative and widely used methods in the existing studies. In our method, we have obtained less redundant clusters, and furthermore, high-quality clusters which correspond to the underlying surfaces of the desirable segmentation.

Future research includes improving the prior distributions and the likelihood function so as to be able to select the model complexity 
                        M
                     , i.e. the number of clusters, automatically in the Bayesian framework, and applying our method to the surface fitting, and so on.

@&#ACKNOWLEDGMENTS@&#

Blade model shown in Fig. 5 is courtesy of the AIM@SHAPE Shape Repository, and the scanned data shown in Figs. 8–10 are provided by Daihatsu Motor Co., Ltd. In Fig. 12, (a)–(c) are produced by EfPiSoft  [43,41], and (d)–(f) by Geomagic Studio 13 (automatic segmentation function  [42,44]).

The VB method of the SMM amounts to an iterative update of the distributions on two hidden variables 
                        
                           
                              z
                           
                           
                              n
                              m
                           
                        
                      and 
                        
                           
                              u
                           
                           
                              n
                              m
                           
                        
                     , and on model parameters in which Gaussian–Wishart distributions are imposed on the means and covariances, Dirichlet prior on the mixture portions, and Gamma distribution 
                        G
                      on the scale parameter accompanied by the hyper-parameters 
                        
                           
                              κ
                           
                           
                              m
                           
                        
                        ,
                        
                           
                              γ
                           
                           
                              m
                           
                        
                        ,
                        
                           
                              m
                           
                           
                              m
                           
                        
                        ,
                        
                           
                              η
                           
                           
                              m
                           
                        
                     , and 
                        
                           
                              S
                           
                           
                              m
                           
                        
                     .

The computation of the approximating posteriors 
                        q
                        
                           (
                           
                              
                                 z
                              
                              
                                 n
                                 m
                              
                           
                           )
                        
                      and 
                        q
                        
                           (
                           
                              
                                 u
                              
                              
                                 n
                                 m
                              
                           
                           )
                        
                     , which are the probability that each 
                        d
                      dimensional data point 
                        
                           
                              
                                 x
                              
                           
                           
                              n
                           
                        
                        
                           (
                           1
                           ≤
                           n
                           ≤
                           N
                           )
                        
                      comes from a particular mixture component 
                        m
                      and the scale variable respectively, are given by the following equations (VB E-step): 
                        
                           
                              
                                 q
                                 
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          n
                                          m
                                       
                                    
                                    =
                                    1
                                    )
                                 
                                 ∝
                                 
                                    
                                       
                                          Γ
                                       
                                       
                                          (
                                          
                                             
                                                d
                                                +
                                                
                                                   
                                                      ν
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          Γ
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      ν
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      ν
                                                   
                                                   
                                                      m
                                                   
                                                
                                                π
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             Λ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       m
                                    
                                    
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          {
                                          1
                                          +
                                          
                                             
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ν
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                S
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   
                                                      ν
                                                   
                                                   
                                                      m
                                                   
                                                
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                          
                                          }
                                       
                                    
                                    
                                       −
                                       
                                          
                                             d
                                             +
                                             
                                                
                                                   ν
                                                
                                                
                                                   m
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 q
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          n
                                          m
                                       
                                    
                                    |
                                    
                                       
                                          z
                                       
                                       
                                          n
                                          m
                                       
                                    
                                    =
                                    1
                                    )
                                 
                                 =
                                 G
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          n
                                          m
                                       
                                    
                                    |
                                    
                                       
                                          α
                                       
                                       
                                          n
                                          m
                                       
                                    
                                    ,
                                    
                                       
                                          β
                                       
                                       
                                          n
                                          m
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                      where using the digamma function 
                        Ψ
                        
                           (
                           ⋅
                           )
                        
                     , 
                        
                           
                              
                                 log
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 ≡
                                 Ψ
                                 
                                    (
                                    
                                       
                                          κ
                                       
                                       
                                          m
                                       
                                    
                                    )
                                 
                                 −
                                 Ψ
                                 
                                    (
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                    
                                       
                                          κ
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 log
                                 
                                    
                                       
                                          
                                             Λ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 ≡
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       d
                                    
                                 
                                 Ψ
                                 
                                    (
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                m
                                             
                                          
                                          +
                                          1
                                          −
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 +
                                 d
                                 log
                                 2
                                 −
                                 log
                                 
                                    |
                                    
                                       
                                          S
                                       
                                       
                                          m
                                       
                                    
                                    |
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       α
                                    
                                    
                                       n
                                       m
                                    
                                 
                                 =
                                 
                                    (
                                    d
                                    +
                                    
                                       
                                          ν
                                       
                                       
                                          m
                                       
                                    
                                    )
                                 
                                 /
                                 2
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       β
                                    
                                    
                                       n
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             m
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                n
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   m
                                                
                                             
                                             
                                                m
                                             
                                          
                                          )
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       m
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          n
                                       
                                    
                                    −
                                    
                                       
                                          
                                             m
                                          
                                       
                                       
                                          m
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       d
                                    
                                    
                                       2
                                       
                                          
                                             η
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             ν
                                          
                                          
                                             m
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        
                     
                  

The responsibility is defined by normalizing the distribution 
                        q
                        
                           (
                           
                              
                                 
                                    z
                                 
                              
                              
                                 n
                              
                           
                           )
                        
                      for each data point 
                        
                           
                              
                                 x
                              
                           
                           
                              n
                           
                        
                      as follows: 
                        
                           (11)
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    n
                                    m
                                 
                              
                              ≡
                              
                                 
                                    q
                                    
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             n
                                             m
                                          
                                       
                                       =
                                       1
                                       )
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                    q
                                    
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             n
                                             
                                                
                                                   m
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       =
                                       1
                                       )
                                    
                                 
                              
                              .
                           
                        
                     
                  

The parameters are updated as follows (VB M-step): 
                        
                           
                              
                                 
                                    
                                       κ
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 N
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 +
                                 
                                    
                                       κ
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       η
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 N
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 +
                                 
                                    
                                       η
                                    
                                    
                                       0
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       
                                          m
                                       
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       N
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   ̄
                                                
                                             
                                          
                                          
                                             m
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                
                                                
                                                   ̄
                                                
                                             
                                          
                                          
                                             m
                                          
                                       
                                       +
                                       
                                          
                                             η
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             
                                                m
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             η
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 N
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       0
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 N
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 +
                                 
                                    
                                       N
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   ̄
                                                
                                             
                                          
                                          
                                             m
                                          
                                       
                                       
                                          
                                             η
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             η
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          m
                                       
                                    
                                    −
                                    
                                       
                                          
                                             m
                                          
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                   
                                                   
                                                      ̄
                                                   
                                                
                                             
                                             
                                                m
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   m
                                                
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                    
                                    
                                       T
                                    
                                 
                                 +
                                 
                                    
                                       S
                                    
                                    
                                       0
                                    
                                 
                                 .
                              
                           
                        
                     
                  

To compute the hyper-parameter update, the following statistics of the observed data with respect to 
                        
                           
                              z
                           
                           
                              n
                              m
                           
                        
                      need to be calculated: 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       n
                                       m
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       n
                                       m
                                    
                                 
                                 ≡
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             n
                                             m
                                          
                                       
                                    
                                    
                                       
                                          
                                             β
                                          
                                          
                                             n
                                             m
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       n
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       n
                                       m
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       N
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   ̄
                                                
                                             
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       n
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       n
                                       m
                                    
                                 
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       n
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       N
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   ̄
                                                
                                             
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       n
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ̄
                                          
                                       
                                    
                                    
                                       n
                                       m
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          n
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          m
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                n
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                   
                                                   
                                                      ̄
                                                   
                                                
                                             
                                             
                                                m
                                             
                                          
                                          )
                                       
                                    
                                    
                                       T
                                    
                                 
                                 .
                              
                           
                        
                     
                  

Finally, since no prior is imposed on the degrees of freedom, it can be approximated by such a formula as  [46].

@&#REFERENCES@&#

