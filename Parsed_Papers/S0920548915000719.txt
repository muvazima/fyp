@&#MAIN-TITLE@&#Fully secure fuzzy identity-based encryption for secure IoT communications

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We proposed a new fuzzy identity-based encryption (FIBE) scheme.


                        
                        
                           
                           We prove that our new FIBE scheme is secure in the full model without random oracles.


                        
                        
                           
                           Our proposed FIBE scheme is more efficient than previous schemes.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Fuzzy identity-based encryption

Tight reduction

Standard model

Secure communications

Internet of things

@&#ABSTRACT@&#


               
               
                  How to securely transmit data is an important problem in Internet of Things (IoT). Fuzzy identity-based encryption (FIBE) is a good candidate for resolving this problem. However, existing FIBE schemes suffer from the following disadvantages: rely on random oracle models, merely secure in selective-ID model, long public parameters, and loose security reduction. In this paper, we propose a new FIBE scheme. Our scheme is secure in the full model without random oracles, and at the same time has a tight security reduction and short public parameters. This means that our scheme is quite suitable for secure transmitting data in IOT.
               
            

@&#INTRODUCTION@&#

In the past few years, Internet of Things (IoT) [1] has been widely used in our daily life. IoT can be viewed as a physical and logical extension of the current internet, populated by billions of intelligent networked devices or “things” [2]. Since the devices in IoT are physically vulnerable and are often left unattended, IoT applications are usually vulnerable to security attacks. Thus the security problems gain more and more attention in IoT. In particular, how to securely transmit data in IoT systems is an important problem. Encryption is a potential technique which can be used for secure communications in IoT. It is worth noting that, traditional encryption technique cannot be trivially used in IoT systems, since the devices in IoT are usually source-constrained, and hence the encryption scheme should be quite efficient. In addition, errors would usually occur during the data transmission, and hence the encryption scheme should provide the feasibility of correcting the errors, i.e., error-tolerance.

Identity Based Encryption (IBE), introduced by Shamir [3] in Crypto 1984, is a public key encryption mechanism where an arbitrary string (such as a user's phone number, email address, identity number, etc.) can serve as the public key. The ability to use identities as public keys can naturally eliminate the need for certificates as used in the traditional pubic key infrastructure (PKI), and hence IBE is more desirable than traditional public key encryption in PKI. IBE has attracted great interests in the past few years, and many IBE schemes and the variants have been proposed in the past years [4–12]. However, IBE cannot provide the property of error-tolerance. To address this problem, in Eurocrypt'05, Sahai and Waters [13] introduced a new notion named fuzzy identity-based encryption (FIBE). In a FIBE scheme, a user with a private key for an identity ID is able to decrypt a ciphertext encrypted with an identity ID
                     ' if and only if ID and ID
                     ' are within a certain distance of each other as judged by some metrics. This means that FIBE is error-tolerant.

In Eurocrypt'05, Sahai and Waters [13] presented two constructions of FIBE systems. The first construction (SW-I for short) only allows for limited attributes, and the second one (SW-II) is a large universe construction that uses all elements in ℤ
                        p
                     
                     ⁎ as attributes. Both schemes are only secure in a weak security model named selective-ID model, in which the adversary must commit the target identity (which the adversary wants to attack) ahead of the system setup. Besides, the public parameters in both constructions are somewhat long, that is, the public parameters size in SW-I grows linearly with the number of possible attributes in the universe, and in SW-II it grows linearly in a parameter which is fixed as the maximum size identity one can encrypt to.

As mentioned above, Sahai-Waters FIBE systems are only secure in the selective-ID model. As shown in [13], suppose that all identities are composed of n attributes and 
                        U
                      is the universe of attributes, then to achieve the full security, these schemes will introduce a security degradation of 
                        
                           
                              
                                 U
                              
                              n
                           
                        
                     . We stress that, a loose security reduction implies a lower security or the requirement of larger keys and ciphertext sizes to obtain the same security level, and thus make the system inefficient. Hence a stronger requirement for our FIBE system proposed in this paper is to be secure in the full model (i.e., the adversary can commit the target identity at any time), and yet the security reduction is tight.

Baek et al. [14] presented another FIBE scheme with short public parameters in the random oracle model.
                        1
                     
                     
                        1
                        In a previous work [15], Pirretti et al. also observed that Sahai-Waters construction can be implemented more efficiently if the random oracle is employed.
                      However, a proof in the random oracle model can only serve as a heuristic argument and does not imply the security in the real world [16–19]. Thus FIBE schemes secure in the standard model (i.e., without random oracles) are more desirable.

Ren et al. [20] proposed a new FIBE scheme, and claimed that their scheme is secure in the full model without random oracles. Unfortunately, Wang et al. [21] and Tian et al. [22] independently present attacks against Ren et al's FIBE scheme, and indicated that Ren et al.'s scheme is insecure in the full model. Other works have been devoted to FIBE. Pirretti et al. [15] examined methods for applying the Sahai-Waters FIBE systems into practice and presented an implementation of these constructions. Chase [23] gave a multi-authority construction of FIBE which allows any polynomial number of independent authorities to monitor attributes and distribute secret keys. They also showed how to apply their techniques to achieve a multi-authority version of the large universe KP-ABE.

In this paper, we propose a new FIBE scheme. Unlike previous selective-ID secure FIBE schemes, our proposed scheme is secure in the full model without random oracles. In addition, our scheme has the advantage of tight security reduction. Thus in contrast to previous FIBE schemes with loose security reduction, our scheme needs not to enlarge the keys size and ciphertext sizes to obtain the same security level. Our scheme also enjoys the advantage of constant size of public parameters. All of these indicate that our FIBE scheme is more efficient that previous schemes, and hence is more suitable for secure IoT communications.

The rest of this paper is organized as follows. Section 2 gives an introduction to bilinear pairings and some complexity assumptions. In Section 3, we review the definition and security notion for FIBE. We present our FIBE scheme in Section 4. The security proof for our scheme and a comparison between our FIBE scheme and some other FIBE schemes are also given in this section. Finally, Section 5 concludes this paper.

Throughout this paper, let ℤ
                           p
                         denote the set {0,1,2,⋯,
                        p
                        −1}, and ℤ
                           p
                        
                        ⁎ denote ℤ
                           p
                        \{0}. For a finite set S, we let |S| denote the cardinality of S, and 
                           x
                           
                              ←
                              $
                           
                           S
                         means choosing an element x from the set S with a uniform distribution.

Let 
                           G
                         be a cyclic multiplicative group of prime order p, and 
                           
                              G
                              T
                           
                         be a cyclic multiplicative group of the same order p. A bilinear pairing is a map 
                           e
                           :
                           G
                           ×
                           G
                           →
                           
                              G
                              T
                           
                         with the following properties:
                           
                              •
                              Bilinearity: 
                                    ∀
                                    
                                       g
                                       1
                                    
                                    ,
                                    
                                       g
                                       2
                                    
                                    ∈
                                    G
                                    ,
                                    ∀
                                    a
                                    ,
                                    b
                                    ∈
                                    
                                       ℤ
                                       p
                                       *
                                    
                                 , we have e(g
                                 1
                                 
                                    a
                                 ,
                                 g
                                 2
                                 
                                    b
                                 )=
                                 e(g
                                 1,
                                 g
                                 2)
                                    ab
                                 ;

Non-degeneracy: there exist 
                                    
                                       g
                                       1
                                    
                                    ,
                                    
                                       g
                                       2
                                    
                                    ∈
                                    G
                                  such that e(g
                                 1,
                                 g
                                 2)≠1;

Computability: there exists an efficient algorithm to compute e(g
                                 1,
                                 g
                                 2) for 
                                    ∀
                                    
                                       g
                                       1
                                    
                                    ,
                                    
                                       g
                                       2
                                    
                                    ∈
                                    G
                                 .

As shown in [24], bilinear parings can be obtained from the Weil pairing or Tate pairing over supersingular elliptic curves or Abelian varieties.

The security of our constructions is based on a variant of the q-bilinear Diffie–Hellman exponent (BDHE) assumption. We here first recall the q-BDHE assumption, which has been used to construct an efficient HIBE scheme in [4] and a broadcast encryption scheme in [25]. The q-BDHE assumption is stated as follows: given a vector of 2q
                        +1 elements
                           
                              
                                 
                                    
                                       g
                                       '
                                       ,
                                       g
                                       ,
                                       
                                          g
                                          α
                                       
                                       ,
                                       
                                          g
                                          
                                             
                                                α
                                                2
                                             
                                          
                                       
                                       ,
                                       ⋯
                                       ,
                                       
                                          g
                                          
                                             
                                                α
                                                q
                                             
                                          
                                       
                                       ,
                                       
                                          g
                                          
                                             
                                                α
                                                
                                                   q
                                                   +
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                       ⋯
                                       ,
                                       
                                          g
                                          
                                             
                                                α
                                                
                                                   2
                                                   q
                                                
                                             
                                          
                                       
                                    
                                 
                                 ∈
                                 
                                    G
                                    
                                       2
                                       q
                                       +
                                       1
                                    
                                 
                              
                           
                        as input, output 
                           e
                           
                              
                                 
                                    g
                                    ,
                                    g
                                    '
                                 
                              
                              
                                 
                                    α
                                    
                                       q
                                       +
                                       1
                                    
                                 
                              
                           
                        . Since the input vector is missing the term 
                           
                              g
                              
                                 
                                    α
                                    
                                       q
                                       +
                                       1
                                    
                                 
                              
                           
                        , the bilinear map does not seem to help compute 
                           e
                           
                              
                                 
                                    g
                                    ,
                                    g
                                    '
                                 
                              
                              
                                 
                                    α
                                    
                                       q
                                       +
                                       1
                                    
                                 
                              
                           
                        .

For convenience, hereafter, we use g
                        
                           i
                         and g
                        '
                        
                           i
                         to denote 
                           
                              g
                              
                                 
                                    α
                                    i
                                 
                              
                           
                         and 
                           g
                           
                              '
                              
                                 
                                    α
                                    i
                                 
                              
                           
                         respectively. Gentry [6] defined an almost identical assumption named q augmented bilinear Diffie–Hellman exponent (q-ABDHE) assumption: given a vector of 2q
                        +2 elements
                           
                              
                                 
                                    
                                       g
                                       '
                                       ,
                                       g
                                       
                                          '
                                          
                                             q
                                             +
                                             2
                                          
                                       
                                       ,
                                       g
                                       ,
                                       
                                          g
                                          1
                                       
                                       ,
                                       
                                          g
                                          2
                                       
                                       ,
                                       ⋯
                                       ,
                                       
                                          g
                                          q
                                       
                                       ,
                                       
                                          g
                                          
                                             q
                                             +
                                             2
                                          
                                       
                                       ,
                                       ⋯
                                       ,
                                       
                                          g
                                          
                                             2
                                             q
                                          
                                       
                                    
                                 
                                 ∈
                                 
                                    G
                                    
                                       2
                                       q
                                       +
                                       2
                                    
                                 
                              
                           
                        as input, output e(g
                        
                           q
                           +1,
                        g
                        '). Introducing the additional term g
                        '
                        
                           q
                           +2 still does not appear to help compute e(g
                        
                           q
                           +1,
                        g
                        '), since the term 
                           
                              g
                              
                                 
                                    α
                                    
                                       ‐
                                       1
                                    
                                 
                              
                           
                         is missed in the input vector.

We here further modify the q-ABDHE assumption by introducing another additional term g
                        2q
                           +1. That is, given a vector of 2q
                        +3 elements
                           
                              
                                 
                                    
                                       g
                                       '
                                       ,
                                       g
                                       
                                          '
                                          
                                             q
                                             +
                                             2
                                          
                                       
                                       ,
                                       g
                                       ,
                                       
                                          g
                                          1
                                       
                                       ,
                                       
                                          g
                                          2
                                       
                                       ,
                                       ⋯
                                       ,
                                       
                                          g
                                          q
                                       
                                       ,
                                       
                                          g
                                          
                                             q
                                             +
                                             2
                                          
                                       
                                       ,
                                       ⋯
                                       ,
                                       
                                          g
                                          
                                             2
                                             q
                                          
                                       
                                       ,
                                       
                                          g
                                          
                                             2
                                             q
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 ∈
                                 
                                    G
                                    
                                       2
                                       q
                                       +
                                       3
                                    
                                 
                              
                           
                        as input, output e(g
                        
                           q
                           +1,
                        g
                        '). Again, introducing the additional term g
                        2q
                           +1 still does not appear to help compute e(g
                        
                           q
                           +1,
                        g
                        '), since the input vector is missing the term 
                           g
                           
                              '
                              
                                 
                                    α
                                    
                                       ‐
                                       q
                                    
                                 
                              
                           
                        . We refer to this modified assumption as q modified bilinear Diffie–Hellman exponent (q-MBDHE) assumption. Our proposed systems are based on the decisional q-MBDHE assumption. Formally,
                           Definition 1
                           The decisional q-MBDHE problem in groups 
                                 
                                    G
                                    
                                       G
                                       T
                                    
                                 
                               is, given a vector
                                 
                                    
                                       
                                          
                                             g
                                             '
                                             ,
                                             g
                                             
                                                '
                                                
                                                   q
                                                   +
                                                   2
                                                
                                             
                                             ,
                                             g
                                             ,
                                             
                                                g
                                                1
                                             
                                             ,
                                             
                                                g
                                                2
                                             
                                             ,
                                             ⋯
                                             ,
                                             
                                                g
                                                q
                                             
                                             ,
                                             
                                                g
                                                
                                                   q
                                                   +
                                                   2
                                                
                                             
                                             ,
                                             ⋯
                                             ,
                                             
                                                g
                                                
                                                   2
                                                   q
                                                
                                             
                                             ,
                                             
                                                g
                                                
                                                   2
                                                   q
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       ∈
                                       
                                          G
                                          
                                             2
                                             q
                                             +
                                             3
                                          
                                       
                                    
                                 
                              for unknown 
                                 α
                                 
                                    ←
                                    $
                                 
                                 
                                    ℤ
                                    p
                                    *
                                 
                               and the random element 
                                 Z
                                 
                                    ←
                                    $
                                 
                                 
                                    G
                                    T
                                 
                              , to decide whether Z
                              =
                              e(g
                              
                                 q
                                 +1,
                              g
                              '). For a probabilistic polynomial-time adversary 
                                 B
                              , we define his advantage against the decisional q-MBDHE problem in groups 
                                 
                                    G
                                    
                                       G
                                       T
                                    
                                 
                               as
                                 
                                    
                                       
                                          
                                             
                                                Ad
                                                
                                                   v
                                                   
                                                      B
                                                      ,
                                                      
                                                         G
                                                         
                                                            G
                                                            T
                                                         
                                                      
                                                   
                                                   
                                                      q
                                                      −
                                                      MBDHE
                                                   
                                                
                                                ≜
                                                
                                                   
                                                      Pr
                                                      
                                                         
                                                            B
                                                            
                                                               
                                                                  g
                                                                  '
                                                                  ,
                                                                  g
                                                                  
                                                                     '
                                                                     
                                                                        q
                                                                        +
                                                                        2
                                                                     
                                                                  
                                                                  ,
                                                                  g
                                                                  ,
                                                                  
                                                                     g
                                                                     1
                                                                  
                                                                  ,
                                                                  
                                                                     g
                                                                     2
                                                                  
                                                                  ,
                                                                  ⋯
                                                                  ,
                                                                  
                                                                     g
                                                                     q
                                                                  
                                                                  ,
                                                                  
                                                                     g
                                                                     
                                                                        q
                                                                        +
                                                                        2
                                                                     
                                                                  
                                                                  ,
                                                                  ⋯
                                                                  ,
                                                                  
                                                                     g
                                                                     
                                                                        2
                                                                        q
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     g
                                                                     
                                                                        2
                                                                        q
                                                                        +
                                                                        1
                                                                     
                                                                  
                                                                  ,
                                                                  e
                                                                  
                                                                     
                                                                        
                                                                           g
                                                                           
                                                                              q
                                                                              +
                                                                              1
                                                                           
                                                                        
                                                                        ,
                                                                        g
                                                                        '
                                                                     
                                                                  
                                                               
                                                            
                                                            =
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      −
                                                      Pr
                                                      
                                                         
                                                            B
                                                            
                                                               
                                                                  g
                                                                  '
                                                                  ,
                                                                  g
                                                                  
                                                                     '
                                                                     
                                                                        q
                                                                        +
                                                                        2
                                                                     
                                                                  
                                                                  ,
                                                                  g
                                                                  ,
                                                                  
                                                                     g
                                                                     1
                                                                  
                                                                  ,
                                                                  
                                                                     g
                                                                     2
                                                                  
                                                                  ,
                                                                  ⋯
                                                                  ,
                                                                  
                                                                     g
                                                                     q
                                                                  
                                                                  ,
                                                                  
                                                                     g
                                                                     
                                                                        q
                                                                        +
                                                                        2
                                                                     
                                                                  
                                                                  ,
                                                                  ⋯
                                                                  ,
                                                                  
                                                                     g
                                                                     
                                                                        2
                                                                        q
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     g
                                                                     
                                                                        2
                                                                        q
                                                                        +
                                                                        1
                                                                     
                                                                  
                                                                  ,
                                                                  Z
                                                               
                                                            
                                                            =
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              where the probability is taken over the random bits consumed by 
                                 B
                              , the random choices of 
                                 g
                                 ,
                                 g
                                 '
                                 ∈
                                 G
                                 ,
                                 α
                                 ∈
                                 
                                    ℤ
                                    p
                                    *
                                 
                               and 
                                 Z
                                 ∈
                                 
                                    G
                                    T
                                 
                              .

We say that the (t,ϵ) decisional q-MBDHE assumption holds in groups 
                                 
                                    G
                                    
                                       G
                                       T
                                    
                                 
                              , if no t-time adversary 
                                 B
                               has advantage at least ϵ in solving the decisional q-MBDHE problem in 
                                 
                                    G
                                    
                                       G
                                       T
                                    
                                 
                              .

Decisional q-MBDHE is a new and non-standard problem. However, it can be verified that it belongs to the general Diffie–Hellman exponent problems mentioned in [25]. Boneh et al. [25] have given the complexity lower bound for these general Diffie–Hellman exponent problems in generic groups. According to their results, we can see that the complexity lower bound of our decisional q-MBDHE assumption is only about 3 times than that of the well-studied BDDH assumption. However, we emphasize that this comparison may not hold in the real world, since the fastest algorithms for solving these assumptions are likely non-generic.

Like traditional identity-based encryption (IBE) systems, a FIBE consists of four algorithms: Setup, Extract, Encrypt, and Decrypt. In a FIBE system, however, the identity is viewed as a set of attributes. A message encrypted under a set w
                     ' of attributes can be decrypted by a secret key associated with a set w of attributes, if and only if w
                     ' and w are within a certain distance of each other as judged by some metric. More precisely, a FIBE system consists of the following algorithms.
                        
                           Setup (κ,
                              d): takes as input a security parameter κ and an error tolerance parameter d. It generates the public parameters param and the corresponding master secret key msk.

Extract 
                                 
                                    
                                       m
                                       s
                                       k
                                    
                                    ID
                                 
                              : takes as input the master secret key msk, an identity 
                                 ID
                               with a set of attributes. It outputs the secret key 
                                 s
                                 
                                    k
                                    ID
                                 
                               for identity 
                                 ID
                              .

Encrypt 
                                 
                                    
                                       m
                                       ,
                                       param
                                       ,
                                       ID
                                       '
                                    
                                 
                              : takes as input a message m, the public parameters param and an identity 
                                 ID
                                 '
                              . It outputs a ciphertext CT.

Decrypt 
                                 
                                    
                                       param
                                       ,
                                       s
                                       
                                          k
                                          ID
                                       
                                       ,
                                       C
                                       T
                                    
                                 
                              : takes as input the public parameters, a ciphertext CT encrypted under an identity 
                                 ID
                                 '
                              , and an identity 
                                 ID
                               such that 
                                 
                                    
                                       ID
                                       
                                          ∩
                                       
                                       ID
                                       '
                                    
                                 
                                 ≥
                                 d
                              . It decrypts this ciphertext and returns the resulting plaintext.

We here define the security model for FIBE system. This model is very similar to the model for standard IBE system, with the exception that the adversary is only allowed to query for secret keys for identities which have less than d overlap with the target identity. Concretely, the IND-ID-CCA2 security for FIBE systems is defined by the following game between an adversary 
                        A
                      and a challenger 
                        C
                     .
                        
                           Setup the challenger 
                                 C
                               runs 
                                 S
                                 e
                                 tup
                                 
                                    κ
                                 
                               to obtain the public parameters param and the corresponding master key msk. 
                                 C
                               gives param to adversary 
                                 A
                              , and keeps msk himself.

Phase 1 adversary 
                                 A
                               adaptively issues queries q
                              1,⋯,
                              q
                              
                                 m
                               where q
                              
                                 i
                               is one of the following:
                                 
                                    •
                                    Secret key query 
                                          
                                             ID
                                          
                                       : challenger 
                                          C
                                        first runs algorithm Extract to obtain a secret key 
                                          s
                                          
                                             k
                                             ID
                                          
                                        for identity 
                                          ID
                                       . Then it returns 
                                          s
                                          
                                             k
                                             ID
                                          
                                        to 
                                          A
                                       .

Decryption query 
                                          
                                             
                                                C
                                                T
                                             
                                             ID
                                          
                                       : challenger 
                                          C
                                        first runs algorithm Extract to obtain a secret key 
                                          s
                                          
                                             k
                                             ID
                                          
                                        for identity 
                                          ID
                                       . Next, it runs 
                                          D
                                          e
                                          crypt
                                          
                                             
                                                param
                                                ,
                                                C
                                                T
                                                ,
                                                s
                                                
                                                   k
                                                   ID
                                                
                                             
                                          
                                        to obtain a plaintext m. Finally, m is returned to 
                                          A
                                       .

Challenge: adversary 
                                 A
                               submits a target identity 
                                 I
                                 
                                    D
                                    *
                                 
                               and two equal length messages m
                              0 and m
                              1. It is required that all the identities queried in Phase 1 have less than d overlap with the target identity 
                                 I
                                 
                                    D
                                    *
                                 
                              . Challenger 
                                 C
                               flips a fair coin b ϵ{0,1}, and encrypts m
                              
                                 b
                               under 
                                 I
                                 
                                    D
                                    *
                                 
                              . The ciphertext CT* is given to adversary 
                                 A
                              .

Phase 2: the same as in Phase 1 with the restrictions that: (i) 
                                 A
                               can not issue a secret key query for an identity 
                                 ID
                               such that 
                                 
                                    
                                       ID
                                       
                                          ∩
                                       
                                       I
                                       
                                          D
                                          *
                                       
                                    
                                 
                                 ≥
                                 d
                              ; (ii) 
                                 A
                               can not issue a decryption query for 
                                 
                                    
                                       C
                                       
                                          T
                                          *
                                       
                                       ,
                                       ID
                                    
                                 
                               such that 
                                 
                                    
                                       ID
                                       
                                          ∩
                                       
                                       I
                                       
                                          D
                                          *
                                       
                                    
                                 
                                 ≥
                                 d
                              .

Guess: finally, 
                                 A
                               outputs a guess b
                              'ϵ{0,1} and wins if b
                              '=
                              b.

We refer to such an adversary 
                        A
                      as an IND-ID-CCA2 adversary. We define 
                        A
                     's advantage in attacking scheme Π as
                        
                           
                              Ad
                              
                                 v
                                 
                                    ∏
                                    ,
                                    A
                                 
                                 
                                    I
                                    N
                                    D
                                    ‐
                                    ID
                                    ‐
                                    C
                                    C
                                    A
                                    2
                                 
                              
                              =
                              
                                 
                                    Pr
                                    
                                       
                                          b
                                          =
                                          b
                                          '
                                       
                                    
                                    −
                                    
                                       1
                                       2
                                    
                                 
                              
                              ,
                           
                        
                     where the probability is taken over the random coins consumed by the challenger and the adversary.

Sahai and Waters [13] defined a weak selective-ID model for FIBE systems, where the adversary must commit ahead of time the target identity. Such an adversary is termed as IND-FSID-CCA2 adversary.
                        Definition 3
                        We say that a CP-ABE scheme Π is (t,
                           q
                           
                              s
                           ,
                           q
                           
                              d
                           ,ϵ)-IND-ID-CCA2 (resp. IND-FSID-CCA2) secure if for any t-time IND-ID-CCA2 (resp. IND-FSID-CCA2) adversary 
                              A
                            who makes at most q
                           
                              s
                            secret key queries and at most q
                           
                              d
                            decryption queries, we have that 
                              Ad
                              
                                 v
                                 
                                    Π
                                    ,
                                    A
                                 
                                 
                                    I
                                    N
                                    D
                                    ‐
                                    ID
                                    ‐
                                    C
                                    C
                                    A
                                    2
                                 
                              
                              <
                              ϵ
                            (resp. 
                              Ad
                              
                                 v
                                 
                                    Π
                                    ,
                                    A
                                 
                                 
                                    I
                                    N
                                    D
                                    ‐
                                    FSID
                                    ‐
                                    C
                                    C
                                    A
                                    2
                                 
                              
                              <
                              ϵ
                           ).

The chosen-plaintext security for a FIBE system Π can be defined as the preceding game, except that adversary 
                        A
                      is disallowed to issue any decryption query. This security notion is termed as IND-ID-CPA (or IND-FSID-CPA in the case of a selective-ID adversary).
                        Definition 4
                        We say that a FIBE system Π is (t,
                           q
                           
                              s
                           ,ϵ)-IND-ID-CPA (resp. IND-FSID-CPA) secure if Π is (t,
                           q
                           
                              s
                           ,0,ϵ)-IND-ID-CCA2 (resp. IND-FSID-CCA2) secure.

Let 
                        G
                      and 
                        
                           G
                           T
                        
                      be two groups with prime order p of size κ, and let e be a bilinear map such that 
                        e
                        :
                        G
                        ×
                        G
                        →
                        
                           G
                           T
                        
                     . The proposed FIBE system consists of the following algorithms:
                        
                           Setup (κ,
                              d): the setup algorithm first randomly picks 
                                 β
                                 
                                    ←
                                    $
                                 
                                 
                                    ℤ
                                    p
                                    *
                                 
                               and 
                                 w
                                 ,
                                 
                                    w
                                    2
                                 
                                 ,
                                 
                                    h
                                    1
                                 
                                 ,
                                 
                                    h
                                    2
                                 
                                 
                                    ←
                                    $
                                 
                                 G
                              . Next, it sets w
                              1
                              =
                              w
                              
                                 β
                              . The public parameters and the master secret key are
                                 
                                    
                                       param
                                       =
                                       
                                          w
                                          
                                             w
                                             1
                                          
                                          
                                             w
                                             2
                                          
                                          
                                             h
                                             1
                                          
                                          
                                             h
                                             2
                                          
                                       
                                       ,
                                       
                                       m
                                       s
                                       k
                                       =
                                       β
                                       .
                                    
                                 
                              
                           

Extract 
                                 
                                    
                                       m
                                       s
                                       k
                                    
                                    ID
                                 
                              : to generate a secret key for identity 
                                 ID
                                 =
                                 
                                    
                                       μ
                                       1
                                    
                                    ⋯
                                    
                                       μ
                                       n
                                    
                                 
                                 ϵ
                                 
                                    
                                       
                                          ℤ
                                          p
                                          *
                                       
                                    
                                    n
                                 
                              , it first randomly generates a (d
                              −1)-degree polynomial q such that 
                                 q
                                 
                                    0
                                 
                                 =
                                 
                                    1
                                    β
                                 
                              . Next, choose r
                              
                                 i
                               for i
                              =1,⋯,
                              n. The secret key for 
                                 ID
                               is defined as
                                 
                                    (1)
                                    
                                       s
                                       
                                          k
                                          ID
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   D
                                                   i
                                                
                                                =
                                                
                                                   w
                                                   2
                                                   
                                                      q
                                                      
                                                         
                                                            μ
                                                            i
                                                         
                                                      
                                                   
                                                
                                                ⋅
                                                
                                                   
                                                      
                                                         
                                                            h
                                                            1
                                                         
                                                         
                                                            h
                                                            2
                                                            
                                                               μ
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      r
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   R
                                                   i
                                                
                                                =
                                                
                                                   w
                                                   1
                                                   
                                                      r
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             i
                                             ∈
                                             
                                                1
                                                ⋯
                                                n
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

Encrypt 
                                 
                                    
                                       m
                                       ,
                                       param
                                       ,
                                       ID
                                       '
                                    
                                 
                              : to encrypt a message 
                                 m
                                 ∈
                                 
                                    G
                                    T
                                 
                               under an identity 
                                 ID
                                 '
                                 =
                                 
                                    
                                       
                                          μ
                                          1
                                       
                                       ,
                                       ⋯
                                       ,
                                       μ
                                       
                                          '
                                          
                                             n
                                             '
                                          
                                       
                                    
                                 
                                 ∈
                                 
                                    
                                       
                                          ℤ
                                          p
                                          *
                                       
                                    
                                    
                                       n
                                       '
                                    
                                 
                              , it pick 
                                 s
                                 
                                    ←
                                    $
                                 
                                 
                                    ℤ
                                    p
                                    *
                                 
                               and define the ciphertext as
                                 
                                    
                                       C
                                       T
                                       =
                                       
                                          
                                             ID
                                             '
                                             ,
                                             C
                                             '
                                             =
                                             m
                                             ⋅
                                             e
                                             
                                                
                                                   w
                                                   
                                                      w
                                                      2
                                                   
                                                
                                                s
                                             
                                             ,
                                             C
                                             '
                                             '
                                             =
                                             
                                                w
                                                1
                                                s
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         C
                                                         i
                                                      
                                                      =
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                                  1
                                                               
                                                               
                                                                  h
                                                                  2
                                                                  
                                                                     μ
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                         s
                                                      
                                                   
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         1
                                                         ,
                                                         ⋯
                                                         ,
                                                         n
                                                         '
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

Decrypt 
                                 
                                    
                                       param
                                       ,
                                       s
                                       
                                          k
                                          ID
                                       
                                       ,
                                       C
                                       T
                                    
                                 
                              : suppose that a ciphertext CT is encrypted under identity 
                                 ID
                                 '
                               and we have a secret key 
                                 s
                                 
                                    k
                                    ID
                                 
                               for identity 
                                 ID
                               such that 
                                 
                                    
                                       ID
                                       
                                          ∩
                                       
                                       ID
                                       '
                                    
                                 
                                 ≥
                                 d
                              . This algorithm first parses the ciphertext as 
                                 C
                                 T
                                 =
                                 
                                    
                                       ID
                                       '
                                       ,
                                       C
                                       '
                                       ,
                                       C
                                       '
                                       '
                                       ,
                                       
                                          
                                             
                                                C
                                                i
                                             
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   1
                                                   ,
                                                   ⋯
                                                   ,
                                                   n
                                                   '
                                                
                                             
                                          
                                       
                                    
                                 
                               and the secret key as 
                                 s
                                 
                                    k
                                    ID
                                 
                                 =
                                 
                                    
                                       
                                          D
                                          i
                                       
                                       
                                          R
                                          i
                                       
                                    
                                    
                                       i
                                       ∈
                                       
                                          1
                                          ⋯
                                          n
                                       
                                    
                                 
                              . Next, it chooses an arbitrary set 
                                 S
                                 ⊆
                                 ID
                                 
                                    ∩
                                 
                                 ID
                                 '
                               such that |S|=
                              d. Finally, the ciphertext can be decrypted as
                                 
                                    
                                       m
                                       =
                                       
                                          
                                             C
                                             '
                                             ⋅
                                             
                                                
                                                   ∏
                                                   
                                                      i
                                                      ∈
                                                      S
                                                   
                                                
                                                
                                                   e
                                                   
                                                      
                                                         
                                                            C
                                                            i
                                                         
                                                         
                                                            R
                                                            i
                                                         
                                                      
                                                      
                                                         Δ
                                                         
                                                            
                                                               μ
                                                               
                                                                  
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                            S
                                                            
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             e
                                             
                                                
                                                   
                                                      
                                                         ∏
                                                         
                                                            i
                                                            ∈
                                                            S
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               D
                                                               i
                                                            
                                                            
                                                               Δ
                                                               
                                                                  
                                                                     μ
                                                                     
                                                                        
                                                                        i
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                  S
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   C
                                                   '
                                                   '
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

Indeed, for a valid ciphertext, we have
                        
                           
                              
                                 
                                    
                                       
                                          
                                             C
                                             '
                                             ⋅
                                             
                                                ∏
                                                
                                                   i
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                e
                                                
                                                   
                                                      
                                                         C
                                                         i
                                                      
                                                      
                                                         R
                                                         i
                                                      
                                                   
                                                   
                                                      Δ
                                                      
                                                         μ
                                                         i
                                                      
                                                      ,
                                                      s
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             e
                                             
                                                
                                                   
                                                      ∏
                                                      
                                                         i
                                                         ∈
                                                         S
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            D
                                                            i
                                                         
                                                         
                                                            Δ
                                                            
                                                               μ
                                                               i
                                                            
                                                            ,
                                                            s
                                                            
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   C
                                                   '
                                                   '
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             m
                                             ⋅
                                             e
                                             
                                                
                                                   w
                                                   
                                                      w
                                                      2
                                                   
                                                
                                                s
                                             
                                             ⋅
                                             
                                                ∏
                                                
                                                   i
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                e
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                                  1
                                                               
                                                               
                                                                  h
                                                                  2
                                                                  
                                                                     μ
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                         s
                                                      
                                                      
                                                         w
                                                         1
                                                         
                                                            r
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      Δ
                                                      
                                                         
                                                            μ
                                                            i
                                                         
                                                         ,
                                                         s
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             e
                                             
                                                
                                                   
                                                      ∏
                                                      
                                                         i
                                                         ∈
                                                         S
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                               2
                                                               
                                                                  q
                                                                  
                                                                     
                                                                        μ
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                            ⋅
                                                            
                                                               
                                                                  
                                                                     
                                                                        h
                                                                        1
                                                                     
                                                                     
                                                                        h
                                                                        2
                                                                        
                                                                           μ
                                                                           i
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  Δ
                                                                  
                                                                     
                                                                        μ
                                                                        i
                                                                     
                                                                     ,
                                                                     s
                                                                     
                                                                        0
                                                                     
                                                                  
                                                               
                                                            
                                                            ,
                                                            
                                                               w
                                                               1
                                                               s
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       =
                                       
                                          
                                             m
                                             ⋅
                                             e
                                             
                                                
                                                   w
                                                   
                                                      w
                                                      2
                                                   
                                                
                                                s
                                             
                                             ⋅
                                             e
                                             
                                                
                                                   
                                                      ∏
                                                      
                                                         i
                                                         ∈
                                                         S
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                                  1
                                                               
                                                               
                                                                  h
                                                                  2
                                                                  
                                                                     μ
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               r
                                                               i
                                                            
                                                            ⋅
                                                            
                                                               Δ
                                                               
                                                                  
                                                                     μ
                                                                     i
                                                                  
                                                                  ,
                                                                  s
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   
                                                      w
                                                      1
                                                      s
                                                   
                                                
                                             
                                          
                                          
                                             e
                                             
                                                
                                                   
                                                      ∏
                                                      
                                                         i
                                                         ∈
                                                         S
                                                      
                                                   
                                                   
                                                      
                                                         w
                                                         2
                                                         
                                                            q
                                                            
                                                               
                                                                  μ
                                                                  i
                                                               
                                                            
                                                            ⋅
                                                            
                                                               Δ
                                                               
                                                                  
                                                                     μ
                                                                     i
                                                                  
                                                                  ,
                                                                  s
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   
                                                      w
                                                      1
                                                      s
                                                   
                                                
                                             
                                             ⋅
                                             e
                                             
                                                
                                                   
                                                      ∏
                                                      
                                                         i
                                                         ∈
                                                         S
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                                  1
                                                               
                                                               
                                                                  h
                                                                  2
                                                                  
                                                                     μ
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               r
                                                               i
                                                            
                                                            ⋅
                                                            
                                                               Δ
                                                               
                                                                  
                                                                     μ
                                                                     i
                                                                  
                                                                  ,
                                                                  s
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   
                                                      w
                                                      1
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       =
                                       
                                          
                                             m
                                             ⋅
                                             e
                                             
                                                
                                                   w
                                                   
                                                      w
                                                      2
                                                   
                                                
                                                s
                                             
                                          
                                          
                                             e
                                             
                                                
                                                   w
                                                   2
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         
                                                            s
                                                            
                                                               q
                                                               
                                                                  
                                                                     μ
                                                                     i
                                                                  
                                                               
                                                               ⋅
                                                               
                                                                  Δ
                                                                  
                                                                     
                                                                        μ
                                                                        i
                                                                     
                                                                     ,
                                                                     s
                                                                     
                                                                        0
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      w
                                                      1
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       =
                                       
                                          
                                             m
                                             ⋅
                                             e
                                             
                                                
                                                   w
                                                   
                                                      w
                                                      2
                                                   
                                                
                                                s
                                             
                                          
                                          
                                             e
                                             
                                                
                                                   w
                                                   2
                                                   
                                                      q
                                                      
                                                         0
                                                      
                                                   
                                                
                                                
                                                   w
                                                   1
                                                   s
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       =
                                       
                                          
                                             m
                                             ⋅
                                             e
                                             
                                                
                                                   w
                                                   
                                                      w
                                                      2
                                                   
                                                
                                                s
                                             
                                          
                                          
                                             e
                                             
                                                
                                                   w
                                                   2
                                                   
                                                      1
                                                      β
                                                   
                                                
                                                
                                                   w
                                                   β
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       =
                                       m
                                       .
                                    
                                 
                              
                           
                        
                     
                  


                        
                           Theorem 1
                           Assume that the (t,ϵ) decisional 2-MBDHE assumption holds in 
                                 
                                    G
                                    
                                       G
                                       T
                                    
                                 
                              . Then the proposed FIBE scheme is (t
                              ',
                              q
                              
                                 s
                              ,ϵ')-IND-ID-CPA secure with
                                 
                                    
                                       t
                                       '
                                       ≤
                                       t
                                       +
                                       O
                                       
                                          
                                             
                                                q
                                                s
                                             
                                             ⋅
                                             
                                                i
                                                m
                                             
                                             ⋅
                                             
                                                t
                                                e
                                             
                                          
                                       
                                       ,
                                       
                                       ϵ
                                       '
                                       =
                                       ϵ
                                       ,
                                    
                                 
                              where q
                              
                                 s
                               denotes the number of secret key queries, i
                              
                                 m
                               is the maximal number of attribute in an identity queried in the secret key queries, and t
                              
                                 e
                               denotes the running time of an exponentiation in 
                                 G
                              .

Suppose there exists a (t
                              ',
                              q
                              
                                 s
                              ,ϵ') adversary 
                                 A
                               against the IND-ID-CPA security of our FIBE scheme. Using 
                                 A
                              , we can construct an algorithm 
                                 B
                               that solves the (t,ϵ) decisional 2-MBDHE assumption in 
                                 
                                    G
                                    
                                       G
                                       T
                                    
                                 
                              . Taking as input a random decisional 2-MBDHE challenge (g
                              ',
                              g
                              '
                              4,
                              g,
                              g
                              1,
                              g
                              2,
                              g
                              4,
                              g
                              5,
                              Z), Algorithm 
                                 B
                               works by interacting with 
                                 A
                               in the IND-ID-CPA game as below:
                                 
                                    Setup: to generate the public parameters for 
                                          A
                                       , using a trick similar to that in [6], algorithm 
                                          B
                                        works as follows:
                                          
                                             1.
                                             Pick 
                                                   δ
                                                   
                                                      ←
                                                      $
                                                   
                                                   
                                                      ℤ
                                                      p
                                                      *
                                                   
                                                . Again, we assume that δ
                                                ≠
                                                α. A random 2-degree polynomial F
                                                1(X)∈ℤ
                                                   p
                                                [X] is also generated.

Set w
                                                =
                                                g,
                                                w
                                                1
                                                =
                                                g
                                                1
                                                g
                                                −
                                                   δ
                                                
                                                =
                                                w
                                                
                                                   α
                                                   −
                                                   δ
                                                 and 
                                                   
                                                      w
                                                      2
                                                   
                                                   =
                                                   
                                                      g
                                                      
                                                         
                                                            F
                                                            1
                                                         
                                                         
                                                            α
                                                         
                                                      
                                                   
                                                   
                                                      g
                                                      
                                                         ‐
                                                         
                                                            F
                                                            1
                                                         
                                                         
                                                            δ
                                                         
                                                      
                                                   
                                                .

Pick 
                                                   
                                                      v
                                                      1
                                                   
                                                   ,
                                                   
                                                      v
                                                      2
                                                   
                                                   
                                                      ←
                                                      $
                                                   
                                                   
                                                      ℤ
                                                      p
                                                      *
                                                   
                                                , and set 
                                                   
                                                      h
                                                      1
                                                   
                                                   =
                                                   
                                                      w
                                                      1
                                                      
                                                         v
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      h
                                                      2
                                                   
                                                   =
                                                   
                                                      w
                                                      1
                                                      
                                                         v
                                                         2
                                                      
                                                   
                                                . The public parameters param
                                                =(w,
                                                w
                                                1,
                                                w
                                                2,
                                                h
                                                1,
                                                h
                                                2) are sent to 
                                                   A
                                                .

Observe that these public parameters are well-formed and have identical distributions as those in the real construction.

Phase 1: in this phase, 
                                          A
                                        issues a series of secret key queries. Upon receiving a secret key query on an identity 
                                          ID
                                          =
                                          
                                             
                                                μ
                                                1
                                             
                                             ⋯
                                             
                                                μ
                                                n
                                             
                                          
                                          ∈
                                          
                                             
                                                
                                                   ℤ
                                                   p
                                                   *
                                                
                                             
                                             n
                                          
                                       , 
                                          B
                                        constructs a secret key for 
                                          T
                                        as follows.
                                          
                                             1.
                                             Construct a random (d
                                                −1)-degree polynomial q such that 
                                                   q
                                                   
                                                      0
                                                   
                                                   =
                                                   
                                                      1
                                                      β
                                                   
                                                 as follows: Pick 
                                                   
                                                      a
                                                      i
                                                   
                                                   
                                                      ←
                                                      $
                                                   
                                                   
                                                      ℤ
                                                      p
                                                   
                                                 for i
                                                =1,⋯,
                                                d
                                                ‐1 such that a
                                                
                                                   d
                                                   ‐1
                                                ≠0. Now, the polynomial q is implicitly set to be 
                                                   q
                                                   
                                                      X
                                                   
                                                   =
                                                   
                                                      1
                                                      β
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         
                                                            d
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            α
                                                            j
                                                         
                                                         ⋅
                                                         
                                                            X
                                                            i
                                                         
                                                      
                                                   
                                                   .
                                                 Note that 
                                                   
                                                      1
                                                      β
                                                   
                                                 is unknown to 
                                                   B
                                                .

Let F
                                                2(X) denote the 1-degree polynomial 
                                                   
                                                      
                                                         
                                                            F
                                                            1
                                                         
                                                         
                                                            X
                                                         
                                                         −
                                                         
                                                            F
                                                            1
                                                         
                                                         
                                                            δ
                                                         
                                                      
                                                      
                                                         X
                                                         −
                                                         δ
                                                      
                                                   
                                                . For each i
                                                ∈{1,⋯,
                                                n}, pick 
                                                   
                                                      r
                                                      i
                                                   
                                                   
                                                      ←
                                                      $
                                                   
                                                   
                                                      ℤ
                                                      p
                                                      *
                                                   
                                                 and define the corresponding secret key component to be
                                                   
                                                      
                                                         
                                                            D
                                                            i
                                                         
                                                         =
                                                         
                                                            g
                                                            
                                                               
                                                                  F
                                                                  2
                                                               
                                                               
                                                                  α
                                                               
                                                            
                                                         
                                                         ⋅
                                                         
                                                            w
                                                            2
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     j
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     d
                                                                     ‐
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     a
                                                                     j
                                                                  
                                                                  ⋅
                                                                  
                                                                     μ
                                                                     i
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                         ⋅
                                                         
                                                            
                                                               
                                                                  
                                                                     h
                                                                     1
                                                                  
                                                                  
                                                                     h
                                                                     2
                                                                     
                                                                        μ
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               r
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            R
                                                            i
                                                         
                                                         =
                                                         
                                                            w
                                                            1
                                                            
                                                               r
                                                               i
                                                            
                                                         
                                                         .
                                                      
                                                   
                                                
                                             

Return the secret key 
                                                   s
                                                   
                                                      k
                                                      ID
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            D
                                                            i
                                                         
                                                         
                                                            R
                                                            i
                                                         
                                                      
                                                      
                                                         i
                                                         ∈
                                                         
                                                            1
                                                            ⋯
                                                            n
                                                         
                                                      
                                                   
                                                 to 
                                                   A
                                                .

Observe that 
                                          s
                                          
                                             k
                                             ID
                                          
                                        is indeed a valid secret key for identity 
                                          ID
                                       , since 
                                          q
                                          
                                             0
                                          
                                          =
                                          
                                             1
                                             β
                                          
                                        and for each i
                                       ∈{1,⋯,
                                       n},
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            D
                                                            i
                                                         
                                                         =
                                                         
                                                            g
                                                            
                                                               
                                                                  F
                                                                  2
                                                               
                                                               
                                                                  α
                                                               
                                                            
                                                         
                                                         ⋅
                                                         
                                                            w
                                                            2
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     j
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     d
                                                                     ‐
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     a
                                                                     j
                                                                  
                                                                  ⋅
                                                                  
                                                                     μ
                                                                     i
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                         ⋅
                                                         
                                                            
                                                               
                                                                  
                                                                     h
                                                                     1
                                                                  
                                                                  
                                                                     h
                                                                     2
                                                                     
                                                                        μ
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               r
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                         =
                                                         
                                                            g
                                                            
                                                               
                                                                  
                                                                     F
                                                                     1
                                                                  
                                                                  
                                                                     α
                                                                  
                                                                  −
                                                                  
                                                                     F
                                                                     1
                                                                  
                                                                  
                                                                     δ
                                                                  
                                                               
                                                               
                                                                  α
                                                                  −
                                                                  β
                                                               
                                                            
                                                         
                                                         ⋅
                                                         
                                                            w
                                                            2
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     j
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     d
                                                                     ‐
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     a
                                                                     j
                                                                  
                                                                  ⋅
                                                                  
                                                                     μ
                                                                     i
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                         ⋅
                                                         
                                                            
                                                               
                                                                  
                                                                     h
                                                                     1
                                                                  
                                                                  
                                                                     h
                                                                     2
                                                                     
                                                                        μ
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               r
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                         =
                                                         
                                                            w
                                                            2
                                                            
                                                               1
                                                               
                                                                  α
                                                                  −
                                                                  δ
                                                               
                                                            
                                                         
                                                         ⋅
                                                         
                                                            w
                                                            2
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     j
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     d
                                                                     ‐
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     a
                                                                     j
                                                                  
                                                                  ⋅
                                                                  
                                                                     μ
                                                                     i
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                         ⋅
                                                         
                                                            
                                                               
                                                                  
                                                                     h
                                                                     1
                                                                  
                                                                  
                                                                     h
                                                                     2
                                                                     
                                                                        μ
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               r
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                         =
                                                         
                                                            w
                                                            2
                                                            
                                                               
                                                                  1
                                                                  β
                                                               
                                                               +
                                                               
                                                                  
                                                                     ∑
                                                                     
                                                                        j
                                                                        =
                                                                        1
                                                                     
                                                                     
                                                                        d
                                                                        ‐
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        a
                                                                        j
                                                                     
                                                                     ⋅
                                                                     
                                                                        μ
                                                                        i
                                                                        j
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         ⋅
                                                         
                                                            
                                                               
                                                                  
                                                                     h
                                                                     1
                                                                  
                                                                  
                                                                     h
                                                                     2
                                                                     
                                                                        μ
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               r
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                         =
                                                         
                                                            w
                                                            2
                                                            
                                                               q
                                                               
                                                                  
                                                                     μ
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                         ⋅
                                                         
                                                            
                                                               
                                                                  
                                                                     h
                                                                     1
                                                                  
                                                                  
                                                                     h
                                                                     2
                                                                     
                                                                        μ
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               r
                                                               i
                                                            
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

Challenge: when 
                                          A
                                        decides that Phase 1 is over, it outputs a target identity 
                                          I
                                          
                                             D
                                             *
                                          
                                          =
                                          
                                             
                                                μ
                                                1
                                                *
                                             
                                             ⋯
                                             
                                                μ
                                                n
                                                *
                                             
                                          
                                        and two equal-length messages 
                                          
                                             m
                                             0
                                          
                                          ,
                                          
                                             m
                                             1
                                          
                                          ∈
                                          
                                             G
                                             T
                                          
                                       . Let F
                                       3(X)=
                                       X
                                       4 and let 
                                          
                                             F
                                             4
                                          
                                          
                                             X
                                          
                                          =
                                          
                                             
                                                
                                                   F
                                                   3
                                                
                                                
                                                   X
                                                
                                                −
                                                
                                                   F
                                                   3
                                                
                                                
                                                   δ
                                                
                                             
                                             
                                                X
                                                −
                                                δ
                                             
                                          
                                       , which is a polynomial of degree 3. Let F
                                       5(X)=(F
                                       1(X)−
                                       F
                                       1(δ))⋅
                                       F
                                       4(X), and express F
                                       5(X) as F
                                       5(X)=∑
                                          i
                                          =0
                                       5
                                       F
                                       
                                          5,i
                                       
                                       X
                                       
                                          i
                                       . Algorithm 
                                          B
                                        picks 
                                          b
                                          
                                             ←
                                             $
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                        and defines the challenge ciphertext as
                                          
                                             
                                                C
                                                
                                                   T
                                                   *
                                                
                                                =
                                                
                                                   
                                                      I
                                                      
                                                         D
                                                         *
                                                      
                                                      ,
                                                      C
                                                      
                                                         '
                                                         *
                                                      
                                                      =
                                                      
                                                         m
                                                         b
                                                      
                                                      ⋅
                                                      
                                                         Z
                                                         
                                                            F
                                                            
                                                               5
                                                               ,
                                                               3
                                                            
                                                         
                                                      
                                                      ⋅
                                                      e
                                                      
                                                         
                                                            g
                                                            '
                                                            ,
                                                            
                                                               
                                                                  ∏
                                                                  
                                                                     
                                                                        
                                                                           i
                                                                           =
                                                                           0
                                                                        
                                                                        
                                                                           i
                                                                           ≠
                                                                           3
                                                                        
                                                                     
                                                                  
                                                                  5
                                                               
                                                               
                                                                  
                                                                     g
                                                                     i
                                                                     
                                                                        F
                                                                        
                                                                           5
                                                                           ,
                                                                           i
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      C
                                                      
                                                         
                                                            '
                                                            '
                                                         
                                                         *
                                                      
                                                      =
                                                      g
                                                      
                                                         '
                                                         
                                                            
                                                               F
                                                               3
                                                            
                                                            
                                                               α
                                                            
                                                            −
                                                            
                                                               F
                                                               3
                                                            
                                                            
                                                               δ
                                                            
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  C
                                                                  i
                                                                  *
                                                               
                                                               =
                                                               
                                                                  
                                                                     
                                                                        C
                                                                        
                                                                           "
                                                                           *
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        v
                                                                        1
                                                                     
                                                                     +
                                                                     
                                                                        μ
                                                                        i
                                                                        *
                                                                     
                                                                     ⋅
                                                                     
                                                                        v
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       which is returned to 
                                          A
                                       .

Phase 2: 
                                          A
                                        issues a series of secret key queries, and 
                                          B
                                        responds as in Phase 1.

Guess: finally, adversary 
                                          A
                                        returns a guess b
                                       '∈{0,1} to 
                                          B
                                       . If b
                                       =
                                       b
                                       ', then 
                                          B
                                        outputs 1 indicating Z
                                       =
                                       e(g
                                       3,
                                       g
                                       '). Otherwise, it outputs 0 indicating Z is a random element in 
                                          
                                             G
                                             T
                                          
                                       .

Analysis: From the description of the simulation, we can see that the public parameters are well-formed and have an indistinguishable distribution as in the real environment. The responses to 
                                          A
                                       's secret key queries are also perfect. Moreover, if Z
                                       =
                                       e(g
                                       3,
                                       g
                                       '), then CT* is a valid ciphertext for m
                                       
                                          b
                                        under the challenge access structure 
                                          
                                             A
                                             *
                                          
                                       . To see this, let s
                                       =(log
                                          g
                                       
                                       g
                                       ')⋅
                                       F
                                       4(α), we have
                                          
                                             
                                                C
                                                
                                                   '
                                                   *
                                                
                                                =
                                                
                                                   m
                                                   b
                                                
                                                ⋅
                                                e
                                                
                                                   
                                                      w
                                                      
                                                         w
                                                         2
                                                      
                                                   
                                                   s
                                                
                                                ,
                                                C
                                                
                                                   
                                                      '
                                                      '
                                                   
                                                   *
                                                
                                                =
                                                
                                                   w
                                                   1
                                                   s
                                                
                                                ,
                                             
                                          
                                       and
                                          
                                             
                                                
                                                   C
                                                   i
                                                   *
                                                
                                                =
                                                
                                                   
                                                      
                                                         C
                                                         
                                                            
                                                               '
                                                               '
                                                            
                                                            *
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                         1
                                                      
                                                      +
                                                      
                                                         μ
                                                         i
                                                         *
                                                      
                                                      ⋅
                                                      
                                                         v
                                                         2
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         w
                                                         1
                                                         s
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                         1
                                                      
                                                      +
                                                      
                                                         μ
                                                         i
                                                         *
                                                      
                                                      ⋅
                                                      
                                                         v
                                                         2
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         w
                                                         1
                                                         
                                                            
                                                               v
                                                               1
                                                            
                                                            +
                                                            
                                                               μ
                                                               i
                                                               *
                                                            
                                                            ⋅
                                                            
                                                               v
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   s
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            h
                                                            1
                                                         
                                                         
                                                            h
                                                            2
                                                            
                                                               μ
                                                               i
                                                               *
                                                            
                                                         
                                                      
                                                   
                                                   s
                                                
                                                ,
                                                ∀
                                                i
                                                ∈
                                                
                                                   1
                                                   ⋯
                                                   n
                                                
                                                .
                                             
                                          
                                       
                                    

So, when Z
                        =
                        e(g
                        3,
                        g
                        '), the simulation provided for 
                           A
                         is indistinguishable from the real environment. Hence we see that
                           
                              
                                 Pr
                                 
                                    
                                       B
                                       
                                          
                                             g
                                             '
                                             ,
                                             g
                                             
                                                '
                                                4
                                             
                                             ,
                                             g
                                             ,
                                             
                                                g
                                                1
                                             
                                             ,
                                             
                                                g
                                                2
                                             
                                             ,
                                             
                                                g
                                                4
                                             
                                             ,
                                             
                                                g
                                                5
                                             
                                             ,
                                             e
                                             
                                                
                                                   
                                                      g
                                                      3
                                                   
                                                   ,
                                                   g
                                                   '
                                                
                                             
                                          
                                       
                                       =
                                       1
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 +
                                 ϵ
                                 .
                              
                           
                        
                     

On the other hand, when Z is uniform and independent in 
                           
                              G
                              T
                           
                        , the challenge ciphertext C* is independent of b in the adversary's view. Thus we have
                           
                              
                                 Pr
                                 
                                    
                                       B
                                       
                                          
                                             g
                                             '
                                             ,
                                             g
                                             
                                                '
                                                4
                                             
                                             ,
                                             g
                                             ,
                                             
                                                g
                                                1
                                             
                                             ,
                                             
                                                g
                                                2
                                             
                                             ,
                                             
                                                g
                                                4
                                             
                                             ,
                                             
                                                g
                                                5
                                             
                                             ,
                                             Z
                                          
                                       
                                       =
                                       1
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 .
                              
                           
                        
                     

Therefore, algorithm 
                           B
                         has an advantage ϵ'=ϵ in solving the decisional 2-MBDHE challenge.

In the simulation, the time complexity of 
                           B
                         is dominated by the exponentiations in the secret key queries. Since there are at most 
                           O
                           
                              
                                 i
                                 m
                              
                           
                         exponentiations in each query, we know that 
                           B
                        's time complexity is 
                           t
                           '
                           ≤
                           t
                           +
                           O
                           
                              
                                 
                                    q
                                    s
                                 
                                 ⋅
                                 
                                    i
                                    m
                                 
                                 ⋅
                                 
                                    t
                                    e
                                 
                              
                           
                        . This concludes the proof of this theorem.

In this subsection, we compare our FIBE scheme with previous FIBE schemes including SW scheme [13] and BSZ Scheme [14]. Since Ren et al.'s scheme [20] has been found insecure, we do not consider their scheme here. Detailed comparisons are given in Table 1
                        , in which “W.R.O.” means without random oracles and “T.S.R.” means tight security reduction. The comparison results indicate that our scheme outperforms other schemes.

The security proof of our FIBE system is given in the chosen-plaintext model. Similar to Goyal et al.'s attribute-based encryption scheme [26], our construction can be extended to the chosen-ciphertext model by applying Sahai's technique [27], which uses the simulation-sound NIZE proofs to achieve chosen-ciphertext security. Furthermore, the delegation mechanism in our scheme can be used with the techniques in [17,28,29] to achieve a more efficient CCA2 secure system.

@&#CONCLUSIONS@&#

With the rapid development of IoT, many security problems had emerged, and how to securely transmit data in IoT is one of these important problems. To deal with these problem, we presented a new fuzzy identity-based encryption (FIBE) scheme, and proved the semantically security of the proposed scheme under the 2-MBDHE assumption. Compared with existing FIBE scheme, our proposed scheme has a number of advantages: (i) it is semantic secure in the full model; (ii) its security is tight, and it does not rely on the random oracle model; (iii) it has short public parameters, and hence is quite efficient. Thus compared with previous FIBE schemes, our scheme is more suitable for the secure communications in IoT.

@&#ACKNOWLEDGMENTS@&#

The authors thank very much the anonymous reviewers for their very helpful comments to improve this paper. This work was supported by National Science Foundation of China under Grant nos. 61373158, 61133014, and 61472091, Program for New Century Excellent Talents in University (Grant no. NCET-12-0680), Research Fund for the Doctoral Program of Higher Education of China (Grant no. 20134401110011), and the Fundamental Research Funds for the Central Universities (Grant no. 11613106).

@&#REFERENCES@&#

