@&#MAIN-TITLE@&#Topology optimization with mixed finite elements on regular grids

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A topology optimization problem is formulated in terms of stresses only.


                        
                        
                           
                           An efficient mixed finite element is used to provide robustness and accuracy on regular grids.


                        
                        
                           
                           Stress-constrained optimization is dealt with also in case of incompressible media.


                        
                        
                           
                           Stress-constrained optimal layouts take advantage of the accuracy of the adopted fem.


                        
                        
                           
                           Peculiar optimal layouts are found in case of incompressible material and plane strain.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Topology optimization

Mixed finite elements

Complementary energy

Incompressible materials

Stress constraints

@&#ABSTRACT@&#


               
               
                  Recently, new families of mixed finite elements have been proposed to address the analysis of linear elastic bodies on regular grids adopting a limited number of degrees of freedom per element. A two-dimensional mixed discretization is implemented to formulate an alternative topology optimization problem where stresses play the role of main variables and both compressible and incompressible materials can be dealt with. The structural compliance is computed through the evaluation of the complementary energy, whereas the enforcement of stress constraints is straightforward. Numerical simulations investigate the features of the proposed approach: comparisons with a conventional displacement-based scheme are provided for compressible materials; stress-constrained solutions for structures made of incompressible media are introduced.
               
            

@&#INTRODUCTION@&#

Stress-constrained topology optimization is an effective tool to investigate layouts that are fully feasible with respect to the strength of the material or any prescribed requirement involving the stress field, see e.g.  [1–3]. When addressing a discrete problem of stress-constrained optimal design, a crucial issue is the choice of a finite element discretization providing robustness and accuracy in the evaluation of the stress field while preserving a reasonable computational cost of the analysis. Most of the numerical methods presented in the literature consist of approaches that resort to displacement-based finite elements, see e.g.  [4–8]. When displacements are main variables of the formulation the stress field is computed through post-processing techniques and is not among the direct variables of the problem. Due to the well-known locking phenomenon, these methods cannot be adopted to address structures made of incompressible material.

Stable mixed finite elements have been alternatively used to overcome the locking phenomenon when coping with the energy-based design of structures made of incompressible material, see e.g.  [9–11], or with optimization procedures dealing with “fluid phases”, see e.g.  [12–15]. Mixed finite elements can also be used to improve the accuracy in the evaluation of the stress field, depending on the shape function embedded in the element  [16]. A mixed approach includes stresses among the direct variables of the elasticity problem and allows enforcing strength constraints and compute the relevant sensitivity with no need for any post-processing handling. This has been firstly implemented in the work  [17] for a finite element discretization adopting displacements as main variables and restricting to compressible materials.

It must be remarked that it is not trivial to solve the elasticity problem adopting stresses as main variables, i.e. formulating a so-called “truly-mixed” finite element problem  [18]. In this version, the Hellinger–Reissner variational principle calls for regular stresses whereas displacements can be even discontinuous. A limited number of finite elements are able to fulfil the well-known Babuška–Brezzi condition. Classical robust discrete schemes are based on the adoption of ad hoc composite finite elements  [19] or embed the enforcement of the symmetry of the stress tensor in weak form, see among the others  [20]. In general, both kinds of solutions involve the handling of a relevant number of degrees of freedom per element, thus calling for a non-negligible computational cost for the analysis and, hence, high CPU time to accomplish any optimization procedure  [21]. For this reason, applications of this kind of elements in topology optimization are limited to energy-based problems that neglect any requirement on the material strength, see e.g.  [9,13].

Recently, a new family of two- and three-dimensional “truly-mixed” finite elements has been proposed that is especially conceived for computations on regular grids  [22]. Adopting discretizations of square or cubic finite elements, the symmetry of the stress tensor and the regularity requested to its approximation as main variable of the problem can be both achieved in an efficient way. The number of degrees of freedom per element significantly decreases with respect to conventional “truly-mixed” discretizations, whereas good convergence rates and full stability for incompressible materials are preserved. These features can be conveniently exploited in topology optimization to investigate the adoption of alternative finite element approximations in stress-constrained design for compressible materials, whereas addressing the optimal design of structures made of incompressible materials with prescribed strength.

This contribution implements the lowest order two-dimensional “truly-mixed” finite element of this new family to formulate an alternative problem of topology optimization that is written only in terms of the main variables of the “truly-mixed” elasticity problem, i.e. stresses. As investigated in  [23], the formulation adopts the weight of the structure as objective function, including an energy-based constraint to control deformability and a selected set of constraints to control undesired stress peaks, if needed. Instead of using the displacement-based strain energy to evaluate the structural compliance, the stress-based complementary energy is herein considered.

Numerical investigations are shown to assess the features of the proposed stress-based framework, providing comparisons with a conventional displacement-based scheme for compressible materials. Stress-constrained optimization for structures made of incompressible media is discussed as well.

The paper outline is as follows. Section  2 introduces the Hellinger–Reissner variational principle, along with the efficient quadrangular mixed finite element exploited in the simulations for plane problems. Section  3 reports fundamentals of the topology optimization problem based on the classical SIMP model  [24] (that is herein written for the compliance tensor instead of the stiffness one) and addresses the computation of structural compliance and stress constraints within the adopted stress-based discrete scheme. The formulation for minimum weight with compliance and stress constraints is presented, addressing some related numerical issues such as the constraints enforcement strategy and the mathematical relaxation against the arising of the well-known singularity problem, see Section  4. Section  5 is devoted to numerical simulations. At first a preliminary numerical investigation is performed to compare convergence features of the adopted mixed finite element with respect to the conventional four-node elements resorting to a bi-linear approximation of the displacement field. Then the formulation introduced in Section  3 is tested on problems of optimal design involving both compressible and incompressible materials. Section  6 concludes the paper, formulating remarks on the presented investigations and the introduced stress-driven framework.

This section provides fundamentals of the Hellinger–Reissner variational principle declined in its “truly-mixed” version, which is the variational formulation implementing stresses as main variables of the problem whereas displacements play the role of Lagrangian multipliers, see  [18].

A homogeneous domain 
                           Ω
                           ∈
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         with a regular boundary 
                           ∂
                           Ω
                         is considered, assuming that 
                           ∂
                           Ω
                           =
                           
                              
                                 Γ
                              
                              
                                 d
                              
                           
                           ∪
                           
                              
                                 Γ
                              
                              
                                 t
                              
                           
                        . Prescribed displacements with components 
                           
                              
                                 
                                    
                                       u
                                    
                                    ¯
                                 
                              
                              
                                 j
                              
                           
                         and tractions with components 
                           
                              
                                 
                                    
                                       f
                                    
                                    ¯
                                 
                              
                              
                                 j
                              
                           
                         are assigned on 
                           
                              
                                 Γ
                              
                              
                                 d
                              
                           
                         and 
                           
                              
                                 Γ
                              
                              
                                 t
                              
                           
                        , respectively. Let 
                           
                              
                                 
                                    
                                       σ
                                    
                                    ¯
                                 
                              
                              ¯
                           
                         be the unknown stress field and 
                           
                              
                                 u
                              
                              ¯
                           
                         the unknown displacement field, whereas 
                           
                              
                                 
                                    
                                       g
                                    
                                    ¯
                                 
                              
                              
                                 j
                              
                           
                         are the components of the square integrable vector of body loads. 
                           
                              
                                 S
                              
                              
                                 i
                                 j
                                 h
                                 k
                              
                           
                         is the fourth order compliance tensor of the linear elastic isotropic material, i.e. the linear map of the constitutive law in its inverse form that transforms stresses in strains according to 
                           
                              
                                 ε
                              
                              
                                 i
                                 j
                              
                           
                           =
                           
                              
                                 S
                              
                              
                                 i
                                 j
                                 h
                                 k
                              
                           
                           
                              
                                 σ
                              
                              
                                 h
                                 k
                              
                           
                         with 
                           
                              
                                 ε
                              
                              
                                 i
                                 j
                              
                           
                           =
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              +
                              
                                 
                                    u
                                 
                                 
                                    j
                                    ,
                                    i
                                 
                              
                              )
                           
                           /
                           2
                        . Hence, the “truly-mixed” weak formulation may be written as: find 
                           
                              (
                              
                                 
                                    
                                       
                                          σ
                                       
                                       ¯
                                    
                                 
                                 ¯
                              
                              ,
                              
                                 
                                    u
                                 
                                 ¯
                              
                              )
                           
                           ∈
                           H
                           ×
                           W
                         such that 
                           
                              
                                 σ
                              
                              
                                 i
                                 j
                              
                           
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                           
                              
                                 ∣
                              
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       f
                                    
                                    ¯
                                 
                              
                              
                                 j
                              
                           
                         and 
                           
                              (1)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   ∫
                                                
                                                
                                                   Ω
                                                
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   i
                                                   j
                                                   h
                                                   k
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   h
                                                   k
                                                
                                             
                                             
                                             
                                                
                                                   τ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                             d
                                             x
                                             +
                                             
                                                
                                                   ∫
                                                
                                                
                                                   Ω
                                                
                                             
                                             
                                                
                                                   τ
                                                
                                                
                                                   i
                                                   j
                                                   ,
                                                   i
                                                
                                             
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   j
                                                
                                             
                                             
                                             d
                                             x
                                             =
                                             
                                                
                                                   ∫
                                                
                                                
                                                   
                                                      
                                                         Γ
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      ¯
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             
                                             
                                                
                                                   τ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                
                                             
                                             
                                             d
                                             s
                                             ,
                                          
                                          
                                             ∀
                                             
                                                
                                                   
                                                      
                                                         τ
                                                      
                                                      ¯
                                                   
                                                
                                                ¯
                                             
                                             ∈
                                             H
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∫
                                                
                                                
                                                   Ω
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   i
                                                   j
                                                   ,
                                                   i
                                                
                                             
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   j
                                                
                                             
                                             
                                             d
                                             x
                                             =
                                             −
                                             
                                                
                                                   ∫
                                                
                                                
                                                   Ω
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         g
                                                      
                                                      ¯
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   j
                                                
                                             
                                             
                                             d
                                             x
                                             ,
                                          
                                          
                                             ∀
                                             
                                                
                                                   v
                                                
                                                ¯
                                             
                                             ∈
                                             W
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 n
                              
                              
                                 j
                              
                           
                         stand for the components of the normal vector to 
                           ∂
                           Ω
                        .

Eq. (1)
                        1 is found testing the compatibility equation and the constitutive law, in its inverse form, with the virtual stress field 
                           
                              
                                 
                                    
                                       τ
                                    
                                    ¯
                                 
                              
                              ¯
                           
                        . Due to the subsequent application of the Gauss–Green formula, the divergence of the stress field arises along with the line integral at the right hand side. The equilibrium equation, tested through the virtual displacement field 
                           
                              
                                 v
                              
                              ¯
                           
                        , gives rise to Eq. (1)
                        2.

The functional spaces 
                           H
                         and 
                           W
                         may be straightforwardly derived requiring that the integrals involved in the equations make sense. The stress field 
                           
                              
                                 
                                    
                                       σ
                                    
                                    ¯
                                 
                              
                              ¯
                           
                         is the main variable of the formulation and is sought in the regular space: 
                           
                              (2)
                              
                                 H
                                 =
                                 H
                                 
                                    (
                                    d
                                    i
                                    v
                                    ;
                                    Ω
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             ¯
                                          
                                       
                                       ¯
                                    
                                    :
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          j
                                          i
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    ∈
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       Ω
                                       )
                                    
                                    ,
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                          j
                                          ,
                                          i
                                       
                                    
                                    ∈
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       Ω
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                         Displacements can be even discontinuous, because the only requirement needed in the definition of the above functionals is their square-integrability that reads: 
                           
                              (3)
                              
                                 W
                                 =
                                 
                                    {
                                    
                                       
                                          u
                                       
                                       ¯
                                    
                                    :
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    ∈
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       Ω
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                         It is worth remarking that the traction boundary condition is imposed a priori on the space of the stress tensor, whereas the displacement boundary condition arises from the variational principle, i.e. it shows up at the right hand side of Eq. (1)
                        1. In fact, stresses are main variables of the “truly-mixed” problem and the enforcement of boundary conditions is dual with respect to the conventional displacement-based framework, as detailed below.

The finite element discretization of the “truly-mixed” variational formulation introduced in the previous section is addressed. A strict robustness requirement, i.e. the so-called inf–sup or Babuška–Brezzi (BB) condition, governs the achievement of any affordable discrete scheme, see  [18]. The very few discretizations that are stable both for compressible and incompressible media need much more degrees of freedom than conventional displacement-based finite elements. A new family of elements has been recently proposed in  [22] to exploit regularity of the grid of any space dimension and achieve robust discretizations in an efficient way. The lowest order element is herein implemented to cope with two-dimensional problems.

The adopted element interpolates each cartesian component 
                           
                              
                                 u
                              
                              
                                 j
                              
                           
                         of the globally discontinuous displacement field through functions in 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           ≔
                           s
                           p
                           a
                           n
                           
                              {
                              1
                              ,
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              }
                           
                        , meaning that four degrees of freedom are needed to represent the two-dimensional field approximated through linear polynomials (see dofs marked with triangles in Fig. 1
                        ). Referring to the displacement field, the finite element space on the element 
                           K
                         belonging to the rectangular grid 
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                         therefore reads: 
                           
                              (4)
                              
                                 V
                                 
                                    (
                                    K
                                    )
                                 
                                 =
                                 s
                                 p
                                 a
                                 n
                                 
                                    (
                                    
                                       
                                          
                                             
                                                {
                                                1
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                             
                                                {
                                                1
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                }
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         and the relevant degrees of freedom are: 
                           
                              (5)
                              
                                 
                                    
                                       1
                                    
                                    
                                       
                                          |
                                          K
                                          |
                                       
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       K
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 v
                                 
                                 d
                                 x
                                 ,
                                 
                                 for all
                                 
                                 v
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 
                                 and
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 .
                              
                           
                        
                     

Concerning the interpolation of the stress field, different approximations are used for the normal and tangential component of the tensor, respectively 
                           
                              
                                 σ
                              
                              
                                 i
                                 i
                              
                           
                         and 
                           
                              
                                 σ
                              
                              
                                 i
                                 j
                              
                           
                        . The former is addressed through functions belonging to 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           ≔
                           s
                           p
                           a
                           n
                           
                              {
                              1
                              ,
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              }
                           
                        , whereas the latter is sought in 
                           
                              
                                 Q
                              
                              
                                 1
                              
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           ≔
                           s
                           p
                           a
                           n
                           
                              {
                              1
                              ,
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              }
                           
                        . In fact, due to the requirement on space 
                           H
                           =
                           H
                           
                              (
                              d
                              i
                              v
                              ;
                              Ω
                              )
                           
                        , 
                           
                              
                                 σ
                              
                              
                                 i
                                 i
                              
                           
                         must be continuous along 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        , whereas 
                           
                              
                                 σ
                              
                              
                                 i
                                 j
                              
                           
                         must be continuous along both 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 x
                              
                              
                                 j
                              
                           
                        . The derivative on a normal stress component 
                           
                              
                                 σ
                              
                              
                                 i
                                 i
                              
                           
                         is only in 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                         direction, while those on 
                           
                              
                                 σ
                              
                              
                                 i
                                 j
                              
                           
                         are in 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 x
                              
                              
                                 j
                              
                           
                         directions. This fact motivates the use of quadratic polynomials 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         for the normal stress component and of bilinear polynomials 
                           
                              
                                 Q
                              
                              
                                 1
                              
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         for the shear stress component. Ten degrees of freedom are needed to represent the stress field (see dofs marked with circles in Fig. 1). Referring to the stress field, the finite element space on the element 
                           K
                         belonging to the rectangular grid 
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                         therefore reads: 
                           
                              (6)
                              
                                 Σ
                                 
                                    (
                                    K
                                    )
                                 
                                 =
                                 s
                                 p
                                 a
                                 n
                                 
                                    (
                                    
                                       
                                          
                                             
                                                {
                                                1
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                }
                                             
                                          
                                          
                                             
                                                {
                                                1
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                             
                                                {
                                                1
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                }
                                             
                                          
                                          
                                             
                                                {
                                                1
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                                }
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         The relevant degrees of freedom for the normal stress components read: 
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   |
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         K
                                                      
                                                   
                                                   |
                                                
                                             
                                          
                                          
                                             
                                                ∫
                                             
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      K
                                                   
                                                
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                i
                                                i
                                             
                                          
                                          
                                          d
                                          s
                                          ,
                                          
                                          for all
                                          
                                          
                                             
                                                F
                                             
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                K
                                             
                                          
                                          
                                          and
                                          
                                          i
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   |
                                                   K
                                                   |
                                                
                                             
                                          
                                          
                                             
                                                ∫
                                             
                                             
                                                K
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                i
                                                i
                                             
                                          
                                          
                                          d
                                          x
                                          ,
                                          
                                          for
                                          
                                          i
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                       
                                    
                                 
                              
                           
                         being 
                           
                              
                                 F
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 K
                              
                           
                         the side of 
                           K
                         perpendicular to 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        -axis. The relevant degrees of freedom for the tangential component are the shear stresses evaluated at the vertices of the rectangular element 
                           K
                        . Further details on shape functions and degrees of freedom for the considered family of mixed finite elements can be found in  [25–27].

It must be remarked that the “truly-mixed” nature of Eq. (1) has a relevant outcome also in the discrete setting. Stresses are main variables of the formulation, meaning that boundary conditions on 
                           
                              
                                 Γ
                              
                              
                                 t
                              
                           
                         must be enforced in strong form. Prescribed loads are imposed as assigned stress dofs, whereas displacement boundary conditions are conversely enforced in weak form through the line integral of Eq. (1)
                        1. If 
                           
                              
                                 
                                    
                                       u
                                    
                                    ¯
                                 
                              
                              
                                 j
                              
                           
                           =
                           0
                         on 
                           
                              
                                 Γ
                              
                              
                                 d
                              
                           
                        , the dual stress dofs are left unspecified, thus annihilating the relevant line integral at the right hand side of Eq. (1)
                        1. In this case, the discrete form of the “truly-mixed” problem reads: 
                           
                              (8)
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                
                                                
                                                   σ
                                                   σ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                
                                                
                                                   σ
                                                   u
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                
                                                
                                                   u
                                                   σ
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                σ
                                             
                                          
                                       
                                       
                                          
                                             
                                                u
                                             
                                          
                                       
                                    
                                    }
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                0
                                             
                                          
                                       
                                       
                                          
                                             
                                                0
                                             
                                          
                                       
                                    
                                    }
                                 
                                 ,
                              
                           
                         where it is also assumed that no body load is active. Each block of the above matrix may be easily recovered from the statement in Eq. (1), taking into account that bi-linear forms are labeled depending on the degrees of freedom involved in their computation. The vector of the unknowns of the mixed problem is made of the sub-vector of the stress unknowns, say 
                           
                              σ
                           
                        , and the sub-vector of the displacement unknowns, say 
                           
                              u
                           
                        . It is worth recalling that the only terms 
                           
                              
                                 
                                    A
                                 
                              
                              
                                 σ
                                 σ
                              
                           
                         deals with the constitutive law of the material.

Let 
                           ρ
                           
                              (
                              χ
                              )
                           
                         be a bounded function such that 
                           0
                           <
                           ρ
                           ≤
                           1
                         in 
                           Ω
                        , representing the material density in the considered domain. The fourth order compliance tensor 
                           
                              
                                 S
                              
                              
                                 i
                                 j
                                 h
                                 k
                              
                           
                         introduced in Section  2.1 depends on the material density at the point 
                           χ
                           ∈
                           Ω
                        . According to the Solid Isotropic Material with Penalization (SIMP) originally developed for the elasticity tensor  [28,29], a penalization for the inverse form of the constitutive law of a linear elastic solid can be written as: 
                           
                              (9)
                              
                                 
                                    
                                       S
                                    
                                    
                                       i
                                       j
                                       h
                                       k
                                    
                                 
                                 
                                    (
                                    ρ
                                    
                                       (
                                       χ
                                       )
                                    
                                    )
                                 
                                 =
                                 ρ
                                 
                                    
                                       
                                          (
                                          χ
                                          )
                                       
                                    
                                    
                                       −
                                       p
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       i
                                       j
                                       h
                                       k
                                    
                                    
                                       0
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 S
                              
                              
                                 i
                                 j
                                 h
                                 k
                              
                              
                                 0
                              
                           
                           =
                           −
                           
                              
                                 ν
                              
                              
                                 E
                              
                           
                           
                              
                                 δ
                              
                              
                                 i
                                 j
                              
                           
                           
                              
                                 δ
                              
                              
                                 h
                                 k
                              
                           
                           +
                           
                              
                                 1
                                 +
                                 ν
                              
                              
                                 E
                              
                           
                           
                              (
                              
                                 
                                    δ
                                 
                                 
                                    i
                                    h
                                 
                              
                              
                                 
                                    δ
                                 
                                 
                                    j
                                    k
                                 
                              
                              +
                              
                                 
                                    δ
                                 
                                 
                                    i
                                    k
                                 
                              
                              
                                 
                                    δ
                                 
                                 
                                    j
                                    h
                                 
                              
                              )
                           
                         is the compliance tensor for a given isotropic medium with engineering constants 
                           E
                         (Young modulus) and 
                           ν
                         (Poisson’s ratio). 
                           p
                           >
                           1
                         is a penalization parameter that can be assumed equal to 3 following e.g.  [30].

The above equation is suitable for compressible elasticity, but cannot be used to handle plane strain problems involving incompressible media. In fact Eq. (9) penalizes 
                           E
                         according to the value of the density unknown 
                           ρ
                        , but does not introduce any penalization on 
                           ν
                        . Undesired regions of minimum density may arise that exhibit non-zero stress and provide a non-physical stiffness to the optimal design, see in particular  [12].

To avoid such kind of numerical issues, one may write the constitutive equation in terms of the bulk and shear modulus of the isotropic material, say 
                           K
                           =
                           
                              
                                 E
                              
                              
                                 3
                                 
                                    (
                                    1
                                    −
                                    2
                                    ν
                                    )
                                 
                              
                           
                         and 
                           G
                           =
                           
                              
                                 E
                              
                              
                                 2
                                 
                                    (
                                    1
                                    +
                                    ν
                                    )
                                 
                              
                           
                         respectively, and adopt different SIMP-type interpolations to achieve an effective penalization of the fourth-order compliance tensor 
                           
                              
                                 S
                              
                              
                                 i
                                 j
                                 h
                                 k
                              
                           
                         for any 
                           ρ
                           <
                           1
                        . Defining by 
                           
                              
                                 σ
                              
                              
                                 i
                                 j
                              
                              
                                 I
                              
                           
                         and 
                           
                              
                                 σ
                              
                              
                                 i
                                 j
                              
                              
                                 D
                              
                           
                         the isotropic and the deviatoric part of the stress tensor, respectively, and by 
                           
                              
                                 ε
                              
                              
                                 i
                                 j
                              
                              
                                 I
                              
                           
                         and 
                           
                              
                                 ε
                              
                              
                                 i
                                 j
                              
                              
                                 D
                              
                           
                         the isotropic and the deviatoric component of the strain tensor, respectively, one has: 
                           
                              (10)
                              
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       I
                                    
                                 
                                 =
                                 ρ
                                 
                                    
                                       
                                          (
                                          χ
                                          )
                                       
                                    
                                    
                                       −
                                       
                                          
                                             p
                                          
                                          
                                             K
                                          
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       3
                                       K
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       I
                                    
                                 
                                 ,
                                 
                                 and
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       D
                                    
                                 
                                 =
                                 ρ
                                 
                                    
                                       
                                          (
                                          χ
                                          )
                                       
                                    
                                    
                                       −
                                       
                                          
                                             p
                                          
                                          
                                             G
                                          
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       2
                                       G
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       D
                                    
                                 
                                 .
                              
                           
                         Adopting an exponent 
                           
                              
                                 p
                              
                              
                                 K
                              
                           
                         bigger than 
                           
                              
                                 p
                              
                              
                                 G
                              
                           
                         (
                           
                              
                                 p
                              
                              
                                 K
                              
                           
                           =
                           6
                         and 
                           
                              
                                 p
                              
                              
                                 G
                              
                           
                           =
                           3
                         in the numerical simulations), a suitable penalization of the stiffness is performed for any value of the density unknown 
                           ρ
                        , thus achieving effective optimal layouts even in case of incompressible materials and plane strain assumption, see in particular  [9]. Eqs. (10) achieve layouts that are in full agreement with benchmarks of topology optimization for plane stress and compressible materials. The same penalization of Eq. (9) is recovered for 
                           
                              
                                 p
                              
                              
                                 K
                              
                           
                           =
                           
                              
                                 p
                              
                              
                                 G
                              
                           
                           =
                           p
                        .

According to Eqs. (1) and (9) one may define the so-called structural compliance at equilibrium, which can be written in terms of the complementary energy as: 
                           
                              (11)
                              
                                 C
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       −
                                       p
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       i
                                       j
                                       h
                                       k
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       h
                                       k
                                    
                                 
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                 d
                                 x
                                 =
                                 
                                    
                                       
                                          σ
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          A
                                       
                                    
                                    
                                       σ
                                       σ
                                    
                                 
                                 
                                    σ
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       e
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       e
                                    
                                    
                                       −
                                       p
                                    
                                 
                                 
                                 
                                    
                                       
                                          σ
                                       
                                    
                                    
                                       e
                                    
                                    
                                       T
                                    
                                 
                                 
                                 
                                    
                                       
                                          A
                                       
                                    
                                    
                                       σ
                                       σ
                                       ,
                                       e
                                    
                                    
                                       0
                                    
                                 
                                 
                                 
                                    
                                       
                                          σ
                                       
                                    
                                    
                                       e
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    σ
                                 
                              
                              
                                 e
                              
                           
                         is the vector of the element unknowns for the stress field, 
                           
                              
                                 
                                    A
                                 
                              
                              
                                 σ
                                 σ
                                 ,
                                 e
                              
                              
                                 0
                              
                           
                         is a block of the element stiffness matrix referring to the virgin material and 
                           
                              
                                 x
                              
                              
                                 e
                              
                           
                         is the 
                           e
                        th component of the vector of the 
                           N
                         element densities 
                           
                              x
                           
                        . A straightforward modification of Eq. (11) is found if the interpolations of Eq. (10) are used instead of Eq. (9).

For simplicity’s sake, the Von Mises stress criterion is used in this contribution to handle stress peaks in the optimal design. Other measures can be adopted to cope with the strength of materials having a non-symmetric behavior in tension and compression or to account for fatigue, see e.g.  [23,2,31]. The relevant inequality on the equivalent stress measure 
                           
                              
                                 σ
                              
                              
                                 e
                                 q
                              
                           
                         that defines feasibility under the assumption of plane stress or plane strain conditions reads: 
                           
                              (12)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       e
                                       q
                                    
                                 
                                 =
                                 
                                    
                                       3
                                       
                                          
                                             J
                                          
                                          
                                             2
                                             D
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             11
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             α
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             22
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             11
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             22
                                          
                                       
                                       +
                                       3
                                       
                                          
                                             σ
                                          
                                          
                                             12
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ≤
                                 
                                    
                                       σ
                                    
                                    
                                       L
                                    
                                 
                                 .
                              
                           
                         In the above equation 
                           
                              
                                 σ
                              
                              
                                 L
                              
                           
                         is the material strength and 
                           
                              
                                 J
                              
                              
                                 2
                                 D
                              
                           
                         is the second deviatoric stress invariant. 
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                           =
                           1
                         recovers a formula that is suitable for plane stress conditions, whereas 
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           =
                           1
                           −
                           ν
                           +
                           
                              
                                 ν
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                           =
                           1
                           +
                           2
                           ν
                           −
                           2
                           
                              
                                 ν
                              
                              
                                 2
                              
                           
                         account for the out-of-plane normal stress 
                           
                              
                                 σ
                              
                              
                                 33
                              
                           
                           =
                           ν
                           
                              (
                              
                                 
                                    σ
                                 
                                 
                                    11
                                 
                              
                              +
                              
                                 
                                    σ
                                 
                                 
                                    22
                                 
                              
                              )
                           
                         arising under the assumption of plane strain.

After the solution of Eq. (8), the stress state all over the domain is known through the main variables of the problem 
                           
                              σ
                           
                        . The overall stress in a relevant point of the 
                           e
                        th finite element, e.g. the centroid, may be written in a vectorial form as 
                           
                              
                                 
                                    σ
                                 
                              
                              
                                 e
                              
                           
                           =
                           
                              
                                 
                                    T
                                 
                              
                              
                                 e
                              
                           
                           
                              σ
                           
                        , being 
                           
                              
                                 
                                    σ
                                 
                              
                              
                                 e
                              
                           
                           =
                           
                              
                                 
                                    {
                                    
                                       
                                          σ
                                       
                                       
                                          11
                                       
                                    
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          22
                                       
                                    
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          12
                                       
                                    
                                    }
                                 
                              
                              
                                 T
                              
                           
                         and 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 e
                              
                           
                         a matrix that selects the stress degrees of freedom of the 
                           e
                        th element and uses the stress shape functions introduced in Section  2.2 to compute the three components of 
                           
                              
                                 
                                    σ
                                 
                              
                              
                                 e
                              
                           
                        . Resorting to the algebra detailed in  [32], the invariant in Eq. (12) may be written in terms of a “von Mises stress matrix” 
                           
                              
                                 
                                    M
                                 
                              
                              
                                 e
                              
                           
                        : 
                           
                              (13)
                              
                                 3
                                 
                                    
                                       J
                                    
                                    
                                       2
                                       D
                                       ,
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       
                                          σ
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          M
                                       
                                    
                                    
                                       e
                                    
                                 
                                 
                                    σ
                                 
                                 ,
                                 
                                 where
                                 
                                 
                                    
                                       
                                          M
                                       
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       
                                          T
                                       
                                    
                                    
                                       e
                                    
                                    
                                       T
                                    
                                 
                                 
                                    V
                                 
                                 
                                    
                                       
                                          T
                                       
                                    
                                    
                                       e
                                    
                                 
                                 
                                 and
                                 
                                 
                                    V
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             −
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                             /
                                             2
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                             /
                                             2
                                          
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             3
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                         The equivalent von Mises stress measure for the 
                           e
                        th finite element therefore reads: 
                           
                              (14)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       e
                                    
                                    
                                       e
                                       q
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                M
                                             
                                          
                                          
                                             e
                                          
                                       
                                       
                                          σ
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Eq. (12) should be applied to the macroscopic stress 
                           
                              
                                 σ
                              
                              
                                 i
                                 j
                              
                           
                         of an element with density 
                           
                              
                                 x
                              
                              
                                 e
                              
                           
                        . According to  [33], an appropriate failure criteria for the porous SIMP material is defined on the apparent “local” stress 
                           
                              〈
                              
                                 
                                    σ
                                 
                                 
                                    i
                                    j
                                 
                              
                              〉
                           
                         that may be derived as 
                           
                              〈
                              
                                 
                                    σ
                                 
                                 
                                    i
                                    j
                                 
                              
                              〉
                           
                           =
                           
                              
                                 σ
                              
                              
                                 i
                                 j
                              
                           
                           /
                           
                              
                                 x
                              
                              
                                 e
                              
                              
                                 q
                              
                           
                        , with 
                           q
                           >
                           1
                        . A suitable form for the Von Mises stress criterion to be used on the 
                           e
                        th finite element in conjunction with the SIMP model is: 
                           
                              (15)
                              
                                 
                                    
                                       
                                          〈
                                          
                                             
                                                σ
                                             
                                             
                                                e
                                             
                                             
                                                e
                                                q
                                             
                                          
                                          〉
                                       
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             L
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             e
                                          
                                          
                                             e
                                             q
                                          
                                       
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             e
                                          
                                          
                                             q
                                          
                                       
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             L
                                          
                                       
                                    
                                 
                                 ≤
                                 1
                                 ,
                              
                           
                         where 
                           
                              〈
                              
                                 
                                    σ
                                 
                                 
                                    e
                                 
                                 
                                    e
                                    q
                                 
                              
                              〉
                           
                         is the equivalent Von Mises “local” stress measure for the 
                           e
                        th finite element. The choice 
                           q
                           =
                           p
                         should be operated to preserve physical consistence of the adopted interpolation model at any density.

A classical problem of topology optimization adopts the compliance as objective function, whereas a constraint on the available volume fraction 
                           
                              
                                 V
                              
                              
                                 f
                              
                           
                         is enforced to achieve non-trivial solutions  [30]. Adopting the herein presented “truly-mixed” finite element method, writing the structural compliance as twice the complementary energy and resorting to the stiffness interpolation in Eq. (9), the MCW formulation (Minimum Compliance with Weight constraint) reads: 
                           
                              (16)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         m
                                                         i
                                                         n
                                                      
                                                   
                                                   ≤
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   ≤
                                                   1
                                                
                                             
                                          
                                          
                                             C
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   e
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   e
                                                
                                                
                                                   −
                                                   p
                                                
                                             
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                
                                                
                                                   e
                                                
                                                
                                                   T
                                                
                                             
                                             
                                             
                                                
                                                   
                                                      A
                                                   
                                                
                                                
                                                   σ
                                                   σ
                                                   ,
                                                   e
                                                
                                                
                                                   0
                                                
                                             
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                
                                                
                                                   e
                                                
                                             
                                          
                                       
                                       
                                          
                                             s.t.
                                          
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                            
                                                            
                                                               σ
                                                               σ
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  e
                                                               
                                                               
                                                                  −
                                                                  p
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  B
                                                               
                                                            
                                                            
                                                               σ
                                                               u
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  B
                                                               
                                                            
                                                            
                                                               u
                                                               σ
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                      
                                                   
                                                
                                                }
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                }
                                             
                                             ,
                                          
                                          
                                       
                                       
                                          
                                          
                                             W
                                             
                                             /
                                             
                                             
                                                
                                                   W
                                                
                                                
                                                   0
                                                
                                             
                                             
                                             ≤
                                             
                                             
                                                
                                                   V
                                                
                                                
                                                   f
                                                
                                             
                                             .
                                          
                                          
                                       
                                    
                                 
                              
                           
                         In the above equation, the objective function is the structural compliance 
                           C
                         of Eq. (11), Eq. (16)
                        2 enforces the discrete equilibrium equation discussed in Section  2.2 and Eq. (16)
                        3 enforces the volume constraint. The weight of the optimal design 
                           W
                         is computed multiplying the element density 
                           
                              
                                 x
                              
                              
                                 e
                              
                           
                         for the volume 
                           
                              
                                 V
                              
                              
                                 e
                              
                           
                         over the 
                           N
                         elements in the discretization, whereas 
                           
                              
                                 W
                              
                              
                                 0
                              
                           
                         stands for the volume of the whole design region. A lower bound 
                           
                              
                                 x
                              
                              
                                 m
                                 i
                                 n
                              
                           
                           >
                           0
                         is enforced on each density unknown 
                           
                              
                                 x
                              
                              
                                 e
                              
                           
                         to avoid singularity of Eq. (16)
                        2. It must be remarked that the above problem is formulated in terms of stresses. Displacements are secondary variables of the adopted finite element formulation and do not provide any contribution to the objective function, which is computed in terms of stresses only.

Minimizing the compliance 
                           C
                         of a structure acted upon by a prescribed set of assigned forces means minimizing the work of external loads, i.e. looking for a stiff structure. Working with one external force, this is the same as minimizing the displacement at the loaded point along the load direction. This approach optimizes the structure with respect to its serviceability, but does not account for any strength requirement preventing its collapse. The failure constraints of Eq. (15) could be straightforwardly added to the formulation of Eq. (16) to cope with the latter issue. In order to state a well-posed problem, a careful choice of the volume fraction 
                           
                              
                                 V
                              
                              
                                 f
                              
                           
                         should be operated in this case, see in particular  [23]. To avoid such an issue, a MWCS problem, i.e. a Minimum Weight formulation with Compliance and Stress constraints can be formulated as: 
                           
                              (17)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         m
                                                         i
                                                         n
                                                      
                                                   
                                                   ≤
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   ≤
                                                   1
                                                
                                             
                                          
                                          
                                             W
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   e
                                                
                                             
                                             
                                                
                                                   V
                                                
                                                
                                                   e
                                                
                                             
                                          
                                       
                                       
                                          
                                             s.t.
                                          
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                            
                                                            
                                                               σ
                                                               σ
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  e
                                                               
                                                               
                                                                  −
                                                                  p
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  B
                                                               
                                                            
                                                            
                                                               σ
                                                               u
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  B
                                                               
                                                            
                                                            
                                                               u
                                                               σ
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                      
                                                   
                                                
                                                }
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                }
                                             
                                             ,
                                          
                                          
                                       
                                       
                                          
                                          
                                             C
                                             
                                             /
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   L
                                                
                                             
                                             
                                             ≤
                                             
                                             1
                                             ,
                                          
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         e
                                                      
                                                      
                                                         e
                                                         q
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         e
                                                      
                                                      
                                                         q
                                                      
                                                   
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         L
                                                      
                                                   
                                                
                                             
                                             ≤
                                             1
                                             ,
                                             
                                             for
                                             
                                             e
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             N
                                             .
                                          
                                          
                                       
                                    
                                 
                              
                           
                         In the above equation, the structural weight 
                           W
                         is the objective function, whereas Eq. (17)
                        3 is a constraint on the overall stiffness, requiring the structural compliance 
                           C
                         to be lower than a prescribed limit 
                           
                              
                                 C
                              
                              
                                 L
                              
                           
                        . Working with one external force, this limit simply refers to the maximum displacement allowed at the loaded point along the load direction. Eq. (17)
                        4 include the set of 
                           N
                         local stress constraints on the equivalent Von Mises stress measure of Eq. (15).

The whole problem in Eq. (17) defines a minimum weight formulation embedding enforcements both on serviceability (compliance constraint) and failure (strength constraints). Neglecting Eq. (17)
                        4, one has a simpler MWC problem, i.e. a Minimum Weight formulation with Compliance constraint. Removing Eq. (17)
                        3, one gets a conventional MWS problem, i.e. a Stress-constrained Minimum Weight formulation, see e.g.  [33].

The MWCS setting can be used to address optimal design problems for which a threshold is prescribed to the deformability of the structure along with a limit on the strength of the material. Additionally, it can be used to remove any stress concentration from the optimal design achieved through the MCW setting of Eq. (16). In this case, 
                           
                              
                                 C
                              
                              
                                 L
                              
                           
                         can be assumed as the compliance of the optimal design found by the MCW setting at convergence.

For simplicity’s sake, the numerical section will primarily address the MWC problem to derive energy-based layouts. The prescribed limit on the compliance 
                           
                              
                                 C
                              
                              
                                 L
                              
                           
                         is formulated assuming that 
                           
                              
                                 C
                              
                              
                                 L
                              
                           
                           =
                           
                              
                                 α
                              
                              
                                 C
                              
                           
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                        , where 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         is the compliance found for the full domain made of virgin material and 
                           
                              
                                 α
                              
                              
                                 C
                              
                           
                         is a prescribed parameter. The MWCS formulation will be subsequently implemented, if needed, to remove any stress concentration arising in the achieved energy-based layouts.

It must be remarked that both kind of constraints that are handled in the discrete formulation of Eq. (17) are written in terms of the main variables of the finite element discretization, i.e. stresses. In particular, the stress measure is directly available from the primal unknowns of the “truly-mixed” setting. This is remarkably different with respect to a conventional displacement-based framework that calls for a post-processing of the variables to enforce strength constraints.

Modifications needed to specialize Eqs. (16) and (17) to the material model of Eqs. (10) are straightforward and herein omitted for brevity’s sake.

The Method of Moving Asymptotes (MMA)  [34], an established approach of convex sequential programming, is herein adopted to iteratively solve the discrete problems in Eq. (17). The algorithm searches for the optimal set of density unknowns, processing compliance and equivalent stress measures that descend from the adoption of an element-wise density discretization along with a quadratic/bi-linear interpolation of the primary field, i.e. the stress field.

The conventional discrete scheme coupling the element-wise density discretization with a bi-linear interpolation of the displacement field is well-known to be affected by the arising of undesired checkerboard patterns. Due to the fine interpolation of the stress field, the adopted “truly-mixed” discrete setting is free from the arising of such kind of numerical instabilities. However, independently of the adopted variational principle, mesh dependence has to be dealt with, see e.g.  [35–37]. A density filter approach is herein adopted following  [1], instead of applying the filter to the objective function and its sensitivities, as done in most cases. The original design variables 
                           
                              
                                 x
                              
                              
                                 e
                              
                           
                         are transformed in a new set of physical unknowns 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 e
                              
                           
                        , i.e.: 
                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             N
                                          
                                       
                                       
                                          
                                             H
                                          
                                          
                                             e
                                             l
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       e
                                       l
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       H
                                    
                                    
                                       e
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       N
                                    
                                 
                                 max
                                 
                                    (
                                    0
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          m
                                          i
                                          n
                                       
                                    
                                    −
                                    
                                       dist
                                    
                                    
                                       (
                                       e
                                       ,
                                       l
                                       )
                                    
                                    )
                                 
                                 .
                              
                           
                         In the above equation dist
                           
                              (
                              e
                              ,
                              l
                              )
                           
                         is the distance between the centroid of the 
                           e
                        th and 
                           l
                        th element, whereas 
                           
                              
                                 r
                              
                              
                                 m
                                 i
                                 n
                              
                           
                           >
                           
                              
                                 d
                              
                              
                                 m
                              
                           
                         is the filter radius, being 
                           
                              
                                 d
                              
                              
                                 m
                              
                           
                         the reference size of the finite elements in the mesh. The parameter 
                           
                              
                                 r
                              
                              
                                 m
                                 i
                                 n
                              
                           
                         provides a heuristic control on the minimum thickness of any member of the design. The assumption 
                           
                              
                                 r
                              
                              
                                 m
                                 i
                                 n
                              
                           
                           =
                           2
                           
                              
                                 d
                              
                              
                                 m
                              
                           
                         is done in the numerical simulations presented in Section  5.

The MWCS setting is mainly driven by the compliance constraint of Eq. (17)
                        3, whereas local enforcements steer the solution towards layouts that are fully feasible with respect to the prescribed strength criterion. Following  [23], a restricted set among the stress constraints in Eq. (17)
                        4 is selected and passed to MMA, with the main aim of reducing the time needed for the computation of the sensitivity information and improving the performance of the minimizer when handling the multi-constrained discrete problem. In the numerical simulations presented next the only constraints with l.h.s. 
                           ≥
                           0.65
                         are processed during the first step. The threshold is linearly increased until the 15th iteration and remain fixed to 0.95 thereafter. At each step, the selection reduces the whole sets of 
                           N
                         stress constraints to 
                           
                              
                                 N
                              
                              
                                 a
                              
                           
                           ≤
                           N
                        .

The adopted strategy provides its best performance when 
                           
                              
                                 N
                              
                              
                                 a
                              
                           
                           ≪
                           N
                        , which means handling a few localized stress peaks through a robust element-wise control and an acceptable computational effort. As introduced above, the MWCS formulation is implemented in Section  5 with the main aim of removing any localized stress concentration found in the energy-based optimal layouts previously achieved by the MWC setting. MWCS problems that require control of the stress field over broad areas or MWS problems where no benefit can be drawn from the enforcement of a compliance-based constraint can be robustly tackled resorting to alternative approaches proposed in the literature. Reference is made in particular to effective techniques involving enhanced global constraints or sets of aggregated local constraints, see e.g.  [1,4,2].

The well-known singularity problem may be responsible for bad convergence of the optimization, preventing the optimizer from finding the expected pure 0–1 design. This problem mainly descends from the asymptotic behavior of the “local” stress defined in Eq. (15) to cope with intermediate densities. As already recalled in Section  3.1, one should take 
                           p
                           =
                           q
                         to achieve full physical consistence in the modeling of the elastic and strength properties of a porous SIMP material. Unfortunately, if this assumption holds, “local” stresses remain finite (nonzero) for vanishing material density and the feasible sets of constraint equations may include some degenerate sub-domains with zero measure. This is a crucial issue for gradient-based optimizers because they are not able to find any global optimum located in these degenerate sub-regions and get stuck in undesired local optima exhibiting extended gray zones.

A classical way to overcome this problem consists in the adoption of a suitable mathematical relaxation to be applied to the equations that enforce stress constraints. Reference is made to  [38] for details related to the adoption of the well-known 
                           ε
                        -relaxation. Similarly, adopting an exponent 
                           q
                           <
                           p
                        , a strong relaxation in the low density region can be introduced without causing any remarkable bias at full density, see e.g.  [23]. This prevents convergence of the optimizer towards undesired local minima, while preserving a robust enforcement of the strength constraints over the full material zone. The analytical form of the relaxed version of the constraints in Eq. (17)
                        4 is the same of the unrelaxed set. No additional manipulation is needed because stresses are main variables of both the optimization and the finite element problem within the proposed approach. The assumption 
                           q
                           =
                           2.8
                         is adopted in the numerical simulations presented next.

The sensitivity computation for the stress-based compliance 
                           C
                         is required at each iteration of the minimization procedures introduced in Section  3.2. Eq. (17) iteratively calls for the sensitivity of the selected set of local stress constraints, as well. Derivatives of the weight function 
                           W
                         with respect to the density unknowns are evaluated once before the optimization starts.

Deriving the stress-based compliance 
                           C
                         with respect to the density unknown 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                        , one has: 
                           
                              (19)
                              
                                 
                                    
                                       ∂
                                       C
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∂
                                       
                                          
                                             
                                                σ
                                             
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          A
                                       
                                    
                                    
                                       σ
                                       σ
                                    
                                 
                                 
                                    σ
                                 
                                 +
                                 
                                    
                                       
                                          σ
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ∂
                                          
                                             
                                                
                                                   A
                                                
                                             
                                             
                                                
                                                   σσ
                                                
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    
                                       σ
                                    
                                    +
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          σ
                                          σ
                                       
                                    
                                    
                                       
                                          ∂
                                          
                                             σ
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Deriving the first line of the “truly-mixed” elastic equilibrium in Eq. (8) with respect to the same density unknown, one finds that the term in brackets reads: 
                           
                              (20)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             
                                                A
                                             
                                          
                                          
                                             
                                                σσ
                                             
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    σ
                                 
                                 +
                                 
                                    
                                       
                                          A
                                       
                                    
                                    
                                       σ
                                       σ
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          σ
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       
                                          B
                                       
                                    
                                    
                                       σ
                                       u
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          u
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         Transposing the above equation and multiplying at right by the vector of the main unknowns 
                           
                              σ
                           
                        , one also can write that: 
                           
                              (21)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             
                                                σ
                                             
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          A
                                       
                                    
                                    
                                       σ
                                       σ
                                    
                                 
                                 
                                    σ
                                 
                                 =
                                 −
                                 
                                    
                                       ∂
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          B
                                       
                                    
                                    
                                       σ
                                       u
                                    
                                    
                                       T
                                    
                                 
                                 
                                    σ
                                 
                                 −
                                 
                                    
                                       
                                          σ
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             
                                                A
                                             
                                          
                                          
                                             σ
                                             σ
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    σ
                                 
                                 .
                              
                           
                         Substituting Eqs.  (20)–(21) into Eq. (19) and recalling that the second line of the “truly-mixed” elastic equilibrium in Eq. (8) enforces that 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 u
                                 σ
                              
                           
                           
                              σ
                           
                           =
                           
                              
                                 
                                    B
                                 
                              
                              
                                 σ
                                 u
                              
                              
                                 T
                              
                           
                           
                              σ
                           
                           =
                           
                              0
                           
                        , one may state that the derivative of 
                           C
                         with respect to the unknown density 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                         reads: 
                           
                              (22)
                              
                                 
                                    
                                       ∂
                                       C
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       
                                          σ
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             
                                                A
                                             
                                          
                                          
                                             σ
                                             σ
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    σ
                                 
                                 =
                                 p
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                    
                                       −
                                       p
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          σ
                                       
                                    
                                    
                                       k
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          A
                                       
                                    
                                    
                                       σ
                                       σ
                                       ,
                                       k
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       
                                          σ
                                       
                                    
                                    
                                       k
                                    
                                 
                                 .
                              
                           
                        
                     

The sensitivities of the stress constraints in Eq. (17)
                        4 require some additional computational effort. Recalling Eq. (15), the adopted relaxation allows straightforwardly to write the derivative of the equivalent Von Mises “local” stress measure for the 
                           e
                        th finite element 
                           
                              〈
                              
                                 
                                    σ
                                 
                                 
                                    e
                                 
                                 
                                    e
                                    q
                                 
                              
                              〉
                           
                        , with respect to the unknown density 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                        . It reads: 
                           
                              (23)
                              
                                 
                                    
                                       ∂
                                       
                                          〈
                                          
                                             
                                                σ
                                             
                                             
                                                e
                                             
                                             
                                                e
                                                q
                                             
                                          
                                          〉
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 =
                                 −
                                 q
                                 
                                    
                                       δ
                                    
                                    
                                       e
                                       k
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       e
                                    
                                    
                                       −
                                       q
                                       −
                                       1
                                    
                                 
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       e
                                    
                                    
                                       e
                                       q
                                    
                                 
                                 +
                                 
                                    
                                       ∂
                                       
                                          
                                             σ
                                          
                                          
                                             e
                                          
                                          
                                             e
                                             q
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       e
                                    
                                    
                                       −
                                       q
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 δ
                              
                              
                                 e
                                 k
                              
                           
                         is the Kronecker symbol that is equal to 1 if 
                           e
                           =
                           k
                         and 0 if 
                           e
                           ≠
                           k
                        .

Since the number of active stress enforcements, i.e.  
                           
                              
                                 N
                              
                              
                                 a
                              
                           
                        , is generally smaller than the number of design variables, i.e.  
                           N
                        , the adjoint method is herein preferred to the direct approach in the computation of the derivative of 
                           
                              
                                 σ
                              
                              
                                 e
                              
                              
                                 e
                                 q
                              
                           
                        , see also  [32] and  [23]. The derivative of the equivalent Von Mises “local” stress measure for the 
                           e
                        th finite element 
                           
                              〈
                              
                                 
                                    σ
                                 
                                 
                                    e
                                 
                                 
                                    e
                                    q
                                 
                              
                              〉
                           
                         with respect to the unknown density 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                         reads: 
                           
                              (24)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             σ
                                          
                                          
                                             e
                                          
                                          
                                             e
                                             q
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             
                                                A
                                             
                                          
                                          
                                             σ
                                             σ
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    σ
                                 
                                 ,
                                 
                                 where
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                
                                                
                                                   σ
                                                   σ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                
                                                
                                                   σ
                                                   u
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                
                                                
                                                   u
                                                   σ
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               M
                                                            
                                                         
                                                         
                                                            e
                                                         
                                                      
                                                      
                                                         σ
                                                      
                                                      )
                                                   
                                                
                                                
                                                   −
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      M
                                                   
                                                
                                                
                                                   e
                                                
                                             
                                             
                                                σ
                                             
                                          
                                       
                                       
                                          
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                         meaning that each active constraint requires the solution of one additional load case for the linear system in Eq. (17)
                        2.

It must be finally remarked that the use of a density filter implies a chain rule modification of the sensitivities of the objective function along with the full set of constraints. In fact, one has to compute the derivatives with respect to the physical unknowns 
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 e
                              
                           
                        .

A first numerical investigation is performed to assess convergence features and stability of the implemented “truly-mixed” finite element. Comparisons with respect to the four-node displacement based finite element are provided, both in case of compressible and quasi-incompressible plane strain elasticity.


                        Fig. 2
                         shows geometry and boundary condition for the considered benchmark, along with the location of point 
                           A
                         where stresses are computed. In the “truly-mixed” setting, the enforcement along 
                           
                              
                                 Γ
                              
                              
                                 d
                              
                           
                         and 
                           
                              
                                 Γ
                              
                              
                                 t
                              
                           
                         is done according to Section  2.2. In detail, stress dofs that are set equal to zero are 
                           
                              
                                 σ
                              
                              
                                 y
                                 y
                              
                           
                        , 
                           
                              
                                 σ
                              
                              
                                 x
                                 y
                              
                           
                         at the lower side, 
                           
                              
                                 σ
                              
                              
                                 x
                                 y
                              
                           
                         at the upper side and 
                           
                              
                                 σ
                              
                              
                                 x
                                 x
                              
                           
                         along the vertical edges. Stress dofs for 
                           
                              
                                 σ
                              
                              
                                 y
                                 y
                              
                           
                         are set equal to the external pressure 
                           w
                         to prescribe the load along the upper side of the specimen.

Analytical expressions for the components of the stress tensor can be derived through the Airy stress function and read: 
                           
                              (25)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       x
                                       x
                                    
                                 
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       2
                                       I
                                    
                                 
                                 
                                    (
                                    
                                       
                                          l
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 y
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       I
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                3
                                             
                                          
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          y
                                       
                                       
                                          5
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       y
                                       y
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       2
                                       I
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                3
                                             
                                          
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    y
                                    +
                                    
                                       
                                          2
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       x
                                       y
                                    
                                 
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       2
                                       I
                                    
                                 
                                 x
                                 
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           w
                           =
                           c
                           =
                           1
                        , 
                           l
                           =
                           3
                           c
                         and 
                           I
                           =
                           2
                           /
                           3
                           
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                        .

Firstly, the case with 
                           ν
                           =
                           0.3
                         is considered. Fig. 3
                        (a)–(c) show convergence plots for the computed values of 
                           
                              
                                 σ
                              
                              
                                 x
                                 x
                              
                           
                        , 
                           
                              
                                 σ
                              
                              
                                 y
                                 y
                              
                           
                        , 
                           
                              
                                 σ
                              
                              
                                 x
                                 y
                              
                           
                        , depending on the number of finite elements that lie along the height of the beam 
                           n
                        . The elements of the adopted mesh are 
                           48
                           ≤
                           3
                           n
                           ⋅
                           n
                           ≤
                           49
                           ,
                           152
                        . All the curves converge to the horizontal plateau corresponding to the exact solution in Eq. (25). Quadratic and bilinear polynomials that directly interpolate the stress field as main variable of the “truly-mixed” formulation provide increased accuracy with respect to the gradient of the bilinear interpolation used to approximate the displacement field in the conventional four-node finite element. This is in agreement with theoretical and numerical results concerning convergence properties of the implemented mixed finite element as presented in  [22].

As detailed in Section  3.1, the Von Mises equivalent stress 
                           
                              
                                 σ
                              
                              
                                 V
                                 M
                              
                           
                         is adopted to control local failure when handling the optimal design. Fig. 3(d) shows a convergence plot of the stress measure 
                           
                              
                                 σ
                              
                              
                                 V
                                 M
                              
                           
                         that is found combining the computed components of the stress tensor according to the left hand side of Eq. (12). It is worth remarking that the “truly-mixed” formulation approaches the final asymptote more rapidly than the conventional displacement-based finite element.


                        Table 1
                         shows the computational cost related to the above simulations, providing the total CPU time needed to run the full code for each finite element analysis and the partial CPU time spent in the solution of the discrete system of equilibrium equations. Matlab backslash has been adopted, as also implemented in  [22] testing the HMZ element. Of course, the construction of the shape functions and the assemblage of the global matrix are more demanding in the “truly-mixed” framework. The direct discretization of the stress field remarkably increases the number of degrees of freedom involved in the solution of the equilibrium equations, thus calling for an increased computational cost with respect to the low order displacement-based approach. However, it must be remarked that the HMZ element allows saving many unknowns with respect to conventional “truly-mixed” discretization, see e.g.  [19], and that ad hoc solvers can be adopted to improve the computational efficiency when handling the saddle-point problem in Eq. (8), see in particular  [39].

Referring to requirements on the deformability of the optimal design, Section  3.1 has also shown that this is dealt with by means of the structural compliance 
                           C
                        . In a conventional displacement-based formulation this quantity is computed as 
                           
                              
                                 
                                    u
                                 
                              
                              
                                 T
                              
                           
                           
                              K
                           
                           
                              u
                           
                        , where 
                           
                              u
                           
                         is the vector of the primary displacement unknowns and 
                           
                              K
                           
                         is the overall stiffness matrix. In the introduced “truly-mixed” setting, 
                           C
                         is written in terms of the complementary energy and computed from the stress unknowns according to Eq. (11). Fig. 4
                        (a) shows that the relevant convergence curves find the same final value with a comparable rate of convergence. Assuming this value as the reference solution, Fig. 4(b) plots the error, highlighting the slightly better performance achieved by the “truly-mixed” finite element.

Displacement-based finite elements are well-known to be affected by locking, i.e. a severe loss of convergence when addressing incompressible or quasi-incompressible materials under plane strain conditions, see in particular  [18]. To assess the behavior of the herein considered finite elements, the above numerical investigation is repeated for 
                           ν
                           =
                           0.49
                        . Fig. 5
                        (a)–(d) show convergence plots for the components of the stress tensor along with the Von Mises stress measure. As one may easily see, no difference is found with respect to Fig. 3(a)–(d) concerning results of the “truly-mixed” discretization. Conversely, convergence rates of the displacement-based approximation get remarkably worse. Fig. 6
                         points out that a similar behavior is found looking at the evaluation of the overall compliance. For 
                           ν
                           →
                           0.5
                         the numerical instabilities shown by the displacement-based approximation become severe both on stresses and compliance, whereas the considered “truly-mixed” discretization remains fully stable even for problems of incompressible elasticity, see  [22] for details.

This section presents results achieved through the stress-based formulation introduced in Section  3.2 and applied to the benchmark example concerning the optimal design of an L-shaped cantilever, see Fig. 7
                        , considering the MWC and MWCS problems. A comparison with the conventional displacement-based formulation is provided for both problems.

A material with Young modulus 
                           E
                           =
                           1
                           
                           
                              
                                 
                                    N/m
                                 
                              
                              
                                 2
                              
                           
                         and Poisson’s ratio 
                           ν
                           =
                           0.3
                         is herein assumed. The adopted regular grids are made of 4096 square elements with unitary thickness under plane stress conditions. Optimal designs are presented in terms of the set of physical unknowns of the adopted filtering scheme, along with maps showing the elementwise equivalent Von Mises stress measure 
                           
                              
                                 σ
                              
                              
                                 e
                                 q
                              
                           
                         defined in Eq. (12).


                        Table 2
                         compares the achieved optimal layouts addressing non-dimensional weight 
                           W
                           /
                           
                              
                                 W
                              
                              
                                 0
                              
                           
                        , non-dimensional compliance 
                           C
                           /
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         and maximum Von Mises equivalent stress 
                           
                              
                                 σ
                              
                              
                                 m
                                 a
                                 x
                              
                              
                                 e
                                 q
                              
                           
                        . Subscript 
                           
                              
                              
                                 0
                              
                           
                         stands for quantities related to the full domain made of virgin material. Weight and compliance at convergence are divided by the relevant values computed at the first iteration of the optimization procedure, when 
                           
                              
                                 x
                              
                              
                                 e
                              
                           
                           =
                           1
                           ,
                           ∀
                           e
                        . The table also shows the number of active constraints processed at convergence 
                           
                              
                                 N
                              
                              
                                 a
                              
                              
                                 C
                              
                           
                        .


                        Fig. 8
                         shows the optimal design achieved through the MWC formulation for the constraint 
                           
                              
                                 α
                              
                              
                                 C
                              
                           
                           =
                           2.0
                         and the adoption of a conventional displacement-based finite element framework. The achieved layout exhibits a vertical displacement of the loaded point that is twice the deflection found for the full domain made of virgin material. The same optimal solution is found by the MWC procedure as completely implemented in terms of stress, i.e. following the formulation of Eq. (17). The relevant Von Mises stress maps shown in Fig. 9
                         point out that the maximum stress is found in the vicinity of the corner region, as expected. Although the optimal layout is the same, the peak stress approximated through the displacement-based discretization is remarkably different from that approximated through the mixed finite element method. The maximum stress read as a result of the displacement-based optimization is 
                           
                              
                                 σ
                              
                              
                                 m
                                 a
                                 x
                              
                              
                                 e
                                 q
                              
                           
                           =
                           9.7
                           
                           
                              
                                 
                                    N/m
                                 
                              
                              
                                 2
                              
                           
                        , whereas the stress-based framework finds 
                           
                              
                                 σ
                              
                              
                                 m
                                 a
                                 x
                              
                              
                                 e
                                 q
                              
                           
                           =
                           10.2
                           
                           
                              
                                 
                                    N/m
                                 
                              
                              
                                 2
                              
                           
                         nearby. The finer approximation provided by the mixed formulation is expected to capture the stress peak with more accuracy. No remarkable difference is found in terms of convergence of the objective function, see Fig. 10
                        .

The above results are in full agreement with the investigation on convergence features of the adopted finite elements that have been presented in Section  5.1. Indeed, the considered energy-based problem is completely driven by the structural compliance, which is approximated with nearly the same accuracy by both finite element approaches, see in particular Fig. 4. This explains why the displacement-based approach and the mixed method find the same optimal design represented in Fig. 8.

To remove the undesired stress concentration preserving the stiffness of the achieved optimal design, the MWCS approach is implemented accounting for both compliance and stress constraints. Fig. 11
                        (a) shows the optimal layout achieved through the conventional displacement-based finite element framework, enforcing 
                           
                              
                                 α
                              
                              
                                 C
                              
                           
                           =
                           2.0
                         and 
                           
                              
                                 σ
                              
                              
                                 L
                              
                           
                           =
                           5.0
                           
                           
                              
                                 
                                    N/m
                                 
                              
                              
                                 2
                              
                           
                        . As expected, the corner region is tackled through the adoption of a set of bars that deviate the tensile stress flux from the geometrical singularity whereas all the members have a suitable thickness to retain the overall compliance. Fig. 11(b) shows the optimal solution found by the MWCS procedure implemented in terms of stress, i.e. following the formulation of Eq. (17). The maximum stress found in both layouts is the same according to the local enforcements on the stress field, see maps in Fig. 12
                        . However, some differences arise in the optimal solutions, due to the different accuracy in the evaluation of the stress field, see Section  5.1. The optimization implementing mixed finite elements distributes inclined members that move away from the geometric singularity, whereas more mass is located around the corner by the displacement-based optimization. Also, the number of bars making the optimal layouts is not the same.

No remarkable difference is found in terms of convergence of the objective function, see Fig. 13
                        , and in the number of active constraints at convergence, see Table 2.

The second example refers to the clamped beam represented in Fig. 7, which is tackled through the proposed stress-based approach to address both compressible and incompressible materials. The MWC formulation is considered, enforcing 
                           
                              
                                 α
                              
                              
                                 C
                              
                           
                           =
                           2.5
                        . Young modulus 
                           E
                           =
                           1
                           
                           
                              
                                 
                                    N/m
                                 
                              
                              
                                 2
                              
                           
                         is herein assumed, whereas the Poisson’s ratio can be either 
                           ν
                           =
                           0.3
                         or 
                           ν
                           =
                           0.5
                        . The adopted regular grid is made of 8192 square elements, making the assumption of plane stress or plane strain conditions. The full geometry is analyzed, instead of one half, to check the symmetry of the optimal layouts.


                        Fig. 14
                        (a) and (b) show the optimal layouts achieved under the assumption of plane stress conditions, for 
                           ν
                           =
                           0.3
                         and 
                           ν
                           =
                           0.5
                         respectively. Fig. 14(c) and (d) show the relevant optimal layouts in case of plane strain. Fig. 15
                         provides the Von Mises stress map for the optimal design of Fig. 14(d) to assess that no unfeasible region arises in the domain to exploit incompressibility of the material at low density under plane strain conditions, see Section  3.1. According to the literature on optimal design for incompressible media, a plane strain design takes advantage of thick members and layouts exploiting triaxial and nearly isotropic stress states. Indeed, the optimal layout in Fig. 14(d) is remarkably different with respect to the others. Some material is gathered around each clamped region, providing a bulk instead of resorting to thin members.

Due to the robustness of the adopted locking-free finite element and to the stiffness interpolation model of Eqs. (10), all the achieved results are pure 0–1 layouts. No remarkable difference is found in the history plot of the objective function for the simulations herein considered, as shown in Fig. 16
                        . A plane stress design has approximately the same convergence of a plane strain optimization, both for compressible and incompressible material.

The contribution of the out-of-plane material makes a plane strain design much stiffer than the relevant plane stress layout, see Table 3
                        .

The last example is concerned with the rectangular cantilever shown in Fig. 7. The proposed stress-based approach is adopted to cope with an incompressible material with Young modulus 
                           E
                           =
                           1
                           
                           
                              
                                 
                                    N/m
                                 
                              
                              
                                 2
                              
                           
                        . A grid with 4704 HMZ finite elements is implemented under the assumption of plane stress or plane strain.

At first the MWC problem is investigated to achieve stiff layouts for a compliance constraint enforcing 
                           
                              
                                 α
                              
                              
                                 C
                              
                           
                           =
                           2.0
                        . Fig. 17
                        (a) shows the optimal layout found under the plane stress assumption, whereas Fig. 17(b) refers to the case of plane strain. The four thinner bars appearing in Fig. 17(a) are replaced by two thicker bars in Fig. 17(b), in full agreement with the outcome of the previous example. Fig. 18
                         provides the relevant Von Mises stress maps for the achieved optimal results, pointing out that some stress concentrations arise in both cases next to the ground constraints. As reported in Table 4
                        , the stress peak is higher under plane stress. In fact, the out-of-plane effect relieves the material under plane strain, as accounted through the parameter 
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                         in Eq. (12).

To remove the undesired stress peaks but preserve the required stiffness, the MWCS approach is implemented enforcing 
                           
                              
                                 α
                              
                              
                                 C
                              
                           
                           =
                           2.0
                         and 
                           
                              
                                 σ
                              
                              
                                 L
                              
                           
                           =
                           12.0
                           
                           
                              
                                 
                                    N/m
                                 
                              
                              
                                 2
                              
                           
                        . Fig. 19
                        (a) shows the optimal layout found under the plane stress assumption, whereas Fig. 19(b) refers to the case of plane strain. According to the relevant Von Mises stress maps reported in Fig. 20
                        (a) and (b), a nearly homogeneous stress field is found in the optimal layouts. To achieve this result inclined members are connected directly to the ground, instead of crossing the horizontal ones. Some difference is found depending on the assumption on the plane problem. Under plane stress inclined members are adjacent to the horizontal ones, whereas under plane strain a full separation between the two set of bars arises. This is required to avoid any disturbance to the stress state related to the geometrical interference.

Finally, Fig. 21
                         provides convergence curves for the stress-constrained problems herein considered. No numerical instability is found, thus assessing the robustness of the proposed approach to cope not only with energy-based problems but also with stress-constrained problems for incompressible materials.

An alternative numerical method has been introduced to cope with the optimal design of structures made of compressible or incompressible material on regular grids. The proposed approach is based on the adoption of a novel “truly-mixed” finite element that allows reducing the number of degrees of freedom with respect to conventional elements, while preserving a good accuracy in the evaluation of the stress field along with full robustness against locking. The topology optimization problem is formulated adopting stresses as main variables and implementing both compliance and stress constraints within a weight minimization. The structural compliance is computed through the evaluation of the complementary energy, whereas the enforcement of stress constraints is straightforward. The classical SIMP law is re-written to penalize the compliance tensor. Sensitivity computations are performed to find derivatives in terms of stresses only.

Referring to compressible media, comparisons with a conventional displacement-based method show that optimal layouts may be affected by the convergence features of the adopted finite element. In case of energy-based problems the strain energy and the complementary energy are approximated with nearly the same accuracy and no remarkable difference is found adopting a conventional displacement-based approach or the proposed method based on mixed finite elements. Conversely, stress-constrained layouts take advantage of the direct discretization of the stress field as main variable of the problem.

Concerning incompressible media, the proposed approach allows performing the optimization without the computational burden peculiar to alternative “truly-mixed” discretizations. It is known that an energy-based plane strain optimal design exploits an increased stiffness of the material under triaxial stress states and may result in a different topology with respect to a plane stress layout. Stress-constrained solutions for structures made of incompressible media are introduced, assessing that remarkable differences may arise when enforcements on the stress field are considered as well.

History plots of the objective function confirm full stability of the proposed framework in all the considered simulations, showing almost the same performance when coping with compressible and incompressible materials.

It must be finally remarked that the adopted family of mixed finite elements preserves its accuracy, robustness and efficiency on regular grids of any dimension. A “truly-mixed” brick finite element is currently being investigated to address the optimal design of structures made of compressible or incompressible media within the three-dimensional framework.

@&#REFERENCES@&#

