@&#MAIN-TITLE@&#Testing the accuracy of DEA estimates under endogeneity through a Monte Carlo simulation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We define endogeneity as the correlation between one input and the efficiency term.


                        
                        
                           
                           We run a Monte Carlo experiment to measure how endogeneity affects DEA estimations.


                        
                        
                           
                           We find that DEA is robust to negative endogeneity.


                        
                        
                           
                           But, a moderate or high positive endogeneity biases DEA performance.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Data envelopment analysis

Endogeneity

Monte Carlo experiments

@&#ABSTRACT@&#


               
               
                  Endogeneity, and the distortions on the estimation of economic models that it causes, is a usual problem in the econometrics literature. Although non-parametric methods like Data Envelopment Analysis (DEA) are among the most used techniques for measuring technical efficiency, the effects of such problem on efficiency estimates have received little attention. The aim of this paper is to alert DEA practitioners about the accuracy of their estimates under the presence of endogeneity. For this, first we illustrate the endogeneity problem and its causes in production processes and its implications for the efficiency measurement from a conceptual perspective. Second, using synthetic data generated in a Monte Carlo experiment we evaluate how different levels of positive and negative endogeneity can impair DEA estimations. We conclude that, although DEA is robust to negative endogeneity, a high positive endogeneity level, i.e., the existence of a high positive correlation between one input and the true efficiency level, might bias severely DEA estimates.
               
            

@&#INTRODUCTION@&#

The evaluation of the technical efficiency of decision-making units (DMUs) is a crucial component of management decision-making for saving resources and for monitoring and evaluating DMU activity in order to detect better and worse performers and improving results. Public service providers are naturally interested in efficiency assessments since they manage a huge amount of funds and face both increasing demands and financial constraints. Completely unknown production technologies or the frequent use of multiple proxy variables to approximate the real output as a result of the special characteristics of public sector production, which is not fixed upon profit maximization, complicate the estimation of accurate efficiency measures (Bowlin, 1986). In these contexts, non-parametric techniques, and especially data
envelopment
analysis (DEA), are the most commonly applied methods for measuring technical efficiency relative to an estimate of an unobserved true frontier in multiple frameworks (Gattoufi, Oral, Kumar, & Reisman, 2004).

Within this framework, selecting the appropriate input and output variables to include in the model specification is one of the most critical choices that practitioners will have to undertake in order to obtain reliable efficiency scores. This point have received a lot of attention in the DEA literature over the past decades, where several works have analyzed the effects of different model misspecifications that can be detrimental to DEA estimates (Dyson et al., 2001; Galagedera & Silvapulle, 2003; Natarajan & Johnson, 2011; Pedraja-Chaparro, Salinas-Jimenez, & Smith, 1999; Ruggiero, 2005; Smith, 1997).

However, there is another major concern, namely, the presence of endogeneity in the production process, which is frequently overlooked when practitioners apply DEA, even though this issue has received plenty of attention in econometrics. There are several potential sources of endogeneity, including measurement errors, omitted relevant variables or the presence of simultaneity (see Wooldridge, 2012, pp. 519–520). The idea behind this concept is that some inputs are not exogenous to the production model, but are determined within the model. In statistical terms, this phenomenon implies the presence of correlation between the error term and at least one explanatory variable. In the estimation of technical efficiency with frontier techniques, this phenomenon implies that at least one input is correlated with the inefficiency term as pointed out by Peyrache and Coelli (2009).

The distortions in the estimation of economic models potentially caused by such endogeneity have been widely studied in the econometrics literature. However, its effects on efficiency measures estimated through nonparametric techniques like DEA have not received much attention. There are only a handful of studies that have addressed this issue and tested the performance of DEA under some kind of endogeneity (Bifulco & Bretschneider, 2001, 2003; Orme & Smith, 1996; Ruggiero, 2003). Using alternative simulation strategies and data generation processes, almost all the above research concludes that DEA estimates can be biased if there is a certain level of correlation between one input and the true efficiency. However, these previous works do not allow to draw general conclusions about the potential distortions of the presence of endogeneity on DEA estimates.

As the aim of this paper is to analyze whether endogeneity can bias the results of DEA in order to make practitioners using this technique aware of the accuracy of their estimates, we make an effort to generalize the effect of endogeneity on DEA estimations by expanding the analysis in various directions. In this sense, we simulate both the negative and the positive endogeneity and different intensities of the correlation between one input and the true efficiency. Secondly, we incorporate a more flexible translog production function in addition to the traditional Cobb–Douglas, which fails to capture the potential nonlinear effects of inputs on the output variable.
                        1
                     
                     
                        1
                        This can be a significant weakness in complex production frameworks such as education or health provision.
                      Finally, we conduct our simulation by performing a Monte Carlo experiment to provide more robust results.

The article is organized as follows. Section 2 introduces some basic concepts of the DEA estimation and the potential effects of endogeneity on its performance from a conceptual viewpoint. Section 3 describes the methodology used to generate the synthetic data in our Monte Carlo experimental design. Section 4 presents the main results of the analysis. Finally, the paper concludes with a discussion of the main implications of our findings for practitioners using DEA to measure technical efficiency in different contexts and some directions for future research.

The analysis of data in the presence of endogeneity is one of the main recent contributions of econometrics to statistical science (Blundell & Powell, 2003). Consider the multiple-input single-output production function:

                        
                           (1)
                           
                              
                                 
                                    y
                                    i
                                 
                                 =
                                 f
                                 
                                    (
                                    
                                       x
                                       i
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       ɛ
                                    
                                    i
                                 
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                              
                           
                        
                     where
yi
                      is the level of observed output for DMU i, f is an unknown production function to be estimated, xi
                      ∈ ℜ
                        m
                      is the vector of observable inputs and ɛ
                        i
                      represents the unobservable error term, which can also be identified as the distance to the true productive frontier. In fact, if we limit the estimation of f to the non-stochastic frontier models, we can assume that all those deviations are due to technical inefficiency and therefore ɛ
                        i
                      ≤ 0 ∀ i = 1, …, n.

In order to estimate
Eq. (1) using a regression model, some crucial assumptions are required, including that the error term is uncorrelated with all the observed inputs E(ɛ|X) = 0; i.e., all regressors must be exogenous. In this context, the presence of endogeneity implies that xi
                      and ɛ
                        i
                      are correlated, thus the latter assumption cannot be hold in practice
E(ɛ|X) ≠ 0. This phenomenon can arise as the result of multiple sources, such as measurement errors, the omission of relevant variables in the model specification, although perhaps the most common cause is the presence of simultaneity or two-way causal relationships between the dependent and independent variables (e.g. see Wooldridge, 2012).

The education sector is a good example to illustrate this issue, since the endogeneity problem arises very frequently (Mayston, 2003). Actually, in this framework the presence of the self-selection problem has been argued to be the basis for multiple theoretical and empirical critiques of traditional findings using conventional econometric techniques. As a result, multiple methods have been developed in the literature to deal with this problem (Schlotter, Schwerdt, & Woessmann, 2011). In this context, it is claimed that schools with better academic outcomes tend to attract relatively more advantaged students from a high socio-economic background. If parents motivation is correlated with socio-economic level, such pupils (and thus the school they attend) will tend to obtain better academic results for two reasons. Firstly, socio-economic level is an essential input for producing educational output. Secondly, parents and students motivation (which is unobserved) has a positive effect on school efficiency. Consequently, we will observe that schools whose students are from a high socio-economic background are more prone to be fully efficient. This mechanism results in a positive correlation between socio-economic background (input) and technical efficiency: E(ɛ|X) > 0. The same reasoning can be applied for the selection of schools by teachers in many public education systems, because highly qualified and motivated teachers self-select into the best schools (those with a high percentage of students from higher income families a lower ratio of repeat students and disadvantaged pupils and better facilities) and also have a positive effect on student results at those schools.

However, the endogeneity problem can also arise in the opposite direction when a direct negative feedback from outputs to resources is observed (simultaneity). This applies, for instance, when school funding systems operating compensatory policies allocate more resources to schools with poorer academic results in order to improve the performance of these schools (Orme & Smith, 1996). If poorer results are due to a high inefficiency, then the ‘reverse causality’ problem implies allocating more resources to inefficient schools causing a negative correlation between resources (input) and true efficiency: E(ɛ|X) < 0.

The endogeneity problem has also been a factor considered recently in the estimation of technical efficiency with parametric frontier techniques. For example, Solis, Bravo‐Ureta, and Quiroga (2007) employ a switching regression model to handle the selection bias in hillside farmers under different levels of adoption of soil conservation in El Salvador and Honduras. Greene (2010) proposes a simple way to extend the Heckman sample selection model to stochastic frontier analysis and apply it to measure state health system performance. Perelman and Santín (2011) address the endogeneity problem of school choice in Spain with instrumental variables. Finally, Mayen, Balagtas, and Alexander (2010), Bravo-Ureta, Greene, and Solís (2012)
                     
                        2
                     
                     
                        2
                        This paper also applies the Greene's (2010) procedure.
                      and Crespo-Cebada, Pedraja-Chaparro, and Santín (2014) apply propensity score matching to American dairy farms, farmers in Honduras and schools in Spain, respectively.

Nevertheless, the potential distortions that endogeneity may cause in the measurement of technical efficiency using nonparametric techniques have received much less attention in the literature. In principle, it might seem that DEA should not be influenced by this problem, since it constructs a boundary around feasible combinations of inputs and outputs without assuming a parametric functional form (Orme & Smith, 1996). However, if we apply insights from Kuosmanen and Johnson (2010) and interpret the DEA model as a constrained variant of the convex nonparametric least squares regression (Kuosmanen, 2008), we can derive straightforward that the same problems of bias caused by the presence of endogeneity explained above can also arise within this approach.

According to Banker (1993), the variable returns to scale DEA estimator of a production function f can be formally defined as:

                        
                           (2)
                           
                              
                                 
                                    
                                       
                                          
                                             f
                                             DEA
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             max
                                             
                                                λ
                                                ∈
                                                
                                                   ℜ
                                                   +
                                                   n
                                                
                                             
                                          
                                          
                                             {
                                             
                                                y
                                                
                                                
                                                   |
                                                   
                                                      
                                                      y
                                                      =
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         
                                                            λ
                                                            i
                                                         
                                                         
                                                            y
                                                            i
                                                         
                                                         ;
                                                         
                                                         x
                                                         ≥
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            n
                                                         
                                                         
                                                            
                                                               λ
                                                               i
                                                            
                                                            
                                                               x
                                                               i
                                                            
                                                            ;
                                                            
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  1
                                                               
                                                               n
                                                            
                                                            
                                                               
                                                                  λ
                                                                  i
                                                               
                                                               =
                                                               1
                                                               ;
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                          
                                             λ
                                             i
                                          
                                          ≥
                                          0
                                          
                                          ∀
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          
                                          n
                                          }
                                       
                                    
                                 
                              
                           
                        
                     
                  

Substituting f in
Eq. (1) by the f
                     DEA estimator, we can observe that the 
                        
                           
                              ɛ
                           
                           i
                           DEA
                        
                      efficiency scores for each unit can also be obtained as the optimal solution to the following LP problem (additive DEA efficiency measure):

                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          
                                             ɛ
                                          
                                          i
                                          DEA
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             min
                                             
                                                λ
                                                ,
                                                
                                                   ɛ
                                                
                                             
                                          
                                          
                                             {
                                             
                                                
                                                   ɛ
                                                
                                                
                                                
                                                
                                                   |
                                                   
                                                      
                                                      
                                                      y
                                                      =
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         
                                                            λ
                                                            i
                                                         
                                                         
                                                            y
                                                            i
                                                         
                                                         +
                                                         
                                                            ɛ
                                                         
                                                         ;
                                                         
                                                         
                                                         x
                                                         ≥
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            n
                                                         
                                                         
                                                            
                                                               λ
                                                               i
                                                            
                                                            
                                                               x
                                                               i
                                                            
                                                            ;
                                                            
                                                            
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  1
                                                               
                                                               n
                                                            
                                                            
                                                               
                                                                  λ
                                                                  i
                                                               
                                                               =
                                                               1
                                                            
                                                            ;
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                          
                                             λ
                                             i
                                          
                                          ≥
                                          0
                                          
                                          ∀
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          
                                          
                                          n
                                          }
                                       
                                    
                                 
                              
                           
                        
                     
                  

As Kuosmanen and Johnson (2010) set, in the single-output setting, formulation (3) is very similar to the multiplicative standard output-oriented DEA under VRS proposed by Banker, Charnes, and Cooper (1984):

                        
                           (4)
                           
                              
                                 
                                    
                                       
                                          ϕ
                                          i
                                          DEA
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             max
                                             
                                                λ
                                                ,
                                                ϕ
                                             
                                          
                                          
                                             {
                                             
                                                ϕ
                                                
                                                
                                                   |
                                                   
                                                      
                                                      ϕ
                                                      
                                                      
                                                         y
                                                         
                                                            r
                                                            i
                                                         
                                                      
                                                      ≤
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         
                                                            λ
                                                            i
                                                         
                                                         
                                                            y
                                                            i
                                                         
                                                         ;
                                                         
                                                         
                                                         
                                                         
                                                            x
                                                            
                                                               k
                                                               i
                                                            
                                                         
                                                         ≥
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            n
                                                         
                                                         
                                                            
                                                               λ
                                                               i
                                                            
                                                            
                                                               x
                                                               i
                                                            
                                                            ;
                                                            
                                                            
                                                            
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  1
                                                               
                                                               n
                                                            
                                                            
                                                               
                                                                  λ
                                                                  i
                                                               
                                                               =
                                                               1
                                                               ;
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                          
                                             λ
                                             i
                                          
                                          ≥
                                          0
                                          
                                          ∀
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          
                                          n
                                          }
                                       
                                    
                                 
                              
                           
                        
                     where xk
                      denotes input k, yr
                      stands for output r and i represents the production units. Multipliers λi
                      are referred as intensity weights of each DMU determined by the program solution. The technical efficiency score of the ith DMU is equal or greater than one, where 
                        
                           
                              
                                 ϕ
                                 ^
                              
                              i
                           
                           
                           =
                           1
                        
                      represents an efficient unit, whereas 
                        
                           
                              
                                 ϕ
                                 ^
                              
                              i
                           
                           
                           >
                           1
                        
                      indicates that the ith DMU is inefficient.

In the single-output setting formulations (3) and (4) are equivalent in the sense that 
                        
                           
                              ϕ
                              i
                              DEA
                           
                           =
                           1
                           −
                           
                              
                                 ɛ
                              
                              i
                              DEA
                           
                           /
                           
                              y
                              i
                           
                           ≥
                           1
                        
                     . In fact, the authors demonstrate in their work that the DEA problem can be interpreted as a nonparametric least-squares model under the assumption that 
                        
                           
                              
                                 ɛ
                              
                              i
                           
                           ≤
                           0
                        
                      (Kuosmanen & Johnson, 2010, p. 152). This connection between the nonparametric regressions and the mathematical programming approaches contributes to developing the statistical foundation of DEA. As a result, we can derive that DEA estimators will be consistent if all the assumptions in the least-squares regression model are fulfilled. However, in the case that ɛ
                        i
                      is correlated with at least one input, the assumption E(ɛ|X) = 0 cannot be hold and, therefore, efficiency estimates 
                        
                           
                              ϕ
                              ^
                           
                           i
                        
                      can be biased. To better understand these ideas hereinafter we graphically illustrate this problem.


                     Fig. 1
                      represents a single-input (x)/single-output (y) production setting in which true efficiency ϕi
                      is exogenously distributed, i.e., E(ϕ|X) = 0. In this scenario, the frontier estimated by DEA is very similar to the true one for the entire data range. Fully efficient DMUs are correctly identified, and efficiency is spread along the production frontier.

However, as noted above, we may well find, in real-world production processes, some kind of correlation between the true efficiency and the level of input that is significantly different from zero: E(ϕ|X) ≠ 0. This correlation can be either positive or negative, as mentioned previously in the examples of different educational settings. Fig. 2
                      illustrates the situation where endogeneity is positive, E(ϕ|X) > 0.

In this case, although microeconomic theory establishes that the input level and the true efficiency are independently distributed, the existence of this positive endogeneity can break this assumption. According to the true frontier, DMUs with higher levels of input (and outputs), e.g., dots C and D in Fig. 2, are fully efficient units, whereas DMUs with lower input levels are less efficient. However, DEA estimates relative efficiency scores based on observed data and therefore the frontier built by DEA will find and classify some DMUs that have a low input level and are really highly inefficient as efficient. This is the case of dots A and B in Fig. 2, which are actually very far away from the true frontier but are identified by DEA as efficient units. Consequently, the border estimated by DEA will be far removed from the true one in the lower input frontier region. This means that efficiency improvement targets will be more demanding for observations with a higher input level than for those with a low input level. For example, while unit E is clearly closer than unit F to the true frontier in terms of output, both units appear to have a similar estimated technical efficiency because the actual production frontier is wrongly identified. Since efficiency scores are relative measures, the misidentification of some DMUs distorts all efficiency estimates and the performance ranking. This result could have very important implications, particularly, if DEA is conducted for benchmarking and policy making.

On the other hand, the existence of a significant negative correlation between the input level and the true efficiency seems to just slightly affect DEA estimates. Fig. 3
                      illustrates this context where in terms of the true production frontier more efficient units show low input levels and more inefficient units are those with high input levels.

It is worth to note, that at the region of high input level the estimated frontier shifts slightly down from the true one. But in this case the most inefficient DMUs (those with high input level) remain far enough away from the DEA estimated frontier to be still identified as the most inefficient producers compared with other DMUs. The main reason for mantaining the high relative distance to the frontier for high input level DMUs is the monotonicity assumption in DEA estimations.
                        3
                     
                     
                        3
                        Monotonicity in production frontiers implies that an efficient DMU cannot reduce (increase) the vector of outputs (inputs) holding the vector of inputs (outputs) fixed while it still belongs to the frontier.
                     
 Monotonicity impedes DEA to pursue downwards inefficient DMUs to drawing the estimated production frontier. In addition, the negative correlation between the input and the technical efficiency provides more information to DEA in order to correctly identify and estimate DMUs efficiency. The reason is that negative endogeneity reinforces the major microeconomic assumption behind the measurement of efficiency, i.e. for a constant output level using higher level of inputs implies greater inefficiency. For instance, unit G is highly inefficient, and although the DEA frontier is closer to G than the true one, the distance between G and the estimated frontier is still large enough in terms of output to be recognized as one of the most inefficient producers. In general, inefficiency is correctly identified since all DMUs keep their relative position. Thus, it is expected that under the presence of negative endogeneity the efficiency scores estimated by DEA will better match the true relative positions, and thus the estimated ranking will not be significantly different from the true one. However, negative endogeneity could move upwards average efficiency scores because now the DEA frontier is closer to the most inefficient DMUs than the true one.

Now, the potential implications of these problems in quantitative terms have to be measured from a theoretical point of view. On this ground, we test DEA performance under endogeneity of different signs and intensity in Section 3. To do this, we simulate endogeneity through a significant positive and negative correlation between the true technical efficiency and one input.

In order to illustrate the ideas developed above, we perform a Monte Carlo experiment applied to seven scenarios. Firstly, we use a data generation process (DGP) to create a baseline dataset without endogeneity (the exogenous scenario). Secondly, we simulate six alternative settings taking into account the correlation between the true efficiency (θi
                     ) and one observed input (the endogenous scenarios). Results from each endogenous scenario are then compared to the baseline scenario in order to measure the effects that endogeneity causes on DEA estimations. All datasets were defined in a single output framework with three inputs.

Almost all previous studies in the literature have simulated data using the Cobb–Douglas production technology. For the sake of comparability, we also draw data from a Cobb–Douglas function with a single output and three inputs:

                           
                              (5)
                              
                                 
                                    ln
                                    
                                    
                                       y
                                       i
                                    
                                    =
                                    
                                       α
                                       1
                                    
                                    
                                    ln
                                    
                                    
                                       x
                                       
                                          1
                                          i
                                       
                                    
                                    +
                                    
                                       α
                                       2
                                    
                                    
                                    ln
                                    
                                    
                                       x
                                       
                                          2
                                          i
                                       
                                    
                                    +
                                    
                                       α
                                       3
                                    
                                    
                                    ln
                                    
                                    
                                       x
                                       
                                          3
                                          i
                                       
                                    
                                 
                              
                           
                        where yi
                         represents the output, and x
                        1, x
                        2 and x
                        3 are the observed inputs. The inputs weights assigned in this work where α
                        1 = 0.3, α
                        2 = 0.35 and α
                        3 = 0.35, assuming constant returns to scale.
                           4
                        
                        
                           4
                           Similar results were obtained using increasing returns to scale and decreasing returns to scale.
                         Although this functional form is the most commonly used in economics and operational research, the assumption of constant input–output elasticities probably is a significant restriction for real world estimations. This means that regardless the scale of production, the marginal effects of inputs on outputs are the same. Therefore, the Cobb–Douglas production function fails to capture potential nonlinear effects of those resources. Since the main aim of this work is to test the accuracy of DEA in an experimental setting that reproduces a more realistic context, we also consider a more flexible technology in our experimental design, namely, the translog production function introduced by Christensen, Jorgenson, and Lau (1971):

                           
                              (6)
                              
                                 
                                    ln
                                    
                                    
                                       y
                                       i
                                    
                                    =
                                    
                                       β
                                       0
                                    
                                    +
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       K
                                    
                                    
                                       
                                          β
                                          k
                                       
                                       
                                       ln
                                       
                                       
                                          x
                                          
                                             k
                                             i
                                          
                                       
                                    
                                    +
                                    
                                       1
                                       2
                                    
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       K
                                    
                                    
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          K
                                       
                                       
                                          
                                             β
                                             
                                                k
                                                j
                                             
                                          
                                          
                                          ln
                                          
                                          
                                             x
                                             
                                                k
                                                i
                                             
                                          
                                          
                                          ln
                                          
                                          
                                             x
                                             
                                                j
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where  y  denotes the output and xk
                         (k = 1, 2, 3) are the three inputs. We assume 
                           
                              
                                 β
                                 0
                              
                              =
                              3.5
                              
                              ;
                              
                              
                                 β
                                 1
                              
                              =
                              0.5
                              
                              ;
                              
                              
                                 β
                                 2
                              
                              =
                              0.3
                              
                              ;
                              
                              
                                 β
                                 3
                              
                              =
                              0.5
                              
                              ;
                              
                              
                                 β
                                 11
                              
                              =
                              −
                              0.1
                              
                              ;
                              
                              
                                 β
                                 22
                              
                              =
                              −
                              0.05
                              
                              ;
                              
                              
                                 β
                                 33
                              
                              =
                              −
                              0.1
                              
                              ;
                              
                              
                                 β
                                 12
                              
                              =
                              
                                 β
                                 13
                              
                              =
                              
                                 β
                                 23
                              
                              =
                              0.01
                           
                        . These parameters were defined in order to obtain a well-behaved production function within the bounds imposed by the inputs distribution that are uniformly distributed over the interval [5, 50]. Therefore, after having generated the data we checked for two desirable conditions at each simulated data point.

Firstly, we verify the monotonicity condition, where in a single output case requires that all marginal products must be non-negative ∂y/∂xk
                         ≥ 0∀k. For the translog production function this implies:

                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                          ∂
                                          y
                                       
                                       /
                                       
                                          ∂
                                          
                                             x
                                             k
                                          
                                       
                                    
                                    
                                    =
                                    
                                    
                                       y
                                       
                                          x
                                          k
                                       
                                    
                                    ·
                                    
                                       
                                          ∂
                                          ln
                                          y
                                       
                                       
                                          ∂
                                          ln
                                          
                                             x
                                             k
                                          
                                       
                                    
                                    
                                    =
                                    
                                    
                                       y
                                       
                                          x
                                          k
                                       
                                    
                                    
                                    ·
                                    
                                    
                                       {
                                       
                                          
                                             β
                                             k
                                          
                                          
                                          +
                                          
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             K
                                          
                                          
                                             β
                                             
                                                k
                                                j
                                             
                                          
                                          ln
                                          
                                             x
                                             j
                                          
                                       
                                       }
                                    
                                    =
                                    
                                       y
                                       
                                          x
                                          k
                                       
                                    
                                    ·
                                    
                                       s
                                       k
                                    
                                    ≥
                                    0
                                    
                                    
                                    
                                    ∀
                                    k
                                 
                              
                           
                        where y/xk
                         is the average product and sk
                         is the elasticity of y with respect to xk
                        . As the average product y/xk
                         is always positive, monotonicity implies that all input-output elasticities sk
                         must be non-negative for all DMUs across all inputs range.

Secondly, we checked for concavity in all inputs, which implies that all marginal products must be nonincreasing, i.e., the law of diminishing marginal productivity (Coelli, Prasada-Rao, O'Donnell, & Battese, 2005). For the translog production function, all inputs must satisfy the following expression across the entire simulated data range:

                           
                              (8)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      2
                                                   
                                                   y
                                                
                                                /
                                                
                                                   
                                                      ∂
                                                      2
                                                   
                                                   
                                                      x
                                                      k
                                                   
                                                
                                             
                                             =
                                             
                                             
                                                y
                                                
                                                   x
                                                   k
                                                   2
                                                
                                             
                                             
                                             
                                                [
                                                
                                                   β
                                                   
                                                      k
                                                      k
                                                   
                                                
                                                +
                                                
                                                   (
                                                   
                                                      
                                                         β
                                                         k
                                                      
                                                      −
                                                      1
                                                      +
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         K
                                                      
                                                      
                                                         β
                                                         
                                                            k
                                                            j
                                                         
                                                      
                                                      
                                                      ln
                                                      
                                                      
                                                         x
                                                         j
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             ×
                                             
                                                
                                                   (
                                                   
                                                      
                                                         β
                                                         k
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         K
                                                      
                                                      
                                                         β
                                                         
                                                            k
                                                            j
                                                         
                                                      
                                                      
                                                      ln
                                                      
                                                      
                                                         x
                                                         j
                                                      
                                                   
                                                   )
                                                
                                                ]
                                             
                                             =
                                             
                                                y
                                                
                                                   x
                                                   k
                                                   2
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                   
                                                      β
                                                      
                                                         k
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      (
                                                      
                                                         s
                                                         k
                                                      
                                                      −
                                                      1
                                                      )
                                                   
                                                   
                                                      s
                                                      k
                                                   
                                                
                                                ]
                                             
                                             
                                             
                                             <
                                             0
                                             
                                             
                                             ∀
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Finally, the selected parameters and the distribution of inputs define the production scale elasticity. We perform the simulation assuming decreasing returns to scale (DRS), where scale elasticity ranges from 0.56 to 0.97, with a mean value of 0.69. These results are consistent with most complex production processes that take place in the real world. In the field of education, for example, if the initial school input endowments are all doubled, it would be reasonable to expect a less-than-double increase in students’ test scores, particularly at high levels of educational attainment (Essid, Ouellette, & Vigeant, 2013).
                     

The baseline scenario represents the exogenous case, where all inputs are uncorrelated with the true technical efficiency, and it is simulated using the following procedure:

                           
                              1.
                              Generate randomly and independently three input vectors x
                                 1, x
                                 2 and x
                                 3 using a uniform distribution over the interval [5, 50] for N DMUs, n = 1, 2, … , N.
                              

Calculate the efficient level of output as yi
                                  = exp (ln  yi
                                 ) using ln  yi
                                  = f( · ), where f( · ) is Eq. (5) or Eq. (6) respectively.

Draw a random error term νi
                                  from a N(0; 0.04), representing the random statistical perturbation in the production function. Since the main aim of this research is to test the performance of DEA under endogeneity, we do not simulate different magnitudes of the random shocks. As it has been demonstrated in previous studies, the larger the measurement error the poorer the performance of DEA (e.g. 
                                 Bifulco & Bretshneider, 2001). Therefore, we chose a small measurement error in order to have, as in the real world, some noise but not so large that distorts the analysis of endogeneity.

Randomly and independently generate N values of ui
                                  using a half-normal distribution 
                                    
                                       
                                          u
                                          i
                                       
                                       ≈
                                       
                                       
                                          |
                                          N
                                          
                                             (
                                             0
                                             
                                             ;
                                             
                                             0.25
                                             )
                                          
                                          |
                                       
                                    
                                  and compute the vector ϕi
                                  = exp (ui
                                 ). Then, compute the true technical efficiency level for each DMU 
                                    
                                       0
                                       ≤
                                       
                                          θ
                                          i
                                       
                                       =
                                       
                                          1
                                          
                                             ϕ
                                             i
                                          
                                       
                                       ≤
                                       1
                                    
                                 .

Compute the observed output as: 
                                    
                                       
                                          
                                             y
                                             ^
                                          
                                          i
                                       
                                       =
                                       
                                          y
                                          i
                                       
                                       ·
                                       exp
                                       
                                          (
                                          
                                             v
                                             i
                                          
                                          )
                                       
                                       ·
                                       
                                          θ
                                          i
                                       
                                    
                                 .

The remaining six scenarios were developed through a similar DGP, but taking into account the existence of endogeneity, which was modeled through the Pearson's correlation coefficient between the true technical efficiency θi
                         and one observed input. Therefore, in each dataset we substitute the exogenous input x
                        3 by an endogenous input E. In order to compute the latter with the same distribution as the exogenous inputs (x
                        1, x
                        2, x
                        3) and with a specific level of correlation with  θi
                        , for each endogenous scenario we follow the next procedure:

                           
                              1.
                              Select the desired Pearson's correlation coefficient ρ
                                 
                                    E, θ
                                  between the endogenous input E and the true technical efficiency θ.

Draw a random matrix A = (a
                                 1, a
                                 2) from a multivariate normal distribution 
                                    
                                       N
                                       
                                          (
                                          0
                                          
                                          ;
                                          
                                          Σ
                                          )
                                       
                                       ,
                                       
                                       
                                       where
                                       
                                       Σ
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      ρ
                                                      
                                                         E
                                                         ,
                                                         θ
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ρ
                                                      
                                                         E
                                                         ,
                                                         θ
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 .

Compute an identification number variable (ID) from 1 to N.
                              

Match the ID with the vector a
                                 1 obtaining: B = [ID 
                                 a
                                 1]. Sort B by a
                                 1 in an ascending order (the ID variable will be unsorted): B' = [ID
                                 
                                    a1 
                                 a
                                 1].

Generate an independent vector x
                                 (n × 1) from a uniform distribution over the interval [5, 50] and sort it in an ascending order obtaining xs
                                 .

Compute a new C matrix by merging B′ with xs: C = [ID
                                 
                                    a1 
                                 a
                                 1 
                                 xs
                                 ].

Sort C by the ID variable in an ascending order:
                                    
                                       
                                          C
                                          ′
                                       
                                       =
                                       
                                          [
                                          I
                                          D
                                          
                                          
                                             a
                                             
                                                1
                                                _
                                                I
                                                D
                                             
                                          
                                          
                                          
                                             x
                                             
                                                I
                                                D
                                             
                                          
                                          ]
                                       
                                    
                                 .

The latter vector of C′(x
                                    ID
                                 ), will be defined as the endogenous input, E = xID
                                 .

Match ID with the vector a
                                 2 obtaining: D = [ID 
                                 a
                                 2]. Sort D by a
                                 2 in an ascending order (the ID variable will be unsorted): D' = [ID
                                 
                                    a2 
                                 a
                                 2].

Randomly and independently generate N values of ui
                                  using a half-normal distribution 
                                    
                                       
                                          u
                                          i
                                       
                                       ≈
                                       
                                       
                                          |
                                          N
                                          
                                             (
                                             0
                                             
                                             ;
                                             
                                             0.25
                                             )
                                          
                                          |
                                       
                                    
                                 . Then, compute the vector ϕi
                                  = exp (ui
                                 ) and sort this variable in an ascending order obtaining ϕs
                                 .

Compute a new H matrix by merging D′ with es: H = [ID
                                 
                                    a2 
                                 a
                                 2 
                                 ϕs
                                 ].

Sort H by the ID variable in an ascending order: 
                                    
                                       
                                          H
                                          ′
                                       
                                       =
                                       
                                          [
                                          I
                                          D
                                          
                                          
                                             a
                                             
                                                2
                                                _
                                                I
                                                D
                                             
                                          
                                          
                                          
                                             ϕ
                                             
                                                I
                                                D
                                             
                                          
                                          ]
                                       
                                    
                                 .

The latter vector of H′(ϕID
                                 ), is used to computed the true technical efficiency level for each unit,
                                    
                                       
                                       
                                          θ
                                          i
                                       
                                       =
                                       
                                          1
                                          
                                             ϕ
                                             
                                                I
                                                D
                                             
                                          
                                       
                                    
                                 . The generated average true efficiency in each experiment ranges from 0.828 to 0.859 with standard deviations values between 0.097 and 0.116.

Using the exogenous inputs x
                                 1 and x
                                 2 generated in the baseline scenario and the endogenous input E, compute the efficient level of output as yiend
                                  = exp (ln  yiend
                                 ) using ln  yiend
                                  = f( · ), where f( · ) is Eq. (5) or Eq. (6) respectively.

Finally, calculate the observed output using the random term νi
                                  computed in the baseline dataset and the true efficiency level  θi
                                  computed in step 13: 
                                    
                                       
                                          
                                             y
                                             ^
                                          
                                          
                                             i
                                             e
                                             n
                                             d
                                          
                                       
                                       =
                                       
                                          y
                                          
                                             i
                                             e
                                             n
                                             d
                                          
                                       
                                       ·
                                       exp
                                       
                                          (
                                          
                                             v
                                             i
                                          
                                          )
                                       
                                       ·
                                       
                                          θ
                                          i
                                       
                                    
                                 .

Two factors were allowed to vary in order to generate the six endogenous settings: the sign (negative or positive) and the intensity (high, medium or weak) of the correlation coefficient between the true efficiency and the endogenous inputs (ρ
                        
                           θ, E
                        ). Table 1 summarizes the main descriptive statistics of the correlation coefficients that have been actually obtained in each simulated scenario.
                           5
                        
                        
                           5
                           The correlation coefficients were computed in each experiment and then averaged to obtain the final measures presented in Table 1.
                        
                        
                        
                     

All scenarios were replicated using the Cobb–Douglas and the translog technologies for a sample size of 100 DMUs. Finally, for each dataset, we estimate the efficiency scores 
                           
                              
                                 θ
                                 ^
                              
                              i
                           
                         by running an output oriented DEA model under constant and variable returns to scale (CRS and VRS), as proposed by Charnes, Cooper, and Rhodes (1978) and Banker, Charnes, and Cooper (1984) respectively. As a result, 28 scenarios were analyzed (the exogenous scenario, six types of endogeneity, two production technologies and two types of return to scale). In order to make the results more reliable, we ran a Monte Carlo experiment, where B, the number of replicates, was 1000.
                           6
                        
                        
                           6
                           Simulations were carried out using MATLAB 7.6.0 software.
                        
 Consequently, all measures were computed in each replication and, finally, averaged to yield the results reported in Section 4.

@&#RESULTS@&#

In order to test the adequacy of DEA under endogeneity, we present a set of accuracy measures. Firstly, we are interested in measuring how accurately DEA ranks observations. For this purpose, we compute Spearman's rho (rs
                        ) correlation coefficients between the true efficiency and estimated score pairs. The higher the correlation coefficient rs
                         the better DEA is able to identify the true efficiency distribution.

Secondly, we are interested in testing how well the model estimates the true level of efficiency. For this purpose, we calculate the mean absolute error (MAE), 
                           
                              MAE
                              =
                              
                                 1
                                 N
                              
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 N
                              
                              
                                 
                                    |
                                 
                                 
                                    
                                       θ
                                       ^
                                    
                                    i
                                 
                                 −
                                 
                                    θ
                                    i
                                 
                                 
                                    |
                                 
                              
                           
                         which is the result of computing and averaging the sum of absolute deviations of DEA estimated scores from the true efficiency level for each observation. A low MAE implies that, on average, the estimates are near to the true efficiency values, and hence small values are preferred.

Finally, following Bifulco and Bretschneider (2001), we present a performance measure based on a quintile analysis. Observations were first divided into quintiles according to their true efficiency score. We then examined how well the technique was able to place observations in the appropriate quintile. Using this complementary measure we can evaluate the DEA accuracy at different points of the distribution, and hence it is a useful tool for detecting the main drawbacks of the technique. All Monte Carlo results are reported in Tables 2 and 3 for data generated from the Cobb–Douglas and translog production technologies, respectively, assuming both CRS and VRS.

The results confirm that DEA performs well in the exogenous case regardless of the production function or the returns to scale assumed.
                           7
                        
                        
                           7
                           These results about the behavior of DEA in the exogenous scenario are similar to those obtained by Krüger (2012) who employed a similar DGP. In this case, DEA performance is slightly better because the DGP has two inputs instead of three as in our case. As it was pointed out by Pedraja-Chaparro et al. (1999) under the same scenario DEA results deteriorate when the number of inputs increases.
                        
 However, as expected, DEA–CRS estimates outperform DEA–VRS for data generated with a Cobb–Douglas production function and vice versa for data derived from the translog DGP. For example, under the Cobb–Douglas assumption, Spearman's correlation coefficients between the true and estimated efficiency are 0.783 under CRS and 0.672 under VRS, whereas these figures are 0.666 and 0.729, respectively, for the translog DGP. This finding remarks the importance of making a correct choice of the assumed returns to scale before conducting an empirical DEA efficiency analysis. In view of this evidence, we will now refer to DEA–CRS for the results estimated from the Cobb–Douglas and to DEA–VRS results for the translog scenarios.

Results from the quintile analysis also confirm that DEA performs adequately in the exogenous case. Only about one out of every eight units is assigned to a quintile that is two or more quintiles removed from where they should be. We can find that DEA's major weakness lies in its ability to correctly identify the most efficient DMUs. Also, the percentage of units which should really be in the top two quintiles and are actually placed in the bottom quintile is close to zero; but this figure rises to 7 percent and to 12.5 percent for observations that should really be in the bottom quintile and are assigned to the top quintile for CRS and VRS, respectively. This evidence should be taken into account especially if DEA is conducted for the purpose of performance-based reforms. In this case, some units which are not actually benchmarks would be identified as such.

The accuracy of DEA under endogeneity depends on the direction and intensity of the correlation between the endogenous input and the true technical efficiency. However, the overall effects on CRS and VRS estimates are similar, being more pronounced in the case of VRS than for CRS. This performance can be explained by the fact that the technique is more sensitive to changes in the data distribution under VRS than under CRS assumptions. Given that VRS is a more realistic and frequent assumption in real-world applications and conclusions are similar for both types of returns to scale, we will discuss results for DEA–VRS more in depth (Table 3). Results are also reported for CRS.

The main finding from our simulations is that high and positive endogeneity is the worst possible scenario, shattering DEA performance. As the intensity of positive endogeneity decreases to medium, DEA results improve but remain still poor compared with the exogenous set. Finally, for low positive endogeneity, DEA estimations are very close to baseline scenario values. As Table 3 shows, the exogenous dataset simulations yield a Spearman's correlation coefficient of 0.729 between estimated and actual efficiency, which drops to 0.265 in the presence of high positive endogeneity and to 0.594 in the case of medium positive endogeneity. The MAE underscores this result. The value of MAE in the worst scenario climbs to 0.123, which is significantly greater than the 0.072 calculated in the baseline one. This fact confirms what we have discussed previously in the graphical analysis, the DEA overestimates the true mean technical efficiency under both types of endogeneity (negative and positive), particularly when the input and the efficiency are highly correlated.

The damage caused by endogeneity can also be evaluated by means of the proportion of units assigned to the correct quintile by DEA. According to Table 3, the proportion of units assigned two or more quintiles from actual triplicates the baseline percentage (increasing from 13.4 percent to 38.4 percent) in the case of high positive endogeneity. These figures also indicate that this decline in DEA performance is further driven by the fact that the technique identifies several of what are really the most inefficient units as efficient. Under a high and positive correlation between true efficiency and one input, only one third of units assigned by DEA to the bottom quintile were actually in the bottom quintile, whereas the equivalent percentage was as high as 74.7 percent in the exogenous scenario. In addition, the percentage of DMUs placed in the top quintile when they should actually have been in the bottom two quintiles triples the baseline scenario values. These results confirm that, at low levels of the endogenous input, the frontier estimated by DEA (which is driven by the data shape) is located farther from the true frontier, identifying quite a lot of inefficient units as very efficient, as illustrated in Fig. 2.

DEA efficiency scores are relative measures. Therefore, the misidentification of the true frontier at low levels of input leads to inaccurate estimated scores for all observations. This implies that such endogeneity also degrades DEA's ability to correctly identify the most efficient DMUs. For instance, whereas no units that should actually be ranked in the top two quintiles are found to be assigned to the bottom quintile in the absence of endogeneity, 12.6 percent
 of DMUs are wrongly ranked in the bottom quintile under high positive endogeneity.

Finally, under low and medium negative endogeneity, Monte Carlo simulations evidence that DEA estimates remain robust. Estimations appear to be slightly impaired only in the scenario where negative endogeneity is high. These results are similar to findings by Bifulco and Bretschneider (2003), who conclude, for the same measurement error level as our simulation, that DEA performance is not substantially affected by the negative endogeneity. This finding can be explained by the fact that negative endogeneity correlates input and efficiency in the same way as DEA assumes to plot the frontier (i.e., the higher the input level, the lower the efficiency score). Consistently, estimates are unaffected by this kind of endogeneity.

In summary, we can conclude from our results that DEA–CRS and DEA–VRS provide accurate efficiency measures in all scenarios but when there is a medium or high positive correlation between one input and the true efficiency. Note again that DEA estimates will be far removed from the actual efficiency values in the presence of a high positive endogeneity regardless of the assumed functional form. This result is worthy of mention since such endogenous scenarios are similar to the ones that are likely to be found in public sector efficiency analysis applications (due to a two-way causality or an omitted variable). Therefore, this evidence suggests that, unless the presence of endogeneity is taken into account, the use of DEA models to estimate technical efficiency could, in such cases, impair efficiency estimates and thus result in inappropriate recommendations.

@&#CONCLUSIONS@&#

The endogeneity problem and the distortions in the estimation of efficiency and production models that it causes is a growing concern in the frontier analysis field. As a result, some research has started to use conventional econometric approaches to deal with endogeneity in the estimation of production frontiers using parametric techniques. Nevertheless, the effects of endogeneity on efficiency estimates obtained with nonparametric frontier methods like DEA have received less attention in the literature.

In this paper, we analyze to what extent the presence of endogeneity in the production process can bias DEA estimates. For this purpose, we simulate different levels of negative and positive endogeneity through the correlation between one input and the true technical efficiency using synthetic data generated in a Monte Carlo experiment. We conduct the analysis using a Cobb–Douglas production technology as well as a more flexible translog specification.

We conclude that DEA is robust to the presence of negative and low positive endogeneity. However, a high and medium positive endogeneity, i.e., a high or medium positive correlation between one input and the true efficiency level, significantly biases DEA performance. For example, while for the translog production function in the exogenous scenario DEA–VRS yields a Spearman's correlation coefficient of 0.729 between the estimated and actual efficiency, this correlation drops to 0.594 in the case of medium positive endogeneity and to 0.265 in the presence of high positive endogeneity. We find that this decline in DEA performance is further driven by the misidentification of the most inefficient DMUs. This evidence shows that it is necessary to be extremely cautious if DEA is applied for the purpose of performance-based reforms, because many units which should not be considered as benchmarks for comparison could be wrongly identified as such.

Therefore, the main derivation of this paper is to caution DEA practitioners concerning the accuracy of their estimates when they suspect that there might be some significant positive endogeneity in real world problems. Defining a method to detect and to deal with the presence of significant endogeneity in empirical applications falls beyond the scope of the present research, although it remains as a logical next challenge for future research.

@&#ACKNOWLEDGMENTS@&#

This paper owes a debt to Timo Kuosmanen for their valuable comments and encouragement. We are grateful to participants at 13th European Workshop on Efficiency and Productivity Analysis for their comments. We also thank two anonymous referees for helpful discussions and suggestions. Gabriela Sicilia thanks research grants from the Fundación Carolina and Agencia Nacional de Investigación e Innovación. Research support from the Extremadura Government (Project IB13106) is also acknowledged by José Cordero and Daniel Santín.

@&#REFERENCES@&#

