@&#MAIN-TITLE@&#Patient non-specific algorithm for seizures detection in scalp EEG

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           It reduces the time spent by physicians in the visual inspection of long term EEG records.


                        
                        
                           
                           It is patient non-specific, so it can be applied to new records that have not been presented to the algorithm.


                        
                        
                           
                           Its performance is comparable with other more complicated algorithms.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Epilepsy

Seizure

Detection

EEG

@&#ABSTRACT@&#


               
               
                  Epilepsy is a brain disorder that affects about 1% of the population in the world. Seizure detection is an important component in both the diagnosis of epilepsy and seizure control. In this work a patient non-specific strategy for seizure detection based on Stationary Wavelet Transform of EEG signals is developed. A new set of features is proposed based on an average process. The seizure detection consisted in finding the EEG segments with seizures and their onset and offset points. The proposed offline method was tested in scalp EEG records of 24–48h of duration of 18 epileptic patients. The method reached mean values of specificity of 99.9%, sensitivity of 87.5% and a false positive rate per hour of 0.9.
               
            

@&#INTRODUCTION@&#

Epilepsy is a brain disorder that affects about 1% of the world population and is characterized by intermittent abnormal firing of neurons in the brain, which may lead to recurrent and spontaneous seizures. Approximately 30% of the epileptic population is not helped by medications [1]. An epileptic seizure is a transient occurrence of signs and/or symptoms due to abnormal excessive or synchronous neuronal activity in the brain [2,3].

Electroencephalography (EEG) is the standard technique to record electrical brain activity in patients with neuro-pathologies. When epileptic activity begins, synchronized and abnormal electrical activity in a small area of the brain is observed [4]. Consequently, this process is reflected in the EEG record as a seizure. The seizure detection is an important component in the diagnosis of epilepsy and for the seizures control, especially for those patients with refractory (intractable) epilepsy.

On one hand, this detection basically involves visual scanning of long electroencephalographic EEG recordings by the expert physicians in clinical practice. This procedure is done to identify and classify the seizure activity present in the EEG signal. Usually, the records are multichannel ones, lasting 24 to 72h, so their inspection implies a very time-consuming task. 
                     Fig. 1 shows 30s of a multichannel EEG record, a 14s seizure (marked by an expert) is indicated with red lines.

On the other hand, an automatic seizure detection system can considerably reduce the volume of data to be observed by the physicians. Thus they could focus their attention on those parts of the EEG records having seizures. Consequently a more precise, swifter diagnosis can be made.

Onset seizure detection is a useful tool for treatments such as timely drug delivery, electrical stimulation and seizure alert systems. Numerous processing techniques have been proposed for automatic seizure detection, quantification and recognition [5]. Some researchers used chaotic features (such as entropies) to evaluate the degree of disorder present in the epileptic signal [6]. Others proposed features from time–frequency domain [7]. Another technique used is the multi-way analysis, which is based on feature tensors to identify seizures [8]. Wavelet Transform (WT) has been widely used in the epilepsy detection [9,10]. In recent years the Empirical Mode Decomposition (EMD) technique has been implemented for epileptic seizure detection as well [11,12]. In Mohammad et al. [13] the EMD and other different transformation techniques like discrete cosine transformation, discrete wavelet transformation and singular value decomposition are used in the analysis of epileptic EEG signals. Zhu et al. [14] proposed a fast weighted horizontal visibility graph constructing an algorithm to identify seizures from EEG signals. A comprehensive review of the majority of the techniques applied to epileptic seizure detection on EEG signals can be accessed in [15].

Long EEG records are visually analyzed by the specialists searching for seizures. This task takes several hours. The aim of this study is to automatically detect epileptic seizures in long EEG records, in order to reduce the visual inspection time and additionally, to achieve an accurate diagnosis. For this purpose an offline seizure detection strategy based on new energy features extracted from Stationary Wavelet Transform (SWT) is developed. The onset and offset points of the seizures are also determined. The strategy proposes a pediatric patient non-specific method introducing a spatial average of features.

In this work the CHB-MIT scalp EEG database was used, which is available free at http://physionet.org/physiobank/database/chbmit/ 
                     [16]. This database, collected at the Children׳s Hospital Boston, is composed of EEG recordings from pediatric subjects with intractable seizures. Recordings were collected from 22 subjects (5 males, ages 3–22; and 17 females, ages 1.5–19), grouped into 23 cases (case 21 belongs to case 1 1.5 years later). Each case contains between 9 and 42 continuous files from a single subject. In most cases, the files contain one hour of digitized EEG signals, several files with seizures contain more than one seizure. All signals were sampled at 256Hz with 16-bit resolution. Most files contain 23 EEG channels. The international 10–20 system of EEG electrode positions and nomenclature was used for these recordings. In the current study the cases with the same bipolar configuration were used, corresponding to 18 patients. The details of the analyzed EEG records are shown in 
                     Table 1.

@&#METHODS@&#

In this section the detection method is detailed. It includes the stages of filtering and segmentation, SWT computation, features extraction, features selection and seizure detection. In 
                     Fig. 2a block diagram of the process is shown. The patient non-specific validation is also described.

All EEG records were band-pass filtered with a second order, bidirectional, Butterworth filter bandwidth of 0.5–30Hz [17]. Then each EEG file of 23 channels and 1 hour duration was divided into segments of 2 seconds (series of 512 samples each). Thus, each channel was segmented into 1800 segments.

Channels 15 and 23 present the same bipolar combination, so channel 23 was discarded to avoid the introduction of redundant information.

After filtering and segmentation the SWT was computed. The SWT is also known as time invariant orthonormal wavelet representation; it can be obtained modifying the basic scheme of the discrete wavelet transform (DWT) [18]. The time invariance in SWT algorithm is achieved by removing the down sampling stages of DWT and replacing them by up sampling the filter coefficients at each stage. This process consists in interpolating zeros in the output sequences of the low and high pass filters of the algorithm. Thus, the output of each level of decomposition has the same number of samples as the original signal [19].

In this study, the Wavelet mother used was Daubechies order 4 with 6 levels of decomposition. The SWT was calculated for each segment of 2s. Hence, for each channel 6 decomposition levels or bands (D1, D2, D3, D4, D5, D6 and A6) were obtained. In 
                        Table 2 the bandwidth of Wavelet Filters for a sampling frequency of 256Hz are shown. The levels of interest are D3, D4, D5, D6, due to their frequency content that approximately matches brain rhythms β: 13–30Hz, α: 8–13Hz, θ: 4–8Hz and δ: 0.5–4Hz [17].

For each selected band and for each channel the spectral and the energy features were computed.

The spectral features were calculated using the power spectral density (PSD) of EEG signals. Hence, PSD of D3 to D6 series was estimated by the Burg method order 16 [20]. Then, Mean and Peak Frequencies (MF and PF) were calculated on the PSD. Thus 8 spectral feature series are obtained (4 levels×2 features).

For energy features computation first the energy of each level Ei was calculated as in (1).
                           
                              (1)
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          i
                                       
                                    
                                    
                                    (
                                    m
                                    )
                                    =
                                    
                                       1
                                       L
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                n
                                                =
                                                (
                                                m
                                                −
                                                1
                                                )
                                                L
                                                +
                                                1
                                             
                                             
                                                m
                                                L
                                             
                                          
                                          
                                             
                                                
                                                   [
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                   
                                                   (
                                                   n
                                                   )
                                                   ]
                                                
                                                2
                                             
                                          
                                       
                                    
                                    
                                    i
                                    =
                                    1
                                    ,
                                    ....
                                    .
                                    ,
                                    6
                                 
                              
                           
                        where i is the decomposition level of the SWT, n is the sample number, m is the analyzed segment and L= 512 samples (2s) is the segment length.

Then the relative band energy (Er) was computed as in (2) for decomposition levels D3 (Er3) to D6 (Er6).
                           
                              (2)
                              
                                 
                                    
                                       E
                                       
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                    (
                                    m
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          m
                                          )
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                6
                                             
                                          
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             m
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Therefore, a total of 264 features are obtained for each 2s EEG segment, 176 (22ch×8 features) frequency features and 88 (22ch×4 features) energy features.

Based on the proximity of the electrodes a spatial average of features is proposed. For this purpose the bipolar channels located as shown in 
                        Fig. 3 were taken by zones: Left Anterior (LA) zone (channels 1, 2, 5, 6, and 20); Right Anterior (RA) zone (channels 9, 10, 13, 14 and 22); Left Posterior (LP) zone (3, 4, 7, 8 and 19); Right Posterior (RP) zone (channels 11, 12, 15 and 16); Central zone (C) channels 17 and 18) and Channel 21 (C21). For example, for LA zone the average between MF of channel 1, MF of channel 2, MF of channel 5, MF of channel 6 and MF of channel 20 is obtained so the new feature is called MF_LA. The same procedure was performed for the other features and zones. Therefore, the new set has 72 features, much fewer than the original 264.

A stepwise analysis was implemented to find the minimal vector of features that best classifies epileptic seizures. This method is based on the statistical parameter Lambda of Wilks (WL). In this case WL is applied considering features belonging to 2 groups: group of seizure segments and the non-seizure one. Those features or discriminator variables are the 72 obtained in Section 3.3.

WL measures the ratio of within-group variability respecting the total variability on the discriminator variables, and is a measurement of the importance of the functions. In this inverse measurement scale, values close to 1 indicate that almost all of the variability in the discriminator variables originates from within-group differences (i.e., differences between cases in each group), whereas values close to 0 indicate that almost all of the variability in the discriminator variables is due to group differences [21].

The WL, in a p-dimensional space constructed with p variables and with the matrixes B
                           p×p
                         and W
                           p×p
                         can be defined as the ratio between their determinants [22] as can be seen in (3):
                           
                              (3)
                              
                                 
                                    
                                       WL
                                    
                                    
                                       =
                                    
                                    
                                       
                                          |
                                          
                                             W
                                          
                                          |
                                       
                                       
                                          |
                                          
                                             
                                                B
                                             
                                             
                                                +
                                             
                                             
                                                W
                                             
                                          
                                          |
                                       
                                    
                                 
                              
                           
                        where B and W are matrixes whose elements represent the square sum and cross products within-groups and between groups, respectively. Then, the value of WL is transformed into the general multivariate statistical F, which allows contrasting significant differences between groups [23]:
                           
                              (4)
                              
                                 
                                    F
                                 
                                 
                                    =
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          −
                                       
                                       
                                          g
                                       
                                       
                                          −
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          g
                                       
                                       
                                          −
                                          1
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                1
                                                −
                                             
                                             
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         s
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         s
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        where n, g and s are the number of cases, groups and selected variables respectively; Λs
                         is the WL before adding a new variable, and Λ
                        
                           s+1 results after adding that variable. To accept a variable in the analysis, the F value must be higher than 3.84 (namely, “F to enter”) and, once included, the variable is rejected if its F value is smaller than 2.71 (namely, “F to exit”) [23]. This selection features method was successfully applied in other areas such as brain–computer interface [24].

Due to the fact that the quantity of seizure-free segments is much higher than the seizure ones (unbalanced problem), 10 balanced sets of features were constructed and the stepwise method was applied to each one. Then those common features (26 out of 72) to all the sets (selected by the method) were chosen to be used in the classification stage and are listed in 
                        Table 3.

Two detection methods are proposed, one based on linear discriminant analysis (LDA) and other based on neural networks (NNs). Therefore, using the selected features in the previous step the seizures segments are detected.

The linear discriminant analysis (LDA) is based on a linear combination of the discriminant variables (selected features) allowing to maximize the differences between groups and minimize the differences within-group. Those linear combinations are known as classification functions. In this case of study there are two functions, one for the seizure class and the other for the non-seizure class.

The discriminant variables are the 26 listed in Table 3. Since the set of data constitutes an unbalanced problem, it was balanced. The LDA was performed using 70% of the balanced data set as a training group and the remaining 30% as a testing group. The cases included in these proportions were randomly selected and the complete procedure was carried out 10 times, obtaining the classification functions.

A pattern recognition neural network (PRNN) with Bayesian regulation was selected for seizure detection. The architecture of this NN is a feed forward multilayer perceptron. The features of Table 3 were the network inputs and the states of seizure (state 1) or non- seizure (state 0) were the outputs of the system. In order to obtain the best adjustment of the network weights, 70% of the balanced data set were randomly selected as a training group and the remaining 30% as testing group; this was carried out 10 times. The best combination of weights was selected for the classification task.

The LDA and NN based classifiers were fed with the selected features (corresponding to the signal segments) chronologically ordered. Then the onset and offset points of the algorithm detections are determined as is explained in the section showing results.

In order to evaluate the performance of the method as a patient non-specific one; a new classification strategy is proposed. In this case, the classifier was adjusted using all the EEG segments except the EEG segments that belong to one specific patient. Then, the classifier is evaluated over a new patient, thus the leave-one-patient-out validation scheme is proposed.

This process is performed for all patients (18 times). Only the LDA classifier was used because it achieved the higher results in the previous stage (Section 3.5).

@&#RESULTS@&#

The proposed method was applied to a total of 275,048 segments of 2s of duration, 3267 of them are seizure segments, corresponding to 18 pediatric patients with intractable epileptic seizures.

To evaluate the performance of the proposed methods in detecting seizures a set of indexes is defined.

The algorithm flags detections that last at least 10s. A positive detection (PD) is reported when flagged by the algorithm, but all the detections within a 60s period are grouped so that continuous bursts of positive detections are not over represented [25].
                        
                           
                              
                                 True positives
                               
                              (TP): They are reported when a PD occurs within the time marked as a seizure by human expert. Only one TP per seizure is reported.


                              
                                 True negatives
                               
                              (TN): Those no seizures segments reported as such by the algorithm.


                              
                                 False negatives
                               
                              (FN): All no detected seizures.


                              
                                 False positives
                               
                              (FP): Detections occurring out of the TP period.

With these indexes the parameters of sensitivity (SEN) and specificity (SPE) are computed [26]. SEN represents the seizure proportion correctly classified by the algorithm and SPE is the percentage of no seizure cases identified by the method.

The indexes of latency and false positive rate are also used and are defined as follows [25,27]:
                        
                           
                              
                                 Detection delay or Latency
                               
                              (Lat): Measures the time it takes for a detector to identify a seizure after its electrographic onset. In this way, positive values of latency denote algorithm detections before the marks of specialist.


                              
                                 False positive rate
                               
                              (FPR/h): Gives information about the quantity of FP per unit of time. This index is calculated as: FP/time free of seizure.

The time limits of the detections are determined on the data chronologically ordered. Then the first PD belonging to the TP period is detected as the onset point. Similarly, the last PD belonging to the TP period is detected as the offset point of the seizure.


                     
                     Table 4 shows the values of the performance indexes for the LDA and NN based detectors. The indexes are expressed as the mean value of the 10 running times; additionally for the Lat the maximum and minimum values are given. The LDA detector reached average values of SPE=99.99%, SEN=92.6% and a FPR/h=0.3. For the NN detector the indexes were SPE=99.7%, SEN=79.9% and a FPR/h=3.9 in average. From the last row of Table 4 it is clear that the LDA detector demonstrates superior values of SPE and SEN than the NN one. The FPR/h is also better for the LDA classifier, this index is less than 1 in almost all cases.

In 
                     Table 5 the performance for the patient non-specific validation is reported. Values of SPE, SEN and FPR/h for each patient of validation stage are shown. The Lat is expressed as the mean value of all the patient seizures, and the maximum and minimum values are also reported. The performance indexes were calculated for each individual patient in the validation step.

@&#DISCUSSION@&#

This paper proposes an algorithm, which is a clinical tool that aids in achieving more accurate and swifter diagnosis of the patient. The capability of the detector to correctly identify an epileptic seizure is measured by the SEN value; on the other hand, the SPE value measures the proportion of negatives which are correctly detected as such. Therefore, the best situation is detecting seizures with a high SEN, i.e., the algorithm should detect all the seizures. Moreover, a high SPE and a low FPR/h will reduce the effort required from the physician in rejecting false detections.

With the aim of finding the best and most accurate method to detect epileptic seizures two classifiers were proposed: one based on linear discriminant analysis (LDA) and other based on neural networks (NNs). Table 4 shows the values of the performance indexes for both detectors. The mean value of SEN=92.6% of the LDA detector is higher than the mean SEN=79.9% of the NN classifier. Additionally, the first detector reaches a higher value of SPE (99.9%) and a lower value of FPR/h (0.3) than the second one. Therefore, the LDA classifier is more robust and reliable than the NN classifier. Besides, the values of latency yield more accuracy for LDA.

In epileptic seizure detection research, the performance is evaluated according to the framework of the application. Hence, the exact onset and offset time point detection of a seizure is crucial for a system designed to stop a seizure once it has started, as in timely drug delivery or electrical brain stimulation. In other applications such as seizure alert systems, the desirable condition is an early detection of the beginning of the seizure as well as its culmination. Additionally, the ambiguity between the onset and ending marks of a seizure, by human experts is known. In this study, the onset/offset points are detected with a mean detection delay of 0.2s and −4s, respectively, for LDA (Table 4). For the patient non-specific validation the mean latency is 1.3s for onset and 3.7s for the offset (Table 5). These values are comparable with differences among human specialists.

In the epileptic seizure detection area, some authors have used the CHB-MIT scalp EEG database for their research. Shoeb et al. [17], proposed a method based on machine learning that has a training stage for each patient obtaining mean values for SEN of 96%, a Lat of 4.6s and a FPR of 2/24h. Khan et al. [28,29], proposed seizure detection based on features of kurtosis, skewness and coefficient of variation from the decimate Discrete Wavelet Decomposition of 5 and 10 patients. They reached mean values for SEN of 83% and SPE of 100% and 100% of SEN in the second one (SPE was not reported) respectively. Kim et al. [30], calculated the entropies of 7 patients to detect seizures; showing a SEN=100–94%, FPR of 2/h–0.9/h and a Lat=13s–18s. The method is also patient-specific. Ahamad et al. [31], proposed a method of automatic detection of epileptic seizure event and onset using decimate Discrete Wavelet Decomposition and interquartile range and mean absolute deviation without wavelet decomposition. For the records of CHB-MIT, they reported a mean sensitivity of 98.5% with an average latency of 1.76s.

From the cited researchers it should be mentioned that all the studies are patient specific, i.e. they trained a classifier for each patient tested. This is a controversial point in automatic epilepsy research. On the other hand, a patient non-specific detector is set with certain fixed parameters and no extra training is needed for new patients. In this sense there is a trade-off between performance, simplicity and swiftness in the seizure detection. In the current study a patient non-specific detection method was proposed. The detector performance was evaluated with each new testing patient (for the 18 patients). This validation stage obtained mean values of SEN=87.5%, SPE=99.9%, FPR/h=0.9 and a mean onset and offset latency of 1.3s and 3.7s respectively. In Table 5 the values of performance of all patients are shown. For patient#19 the SEN is 50% since this patient has only two seizures and only one is detected. If this patient is left out the value of SEN for the patient non-specific method increases to 89.7%. Therefore, the current method correctly classifies almost the 90% of the seizures. This value is comparable with those patient specific ones [28–31]. Moreover, the values of FPR/h and Lat of the proposed method are very similar to the others. Hence, the algorithm can successfully detect seizures, its implementation is simple and swift since it does not need training for every new patient. Therefore, the current algorithm can be evaluated in other databases and its performance should be suitable for clinical applications.

@&#CONCLUSIONS@&#

This paper presents an automatic algorithm that is able to detect epileptic seizures in long-term EEG records for clinical applications. The off line method is based on spectral and energy features extracted from the SWT of pediatric EEG signals. The current study proposed a spatial average of features which, on one hand, enables reducing the number of variables in the analysis. Conversely, it could allow the identification of seizures from different parts of the brain.

The detection strategy is able to discriminate EEG signals with and without seizures reaching high values of SEN and SPE. Its implementation is simple and swift because it does not require training for every new patient. Before its clinical application, the detector could be tested on another EEG database to continue evaluating its performance.

None declared.

@&#ACKNOWLEDGMENTS@&#

This work has been supported by grants from Consejo Nacional de Investigaciones Científicas y Técnicas (CONICET), Universidad Nacional de San Juan (UNSJ) and the Secretaría de Ciencia, Tecnología e Innovación (SECITI) de San Juan, all institutions originating from Argentina.

@&#REFERENCES@&#

