@&#MAIN-TITLE@&#Implementation of density-based implicit LU-SGS solver in the framework of OpenFOAM

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Implicit steady and dual-time LU-SGS solver is implemented in OpenFOAM.


                        
                        
                           
                           The implementation codes of the sweep process in LU-SGS approach are introduced.


                        
                        
                           
                           Typical test cases are used to investigate the performance of LU-SGS solver.


                        
                        
                           
                           Convergence performance of LU-SGS solver is superior to original explicit solver.


                        
                        
                           
                           The LU-SGS solver is significantly more efficient than original explicit solver.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OpenFOAM

Density-based

Dual-time

Implicit

LU-SGS

Numerical

@&#ABSTRACT@&#


               
               
                  In this paper, in the framework of OpenFOAM, the density-based steady and unsteady dual-time implicit LU-SGS solvers which are termed as lusgsFoam and lusgsDualFoam are established. The key implementation details of the forward and backward sweep looping process in the LU-SGS approach are introduced. Three typical test cases, i.e. hypersonic airflow across cylinder(steady), subsonic flow over bump (steady) and supersonic forward step flow (unsteady), are used to investigate the performance of these LU-SGS solvers, and the density-based explicit solver, i.e. the rhoCentralFoam in the official OpenFOAM, is adopted as the comparison solver. Through the comparison of the numerical results for the first two steady cases, it is found that, the convergence performance of the LU-SGS solver is significantly superior to explicit solver rhoCentralFoam. Meanwhile, considering the combined effect of time step and the iteration efficiency, the LU-SGS solver, lusgsFoam is significantly more efficient than the explicit solver, rhoCentralFoam. For the third test case, i.e. the unsteady supersonic forward step flow, the spatial accuracy of the unsteady dual time lusgsDualFoam solver is a little lower than the explicit rhoCentralFoam, but overall, this unsteady implicit solver can capture the transient characteristics efficiently.
               
            

convective Jacobian matrix

positive/negative Steger–Warming flux-splitting Jacobian matrix


                        
surface element

diagonal matrix, the lower-diagonal matrix and the the upper-diagonal matrix

convective flux vectors

viscous flux vectors


                        
identity matrix

sets of “owner” and “neighbor” cells which are adjacent to the cell i in OpenFOAM

unit normal vector at the interface

set of cells which are adjacent to cell i
                     

residual of complete spatial discretization term for the discretized governing equation

physical time(s)


                        
contravariant velocity


                        
vector of conservative variable

control volume

spectral radius of the convective flux Jacobian, Ac
                        
                     

L2 norm residual

pseudo time step

convective; sound speed

index of cell

interface between cell i and j
                     


                        
time level at the current pseudo time


                        
Cartesian coordinates

inverse


                        
time level at the current physical time

viscous

symbol indicating direction

temporary variable

@&#INTRODUCTION@&#

OpenFOAM® is a widely spread CFD (Computational Fluid Dynamics) open source library based on object-oriented C++ language [1,2]. Utilizing its high level programming syntax and related released code details, it is convenient for the researchers to reproduce the algorithm in other references recently published or even to develop their own code according to their new idea [3–15]. OpenFOAM originated from pressure-based velocity-pressure correction mode which is devised to solve the incompressible Navier–Stokes equations [2], e.g. PISO [16,17] and SIMPLE [18,19]. After decades of development the relevant pressure-based solving strategies in OpenFOAM have already been abundant. In contrast to pressure-based mode, the density-based algorithm in the framework of OpenFOAM, which is more proper to solve the high speed (especially for the supersonic/hypersonic) compressible flow problem, appears relatively lately. Until now, compared with the commercial CFD software, e.g. Ansys Fluent [20], Fastran [21], the amount of functions of the density-based solvers in the official or the extended version of OpenFOAM is less and the efficiency of them is relatively lower.

So far, the only density-based solver in the official OpenFOAM is rhoCentralFoam, of which the convective discrete scheme is the central-upwind schemes of Kurganov and Tadmor [22,23]. Another popular density-based solver is densityBasedTurbo series in the extended version of OpenFOAM, of which the convective discrete schemes are the well known Godunov type schemes, e.g. AUSM family and Roe [24]. Based on the densityBasedTurbo solvers, for the all-speed flow, the time-derivative preconditioning method with all-speed convective discrete scheme (e.g. preconditioned Roe, AUSM+up, AUSM+P) was added in Refs. [25–27]. However, the density-based solvers above are all explicit, and so their computational efficiency is much lower than the density-based implicit solvers in the commercial software.

Matrix-free LU-SGS (lower-upper symmetric Gauss–Seidel) implicit scheme is widely used because of its low numerical complexity and modest memory requirements [28–30]. Using the LU-SGS algorithm, a density based solver in OpenFOAM was performed by Kim et al. [31], especially focused on steady state. The authors primarily showed the comparison results reproduced by the developed LU-SGS solver, whereas regretfully, they didn't present sufficient details associated with their program architecture within OpenFOAM. Thereby, for others in the OpenFOAM community, it's difficult to follow and improve the solver further. Until now, there is no other density-based implicit solver released in OpenFOAM or related references to declare the establishment of systematic density-based implicit solver in the framework of OpenFOAM. And so the other new implicit solver needs to be developed to further enrich the density based-solver library within OpenFOAM. The basic motivation of the present work arises from the lack of the density-based implicit solver in the framework of OpenFOAM.

Meanwhile there are many potential advantages due to its characteristics of open source in the framework of OpenFOAM . The most significant advantage of the solver in OpenFOAM is that a lot of other advanced models e.g. turbulence, can be directly added in. In comparison with other analogous solvers in commercial software, it could be also further improved by other researches due to its characteristics of open source. Moreover, it natively supports the unstructured grid for complex geometry and the parallelization to accelerate the computation process.

In view of lack of the density-based implicit solver in OpenFOAM and the potential advantages of the solver in OpenFOAM, the objective of this paper is to further develop the complete steady and unsteady LU-SGS solver based on the program of Borm et al. [24] and Shen et al. [26], and to show the code architecture of the program properly for futher improvement and perfection by others in the OpenFOAM community. Several test cases are selected to investigate the convergence performance and the computational efficiency of this implicit solver, as the other open source fluid solvers based on OpenFOAM lib [15,23,26,32] or other open source platforms [33–37]. These test cases could cover a wide range of benchmark examples from subsonic to hypersonic and steady to unsteady flow regimes.

Governing equations in integral form is shown as follows:

                           
                              (1)
                              
                                 
                                    
                                       ∫
                                       Ω
                                    
                                    
                                       
                                          
                                             ∂
                                             W
                                          
                                          
                                             ∂
                                             t
                                          
                                       
                                       d
                                       Ω
                                    
                                    +
                                    
                                       ∮
                                       
                                          ∂
                                          Ω
                                       
                                    
                                    
                                       (
                                       
                                          
                                             F
                                             c
                                          
                                          −
                                          
                                             F
                                             v
                                          
                                       
                                       )
                                    
                                    d
                                    S
                                    =
                                    0
                                 
                              
                           
                        where 
                           W
                         is the vector of the conservative variables, 
                           F
                        
                        
                           c
                         and 
                           F
                        
                        
                           v
                         are the vectors of the convective fluxes and the viscous fluxes, respectively, and Ω, ∂Ω and dS denote the control volume, the closed surface related to the particular control volume Ω and a surface element. The specific forms corresponding to the above variables are presented in Refs. [25,27].

By using the finite volume method for each grid cell i, the temporal and spatial discretization of Eq. (1) can be expressed as

                           
                              (2)
                              
                                 
                                    
                                       [
                                       
                                          
                                             
                                                Ω
                                                i
                                             
                                             
                                                Δ
                                                t
                                             
                                          
                                          I
                                          +
                                          
                                             
                                                ∂
                                                
                                                   R
                                                   i
                                                   n
                                                
                                             
                                             
                                                ∂
                                                
                                                   W
                                                   i
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    Δ
                                    
                                       W
                                       i
                                       n
                                    
                                    =
                                    −
                                    
                                       R
                                       i
                                       n
                                    
                                 
                              
                           
                        where 
                           
                              R
                              i
                              n
                           
                         is the so-called residual-the complete spatial discretization term, the term 
                           
                              
                                 ∂
                                 
                                    R
                                    i
                                    n
                                 
                              
                              
                                 ∂
                                 
                                    W
                                    i
                                 
                              
                           
                         is referred to as the flux Jacobian, I is identity matrix, and the superscript n denotes time level at the current time t, with

                           
                              (3)
                              
                                 
                                    Δ
                                    
                                       W
                                       i
                                       n
                                    
                                    =
                                    
                                       W
                                       i
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       W
                                       i
                                       n
                                    
                                 
                              
                           
                        being the solution correction. In this paper, we only consider the contribution of the convective flux Jacobian to the term 
                           
                              
                                 ∂
                                 
                                    R
                                    i
                                    n
                                 
                              
                              
                                 ∂
                                 
                                    W
                                    i
                                 
                              
                           
                        , i.e.

                           
                              (4)
                              
                                 
                                    
                                       
                                          ∂
                                          
                                             R
                                             i
                                             n
                                          
                                       
                                       
                                          ∂
                                          
                                             W
                                             i
                                          
                                       
                                    
                                    Δ
                                    
                                       W
                                       i
                                       n
                                    
                                    
                                    =
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          N
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                    
                                    
                                       [
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      ∂
                                                      
                                                         
                                                            
                                                               F
                                                               
                                                                  c
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                         n
                                                      
                                                   
                                                   
                                                      ∂
                                                      W
                                                   
                                                
                                                )
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          Δ
                                          
                                             S
                                             
                                                i
                                                j
                                             
                                          
                                          Δ
                                          
                                             W
                                             
                                                i
                                                j
                                             
                                             n
                                          
                                       
                                       ]
                                    
                                    
                                    =
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          N
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                    
                                    
                                       [
                                       
                                          
                                             A
                                             
                                                c
                                                ,
                                                i
                                                j
                                             
                                          
                                          Δ
                                          
                                             S
                                             
                                                i
                                                j
                                             
                                          
                                          Δ
                                          
                                             W
                                             
                                                i
                                                j
                                             
                                             n
                                          
                                       
                                       ]
                                    
                                 
                              
                           
                        where Ac
                         is the convective Jacobian matrix, N(i) is the set of cells which are adjacent to cell i. Substituting Eq. (4) for the convective flux Jacobian into Eq. (2), the following form is obtained:

                           
                              (5)
                              
                                 
                                    
                                       Ω
                                       i
                                    
                                    
                                       
                                          
                                             W
                                             i
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          −
                                          
                                             W
                                             i
                                             n
                                          
                                       
                                       
                                          Δ
                                          
                                             t
                                             i
                                          
                                       
                                    
                                    +
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          N
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                    
                                    
                                       
                                          A
                                          
                                             c
                                             ,
                                             i
                                             j
                                          
                                       
                                       Δ
                                       
                                          W
                                          
                                             i
                                             j
                                          
                                          n
                                       
                                       
                                          S
                                          
                                             i
                                             j
                                          
                                       
                                    
                                    =
                                    −
                                    
                                       R
                                       i
                                       n
                                    
                                    .
                                 
                              
                           
                        
                     

Then applying the Steger–Warming splitting scheme to discretize implicit operator above

                           
                              (6)
                              
                                 
                                    
                                       A
                                       
                                          c
                                          ,
                                          i
                                          j
                                       
                                    
                                    Δ
                                    
                                       W
                                       
                                          i
                                          j
                                       
                                       n
                                    
                                    
                                       S
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             A
                                             
                                                c
                                                ,
                                                i
                                                j
                                             
                                             +
                                          
                                          Δ
                                          
                                             W
                                             i
                                             n
                                          
                                          +
                                          
                                             A
                                             
                                                c
                                                ,
                                                i
                                                j
                                             
                                             −
                                          
                                          Δ
                                          
                                             W
                                             j
                                             n
                                          
                                       
                                       )
                                    
                                    
                                       S
                                       
                                          i
                                          j
                                       
                                    
                                 
                              
                           
                        with 
                           
                              A
                              c
                              ±
                           
                         denoting the positive/negative Steger–Warming flux-splitting Jacobian matrix. Finally, the following discretization form is obtained:

                           
                              (7)
                              
                                 
                                    
                                       Ω
                                       i
                                    
                                    
                                       
                                          
                                             W
                                             i
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          −
                                          
                                             W
                                             i
                                             n
                                          
                                       
                                       
                                          Δ
                                          
                                             t
                                             i
                                          
                                       
                                    
                                    +
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          N
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                A
                                                
                                                   c
                                                   ,
                                                   i
                                                   j
                                                
                                                +
                                             
                                             Δ
                                             
                                                W
                                                i
                                                n
                                             
                                             +
                                             
                                                A
                                                
                                                   c
                                                   ,
                                                   i
                                                   j
                                                
                                                −
                                             
                                             Δ
                                             
                                                W
                                                j
                                                n
                                             
                                          
                                          )
                                       
                                       
                                          S
                                          
                                             i
                                             j
                                          
                                       
                                    
                                    =
                                    −
                                    
                                       R
                                       i
                                       n
                                    
                                    .
                                 
                              
                           
                        
                     

According to the original theory of LU-SGS scheme, the implicit operator should be divided into the diagonal matrix D, the lower-diagonal matrix L and the the upper-diagonal matrix U. For this purpose, Eq. (7) could be deduced further as follows:

                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                Ω
                                                i
                                             
                                             
                                                
                                                   Δ
                                                   
                                                      W
                                                      i
                                                      n
                                                   
                                                
                                                
                                                   Δ
                                                   
                                                      t
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          −
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   L
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      A
                                                      
                                                         c
                                                         ,
                                                         i
                                                      
                                                      −
                                                   
                                                   
                                                      S
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                )
                                             
                                             Δ
                                             
                                                W
                                                i
                                                n
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   U
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      A
                                                      
                                                         c
                                                         ,
                                                         i
                                                      
                                                      +
                                                   
                                                   
                                                      S
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                )
                                             
                                             Δ
                                             
                                                W
                                                i
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          −
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   L
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      A
                                                      
                                                         c
                                                         ,
                                                         j
                                                      
                                                      +
                                                   
                                                   
                                                      S
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                )
                                             
                                             Δ
                                             
                                                W
                                                j
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          +
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   U
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      A
                                                      
                                                         c
                                                         ,
                                                         j
                                                      
                                                      −
                                                   
                                                   
                                                      S
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                )
                                             
                                             Δ
                                             
                                                W
                                                j
                                                n
                                             
                                             =
                                             −
                                             
                                                R
                                                i
                                                n
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The split convective flux Jacobian could be evaluated as follows:

                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                A
                                                ±
                                             
                                             Δ
                                             
                                                S
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                1
                                                2
                                             
                                             
                                                (
                                                
                                                   
                                                      A
                                                      c
                                                   
                                                   
                                                      S
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   ±
                                                   
                                                      Λ
                                                      c
                                                   
                                                   I
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             Λ
                                             c
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      |
                                                      V
                                                      |
                                                   
                                                   +
                                                   c
                                                
                                                )
                                             
                                             
                                                S
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where the contravariant velocity 
                           
                              V
                              =
                              U
                              •
                              
                                 n
                                 
                                    i
                                    j
                                 
                              
                              =
                              
                                 n
                                 x
                              
                              u
                              +
                              
                                 n
                                 y
                              
                              v
                              +
                              
                                 n
                                 z
                              
                              w
                           
                        , with the unit normal vector 
                           
                              
                                 n
                                 
                                    i
                                    j
                                 
                              
                              =
                              
                                 n
                                 x
                              
                              i
                              +
                              
                                 n
                                 y
                              
                              j
                              +
                              
                                 n
                                 z
                              
                              k
                           
                         corresponding to the face area vector 
                           S
                        
                        
                           ij
                        , and Λc
                         represents the spectral radius of the convective flux Jacobian Ac
                        . Then substituting Eq. (9) into Eq. (8), the diagonal matrix D could be written as

                           
                              (10)
                              
                                 
                                    
                                       D
                                       i
                                    
                                    =
                                    
                                       
                                          Ω
                                          i
                                       
                                       
                                          Δ
                                          
                                             t
                                             i
                                          
                                       
                                    
                                    I
                                    +
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          
                                             (
                                             
                                                L
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                +
                                                U
                                                
                                                   (
                                                   i
                                                   )
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          ω
                                          2
                                       
                                       
                                          Λ
                                          
                                             
                                                c
                                                ,
                                             
                                             i
                                             j
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Meanwhile, 
                           
                              
                                 L
                                 i
                              
                              =
                              −
                              
                                 ∑
                                 
                                    j
                                    ∈
                                    L
                                    (
                                    i
                                    )
                                 
                              
                              
                                 (
                                 
                                    
                                       A
                                       
                                          c
                                          ,
                                          j
                                       
                                       +
                                    
                                    
                                       S
                                       
                                          i
                                          j
                                       
                                    
                                 
                                 )
                              
                           
                        , with L(i) being the set of “owner” cells which are adjacent to the discrete element i(cellI), i.e. j ∈ L(i); 
                           
                              
                                 U
                                 i
                              
                              =
                              
                                 ∑
                                 
                                    j
                                    ∈
                                    U
                                    (
                                    i
                                    )
                                 
                              
                              
                                 (
                                 
                                    
                                       A
                                       
                                          c
                                          ,
                                          j
                                       
                                       −
                                    
                                    
                                       S
                                       
                                          i
                                          j
                                       
                                    
                                 
                                 )
                              
                           
                        , with U(i) being the set of “neighbor” cells which are adjacent to the discrete element i(cellI), i.e. j ∈ U(i).

In OpenFOAM, the superscript “+” and “−” denote the positive and the negative direction corresponding to the face normal vector 
                           
                              
                                 n
                                 
                                    i
                                    j
                                 
                              
                              =
                              
                                 n
                                 x
                              
                              i
                              +
                              
                                 n
                                 y
                              
                              j
                              +
                              
                                 n
                                 z
                              
                              k
                           
                        . In other words, for each interface ij, the positive variable is directed from owner cell to neighbor cell and the negative variable has the reverse direction. Specially, it is noted that, if j ∈ L(i), 
                           S
                        
                        
                           ij
                         is the inward-pointing face area vector for cell i, so it means that, according to the Gauss theorem, the sign of the second and forth implicit operator term in the left hand of Eq. (8) should be negative.

Finally, Eq. (8) could be transformed into

                           
                              (11)
                              
                                 
                                    
                                       (
                                       
                                          D
                                          +
                                          L
                                       
                                       )
                                    
                                    
                                       D
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          D
                                          +
                                          U
                                       
                                       )
                                    
                                    Δ
                                    
                                       W
                                       n
                                    
                                    =
                                    −
                                    
                                       R
                                       n
                                    
                                    .
                                 
                              
                           
                        
                     

The solving process is divided into two steps: forward sweep and backward sweep, where forward and backward sweep processes are directly solving Eqs. (12) and(13), respectively,

                           
                              (12)
                              
                                 
                                    
                                       (
                                       
                                          D
                                          +
                                          L
                                       
                                       )
                                    
                                    Δ
                                    
                                       W
                                       *
                                    
                                    =
                                    −
                                    
                                       R
                                       n
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       (
                                       
                                          D
                                          +
                                          U
                                       
                                       )
                                    
                                    Δ
                                    
                                       W
                                       n
                                    
                                    =
                                    D
                                    Δ
                                    
                                       W
                                       *
                                    
                                    .
                                 
                              
                           
                        
                     

Dual time-stepping approach is very often employed for the unsteady flow. In this approach, pseudo-time term, i.e. 
                           
                              
                                 Ω
                                 i
                              
                              
                                 
                                    Δ
                                    
                                       W
                                       i
                                       *
                                    
                                 
                                 
                                    Δ
                                    τ
                                 
                              
                           
                        , should be added in as follows:

                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             
                                                Ω
                                                i
                                             
                                             
                                                
                                                   Δ
                                                   
                                                      W
                                                      i
                                                      l
                                                   
                                                
                                                
                                                   Δ
                                                   τ
                                                
                                             
                                          
                                       
                                       
                                          +
                                       
                                       
                                          
                                             
                                                Ω
                                                i
                                             
                                             
                                                
                                                   3
                                                   Δ
                                                   
                                                      W
                                                      i
                                                      l
                                                   
                                                   +
                                                   3
                                                   
                                                      W
                                                      i
                                                      l
                                                   
                                                   −
                                                   4
                                                   
                                                      W
                                                      i
                                                      n
                                                   
                                                   +
                                                   
                                                      W
                                                      i
                                                      
                                                         n
                                                         −
                                                         1
                                                      
                                                   
                                                
                                                
                                                   2
                                                   Δ
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          +
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   N
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      F
                                                      
                                                         c
                                                         ,
                                                         i
                                                         j
                                                      
                                                      
                                                         l
                                                         +
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      F
                                                      
                                                         v
                                                         ,
                                                         i
                                                         j
                                                      
                                                      l
                                                   
                                                
                                                )
                                             
                                             
                                                S
                                                
                                                   i
                                                   j
                                                
                                             
                                             =
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        with

                           
                              (15)
                              
                                 
                                    Δ
                                    
                                       W
                                       i
                                       l
                                    
                                    =
                                    
                                       W
                                       i
                                       
                                          l
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       W
                                       i
                                       l
                                    
                                 
                              
                           
                        where superscript l denotes the current pseudo-time level. Similar as the discretization Eq. (2) for the physical time implicit scheme, Eq. (16) is obtained:

                           
                              (16)
                              
                                 
                                    
                                       [
                                       
                                          
                                             Ω
                                             i
                                          
                                          
                                             (
                                             
                                                
                                                   1
                                                   
                                                      Δ
                                                      τ
                                                   
                                                
                                                +
                                                
                                                   3
                                                   
                                                      2
                                                      Δ
                                                      t
                                                   
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             
                                                ∂
                                                
                                                   R
                                                   i
                                                   l
                                                
                                             
                                             
                                                ∂
                                                
                                                   W
                                                   i
                                                   l
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    Δ
                                    
                                       W
                                       i
                                       l
                                    
                                    =
                                    −
                                    
                                       
                                          (
                                          
                                             R
                                             i
                                             *
                                          
                                          )
                                       
                                       l
                                    
                                 
                              
                           
                        where the residual term for dual time-stepping approach is

                           
                              (17)
                              
                                 
                                    
                                       
                                          (
                                          
                                             R
                                             i
                                             *
                                          
                                          )
                                       
                                       l
                                    
                                    =
                                    
                                       R
                                       i
                                       l
                                    
                                    +
                                    
                                       (
                                       
                                          
                                             Ω
                                             i
                                          
                                          
                                             
                                                3
                                                
                                                   W
                                                   i
                                                   l
                                                
                                                −
                                                4
                                                
                                                   W
                                                   i
                                                   n
                                                
                                                +
                                                
                                                   W
                                                   i
                                                   
                                                      n
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                2
                                                Δ
                                                t
                                             
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

The discretization procedure to solve Eq. (16) is similar as that shown in Section 2.3.

For the LU-SGS scheme, the sweeping process could be conveniently implemented. Eqs. (12) and (13) are transformed into the following form:

                        
                           (18)
                           
                              
                                 Δ
                                 
                                    W
                                    *
                                 
                                 =
                                 
                                    D
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       −
                                       
                                          R
                                          n
                                       
                                       −
                                       L
                                       Δ
                                       
                                          W
                                          *
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (19)
                           
                              
                                 Δ
                                 W
                                 =
                                 Δ
                                 
                                    W
                                    *
                                 
                                 −
                                 
                                    D
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       U
                                       Δ
                                       W
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

As mentioned above, Eq. (18) is related to the forward sweep that LΔW* is known in advance, and in OpenFOAM, it is equivalent to that, corresponding to the cell i(cellI) to be solved, the solutions of the variable at its adjacent owner cells are already known. Eq. (19) is related to the backward sweep that UΔW is known beforehand, and in OpenFOAM, the solutions of the variable at its adjacent neighbor cells are known in advance.

Subsequently, the detail of the implementation of LU-SGS scheme in OpenFOAM is presented, taken the simple 2-D structured 3 × 3 mesh system, shown in Fig. 1
                     . Fig. 1(a) shows the cell index i or cellI, and Fig. 1(b) shows the face serial index number faceI. Tables 1
                     
                     
                     
                     
                      and 2 present mapping relationship between the internal face faceI (not including the boundary faces) and its adjacent owner and neighbor cells.


                     Fig. 2 shows the implicit operator matrix (diagonal matrix D, the lower-diagonal matrix L and the upper-diagonal matrix U) for the 3 × 3 mesh in Fig. 1.
                  


                     Algorithms 1–3 show some details corresponding to the LU-SGS scheme in OpenFOAM in brief. Firstly, the lists of owner and neighbor cell index, i.e. cellI lists in Tables 1 and 2, should be obtained, as shown in Algorithm 1
                     . These two lists are the basis to get cells adjacent to each cell cellI.


                     Algorithm 2 shows the key ingredient of the LU-SGS scheme looping in OpenFOAM, i.e. definition of the Lower matrix, and performance of the forward sweep.

The process corresponding to the backward sweep is similar to the forward sweep as shown in Algorithm 2. It is noted that the reverse cell looping command forAllReverse substitutes the positive cell looping command forAll, as shown in Algorithm 3
                     
                     .


                     Fig. 3 shows the block diagram of forward sweeping process in the framework of OpenFOAM.

@&#RESULTS AND DISCUSSION@&#

Hypersonic airflow across blunt body, e.g. blunt cone and cylinder, is a typical test case to investigate the performance of the numerical methods to capture the shock discontinuity in the hypersonic flow regime [23,38,39]. In this paper, Hypersonic airflow across cylinder is employed, and the inlet velocity of the hypersonic airflow stream is 6.47Ma, and other computational conditions, e.g. the geometric sizes are the same as that presented in Ref. [23]. It is noted that the independence of grid size was also discussed in Ref. [23]. The numerical results produced by the LU-SGS solver, which called lusgsFoam solver in the following context, are compared with the corresponding results generated by the rhoCentralFoam solver in the official OpenFOAM platform. For these two solvers, the one-dimension reconstruction scheme with minmod TVD limiter is utilized to enhance the spatial accuracy to second order [19,26,28].


                        Fig. 4
                        
                        
                        
                        
                        
                        
                         shows the comparison of temperature contour lines predicted by the two solvers mentioned above. The locations of corresponding contour lines, especially for the locations at shocks, are nearly coincident with each other. The spacings of the shocks predicted by these two solvers are almost uniform.

Except the spatial accuracy, the convergence history and the computational efficiency regarding the execution time, i.e. CPU time, are two additional key points to be discussed for the numerical solver. In this paper, L2 norm residual ϕ is chosen as the convergence criterion, which is shown as follows:

                           
                              (20)
                              
                                 
                                    ϕ
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                c
                                                e
                                                l
                                                l
                                                I
                                             
                                          
                                          
                                             
                                                
                                                   |
                                                   
                                                      
                                                         (
                                                         
                                                            ∇
                                                            ·
                                                            
                                                               (
                                                               
                                                                  ρ
                                                                  U
                                                               
                                                               )
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         c
                                                         e
                                                         l
                                                         l
                                                         I
                                                      
                                                   
                                                   |
                                                
                                             
                                             2
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                c
                                                e
                                                l
                                                l
                                                I
                                             
                                          
                                          
                                             
                                                
                                                   |
                                                   
                                                      
                                                         ∑
                                                         
                                                            f
                                                            a
                                                            c
                                                            e
                                                            I
                                                         
                                                         
                                                            c
                                                            e
                                                            l
                                                            l
                                                            I
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            S
                                                            ·
                                                            
                                                               
                                                                  (
                                                                  
                                                                     ρ
                                                                     U
                                                                  
                                                                  )
                                                               
                                                               
                                                                  f
                                                                  a
                                                                  c
                                                                  e
                                                                  I
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   |
                                                
                                             
                                             2
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

The convergence histories in terms of physical time t are shown in Fig. 5. For the lusgsFoam, the magnitude of the residual is nearly converged at the value 0.5, and it is much smaller than the converged value (larger than 3) produced by the rhoCentralFoam solver.

In this case, the computational time steps Δt = 10−7 s and 0.5 × 10−8s are utilized for the lusgsFoam and rhoCentralFoam solvers, respectively, and these two time spans are the maximum allowable time steps for these two solvers, respectively. The consumptions of the execution time at the same physical moment t are shown at
Table 3. Considering the combined effect of physical time step and the iteration efficiency, the consumption of the CPU execution time corresponding to the lusgsFoam is less than one fifth of that cost by the rhoCentralFoam.

The subsonic flow over bump is another frequently used as compressible steady test case [26]. In this paper, the inlet Mach number is 0.675. In order to enhance the spatial accuracy to second order, the multi-dimension reconstruction scheme with Venkatakrishnan limiter [24,26,28] is adopted for the lusgsFoam solver, and one-dimension reconstruction scheme with minmod limiter function is adopted for the rhoCentralFoam solver. As shown in Fig. 6, the difference of the contour lines predicted by these two solvers is significant. Some contour lines produced by the rhoCentralFoam can't expand enough as the corresponding lines generated by lusgsFoam, especially for the lines regarding the magnitude Ma = 0.6 and 0.85. However, the area enclosed by other contour lines, e.g. Ma = 0.65 ahead of and behind the bump, are a little larger that corresponding lines predicted by the lusgsFoam solver.

The convergence history in terms of physical time t is shown in Fig. 7. As we can observe, the convergence residual line which is produced by the lusgsFoam with multi-dimensional interface reconstruction scheme continuously decline rapidly, while the corresponding line generated by rhoCentralFoam with vanleer limiter oscillated up and down at the value of 1.

In this case, the computational step for the lusgsFoam is 2 × 10−4 s, while the computational step for the rhoCentralFoam is 2 × 10−5 s. Due to neglecting the derivative of the Jacobian matrix during the flux splitting process, the CFL number should be restricted, so the time step 2 × 10−4 s is not the largest time step for this lusgsFoam with multi-dimensional reconstruction scheme [28], while 2 × 10−5 s is the largest time step for the rhoCentralFoam with minmod limiter. The consumption of the execution time at the same physical time t is shown at Table 4. Considering the combined effect of time step and the iteration efficiency, the consumption of the execution time corresponding to the lusgsFoam is still less than one fifth of that cost by the rhoCentralFoam, similar as Case 1.
                     

The performance of iteration efficiency of lusgsDualFoam solver is nearly the same as lusgsFoam. Employing Case 3, it is intended to indicate that the lusgsDualFoam solver can capture the unsteady characteristics for the transient flow problem. As for its entire efficiency (summing up both inner iteration-pseudo time stepping and out iteration-physical time stepping), it depends the physical time step Δt and the inner iteration number. If Δt and the inner iteration number are larger, the entire computational efficiency will be higher, and the accuracy will be lower. Herein smaller physical time step Δt = 0.1 s is adopted to ensure the accuracy.

The subsonic flow over bump is selected to evaluate the performance of dual-time lusgsDualFoam solver for the unsteady flow. Fig. 8(a) presents comparison of density and pressure contour lines produced by the lusgsFoam and rhoCentralFoam solvers both with vanleer limiter. As one can see in Fig. 8(a), at t = 0.5 s, the contour lines generated by lusgsDualFoam solver are less sharp than those predicted by rhoCentralFoam. There are existing pre-shock ahead of the shock in front of the forward step, and the pre-shock is gradually vanished with the physical time proceeding. Meanwhile, at t = 4 s, downstream of the shock reflected from the step, the oscillation is produced by the lusgsDualFoam solver. Compared with the data from Ref. [26], the pre-shock and the oscillation phenomena are a little weaker than the results produced by the original densityBasedTurb solvers. Fig. 8(b) presents comparison of pressure contour lines. The numerical phenomena shown in Fig. 8(b) are similar as that presented in Fig. 8(a), and the pre-shock is much clearer.

It should be noted that, in Fig. 9, the meanings of x-axis are different. For lusgsDualFoam solver, x-axis represents the pseudo-time, and for rhoCentralFoam solver, the x-axis represents physical time. For the sake of clarity, only the convergence residual curves at five physical time step (t = 0, 0.1, 0.2, 3.9 and 4 s) corresponding to the lusgsDualFoam are shown in Fig. 9. For the convenience of comparison, wherein the curves corresponding to t = 3.9 and 4 s are translated forward and the tail of curve corresponding to t = 4 s is aligned with the tail of curve corresponding to rhoCentralFoam solver.

As shown in Fig. 9, different from the previous two test cases, at the terminal time t = 4 s, the residuals produced by the lusgsDualFoam and rhoCentralFoam both are nearly the same, i.e. nearly both converging to the value of 0.2. For the previous two cases, it is required that the computational process must proceed to the steady state that the convergence residuals should be small enough. For this forward step case, due to the unsteady feature, there is no need to guarantee that the residual is small sufficiently. That's why the residuals generated by these two solvers are nearly converged to the same value.

@&#CONCLUSION@&#

In this paper, in the framework of OpenFOAM, the density based steady and unsteady dual-time implicit LU-SGS solvers which are termed as lusgsFoam and lusgsDualFoam are established. The key implementation details of the forward and backward sweep looping process in the LU-SGS approach are introduced. Three typical test cases, i.e. hypersonic airflow across cylinder (steady), subsonic flow over bump (steady) and supersonic forward step flow (unsteady), are used to investigate the performance of this LU-SGS solver, and the density based explicit solver, i.e. the rhoCentralFoam in the official OpenFOAM, is adopted as the comparison solver.

Through the comparison of the numerical results for the first two steady cases, it is found that, the convergence performance of the LU-SGS solver, lusgsFoam is significantly superior to explicit solver rhoCentralFoam. Meanwhile, considering the combined effect of time step and the iteration efficiency, the consumption of the execution time corresponding to the lusgsFoam solver is still less than one fifth of that cost by the rhoCentralFoam solver, and in other words, the LU-SGS solver, lusgsFoam has much higher computational efficiency than the explicit solver, rhoCentralFoam.

For the third test case, i.e. the unsteady supersonic forward step flow, the spatial accuracy of the unsteady dual-time lusgsDualFoam solver is a little lower than the explicit rhoCentralFoam, but overall, this unsteady implicit solver can capture the transient characteristics efficiently.

The most significant advantage of the density-based implicit solver in OpenFOAM is that a lot of other advanced models e.g. turbulence, can be directly added in. In comparison with other analogous solvers in commercial software, it could be also further improved by other researches due to its characteristics of open source. Moreover, it natively supports the unstructured grid for complex geometry and the parallelization to accelerate the computation process. However, until now, it needs much more test cases to verify and does not support the multigrid method, and this is the work that the authors should do in the future.

@&#ACKNOWLEDGMENT@&#

This study was supported by the National Natural Science Foundation of China (Grant no. 51176038 and Grant no. 51309115), and the Special Fund for Agroscientific Research in the Public Interest (Grant no. 201503135).

@&#REFERENCES@&#

