@&#MAIN-TITLE@&#Smooth surfaces from rational bilinear patches

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We approximate negatively curved surfaces by smooth unions of rational bilinear patches.


                        
                        
                           
                           We prove vertex consistency of hyperbolic nets using a CAGD approach.


                        
                        
                           
                           We generate smooth surfaces composed of Darboux cyclide patches.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Discrete differential geometry

Architectural geometry

Fabrication-aware design

Asymptotic net

Hyperbolic net

Rational bilinear patch

Darboux cyclide

Darboux transformation

@&#ABSTRACT@&#


               
               
                  Smooth freeform skins from simple panels constitute a challenging topic arising in contemporary architecture. We contribute to this problem area by showing how to approximate a negatively curved surface by smoothly joined rational bilinear patches. The approximation problem is solved with help of a new computational approach to the hyperbolic nets of Huhnen-Venedey and Rörig and optimization algorithms based on it. We also discuss its limits which lie in the topology of the input surface. Finally, freeform deformations based on Darboux transformations are used to generate smooth surfaces from smoothly joined Darboux cyclide patches; in this way we eliminate the restriction to surfaces with negative Gaussian curvature.
               
            

@&#INTRODUCTION@&#

The growing interest of contemporary architects in freeform structures poses new challenges to digital design. In this area, there are numerous open problems, one of them being the production of smooth architectural freeform skins (surfaces). To make them affordable, they have to be composed of simple and easily manufacturable panels (patches). The manufacturing cost of a panel depends on the material and the process to produce it, which includes the production of the mold.

Let us look at an example: To produce a curved glass-fibre reinforced concrete panel, a mold is produced from styrofoam. The cheapest way of mold production is to use heated wire cutting, which can only produce ruled surfaces. Hence ruled panels are an advantage. Ruled surfaces are also advantageous for the manufacturing of form work on which the concrete is poured, for substructures and for timber constructions.

Hence, as a contribution towards fabrication-aware design, we ask ourselves how to compose smooth surfaces from simple ruled patches. The simplest case, smooth surfaces from bilinear patches, has been investigated recently by Käferböck and Pottmann (2013). The resulting surfaces possess rather strong shape restrictions as they represent discrete versions of affine minimal surfaces previously introduced by Craizer et al. (2010).

Can we do more with rational bilinear patches? It is clear that smoothly joined negatively curved patches will only generate models of negatively curved surfaces S. It turns out that the only remaining restriction is on the topology of S: the surface S has to be simply connected. As in many other instances of geometric problems in freeform architecture (Wallner and Pottmann, 2011), we are again led to discrete differential geometry: Useful discrete representations of negatively curved surfaces are discrete asymptotic parameterizations, namely quad meshes with planar vertex stars (A-nets; see e.g. Bobenko and Suris, 2008). Huhnen-Venedey and Rörig (2013) could show that simply connected A-nets (whose extraordinary vertices are of even valence) can be extended to smooth surfaces via rational bilinear patches (under a certain mild condition on the way how the quad strips in the mesh are twisted, which for a sufficiently fine A-net is satisfied anyway). They call the resulting structures hyperbolic nets (H-nets), as they are typically composed of hyperboloid patches (but may contain patches of hyperbolic paraboloids as well).

In the present paper, we further elaborate on hyperbolic nets by providing a new elementary derivation: While Huhnen-Venedey and Rörig (2013) work in the Plücker quadric model of line geometry, we just use the rational Bézier form and thus also contribute to a simple computation based on standard CAGD methods. Moreover, we add a proper algorithmic treatment of surface approximation with H-nets, formulated within a global geometric optimization framework.

Paneling freeform skins is an important issue in architecture. Eigensatz et al. (2010) presented an optimization framework which allows one to achieve a good balance between production cost and skin quality, the latter being evaluated through the size of gaps and the kink angles occurring at adjacent panels. Ideally, these measures should be zero, but this is in general not achievable, unless the geometry and the panel seam layout are special.

Negatively curved smooth surfaces which are composed of ruled surface strips, have been addressed by Flöry (2010), Flöry and Pottmann (2010), Flöry et al. (2012). This work does not employ rational bilinear patches. It can be seen as a computational approach to semidiscrete asymptotic parameterizations, which have been investigated from a mathematical viewpoint by Wallner (2012).

As we deal here with a smooth extension of a mesh, we point to the related problem of extending the vertices of a circular mesh (quad mesh all whose quads possess a circum-circle) smoothly with Dupin cyclide patches (Bobenko and Huhnen-Venedey, 2012); a computational treatment of these cyclidic nets along with generalizations aiming at substructures in freeform architecture, has been presented by Bo et al. (2011). The theoretical beauty of the approach by Huhnen-Venedey and Rörig (2013) lies in the use of the Plücker quadric model, which reveals the close relation to cyclidic nets, in accordance with the famous line-sphere transformation of S. Lie (which is of theoretical interest, but not directly applicable as it is not real). Independently from our work, Huhnen-Venedey and Schief (2013) developed an affine approach to H-nets which is related to ours and which they use for the study of Weingarten transformations.

While cyclidic nets are always arranged along curvature lines, we may ask for generalizations by replacing Dupin cyclides by Darboux cyclides (Pottmann et al., 2012). Like Dupin cyclides, the latter also contain families of circles (up to six!), which is an advantage for production on the large architectural scale. As a first step towards the most general Darboux cyclide patchworks we address here a simple computation from hyperbolic nets via so-called Darboux transformations.

The contributions of the present paper are as follows:
                           
                              1.
                              We provide a simple CAGD proof of the main result of Huhnen-Venedey and Rörig (2013) along with formulae for computations based on the rational Bézier form (Section 2).

We show how to approximate a given negatively curved surface with a smooth union of rational bilinear patches, through a numerical optimization algorithm which combines A-net generation and its smooth extension with ruled quadric patches (Section 3).

We apply Darboux transformations to obtain smooth surfaces from Darboux cyclide patches; these surfaces are no longer restricted to negative Gaussian curvature (Section 4).

A rational bilinear patch with control points 
                           
                              
                                 b
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 b
                              
                              
                                 3
                              
                           
                         and positive weights 
                           
                              
                                 w
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 w
                              
                              
                                 3
                              
                           
                         is given by the parametric representation
                           
                              (1)
                              
                                 x
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 =
                                 
                                    
                                       (
                                       1
                                       −
                                       u
                                       )
                                       (
                                       1
                                       −
                                       v
                                       )
                                       
                                          
                                             w
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       u
                                       (
                                       1
                                       −
                                       v
                                       )
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       (
                                       1
                                       −
                                       u
                                       )
                                       v
                                       
                                          
                                             w
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       u
                                       v
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       (
                                       1
                                       −
                                       u
                                       )
                                       (
                                       1
                                       −
                                       v
                                       )
                                       
                                          
                                             w
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       u
                                       (
                                       1
                                       −
                                       v
                                       )
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       (
                                       1
                                       −
                                       u
                                       )
                                       v
                                       
                                          
                                             w
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       u
                                       v
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         with 
                           (
                           u
                           ,
                           v
                           )
                           ∈
                           
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                              
                                 2
                              
                           
                        . One can obtain it from a bilinear patch 
                           
                              
                                 x
                              
                              
                                 ¯
                              
                           
                           (
                           u
                           ,
                           v
                           )
                         in 
                           
                              
                                 R
                              
                              
                                 4
                              
                           
                        , with vertices 
                           
                              
                                 
                                    
                                       b
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 i
                              
                           
                           :
                           =
                           (
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           )
                        , by mapping it into 3-space with help of the canonical projection 
                           (
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 4
                              
                           
                           )
                           ↦
                           (
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           /
                           
                              
                                 x
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           /
                           
                              
                                 x
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                           /
                           
                              
                                 x
                              
                              
                                 4
                              
                           
                           )
                        . The patch lies on a ruled quadric and carries two families of straight line segments (rulings), namely the u- and v-isoparameter lines.

Let us first discuss why it is sufficient to set three of the four weights equal to 1, say
                           
                              (2)
                              
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 1
                                 ,
                              
                           
                         without losing the possible variety of quadric patches with a given boundary polygon 
                           
                              
                                 b
                              
                              
                                 0
                              
                           
                           …
                           
                              
                                 b
                              
                              
                                 3
                              
                           
                        . One way of proving this uses the so-called frame points which are the canonical projections of the edge midpoints of 
                           
                              
                                 x
                              
                              
                                 ¯
                              
                           
                        . These points 
                           
                              
                                 f
                              
                              
                                 0
                              
                           
                           =
                           x
                           (
                           1
                           /
                           2
                           ,
                           0
                           )
                        , 
                           
                              
                                 f
                              
                              
                                 1
                              
                           
                           =
                           x
                           (
                           1
                           ,
                           1
                           /
                           2
                           )
                        , 
                           
                              
                                 f
                              
                              
                                 2
                              
                           
                           =
                           x
                           (
                           1
                           /
                           2
                           ,
                           1
                           )
                        , 
                           
                              
                                 f
                              
                              
                                 3
                              
                           
                           =
                           x
                           (
                           0
                           ,
                           1
                           /
                           2
                           )
                        , are expressed as 
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                           :
                           =
                           (
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                           +
                           
                              
                                 w
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           
                              
                                 b
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                           /
                           (
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           +
                           
                              
                                 w
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                         (with indices taken modulo 4). They divide the boundary edges in the inverse ratio of the corresponding weights (see Fig. 1
                        , left). Frame points on opposite edges are connected by straight line segments which lie entirely on the patch x (isoparameter lines 
                           u
                           =
                           1
                           /
                           2
                         and 
                           v
                           =
                           1
                           /
                           2
                        , respectively). A given ruled quadric patch has infinitely many rational bilinear parameterizations: We can choose a ruling in each of the two families as those connecting the frame points, and this determines the weights and hence the parameterization of the patch. Let us choose rulings so that two frame points on adjacent edges, say 
                           
                              
                                 f
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 3
                              
                           
                        , are edge midpoints (Fig. 1, right). This implies 
                           
                              
                                 w
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 w
                              
                              
                                 3
                              
                           
                        , and as only the ratio of weights matters, we can set these three weights to 1. Hence we are left with a single “shape parameter”, the weight 
                           
                              
                                 w
                              
                              
                                 2
                              
                           
                        , in accordance with the fact that there is only a one-parameter family of ruled quadric patches through a given skew quadrilateral with vertices 
                           
                              
                                 b
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 b
                              
                              
                                 3
                              
                           
                        . Note that 
                           
                              
                                 w
                              
                              
                                 2
                              
                           
                           =
                           1
                         characterizes a patch of a hyperbolic paraboloid; otherwise the patch lies on a one-sheeted hyperboloid.

While it is convenient for some of our discussions to have three weights equal to 1, we also need to convert to the general case: Two rational bilinear patches with the same control points and weights 
                        
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                         
                        and 
                        
                           
                              
                                 w
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                        
                        , respectively, define the same quadric patch, if and only if
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             0
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             3
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         This follows easily from projective geometry, namely the fact that the cross ratios determined by control points and frame points on one pair of opposite edges of the control quad have to agree (then they also agree on the other edge pair),
                           
                              
                                 cr
                                 
                                    (
                                    
                                       
                                          b
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 =
                                 cr
                                 
                                    (
                                    
                                       
                                          b
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          b
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          3
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         which is equivalent to (3) and once again shows that we can set three of the weights equal to 1. If the value
                           
                              (4)
                              
                                 W
                                 :
                                 =
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                              
                           
                         approaches 0 or ∞, the patch exhibits increasing curvature along a diagonal of the control quad, and in the limit it becomes a pair of triangles. As this is very undesirable for our applications, we want W to be sufficiently close to 1, which we will later use in our optimization algorithm. Note that the value W depends on the selection of a diagonal in the quad. The product of weights of the vertices of this diagonal are in the numerator. Depending on the diagonal selection, the value of the shape parameter is W or 
                           1
                           /
                           W
                        .

Using the notation from Fig. 2
                        , we prove a simple condition for smoothly joined rational bilinear patches:


                        
                           Proposition 1
                           
                              Let us consider two rational bilinear patches with vertices 
                              
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       4
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       5
                                    
                                 
                              
                              , and weights 
                              
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                               
                              of 
                              
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                               
                              equal to one, except weights 
                              
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       w
                                    
                                    
                                       4
                                    
                                 
                              
                              . Then these patches join smoothly along the common edge 
                              
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                 
                               
                              if the vertex stars at the common vertices are planar, i.e., points 
                              
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       5
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       4
                                    
                                 
                               
                              are coplanar, and if the following condition holds,
                              
                                 
                                    (5)
                                    
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                       
                                       det
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             30
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             50
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             20
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             w
                                          
                                          
                                             4
                                          
                                       
                                       det
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             30
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             10
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             40
                                          
                                       
                                       )
                                       ,
                                       
                                       
                                          with
                                       
                                       
                                       
                                          
                                             b
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       :
                                       =
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             b
                                          
                                          
                                             j
                                          
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           It is well known that two ruled surfaces join smoothly along a common ruling as soon as we have agreement of tangent planes at three points of that ruling. Two of these points are 
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                 
                              , and so we just need to ensure a common tangent plane at a third point. We choose the frame point 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 /
                                 2
                               and get the condition
                                 
                                    
                                       det
                                       
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                30
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                1
                                                +
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             2
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      5
                                                   
                                                
                                                +
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      4
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                             
                                                1
                                                +
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             2
                                          
                                          )
                                       
                                       =
                                       0
                                       .
                                    
                                 
                               This equation can be rewritten as
                                 
                                    
                                       det
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             30
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             10
                                          
                                       
                                       +
                                       
                                          
                                             b
                                          
                                          
                                             13
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             23
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             20
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             50
                                          
                                       
                                       +
                                       
                                          
                                             b
                                          
                                          
                                             53
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             43
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             40
                                          
                                       
                                       )
                                       =
                                       0
                                       ,
                                    
                                 
                               and by adding 
                                 (
                                 1
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 
                                    
                                       b
                                    
                                    
                                       30
                                    
                                 
                               to the 2nd vector and 
                                 (
                                 1
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       4
                                    
                                 
                                 )
                                 
                                    
                                       b
                                    
                                    
                                       30
                                    
                                 
                               to the third, we arrive at
                                 
                                    
                                       det
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             30
                                          
                                       
                                       ,
                                       2
                                       
                                          
                                             b
                                          
                                          
                                             10
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             20
                                          
                                       
                                       ,
                                       2
                                       
                                          
                                             b
                                          
                                          
                                             50
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             w
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             40
                                          
                                       
                                       )
                                       =
                                       0
                                       .
                                    
                                 
                               Due to the planarity constraints at 
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                               and 
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                 
                              , we have 
                                 det
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       30
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       10
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       50
                                    
                                 
                                 )
                                 =
                                 det
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       30
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       20
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       40
                                    
                                 
                                 )
                                 =
                                 0
                               and this reduces the condition to Eq. (5).  □


                        
                           Remark 2
                           Positive weights 
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       4
                                    
                                 
                               for the smoothly joined patches require equal sign of the two determinants 
                                 det
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       30
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       50
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       20
                                    
                                 
                                 )
                               and 
                                 det
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       30
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       10
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       40
                                    
                                 
                                 )
                               (called equitwist condition in Huhnen-Venedey and Rörig, 2013). Let us denote the tangent planes of the vertex stars at 
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                               and 
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                 
                               by 
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                               and 
                                 
                                    
                                       T
                                    
                                    
                                       3
                                    
                                 
                              , respectively. Then, a practically useful net will have (i) 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       b
                                    
                                    
                                       5
                                    
                                 
                               on different sides of the common edge 
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                 
                               (inside plane 
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                              ) and (ii) 
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                               and 
                                 
                                    
                                       b
                                    
                                    
                                       4
                                    
                                 
                               on different sides of 
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                 
                               (inside plane 
                                 
                                    
                                       T
                                    
                                    
                                       3
                                    
                                 
                              ); the latter implies that 
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                               and 
                                 
                                    
                                       b
                                    
                                    
                                       4
                                    
                                 
                               are on different sides of 
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                              , and thus the sign condition is satisfied. Hence, ensuring positive weights does not cause any problems in the practical computations discussed below.


                        
                           Remark 3
                           For general weights 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                              , we obtain in view of (3) the following condition for a smooth connection,
                                 
                                    (6)
                                    
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             5
                                          
                                       
                                       det
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             30
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             50
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             20
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             4
                                          
                                       
                                       det
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             30
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             10
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             40
                                          
                                       
                                       )
                                       .
                                    
                                 
                               We can nicely rewrite this condition in terms of the shape parameters W defined in (4). Selecting the diagonal 
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                               for the left patch, we define the shape parameter 
                                 
                                    
                                       W
                                    
                                    
                                       l
                                    
                                 
                                 :
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 /
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       3
                                    
                                 
                              . Selecting the diagonal 
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       4
                                    
                                 
                               for the right patch, we have 
                                 
                                    
                                       W
                                    
                                    
                                       r
                                    
                                 
                                 :
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       4
                                    
                                 
                                 /
                                 
                                    
                                       w
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       5
                                    
                                 
                              . Then, (6) can be rewritten as
                                 
                                    (7)
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                r
                                             
                                          
                                          
                                             
                                                W
                                             
                                             
                                                l
                                             
                                          
                                       
                                       =
                                       
                                          
                                             det
                                             (
                                             
                                                
                                                   b
                                                
                                                
                                                   30
                                                
                                             
                                             ,
                                             
                                                
                                                   b
                                                
                                                
                                                   50
                                                
                                             
                                             ,
                                             
                                                
                                                   b
                                                
                                                
                                                   20
                                                
                                             
                                             )
                                          
                                          
                                             det
                                             (
                                             
                                                
                                                   b
                                                
                                                
                                                   30
                                                
                                             
                                             ,
                                             
                                                
                                                   b
                                                
                                                
                                                   10
                                                
                                             
                                             ,
                                             
                                                
                                                   b
                                                
                                                
                                                   40
                                                
                                             
                                             )
                                          
                                       
                                       .
                                    
                                 
                               Hence, any two smoothly joined pairs of quadric patches have shape parameters with a constant ratio, 
                                 
                                    
                                       W
                                    
                                    
                                       r
                                    
                                 
                                 :
                                 
                                    
                                       W
                                    
                                    
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       W
                                    
                                    
                                       r
                                    
                                    
                                       ′
                                    
                                 
                                 :
                                 
                                    
                                       W
                                    
                                    
                                       l
                                    
                                    
                                       ′
                                    
                                 
                              , which is determined by the control points alone.

We allow extraordinary vertices 
                        v (with planar vertex star) in an A-net, but note that they must be of even valence. This is so, since the quads assembled around a vertex v have their free vertex (the one which is not connected to v by an edge) alternately on different sides of the tangent plane T at v (see Remark 2).

We are now in a position to provide a simple proof of the main result of Huhnen-Venedey and Rörig (2013).


                        
                           Theorem 4
                           
                              Any simply connected A-net whose interior vertices are of even valence and which satisfies the equitwist condition (cf. 
                              
                                 Remark 2) possesses a one-parameter family of smooth extensions to a hyperbolic net (patchwork of smoothly joined rational bilinear patches).
                           


                        
                           Proof
                           We arbitrarily fill a patch into one quad of the A-net and then obtain the others through application of the smoothness condition (5). As we have a simply connected A-net, there are no global closure problems. Hence, it is sufficient to prove consistency around vertices. At a vertex 
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                               of even valence n, we have to ensure that successive patches 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                               and 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                               meet smoothly,
                                 
                                    (8)
                                    
                                       
                                          
                                             w
                                          
                                          
                                             2
                                             i
                                          
                                       
                                       det
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             i
                                             +
                                             1
                                             ,
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             i
                                             +
                                             3
                                             ,
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             i
                                             ,
                                             0
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             w
                                          
                                          
                                             2
                                             i
                                             +
                                             2
                                          
                                       
                                       det
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             i
                                             +
                                             1
                                             ,
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             i
                                             −
                                             1
                                             ,
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             i
                                             +
                                             2
                                             ,
                                             0
                                          
                                       
                                       )
                                       ,
                                       
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       ,
                                    
                                 
                               where indices are taken modulo 2n (see Fig. 3
                              ). Starting to fill in patch 
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                              , i.e., selecting 
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                              , these smoothness conditions yield 
                                 
                                    
                                       w
                                    
                                    
                                       4
                                    
                                 
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       6
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       2
                                       n
                                    
                                 
                              , and then the last patch 
                                 
                                    
                                       P
                                    
                                    
                                       n
                                    
                                 
                               must join smoothly with 
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                               along 
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                              . This amounts to the closure condition
                                 
                                    (9)
                                    
                                       
                                          ∏
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       det
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             i
                                             +
                                             1
                                             ,
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             i
                                             +
                                             3
                                             ,
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             i
                                             ,
                                             0
                                          
                                       
                                       )
                                       =
                                       
                                          ∏
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       det
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             i
                                             +
                                             1
                                             ,
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             i
                                             −
                                             1
                                             ,
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             i
                                             +
                                             2
                                             ,
                                             0
                                          
                                       
                                       )
                                       .
                                    
                                 
                               A determinant is a signed volume of a parallelepiped. Fixing an orientation of the tangent plane 
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                               at 
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                              , we consider the signed area 
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                               of the parallelogram defined by 
                                 
                                    
                                       b
                                    
                                    
                                       2
                                       i
                                       −
                                       1
                                       ,
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       2
                                       i
                                       +
                                       1
                                       ,
                                       0
                                    
                                 
                               and the signed distance 
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                               of 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                              ʼs free vertex 
                                 
                                    
                                       b
                                    
                                    
                                       2
                                       i
                                    
                                 
                               from 
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                              . Then, we have
                                 
                                    
                                       det
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             i
                                             +
                                             1
                                             ,
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             i
                                             +
                                             3
                                             ,
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             i
                                             ,
                                             0
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             A
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                       det
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             i
                                             +
                                             1
                                             ,
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             i
                                             −
                                             1
                                             ,
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             i
                                             +
                                             2
                                             ,
                                             0
                                          
                                       
                                       )
                                       =
                                       −
                                       
                                          
                                             A
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       ,
                                    
                                 
                               so that left and right hand side of (9) are equal, since n is even. □


                        
                           Remark 5
                           We have seen that there is a one-parameter family of smooth extensions of an A-net. The shape parameters 
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                 
                               of these solutions are very closely related: To see this, let us select diagonals in the A-net so that diagonals of quads with a common edge meet at a common vertex of that edge. In view of Eq. (7), we just need to compute one set of parameters, say 
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       W
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 )
                              . Any other solution must have the same ratio of shape parameters and thus be of the form 
                                 λ
                                 ⋅
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       W
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 )
                              .

In this section, we show how to approximate a simply connected, negatively curved surface S (given as a triangle mesh) by a hyperbolic net 
                        H
                     . This includes a global optimization algorithm which we use to get high quality results for problems where we have direct constructions, like extending an A-net to an H-net. Moreover, optimization can be employed also in scenarios where we have no theoretical guarantee that an H-net exists; this is illustrated by surfaces S that are not of disk topology.

The computational pipeline of the approximation algorithm is as follows:
                        
                           •
                           Compute the frame field of asymptotic directions of the input surface S and approximate S by a quad mesh 
                                 Q
                               which follows the asymptotic directions (Section 3.1).

Optimize 
                                 Q
                               to a hyperbolic net 
                                 H
                               approximating S (Section 3.2).

Given a triangle mesh S, we firstly estimate the curvature tensor for the barycenter of each face by the 3rd order jet fit of Cazals and Pouget (2003) and compute the asymptotic directions from it. These asymptotic directions can be considered as a special frame field. Singularities of the asymptotic direction field occur at flat points of the surface S, therefore they are also singularities of the principal direction field. Singularities of a frame field are classified via the cross field of bisectors (in our case, principal directions), and thus – as for the principal direction field – the indices of the asymptotic field are integer multiples of 1/2 (for a proof, see e.g. Zadravec et al., 2010). However, we can show even more (for a proof, see Appendix A):


                              
                                 Theorem 6
                                 
                                    An ordinary flat point (i.e., a surface point whose tangent plane has 2nd order contact with the surface, but not 3rd order contact) which lies inside a surface region with negative Gaussian curvature, is a singularity of index 
                                    
                                       −
                                       1
                                       /
                                       2
                                     
                                    for the principal field and the asymptotic field.
                                 

It has to be expected that higher order flat points can be seen as limit cases of several nearby ordinary flat points. Since indices in an area add up, we conjecture that the index is always negative. For rationalization of freeform structures, the non-generic case is very unlikely to appear: According to Smyth and Xavier (1992), umbilics with an index different from 
                                 ±
                                 1
                                 /
                                 2
                               are critical points of Gaussian curvature K, mean curvature H and, additionally, the 3-jet of 
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 K
                               vanishes there.

Once we have the asymptotic directions on each face, we re-mesh S to obtain a quad mesh 
                                 Q
                               whose edges follow the asymptotic directions. We can make use of quad re-meshing algorithms such as QuadCover (Kälberer et al., 2007) or mixed-integer quadrangulation (Bommes et al., 2009). In our implementation, we adopt the method of Liu et al. (2011), which is a version of mixed-integer quadrangulation.

Since we aim at the optimization of 
                                 Q
                               towards an A-net that is extendable to an H-net, we have to make sure that all inner vertices of 
                                 Q
                               have even valence. As discussed above, a flatpoint of the input surface S will most likely be an ordinary one (index 
                                 −
                                 1
                                 /
                                 2
                              ) and thus lead to a vertex of valence 6. If our conjecture that the index is always negative holds true, we would only get even valences and thus be able to model all cases.

In a quad mesh 
                           Q
                         which follows the asymptotic field, the vertex stars are nearly planar, and thus 
                           Q
                         serves as a good initialization for optimization towards an A-net 
                           A
                         and subsequently towards an H-net 
                           H
                        . We proceed as follows (see the flowchart in Fig. 4
                        ):
                           
                              1.
                              Taking the quad mesh 
                                    Q
                                  as input, we optimize it towards an A-net 
                                    A
                                 , i.e., we flatten its vertex stars while keeping fairness and proximity to the reference surface S.

We extend the A-net 
                                    A
                                  to a hyperbolic net 
                                    H
                                  by computing the best possible shape parameters, avoiding unnecessarily high mean curvature in patches. This step has an explicit solution.

We fix the shape parameters and update mesh vertices by a global optimization of the H-net 
                                    H
                                  to achieve an even better curvature behavior and satisfaction of constraints to higher precision. This step is iterated with the 2nd step, as illustrated in Fig. 4.

The quad mesh 
                                 Q
                               provides a good initialization for optimization towards an A-net 
                                 A
                              , which we obtain by minimizing the following objective function,
                                 
                                    (10)
                                    
                                       
                                          
                                             F
                                          
                                          
                                             anet
                                          
                                       
                                       (
                                       b
                                       )
                                       =
                                       
                                          ∑
                                          i
                                       
                                       
                                          
                                             F
                                          
                                          
                                             p
                                          
                                       
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             fairness
                                          
                                       
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             prox
                                          
                                       
                                       .
                                    
                                 
                               Here 
                                 
                                    
                                       F
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 )
                               ensures planarity of the vertex star around vertex 
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                              , 
                                 
                                    
                                       F
                                    
                                    
                                       fairness
                                    
                                 
                               aims at high mesh fairness and 
                                 
                                    
                                       F
                                    
                                    
                                       prox
                                    
                                 
                               makes sure that the mesh stays close to the reference surface S.

The proximity term 
                                 
                                    
                                       F
                                    
                                    
                                       prox
                                    
                                 
                               is composed of two parts: the squared distance of each vertex 
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                               to its closest point 
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                    
                                       c
                                    
                                 
                               on S and the squared distance of 
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                               to the tangent plane of S at 
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                    
                                       c
                                    
                                 
                              . This yields a good approximation of the squared distance function of S, especially in our case, where one is close to S and gives the tangent plane distance a higher weight (see e.g. Pottmann and Leopoldseder, 2003).


                              Fairness is achieved with an energy 
                                 
                                    
                                       F
                                    
                                    
                                       fairness
                                    
                                 
                               which is a sum of squares of second or third order differences at vertices of all those mesh polylines which should be fair; we follow Deng et al. (2011).

To handle planarity of vertex stars, we have two options: (i) We can add to each mesh vertex 
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                               a vertex normal 
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                               as additional variable and in this way define the plane of the vertex star. Then 
                                 
                                    
                                       F
                                    
                                    
                                       p
                                    
                                 
                               is the sum of squared plane distances of direct neighbor vertices (see Deng et al., 2011). (ii) Planarity of a vertex star is expressed by planarity of a number of quads, where quad planarity is measured by the squared diagonal distance 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                              . In fact, as a planarity measure of a quad 
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                 
                               we only employ the following approximation of 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                              ,
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             quad
                                          
                                       
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             3
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             (
                                             n
                                             ⋅
                                             d
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                    
                                 
                               where 
                                 n
                                 =
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       02
                                    
                                 
                                 ×
                                 
                                    
                                       b
                                    
                                    
                                       13
                                    
                                 
                                 )
                                 /
                                 ‖
                                 
                                    
                                       b
                                    
                                    
                                       02
                                    
                                 
                                 ×
                                 
                                    
                                       b
                                    
                                    
                                       13
                                    
                                 
                                 ‖
                               is a unit vector orthogonal to both diagonals and 
                                 d
                                 :
                                 =
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 /
                                 2
                              . Obviously, to achieve planarity of a vertex star of valence n, we need to ensure planarity of 
                                 n
                                 −
                                 2
                               quads. This is the approach taken in our implementation.

For numerical optimization, we use a Gauss–Newton method. At the end of this step, we have an A-net 
                                 A
                              .

Based on the smoothness condition (7) and Remark 5, we can easily extend an A-net 
                                 A
                               to an H-net 
                                 H
                               by computing the shape parameter 
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                 
                               of each patch 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                              . Starting at an arbitrary patch 
                                 
                                    
                                       P
                                    
                                    
                                       0
                                    
                                 
                               to which we assign an initial parameter 
                                 
                                    
                                       W
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 1
                              , we move to neighboring faces and compute via (7) their shape parameters. This results in an initial set of parameters 
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       W
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 )
                              . Any other shape parameter set is of the form 
                                 λ
                                 ⋅
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       W
                                    
                                    
                                       1
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 )
                              . To determine the optimal factor λ, we try to achieve patches whose shape parameter 
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                 
                               is not close to 0 or ∞. This is achieved by minimizing
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             s
                                             h
                                             a
                                             p
                                             e
                                          
                                       
                                       =
                                       
                                          ∑
                                          i
                                       
                                       
                                          [
                                          
                                             
                                                (
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      i
                                                   
                                                
                                                −
                                                1
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                (
                                                
                                                   1
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                −
                                                1
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          ]
                                       
                                       ,
                                    
                                 
                               or equivalently
                                 
                                    (11)
                                    
                                       
                                          
                                             F
                                          
                                          
                                             s
                                             h
                                             a
                                             p
                                             e
                                          
                                       
                                       (
                                       λ
                                       )
                                       =
                                       
                                          ∑
                                          i
                                       
                                       
                                          [
                                          
                                             
                                                (
                                                λ
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      0
                                                   
                                                
                                                −
                                                1
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                (
                                                
                                                   1
                                                   
                                                      λ
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                −
                                                1
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          ]
                                       
                                       .
                                    
                                 
                               Minimization of this univariate function amounts to computing the roots of a quartic polynomial and thus this problem has an explicit solution.

This step is taken for two reasons. (i) Numerical optimization is limited to a certain accuracy and thus vertex stars in 
                                 A
                               are not fully planar, resulting in small deviations from smooth patch joints in 
                                 H
                              . (ii) More importantly, the shape parameters for 
                                 H
                               are computed from a given 
                                 A
                              , and there is hope that by slightly changing 
                                 A
                               we get an even better curvature behavior of the quadric patches in 
                                 H
                              .

The entire global optimization of 
                                 H
                               alternates between Step 3, which updates the mesh vertices (shape parameters fixed) and Step 2 (which updates shape parameters, but keeps vertices fixed). Here, we only have to discuss the update of vertices in 
                                 H
                              . We want to jointly address the A-net property and smoothness of patch joints (with fixed weights). For a smooth joint of two patches along an edge, say 
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                 
                              , frame points 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                              , 
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                               should be co-planar with that edge, see Fig. 2. Hence, we add an extra planarity term for the frame points. Recall that the frame points are computed from the weights (shape parameters), which are fixed in this step. Summarizing, the target functional is
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             frame
                                          
                                       
                                       (
                                       b
                                       )
                                       =
                                       
                                          
                                             F
                                          
                                          
                                             anet
                                          
                                       
                                       (
                                       b
                                       )
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             3
                                          
                                       
                                       
                                          ∑
                                          j
                                       
                                       
                                          
                                             F
                                          
                                          
                                             quad
                                          
                                       
                                       
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                0
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                f
                                             
                                             
                                                1
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                b
                                             
                                             
                                                3
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                f
                                             
                                             
                                                4
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                               Here the superscript j is used to enumerate all adjacent quad faces (inner edges).

@&#RESULTS AND DISCUSSION@&#

We provide a number of examples which partially go beyond the limits of the theory and demonstrate the capabilities and limitations of our optimization framework.

For visualization of surface quality, we provide a sensitive analysis tool, namely isophotes. Isophotes are those curves on a surface Φ along which the angle between the surface normal and a given fixed vector is constant. Thus, isophotes are typically one differentiation class below that of the surface. In particular, for a smooth (tangent plane continuous) surface Φ, isophotes are continuous, but in general exhibit tangent discontinuities at curvature discontinuities of Φ. Discontinuities in isophotes belong to tangent plane discontinuities of Φ.

Results of our optimization on simply connected surfaces are depicted in Fig. 5
                              . We can clearly see the smoothness of the surfaces. In fact, isophotes do not exhibit large kinks, indicating that the surfaces are in most parts nearly curvature continuous. This is also confirmed by the mean curvature plots in Fig. 6
                              , which further show that only few patches are highly curved at a diagonal.

To test the limits of optimization, we applied the algorithm to surfaces which are not simply connected. As Fig. 7
                               shows, the resulting H-nets of non-simply connected surfaces can be reasonably smooth. The kink angles are shown in Table 1
                              . These mild deviations from smoothness are visible in partially rather strong discontinuities of isophotes. Fig. 7 shows three minimal surfaces which are not simply connected.

We use a part of a design by Zaha Hadid Architects for the Cagliari Contemporary Arts Center project. The model is basically a negatively-curved surface. However, small parts of the model are nearly flat or of positive Gaussian curvature. We model it with a fixed boundary curve, but allow a higher deviation from the reference surface in the areas of non-negative Gaussian curvature. The resulting H-net is shown by Fig. 8
                              .

We also show the optimization details of our examples in Table 1. As expected, the simply connected surfaces require a smaller number of patches to achieve a good approximation, while the surfaces with multiple connections need larger H-nets and still produce higher kink angles.

Using smoothly joined ruled patches we can only model negatively curved surfaces. In order to get rid of this restriction, we need more general patches. Next to straight lines, circular arcs are probably easiest to manufacture, and thus we look for patches which carry two families of circular arcs. Darboux cylide patches are good candidates for this task, especially since they can easily be obtained from ruled quadric patches (see e.g. Pottmann et al., 2012, in particular Proposition 9). For our purposes it is sufficient to realize that so-called Darboux transformations (discussed below) transform ruled quadrics into Darboux cyclides (Remark 10 in Pottmann et al., 2012). Therefore, they transform hyperbolic nets to smooth surfaces composed of Darboux cyclide patches.

Darboux transformations occur in non-Euclidean geometry, where they are used for the transfer from the projective model of elliptic or hyperbolic geometry to the corresponding conformal model. Without reference to non-Euclidean geometry we may define them in 3D as follows: Embed points 
                        x
                        ∈
                        
                           
                              R
                           
                           
                              3
                           
                        
                      into 4-space 
                        
                           
                              R
                           
                           
                              4
                           
                        
                     , e.g. as 
                        (
                        x
                        ,
                        1
                        )
                     , and project them from a center C onto the unit sphere 
                        Σ
                        :
                        
                           
                              x
                           
                           
                              1
                           
                           
                              2
                           
                        
                        +
                        ⋯
                        +
                        
                           
                              x
                           
                           
                              4
                           
                           
                              2
                           
                        
                        =
                        1
                     . Then, perform stereographic projection σ of Σ. We choose the projection center C as 
                        (
                        0
                        ,
                        0
                        ,
                        0
                        ,
                        c
                        )
                      with 
                        c
                        ≠
                        1
                     . Then, the straight line connecting C and 
                        (
                        x
                        ,
                        1
                        )
                      is parameterized as 
                        (
                        λ
                        x
                        ,
                        c
                        +
                        λ
                        (
                        1
                        −
                        c
                        )
                        )
                     . Its intersection points with Σ are characterized by
                        
                           
                              λ
                              =
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    c
                                    ±
                                    
                                       
                                          
                                             
                                                (
                                                c
                                                −
                                                1
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          (
                                          1
                                          −
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          (
                                          c
                                          −
                                          1
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              .
                           
                        
                      Stereographic projection from center 
                        (
                        0
                        ,
                        0
                        ,
                        0
                        ,
                        1
                        )
                      onto 
                        
                           
                              x
                           
                           
                              4
                           
                        
                        =
                        0
                      is given by
                        
                           
                              σ
                              :
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    4
                                 
                              
                              )
                              ↦
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    3
                                 
                              
                              )
                              /
                              (
                              1
                              −
                              
                                 
                                    x
                                 
                                 
                                    4
                                 
                              
                              )
                              ,
                           
                        
                      and thus we obtain for the Darboux transformation,
                        
                           
                              x
                              ↦
                              
                                 
                                    λ
                                    x
                                 
                                 
                                    (
                                    1
                                    −
                                    c
                                    )
                                    (
                                    1
                                    −
                                    λ
                                    )
                                 
                              
                              .
                           
                        
                      We prefer to scale the image with 
                        1
                        −
                        c
                     , and this finally yields the Darboux transformation
                        
                           (12)
                           
                              δ
                              :
                              x
                              ↦
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    c
                                    ±
                                    
                                       
                                          
                                             
                                                (
                                                c
                                                −
                                                1
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          (
                                          1
                                          −
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    1
                                    −
                                    c
                                    ∓
                                    
                                       
                                          
                                             
                                                (
                                                c
                                                −
                                                1
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          (
                                          1
                                          −
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                              ⋅
                              x
                              .
                           
                        
                      By construction, the two image points 
                        δ
                        (
                        x
                        )
                      are related to each other by an inversion with respect to a (not necessarily real) sphere Λ. This sphere is obtained as follows: Intersect the polar hyperplane 
                        
                           
                              x
                           
                           
                              4
                           
                        
                        =
                        1
                        /
                        c
                      of C with respect to Σ with Σ; this results in general (
                        C
                        ∉
                        Σ
                     , i.e. 
                        c
                        ≠
                        −
                        1
                     ) in a real or imaginary sphere ⊂Σ whose stereographic image has the equation 
                        
                           
                              x
                           
                           
                              1
                           
                           
                              2
                           
                        
                        +
                        
                           
                              x
                           
                           
                              2
                           
                           
                              2
                           
                        
                        +
                        
                           
                              x
                           
                           
                              3
                           
                           
                              2
                           
                        
                        =
                        (
                        c
                        +
                        1
                        )
                        /
                        (
                        c
                        −
                        1
                        )
                     . After scaling with 
                        1
                        −
                        c
                     , we arrive at the sphere 
                        Λ
                        :
                        
                           
                              x
                           
                           
                              1
                           
                           
                              2
                           
                        
                        +
                        
                           
                              x
                           
                           
                              2
                           
                           
                              2
                           
                        
                        +
                        
                           
                              x
                           
                           
                              3
                           
                           
                              2
                           
                        
                        =
                        
                           
                              c
                           
                           
                              2
                           
                        
                        −
                        1
                     .

It is appropriate to use Möbius geometry in image space, i.e., consider straight lines as circles and planes as spheres. Then we can state: A Darboux transformation maps a straight line to a Möbius circle and a plane to a Möbius sphere (these circles and spheres are orthogonal to Λ). If the center C is not inside Σ (
                        |
                        c
                        |
                        >
                        1
                     ), these images need not be real. If C lies on Σ (
                        c
                        =
                        −
                        1
                     ), δ becomes an inversion. To get the most general Darboux transformations, we may at first apply a projective map in 3-space and then the mapping (12).

The most important property for our purposes is the fact that a rational bilinear patch is mapped to a pair of Darboux cyclide patches (inverse with respect to the sphere Λ) and thus a hyperbolic net is mapped to a pair of smooth surfaces composed of Darboux cyclide patches.

We implemented a free-form deformation tool based on Darboux transformations. The H-net to be transformed is embedded in a box acting as a control cage. The cage is then deformed exploiting the 16 degrees of freedom (15 for the choice of an initial projective transformation and 1 for c). Note that the transformed cage pair has circular edges and spherical faces. The transformation of the cage allows one to get a better feeling of the way how δ will transform an object embedded in it. Examples are shown in Fig. 9
                     .

Applying CAGD methods to a very recent development in discrete differential geometry, namely H-nets, and combining it with numerical optimization, we showed how to approximate a given negatively curved surface S with a smooth surface composed of ruled quadric patches. Limitations have been discussed and the applicability of the optimization framework beyond theoretical guarantees has been tested. Through Darboux transformations, we obtained a first method for smoothly joining Darboux cyclide patches.

Smooth or approximately smooth patchworks from Darboux cyclides will require further studies; in particular, we did not yet show how to approximate general freeform surfaces. This may require an approach which avoids Darboux transformations and directly works with an appropriate control structure of the cyclide patches.

More generally, we are interested in smooth extensions of discrete structures – or slightly reformulated – in discrete structures which are actually smooth composites of simple elements. It could turn out that certain low degree spline curves and surfaces possess remarkable properties in discrete differential geometry, especially in those groups (affine, projective) where the classical theory requires higher order derivatives.

@&#ACKNOWLEDGEMENTS@&#

This research was supported in part by the DFG-Collaborative Research Center, TRR 109, Discretization in Geometry and Dynamics, through grant I 706-N26 of the Austrian Science Fund (FWF). We thank Udo Hertrich-Jeromin and Johannes Wallner for stimulating discussions and the reviewers for their excellent comments and suggestions.

We use a local coordinate system with the flat point p at the origin and with 
                        z
                        =
                        0
                      as tangent plane at p. Locally, the surface can be written in Monge form, 
                        z
                        =
                        f
                        (
                        x
                        ,
                        y
                        )
                     , and since 
                        z
                        =
                        0
                      is a 2nd order approximant, the Taylor expansion of 
                        f
                        (
                        x
                        ,
                        y
                        )
                      starts with cubic terms (which do not vanish since the flat point is ordinary). Hence, it suffices to prove the result for the special surface,
                        
                           (13)
                           
                              z
                              =
                              f
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 
                                    b
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    3
                                 
                              
                              +
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              y
                              +
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              x
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    3
                                 
                              
                              .
                           
                        
                      There are 3 types of ordinary umbilics, which are sometimes called star (index 
                        −
                        1
                        /
                        2
                     ), monstar and lemon (both of index 1/2). The star type is characterized by (see Cazals and Pouget, 2004),
                        
                           (14)
                           
                              
                                 
                                    b
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              −
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                              
                              −
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              <
                              0
                              .
                           
                        
                      We claim that this inequality is always fulfilled since the flat point lies in a negatively curved area: Negative Gaussian curvature K is expressed by a negative determinant of the Hessian of f: 
                        
                           
                              f
                           
                           
                              x
                              x
                           
                        
                        
                           
                              f
                           
                           
                              y
                              y
                           
                        
                        −
                        
                           
                              f
                           
                           
                              x
                              y
                           
                           
                              2
                           
                        
                        <
                        0
                     . For the surface (13), this condition reads
                        
                           
                              
                                 (
                                 3
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              +
                              (
                              9
                              
                                 
                                    b
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                              
                              −
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              )
                              x
                              y
                              +
                              
                                 (
                                 3
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       3
                                    
                                 
                                 −
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              <
                              0
                              .
                           
                        
                      It has to hold for all 
                        (
                        x
                        ,
                        y
                        )
                        ≠
                        (
                        0
                        ,
                        0
                        )
                     , which implies
                        
                           
                              3
                              
                                 
                                    b
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              −
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              <
                              0
                              ,
                              
                              3
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                              
                              −
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              <
                              0
                              ,
                           
                        
                      and shows that (14) is satisfied.  □

@&#REFERENCES@&#

