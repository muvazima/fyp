@&#MAIN-TITLE@&#Registration of images with affine geometric distortion based on Maximally Stable Extremal Regions and phase congruency

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A combination of coarse alignment and refinement is employed in the method.


                        
                        
                           
                           Input images are coarsely aligned by fitting and normalizing the matched MSERs.


                        
                        
                           
                           A phase congruency and point set registration based refinement step is used.


                        
                        
                           
                           The method accurately and efficiently aligns images with affine distortions.


                        
                        
                           
                           The method is robust to illumination changes.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image registration

Affine transformation

Maximally Stable Extremal Region

Phase congruency

Point set registration

@&#ABSTRACT@&#


               
               
                  This paper proposes a novel method to address the registration of images with affine transformation. Firstly, the Maximally Stable Extremal Region (MSER) detection method is performed on the reference image and the image to be registered, respectively. And the coarse affine transformation matrix between the two images is estimated by the matched MSER pairs. Two circular regions containing roughly the same image content are also obtained by fitting and normalizing the centroids of the matched MSERs from the two images. Secondly, a scale invariant and approximate affine transformation invariant feature point detection algorithm based on the Gabor filter decomposition and phase congruency is performed on the two coarsely aligned regions, and two feature point sets are achieved, respectively. Finally, the affine transformation matrix between the two feature point sets is obtained by using a probabilistic point set registration algorithm, and the final affine transformation matrix between the reference image and the image to be registered is achieved according to the coarse affine transformation matrix and the affine transformation matrix between the two feature point sets. Several sets of experiments demonstrate that our proposed method performs competitively with the classical scale-invariant feature transform (SIFT) method for images with scale changes, and performs better than the traditional MSER and Affine-SIFT (ASIFT) methods for images with affine distortions. Moreover, the proposed method shows higher computation efficiency and robustness to illumination change than some existing area-based or feature-based methods do.
               
            

@&#INTRODUCTION@&#

Image registration is to overlay two or more images containing the same scene shot at different times, from different viewpoints or by different sensors [1]. It has been widely applied to many fields, such as image stitching [2], image fusion [3], and 3D reconstruction [4]. Because of the different structures caused by different viewpoints, the alignment for image pairs with affine geometric distortion is much more difficult than that for images with some simple transformations (e.g., translation, rotation and scaling). This paper proposes a novel method by using a two-step way, i.e., by combining a coarse alignment based on feature region detection and a refinement based on feature point detection, to address the registration of images with affine transformation.

So far, there have been numbers of image registration algorithms, which can be divided into two categories [1], i.e., area-based and feature-based methods. The area-based image registration methods [5–9] generally employ some optimization algorithms to search the transformation model between two input images, in which some windows of predefined size or even the whole image is used [1]. However, if there is large affine distortion between images, these area-based methods will obtain some unsatisfactory results. In addition, the huge parameter space of the transformation model often leads to high computation complexity [1]. Differently, the feature-based methods [10–15] utilize the salient features instead of image intensities to determine the transformation model between the two input images. They are more robust to some complex geometric deformations, such as the affine distortion, and have higher computation efficiency than the area-based ones do [1]. Therefore, the feature-based methods are more widely used to align images with complex geometric distortions [1].

Especially, many feature-based methods have been proposed to align images with affine geometric distortion. For example, Flusser and Suk [13] utilized closed-boundary region features to align the SPOT and Landsat images, in which the moment-based invariants were used to describe the regions. Yang and Cohen [14] computed the affine geometric invariants of the border triangles generated by object convex hull. They successfully recovered the affine transformation and mapped the reference object into the test object domain. Moreover, some affine invariant region detectors, such as Harris–Laplace [16], Hessian–Laplace [17], Maximally Stable Extremal Region (MSER) [18] and the improved MSER [19] have been proposed. These detectors can effectively detect invariant regions from the image pairs. And the centroids of the detected regions are often used to establish the geometrical relationship and estimate the affine transformation model. But the shapes of the detected regions are usually unstable because of some image distortions, such as affine distortion, scale change, illumination change and blur. This influences the localization accuracy of each detected region's centroid, and reduces the final registration precision.

Compared with region features, point features, such as Harris corners [20] and Scale Invariant Feature Transform (SIFT) [21] points, usually have more stable localization against those image distortions mentioned above. Higher registration precisions may be achieved by using point features instead of region features to estimate the transformation model between the image pairs. For instance, Lin and Du et al. [15] used the correlation between the edge images to determine the homologous corner points, and then established the affine transformation model between the two input images. It should be noted that most of the feature point detection methods are not affine invariant, although some methods (e.g., SIFT) can obtain many correspondences from images with a narrow range of affine transformation. Generally, low feature repeatability rate [22]
                     
                        1
                     
                     
                        1
                        The feature repeatability rate is the percentage of the total observed features that are detected in both images. More details can be seen in [22].
                      is obtained when these feature point detectors are directly performed on the images with affine geometric distortion, especially when the affine distortion is too large. This reduces the registration precisions to some extent. Recently, Morel and Yu [23] proposed a fully affine invariant feature detection method, i.e., Affine-SIFT (ASIFT), by which, good registration results can be obtained on images with large affine geometric distortion. However, the computation complexity of the ASIFT is very high, which limits its application in aligning images of large size. Considering the affine invariance of the region features and the high localization accuracy of the point features, more point correspondences with high feature repeatability rate will be obtained if the feature point detection is performed on the detected affine invariant regions instead of on the original image pairs. Correspondingly, the registration results will also be improved by the combination of point and region detections.

In this paper, a novel affine image registration method is proposed based on the Maximally Stable Extremal Region (MSER) [18] and phase congruency [24,25]. In the proposed algorithm, two circular image regions are firstly obtained by fitting and normalizing the matched MSERs, and the coarse affine transformation matrix between the two input images is thus estimated. Secondly, a point detection algorithm (GDPC, for short) based on the Gabor filter decomposition and the maximal phase congruency moment [26] is performed on the two circular regions. Two sets of points with scale and approximate affine invariance are thus obtained from the reference image and the image to be registered, respectively. Finally, the point set registration method in [27] is performed on the two point sets and the transformation matrix between them is obtained. The final affine transformation matrix between the input image pairs is achieved according to the coarse affine transformation matrix and the affine transformation matrix between the two feature point sets.

The proposed method is an adaptation of a number of commonly used techniques. But it should be noted that the proposed method is not a simple combination of the existing methods. Three main contributions are made in this paper. (1) The proposed registration method is implemented by using a two-step way, i.e., the region feature based coarse alignment and the point feature based refined registration. By the combination of the two steps, the proposed method makes best use of the affine-invariance of the region detectors and the localization accuracy of the point detectors, and then outperforms some traditional registration methods, such as the SIFT, MSER and ASIFT methods, for images with scale or affine distortions. (2) A novel MSER based registration method is proposed in the coarse alignment step. Instead of directly using the matched MSER pairs to estimate the transformation matrix, we first obtain two coarsely aligned circular regions by fitting and normalizing the matched MSER pairs in the reference image and the image to be registered, and then obtain the coarse estimation of the transformation matrix according to the relationship between the two circular regions. By this way, the parameters in the transformation matrix model are more easily estimated due to the fact that there mainly exist scale and rotation geometric distortions between the two circular regions after normalization. More feature points and higher feature repeatability rate in the subsequent refinement step will also benefit from the two coarsely aligned circular regions considering the fact that they contain more common image contents than any individual matched MSER pair. In addition, we present a new method to exclude the mismatched MSER pairs by using a voting mechanism in the coarse alignment of the sub-regions. (3) A phase congruency based feature point detection method (i.e., GDPC method) and a point set registration method are jointly employed to refine the coarse alignment. The employed GDPC point detector improves the robustness of the proposed registration method to illumination change. And the employed point set registration algorithm avoids the construction of descriptors for the detected feature points in the refinement step and increases the computation efficiency of the proposed method to some extent.

The rest of the paper is organized as follows. Section 2 gives a brief introduction to the related work. In Section 3, the diagram of the proposed image registration approach is provided, which consists of three parts. And the three parts will be described in detail in Sections 4, 5 and 6, respectively. Experimental results are presented in Section 7 and some conclusions are drawn in Section 8.

@&#RELATED WORK@&#

In general, the feature-based image registration methods consist of four basic steps [1], i.e., feature detection, feature matching, transformation model estimation, and image re-sampling and transformation, among which feature extraction and matching are paid more attentions due to their crucial roles.

In the past several decades, numbers of feature point detection methods have been proposed, and most of them are based on image gradient. For example, Harris corner detector [20], proposed by Harris and Stephens, is rotation invariant and is taken as the best one to extract “L” junctions [28]. However, Harris detector is sensitive to contrast and noise and is not scale invariant. Scale Invariant Feature Transform (SIFT) [21], a landmark in feature detection, is robust to noise, scale and illumination change to some extent. As well, it has a good performance on images with a narrow range of affine transformation [21]. Various improved algorithms based on the SIFT have also been proposed, such as Speed Up Robust Features (SURF) [29], Principal Component Analysis SIFT (PCA-SIFT) [30] and Gradient Location–Orientation Histogram (GLOH) [31]. However, these methods may fail in the case of large affine distortions. Recently, a fully affine invariant algorithm, i.e., Affine-SIFT (ASIFT), has been proposed [23]. The ASIFT firstly simulates several possible affine distortions caused by varying orientation parameters of the camera axis and then applies the SIFT method to detect feature points on each simulated image, by which a large amount of feature points with affine invariant are obtained. Sufficient correct matches are obtained by the ASIFT, but many more useless feature points are also produced, which leads to a low feature repeatability rate. Furthermore, these redundant feature points cost a huge amount of memory space and query time, which limits its applications in detecting features from large size images.

In addition, these image gradient based feature point detection methods are sensitive to some image distortions, including geometric distortion (e.g., scale, rotation and affine transformations), illumination change and noise. In [24], Kovesi proposed a dimensionless measure for the significance of a local structure, i.e., phase congruency. Rather than defining features at points with sharp changes in intensity, the phase congruency indicates that image points, whose Fourier components are maximally in phase, can be regarded as significant features. The phase congruency has been widely used in many image processing tasks [25,32–34]. Particularly, in [25], Kovesi applied the phase congruency to ‘corner’ point detection by using the maximum and minimum moments. The proposed detector shows good localization and high robustness to the contrast, illumination and noise. However, similar to the Harris corner detector, it is also not scale invariant.

Besides the point-based feature detection algorithms, some other feature detection methods were proposed, such as the edge-based [35,36] and region-based ones [16–18]. Especially, the region-based feature detection methods, for example, Harris–Laplace [16], Hessian–Laplace [17] and MSER [18] are usually more robust to the affine geometric distortion and have high computation efficiencies. However, the shapes of the detected regions are usually unstable, which will lead to lower accuracy of localization (e.g., the computation of the detected region's centroid) than the detected points.

In addition to the feature detectors, the descriptor, i.e., how to describe the detected features uniquely and stably, is another important factor in these feature detection and matching methods. In order to improve the distinctiveness and correct matching rate of the detected features, high dimensions of descriptor vectors are generally required. For example, the dimension of the SIFT descriptor vector is 128, which increases the computation complexities of the subsequent processing tasks (e.g., feature matching). Recently, in order to achieve lower computational cost, some fast binary descriptors such as Binary Robust Invariant Scalable Keypoints (BRISK) [37], Binary Descriptor Very Fast (BRIEF) [38], and Fast Retina Keypoint (FREAK) [39] were proposed. But these methods often compromise between the matching accuracy and the calculating speed [40]. Differently, in [27], a novel point set registration algorithm was presented for the affine transformation model, in which, the descriptors for the feature points are not required and only the probability distributions of the feature points are employed. Moreover, the transformation and correspondences between the two point sets can be simultaneously determined by the algorithm.

As shown in Fig. 1
                     , the proposed image registration method consists of three main parts: sub-regions coarse matching, feature point extraction and transformation matrix estimation. (1) Sub-region coarse alignment based on MSER detection and matching: MSERs [18] are first extracted and matched from the reference image and the image to be registered, respectively. Then two circular regions are obtained by fitting and normalizing the matched MSER pairs in each image, and the coarse affine transformation matrix between the two input images is calculated. (2) Feature point detection based on Gabor filter decomposition and phase congruency: A series of band-pass Gabor filters are first constructed to decompose the circular regions obtained above into several sub-bands. Then, two sets of feature points are obtained by performing the maximum phase congruency moment based feature detection algorithm on the two sets of sub-bands, respectively. (3) Final transformation matrix estimation: A probabilistic model [27] is first built to describe the distributions for the two feature point sets (i.e., the two sets of feature points detected above). Then, according to the distributions of the two point sets, the parameters of the affine transformation model between the two point sets are achieved. Finally, the final transformation matrix between the two input images is calculated according to the coarse affine transformation matrix between the two input images and the affine transformation matrix between the two feature point sets. In the following sections, we will discuss each part in detail.

In general, each detected or matched MSER in the reference image or the image to be registered can be directly employed in the subsequent processing (e.g. point detection and transformation matrix estimation). However, one MSER often contains limited features, which will increase the transformation matrix estimation error or reduce the numbers of the detected feature points. Therefore, in the proposed algorithm, all of the matched MSERs are firstly fitted and normalized into one circular region in the reference image and the image to be registered, respectively. Then the coarse affine transformation matrix between the two input images is calculated according to the two circular regions. Moreover, the two circular regions will be employed again in the subsequent feature point detection to detect feature points with high repeatability rate, which will be discussed in Section 5.

The Maximally Stable Extremal Region (MSER) detector [18] is based on the Watershed segmentation and is affine invariant. In addition, it has the advantages of high computation efficiency and detection accuracy over some other affine invariant region detectors [41], such as Harris–Laplace [16] and Hessian–Laplace [17]. Therefore, we employ the MSER detector to coarsely estimate the affine transformation matrix between the two input images.

In the MSER extraction algorithm [18], MSERs are defined by an extremal property of the intensity function in an image region and on its outer boundary. Let Q
                        
                           t
                         be an extremal region of an image. The pixel values inside it are either strictly higher or lower than those on its boundary, where the intensity value is exactly equal to t. Then the stability of Q
                        
                           t
                         is defined as
                           
                              (1)
                              
                                 ζ
                                 
                                    
                                       Q
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       A
                                       
                                          
                                             Q
                                             t
                                          
                                       
                                    
                                    
                                       
                                          d
                                          
                                             d
                                             t
                                          
                                       
                                       A
                                       
                                          
                                             Q
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        where A(Q
                        
                           t
                        ) denotes the area of Q
                        
                           t
                        . The region Q
                        
                           t
                         is called maximally stable if ζ(Q
                        
                           t
                        ) has a local maximum at t. By the MSER algorithm, two sets of the MSERs are detected from the reference image and the image to be registered, respectively. More details can be seen in [18].

Each detected MSER with irregular shape is firstly fitted into an elliptical region and then normalized into a circular one, which is further described by a 128-element vector. In this paper, we employ the same matching strategy as that in [21] to obtain the matched MSERs, which are represented as
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             Ω
                                             i
                                          
                                          
                                             Ω
                                             i
                                             ′
                                          
                                       
                                       
                                          
                                             
                                                Ω
                                                i
                                             
                                             ⊂
                                             I
                                             ,
                                             
                                                Ω
                                                i
                                                ′
                                             
                                             ⊂
                                             
                                                I
                                                ′
                                             
                                             ,
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             K
                                          
                                       
                                    
                                 
                              
                           
                        where, I and I′ are the reference image and the image to be registered, respectively. (Ω
                        
                           i
                        ,
                        Ω
                        
                           i
                        
                        ′) represents the ith matched MSER pair and K denotes the total number of the matched pairs.

As discussed in the earlier part of this section, each matched MSER Ω
                        
                           i
                         (or Ω
                        
                           i
                        
                        ′) may contain limited features. Therefore, all of the MSERs in the reference image or the image to be registered are fitted into a big elliptical region to provide more useful information before further being processed. The fitting of the matched MSER pairs is computed as follows.

Firstly, compute the region centroids (x
                        
                           i
                        ,
                        y
                        
                           i
                        )
                           T
                         and (x
                        
                           i
                        
                        ′,
                        y
                        
                           i
                        
                        ′)
                           T
                         for each pair of matched MSERs Ω
                        
                           i
                         and Ω
                        
                           i
                        
                        ′ in Eq. (2), and obtain a set of points P and P′ for the reference image and the image to be registered, respectively, i.e.,
                           
                              (3)
                              
                                 P
                                 =
                                 
                                    
                                       
                                          x
                                          i
                                       
                                       
                                          
                                             
                                                x
                                                i
                                             
                                             =
                                             
                                                
                                                   
                                                      x
                                                      i
                                                   
                                                   
                                                      y
                                                      i
                                                   
                                                
                                                T
                                             
                                             ,
                                             
                                                x
                                                i
                                             
                                             ∈
                                             I
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             K
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    P
                                    ′
                                 
                                 =
                                 
                                    
                                       
                                          x
                                          i
                                          ′
                                       
                                       
                                          
                                             
                                                x
                                                i
                                                ′
                                             
                                             =
                                             
                                                
                                                   
                                                      x
                                                      i
                                                      ′
                                                   
                                                   
                                                      y
                                                      i
                                                      ′
                                                   
                                                
                                                T
                                             
                                             ,
                                             
                                                x
                                                ′
                                             
                                             ∈
                                             
                                                I
                                                ′
                                             
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             K
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Secondly, for the point sets P and P′, compute their mean and covariance matrix as
                           
                              (5)
                              
                                 μ
                                 =
                                 
                                    1
                                    K
                                 
                                 
                                    
                                       ∑
                                       
                                          
                                             x
                                             i
                                          
                                          ∈
                                          P
                                       
                                    
                                    
                                       
                                          x
                                          i
                                       
                                    
                                 
                                 ,
                                 
                                 U
                                 =
                                 
                                    1
                                    K
                                 
                                 
                                    
                                       ∑
                                       
                                          
                                             x
                                             i
                                          
                                          ∈
                                          P
                                       
                                    
                                    
                                       
                                          
                                             
                                                x
                                                i
                                             
                                             −
                                             μ
                                          
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                   i
                                                
                                                −
                                                μ
                                             
                                          
                                          T
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    μ
                                    ′
                                 
                                 =
                                 
                                    1
                                    K
                                 
                                 
                                    
                                       ∑
                                       
                                          
                                             x
                                             i
                                             ′
                                          
                                          ∈
                                          P
                                       
                                    
                                    
                                       
                                          x
                                          i
                                          ′
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    U
                                    ′
                                 
                                 =
                                 
                                    1
                                    K
                                 
                                 
                                    
                                       ∑
                                       
                                          
                                             x
                                             i
                                             ′
                                          
                                          ∈
                                          P
                                       
                                    
                                    
                                       
                                          
                                             
                                                x
                                                i
                                                ′
                                             
                                             −
                                             
                                                μ
                                                ′
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                   i
                                                   ′
                                                
                                                −
                                                
                                                   μ
                                                   ′
                                                
                                             
                                          
                                          T
                                       
                                    
                                 
                              
                           
                        where, μ and U represent the mean and the covariance matrix of P, respectively. μ′ and U′ represent the mean and the covariance matrix of P′. In general, both U and U′ are symmetric and invertible matrices.
                           2
                        
                        
                           2
                           The covariance matrix U or U′ is not invertible when all of the points in P or P′ lie on a straight line. However, this case rarely happens.
                        
                     

Finally, fit all of the points in P and P′ (i.e., the matched MSERs {Ω
                        
                           i
                        |i
                        =1,2,…,
                        K} and {Ω
                        
                           i
                        
                        ′|i
                        =1,2,…,
                        K}) into two elliptical regions determined by Eqs. (7) and (8), respectively.
                           
                              (7)
                              
                                 
                                    
                                       
                                          x
                                          −
                                          μ
                                       
                                    
                                    T
                                 
                                 
                                    U
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       x
                                       −
                                       μ
                                    
                                 
                                 =
                                 1
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             x
                                             ′
                                          
                                          −
                                          
                                             μ
                                             ′
                                          
                                       
                                    
                                    T
                                 
                                 
                                    
                                       U
                                       ′
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ′
                                       
                                       −
                                       
                                          μ
                                          ′
                                       
                                    
                                 
                                 =
                                 1
                              
                           
                        
                     


                        Fig. 2
                         illustrates an example of the fitted elliptical regions on a pair of images with affine distortion. Fig. 2(a) and (b) illustrates the fitted regions for the reference image and the image to be registered, respectively. However, as shown in Fig. 2(a) and (b), parts of the image contents in the two elliptical regions fitted by point sets P and P′ are different. This is due to the fact that there are many mismatches in Eq. (2). Therefore, the mismatched MSER pairs should be eliminated before being fitted so that the image contents in the two fitted elliptical regions are almost the same. In this paper, a method is presented to eliminate the mismatching points based on a voting mechanism, which is similar to Hough transform [42]. The specific implementation can be seen in Appendix A.

After the mismatches being eliminated, two new sets of points 
                           
                              P
                              ^
                           
                         and 
                           
                              
                                 P
                                 ′
                              
                              ^
                           
                         are obtained
                           
                              (9)
                              
                                 
                                    P
                                    ^
                                 
                                 =
                                 
                                    
                                       
                                          
                                             x
                                             ^
                                          
                                          i
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                   ^
                                                
                                                i
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         x
                                                         ^
                                                      
                                                      i
                                                   
                                                   
                                                      
                                                         y
                                                         ^
                                                      
                                                      i
                                                   
                                                
                                                T
                                             
                                             ,
                                             
                                                
                                                   x
                                                   ^
                                                
                                                i
                                             
                                             ∈
                                             I
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             L
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       P
                                       ′
                                    
                                    ^
                                 
                                 =
                                 
                                    
                                       
                                          
                                             x
                                             ^
                                          
                                          i
                                          ′
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                   ^
                                                
                                                i
                                                ′
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            ′
                                                         
                                                         ^
                                                      
                                                      i
                                                   
                                                   
                                                      
                                                         
                                                            y
                                                            ′
                                                         
                                                         ^
                                                      
                                                      i
                                                   
                                                
                                                T
                                             
                                             ,
                                             
                                                
                                                   x
                                                   ′
                                                
                                                ^
                                             
                                             ∈
                                             
                                                I
                                                ′
                                             
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             L
                                          
                                       
                                    
                                 
                              
                           
                        where L denotes the number of the remaining points in P or P′ after the mismatches being removed. Subsequently, two new elliptical regions corresponding to 
                           
                              P
                              ^
                           
                         and 
                           
                              
                                 P
                                 ′
                              
                              ^
                           
                         are also obtained
                           
                              (11)
                              
                                 
                                    
                                       
                                          x
                                          −
                                          
                                             μ
                                             ^
                                          
                                       
                                    
                                    T
                                 
                                 
                                    
                                       U
                                       ^
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       x
                                       −
                                       
                                          μ
                                          ^
                                       
                                    
                                 
                                 =
                                 1
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             x
                                             ′
                                          
                                          −
                                          
                                             
                                                μ
                                                ′
                                             
                                             ^
                                          
                                       
                                    
                                    T
                                 
                                 
                                    
                                       
                                          U
                                          ′
                                       
                                       ^
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          x
                                          ′
                                       
                                       −
                                       
                                          
                                             μ
                                             ′
                                          
                                          ^
                                       
                                    
                                 
                                 =
                                 1
                              
                           
                        where, 
                           
                              μ
                              ^
                           
                         and Û represent the mean and the covariance matrix of 
                           
                              P
                              ^
                           
                        , respectively. 
                           
                              
                                 μ
                                 ′
                              
                              ^
                           
                         and Û′ represent the mean and the covariance matrix of 
                           
                              
                                 P
                                 ′
                              
                              ^
                           
                        , respectively. As shown in Fig. 2(c), the two elliptical regions contain roughly the same image contents.

Due to the affine geometric distortion, the structures of the two images captured from the same scene are generally different. And it is difficult to calculate the affine transformation model between the two input images by directly utilizing Eqs. (11) and (12). Therefore, in order to better estimate the affine relationship between the two input images, the two elliptical regions should be further normalized into circular ones, between which there mainly remains scale and rotation changes. In addition, the two elliptical regions contain different features (e.g., the edges and corners). The feature repeatability rate will also be reduced when the feature point detection method, to be introduced in following Section 5, is directly performed on them. However, after the normalization of the elliptical regions, more feature points with high repeatability rate can be detected on the circular regions, which will also improve the subsequent image registration precision. As shown in Fig. 3
                        , the computation procedure of the normalization is implemented as follows.
                           
                              Step 1:
                              Normalize the two ellipses defined by Eqs. (11) and (12) into circles, which are denoted by Eqs. (13) and (14), respectively. The areas of the two circular regions remain the same as those of their corresponding elliptical regions.
                                    
                                       (13)
                                       
                                          
                                             
                                                
                                                   
                                                      z
                                                      T
                                                   
                                                   z
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  λ
                                                                  ^
                                                               
                                                               1
                                                            
                                                            
                                                               
                                                                  λ
                                                                  ^
                                                               
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         −
                                                         1
                                                         /
                                                         2
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   z
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  λ
                                                                  ^
                                                               
                                                               1
                                                            
                                                            
                                                               
                                                                  λ
                                                                  ^
                                                               
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         −
                                                         1
                                                         /
                                                         4
                                                      
                                                   
                                                   
                                                      
                                                         Λ
                                                         ^
                                                      
                                                      
                                                         1
                                                         /
                                                         2
                                                      
                                                   
                                                   
                                                      H
                                                      ^
                                                   
                                                   
                                                      
                                                         x
                                                         −
                                                         
                                                            μ
                                                            ^
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (14)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         z
                                                         ′
                                                      
                                                      T
                                                   
                                                   
                                                      z
                                                      ′
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  λ
                                                                  ^
                                                               
                                                               1
                                                               ′
                                                            
                                                            
                                                               
                                                                  λ
                                                                  ^
                                                               
                                                               2
                                                               ′
                                                            
                                                         
                                                      
                                                      
                                                         −
                                                         1
                                                         /
                                                         2
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   
                                                      z
                                                      ′
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  λ
                                                                  ^
                                                               
                                                               1
                                                               ′
                                                            
                                                            
                                                               
                                                                  λ
                                                                  ^
                                                               
                                                               2
                                                               ′
                                                            
                                                         
                                                      
                                                      
                                                         −
                                                         1
                                                         /
                                                         4
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Λ
                                                            ′
                                                         
                                                         ^
                                                      
                                                      
                                                         1
                                                         /
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         H
                                                         ′
                                                      
                                                      ^
                                                   
                                                   
                                                      
                                                         
                                                            x
                                                            ′
                                                         
                                                         −
                                                         
                                                            
                                                               μ
                                                               ′
                                                            
                                                            ^
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 where Ĥ is a symmetric orthogonal matrix and 
                                    
                                       Λ
                                       ^
                                    
                                    =
                                    diag
                                    
                                       
                                          
                                             λ
                                             ^
                                          
                                          1
                                       
                                       
                                          
                                             λ
                                             ^
                                          
                                          2
                                       
                                    
                                 . They are obtained by performing the singular value decomposition (SVD) on the matrix Û
                                 −1, i.e., 
                                    
                                       
                                          U
                                          ^
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          H
                                          ^
                                       
                                       T
                                    
                                    
                                       Λ
                                       ^
                                    
                                    
                                       H
                                       ^
                                    
                                  (here, Û
                                 −1 is a symmetric matrix, so the right and left orthogonal matrices are the same in the SVD of the matrix Û
                                 −1). Correspondingly, Ĥ′ and 
                                    
                                       
                                          Λ
                                          ^
                                       
                                       ′
                                    
                                    =
                                    diag
                                    
                                       
                                          
                                             λ
                                             ^
                                          
                                          1
                                          ′
                                       
                                       
                                          
                                             λ
                                             ^
                                          
                                          2
                                          ′
                                       
                                    
                                  are the SVD results on the matrix Û′−1. 
                                    
                                       
                                          λ
                                          ^
                                       
                                       1
                                    
                                  and 
                                    
                                       
                                          λ
                                          ^
                                       
                                       2
                                    
                                  are the two singular values of Û
                                 −1. 
                                    
                                       
                                          λ
                                          ^
                                       
                                       1
                                       ′
                                    
                                  and 
                                    
                                       
                                          λ
                                          ^
                                       
                                       2
                                       ′
                                    
                                  are the two singular values of Û
                                 −1.

Compute the scale transformation factor s and the rotation transformation matrix R between the two circular regions determined by 
                                    
                                       z
                                       T
                                    
                                    z
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                   ^
                                                
                                                1
                                             
                                             
                                                
                                                   λ
                                                   ^
                                                
                                                2
                                             
                                          
                                       
                                       
                                          −
                                          1
                                          /
                                          2
                                       
                                    
                                  and 
                                    
                                       
                                          z
                                          ′
                                       
                                       T
                                    
                                    
                                       z
                                       ′
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                   ^
                                                
                                                1
                                                ′
                                             
                                             
                                                
                                                   λ
                                                   ^
                                                
                                                2
                                                ′
                                             
                                          
                                       
                                       
                                          −
                                          1
                                          /
                                          2
                                       
                                    
                                 . Owing to the fact that the main geometric transformations between the two normalized circular regions are rotation and scale changes, the following equations are achieved.
                                    
                                       (15)
                                       
                                          z
                                          ≈
                                          
                                             z
                                             ″
                                          
                                          ,
                                          
                                          
                                             z
                                             ″
                                          
                                          =
                                          s
                                          R
                                          
                                             z
                                             ′
                                          
                                       
                                    
                                 where 
                                    R
                                    =
                                    
                                       
                                          
                                             
                                                cos
                                                θ
                                             
                                             
                                                sin
                                                θ
                                             
                                          
                                          
                                             
                                                −
                                                sin
                                                θ
                                             
                                             
                                                cos
                                                θ
                                             
                                          
                                       
                                    
                                  denotes the rotation between the two regions. Different from Arun's method [43] that estimates the rotation matrix between two point sets based on SVD, a novel method based on the voting mechanism is presented to computation of the rotation angle θ in this paper (see Appendix A). The scale factor s is computed as the square root of the area ratio between the two circles, i.e., 
                                    s
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                   ^
                                                
                                                1
                                                ′
                                             
                                             
                                                
                                                   λ
                                                   ^
                                                
                                                2
                                                ′
                                             
                                          
                                       
                                       
                                          1
                                          /
                                          4
                                       
                                    
                                    /
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                   ^
                                                
                                                1
                                             
                                             
                                                
                                                   λ
                                                   ^
                                                
                                                2
                                             
                                          
                                       
                                       
                                          1
                                          /
                                          4
                                       
                                    
                                 .

In this step, two coarsely aligned circular regions determined by 
                                    
                                       z
                                       T
                                    
                                    z
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                   ^
                                                
                                                1
                                             
                                             
                                                
                                                   λ
                                                   ^
                                                
                                                2
                                             
                                          
                                       
                                       
                                          −
                                          1
                                          /
                                          2
                                       
                                    
                                  and 
                                    
                                       
                                          z
                                          ″
                                       
                                       T
                                    
                                    
                                       z
                                       ″
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                   ^
                                                
                                                1
                                             
                                             
                                                
                                                   λ
                                                   ^
                                                
                                                2
                                             
                                          
                                       
                                       
                                          −
                                          1
                                          /
                                          2
                                       
                                    
                                  are obtained, i.e., the region D
                                 1 corresponding to the reference image and the region D
                                 2 corresponding to the image to be registered. And the two circular regions will be further used to refine the affine transformation matrix between the two input images in Sections 5 and 6. It should be noted that the regions D
                                 1 and D
                                 2 are sampled to almost the same scale after the coarse alignment step, which makes our proposed method reach a sub-pixel accuracy after the refinement step.

Substitute 
                                    z
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                   ^
                                                
                                                1
                                             
                                             
                                                
                                                   λ
                                                   ^
                                                
                                                2
                                             
                                          
                                       
                                       
                                          −
                                          1
                                          /
                                          4
                                       
                                    
                                    
                                       
                                          Λ
                                          ^
                                       
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                    
                                       H
                                       ^
                                    
                                    
                                       
                                          x
                                          −
                                          
                                             μ
                                             ^
                                          
                                       
                                    
                                  and 
                                    
                                       z
                                       ′
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                   ^
                                                
                                                1
                                                ′
                                             
                                             
                                                
                                                   λ
                                                   ^
                                                
                                                2
                                                ′
                                             
                                          
                                       
                                       
                                          −
                                          1
                                          /
                                          4
                                       
                                    
                                    
                                       
                                          
                                             Λ
                                             ′
                                          
                                          ^
                                       
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                    
                                       
                                          H
                                          ′
                                       
                                       ^
                                    
                                    
                                       
                                          
                                             x
                                             ′
                                          
                                          −
                                          
                                             
                                                μ
                                                ′
                                             
                                             ^
                                          
                                       
                                    
                                  into Eq. (15), and obtain
                                    
                                       (16)
                                       
                                          
                                             
                                                Λ
                                                ^
                                             
                                             
                                                1
                                                /
                                                2
                                             
                                          
                                          
                                             H
                                             ^
                                          
                                          
                                             
                                                x
                                                −
                                                
                                                   μ
                                                   ^
                                                
                                             
                                          
                                          ≈
                                          R
                                          
                                             
                                                
                                                   Λ
                                                   ′
                                                
                                                ^
                                             
                                             
                                                1
                                                /
                                                2
                                             
                                          
                                          
                                             
                                                H
                                                ′
                                             
                                             ^
                                          
                                          
                                             
                                                
                                                   x
                                                   ′
                                                
                                                −
                                                
                                                   
                                                      μ
                                                      ′
                                                   
                                                   ^
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              

Let 
                                    
                                       A
                                       
                                          c
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Λ
                                                      ^
                                                   
                                                   
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                                
                                                   H
                                                   ^
                                                
                                             
                                             
                                                −
                                                
                                                   μ
                                                   ^
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                  and 
                                    
                                       A
                                       
                                          c
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                R
                                                
                                                   
                                                      
                                                         Λ
                                                         ′
                                                      
                                                      ^
                                                   
                                                   
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                                
                                                   
                                                      H
                                                      ′
                                                   
                                                   ^
                                                
                                             
                                             
                                                −
                                                
                                                   
                                                      μ
                                                      ^
                                                   
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 . Then the coarse affine transformation A
                                 
                                    c
                                  between the two input images is computed as
                                    
                                       (17)
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                      
                                                         c
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                         
                                                         
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   ≈
                                                   
                                                      A
                                                      
                                                         c
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                                  ′
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   
                                                      A
                                                      c
                                                   
                                                   =
                                                   
                                                      A
                                                      
                                                         c
                                                         1
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      A
                                                      
                                                         c
                                                         2
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     H
                                                                     ^
                                                                  
                                                                  T
                                                               
                                                               
                                                                  
                                                                     Λ
                                                                     ^
                                                                  
                                                                  
                                                                     −
                                                                     1
                                                                     /
                                                                     2
                                                                  
                                                               
                                                               R
                                                               
                                                                  
                                                                     
                                                                        Λ
                                                                        ′
                                                                     
                                                                     ^
                                                                  
                                                                  
                                                                     1
                                                                     /
                                                                     2
                                                                  
                                                               
                                                               
                                                                  
                                                                     H
                                                                     ′
                                                                  
                                                                  ^
                                                               
                                                            
                                                            
                                                               
                                                                  μ
                                                                  ^
                                                               
                                                               −
                                                               
                                                                  
                                                                     H
                                                                     ^
                                                                  
                                                                  T
                                                               
                                                               
                                                                  
                                                                     Λ
                                                                     ^
                                                                  
                                                                  
                                                                     −
                                                                     1
                                                                     /
                                                                     2
                                                                  
                                                               
                                                               R
                                                               
                                                                  
                                                                     
                                                                        Λ
                                                                        ′
                                                                     
                                                                     ^
                                                                  
                                                                  
                                                                     1
                                                                     /
                                                                     2
                                                                  
                                                               
                                                               
                                                                  
                                                                     H
                                                                     ′
                                                                  
                                                                  ^
                                                               
                                                               
                                                                  
                                                                     μ
                                                                     ′
                                                                  
                                                                  ^
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 where x
                                 =(x,
                                 y)
                                    T
                                  and x′=(x′,
                                 y′)
                                    T
                                  represent the image points in the reference image and the image to be registered, respectively.

In general, MSERs are irregular and the computation of their centroids is also inaccurate. Therefore, the transformation matrix between the two input images should be further refined. In the following sections, we will use the GDPC method to detect feature points on the two coarsely aligned regions (i.e., D
                                 1 and D
                                 2 in Fig. 3) and then obtain the refined transformation matrix by performing the probabilistic point set registration algorithm on the detected feature point sets.

After the coarse alignment, some traditional area-based methods, such as the mutual information (MI) [44] and cross-correlation (CC) [45] based ones, can be performed on those circular regions obtained above, and the precision of the final registration results will also be further improved. However, one of the two coarsely aligned regions will be enlarged and thus be blurred if there exists large scale change between the reference image and the image to be registered. The contrast of the zoomed image will also be greatly reduced. Correspondingly, the final registration accuracy of these area-based methods will be reduced. Some traditional feature-based methods, such as the SIFT [21] and ASIFT [23] based ones, can also be employed in our refinement step, and satisfactory results will also be obtained in most cases. However, these methods are usually based on image gradient. In some special cases, such as for images with illumination change or blur, the final registration precision of these methods will also be affected.

Compared with image gradient, phase congruency is more robust to the noise, illumination and contrast change. In [25], Kovesi presented a feature point detector by using the maximum moment of the image phase congruency. Under varying illumination conditions, the detector shows high stability. However, as discussed in the earlier Section 1, the detector is not scale invariant. The detected points from one of input images will be much less than those from the other images if there exits large scale change between the two images. Fig. 4
                      illustrates the feature point detection results on two images with large scale change. As shown in Fig. 4(b), there are 130 detected points in the rectangle region of Fig. 4(a). But as shown in Fig. 4(d), there are only 75 detected points in the interpolated region of Fig. 4(c). This may result from the fact that some mirror high frequency components are introduced when an image is interpolated and the computation of the phase congruency is thus affected to some extent.

To overcome the shortcomings of the point detector in [25], a novel feature point detection algorithm (i.e., GDPC) was proposed to detect corners from images captured with different focal-lengths or different focuses in our previous work [26]. Here, we apply the GDPC algorithm to solve the problem of image blurring caused by enlargement and interpolation. And for completeness of our proposed registration method, the GDPC detector is briefly introduced in the following contents.

In GDPC, the input image is first decomposed into many sub-bands by using a set of band-pass filters with different center frequencies and bandwidths. Then the maximum phase congruency moment based point detector [25] is performed on each sub-band. The detected points from the sub-band that contains the maximum number of detected points are taken as the final detection results.

Studies show that the Gabor filters can well simulate the frequency and orientation selectivity mechanism of the human visual system (HVS) [46]. In addition, compared with some other commonly used band-pass filters, such as the Laplacian of Gaussian band-pass filters, Gabor filters have better spectral distinctiveness [47]. Therefore, the Gabor filters are employed to decompose an image into different sub-bands.

A 2D circular symmetrical Gabor function g
                     
                        σ,β
                     (x,
                     y) and its Fourier transform G
                     
                        σ,β
                     (ω
                     
                        x
                     ,
                     ω
                     
                        y
                     ) are expressed as
                        
                           (18)
                           
                              
                                 g
                                 
                                    σ
                                    ,
                                    β
                                 
                              
                              
                                 x
                                 y
                              
                              =
                              
                                 1
                                 
                                    2
                                    π
                                    
                                       σ
                                       2
                                    
                                 
                              
                              
                                 e
                                 
                                    −
                                    
                                       
                                          
                                             x
                                             2
                                          
                                          +
                                          
                                             y
                                             2
                                          
                                       
                                       
                                          2
                                          
                                             σ
                                             2
                                          
                                       
                                    
                                 
                              
                              
                                 e
                                 
                                    i
                                    
                                       π
                                       σ
                                    
                                    
                                       
                                          x
                                          cos
                                          β
                                          +
                                          y
                                          sin
                                          β
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (19)
                           
                              
                                 G
                                 
                                    σ
                                    ,
                                    β
                                 
                              
                              
                                 
                                    ω
                                    x
                                 
                                 
                                    ω
                                    y
                                 
                              
                              =
                              
                                 e
                                 
                                    −
                                    2
                                    
                                       π
                                       2
                                    
                                    
                                       σ
                                       2
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ω
                                                      x
                                                   
                                                   −
                                                   
                                                      
                                                         cos
                                                         β
                                                      
                                                      
                                                         2
                                                         σ
                                                      
                                                   
                                                
                                             
                                             2
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      ω
                                                      y
                                                   
                                                   −
                                                   
                                                      
                                                         sin
                                                         β
                                                      
                                                      
                                                         2
                                                         σ
                                                      
                                                   
                                                
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     where σ
                     >0 determines the bandwidth of the Gabor function and β denotes its orientation. ω
                     
                        x
                      and ω
                     
                        y
                      are frequency variables. To construct a band-pass Gabor filter, all of the directional filters with the same bandwidth (i.e., the same σ) defined by Eq. (18) are merged as [47]
                     
                        
                           (20)
                           
                              
                                 g
                                 σ
                              
                              
                                 x
                                 y
                              
                              =
                              
                                 
                                    ∫
                                    
                                       −
                                       π
                                    
                                    π
                                 
                                 
                                    real
                                    
                                       
                                          
                                             g
                                             
                                                σ
                                                ,
                                                β
                                             
                                          
                                          
                                             x
                                             y
                                          
                                       
                                    
                                    d
                                    β
                                 
                              
                              .
                           
                        
                     
                  

Practically, β are some discrete values. Then the integration operation in Eq. (20) is substituted with the sum operation, i.e.,
                        
                           (21)
                           
                              
                                 g
                                 σ
                              
                              
                                 x
                                 y
                              
                              =
                              
                                 π
                                 N
                              
                              
                                 
                                    ∑
                                    
                                       k
                                       =
                                       −
                                       N
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 
                                    real
                                    
                                       
                                          
                                             g
                                             
                                                σ
                                                ,
                                                
                                                   β
                                                   k
                                                
                                             
                                          
                                          
                                             x
                                             y
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 π
                                 N
                              
                              
                                 
                                    ∑
                                    
                                       k
                                       =
                                       −
                                       N
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       g
                                       
                                          σ
                                          ,
                                          
                                             β
                                             k
                                          
                                       
                                    
                                    
                                       x
                                       y
                                    
                                 
                              
                           
                        
                     where, β
                     
                        k
                     
                     =
                     kπ/N with k
                     ={−
                     N,−
                     N
                     +1,…,
                     N
                     −1}. 2N denotes the number of orientations. In this paper, N is set to 6. The Fourier transformation of the band-pass Gabor filter g
                     
                        σ
                     (x,
                     y) is thus expressed by
                        
                           (22)
                           
                              
                                 G
                                 σ
                              
                              
                                 
                                    ω
                                    x
                                 
                                 
                                    ω
                                    y
                                 
                              
                              =
                              
                                 π
                                 N
                              
                              
                                 
                                    ∑
                                    
                                       k
                                       =
                                       −
                                       N
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       e
                                       
                                          −
                                          2
                                          
                                             π
                                             2
                                          
                                          
                                             σ
                                             2
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ω
                                                            x
                                                         
                                                         −
                                                         
                                                            
                                                               cos
                                                               
                                                                  β
                                                                  k
                                                               
                                                            
                                                            
                                                               2
                                                               σ
                                                            
                                                         
                                                      
                                                   
                                                   2
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            ω
                                                            y
                                                         
                                                         −
                                                         
                                                            
                                                               sin
                                                               
                                                                  β
                                                                  k
                                                               
                                                            
                                                            
                                                               2
                                                               σ
                                                            
                                                         
                                                      
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  

By setting σ to different values, a set of band-pass Gabor filters with different bandwidths are constructed. Fig. 5
                      illustrates the magnitude–frequency response of a Gabor filter with 
                        σ
                        =
                        2
                        
                           2
                        
                     . Correspondingly, a set of filtered images I
                     
                        σ
                     (x,
                     y) are obtained by
                        
                           (23)
                           
                              
                                 I
                                 σ
                              
                              
                                 x
                                 y
                              
                              =
                              
                                 F
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    
                                       G
                                       σ
                                    
                                    
                                       
                                          ω
                                          x
                                       
                                       
                                          ω
                                          y
                                       
                                    
                                    ×
                                    F
                                    
                                       
                                          
                                             I
                                             0
                                          
                                          
                                             x
                                             y
                                          
                                       
                                    
                                 
                              
                           
                        
                     where I
                     0(x,
                     y) is the original image. F[⋅] and F
                     −1[⋅] denote the forward Fourier transform and the inverse Fourier transform, respectively. In this paper, σ is experimentally set to the following five values, i.e., σ
                     =2
                        n/2 (with n
                     =1,2,3,4,5).

Subsequently, the maximum phase congruency moment based corner detector [25] is performed on each of the five filtered images, respectively. And the image Î that contains the maximum number of detected points is picked out, i.e.,
                        
                           (24)
                           
                              
                                 I
                                 ^
                              
                              =
                              
                                 
                                    arg
                                    max
                                 
                                 
                                    I
                                    σ
                                 
                              
                              
                                 
                                    N
                                    u
                                    m
                                    
                                       
                                          ρ
                                          
                                             
                                                I
                                                σ
                                             
                                          
                                          >
                                          t
                                          h
                                          1
                                       
                                    
                                 
                              
                           
                        
                     where I
                     
                        σ
                      denotes the filtered image. ρ(I
                     
                        σ
                     ) represents the maximum phase congruency moment of I
                     
                        σ
                     . th1 is the threshold for detecting the feature points and is set to 0.4 in this paper. Finally, the feature points obtained from Î are regarded as the final detection results.

To illustrate the validity of the GDPC method, the image in the above Fig. 4(d) is employed again. As shown in Fig. 6
                     , the numbers of the phase congruency feature points detected in Fig. 6(a) to (f) are 75, 112, 122, 105, 80 and 19, respectively. In the 2nd sub-band, i.e. Fig. 6(c), which corresponds to σ
                     =2, the number of the detected phase congruency feature points is maximum. Thus the detected feature points in Fig. 6(c) are taken as the final detection result. Moreover, for the feature points detected in Fig. 4(b) and (d), there are 31 correct matches and the feature repeatability rate is 0.4133. By virtue of the Gabor band-pass decomposition, 69 correct matches are obtained and the corresponding feature repeatability rate also reaches to 0.5476. This demonstrates that the GDPC detector performs better than the original phase congruency based point detector in [25] for images with large scale change.

In the classical SIFT based and ASIFT based image registration methods, a descriptor is first constructed for each feature point. Then some matching strategies (e.g., the Euclidean Distance) are used to search for the best matches. Finally, the Least Squares (LS) or the RANdom SAmple Consensus (RANSAC) method [48] is applied to remove the outliers and estimate the transformation matrix. As discussed in the earlier Introduction part, the construction of descriptors for each feature point has important influence on the final matching (or registration) results and still is an open issue. Moreover, the RANSAC method is time-consuming when the number of the matches is very large. Different from that in the traditional feature-based registration methods, we employ a probabilistic model based point set registration approach [27] to estimate the transformation matrix between the two feature point sets in this paper, in which there is no need to build descriptors for the feature points. In addition, the searching for the best matches and the estimation of transformation matrix are implemented simultaneously, which improves the computation efficiency of the proposed image registration method.

In Section 4.3, two circular regions containing roughly the same image contents, i.e., the reference region D
                        1 denoted by Eq. (13) and the tested region D
                        2 denoted by Eq. (15), are obtained. Two feature point sets X and Y are then obtained by performing the GDPC algorithm introduced in Section 5 on D
                        1 and D
                        2, respectively. The X and Y are defined as follows.
                           
                              (25)
                              
                                 X
                                 =
                                 
                                    
                                       
                                          
                                             
                                                x
                                                1
                                                T
                                             
                                          
                                       
                                       
                                          
                                             
                                                x
                                                2
                                                T
                                             
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             
                                                x
                                                N
                                                T
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   1
                                                
                                             
                                             
                                                
                                                   y
                                                   1
                                                
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   x
                                                   2
                                                
                                             
                                             
                                                
                                                   y
                                                   2
                                                
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                             
                                                ⋮
                                             
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                
                                                   x
                                                   N
                                                
                                             
                                             
                                                
                                                   y
                                                   N
                                                
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       N
                                       ×
                                       3
                                    
                                 
                                 ,
                                 Y
                                 =
                                 
                                    
                                       
                                          
                                             
                                                y
                                                1
                                                T
                                             
                                          
                                       
                                       
                                          
                                             
                                                y
                                                2
                                                T
                                             
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             
                                                y
                                                M
                                                T
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   1
                                                   ′
                                                
                                             
                                             
                                                
                                                   y
                                                   1
                                                   ′
                                                
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   x
                                                   2
                                                   ′
                                                
                                             
                                             
                                                
                                                   y
                                                   2
                                                   ′
                                                
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                             
                                                ⋮
                                             
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                
                                                   x
                                                   M
                                                   ′
                                                
                                             
                                             
                                                
                                                   y
                                                   M
                                                   ′
                                                
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       M
                                       ×
                                       3
                                    
                                 
                              
                           
                        where N and M are the number of the feature points detected from D
                        1 and D
                        2, respectively. (x
                        
                           n
                        ,
                        y
                        
                           n
                        ) and (x
                        
                           m
                        ′,
                        y
                        
                           m
                        ′) represent the coordinates of the nth and mth feature points in D
                        1 and D
                        2.

Assume that the geometrical relationship between the two point sets is modeled by an affine transformation, i.e., the correspondence of x
                        
                           n
                        
                        =(x
                        
                           n
                        ,
                        y
                        
                           n
                        ,1)
                           T
                         and y
                        
                           m
                        
                        =(x
                        
                           m
                        ′,
                        y
                        
                           m
                        ′,1)
                           T
                         satisfies
                           
                              (26)
                              
                                 
                                    x
                                    n
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                x
                                                n
                                             
                                          
                                       
                                       
                                          
                                             
                                                y
                                                n
                                             
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             b
                                          
                                          
                                             c
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             e
                                          
                                          
                                             f
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                x
                                                m
                                                ′
                                             
                                          
                                       
                                       
                                          
                                             
                                                y
                                                m
                                                ′
                                             
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    A
                                    r
                                 
                                 
                                    y
                                    m
                                 
                              
                           
                        where the matrix A
                        
                           r
                         with 3×3 order denotes the affine transformation between the two feature point sets. Then A
                        
                           r
                         can be estimated by the probabilistic model based point set registration algorithm in [27].

Here, the points in set Y are treated as the centroids of the Gaussian mixture model (GMM) [49], and the estimation of A
                        
                           r
                         is to find the optimal model that generates the closest data points to X. The conditional probability density function (PDF) of point x
                        
                           n
                         generated by the centroid y
                        
                           m
                         is expressed as
                           
                              (27)
                              
                                 P
                                 
                                    
                                       
                                          x
                                          n
                                       
                                       |
                                       
                                          y
                                          m
                                       
                                       ,
                                       ψ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          2
                                          π
                                          
                                             λ
                                             2
                                          
                                       
                                    
                                    
                                       −
                                       3
                                       /
                                       2
                                    
                                 
                                 
                                    e
                                    
                                       
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         n
                                                      
                                                      −
                                                      
                                                         A
                                                         r
                                                      
                                                      
                                                         y
                                                         m
                                                      
                                                   
                                                
                                                2
                                             
                                             
                                                2
                                                
                                                   λ
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where ψ denotes the parameters in A
                        
                           r
                         and the covariance λ
                        2. All of the GMM components are supposed to have the identical values of λ
                        2. Then the GMM PDF of point x
                        
                           n
                         generated by all the centroids is expressed as
                           
                              (28)
                              
                                 P
                                 
                                    
                                       
                                          x
                                          n
                                       
                                       |
                                       ψ
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                       
                                          m
                                          =
                                          1
                                       
                                       M
                                    
                                    
                                       w
                                       
                                          
                                             y
                                             m
                                          
                                       
                                       P
                                       
                                          
                                             
                                                x
                                                n
                                             
                                             |
                                             
                                                y
                                                m
                                             
                                             ,
                                             ψ
                                          
                                       
                                    
                                 
                              
                           
                        where w(y
                        
                           m
                        ) is the weight for the mth GMM component, and it is simply set to 1/M for all m.

For all of the points in set X, we can totally obtain N GMM PDFs to generate them. The log-likelihood of the GMM function is
                           
                              (29)
                              
                                 
                                    
                                       
                                          l
                                          
                                             ψ
                                          
                                          =
                                          log
                                          
                                             
                                                ∏
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                P
                                                
                                                   
                                                      
                                                         x
                                                         n
                                                      
                                                      |
                                                      ψ
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                          =
                                          
                                             
                                                ∑
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                
                                                   
                                                      log
                                                      
                                                         
                                                            ∑
                                                            
                                                               m
                                                               =
                                                               1
                                                            
                                                            M
                                                         
                                                         
                                                            
                                                               1
                                                               M
                                                            
                                                            P
                                                            
                                                               
                                                                  
                                                                     x
                                                                     n
                                                                  
                                                                  |
                                                                  
                                                                     y
                                                                     m
                                                                  
                                                                  ,
                                                                  ψ
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

Then the problem of estimation of A
                        
                           r
                         is reduced to seek for the solution that maximizes l(ψ). The Expectation Maximization (EM) algorithm [49] is adopted here to estimate the parameters. More details can be seen in [27].

After the coarse sub-region matching and the feature point set registration, two affine transformation matrices A
                        
                           c
                        
                        =
                        A
                        
                           c1
                        −1
                        A
                        
                           c2 and Expectation Maximization are obtained. Then Eq. (17) can be precisely expressed as
                           
                              (30)
                              
                                 
                                    A
                                    
                                       c
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    A
                                    r
                                 
                                 
                                    A
                                    
                                       c
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                x
                                                ′
                                             
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        where x
                        =(x,
                        y)
                           T
                         and x′=(x′,
                        y′)
                           T
                         represent the image points in the reference image and the image to be registered, respectively.

Let 
                           B
                           =
                           
                              
                                 
                                    
                                       a
                                    
                                    
                                       b
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       e
                                    
                                 
                              
                           
                         denote the linear transformation and 
                           t
                           =
                           
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    
                                       f
                                    
                                 
                              
                           
                         denote the translational transformation, then the affine transformation matrix A
                        
                           r
                         in Eq. (26) is simply rewritten as
                           
                              (31)
                              
                                 
                                    A
                                    r
                                 
                                 =
                                 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Thus, the final affine transformation matrix T between the two input images is calculated by
                           
                              (32)
                              
                                 T
                                 =
                                 
                                    A
                                    
                                       c
                                       1
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    A
                                    r
                                 
                                 
                                    A
                                    
                                       c
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                   ^
                                                
                                                T
                                             
                                             
                                                
                                                   Λ
                                                   ^
                                                
                                                
                                                   −
                                                   1
                                                   /
                                                   2
                                                
                                             
                                             B
                                             R
                                             
                                                
                                                   
                                                      Λ
                                                      ′
                                                   
                                                   ^
                                                
                                                
                                                   1
                                                   /
                                                   2
                                                
                                             
                                             
                                                
                                                   H
                                                   ′
                                                
                                                ^
                                             
                                          
                                          
                                             
                                                μ
                                                ^
                                             
                                             +
                                             
                                                
                                                   H
                                                   ^
                                                
                                                T
                                             
                                             
                                                
                                                   Λ
                                                   ^
                                                
                                                
                                                   −
                                                   1
                                                   /
                                                   2
                                                
                                             
                                             
                                                
                                                   t
                                                   −
                                                   B
                                                   R
                                                   
                                                      
                                                         
                                                            Λ
                                                            ′
                                                         
                                                         ^
                                                      
                                                      
                                                         1
                                                         /
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         H
                                                         ′
                                                      
                                                      ^
                                                   
                                                   
                                                      
                                                         μ
                                                         ′
                                                      
                                                      ^
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

The image to be registered is finally transformed by using the affine transformation matrix T, and the image values in non-integer coordinates are computed by the bilinear interpolation technique.

In this section, several sets of experiments are performed to demonstrate the validity of the proposed image registration algorithm. Firstly, a set of experiments are performed to verify the validity of the proposed image registration method on the alignment of images with scale changes. Secondly, several sets of images with different affine distortions are aligned to test the feasibility of the proposed image registration algorithm. Finally, a set of experiments are performed to test the robustness of the proposed image registration algorithm to illumination change. All the experiments work on a personal computer with a 2.83GHz Intel Core CPU, 3.48G RAM, and Windows XP operating system.

In this subsection, several sets of images with scale changes are used to test the validity of the proposed image registration method. Besides the proposed method, the classical SIFT based image registration method [21] (SIFT method, for short) and another three methods (MSER–SIFT, MSER–MI and MSER–CC methods, for short, respectively) that employ the same coarse alignment step in Section 4 but different refinement steps are performed for comparisons. In the latter three methods, the SIFT based [21], the mutual information based [44] and the cross correlation based [45] methods are employed in the refinement step, respectively. In the SIFT and MSER–SIFT methods, the matched feature points between the reference image and the image to be registered are firstly obtained. Then the transformation matrix (or model parameters) is estimated by using the RANSAC algorithm. The default values of the parameters in [21] are employed in the SIFT feature points detection and matching step.

In this subsection, a set of man-made images with scale changes are used to test the performance of different registration methods above. Fig. 7
                            illustrates the test images. Considering the fact that all of the images to be registered in Fig. 7 are derived from the reference image, it is easy to obtain the accurate ground-truth control point pairs. Therefore, the registration precision of different methods can be evaluated by the root mean square error (RMSE) of the displacement of the control point pairs. As suggested in [33], we also employ 20 control points in the computation of the RMSE. Fig. 8
                            gives the RMSE values of different registration methods on the images with varieties of scale factors. As shown in Fig. 8, it is obviously found that the SIFT, MSER–SIFT and our proposed methods outperform the other three methods, especially for images with large scale changes (i.e., corresponding to bigger or smaller scale factors). It can also be found that the MSER–MI and MSER–CC methods perform better than the coarse alignment method in most of cases. But for images with large scale changes, the registration precisions of the two area-based methods obviously reduce and even perform worse than the coarse alignment one (e.g., in the case of the scale factors less than 0.7). As discussed in the earlier Section 5, the zoomed image will be greatly blurred after the interpolation and enlargement if there exists large scale change between the two input images. The registration precisions of these two area-based methods are thus reduced to some extent in this case.

In this subsection, a set of real-world images with scale changes are employed to demonstrate the validity of our proposed method. Fig. 9
                            illustrates the test images downloaded from www.robots.ox.ac.uk 
                           [50] and Fig. 10
                            displays the registration results obtained by the SIFT and our proposed methods.
                              3
                           
                           
                              3
                              The registered results obtained by other methods such as MSER–SIFT, MSER–MI and MSER–CC, have insignificant differences with those obtained by the proposed method. So, they are not displayed here due to space limitation.
                            As shown in Fig. 10, both of the SIFT and our proposed registration methods can align these images successfully and the registered results have insignificant differences.

In order to evaluate the performance of different methods, some other objective metrics [31] in addition to the RMSE metric are employed here, which include the number of total matches (N
                           
                              T
                           ), the number of correct matches (N
                           
                              C
                           ), the feature repeatability rate (F
                           
                              R
                           ) of detected features and the correct matching rate (C
                           
                              R
                           ). Here, given the transformation matrix T,
                              4
                           
                           
                              4
                              Here, an affine transformation matrix is employed.
                            a matched point pair (x,
                           y)↔(x′,
                           y′) is regarded as a correct one if they satisfy
                              
                                 (33)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      −
                                                      
                                                         x
                                                         ″
                                                      
                                                   
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   
                                                      y
                                                      −
                                                      
                                                         y
                                                         ″
                                                      
                                                   
                                                
                                                2
                                             
                                             <
                                             t
                                             h
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      '
                                                      '
                                                      ,
                                                      y
                                                      '
                                                      '
                                                      ,
                                                      1
                                                   
                                                
                                                T
                                             
                                             =
                                             T
                                             
                                                
                                                   
                                                      x
                                                      ′
                                                   
                                                   
                                                      y
                                                      ′
                                                   
                                                   1
                                                
                                                T
                                             
                                          
                                       
                                    
                                 
                              
                           where th2 is a threshold, and it is experimentally set to 50 in all of the experiments. The metrics F
                           
                              R
                            and C
                           
                              R
                            are defined as
                              
                                 (34)
                                 
                                    
                                       F
                                       R
                                    
                                    =
                                    
                                       N
                                       C
                                    
                                    /
                                    min
                                    
                                       
                                          N
                                          
                                             r
                                             e
                                             f
                                          
                                       
                                       
                                          N
                                          test
                                       
                                    
                                 
                              
                           
                           
                              
                                 (35)
                                 
                                    
                                       C
                                       R
                                    
                                    =
                                    
                                       N
                                       C
                                    
                                    /
                                    
                                       N
                                       T
                                    
                                 
                              
                           where, N
                           
                              ref
                            and N
                           
                              test
                            denote the total number of detected features from the reference image and the image to be registered, respectively.

According to the RMSE values in Table 1
                           , it can be concluded that the SIFT, MSER–SIFT, and our proposed methods perform competitively and significantly outperform the MSER–MI and MSER–CC methods in registration accuracy for images with scale changes. By a further comparison, it can also be found that the MSER–SIFT and our proposed methods, especially our proposed methods, obtain higher correct matching rate and repeatability rate than the SIFT method does. In addition, the MSER–SIFT and our proposed methods perform more stable than the SIFT method. For example, the SIFT method obtains satisfactory results when the scale changes between the reference image and the image to be registered are small (e.g., for Fig. 9(b) and (c)). However, the number of correct matches and the repeatability rate obtained by the SIFT method reduce greatly when the scale changes are large (e.g., for Fig. 9(d) and (e)). Differently, the matching results obtained by the MSER–SIFT and our proposed methods are stable with the increase of scale changes between the reference image and the one to be registered. This may owe to the employed coarse alignment step in our proposed method.

In this subsection, several sets of experiments are performed to test the feasibility of the proposed registration method on images with affine distortions. In addition to the proposed, SIFT, MSER–SIFT, MSER–MI and MSER–CC methods mentioned in Section 7.1, another three feature-based image registration methods, i.e., the MSER [18], ASIFT [23] and MSER–ASIFT
                           5
                        
                        
                           5
                           Similarly, the MSER–ASIFT method employs the MSER based alignment method introduced in Section 4 as a coarse step and the ASIFT based registration method in [23] as a refinement step.
                         methods, are performed for comparisons. In the MSER, ASIFT and MSER–ASIFT methods, the feature regions or points are first detected and described for each input image. Then the matches are obtained by using the same strategy in [21]. Finally, the transformation matrix between the two input images is estimated by using the RANSAC algorithm. The default values of the parameters in [18] are employed in the MSER method and the default values of the parameters in [23] are employed in the ASIFT and MSER–ASIFT methods.

In this subsection, a set of man-made test images with affine distortions are employed to verify our proposed method. Fig. 11
                            illustrates the test images, in which, Fig. 11(a) shows a front view image shot [51] and is taken as the reference image in the following experiments. Fig. 11(b)–(e) shows the four images to be registered, which are obtained by performing the affine transformation defined by Eq. (36) in Fig. 11(a) with α
                           =0.2, 0.4, 0.6, 0.8, respectively.
                              
                                 (36)
                                 
                                    T
                                    =
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                0.4
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                α
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

The same objective metrics mentioned in the above subsection are employed here and Table 2
                            gives the experimental results obtained by different methods. As shown in Table 2, it can be found that all of the methods by using a two-step way (i.e., the MSER–SIFT, MSER–ASIFT, MSER–MI, MSER–CC and our proposed methods) obtain higher registration precisions than the coarse alignment results in term of the metric RMSE. Moreover, the MSER–SIFT, MSER–ASIFT and our proposed methods perform better than those two area-based methods. Especially, the proposed method yields the lowest RMSE values among all the mentioned methods.

In terms of the metrics C
                           
                              R
                            and F
                           
                              R
                           , the MSER–SIFT and our proposed method, especially our proposed method, also perform better than the other feature-based methods, such as the MSER, SIFT, ASIFT, and MSER–ASIFT ones. The SIFT method performs the worst among the feature-based methods in the four sets of experiments. It obtains less correct matches and lower correct matching rate than the other methods. Especially, the SIFT based registration method obtains few or even none of matches when the affine distortion is larger (e.g., α is 0.6 or 0.8). This may result from the fact that the SIFT based point detection and matching algorithm is sensitive to large affine distortion [21]. Compared with the SIFT method, the MSER–SIFT method achieves a significant improvement in terms of the correct matches, the correct matching rate and the feature repeatability rate by virtue of the proposed coarse alignment step. It can also be found that the ASIFT and MSER–ASIFT methods obtain a large number of correct matches but low repeatability rates. That is to say, there are only a few proportions of feature points detected by the ASIFT algorithm are useful and much more are useless, which leads to the great increase of computation complexity and huge waste of memory space [23].

The run time (i.e., T(s)) of different methods is also provided in Table 2, which shows that the MSER and SIFT methods are much faster than the other methods. The ASIFT, MSER–ASIFT and MSER–CC methods run the slowest among the mentioned registration methods. The run time of our proposed method is about half of that of the ASIFT method.

In this subsection, five pairs of real-world images with affine distortions are aligned to further demonstrate the validity of our proposed method. Fig. 12
                            illustrates the test images
                              6
                           
                           
                              6
                              The test images in Fig. 12(a) are shot by the IKONOS camera. The test images in Fig. 12(b) and (e) are downloaded from http://lear.inrialpes.fr/people/mikolajczyk/Database/index.html 
                                 [51]. The test images in Fig. 12(c) come from Google earth, and the test images in Fig. 12(d) are downloaded from www.robots.ox.ac.uk 
                                 [50].
                            and the registered ones obtained by our proposed method.
                              7
                           
                           
                              7
                              The registration results obtained by the MSER, ASIFT, MSER–SIFT, MSER–ASIFT methods on all of the real-world images and the registration results obtained by the SIFT method on the images displayed in Fig. 12(a) and (b) have insignificant differences with the corresponding ones obtained by the proposed method, so they are not displayed here for space limitation.
                            And Table 3
                            gives the experimental data of different methods.

Similar results can be found according to the experimental data in Table 3. In terms of the correct matching rate, the proposed method performs competitively with the MSER–SIFT and MSER–ASIFT methods and better than the MSER, SIFT and ASIFT methods for all of the five experiments. Except for the MSER–SIFT method, the proposed method obtains the highest repeatability rate among the other five feature-based methods. The ASIFT and MSER–ASIFT methods obtain a large number of correct matches but low repeatability rates. For images with affine distortions (e.g., Fig. 12(b)–(e)), the SIFT based registration method performs the worst and even fails. In term of the metric RMSE, the MSER–ASIFT performs slightly better than the MSER–SIFT and our proposed methods. And these three methods outperform the other methods. Finally, in term of the metric T, the proposed method runs faster than the ASIFT, MSER–ASIFT and MSER–CC methods and slower than the other methods. In summary, it can be concluded that the proposed and MSER–SIFT methods perform better than the others on aligning images with affine distortions by comprehensively considering the computational efficiency and registration precision.

To further demonstrate the validity of our propose method, a set of images with different illumination changes are employed in this experiment. The test images which are downloaded from www.robots.ox.ac.ok 
                        [50], and the aligned images obtained by our proposed method are illustrated in Fig. 13
                        . Similarly, the registration results obtained by the other methods on these images have insignificant differences with the corresponding ones obtained by the proposed method, so they are also not displayed here. Quantitative results obtained by different methods are given in Table 4
                        , which shows that all of the feature-based methods obviously perform better than the other two area-based methods in this case. Among the feature-based methods, our proposed method performs the best in terms of the metrics C
                        
                           R
                        , F
                        
                           R
                         and RMSE in most of cases. This demonstrates that our proposed method is more robust to illumination change than the other methods, which owes to the employed GDPC detector in our proposed refinement step.

@&#CONCLUSIONS@&#

In this paper, a novel image registration method is proposed to align images with affine distortions by using a two-step way. The coarse affine transformation matrix between the reference image and the image to be registered is first estimated by using an improved MSER based registration method. Then the final affined transform matrix is refined by using a phase congruency based point detector and a probabilistic point set registration method. We show that the combination of the two-step way makes the proposed method outperform some traditional area-based methods (e.g., the MSER–MI and MSER–CC methods) and feature-based methods (e.g. MSER, SIFT, ASIFT and MSER–ASIFT methods) for images with scale changes or affine distortions. Especially, with the help of the phase congruency based point detector in the refinement step, the proposed method shows higher robustness to illumination change than those existing methods do. Owing to the employed point set registration algorithm, the construction of descriptors is canceled in the refinement step, and the computation complexity of our proposed registration method is also reduced to some extent. Experimental results demonstrate that the run time of our proposed method is about the half of that of the ASIFT method.

@&#ACKNOWLEDGMENT@&#

This work is supported by the National Natural Science Foundation of China under grant no. 61104212, by the Fundamental Research Funds for the Central Universities under grant nos. K5051304001 and NSIY211416, and by China Scholarship Council under grant no. 201306965005. The image data sets used in Sections 7.1 and 7.3 are downloaded from www.robots.ox.ac.uk and are kindly provided by the Department of Engineering Science, University of Oxford.

In this appendix, the proposed methods for removing the false matched MSER pairs and determining the rotation angle θ between the two corresponding point sets are discussed in detail. Suppose that there are two coarsely matched point sets P and P′ which are fitted into two ellipses expressed by Eqs. (7) and (8), respectively. And the two ellipses are normalized into circles in the same way as Eqs. (13) and (14). Then another two point sets S and S′ corresponding to the two circles are obtained, i.e.,
                        
                           (A.1)
                           
                              S
                              =
                              
                                 
                                    
                                       z
                                       i
                                    
                                    |
                                    
                                       z
                                       i
                                    
                                    =
                                    
                                       
                                          
                                             u
                                             i
                                          
                                          
                                             v
                                             i
                                          
                                       
                                       T
                                    
                                    ,
                                    
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    N
                                 
                              
                           
                        
                     
                     
                        
                           (A.2)
                           
                              
                                 S
                                 ′
                              
                              =
                              
                                 
                                    
                                       z
                                       i
                                       ′
                                    
                                    |
                                    
                                       z
                                       i
                                       ′
                                    
                                    =
                                    
                                       
                                          
                                             u
                                             i
                                             ′
                                          
                                          
                                             v
                                             i
                                             ′
                                          
                                       
                                       T
                                    
                                    ,
                                    
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    N
                                 
                              
                           
                        
                     where (u
                     
                        i
                     ,
                     v
                     
                        i
                     )
                        T
                      and (u
                     
                        i
                     
                     ′,
                     v
                     
                        i
                     
                     ′)
                        T
                      are a matched point pair. N is the total number of the matches.


                     
                  

As shown in Fig. A1, for each matched point pair z
                     
                        i
                     
                     =(u
                     
                        i
                     ,
                     v
                     
                        i
                     )
                        T
                      and z
                     
                        i
                     
                     ′
                     =(u
                     
                        i
                     
                     ′,
                     v
                     
                        i
                     
                     ′)
                        T
                     , their phase angles ϕ
                     
                        i
                      and ϕ
                     
                        i
                     
                     ′ are computed by Eqs. (A.3) and (A.4), respectively.
                        
                           (A.3)
                           
                              
                                 ϕ
                                 i
                              
                              =
                              mod
                              
                                 
                                    atan
                                    2
                                    
                                       
                                          v
                                          i
                                       
                                       
                                          u
                                          i
                                       
                                    
                                    ,
                                    2
                                    π
                                 
                              
                              ,
                              
                              
                                 ϕ
                                 i
                              
                              ∈
                              
                                 
                                    0
                                    ,
                                    2
                                    π
                                 
                              
                           
                        
                     
                     
                        
                           (A.4)
                           
                              
                                 ϕ
                                 i
                                 ′
                              
                              =
                              mod
                              
                                 
                                    atan
                                    2
                                    
                                       
                                          v
                                          i
                                          ′
                                       
                                       
                                          u
                                          i
                                          ′
                                       
                                    
                                    ,
                                    2
                                    π
                                 
                              
                              ,
                              
                              
                                 ϕ
                                 i
                                 ′
                              
                              ∈
                              
                                 
                                    0
                                    ,
                                    2
                                    π
                                 
                              
                           
                        
                     where atan2(·) denotes the four quadrant inverse tangent function. Then a set of angle differences Δ
                     Φ for all of the matched point pairs in S and S′ are obtained, i.e.,
                        
                           (A.5)
                           
                              Δ
                              Φ
                              =
                              
                                 
                                    Δ
                                    
                                       ϕ
                                       i
                                    
                                    
                                    |
                                    
                                    Δ
                                    
                                       ϕ
                                       i
                                    
                                    =
                                    mod
                                    
                                       
                                          
                                             
                                                
                                                   ϕ
                                                   i
                                                   ′
                                                
                                                −
                                                
                                                   ϕ
                                                   i
                                                
                                             
                                          
                                          ,
                                          2
                                          π
                                       
                                    
                                    ,
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    N
                                 
                              
                              ,
                              
                              Δ
                              
                                 ϕ
                                 i
                              
                              ∈
                              
                                 
                                    0
                                    ,
                                    2
                                    π
                                 
                              
                           
                        
                     
                  

The mean of the elements in the set Δ
                     Φ can be regarded as the rotation angle θ between S and S′. However, there may be some mismatches in P and P′, which will lead to a large deviation between the true rotation angle and the computed result. Therefore, the false matches should be removed before the rotation angle is estimated. Similar to the idea in the Hough transform [42], we also present a method based on the voting mechanism to remove the mismatched MSER pairs and determine the rotation angle θ in this paper.

Firstly, each matched pair votes for its corresponding angular interval. The interval [0,2π) is divided into 36 smaller sub-intervals of equal size.
                        8
                     
                     
                        8
                        Here, more than 36 sub-intervals can be divided, but slight improvements will be made. So, the number of sub-intervals is set to 36 in our experiments by comprehensively considering the computation complexity and accuracy.
                      For the nth (n
                     =1,2,…,36) sub-interval, a new sub set Ψ
                     
                        n
                      is defined by
                        
                           (A.6)
                           
                              
                                 Ψ
                                 n
                              
                              =
                              
                                 
                                    
                                       
                                          Δ
                                          
                                             φ
                                             
                                                n
                                                ,
                                                
                                                j
                                             
                                          
                                       
                                    
                                    Δ
                                    
                                       φ
                                       
                                          n
                                          ,
                                          
                                          j
                                       
                                    
                                    ∈
                                    Δ
                                    Φ
                                    ,
                                    
                                    and
                                    
                                    Δ
                                    
                                       φ
                                       
                                          n
                                          ,
                                          
                                          j
                                       
                                    
                                    ∈
                                    
                                       
                                          
                                             π
                                             18
                                          
                                          
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          ,
                                          
                                             π
                                             18
                                          
                                          n
                                       
                                    
                                    ,
                                    
                                    j
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    
                                       a
                                       n
                                    
                                 
                              
                           
                        
                     where a
                     
                        n
                      is the total number of the elements that fall into the sub-interval 
                        
                           
                              
                                 π
                                 18
                              
                              
                                 
                                    n
                                    −
                                    1
                                 
                              
                              ,
                              
                                 π
                                 18
                              
                              n
                           
                        
                     .

Then, the main interval 
                        
                           
                              
                                 π
                                 18
                              
                              
                                 
                                    m
                                    −
                                    1
                                 
                              
                              ,
                              
                                 π
                                 18
                              
                              m
                           
                        
                      containing the maximum elements is obtained, where m is determined by
                        
                           (A.7)
                           
                              m
                              =
                              
                                 
                                    
                                       arg
                                       max
                                    
                                    n
                                 
                              
                              
                                 
                                    
                                       a
                                       n
                                    
                                    
                                       
                                          n
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          36
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  

As shown in Fig. A2, the interval 
                        
                           
                              
                                 π
                                 18
                              
                              
                                 
                                    m
                                    −
                                    1
                                 
                              
                              ,
                              
                                 π
                                 18
                              
                              m
                           
                        
                      marked by orange color represents the main interval.


                     
                  

Finally, the mismatched pairs are rejected based on the voting results. The matched pairs from S and S′ are regarded as the correct matches if their angle differences fall into the main interval. However, considering the computation error, the matched point pairs whose angle differences fall into the intervals around the main one (e.g., the intervals marked by the brown color in Fig. A2) may also be regarded as the correct pairs.8
                  

In this paper, the matched pairs whose angle differences fall into the interval 
                        
                           
                              
                                 π
                                 18
                              
                              
                                 
                                    m
                                    −
                                    3
                                 
                              
                              ,
                              
                                 π
                                 18
                              
                              
                                 
                                    m
                                    +
                                    2
                                 
                              
                           
                        
                      are finally regarded as the correct ones. The rest of the matched pairs are regarded as the mismatched ones and then removed from S and S′. Correspondingly, the rotation angle between S and S′ is computed by
                        
                           (A.8)
                           
                              θ
                              =
                              mod
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                p
                                                =
                                                m
                                                −
                                                2
                                             
                                             
                                                m
                                                +
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      q
                                                      =
                                                      1
                                                   
                                                   
                                                      a
                                                      p
                                                   
                                                
                                                
                                                   
                                                      
                                                         Δ
                                                         
                                                            φ
                                                            
                                                               p
                                                               ,
                                                               q
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                p
                                                =
                                                m
                                                −
                                                2
                                             
                                             
                                                m
                                                +
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   a
                                                   p
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    2
                                    π
                                 
                              
                              .
                           
                        
                     
                  

However, there will be some computation errors in Eq. (A.8) when the main interval is near to 0 or 2π (i.e., m
                     ≥35 or m
                     ≤2). For example, in the case of m
                     =36, some of the angles △
                     φ
                     
                        p,q
                      (e.g., the angles in the blue regions in Fig. A2) are near to 2π, but the others (e.g., the angles in the green regions in Fig. A2) will be near to 0. Then the mean of these angles has a large deviation from 2π, and a false result will be obtained. In addition, some values of p will exceed the range of [1,36] in this case. Therefore, in order to avoid such errors, p and △
                     φ
                     
                        p,q
                      are simply modified as Eqs. (A.9) or (A.10) during the computation of θ for m
                     ≥35 or m
                     ≤2.
                        
                           (A.9)
                           
                              
                                 
                                    
                                       
                                          p
                                          =
                                          p
                                          −
                                          36
                                       
                                    
                                    
                                       
                                          Δ
                                          
                                             φ
                                             
                                                p
                                                ,
                                                q
                                             
                                          
                                          =
                                          Δ
                                          
                                             φ
                                             
                                                p
                                                ,
                                                q
                                             
                                          
                                          +
                                          2
                                          π
                                       
                                    
                                 
                              
                              
                              ,
                              
                              when
                              
                              m
                              ≥
                              35
                              
                              and
                              
                              p
                              ≥
                              37
                           
                        
                     
                     
                        
                           (A.10)
                           
                              
                                 
                                    
                                       
                                          p
                                          =
                                          p
                                          +
                                          36
                                       
                                    
                                    
                                       
                                          Δ
                                          
                                             φ
                                             
                                                p
                                                ,
                                                q
                                             
                                          
                                          =
                                          Δ
                                          
                                             φ
                                             
                                                p
                                                ,
                                                q
                                             
                                          
                                          −
                                          2
                                          π
                                       
                                    
                                 
                              
                              
                              ,
                              
                              when
                              
                              m
                              ≤
                              2
                              
                              and
                              
                              p
                              ≤
                              0
                           
                        
                     
                  

@&#REFERENCES@&#

