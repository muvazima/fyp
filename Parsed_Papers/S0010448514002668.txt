@&#MAIN-TITLE@&#Degree reduction of Bézier curves with restricted control points area

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a new approach to the problem of degree reduction of Bézier curves.


                        
                        
                           
                           We impose constraints of the control points area.


                        
                        
                           
                           The degree reduced curve is suitable for further modification and applications.


                        
                        
                           
                           We give and compare two methods of solving the new problem.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Bézier curve

Degree reduction

Constrained least squares approximation

@&#ABSTRACT@&#


               
               
                  In this paper, we propose a new approach to the problem of degree reduction of Bézier curves with respect to the least squares norm. We impose restrictions of the control points area to get more intuitive location of the control points. As a result, the degree reduced curve is suitable for further modification and applications. We present and compare two methods of solving the new problem. First one is based on quadratic programming approach and the other on BVLS algorithm. Some illustrative examples are given.
               
            

@&#INTRODUCTION@&#

The problem of degree reduction of Bézier curves is to approximate an original curve with another Bézier curve of lower degree. It is an important problem in CAGD. Degree reduction of curves might be necessary for data exchange between computer modeling systems. It is also used in data compression.

First, let us discuss the conventional approach to the problem of degree reduction of Bézier curves. The most frequently used strategy is to find control points of the degree reduced curve in order to minimize a chosen error function. Error of the approximation is often measured using 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm (see, e.g.,  [1–4]) or 
                        
                           
                              L
                           
                           
                              ∞
                           
                        
                     -norm (see, e.g.,  [5–8]). In the case of 
                        
                           
                              L
                           
                           
                              2
                           
                        
                     -norm, the algorithms usually solve a system of normal equations (see, e.g.,  [2]). Some of them use different approach, e.g., the properties of so-called constrained dual Bernstein basis polynomials (see  [3]). Degree reduction with respect to the 
                        
                           
                              L
                           
                           
                              ∞
                           
                        
                     -norm can be solved using, e.g., Chebyshev economization (see  [7]). To maintain a smooth connection in the case of degree reduction of many Bézier curves joined end-to-end, constraints involving parametric continuity (see, e.g.,  [1,3,9]) or geometric continuity (see, e.g.,  [2,4,10]) at both endpoints are imposed.

As a result of the conventional degree reduction, one may obtain control points, which are located far away from the plot of the curve. In the next section, we give appropriate example and explain why this is a serious defect. Then, we show that this issue can be eliminated by restricting the control points area. Therefore, the main objective of this paper is to propose a new approach to the problem by imposing additional constraints of the new type. Such approach allows us to obtain results, which seem to be practically more useful. Furthermore, we show that the solution always exists. The new degree reduction problem requires completely different methods than in the case of the conventional problem. In this paper, we describe two approaches. First one solves the quadratic programming problem using Wolfe’s method. The other one is based on BVLS algorithm, which allows to determine the solution by solving simple subproblems. We relate the subproblem with the degree reduction problem and give formula for its solution. Because of the additional restrictions, the approximation error must be larger than for the conventional problem. The new problem is also more difficult to solve. As a result, the running times of presented methods are longer.

The outline of this paper is as follows. Further in this section, we give necessary definitions and notation. Section  2 contains example motivating new approach to the problem of degree reduction. In Section  3, we formulate the problem of degree reduction of Bézier curves with restricted control points area. In Section  4, we solve the problem using quadratic programming approach and prove that the solution always exists. Section  5 brings another method, which is based on BVLS algorithm. Results of experiments are given in Section  6, and for a brief summary of the paper, see Section  7. In the Appendix, we give formula for the solution of the subproblem, which is an essential part of the BVLS algorithm.

Let 
                        
                           
                              Π
                           
                           
                              n
                           
                           
                              2
                           
                        
                        
                        
                           (
                           n
                           ∈
                           N
                           )
                        
                      denote the space of all parametric polynomials in 
                        
                           
                              R
                           
                           
                              2
                           
                        
                      of degree at most 
                        n
                     . A Bézier curve 
                     
                        
                           
                              P
                           
                           
                              n
                           
                        
                        ∈
                        
                           
                              Π
                           
                           
                              n
                           
                           
                              2
                           
                        
                      is the following parametric curve: 
                        
                           
                              
                                 
                                    P
                                 
                                 
                                    n
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 
                                    
                                       b
                                    
                                 
                                 
                                    n
                                    ,
                                    t
                                 
                              
                              
                                 p
                              
                              
                              
                                 (
                                 0
                                 ≤
                                 t
                                 ≤
                                 1
                                 )
                              
                              ,
                           
                        
                      where 
                        
                           p
                        
                        ≔
                        
                           
                              
                                 [
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       n
                                    
                                 
                                 ]
                              
                           
                           
                              T
                           
                        
                      with 
                        
                           
                              p
                           
                           
                              i
                           
                        
                        ≔
                        
                           (
                           
                              
                                 p
                              
                              
                                 i
                              
                              
                                 x
                              
                           
                           ,
                           
                              
                                 p
                              
                              
                                 i
                              
                              
                                 y
                              
                           
                           )
                        
                        ∈
                        
                           
                              R
                           
                           
                              2
                           
                        
                     , and 
                        
                           
                              
                                 b
                              
                           
                           
                              n
                              ,
                              t
                           
                        
                        ≔
                        
                           [
                           
                              
                                 B
                              
                              
                                 0
                              
                              
                                 n
                              
                           
                           
                              (
                              t
                              )
                           
                           ,
                           
                              
                                 B
                              
                              
                                 1
                              
                              
                                 n
                              
                           
                           
                              (
                              t
                              )
                           
                           ,
                           …
                           ,
                           
                              
                                 B
                              
                              
                                 n
                              
                              
                                 n
                              
                           
                           
                              (
                              t
                              )
                           
                           ]
                        
                     , where 
                        
                           
                              B
                           
                           
                              i
                           
                           
                              n
                           
                        
                      denotes the 
                        i
                     
                     th Bernstein polynomial of degree 
                     
                        n
                     , given by
                        
                           
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                              ≔
                              
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       (
                                       1
                                       −
                                       t
                                       )
                                    
                                 
                                 
                                    n
                                    −
                                    i
                                 
                              
                              
                              
                                 (
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 ;
                                 
                                 n
                                 ∈
                                 N
                                 )
                              
                              .
                           
                        
                      The components of vector 
                        
                           p
                        
                      are called control points of Bézier curve 
                        
                           
                              P
                           
                           
                              n
                           
                        
                     , and 
                        n
                      is the degree of the curve.

Let 
                        
                           
                              
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 }
                              
                           
                           
                              k
                              =
                              0
                           
                           
                              N
                           
                        
                        
                        
                           (
                           N
                           ∈
                           N
                           )
                        
                      be a strictly increasing sequence whose elements are in the interval 
                        
                           [
                           0
                           ,
                           1
                           ]
                        
                     . The least squares distance between Bézier curves 
                        
                           
                              P
                           
                           
                              n
                           
                        
                      and 
                        
                           
                              R
                           
                           
                              m
                           
                        
                        ∈
                        
                           
                              Π
                           
                           
                              m
                           
                           
                              2
                           
                        
                      is given by the formula 
                        
                           (1.1)
                           
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       m
                                    
                                 
                                 )
                              
                              ≔
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          0
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   P
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                                
                                                   R
                                                
                                                
                                                   m
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                           
                        
                      where 
                        
                           ‖
                           ⋅
                           ‖
                        
                      denotes the Euclidean vector norm in 
                        
                           
                              R
                           
                           
                              2
                           
                        
                     .

Let 
                        
                           M
                        
                        ∈
                        
                           
                              R
                           
                           
                              n
                              ×
                              m
                           
                        
                      be a matrix, and let 
                        A
                        ≔
                        
                           {
                           
                              
                                 i
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 i
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 i
                              
                              
                                 k
                              
                           
                           }
                        
                        ⊂
                        
                           [
                           0
                           ,
                           n
                           −
                           1
                           ]
                        
                        ,
                        B
                        ≔
                        
                           {
                           
                              
                                 j
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 j
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 j
                              
                              
                                 l
                              
                           
                           }
                        
                        ⊂
                        
                           [
                           0
                           ,
                           m
                           −
                           1
                           ]
                        
                      be sets of natural numbers, sorted in ascending order. Notation 
                        
                           (1.2)
                           
                              
                                 
                                    
                                       M
                                    
                                 
                                 
                                    A
                                    ,
                                    B
                                 
                              
                           
                        
                      defines a matrix formed by rows 
                        
                           
                              i
                           
                           
                              1
                           
                        
                        +
                        1
                        ,
                        
                           
                              i
                           
                           
                              2
                           
                        
                        +
                        1
                        ,
                        …
                        ,
                        
                           
                              i
                           
                           
                              k
                           
                        
                        +
                        1
                      and columns 
                        
                           
                              j
                           
                           
                              1
                           
                        
                        +
                        1
                        ,
                        
                           
                              j
                           
                           
                              2
                           
                        
                        +
                        1
                        ,
                        …
                        ,
                        
                           
                              j
                           
                           
                              l
                           
                        
                        +
                        1
                      of matrix 
                        
                           M
                        
                     . Similarly, we use 
                        
                           
                              
                                 v
                              
                           
                           
                              A
                           
                        
                     , where 
                        
                           v
                        
                      is a vector in 
                        
                           
                              R
                           
                           
                              n
                           
                        
                     .

For 
                        
                           v
                        
                        ≔
                        
                           
                              
                                 [
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       r
                                    
                                 
                                 ]
                              
                           
                           
                              T
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              r
                           
                        
                      and 
                        
                           w
                        
                        ≔
                        
                           
                              
                                 [
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       r
                                    
                                 
                                 ]
                              
                           
                           
                              T
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              r
                           
                        
                     , notation 
                        
                           v
                        
                        ≤
                        
                           w
                        
                      means that 
                        
                           
                              v
                           
                           
                              i
                           
                        
                        ≤
                        
                           
                              w
                           
                           
                              i
                           
                        
                        
                        
                           (
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           r
                           )
                        
                     . Definition of 
                        
                           v
                        
                        ≥
                        
                           w
                        
                      is similar to the previous one.

To solve the conventional problem of degree reduction, we look for a curve that minimizes a properly defined error and satisfies continuity conditions at the endpoints. This approach gives precise results, however, we have no control over the location of the resulting control points.

A designer that modifies the control points uses a convex hull property and assumes that the curve will not be far away from the control points. It can be said, that the size of the convex hull is a measure of predictability of the curve. In many cases, resulting control points are located far away from the plot of the curve so that the coordinates can be large numbers. As a result, it may happen that further editing of the obtained curve can be difficult or even impossible.

Notice that simple tests based on the convex hull can give quick solutions of problems, which usually require more expensive calculation. For example, if the convex hulls of two curves do not intersect, which is fairly easy to determine, then the curves do not intersect, which normally is more expensive to decide. Intersection problem has many practical applications. Suppose that two Bézier curves represent the paths of robotic arms. To avoid collisions one should solve the intersection problem (see  [11, p. 49]). Analogously, one can quickly check that a curve and a surface do not intersect, or decide that a point does not lie on a curve. This strategy can be useful, but only if the control points are not far away from the curve and the convex hull is not too big.

Example given below shows that by imposing reasonable constraints on the control points, one can eliminate the above-described defect and get satisfying results. 
                        Example 2.1
                        Let 
                              P
                            denote the Bézier curve “Ampersand” of degree ten (for the control points, see http://www.ii.uni.wroc.pl/~pgo/papers.html). Let 
                              R
                            be the Bézier curve of degree eight, satisfying the following conditions:
                              
                                 1.
                                 
                                    
                                       P
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       R
                                       
                                          (
                                          t
                                          )
                                       
                                     for 
                                       t
                                       =
                                       0
                                       ,
                                       1
                                    ;

distance 
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          P
                                          ,
                                          R
                                          )
                                       
                                     is minimized, where 
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       ≔
                                       k
                                       /
                                       N
                                       
                                       
                                          (
                                          k
                                          =
                                          0
                                          ,
                                          1
                                          ,
                                          …
                                          ,
                                          N
                                          )
                                       
                                     with 
                                       N
                                       =
                                       14
                                     (cf. (1.1)).


                           Fig. 1
                           (a) shows the plots of curves 
                              P
                            and 
                              R
                           . The result is quite precise, but this solution has certain defect, which is illustrated in Fig. 1(b) showing the location of control points of the curves. Clearly, one can see that the resulting control points are far away from the plot of curve 
                              R
                           . This can significantly disturb further modeling of this curve because it is difficult to modify it by moving such control points. Furthermore, the convex hull of curve 
                              R
                            is much bigger, than the one of curve 
                              P
                           , and useless in finding quick solutions of the problems mentioned earlier.

Now, let us impose additional constraints on the control points of curve 
                              R
                           . We enforce their location inside the specified rectangular area (including edges of the rectangle). As a result, we obtain curve having more intuitive location of the control points (see Fig. 2
                           ). The curve can be easily modified, which is desired from a practical point of view. In addition, this approach leads to much smaller convex hull. Obviously, the error is larger than for the conventional degree reduction because we imposed the additional constraints. However, the result of approximation is satisfying.

Taking into account the above remarks, in this paper we propose a new approach to the problem of degree reduction of Bézier curves, which allows us to restrict the area of resulting control points.

In this section, we formulate the following new variant of degree reduction of Bézier curves. 
                        Problem 3.1
                        Let be given a Bézier curve 
                              
                                 
                                    P
                                 
                                 
                                    n
                                 
                              
                              ∈
                              
                                 
                                    Π
                                 
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                           , 
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          n
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          n
                                          ,
                                          t
                                       
                                    
                                    
                                       p
                                    
                                    
                                    
                                       (
                                       0
                                       ≤
                                       t
                                       ≤
                                       1
                                       )
                                    
                                    .
                                 
                              
                            Find a Bézier curve of degree 
                              m
                           , 
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          m
                                          ,
                                          t
                                       
                                    
                                    
                                       r
                                    
                                    
                                    
                                       (
                                       0
                                       ≤
                                       t
                                       ≤
                                       1
                                       ;
                                       
                                       m
                                       <
                                       n
                                       )
                                    
                                    ,
                                 
                              
                            where 
                              
                                 r
                              
                              ≔
                              
                                 
                                    
                                       [
                                       
                                          
                                             r
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             m
                                          
                                       
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                            is a vector of searched control points 
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              ≔
                              
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                    
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                    
                                       y
                                    
                                 
                                 )
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              
                              
                                 (
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 )
                              
                           , satisfying the following conditions: 
                              
                                 (i)
                                 value of the least squares error 
                                       
                                          (3.1)
                                          
                                             E
                                             ≡
                                             E
                                             
                                                (
                                                
                                                   r
                                                
                                                )
                                             
                                             ≔
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ,
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      m
                                                   
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         0
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     b
                                                                  
                                                               
                                                               
                                                                  n
                                                                  ,
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               p
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     b
                                                                  
                                                               
                                                               
                                                                  m
                                                                  ,
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               r
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                     is minimized in the space 
                                       
                                          
                                             Π
                                          
                                          
                                             m
                                          
                                          
                                             2
                                          
                                       
                                    , where 
                                       
                                          
                                             
                                                {
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                }
                                             
                                          
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             N
                                          
                                       
                                       
                                       
                                          (
                                          N
                                          ∈
                                          N
                                          )
                                       
                                     is a given, strictly increasing sequence whose elements are in the interval 
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                    ;


                                    
                                       
                                          
                                             P
                                          
                                          
                                             n
                                          
                                       
                                     and 
                                       
                                          
                                             R
                                          
                                          
                                             m
                                          
                                       
                                     are 
                                       
                                          
                                             C
                                          
                                          
                                             α
                                             ,
                                             β
                                          
                                       
                                    -continuous (
                                       α
                                       ,
                                       β
                                       ≥
                                       0
                                     and 
                                       α
                                       +
                                       β
                                       <
                                       m
                                       −
                                       1
                                    ) at the endpoints, i.e., 
                                       
                                          (3.2)
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   n
                                                
                                                
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             
                                                (
                                                0
                                                )
                                             
                                             =
                                             
                                                
                                                   R
                                                
                                                
                                                   m
                                                
                                                
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                             
                                                (
                                                0
                                                )
                                             
                                             
                                             
                                                (
                                                i
                                                =
                                                0
                                                ,
                                                1
                                                ,
                                                …
                                                ,
                                                α
                                                )
                                             
                                             ,
                                             
                                             
                                                
                                                   P
                                                
                                                
                                                   n
                                                
                                                
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                             
                                                (
                                                1
                                                )
                                             
                                             =
                                             
                                                
                                                   R
                                                
                                                
                                                   m
                                                
                                                
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                             
                                             
                                                (
                                                1
                                                )
                                             
                                             
                                             
                                                (
                                                j
                                                =
                                                0
                                                ,
                                                1
                                                ,
                                                …
                                                ,
                                                β
                                                )
                                             
                                             ;
                                          
                                       
                                    
                                 

control points 
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                       
                                       
                                          (
                                          α
                                          <
                                          i
                                          <
                                          m
                                          −
                                          β
                                          )
                                       
                                     are located inside the specified rectangular area, including edges of the rectangle, i.e.,  
                                       
                                          (3.3)
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   z
                                                
                                             
                                             ≤
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                                
                                                   z
                                                
                                             
                                             ≤
                                             
                                                
                                                   u
                                                
                                                
                                                   z
                                                
                                             
                                             
                                             
                                                (
                                                i
                                                =
                                                α
                                                +
                                                1
                                                ,
                                                α
                                                +
                                                2
                                                ,
                                                …
                                                ,
                                                m
                                                −
                                                β
                                                −
                                                1
                                                ;
                                                
                                                z
                                                =
                                                x
                                                ,
                                                y
                                                )
                                             
                                             ,
                                          
                                       
                                     where 
                                       
                                          
                                             l
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             y
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             y
                                          
                                       
                                       ∈
                                       R
                                    .


                     
                        Remark 3.2
                        Further in this paper, the minimization of (3.1), with constraints (3.2), but without conditions (3.3) is called the traditional degree reduction.

First, notice that conditions (3.2) imply the following formulas for the coordinates of control points 
                        
                           
                              r
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              r
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              r
                           
                           
                              α
                           
                        
                      and 
                        
                           
                              r
                           
                           
                              m
                           
                        
                        ,
                        
                           
                              r
                           
                           
                              m
                              −
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              r
                           
                           
                              m
                              −
                              β
                           
                        
                      (see, e.g.,  [3]): 
                        
                           
                              (3.4)
                              
                                 
                                    
                                       r
                                    
                                    
                                       j
                                    
                                    
                                       z
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                m
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       Δ
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                    
                                       z
                                    
                                 
                                 −
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       0
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          (
                                          −
                                          1
                                          )
                                       
                                    
                                    
                                       j
                                       +
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       
                                          j
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    
                                       r
                                    
                                    
                                       k
                                    
                                    
                                       z
                                    
                                 
                                 
                                 
                                    (
                                    j
                                    =
                                    0
                                    ,
                                    1
                                    ,
                                    …
                                    ,
                                    α
                                    )
                                 
                                 ,
                              
                           
                           
                              (3.5)
                              
                                 
                                    
                                       r
                                    
                                    
                                       m
                                       −
                                       j
                                    
                                    
                                       z
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          −
                                          1
                                          )
                                       
                                    
                                    
                                       j
                                    
                                 
                                 
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                m
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       Δ
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       n
                                       −
                                       j
                                    
                                    
                                       z
                                    
                                 
                                 −
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       
                                          (
                                          −
                                          1
                                          )
                                       
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       
                                          j
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    
                                       r
                                    
                                    
                                       m
                                       −
                                       j
                                       +
                                       k
                                    
                                    
                                       z
                                    
                                 
                                 
                                 
                                    (
                                    j
                                    =
                                    0
                                    ,
                                    1
                                    ,
                                    …
                                    ,
                                    β
                                    )
                                 
                                 ,
                              
                           
                        
                      where 
                        z
                        =
                        x
                        ,
                        y
                     , and 
                        
                           
                              
                                 
                                    Δ
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                              ≔
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                              ≔
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                              
                              
                                 (
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 )
                              
                              .
                           
                        
                     
                  

The remaining control points 
                        
                           
                              r
                           
                           
                              α
                              +
                              1
                           
                        
                        ,
                        
                           
                              r
                           
                           
                              α
                              +
                              2
                           
                        
                        ,
                        …
                        ,
                        
                           
                              r
                           
                           
                              m
                              −
                              β
                              −
                              1
                           
                        
                      are to be determined to satisfy conditions (i) and (iii). 
                        Remark 3.3
                        It is easy to check, that the square of error function   (3.1) can be represented as 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          r
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          E
                                       
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             x
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          E
                                       
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             y
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          z
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             z
                                          
                                       
                                       )
                                    
                                    ≔
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                =
                                                0
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                      
                                                      
                                                         n
                                                         ,
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         z
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                      
                                                      
                                                         m
                                                         ,
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                      
                                                      
                                                         z
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                            with 
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    z
                                 
                              
                              ≔
                              
                                 
                                    
                                       [
                                       
                                          
                                             p
                                          
                                          
                                             0
                                          
                                          
                                             z
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             1
                                          
                                          
                                             z
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             n
                                          
                                          
                                             z
                                          
                                       
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                              ,
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    z
                                 
                              
                              ≔
                              
                                 
                                    
                                       [
                                       
                                          
                                             r
                                          
                                          
                                             0
                                          
                                          
                                             z
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                          
                                             z
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             m
                                          
                                          
                                             z
                                          
                                       
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                              
                              
                                 (
                                 z
                                 =
                                 x
                                 ,
                                 y
                                 )
                              
                           . Therefore, in order to satisfy condition (i), with constraints (iii), it is sufficient to minimize independently 
                              
                                 
                                    E
                                 
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    E
                                 
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                           , under the conditions (3.3) for 
                              z
                              =
                              x
                            and 
                              z
                              =
                              y
                           , respectively. As a result, further in this paper, we limit ourselves to the case of 
                              z
                              =
                              x
                           .

In the next two sections, we solve Problem 3.1 and use the following definitions. Let us define vectors 
                        
                           
                              
                                 
                                    
                                       l
                                    
                                 
                                 
                                    x
                                 
                              
                              ≔
                              
                                 
                                    
                                       [
                                       
                                          
                                             l
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             x
                                          
                                       
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    m
                                    −
                                    β
                                    −
                                    α
                                    −
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    x
                                 
                              
                              ≔
                              
                                 
                                    
                                       [
                                       
                                          
                                             u
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             x
                                          
                                       
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    m
                                    −
                                    β
                                    −
                                    α
                                    −
                                    1
                                 
                              
                              ,
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       
                                          r
                                       
                                    
                                    
                                       x
                                    
                                    
                                       c
                                    
                                 
                                 ≔
                                 
                                    
                                       
                                          [
                                          
                                             
                                                r
                                             
                                             
                                                0
                                             
                                             
                                                x
                                             
                                          
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                1
                                             
                                             
                                                x
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                α
                                             
                                             
                                                x
                                             
                                          
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                m
                                                −
                                                β
                                             
                                             
                                                x
                                             
                                          
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                m
                                                −
                                                β
                                                +
                                                1
                                             
                                             
                                                x
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                m
                                             
                                             
                                                x
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       
                                          r
                                       
                                    
                                    
                                       x
                                    
                                    
                                       f
                                    
                                 
                                 ≔
                                 
                                    
                                       
                                          [
                                          
                                             
                                                r
                                             
                                             
                                                α
                                                +
                                                1
                                             
                                             
                                                x
                                             
                                          
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                α
                                                +
                                                2
                                             
                                             
                                                x
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                m
                                                −
                                                β
                                                −
                                                1
                                             
                                             
                                                x
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 .
                              
                           
                        
                      Similarly, we have 
                        
                           
                              
                                 
                                    
                                       
                                          b
                                       
                                    
                                    
                                       m
                                       ,
                                       t
                                    
                                    
                                       c
                                    
                                 
                                 ≔
                                 
                                    [
                                    
                                       
                                          B
                                       
                                       
                                          0
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ,
                                    
                                       
                                          B
                                       
                                       
                                          1
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          B
                                       
                                       
                                          α
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ,
                                    
                                       
                                          B
                                       
                                       
                                          m
                                          −
                                          β
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ,
                                    
                                       
                                          B
                                       
                                       
                                          m
                                          −
                                          β
                                          +
                                          1
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          B
                                       
                                       
                                          m
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ]
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       
                                          b
                                       
                                    
                                    
                                       m
                                       ,
                                       t
                                    
                                    
                                       f
                                    
                                 
                                 ≔
                                 
                                    [
                                    
                                       
                                          B
                                       
                                       
                                          α
                                          +
                                          1
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ,
                                    
                                       
                                          B
                                       
                                       
                                          α
                                          +
                                          2
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          B
                                       
                                       
                                          m
                                          −
                                          β
                                          −
                                          1
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     
                  

Now, we use the quadratic programming approach to solve Problem 3.1.

Quadratic programming is an optimization problem of minimizing or maximizing a quadratic objective function 
                     
                        f
                      of several variables 
                        
                           x
                        
                        ∈
                        
                           
                              R
                           
                           
                              i
                           
                        
                     , subject to linear constraints on these variables. More precisely, we have to find the extremum of function 
                        
                           (4.1)
                           
                              f
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 x
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 Q
                              
                              
                                 x
                              
                              ,
                           
                        
                      where 
                        
                           Q
                        
                        ∈
                        
                           
                              R
                           
                           
                              i
                              ×
                              i
                           
                        
                        ,
                        
                           c
                        
                        ∈
                        
                           
                              R
                           
                           
                              i
                           
                        
                     , subject to the following constraints: 
                        
                           (4.2)
                           
                              
                                 G
                              
                              
                                 x
                              
                              ≤
                              
                                 h
                              
                              ,
                              
                              
                                 x
                              
                              ≥
                              
                                 0
                              
                              ,
                           
                        
                      where 
                        
                           G
                        
                        ∈
                        
                           
                              R
                           
                           
                              j
                              ×
                              i
                           
                        
                        ,
                        
                           h
                        
                        ∈
                        
                           
                              R
                           
                           
                              j
                           
                        
                     .

We will show that significant terms of function 
                        
                           
                              E
                           
                           
                              x
                           
                           
                              2
                           
                        
                      can be written in the form (4.1). First, notice that 
                        
                           (4.3)
                           
                              
                                 
                                    E
                                 
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          r
                                       
                                    
                                    
                                       x
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    0
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             n
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             m
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             x
                                          
                                       
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    0
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             n
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             m
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             f
                                          
                                       
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             x
                                          
                                          
                                             f
                                          
                                       
                                       −
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             m
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             c
                                          
                                       
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             x
                                          
                                          
                                             c
                                          
                                       
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    0
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             m
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             f
                                          
                                       
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             x
                                          
                                          
                                             f
                                          
                                       
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              −
                              2
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    0
                                 
                                 
                                    N
                                 
                              
                              
                                 (
                                 
                                    (
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          n
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          x
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          m
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          f
                                       
                                    
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          x
                                       
                                       
                                          f
                                       
                                    
                                    )
                                 
                                 −
                                 
                                    (
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          m
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          c
                                       
                                    
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          x
                                       
                                       
                                          c
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          m
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          f
                                       
                                    
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          x
                                       
                                       
                                          f
                                       
                                    
                                    )
                                 
                                 )
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    0
                                 
                                 
                                    N
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   b
                                                
                                             
                                             
                                                n
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                x
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   b
                                                
                                             
                                             
                                                m
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                c
                                             
                                          
                                          
                                             
                                                
                                                   r
                                                
                                             
                                             
                                                x
                                             
                                             
                                                c
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 2
                                 
                                    (
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          n
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          x
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          m
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          c
                                       
                                    
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          x
                                       
                                       
                                          c
                                       
                                    
                                    )
                                 
                                 )
                              
                              ≕
                              g
                              
                                 (
                                 
                                    
                                       
                                          r
                                       
                                    
                                    
                                       x
                                    
                                    
                                       f
                                    
                                 
                                 )
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    0
                                 
                                 
                                    N
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   b
                                                
                                             
                                             
                                                n
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                x
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   b
                                                
                                             
                                             
                                                m
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                c
                                             
                                          
                                          
                                             
                                                
                                                   r
                                                
                                             
                                             
                                                x
                                             
                                             
                                                c
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 2
                                 
                                    (
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          n
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          x
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          m
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          c
                                       
                                    
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          x
                                       
                                       
                                          c
                                       
                                    
                                    )
                                 
                                 )
                              
                              .
                           
                        
                      Term (4.3) is constant, therefore, it is sufficient to minimize function 
                        g
                     . It is easy to check, that 
                        
                           
                              g
                              
                                 (
                                 
                                    
                                       
                                          r
                                       
                                    
                                    
                                       x
                                    
                                    
                                       f
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    x
                                 
                                 
                                    f
                                 
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             x
                                          
                                          
                                             f
                                          
                                       
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 Q
                              
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    x
                                 
                                 
                                    f
                                 
                              
                              ,
                           
                        
                      where 
                        
                           Q
                        
                        ≔
                        
                           [
                           
                              
                                 Q
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           ]
                        
                        ∈
                        
                           
                              R
                           
                           
                              
                                 (
                                 m
                                 −
                                 β
                                 −
                                 α
                                 −
                                 1
                                 )
                              
                              ×
                              
                                 (
                                 m
                                 −
                                 β
                                 −
                                 α
                                 −
                                 1
                                 )
                              
                           
                        
                        ,
                        
                           d
                        
                        ≔
                        
                           [
                           
                              
                                 d
                              
                              
                                 i
                              
                           
                           ]
                        
                        ∈
                        
                           
                              R
                           
                           
                              m
                              −
                              β
                              −
                              α
                              −
                              1
                           
                        
                     , with 
                        
                           
                              (4.4)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ≔
                                 2
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       0
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       +
                                       α
                                    
                                    
                                       m
                                    
                                 
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    
                                       B
                                    
                                    
                                       j
                                       +
                                       α
                                    
                                    
                                       m
                                    
                                 
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    m
                                    −
                                    β
                                    −
                                    α
                                    −
                                    1
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 ≔
                                 2
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       0
                                    
                                    
                                       N
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          m
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          c
                                       
                                    
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          x
                                       
                                       
                                          c
                                       
                                    
                                    −
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          n
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          x
                                       
                                    
                                    )
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       +
                                       α
                                    
                                    
                                       m
                                    
                                 
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                 
                                    (
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    m
                                    −
                                    β
                                    −
                                    α
                                    −
                                    1
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

Constraints (3.3), for 
                        z
                        =
                        x
                     , are not written in the form (4.2). However, they can be easily adjusted. Assume that 
                        
                           
                              
                                 s
                              
                           
                           
                              x
                           
                           
                              f
                           
                        
                        ≔
                        
                           
                              
                                 r
                              
                           
                           
                              x
                           
                           
                              f
                           
                        
                        −
                        
                           
                              
                                 l
                              
                           
                           
                              x
                           
                        
                      and 
                        
                           h
                        
                        ≔
                        
                           
                              
                                 u
                              
                           
                           
                              x
                           
                        
                        −
                        
                           
                              
                                 l
                              
                           
                           
                              x
                           
                        
                     . Then, the problem is to minimize 
                        
                           
                              g
                              
                                 (
                                 
                                    
                                       
                                          s
                                       
                                    
                                    
                                       x
                                    
                                    
                                       f
                                    
                                 
                                 +
                                 
                                    
                                       
                                          l
                                       
                                    
                                    
                                       x
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       s
                                    
                                 
                                 
                                    x
                                 
                                 
                                    f
                                 
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                s
                                             
                                          
                                          
                                             x
                                          
                                          
                                             f
                                          
                                       
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 Q
                              
                              
                                 
                                    
                                       s
                                    
                                 
                                 
                                    x
                                 
                                 
                                    f
                                 
                              
                              +
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       l
                                    
                                 
                                 
                                    x
                                 
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       l
                                    
                                 
                                 
                                    x
                                 
                                 
                                    T
                                 
                              
                              
                                 Q
                              
                              
                                 
                                    
                                       l
                                    
                                 
                                 
                                    x
                                 
                              
                           
                        
                      with respect to 
                        
                           
                              
                                 s
                              
                           
                           
                              x
                           
                           
                              f
                           
                        
                     , where 
                        
                           c
                        
                        ≔
                        
                           d
                        
                        +
                        
                           Q
                        
                        
                           
                              
                                 l
                              
                           
                           
                              x
                           
                        
                     , subject to the constraints 
                        
                           (4.5)
                           
                              
                                 G
                              
                              
                                 
                                    
                                       s
                                    
                                 
                                 
                                    x
                                 
                                 
                                    f
                                 
                              
                              ≤
                              
                                 h
                              
                              ,
                              
                              
                                 
                                    
                                       s
                                    
                                 
                                 
                                    x
                                 
                                 
                                    f
                                 
                              
                              ≥
                              
                                 0
                              
                              ,
                           
                        
                      where 
                        
                           G
                        
                      is the identity matrix of size 
                        m
                        −
                        β
                        −
                        α
                        −
                        1
                     .

Finally, taking into account that term 
                        
                           
                              
                                 d
                              
                           
                           
                              T
                           
                        
                        
                           
                              
                                 l
                              
                           
                           
                              x
                           
                        
                        +
                        
                           
                              1
                           
                           
                              2
                           
                        
                        
                           
                              
                                 l
                              
                           
                           
                              x
                           
                           
                              T
                           
                        
                        
                           Q
                        
                        
                           
                              
                                 l
                              
                           
                           
                              x
                           
                        
                      is constant, a goal is to find the minimum of function 
                        
                           (4.6)
                           
                              f
                              
                                 (
                                 
                                    
                                       
                                          s
                                       
                                    
                                    
                                       x
                                    
                                    
                                       f
                                    
                                 
                                 )
                              
                              ≔
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       s
                                    
                                 
                                 
                                    x
                                 
                                 
                                    f
                                 
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                s
                                             
                                          
                                          
                                             x
                                          
                                          
                                             f
                                          
                                       
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 Q
                              
                              
                                 
                                    
                                       s
                                    
                                 
                                 
                                    x
                                 
                                 
                                    f
                                 
                              
                              ,
                           
                        
                      subject to the constraints (4.5).

Obviously, if function 
                        f
                      has a minimum point at 
                        
                           
                              
                                 s
                              
                           
                           
                              x
                           
                           
                              f
                           
                        
                     , subject to the constraints (4.5), then we can minimize function 
                        
                           
                              E
                           
                           
                              x
                           
                           
                              2
                           
                        
                     , subject to the constraints (3.2) and (3.3), by setting 
                        
                           
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    x
                                 
                              
                              ≔
                              
                                 
                                    
                                       [
                                       
                                          
                                             r
                                          
                                          
                                             0
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             α
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         α
                                                         +
                                                         1
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         m
                                                         −
                                                         β
                                                         −
                                                         1
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                                ︸
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                
                                                
                                                   x
                                                
                                                
                                                   f
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             m
                                             −
                                             β
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             m
                                          
                                          
                                             x
                                          
                                       
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              
                                 r
                              
                           
                           
                              x
                           
                           
                              f
                           
                        
                        ≡
                        
                           
                              
                                 [
                                 
                                    
                                       r
                                    
                                    
                                       α
                                       +
                                       1
                                    
                                    
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       α
                                       +
                                       2
                                    
                                    
                                       x
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       m
                                       −
                                       β
                                       −
                                       1
                                    
                                    
                                       x
                                    
                                 
                                 ]
                              
                           
                           
                              T
                           
                        
                        ≔
                        
                           
                              
                                 s
                              
                           
                           
                              x
                           
                           
                              f
                           
                        
                        +
                        
                           
                              
                                 l
                              
                           
                           
                              x
                           
                        
                      (see (3.4), (3.5)).

It is well known, that if matrix 
                        
                           Q
                        
                      is positive semi-definite and feasible set (4.2) is bounded, then the quadratic programming problem has a solution (see, e.g.,  [12, Section 2.3]). 
                        Theorem 4.1
                        
                           Matrix 
                           
                              
                                 Q
                              
                            
                           given by   (4.4)   is positive semi-definite.
                        


                     
                        Proof
                        Let 
                              
                                 x
                              
                              ≔
                              
                                 
                                    
                                       [
                                       
                                          
                                             x
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             m
                                             −
                                             β
                                             −
                                             α
                                             −
                                             2
                                          
                                       
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                            be any non-zero vector in 
                              
                                 
                                    R
                                 
                                 
                                    m
                                    −
                                    β
                                    −
                                    α
                                    −
                                    1
                                 
                              
                           . Notice that 
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          T
                                       
                                    
                                    
                                       Q
                                    
                                    
                                       x
                                    
                                    =
                                    2
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          α
                                          +
                                          1
                                       
                                       
                                          m
                                          −
                                          β
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          α
                                          +
                                          1
                                       
                                       
                                          m
                                          −
                                          β
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          −
                                          α
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          j
                                          −
                                          α
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          0
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    =
                                    2
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          0
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   α
                                                   +
                                                   1
                                                
                                                
                                                   m
                                                   −
                                                   β
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   i
                                                
                                                
                                                   m
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                   −
                                                   α
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ≥
                                    0
                                    ,
                                 
                              
                            which completes the proof.□


                     
                        Corollary 4.2
                        
                           Objective function related to   
                              Problem  3.1   is convex, therefore, the problem has a solution.
                        

Problem of minimizing function (4.6), subject to the constraints (4.5), can be solved using, e.g., Wolfe’s method  [13], which is a simplex-type method for the quadratic programming. The disadvantage of this method is that it has exponential worst-case complexity. In general, however, it works relatively fast, particularly for small-sized problems. Furthermore, there are algorithms solving quadratic programming problems in polynomial time (see  [14,15]), but in the context of degree reduction problem, their significance is only theoretical.

In this section, we solve Problem 3.1 using BVLS algorithm  [16]. This method seems to be more interesting from a practical point of view than the previously mentioned approach.

BVLS algorithm, which is a generalization of iterative NNLS algorithm (non-negative least-squares)   [17], solves so-called  bvls problem (bounded-variable least-squares), written in the following form: 
                        
                           (5.1)
                           
                              
                                 
                                    min
                                 
                                 
                                    
                                       v
                                    
                                    ≤
                                    
                                       x
                                    
                                    ≤
                                    
                                       w
                                    
                                 
                              
                              
                                 ‖
                                 
                                    A
                                 
                                 
                                    x
                                 
                                 −
                                 
                                    b
                                 
                                 ‖
                              
                              ,
                           
                        
                      where 
                        
                           A
                        
                        ∈
                        
                           
                              R
                           
                           
                              j
                              ×
                              i
                           
                        
                        ,
                        
                           x
                        
                        ,
                        
                           v
                        
                        ,
                        
                           w
                        
                        ∈
                        
                           
                              R
                           
                           
                              i
                           
                        
                        ,
                        
                           b
                        
                        ∈
                        
                           
                              R
                           
                           
                              j
                           
                        
                     . Strategy of the algorithm is to find so-called  active set for the optimal solution. We call a constraint active, if it forces boundary value of a variable. Solution improves in each iteration of the algorithm, until the optimal one is found, which happens in the finite number of steps (cf. [16, Section 2]).

In our case, the adjustment of Problem 3.1 to the form (5.1) is simple. We assume that 
                        
                           v
                        
                        ≔
                        
                           
                              
                                 l
                              
                           
                           
                              x
                           
                        
                        ,
                        
                           w
                        
                        ≔
                        
                           
                              
                                 u
                              
                           
                           
                              x
                           
                        
                        ,
                        
                           x
                        
                        ≔
                        
                           
                              
                                 r
                              
                           
                           
                              x
                           
                           
                              f
                           
                        
                     , and 
                        
                           A
                        
                        ≔
                        
                           [
                           
                              
                                 A
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           ]
                        
                        ∈
                        
                           
                              R
                           
                           
                              
                                 (
                                 N
                                 +
                                 1
                                 )
                              
                              ×
                              
                                 (
                                 m
                                 −
                                 β
                                 −
                                 α
                                 −
                                 1
                                 )
                              
                           
                        
                        ,
                        
                           b
                        
                        ≔
                        
                           [
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                           ]
                        
                        ∈
                        
                           
                              R
                           
                           
                              N
                              +
                              1
                           
                        
                     , where 
                        
                           
                              
                                 
                                    
                                       A
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ≔
                                 
                                    
                                       B
                                    
                                    
                                       j
                                       +
                                       α
                                    
                                    
                                       m
                                    
                                 
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 
                                 
                                    (
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    N
                                    +
                                    1
                                    ;
                                    
                                    j
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    m
                                    −
                                    β
                                    −
                                    α
                                    −
                                    1
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 ≔
                                 
                                    
                                       
                                          b
                                       
                                    
                                    
                                       n
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       x
                                    
                                 
                                 −
                                 
                                    
                                       
                                          b
                                       
                                    
                                    
                                       m
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                    
                                    
                                       c
                                    
                                 
                                 
                                    
                                       
                                          r
                                       
                                    
                                    
                                       x
                                    
                                    
                                       c
                                    
                                 
                                 
                                 
                                    (
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    N
                                    +
                                    1
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

We will now describe, step by step, how to solve Problem 3.1 using BVLS algorithm. Note that a more detailed description of the original algorithm, including all necessary formulas, is given in  [16].


                     Step 1. Let us assume that in each iteration of the algorithm, vector 
                        
                           x
                        
                      contains current values of all variables, set 
                        F
                      contains indices of variables satisfying strict version of inequalities (3.3), whereas sets 
                        L
                      and 
                        U
                      contain indices of variables which have reached minimum and maximum permissible value, respectively (cf. (3.3)). At the beginning, we set 
                        
                           
                              L
                              ∪
                              U
                              ≔
                              0̸
                              ,
                              
                              F
                              ≔
                              
                                 {
                                 α
                                 +
                                 1
                                 ,
                                 α
                                 +
                                 2
                                 ,
                                 …
                                 ,
                                 m
                                 −
                                 β
                                 −
                                 1
                                 }
                              
                              ,
                              
                              
                                 x
                              
                              ≔
                              
                                 
                                    
                                       
                                          
                                             l
                                          
                                       
                                       
                                          x
                                       
                                    
                                    +
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          x
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                           
                        
                      and with such assumptions, in the first iteration, we omit the next step of the original algorithm and go to Step 3.


                     Step 2. We omit this step in the first iteration of the algorithm. We define a function 
                        h
                        
                           (
                           
                              x
                           
                           )
                        
                        ≔
                        
                           
                              1
                           
                           
                              2
                           
                        
                        
                           
                              
                                 ‖
                                 
                                    A
                                 
                                 
                                    x
                                 
                                 −
                                 
                                    b
                                 
                                 ‖
                              
                           
                           
                              2
                           
                        
                     , and a vector 
                        
                           g
                        
                        ≡
                        
                           
                              
                                 [
                                 
                                    
                                       g
                                    
                                    
                                       α
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       α
                                       +
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       m
                                       −
                                       β
                                       −
                                       1
                                    
                                 
                                 ]
                              
                           
                           
                              T
                           
                        
                        ≔
                        −
                        ∇
                        h
                        
                           (
                           
                              x
                           
                           )
                        
                        ≡
                        
                           
                              
                                 A
                              
                           
                           
                              T
                           
                        
                        
                           (
                           
                              b
                           
                           −
                           
                              A
                           
                           
                              x
                           
                           )
                        
                     . The algorithm selects a variable from set 
                        L
                        ∪
                        U
                     . The chosen variable is the one that violates following Karush–Kuhn–Tucker (KKT) optimality conditions for the bvls problem:
                        
                           (5.2)
                           
                              
                                 
                                    g
                                 
                                 
                                    i
                                 
                              
                              ≤
                              0
                              
                              
                                 (
                                 i
                                 ∈
                                 L
                                 )
                              
                              ,
                              
                              
                                 
                                    g
                                 
                                 
                                    j
                                 
                              
                              ≥
                              0
                              
                              
                                 (
                                 j
                                 ∈
                                 U
                                 )
                              
                              ,
                           
                        
                      the most in terms of absolute value (for details, see  [16, Section 2, pt. 4]). Next, the index of selected variable is transferred to set 
                        F
                     . If none of the variables violate the above conditions, then 
                        
                           x
                        
                      is the optimal solution of the bvls problem, and the algorithm stops.


                     Step 3. Next, we solve a subproblem, i.e., we find the optimal values of variables whose indices are in set 
                        F
                     , subject to the fixed values of variables whose indices are in set 
                        L
                        ∪
                        U
                     . More precisely, the subproblem is to minimize function 
                        
                           
                              E
                           
                           
                              x
                           
                           
                              2
                           
                        
                     , subject to the constraints (3.2) and conditions 
                        
                           (5.3)
                           
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                                 
                                    x
                                 
                              
                              =
                              
                                 
                                    l
                                 
                                 
                                    x
                                 
                              
                              
                              
                                 (
                                 i
                                 ∈
                                 L
                                 )
                              
                              ,
                              
                              
                                 
                                    r
                                 
                                 
                                    j
                                 
                                 
                                    x
                                 
                              
                              =
                              
                                 
                                    u
                                 
                                 
                                    x
                                 
                              
                              
                              
                                 (
                                 j
                                 ∈
                                 U
                                 )
                              
                           
                        
                      (cf. (3.3)). Notice that we ignore constraints (3.3). Taking into account the arrangements from Step 1, we observe that in the first iteration of the algorithm, subproblem is equivalent to the traditional degree reduction problem (see Remark 3.2) in the case of 
                        z
                        =
                        x
                      (see Remark 3.3). In the next iterations, we are dealing with degree reduction problem, subject to the constraints (3.2) and (5.3). Formula for the solution of the subproblem is given in the Appendix.


                     Step 4. If the obtained values of all variables, whose indices are in set 
                        F
                     , satisfy strict version of inequalities (3.3), then one should assign them to 
                        
                           x
                        
                     , and go to Step 2 to check the optimality of such result. Otherwise, we have to repair the solution (see Step 5).


                     Step 5. Now, we repair the solution, i.e., we modify values of variables whose indices are in set 
                        F
                      (for details, see  [16, Section 2, pts. 8–10]). The repair guarantees that (i) a variable, which was the farthest from fulfilling the constraints, now has the boundary value; (ii) other variables, whose indices are in set 
                        F
                     , satisfy the constraints (3.3). As a result of the repair, an index of at least one variable is transferred from set 
                        F
                      to set 
                        L
                      or 
                        U
                     . After determining the elements of sets 
                        F
                        ,
                        L
                      and 
                        U
                     , one should assign new values to 
                        
                           x
                        
                     , and go back to Step 3, where the subproblem is solved again. 
                        Remark 5.1
                        It is worth noting, that an approximate solution, sufficiently accurate or received after a specified number of iterations, often only slightly differs in quality from the optimal one. Therefore, a reasonable stopping criterion, alternative to the optimality conditions (5.2), may allow earlier termination of the algorithm and result in a solution close enough to the optimum.

Finally, we give a block diagram of BVLS algorithm, including the usage of alternative stopping criterion (see Fig. 3
                     ).

This section provides several examples of application of the discussed methods.

Results of the experiments have been obtained on a computer with Intel Core i5-3337U 1.8 GHz processor and 8 GB of RAM, using 8-digit arithmetic.

Maple™13 worksheet containing implementation of the algorithms and tests is available on the website http://www.ii.uni.wroc.pl/~pgo/papers.html. Text files containing control points of the designed Bézier curves are also available. Optimal solution of the traditional degree reduction problem (see Remark 3.2) is obtained by solving a system of normal equations, using Maple™ fsolve procedure. Optimal solution of Problem 3.1 is determined by Wolfe’s method and the same result is computed by BVLS algorithm. Approximate solution of Problem 3.1 is obtained by BVLS algorithm (see Remark 5.1).

For each example, we give the least squares error 
                        E
                      (see (3.1)), and the maximum error 
                        
                           
                              
                                 
                                    E
                                 
                                 
                                    ∞
                                 
                              
                              ≔
                              
                                 
                                    max
                                 
                                 
                                    t
                                    ∈
                                    
                                       
                                          D
                                       
                                       
                                          M
                                       
                                    
                                 
                              
                              
                                 ‖
                                 
                                    
                                       P
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 −
                                 
                                    
                                       R
                                    
                                    
                                       m
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ‖
                              
                              ≈
                              
                                 
                                    max
                                 
                                 
                                    0
                                    ≤
                                    t
                                    ≤
                                    1
                                 
                              
                              
                                 ‖
                                 
                                    
                                       P
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 −
                                 
                                    
                                       R
                                    
                                    
                                       m
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ‖
                              
                              ,
                           
                        
                      where 
                        
                           
                              D
                           
                           
                              M
                           
                        
                        ≔
                        
                           {
                           0
                           ,
                           1
                           /
                           M
                           ,
                           2
                           /
                           M
                           ,
                           …
                           ,
                           1
                           }
                        
                      with 
                        M
                        ≔
                        500
                     . In each case, we use the sequence 
                        
                           
                              
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 }
                              
                           
                           
                              k
                              =
                              0
                           
                           
                              N
                           
                        
                      of equally spaced points for the least squares distance (1.1), i.e., 
                        
                           
                              t
                           
                           
                              k
                           
                        
                        ≔
                        k
                        /
                        N
                        
                        
                           (
                           k
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           N
                           )
                        
                     . 
                        Example 6.1
                        Let us apply the algorithms to degree thirteen Bézier curve “Double loop”, which is given in  [2, Appendix B]. For this curve, we set the rectangular area in the following way: 
                              
                                 (6.1)
                                 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             x
                                          
                                       
                                       ≔
                                       
                                          
                                             min
                                          
                                          
                                             0
                                             ≤
                                             k
                                             ≤
                                             n
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             k
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       13
                                       =
                                       −
                                       13
                                       ,
                                       
                                       
                                          
                                             u
                                          
                                          
                                             x
                                          
                                       
                                       ≔
                                       
                                          
                                             max
                                          
                                          
                                             0
                                             ≤
                                             k
                                             ≤
                                             n
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             k
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       30
                                       =
                                       101
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             y
                                          
                                       
                                       ≔
                                       
                                          
                                             min
                                          
                                          
                                             0
                                             ≤
                                             k
                                             ≤
                                             n
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             k
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       20
                                       =
                                       −
                                       20
                                       ,
                                       
                                       
                                          
                                             u
                                          
                                          
                                             y
                                          
                                       
                                       ≔
                                       
                                          
                                             max
                                          
                                          
                                             0
                                             ≤
                                             k
                                             ≤
                                             n
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             k
                                          
                                          
                                             y
                                          
                                       
                                       +
                                       20
                                       =
                                       74
                                       .
                                    
                                 
                              
                           
                        


                           Fig. 4
                           
                           (a)–(c) illustrates the results of degree reduction, i.e., the obtained Bézier curves of degree nine. Clearly, solution of the traditional problem is very precise (see Fig. 4(a)). However, it has the defect described in Section  2 (see Fig. 4(b)), whereas solution of Problem 3.1 is much more satisfying in this regard (see Fig. 4(c)). Obviously, because of the additional restrictions, approximation error is inevitably larger than for the traditional approach.


                     
                        Example 6.2
                        Let us consider the problem of degree reduction of Bézier curves, which are joined to obtain eight-segment composite Bézier curve “Flamingo” (see Fig. 5
                           (a)). The algorithms were applied independently to every segment of the composite Bézier curve. Constraints (3.3) were chosen so that the resulting control points are placed in the rectangular areas, bounded by the outermost control points of the original curves, i.e.,  
                              
                                 (6.2)
                                 
                                    
                                       
                                          l
                                       
                                       
                                          z
                                       
                                    
                                    ≔
                                    
                                       
                                          min
                                       
                                       
                                          0
                                          ≤
                                          k
                                          ≤
                                          n
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          k
                                       
                                       
                                          z
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          u
                                       
                                       
                                          z
                                       
                                    
                                    ≔
                                    
                                       
                                          max
                                       
                                       
                                          0
                                          ≤
                                          k
                                          ≤
                                          n
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          k
                                       
                                       
                                          z
                                       
                                    
                                    
                                    
                                       (
                                       z
                                       =
                                       x
                                       ,
                                       y
                                       )
                                    
                                    .
                                 
                              
                            Results of the experiments are given in Table 1, which consists of the following columns: 
                              
                                 1.
                                 parameters—degree 
                                       n
                                     of the original curve, degree 
                                       m
                                     of the obtained curve, number 
                                       N
                                     of points for the least squares distance (1.1), and orders 
                                       α
                                       ,
                                       β
                                     of the parametric continuity at 
                                       t
                                       =
                                       0
                                       ,
                                       1
                                    , respectively;

values of errors 
                                       E
                                     and 
                                       
                                          
                                             E
                                          
                                          
                                             ∞
                                          
                                       
                                     in the cases of: 
                                       
                                          (i)
                                          optimal solution of traditional degree reduction problem,

optimal solution of Problem 3.1,

approximate solution of Problem 3.1;

pairs of numbers 
                                       
                                          (
                                          
                                             
                                                I
                                             
                                             
                                                x
                                             
                                          
                                          ,
                                          
                                             
                                                I
                                             
                                             
                                                y
                                             
                                          
                                          )
                                       
                                     of iterations, required for BVLS algorithm to find optimal solution and approximate one, running separately for the 
                                       x
                                       ,
                                       y
                                     coordinates (see Remark 3.3).


                     
                        Remark 6.3
                        Now, let us discuss the issue of setting the rectangular area (see (3.3)). A good way to start is to choose (6.2), which means that the resulting control points will be placed in the rectangular area, bounded by the outermost control points of the original curve. Usually, this simple idea works quite well (see Example 6.2). In some cases we can even reduce the size of the rectangle, as in Example 2.1, where we set 
                              
                                 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             x
                                          
                                       
                                       ≔
                                       
                                          
                                             min
                                          
                                          
                                             0
                                             ≤
                                             k
                                             ≤
                                             n
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             k
                                          
                                          
                                             x
                                          
                                       
                                       =
                                       −
                                       28
                                       ,
                                       
                                       
                                          
                                             u
                                          
                                          
                                             x
                                          
                                       
                                       ≔
                                       
                                          
                                             max
                                          
                                          
                                             0
                                             ≤
                                             k
                                             ≤
                                             n
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             k
                                          
                                          
                                             x
                                          
                                       
                                       =
                                       196
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             y
                                          
                                       
                                       ≔
                                       
                                          
                                             min
                                          
                                          
                                             0
                                             ≤
                                             k
                                             ≤
                                             n
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             k
                                          
                                          
                                             y
                                          
                                       
                                       =
                                       −
                                       15
                                       ,
                                       
                                       
                                          
                                             u
                                          
                                          
                                             y
                                          
                                       
                                       ≔
                                       
                                          
                                             max
                                          
                                          
                                             0
                                             ≤
                                             k
                                             ≤
                                             n
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             k
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       65
                                       =
                                       135
                                       ,
                                    
                                 
                              
                            and the result is still good enough. However, Example 6.1 shows that sometimes we should expand the area to get satisfying results (see (6.1)). The above-described method of setting the rectangular area is only a suggestion. Choice of restrictions (3.3) depends on the considered example. In general, this is a difficult problem to solve. The author intends to study it in the future.

@&#CONCLUSIONS AND FUTURE WORK@&#

In this paper, we introduce a novel approach to the problem of degree reduction of Bézier curves with constraints. We impose the restrictions of control points area to get degree reduced curves with more intuitive location of control points. The resulting curves are more suitable for further modification, therefore, the algorithms are more practical. In addition, one can use the convex hull property of such curves to solve efficiently some important problems. The cost of determining an optimal solution, satisfying the additional constraints, is obviously larger than for the traditional degree reduction problem. However, in the case of BVLS algorithm, one can reduce the cost by requiring less accuracy. Approximate solution, obtained by choosing reasonable stopping criterion, often only slightly differs in quality from the optimal one. Since BVLS algorithm is more adjusted to the considered problem, it seems to be a better choice than Wolfe’s method, which is a tool that solves also more general problems. In addition, it allows to determine the solution by solving simple subproblems. Therefore, further research can focus on finding efficient methods of solving the subproblem.

Observe that in the case of degree reduction of three dimensional Bézier curves, Remark 3.3 can be generalized. As a result, degree reduction of such curves can be done in a componentwise way. Therefore, the methods described in this paper are sufficient to solve such problem and can be easily applied.

In the near future, the author intends to study Problem 3.1 with geometric continuity constraints instead of the parametric continuity conditions. Such approach should improve the quality of results.

@&#ACKNOWLEDGMENTS@&#

The author would like to thank P. Woźny and S. Lewanowicz from the University of Wrocław for their valuable comments and suggestions concerning this research.

In Section  5, we describe how to solve Problem 3.1 using BVLS algorithm. Let us recall that the subproblem, which is an essential part of the algorithm (see Step 3), is to minimize function 
                        
                           
                              E
                           
                           
                              x
                           
                           
                              2
                           
                        
                     , subject to the constraints (3.2) and (5.3). Now, let us solve the subproblem.

First, we define sets 
                        C
                        ≔
                        
                           {
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           α
                           ,
                           m
                           −
                           β
                           ,
                           m
                           −
                           β
                           +
                           1
                           ,
                           …
                           ,
                           m
                           }
                        
                     , 
                        
                           
                              C
                           
                           ¯
                        
                        ≔
                        
                           {
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           m
                           }
                        
                        ∖
                        C
                        ,
                        D
                        ≔
                        
                           {
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           n
                           }
                        
                        ,
                        K
                        ≔
                        L
                        ∪
                        U
                        ∪
                        C
                     ; and matrix 
                        
                           
                              
                                 Q
                              
                           
                           
                              n
                              ,
                              m
                           
                        
                        ≔
                        
                           [
                           
                              
                                 Q
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 n
                                 ,
                                 m
                              
                           
                           ]
                        
                        ∈
                        
                           
                              R
                           
                           
                              
                                 (
                                 n
                                 +
                                 1
                                 )
                              
                              ×
                              
                                 (
                                 m
                                 +
                                 1
                                 )
                              
                           
                        
                     , where 
                        
                           
                              
                                 
                                    Q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                              
                              ≔
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    0
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                    −
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              
                                 
                                    B
                                 
                                 
                                    j
                                    −
                                    1
                                 
                                 
                                    m
                                 
                              
                              
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              
                              
                                 (
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 +
                                 1
                                 ;
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 m
                                 +
                                 1
                                 )
                              
                              .
                           
                        
                      Further in this section, we use the notation of (1.2) to denote the matrices formed by specified rows and columns. Analogous notation is used to define necessary vectors.

Now, we write 
                        
                           (A.1)
                           
                              
                                 
                                    E
                                 
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          r
                                       
                                    
                                    
                                       x
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    0
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             n
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             m
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             x
                                          
                                       
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    0
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             n
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             m
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             F
                                          
                                       
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             x
                                          
                                          
                                             F
                                          
                                       
                                       −
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             m
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             K
                                          
                                       
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             x
                                          
                                          
                                             K
                                          
                                       
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    0
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             m
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             F
                                          
                                       
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             x
                                          
                                          
                                             F
                                          
                                       
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              −
                              2
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    0
                                 
                                 
                                    N
                                 
                              
                              
                                 (
                                 
                                    (
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          n
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          x
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          m
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          F
                                       
                                    
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          x
                                       
                                       
                                          F
                                       
                                    
                                    )
                                 
                                 −
                                 
                                    (
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          m
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          K
                                       
                                    
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          x
                                       
                                       
                                          K
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          m
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          F
                                       
                                    
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          x
                                       
                                       
                                          F
                                       
                                    
                                    )
                                 
                                 )
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    0
                                 
                                 
                                    N
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   b
                                                
                                             
                                             
                                                n
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                x
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   b
                                                
                                             
                                             
                                                m
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                K
                                             
                                          
                                          
                                             
                                                
                                                   r
                                                
                                             
                                             
                                                x
                                             
                                             
                                                K
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 2
                                 
                                    (
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          n
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          x
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          m
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          K
                                       
                                    
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          x
                                       
                                       
                                          K
                                       
                                    
                                    )
                                 
                                 )
                              
                              .
                           
                        
                      Next, we omit the constant term (A.1), and solve the subproblem by minimizing 
                        
                           
                              ε
                              
                                 (
                                 
                                    
                                       
                                          r
                                       
                                    
                                    
                                       x
                                    
                                    
                                       F
                                    
                                 
                                 )
                              
                              ≔
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             x
                                          
                                          
                                             F
                                          
                                       
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       Q
                                    
                                 
                                 
                                    m
                                    ,
                                    m
                                 
                                 
                                    F
                                    ,
                                    F
                                 
                              
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    x
                                 
                                 
                                    F
                                 
                              
                              −
                              2
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    x
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       Q
                                    
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                                 
                                    D
                                    ,
                                    F
                                 
                              
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    x
                                 
                                 
                                    F
                                 
                              
                              +
                              2
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             x
                                          
                                          
                                             K
                                          
                                       
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       Q
                                    
                                 
                                 
                                    m
                                    ,
                                    m
                                 
                                 
                                    K
                                    ,
                                    F
                                 
                              
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    x
                                 
                                 
                                    F
                                 
                              
                              .
                           
                        
                      To find the minimum of function 
                        ε
                     , it is sufficient to solve the following system of linear equations: 
                        
                           
                              
                                 0
                              
                              =
                              
                                 
                                    ∂
                                    ε
                                    
                                       (
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             x
                                          
                                          
                                             F
                                          
                                       
                                       )
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          x
                                       
                                       
                                          F
                                       
                                    
                                 
                              
                              .
                           
                        
                      After calculating the partial derivatives, we obtain system 
                        
                           (A.2)
                           
                              
                                 
                                    
                                       Q
                                    
                                 
                                 
                                    m
                                    ,
                                    m
                                 
                                 
                                    F
                                    ,
                                    F
                                 
                              
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    x
                                 
                                 
                                    F
                                 
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                Q
                                             
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                          
                                             D
                                             ,
                                             F
                                          
                                       
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    x
                                 
                              
                              −
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                Q
                                             
                                          
                                          
                                             m
                                             ,
                                             m
                                          
                                          
                                             K
                                             ,
                                             F
                                          
                                       
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    x
                                 
                                 
                                    K
                                 
                              
                              ,
                           
                        
                      and the solution is given by 
                        
                           (A.3)
                           
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    x
                                 
                                 
                                    F
                                 
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                Q
                                             
                                          
                                          
                                             m
                                             ,
                                             m
                                          
                                          
                                             F
                                             ,
                                             F
                                          
                                       
                                       )
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   Q
                                                
                                             
                                             
                                                n
                                                ,
                                                m
                                             
                                             
                                                D
                                                ,
                                                F
                                             
                                          
                                          )
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       x
                                    
                                 
                                 −
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   Q
                                                
                                             
                                             
                                                m
                                                ,
                                                m
                                             
                                             
                                                K
                                                ,
                                                F
                                             
                                          
                                          )
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          r
                                       
                                    
                                    
                                       x
                                    
                                    
                                       K
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  

Therefore, we solve the subproblem by computing vector (A.3), which is the solution of system (A.2). Observe that the complexity of the method is 
                        O
                        
                           (
                           n
                           m
                           N
                           +
                           
                              
                                 m
                              
                              
                                 3
                              
                           
                           )
                        
                     .

Notice that the computation of vector 
                        
                           
                              
                                 r
                              
                           
                           
                              
                                 x
                              
                           
                           
                              F
                           
                        
                     , by the formula (A.3), requires matrix inversion. However, this can be avoided by solving the system (A.2) using, e.g.,  LUP decomposition, which has better numerical properties. In addition, before the first iteration of BVLS algorithm, it is recommended to determine the following matrix and vector: 
                        
                           
                              
                                 
                                    
                                       Q
                                    
                                 
                                 
                                    m
                                    ,
                                    m
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                Q
                                             
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                          
                                             D
                                             ,
                                             
                                                
                                                   C
                                                
                                                ¯
                                             
                                          
                                       
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    x
                                 
                              
                              ,
                           
                        
                      from which–by selecting the appropriate rows or columns–it is possible to obtain matrices and vectors 
                        
                           
                              
                                 
                                    
                                       Q
                                    
                                 
                                 
                                    m
                                    ,
                                    m
                                 
                                 
                                    F
                                    ,
                                    F
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       Q
                                    
                                 
                                 
                                    m
                                    ,
                                    m
                                 
                                 
                                    K
                                    ,
                                    F
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                Q
                                             
                                          
                                          
                                             n
                                             ,
                                             m
                                          
                                          
                                             D
                                             ,
                                             F
                                          
                                       
                                       )
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    x
                                 
                              
                              ,
                           
                        
                      required for the next iterations, without repeating some redundant calculations.

@&#REFERENCES@&#

