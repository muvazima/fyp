@&#MAIN-TITLE@&#Support image set machine: Jointly learning representation and classifier for image set classification

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a joint method for image set representation and classification.


                        
                        
                           
                           Learning parameters of representation and classifier are unified in one objective.


                        
                        
                           
                           Learning of image set representation and classifier are regularized by each other.


                        
                        
                           
                           Our method reduces the time complexity of classifying set image set significantly.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image set classification

Support vector machine

Joint image set representation

Fast iterative shrinkage-thresholding

Supervised learning

@&#ABSTRACT@&#


               
               
                  In this paper, we investigate the problem of classifying an image set of an object, and develop a novel image set representation and classification algorithm. We propose to represent an image set by a joint representation method using both an affine hull of its image samples and a combination of its reference images, and further classify it by a linear classification function from its representation. A unified objective function is formulated to learn both the representation and classifier parameters. Similar to support vector machine, the hinge losses and the squared 
                        
                           
                              
                                 ℓ
                              
                              
                                 2
                              
                           
                        
                      norm of the image set classifier are minimized simultaneously in the objective. Moreover, the differences between the two different representations are also minimized. The objective function is optimized with respect to representation and classifier parameters alternately in an iterative algorithm. The proposed algorithm is named as support image set machine (SupISMac) because it takes advantage of support vector machine formulation to learn an image set classifier. The experiments on two different image set classification benchmark databases show that SupISMac not only outperforms the state-of-the-art image set classification methods, but also reduces the running time of test procedures significantly.
               
            

@&#INTRODUCTION@&#

In traditional computer vision and pattern recognition problems, a data sample is usually a single image. Single image-based pattern recognition have many applications, such as face recognition [1–3], object recognition [4–6] and scene recognition [7,8]. In this type of problems, the recognition is usually conducted from a single image. Although multiple images may be used to learn a boundary between different classes in the training procedure, one single image is usually used to represent a data sample. Recently, with the rapid development of video technology, one data sample can be represent by a set of images in a video sequence, and the problem of learning from image set is proposed [9–11]. In this problem, instead of classifying a single image, we aim to classify a set of images of one object or scene to a known class. The advantage of using image set as a data sample is that the images in an image set contain complementary information, and we can also explorer the temporal relationship among different images in one image set. However, traditional image representation and classification methods cannot be directly applied to image set classification problems, and novel methods are to be developed. In this paper, we investigate the problem of classifying image sets, and propose a novel supervised learning algorithm to this problem.

@&#RELATED WORKS@&#

Some image set classification methods have been developed to solve this problem. The most popular ones are listed as follows.
                           
                              •
                              Kim et al. [12] proposed a linear discriminant function to compare a pair of image sets, by maximizing the canonical correlations of within-class sets, and minimizing the canonical correlations of between-class sets.

Wang et al. [13] proposed to formulate the problem of comparing a pair of image sets as the computation of manifold–manifold distance (MMD). Each image set is represented as a nonlinear manifold which is expressed by a collection of local linear models, and the dissimilarity between a pair of images sets is measured by the distance between their nonlinear manifolds.

Wang and Chen [14] further proposed to extend MMD to manifold discriminant analysis (MDA) for image set classification. MDA also represents an image set as a manifold, and it seeks to learn a embedding space so that the manifold margin can be maximized, i.e., different classes can be separated and local data compactness within each manifold can be enhanced.

Cevikalp and Triggs [15] proposed to represent each image set as a convex models in an affine or convex hull spanned by its image samples (AHISD), and compare a pair of image sets by measuring the geometric distance between their convex models.

Hu et al. [16] proposed a joint representation method for an image set using both image samples of the set and their affine hull model, compared a pair of image sets by calculating the between-set distance, and introduced the sparse approximated nearest point (SANP) algorithm.

Besides these methods mentioned, some other works focused on image classification based on data mining can be used as other alternatives [17–21].

All these methods are based on nearest neighbor classification methods. They proposed different image set representation and image set pair comparison methods based on various distance functions, however, the classification procedures are all to search the nearest neighbors of a test image from a given training set of image sets, and then assign it to the class of the nearest neighbor. The disadvantages of this strategy are as follows:
                           
                              1.
                              The nearest neighbor classifier is simple, but it has been shown to be inferior to many other classifiers, such as support vector machine (SVM) [22–24]. These pair-wise image set comparison-based methods cannot take advantage of the more effective classification methods. However, most effective classification methods other than nearest neighbor classification cannot be used directly to image set, such as SVM.

The pair-wise comparison based method need to compare a given test image set against to all the image sets in the training set. When the size of the training set is large, this procedure is time consuming.

In this paper, we propose a novel image set classification method to solve the problems mentioned above. Instead of using the nearest neighbor classifier which relies on the training samples, we propose to learn a linear function to predict the class of a given image set. Inspired by Hu et al.’s work [16], we map an image set to a new representation using the joint representation method based on both models of affine hull of the samples of image set and combination of reference images. Then we apply a linear function to predict its class label vector from its new representation. To learn both the joint representation parameters and the classifier parameter, we build a unified objective function by considering both the representation and classification problem simultaneously. The objective function is composed of differences of the two presentation models of training image sets, the hinge loss-based classification measures, and the squared 
                           
                              
                                 
                                    ℓ
                                 
                                 
                                    2
                                 
                              
                           
                         norm-based classifier parameter regularization. We use an alternate optimization strategy to learn the representation and classification parameters jointly, and developed an iterative algorithm based on the optimization results. The advantages of the proposed method are of three folds:
                           
                              1.
                              Instead of comparing a test image set against all the training image sets, we use a classification function trained from the training set to classify the test image directly. The time-complexity of this method is much lower than the transitional nearest neighbor based image set classification methods, especially when the training set is large. Please note this advantage is a common performance of the methods based on supervised classification (except nearest neighbor classification), as well as some of the classification algorithms from Weka [25]. However, most of the methods of Weka [25] requires that each data sample can be represented as a feature vector, thus they cannot be directly applied to image set classification, because each image set data is given as a matrix. In this paper, for the first time, we propose to represent each image set as a feature vector, so that the methods of Weka [25] can be used to classify image set directly. As an example, we explore of usage of SVM for this problem. In this way, this advantage of low time-complexity can also be a singular characteristic of the proposed image set classification method, compared to the other image set classification method based on nearest neighbor classifier.

By using the hinge loss and 
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             2
                                          
                                       
                                    
                                  norm regularization to train the classifier, the learning of classifier has a formula of SVM, and thus it is possible to gain a good classification accuracy as SVM. Compared to nearest neighbor classification, SVM is usually superior.

Compared to SANP which only used the image set data information, while neglected the class label information, the proposed methods modeled the learning of representation and classifier parameters jointly in a unified objective, utilized the class label information to learn discriminative representation parameters.

The rest parts of this paper are organized as follows: in Section 2, we introduce the purposed image set presentation and classification method, in Section 3, the proposed method is compared against state-of-the-art image set classification methods, and in Section 4, the paper is concluded.

@&#PROPOSED METHOD@&#

In this section, we will introduce the joint image set representation and classification method by first formulate the problem and then solve it with an iterative optimization algorithm.

Suppose we have a database of image sets denoted as 
                           
                              
                                 
                                    {
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              =
                              [
                              
                                 
                                    x
                                 
                                 
                                    i
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          in
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              ]
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    d
                                    ×
                                    
                                       
                                          n
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         is the data matrix of the ith image set, where 
                           
                              
                                 
                                    x
                                 
                                 
                                    il
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                           
                         is a d-dimensional visual feature vector of the lth image of the ith image set, and 
                           
                              
                                 
                                    n
                                 
                                 
                                    i
                                 
                              
                           
                         is the number of images in the ith image set. These image sets belong to c classes, and we define a class label vector for the ith image set as 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              =
                              [
                              
                                 
                                    y
                                 
                                 
                                    i
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    y
                                 
                                 
                                    ic
                                 
                              
                              ]
                              ∈
                              
                                 
                                    {
                                    +
                                    1
                                    ,
                                    -
                                    1
                                    }
                                 
                                 
                                    c
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    y
                                 
                                 
                                    ik
                                 
                              
                              =
                              +
                              1
                           
                         if the ith image set belongs to the kth class, and 
                           
                              
                                 
                                    y
                                 
                                 
                                    ik
                                 
                              
                              =
                              -
                              1
                           
                         otherwise. The problem of image set is to learn a predictor to predict the class label vector 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                           
                         of a given image set data matrix 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                           
                        . To this end, we proposed to use two model to represent 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                           
                        , and learn a linear function to predict the class label vector from the representation.
                           
                              •
                              
                                 Image set representation: Inspired by Hu et al. [26]’s work, we use two different models to represent a image set data matrix 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                    
                                 :
                                    
                                       1.
                                       
                                          Affine hull of the samples of image set: The first representation model represents an image set as an affine hull of the image set, which is actually a linear combination of the images in the image set,
                                             
                                                (1)
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               ^
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            l
                                                            =
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         il
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         il
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          where 
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      il
                                                   
                                                
                                             
                                           is the linear combination coefficient of the lth image of the ith image set, and 
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                [
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      i
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      
                                                         
                                                            in
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                ]
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                           is the coefficient vector of the ith image set. We assume that not all the images in the image set play important roles in the representation problem, but only a few critical images. Thus we hope that the combination coefficient vector to be sparse.


                                          Combination of reference images: The second representation model represents an image set as the combination of some reference images extracted from the images. We use the image mean, and some orthonormal bases obtained from the Singular Value Decomposition (SVD) of the centered image set matrix [27–30]. The image mean and the centered data matrix of an image set is calculated as
                                             
                                                (2)
                                                
                                                   
                                                      
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               =
                                                               
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           n
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∑
                                                                     
                                                                     
                                                                        l
                                                                        =
                                                                        1
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              n
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     il
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     c
                                                                  
                                                               
                                                               =
                                                               [
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     i
                                                                     1
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           in
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               ]
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          By performing SVD to 
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      c
                                                   
                                                
                                             
                                           we can obtain m orthonormal bases vectors 
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      im
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      d
                                                   
                                                
                                             
                                          , and organize them as an orthonormal bases matrix 
                                             
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                [
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      im
                                                   
                                                
                                                ]
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      d
                                                      ×
                                                      m
                                                   
                                                
                                             
                                          . Using 
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                           and 
                                             
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                           as references, we can represent 
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                           as the combination of 
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                           and weighted orthonormal basses,
                                             
                                                (3)
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               ∼
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            l
                                                            =
                                                            1
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         il
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         il
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          where 
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      il
                                                   
                                                
                                             
                                           is the combination weight of the lth orthonormal bases, and 
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                [
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      i
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      im
                                                   
                                                
                                                ]
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                           is the orthonormal bases weight vector.

To learn the parameters of the two different models of each image set 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                    
                                 , i.e. 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             i
                                          
                                       
                                    
                                 , we propose to minimize the differences between these two representations, which is measured by the squared 
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             2
                                          
                                       
                                    
                                  norm distance. Moreover, 
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             1
                                          
                                       
                                    
                                  norms of 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                       
                                    
                                  are also minimized to seek its sparsity,
                                    
                                       (4)
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   (
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         |
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     α
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               -
                                                               (
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     U
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     β
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   λ
                                                   ‖
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         ‖
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 where λ is a tradeoff parameter.


                                 Image set classification: To predict the class label vector 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                    
                                  of an image set 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                    
                                 , we use its second representation and design a linear function to perform the prediction.
                                    
                                       (5)
                                       
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          ←
                                          f
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          =
                                          W
                                          (
                                          
                                             
                                                μ
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                β
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                 where 
                                    
                                       (
                                       
                                          
                                             μ
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             U
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             β
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             d
                                          
                                       
                                    
                                  is the representation of the ith image set, and 
                                    
                                       W
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             k
                                             ×
                                             d
                                          
                                       
                                    
                                  is the linear function parameter matrix. To learn W, we propose to minimize the hinge loss [31–34] of the predictor over all training image sets:
                                    
                                       (6)
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   W
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             max
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                   h
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   W
                                                   (
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 where 
                                    
                                       h
                                       ⩾
                                       0
                                    
                                  is a parameter variable of the hinge loss function. By introducing a slack variable for each image set 
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 , regularizing the prediction function parameter matrix W with a squared 
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             2
                                          
                                       
                                    
                                  norm to reduce the complexity of the predictor, and learning the representation parameters simultaneously, (6) is extended to
                                    
                                       (7)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               min
                                                            
                                                            
                                                               W
                                                               ,
                                                               (
                                                               
                                                                  
                                                                     β
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               ,
                                                               ξ
                                                               )
                                                               
                                                                  
                                                                     |
                                                                  
                                                                  
                                                                     i
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     n
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  W
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      s
                                                      .
                                                      t
                                                      .
                                                   
                                                
                                                
                                                   
                                                      
                                                      ∀
                                                      i
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ⩾
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ⩾
                                                      h
                                                      -
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      W
                                                      (
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 where 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                    
                                  is a tradeoff parameter.

The overall image representation and classification problem is obtained by combining (4) and (7),
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      W
                                                      ,
                                                      (
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      ξ
                                                      )
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  W
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 X
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 α
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                           -
                                                                           (
                                                                           
                                                                              
                                                                                 μ
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                           +
                                                                           
                                                                              
                                                                                 U
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 β
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               +
                                                               λ
                                                               ‖
                                                               
                                                                  
                                                                     α
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     ‖
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                
                                             
                                             ⩾
                                             0
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                
                                             
                                             ⩾
                                             h
                                             -
                                             
                                                
                                                   y
                                                
                                                
                                                   i
                                                
                                                
                                                   ⊤
                                                
                                             
                                             W
                                             (
                                             
                                                
                                                   μ
                                                
                                                
                                                   i
                                                
                                             
                                             +
                                             
                                                
                                                   U
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   β
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                           
                         is another tradeoff parameter. In this problem, both the representation parameters 
                           
                              (
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              )
                              
                                 
                                    |
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                           
                         and the classifier parameters W are variables, and they are optimized simultaneously. In this way, the presentation and classification of image set are unified in one single problem.

The Lagrange function of (8) is
                           
                              (9)
                              
                                 L
                                 =
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                C
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                C
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     α
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               -
                                                               (
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     U
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     β
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   λ
                                                   ‖
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         ‖
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             
                                                ∊
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   h
                                                   +
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   W
                                                   (
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                              ⩾
                              0
                           
                         is the Lagrange multiplier of the constrain 
                           
                              
                                 
                                    ξ
                                 
                                 
                                    i
                                 
                              
                              ⩾
                              0
                           
                         and 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    i
                                 
                              
                              ⩾
                              0
                           
                         is the Lagrange multiplier of the constrain 
                           
                              
                                 
                                    ξ
                                 
                                 
                                    i
                                 
                              
                              ⩾
                              h
                              -
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                                 
                                    ⊤
                                 
                              
                              W
                              (
                              
                                 
                                    μ
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        . To optimize (8), the dual form is obtained as
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            ∊
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      W
                                                      ,
                                                      (
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      ξ
                                                      )
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             L
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             :
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                
                                             
                                             ⩾
                                             0
                                             ,
                                             
                                                
                                                   ∊
                                                
                                                
                                                   i
                                                
                                             
                                             ⩾
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        By setting the partial derivative of 
                           
                              L
                           
                         to zero with regard to W and 
                           
                              
                                 
                                    ξ
                                 
                                 
                                    i
                                 
                              
                           
                         respectively, we have
                           
                              (11)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ∂
                                                   L
                                                
                                                
                                                   ∂
                                                   W
                                                
                                             
                                             =
                                             W
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                             
                                                
                                                   ∊
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                
                                                   ⊤
                                                
                                             
                                             =
                                             0
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             ⇒
                                             W
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                             
                                                
                                                   ∊
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                
                                                   ⊤
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ∂
                                                   L
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             -
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   ∊
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             0
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             ⇒
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             -
                                             
                                                
                                                   ∊
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                
                                             
                                             ⩾
                                             0
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             ⇒
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             ⩾
                                             
                                                
                                                   ∊
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        By substituting (11) to (10), we have
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      
                                                         
                                                            ∊
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      -
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               ,
                                                               j
                                                               =
                                                               1
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ∊
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            ∊
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  μ
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  U
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      +
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 X
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 α
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                           -
                                                                           (
                                                                           
                                                                              
                                                                                 μ
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                           +
                                                                           
                                                                              
                                                                                 U
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 β
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               +
                                                               λ
                                                               ‖
                                                               
                                                                  
                                                                     α
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     ‖
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      +
                                                      h
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ∊
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                          
                                       
                                       
                                          
                                             
                                             ∀
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             :
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             ⩾
                                             
                                                
                                                   ∊
                                                
                                                
                                                   i
                                                
                                             
                                             ⩾
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        To solve this problem we adapt an alternate optimization strategy. 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                           
                         and 
                           
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                           
                         and 
                           
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                           
                         are optimized alternately in an iterative algorithm. When one of them is optimized, the other two ones are fixed. In the following, we will discuss how to optimize each of them while the others are fixed.
                           
                              •
                              
                                 Optimizing 
                                 
                                    
                                       
                                          
                                             ∊
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                 : When 
                                    
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             β
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       
                                          
                                             |
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                  are fixed, and only 
                                    
                                       
                                          
                                             ∊
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                  are considered, we can remove the terms in (12) irrelevant to 
                                    
                                       
                                          
                                             ∊
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                 , and have the following problem,
                                    
                                       (13)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               max
                                                            
                                                            
                                                               
                                                                  
                                                                     ∊
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     |
                                                                  
                                                                  
                                                                     i
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     n
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               -
                                                               
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        ∑
                                                                     
                                                                     
                                                                        i
                                                                        ,
                                                                        j
                                                                        =
                                                                        1
                                                                     
                                                                     
                                                                        n
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     ∊
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     ∊
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     ⊤
                                                                  
                                                               
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           μ
                                                                        
                                                                        
                                                                           j
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        
                                                                           U
                                                                        
                                                                        
                                                                           j
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           β
                                                                        
                                                                        
                                                                           j
                                                                        
                                                                     
                                                                     )
                                                                  
                                                                  
                                                                     ⊤
                                                                  
                                                               
                                                               (
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     U
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     β
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               )
                                                               +
                                                               h
                                                               
                                                                  
                                                                     
                                                                        ∑
                                                                     
                                                                     
                                                                        i
                                                                        =
                                                                        1
                                                                     
                                                                     
                                                                        n
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     ∊
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      s
                                                      .
                                                      t
                                                      .
                                                   
                                                
                                                
                                                   
                                                      
                                                      ∀
                                                      i
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      :
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ⩾
                                                      
                                                         
                                                            ∊
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ⩾
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                 This problem is a constrained quadratic programming (QP) problem [35–38], and it can be solved by the active set algorithm. Please note that similar to SVM, the multipliers 
                                    
                                       
                                          
                                             ∊
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                  solved in (13) are sparse, i.e. most of the 
                                    
                                       
                                          
                                             ∊
                                          
                                          
                                             i
                                          
                                       
                                    
                                  are zeros. The nonzero 
                                    
                                       
                                          
                                             ∊
                                          
                                          
                                             i
                                          
                                       
                                    
                                  are corresponding to the image sets supporting the boundary between different classes. Thus we call the proposed method support images set machine (SupISMac), similar to SVM.


                                 Optimizing 
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                 : When we only consider 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                  while fixing 
                                    
                                       
                                          
                                             ∊
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                 , and removing the irrelevant terms, we have the following problem,
                                    
                                       (14)
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         |
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              X
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              α
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        -
                                                                        (
                                                                        
                                                                           
                                                                              μ
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        +
                                                                        
                                                                           
                                                                              U
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              β
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            λ
                                                            ‖
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  ‖
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            g
                                                            (
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            )
                                                            +
                                                            λ
                                                            ‖
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  ‖
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 where 
                                    
                                       g
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   (
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                    
                                  is a smooth function for each image set, and 
                                    
                                       λ
                                       ‖
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             ‖
                                          
                                          
                                             1
                                          
                                       
                                    
                                  is a non-smooth function. To seek an optimal 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                       
                                    
                                  to minimize (14), we use the fast iterative shrinkage-thresholding (FISTA) algorithm with a constant step size [39]. This algorithm is an iterative algorithm, and each iteration is composed of two steps.
                                    
                                       1.
                                       In the tth iteration, we first calculate a search point 
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                           for 
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          ,
                                             
                                                (15)
                                                
                                                   
                                                      
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     η
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               =
                                                               
                                                                  
                                                                     1
                                                                     +
                                                                     
                                                                        
                                                                           1
                                                                           +
                                                                           4
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       η
                                                                                    
                                                                                    
                                                                                       t
                                                                                       -
                                                                                       1
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     ϕ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               =
                                                               
                                                                  
                                                                     α
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     t
                                                                     -
                                                                     1
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     
                                                                        
                                                                           η
                                                                        
                                                                        
                                                                           t
                                                                           -
                                                                           1
                                                                        
                                                                     
                                                                     -
                                                                     1
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           η
                                                                        
                                                                        
                                                                           t
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              α
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              t
                                                                              -
                                                                              1
                                                                           
                                                                        
                                                                        -
                                                                        
                                                                           
                                                                              α
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              t
                                                                              -
                                                                              2
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       

Then using the search point, we calculate the solution 
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                           as follows,
                                             
                                                (16)
                                                
                                                   
                                                      
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     α
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               =
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     L
                                                                  
                                                               
                                                               (
                                                               
                                                                  
                                                                     ϕ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               )
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     L
                                                                  
                                                               
                                                               (
                                                               
                                                                  
                                                                     ϕ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               )
                                                               =
                                                               arg
                                                               
                                                                  
                                                                     min
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           α
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              L
                                                                           
                                                                           
                                                                              2
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          α
                                                                                       
                                                                                       
                                                                                          i
                                                                                       
                                                                                    
                                                                                    -
                                                                                    
                                                                                       
                                                                                          
                                                                                             
                                                                                                
                                                                                                   ϕ
                                                                                                
                                                                                                
                                                                                                   i
                                                                                                
                                                                                                
                                                                                                   t
                                                                                                
                                                                                             
                                                                                             -
                                                                                             
                                                                                                
                                                                                                   1
                                                                                                
                                                                                                
                                                                                                   L
                                                                                                
                                                                                             
                                                                                             ∇
                                                                                             g
                                                                                             (
                                                                                             
                                                                                                
                                                                                                   ϕ
                                                                                                
                                                                                                
                                                                                                   i
                                                                                                
                                                                                                
                                                                                                   t
                                                                                                
                                                                                             
                                                                                             )
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              2
                                                                           
                                                                           
                                                                              2
                                                                           
                                                                        
                                                                        +
                                                                        λ
                                                                        ‖
                                                                        
                                                                           
                                                                              α
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              ‖
                                                                           
                                                                           
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          where 
                                             
                                                ∇
                                                g
                                                (
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                =
                                                2
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                2
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                (
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                +
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          , and L is the step size. This problem can be solved with the following solution:
                                             
                                                (17)
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         
                                                            
                                                               λ
                                                            
                                                            
                                                               L
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ϕ
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  L
                                                               
                                                            
                                                            ∇
                                                            g
                                                            (
                                                            
                                                               
                                                                  ϕ
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          where 
                                             
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      σ
                                                   
                                                
                                                (
                                                α
                                                )
                                                =
                                                (
                                                |
                                                α
                                                |
                                                -
                                                σ
                                                )
                                                ⊗
                                                sgn
                                                (
                                                α
                                                )
                                             
                                           is the shrinkage operator.


                                 Optimizing 
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                 : When 
                                    
                                       
                                          
                                             ∊
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                  are fixed and we only consider 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                 , the problem in (12) is reduced to
                                    
                                       (18)
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         |
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   -
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ,
                                                            j
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∊
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         ∊
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               U
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   +
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              X
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              α
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        -
                                                                        (
                                                                        
                                                                           
                                                                              μ
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        +
                                                                        
                                                                           
                                                                              U
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              β
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 Moreover, we optimize 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                  one by one, i.e., when 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             i
                                          
                                       
                                    
                                  is optimized, 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             i
                                             ≠
                                             ij
                                          
                                       
                                    
                                  are fixed. In this way, we further reduce (18) to
                                    
                                       (19)
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   r
                                                   (
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   =
                                                   -
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            :
                                                            j
                                                            ≠
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∊
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         ∊
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               U
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   -
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         ∊
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     U
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     β
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     α
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               -
                                                               (
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     U
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     β
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 We also use the FISTA algorithm with constant step size [39] to solve this problem. In the tth iteration, we perform the following two steps:
                                    
                                       1.
                                       We first calculate a search point 
                                             
                                                
                                                   
                                                      φ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                           for 
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          ,
                                             
                                                (20)
                                                
                                                   
                                                      
                                                         φ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               η
                                                            
                                                            
                                                               t
                                                               -
                                                               1
                                                            
                                                         
                                                         -
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               η
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  1
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  t
                                                                  -
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          where 
                                             
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                           is calculated the same as in (15).

Then using the search point, we calculate the solution 
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                           as follows,
                                             
                                                (21)
                                                
                                                   
                                                      
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     β
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               =
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     L
                                                                  
                                                               
                                                               (
                                                               
                                                                  
                                                                     φ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               )
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     L
                                                                  
                                                               
                                                               (
                                                               
                                                                  
                                                                     φ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               )
                                                               =
                                                               arg
                                                               
                                                                  
                                                                     min
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           β
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              L
                                                                           
                                                                           
                                                                              2
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       
                                                                                          β
                                                                                       
                                                                                       
                                                                                          i
                                                                                       
                                                                                    
                                                                                    -
                                                                                    
                                                                                       
                                                                                          
                                                                                             
                                                                                                
                                                                                                   φ
                                                                                                
                                                                                                
                                                                                                   i
                                                                                                
                                                                                                
                                                                                                   t
                                                                                                
                                                                                             
                                                                                             -
                                                                                             
                                                                                                
                                                                                                   1
                                                                                                
                                                                                                
                                                                                                   L
                                                                                                
                                                                                             
                                                                                             ∇
                                                                                             r
                                                                                             (
                                                                                             
                                                                                                
                                                                                                   φ
                                                                                                
                                                                                                
                                                                                                   i
                                                                                                
                                                                                                
                                                                                                   t
                                                                                                
                                                                                             
                                                                                             )
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              2
                                                                           
                                                                           
                                                                              2
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          where 
                                             
                                                ∇
                                                r
                                                (
                                                
                                                   
                                                      φ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                =
                                                -
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      :
                                                      j
                                                      ≠
                                                      i
                                                   
                                                
                                                
                                                   
                                                      ∊
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      ∊
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                (
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      j
                                                   
                                                
                                                +
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   
                                                      φ
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                                -
                                                
                                                   
                                                      ∊
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                (
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                +
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      φ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                -
                                                2
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         -
                                                         (
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               U
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               φ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          . This problem can be solved with the following solution:
                                             
                                                (22)
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         φ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         L
                                                      
                                                   
                                                   ∇
                                                   r
                                                   (
                                                   
                                                      
                                                         φ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       

Based on the optimization results, we develop an iterative learning algorithm. The iterative learning algorithm is summarized in Algorithm 1. We can see that the iterations are repeated T times, and in each iteration, the representation and classification parameters are updated alternately.
                           Algorithm 1
                           SupISMac learning algorithm. 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: Training set of image sets 
                                                   
                                                      
                                                         
                                                            {
                                                            (
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            )
                                                            }
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                ;
                                          
                                          
                                             
                                                Input: Tradeoff parameters 
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                 and λ;
                                          
                                          
                                             
                                                Input: Maximum number of iterations, T;
                                          
                                          
                                             Initialize the representation parameters 
                                                   
                                                      (
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                ;
                                          
                                          
                                             
                                                for 
                                                
                                                   
                                                      t
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      T
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                Update the Lagrange multipliers 
                                                   
                                                      
                                                         
                                                            ∊
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                 by fixing 
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                            -
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                 and solving the QP problem in (13);
                                          
                                          
                                             
                                                Update the representation parameters 
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                 as in (17) by fixing 
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                            -
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            ∊
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                ;
                                          
                                          
                                             
                                                Update the representation parameter 
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                 as in (22) by fixing 
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                ;
                                          
                                          
                                             
                                                end for
                                             
                                          
                                          
                                             STATE Calculate W from 
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            ∊
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                 as in (11).
                                          
                                          
                                             
                                                Output: The classifier parameter matrix W.
                                          
                                       
                                    
                                 
                              
                           

To classify a given test image set X, we also represent it with the joint reforestation methods as 
                           
                              X
                              α
                           
                         and 
                           
                              μ
                              +
                              U
                              β
                           
                        , where 
                           
                              μ
                           
                         is the image mean of 
                           
                              X
                              ,
                              
                              U
                           
                         is the orthonormal bases matrix of centered data matrix of X, and 
                           
                              α
                           
                         and 
                           
                              β
                           
                         are the representation parameters. The optimal class label vector of X is obtained by solving the following minimization problem,
                           
                              (23)
                              
                                 
                                    
                                       y
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       
                                          arg
                                          min
                                       
                                       
                                          y
                                          ∈
                                          Y
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   α
                                                   ,
                                                   β
                                                
                                             
                                          
                                          
                                             
                                                
                                                   -
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   W
                                                   (
                                                   μ
                                                   +
                                                   U
                                                   β
                                                   )
                                                   +
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            |
                                                            |
                                                            X
                                                            α
                                                            -
                                                            (
                                                            μ
                                                            +
                                                            U
                                                            β
                                                            )
                                                            |
                                                            
                                                               
                                                                  |
                                                               
                                                               
                                                                  2
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            λ
                                                            |
                                                            |
                                                            α
                                                            |
                                                            
                                                               
                                                                  |
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        This problem is composed of two minimization problems. Given a candidate class label vector, the inner minimization problem is to seek the presentation parameters to minimize both the classification and representation errors. The exterior minimization problem is to find the optimal class label vector from the class label vector space 
                           
                              Y
                           
                        , which contains only c possible vectors. Thus in this case, we only need to compare the test image against c different classes.

@&#EXPERIMENTS@&#

In this section, we evaluate the proposed image classification algorithm and compare it against other methods.

In the experiments, we used two different image set classification databases. One of them is a face image set database, and the other one of them is an object image set database. The details of the two databases are given as follows:
                           
                              1.
                              
                                 YouTube Celebrity face database: The first database used is the YouTube Celebrity face database [40]. This database is collected from YouTube, and it contains 1910 video sequences of 47 celebrities’ faces, most of whom are actors/actresses and politicians. The face regions of frames of each sequence is segmented and collected to construct a image set. Usually each sequence contains hundreds of frames, and the face images in one single sequence are of large variations of pose, illumination, expressions. The face images in a sequence are resized to 
                                    
                                       30
                                       ×
                                       30
                                    
                                 , and we extract a visual feature vector for each of them to construct a data matrix of the sequence. Given a video sequence of face, the problem of image set classification of this database is to recognize which celebrity he/she is.


                                 ETH-80 object database: The second database used is the ETH-80 object database [41]. This database constrains image sets of eight different object classes, which are apples, cars, cows, cups, dogs, horses, pears and tomatoes. Each classes contains ten object image sets, and each image set contains 41 images of different views of one single object. The problem of this database is to classify an image set of object to a known class.

To extract the visual feature vector from each image, we first resize the image, and then vectorize the raw pixels values of the resize the image to from the feature vector.

To conduct the experiment, we used the p-fold cross validation. Given a database of image sets, we randomly split it to p folds, and each fold is used as a test set, while the remaining 
                           
                              p
                              -
                              1
                           
                         folds were combined to construct a training set. We performed the SupISMac learning algorithm to the training set of image sets to learn the a image set classifier, and then used it to classify the image sets in the test set. The tradeoff parameters 
                           
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                           
                         and γ are selected by using a 
                           
                              p
                              -
                              1
                           
                        -fold cross validation using only the training set while neglecting the test set. Please also note that for different folds the selected tradeoff parameters may be different.The classification accuracies of the p-fold cross validations were used as performance measures. The accuracy was calculated as follows:
                           
                              (24)
                              
                                 Accuracy
                                 =
                                 
                                    
                                       Number of correctly classified test image sets
                                    
                                    
                                       Total number of test image sets
                                    
                                 
                              
                           
                        The fold number p of the YouTube Celebrity face database and ETH-80 object database are 10 and 4 respectively.

We first compare the proposed algorithm against the state-of-the-art image classification methods, including SANP, AHISD, MDA, and MMD. The boxplots of the accuracies of the 10-fold cross validation on YouTube Celebrity face database and 4-fold cross validation on ETH-80 object database are shown in Figs. 1 and 2
                           
                            respectively. As we can see from Fig. 1, the proposed SupISMac outperforms the other methods significantly. The median value of SupISMac of the accuracies of 10-fold cross validation on YouTube Celebrity face database is 0.6728, while the median values of other algorithms vary from 0.5262 to 0.6387. Moreover the lower quartile of the boxplot of SupISMac is even higher than most of the upper quartiles of the other algorithms. While in Fig. 2, the median value of SupISMac is 0.9250, and this is the only median values larger than 0.9000 in the five compared methods. These are strong evidences of the superiority of SupISMac over other algorithms on accuracy. This is not surprising since SupISMac is the only method relying on the support image sets to build boundaries among different classes, while all other four methods rely on nearest neighbor classification. Among the four other algorithms, it seems that SANP achieves the best performances. A possible reason is that it uses the effective joint representation method. MMD performs worst in both databases, and AHISD and MDA are comparable to each other.

We also showed some typical image sets to illustrate the classification results of different methods in Fig. 3
                           . It can be seen that both SANP and AHISD algorithms correctly classifies two of the three test image sets given in Fig. 3, while MDA and MMD only correctly classifies one of them. Only SupISMac correctly classifies all of the three test image sets. This is another evidence of the outperforming of the proposed algorithm over the competing methods.

We are also interested in the running time of different algorithms. The average running time of training and test procedures is given in Fig. 4
                           . As we can see from this figure, the test running time of the proposed algorithm SupISMac is shorter than any other algorithms since it only compares a test image set to all the classes, while the other algorithms need to compare it to all the training image sets. It is interesting to note that although both SupISMac and SANP use the same FISTA optimization method to learn the representation parameters, the test running time of SupISMac is much shorter than SANP. The reason is that in the test procedure, SupISMac only calculate the representation parameters of a test image set, while SANP need to calculate representation parameters of all training image sets. We further give some general discussion and comparison of computational complexities of SANP and SupISMac to give more insights to these results. Since there are n image sets in the training set, and SANP compares a test image set to the training set one by one, and each comparison contains an iterative FISTA algorithm of T iterations, the time complexity of SANP is 
                              
                                 O
                                 (
                                 nT
                                 )
                              
                           . SupISMac only compares a test image to c image set classes, and each comparison also contains T iterations of FISTA, the time complexity is 
                              
                                 O
                                 (
                                 cT
                                 )
                              
                           . Usually, 
                              
                                 c
                                 ≪
                                 n
                              
                           , thus it is not surprisingly the running time of SupISMac is much less than SANP. From Fig. 4, we can also see that SANP and AHISD algorithms do not have training time, because both of them do not have training procedure. Training time of MDA is long, while SupISMac and MMD are comparable on training time.

We investigated the sensitivity of the proposed algorithm to the tradeoff parameters 
                              
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                              
                            and λ, and the maximum iteration number T. The accuracies of the algorithm on YouTube Celebrity face database using different values of 
                              
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                              
                            parameter is given in Fig. 5
                           . From this figure, we can see that when the 
                              
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                              
                            parameter value increases from 0.1 to 10, the performances of the proposed SupISMac algorithm are improved. However, when the 
                              
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                              
                            parameter value is larger than 10, the performances are stable. This indicates that 
                              
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                              
                            parameter plays an important role in the SupISMac algorithm, since it is a penalty weight of the hinge loss in the objective. However, when it is large enough, the sensitivity of the proposed algorithm is reduced.

The accuracies of the proposed algorithm using different values of 
                              
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                              
                            parameters are shown in Fig. 6
                           . It seems that SupISMac is more stable over 
                              
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                              
                            than 
                              
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                              
                           . 
                              
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                              
                            is the weight of the representation terms in the objective function. A possible reason is that the classification terms play a more direct roles than the representation terms in the image set classification problems.

The accuracies of SupISMac algorithm against different λ parameter values are given in Fig. 7
                           . It is clear that larger λ can boost the performances of SupISMac. This means that the sparsity of the representation parameter is necessary for the presentation and classification of image set classification. The sensitivity curve of parameter T is given in Fig. 8
                           . From this figure, we can see the accuracies can be improved with larger value of T in general, but the performances seem stable when T is larger than 100. Thus it is reasonable to set 
                              
                                 T
                                 =
                                 100
                              
                            without much loss of accuracies.

In this paper, we proposed a novel image representation and classification algorithm. We proposed to represent an image set by a joint representation method using both the affine hull of the samples of image set and the combination of reference images, and learn a linear class label vector prediction function to classify it from its representation. An important characteristic of this strategy is that it attempts to learn a classifier from the training image sets to classify a test image set, instead of using the training image sets themselves to classify a test image set using nearest neighbor rule. In this way, we can employ different classifier learning methods to train an effective classifier. In this paper, we used the hinge loss and 
                        
                           
                              
                                 ℓ
                              
                              
                                 2
                              
                           
                        
                      norm regularization to learn the classifier parameter, making it has the formulation of SVM. However, it is not limited to SVM, and other single image classifier learning methods are also open to be employed. The dependence between SVM and the proposal lies on the usage of hinge loss and 
                        
                           
                              
                                 ℓ
                              
                              
                                 2
                              
                           
                        
                      norm regularization. Thus if we replace these terms by alternatives, we can switch to other classifiers. For example, if the hinge loss is replaced by logistic loss, we can obtain the logistic regression classifier. The independence between SVM and the proposal lies on that the formulation is open for alternate classification loss functions and regularization. Moreover, due to the usage of classifier, the test procedure can be independent from the training image sets, thus the time consuming comparisons against all training image sets can be avoided. More importantly, the classifier learning and representation parameter learning are unified in one single objective, so that we cannot only learn an effective classifier, but also learn discriminative representation parameters.

We have described the method for representing the test image set, as well as the way for identifying the minimum class set to be used for classifying the test image set in Section 2.3. A basic assumption of this problem is that the class space is known and each test image set belongs to a known class. However, in real-world applications, there may be an unknown class in the test image set, i.e., there is a class which is not identified into the training set. However, the proposed method cannot be applied to this situation. In the future, we will extend the proposed method to open image set classification problem to detect and classify unknown image set class in the test set.

@&#ACKNOWLEDGEMENTS@&#

This project was funded by a open research program of the Tianjin Key Laboratory of Cognitive Computing and Application, Tianjin University, China.

@&#REFERENCES@&#

