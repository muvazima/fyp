@&#MAIN-TITLE@&#Online domain-shift learning and object tracking based on nonlinear dynamic models and particle filters on Riemannian manifolds

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Online domain-shift learning of dynamic object appearances with out-of-plane motions.


                        
                        
                           
                           Bayesian formulation on Riemannian manifolds using nonlinear state space models.


                        
                        
                           
                           Two particle filters, one on manifolds for appearance learning, another for object tracking.


                        
                        
                           
                           Occlusion handling to prevent online learning when objects are likely occluded.


                        
                        
                           
                           Tracking scheme is applied to visual-band videos and thermal infrared videos.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Domain-shift object learning

Manifold appearance learning

Visual object tracking

Infrared object tracking

Riemannian manifolds

Covariance tracking

Object partition

Particle filters

Occlusion handling

Nonlinear dynamic model

@&#ABSTRACT@&#


               
               
                  This paper proposes a novel online domain-shift appearance learning and object tracking scheme on a Riemannian manifold for visual and infrared videos, especially for video scenarios containing large deformable objects with fast out-of-plane pose changes that could be accompanied by partial occlusions. Although Riemannian manifolds and covariance descriptors are promising for visual object tracking, the use of Riemannian mean from a window of observations, spatially insensitive covariance descriptors, fast significant out-of-plane (non-planar) pose changes, and long-term partial occlusions of large-size deformable objects in video limits the performance of such trackers. The proposed method tackles these issues with the following main contributions: (a) Proposing a Bayesian formulation on Riemannian manifolds by using particle filters on the manifold and using appearance particles in each time instant for computing the Riemannian mean, rather than using a window of observations. (b) Proposing a nonlinear dynamic model for online domain-shift learning on the manifold, where the model includes both manifold object appearance and its velocity. (c) Introducing a criterion-based partial occlusion handling approach in online learning. (d) Tracking object bounding box by using affine parametric shape modeling with manifold appearance embedded. (e) Incorporating spatial, frequency and orientation information in the covariance descriptor by extracting Gabor features in a partitioned bounding box. (f) Effectively applying to both visual-band videos and thermal-infrared videos. To realize the proposed tracker, two particle filters are employed: one is applied on the Riemannian manifold for generating candidate appearance particles and another is on vector space for generating candidate box particles. Further, tracking and online learning are performed in alternation to mitigate the tracking drift. Experiments on both visual and infrared videos have shown robust tracking performance of the proposed scheme. Comparisons and evaluations with ten existing state-of-art trackers provide further support to the proposed scheme.
               
            

@&#INTRODUCTION@&#

Tracking visual object from videos has drawn increased interest in recent years [1,2]. Many robust trackers have been successfully developed however challenges remain especially when dynamic objects contain large out-of-plane changes and significant appearance changes, experience long-term partial occlusions or intersections with other objects in dynamic background and crowded scenes. Online learning of object appearances is an essential issue for mitigating the tracking drift, where off-line learning is often unrealistic for dealing with real world problems. One of the main tasks for online learning is to estimate current statistics, parameters or states of non-stationary objects from new observations. It enables a tracker to adaptively utilize a timely reference object model for tracking. A main challenge for online learning of visual object is the ambiguity on image changes that can be caused either by object itself (e.g. deformation, pose, self-occlusion) or by other occluding object/background. It is desirable that an online learning method adapts to changes in object intrinsic parameters (e.g. pose, appearance and shape) and is insensitive to extrinsic variations (e.g. illumination, occlusion, background, camera motion and viewpoint). Several online learning methods have been proposed. For example, Refs. [3,4] uses vector space learning that incrementally updates the sample mean of object appearance. Refs. [5,6] proposes manifold learning where dynamic object appearance is described as a point moving on a smoothed manifold surface. Since images of dynamic objects, especially out-of-plane objects, reside in nonlinear spaces, or manifolds [7], using a set of low-dimensional subspaces on manifolds has led to more robust online domain-shift learning as comparing with those using a single vector space.

Using covariance matrices of image features as object descriptors has drawn increasing interest lately for visual tracking [8]. It enables efficient description of object features, and shows to be robust and versatile for variations in illuminations, views and poses at modest computational cost. The space of non-singular covariance matrices of image features can be formulated as connected points (corresponding to smoothly shifting in different subspaces) on a Riemannian manifold. This paper addresses online domain-shift learning and tracking on Riemannian manifolds by using a set of weighted candidate covariance matrices as object descriptors.

@&#RELATED WORK@&#

Many object tracking methods have been proposed recently. One category of tracking methods models the images of objects on a vector space. For example, a mean shift-based tracker [9] seeks local modes through the kernel-based pdf estimate. It maximizes the similarity between a reference and a candidate object. However, mean shift tracker may fail if a target object has similar colors to occluding objects/background or too large changes in appearance due to pose changes. To tackle the problem, Ref. [10] proposes to use combination of anisotropic mean shift for describing global object appearance and SIFT-RANSAC for describing local object features for effective object tracking. CONDENSATION tracker [11] uses particle filters (PFs) and learned dynamic model, together with visual observations, to estimate the posterior probability of state vector. Ref. [3] incrementally learns the appearance subspace and updates the mean image by using a PF and extended sequential Karhunen–Loeve algorithm, that is performed by linear operations on a single subspace. However, for 2D planar images, dynamic object appearances especially objects containing large out-of-plane pose changes lie in different subspaces, or, on a differentiable manifold. Although these trackers perform rather well for some scenarios, challenges remain when objects contain significant out-of-plane pose changes, especially when the object size in image is large. Another category of tracking methods model the image of an object on a manifold that is locally Euclidean. For example, Ref. [5] uses a conjugate gradient and Newton’s method for subspace tracking on Grassmann and Stiefel manifolds with applications to orthogonal procrustes. Ref. [12] proposes piecewise geodesics on complex Grassmann manifolds using projection matrices for subspace tracking, where simulations are performed on synthetic signals from an array of sensors. Ref. [13] proposes a visual tracking approach by applying a Kalman filter to velocity vectors in the tangent planes of Grassmann manifolds. Ref. [14] applies visual tracking on Grassmann manifolds by using sliding-window observations. Much manifold tracking work is focused on covariance tracking, probably due to their robust performance. The first significant work on covariance tracking is proposed by Porikli et al. [6]. A variety of methods are then proposed that further improve and enhance the method. Among them, Ref. [15] uses an exhaustive search and a distance measure to find the best matching where model updating is performed using the Lie group structure on the manifold. The method is able to track objects with moderate out-of-plane pose changes however significant ones remain a challenge. Ref. [16] uses PFs [17] and affine invariant metrics [18] on Riemannian manifolds for seeking objects with similar appearances and tracking object bounding boxes with central location, width and height as the parameters. Ref. [19] incrementally learns covariance matrices of object appearances by applying the log-Euclidean metric [20] on a time window of manifold points, and uses PFs to track the object bounding box parameterized by its scale and central location. However, none of these methods simultaneously estimates affine bounding box parameters and covariance matrix of object appearance. Ref. [21] employs the log-Euclidean metric on a time window of manifold points for tracking affine box parameters of a moving object, and incrementally learns the eigen object representation in the tangent planes of manifold points. However, using a time window in log-Euclidean metric could affect the tracker in adapting abrupt object motions. Ref. [22] proposes a head pose estimation by using covariance matrices for object appearances and a nearest centroid classifier. The method is mainly related to an image descriptor for static images. Ref. [23] utilizes PFs on the manifold to estimate the target position and time-varying noise covariance with synthetic 2D position points for tracking target trajectories. The method is only simulated on tracking point data rather than images/video objects. Ref. [24] proposes nonlinear mean shift on a manifold for image segmentation and filtering. The basic formulation of Riemannian manifolds for imaging application is described in a very concise and thorough way, however, it has not addressed the issue of video object tracking. Ref. [25] proposes a Kalman filter on the manifold for visual object tracking. The weakness is that it cannot well handle nonlinear and non-Gaussian visual objects. Ref. [26] applies offline manifold training from a face dataset of different poses, and subsequent online learning of local linearity of appearance manifolds by PFs with a coarse-to-fine factorized sampling. It searches object locations during tacking, however, does not handle affine object transformations. The two categories of trackers above both belong to subspace tracking and modeling techniques. A third category of methods is based on tracking-by-detection, where an online discriminative classifier is trained to separate a target object from the background/clutter [27–31]. One can see that using learned classifiers for tracking is a rather different methodology: classifiers are usually formed by online boosted learning (e.g. AdaBoost) using a set of positive and negative visual samples corresponding to objects and background/clutter. It is also worth noting that the first category of methods uses features in a vector space while the second category uses features embedded on a manifold. The difference on whether basis matrices of feature vectors are defined in a vector space or on a manifold leads to key difference of these methods, where the latter category offers domain-shift possibility. Further, an important difference of these two categories to the third category of tracking-by-detection methods is on how the reference model is built, where the last category uses a set of training data to obtain the model. Although the final tracking performance is examined in a same way, parameters that impact the performance are rather different in the tracking-by detection category. The performance of tracking-by-detection trackers are largely influenced by how discriminative the online learned classifier with respect to the selected sets of positive and negative samples (in terms of the size of training samples and their statistical coverage).

Despite relatively good tracking results in these covariance trackers, several limitations are posed on their performance. One main limitation is tracking objects with fast or variable speed out-of-plane (or, non-planar) pose changes. This may be due to the use of a time window of manifold observations in the Riemannian mean to generate a new manifold point estimate [6]. The second limitation may occur when two objects have similar statistics however different spatial distributions, as the conventional covariance descriptor lacks of spatial information. The covariance matrices in these trackers are computed by first describing each pixel by a feature vector (e.g. pixel position, color and intensity values, first and 2nd derivatives), followed by computing the covariance over an entire set of feature vectors within a candidate object box. The third limitation could be caused by inaccuracies in updating new manifold points using predicted velocity vectors.

Motivated by the above, we propose a new covariance tracking scheme. The following strategies and novelties have been adopted to tackle the above issues: (a) The proposed scheme uses a nonlinear dynamic model and Bayesian formulation on Riemannian manifolds for estimating object appearances. Under the PF, the posterior manifold point is estimated from weighted predicted manifold points at the same time instant. This avoids the use of Riemannian mean over a time window. (b) The proposed nonlinear model, including two state variables of position and velocity, is a special case of 2nd-order dynamic model. This high order appearance model on the manifold is designed to introduce more robustness in tracking the dynamic appearance with fast domain-shift. (c) The proposed online learning method also contains a criterion-based partial occlusion handling part by using the geodesic distance so that appearance updating is only performed when no clear evidence of object occlusions. (d) A spatial-dependent covariance matrix is utilized by computing covariances on sub-regions of a partitioned bounding box. (e) Gabor features in different frequencies and orientations of partitioned sub-regions are used to form the feature vector of covariance matrix. The motivation is to formulate a spatial-frequency-orientation dependent feature descriptor. Apart from this, the descriptor is more flexible on using variable high frequency components in different types of images, e.g. infrared images require fewer frequency bands than that of visual images, as they lack detailed edges. The key improvement is on tracking moving objects with various types of out-of-plane motion/rotations accompanied with long-term partial-occlusions for large size objects (as compared to image size). This is mainly due to employing a nonlinear model and Bayesian formulation directly on the appearance manifold, although other novelties mentioned above also contribute to the improvement. By applying Bayesian formulation and particle filters on the manifold itself, we estimate the posterior object appearance through using a set of predicted manifold points in combination with object priori. Hence, robust tracking can be expected with reduced tracking drift, especially in tracking out-of-plane moving objects.

Roughly speaking, the proposed covariance tracker can be subdivided into two parts: online learning and object tracking. The online domain-shift appearance learning part is based on the Bayesian estimation of state variables (related to object appearance) on Riemannian manifolds by a nonlinear dynamic model. This model is realized through the help of two mapping (exponential and logarithmic) functions between tangent planes and Riemannian manifolds. Comparing with conventional manifold learning, a key difference lie in using a set of weighted predicted candidates and priors under Bayesian formulation. The tracking part is based on Bayesian estimation of state variables (related to affine object bounding box) in a vector space by a second PF. The key difference in this part from the conventional PF tracking is that the embedded visual object appearance is on a nonlinear Riemannian manifold rather than in a vector space. Comparing with our previous preliminary work presented in workshops [32,33], this paper has introduced a new method for occlusion handling that is integrated into the manifold online learning process. Furthermore, it provides more thorough mathematical formulations on the tracking scheme, applies several objective criteria to evaluate the performance of the tracker in addition to the previous visual inspections, and tested on more videos (containing a range of complex scenarios) and compared with more trackers (nice relevant trackers). Further, it is worth mentioning that although the idea of Bayesian tracking in [14] is somewhat similar to this paper, significant difference exists in terms of the manifold applied (Grassmann manifold) and in terms of data (a sliding window of images) used for manifold point estimation. The tracker in this paper is built on Riemannian manifolds where each manifold point is estimated by using one single frame of object image at current time.

To demonstrate the effectiveness of the proposed method, experiments have been conducted extensively on visual and thermal IR videos. The performance of the proposed tracker has been compared to nine existing trackers that are most relevant to the proposed scheme. The remainder of the paper is organized as follows. Section 2 briefly reviews manifold theory and its commonly used examples in computer vision. Sections 3–5 describe the proposed tracking scheme in details. Section 6 summaries the proposed integrated tracking scheme and the algorithm in detail. Section 7 describes experimental results, performance evaluations and comparisons, including discussions and limitations. Finally, the conclusion is given in Section 8.

This section briefly reviews the manifold structure, tangent spaces, Riemannian metrics and geometries of symmetric manifolds for the sake of mathematical convenience in subsequent sections. More details on manifold theories are referred to [34–36]. In all cases, notations for manifold points are in bold lower case letters (e.g., 
                        
                           p
                           ,
                           q
                        
                     ), and matrices are in bold capital letters (e.g., 
                        
                           A
                           ,
                           B
                        
                     ).

Roughly speaking, a manifold can be considered as low dimensional spaces embedded in a high dimensional space, where a set of metrics or calculus can be defined. The main motivation of using manifolds is that a high dimensional signal may efficiently be described by significantly lower dimensional spaces while maintaining its geometry, topology (e.g. Euclidean topology) and other essential properties. A simple example is to describe a curve in 3D space by a one-dimensional manifold. The motivation of using Riemannian manifolds for describing object appearances, apart from reducing the dimensionality, is that trajectories of objects described by Riemannian manifolds are smooth and differentiable, and Riemannian metrics are inner products on the manifolds where important object geometries, e.g., distances or geodesics, are preserved. Differential manifolds can be considered as topological spaces that consist of open sets of Euclidean space 
                           
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                           
                        , glued together and is differentiable. This means that a manifold is locally similar to the Euclidean space, but not globally. For every point on a d-dimensional manifold, there exists a neighborhood that is topologically equivalent (homeomorphic) to an open set in 
                           
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                           
                        . Fig. 1
                         depicts a two-dimensional manifold embedded in 
                           
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                           
                        . Detailed description of manifold basics is beyond the scope of this paper, readers are referred to [36,37]. In the remaining part of this section, we summarize several essential definitions of manifold terminologies that are used in this paper.

A curve 
                        
                           
                              γ
                              (
                              t
                              )
                           
                         on a manifold is a smooth mapping from an open interval in 
                           
                              R
                           
                         to 
                           
                              M
                           
                        . The derivative of a curve passing through a point 
                           
                              p
                           
                         on a manifold is called the tangent vector 
                        
                           
                              Δ
                           
                         at 
                           
                              p
                           
                        . The set of all tangent vectors at 
                           
                              p
                           
                         forms a tangent space 
                        
                           
                              
                                 
                                    T
                                 
                                 
                                    p
                                 
                              
                              M
                           
                        . It is a vector space whose dimension is equal to that of the manifold. The tangent space provides a local linear approximation of the manifold in the similar way that the derivative of a real-valued function provides a local linear approximation.

A geodesic is defined as the shortest curve that connects two points 
                           
                              p
                              ,
                              q
                           
                         on a manifold. The geodesic is uniquely defined by two initial conditions, typically its initial position and initial derivative [5]. For each 
                           
                              Δ
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    p
                                 
                              
                              M
                           
                        , there exists a locally unique geodesic 
                           
                              γ
                              (
                              t
                              )
                           
                         starting at 
                           
                              γ
                              (
                              0
                              )
                              =
                              p
                           
                         with initial velocity 
                           
                              
                                 
                                    γ
                                 
                                 
                                    ̇
                                 
                              
                              (
                              0
                              )
                              =
                              Δ
                           
                        , and travelling with a constant speed.

The exponential and logarithmic map functions are two functions that map between manifold points and their corresponding velocity vectors along the geodesics. The exponential mapping function 
                        
                           
                              
                                 
                                    exp
                                 
                                 
                                    p
                                 
                              
                              :
                              
                                 
                                    T
                                 
                                 
                                    p
                                 
                              
                              M
                              →
                              M
                           
                         maps a tangent vector 
                           
                              Δ
                           
                         to a manifold point 
                           
                              q
                           
                         starting from 
                           
                              p
                           
                         and reaching in a unit time along the geodesic 
                           
                              q
                              =
                              
                                 
                                    exp
                                 
                                 
                                    p
                                 
                              
                              (
                              Δ
                              )
                              =
                              γ
                              (
                              1
                              )
                           
                        . The logarithmic mapping function 
                        
                           
                              
                                 
                                    log
                                 
                                 
                                    p
                                 
                              
                              :
                              M
                              →
                              
                                 
                                    T
                                 
                                 
                                    p
                                 
                              
                              M
                           
                         maps a manifold point to a tangent vector, and is the inverse process of exponential mapping.

This subsection reviews two metrics defined on Riemannian manifolds, and summarizes the formulae used in our tracking scheme for computing the two mapping functions, geodesics and Riemannian means under one of the metrics. It is known that metrics defined on a Riemannian manifold are related to inner products (which is symmetric positive) on the manifold. The space of Symmetric Positive Definite 
                           
                              (
                              
                                 
                                    Symm
                                 
                                 
                                    n
                                 
                                 
                                    +
                                 
                              
                              )
                           
                         matrices is not a vector space, instead it lies on a Riemannian manifold that constitutes the convex-half cone in a vector space of matrices. It is easy to show that the multiplication operation by a negative scalar does not always guarantee to be closed. The derivative at a point on 
                           
                              M
                           
                         lies in 
                           
                              T
                           
                        , which is a vector space formed by symmetric matrices, not necessarily 
                           
                              
                                 
                                    Symm
                                 
                                 
                                    n
                                 
                                 
                                    +
                                 
                              
                           
                        . Two metrics, namely affine-invariant metric and log-Euclidean metric, proposed by Pennec et al. [18] and Arsigny et al. [20], are commonly used for computing statistics on 
                           
                              
                                 
                                    Symm
                                 
                                 
                                    n
                                 
                                 
                                    +
                                 
                              
                           
                        . Numerical results of both metrics are similar. Since the log-Euclidean metric is computationally more efficient, and the mean value on 
                           
                              M
                           
                         is easier to compute with a closed form solution, we adopt the log-Euclidean metric in this paper. Equations for computing mappings, geodesics, and manifold means are dependent on the type of manifolds and the matric used. In the following we briefly review and summarize the relevant formulae on Riemannian manifolds under the log-Euclidean metric.

Given a staring point 
                              
                                 p
                              
                            (or, 
                              
                                 p
                                 (
                                 t
                                 =
                                 0
                                 )
                              
                           ) on the manifold 
                              
                                 M
                              
                           , and the corresponding tangent vector 
                              
                                 Δ
                              
                            in its tangent plane 
                              
                                 T
                              
                           , (1) maps the tangent vector along the geodesic to yield the end point 
                              
                                 q
                              
                            at a unit time on 
                              
                                 M
                              
                           , i.e. 
                              
                                 q
                                 =
                                 p
                                 (
                                 1
                                 )
                              
                           . The exponential mapping [24] for the log-Euclidean metric is given by:
                              
                                 (1)
                                 
                                    
                                       
                                          exp
                                       
                                       
                                          p
                                       
                                    
                                    (
                                    Δ
                                    )
                                    =
                                    exp
                                    (
                                    log
                                    p
                                    +
                                    Δ
                                    )
                                 
                              
                           
                        

Given two points 
                              
                                 p
                                 ,
                                 
                                 q
                              
                            on 
                              
                                 M
                              
                           , (2) results in a velocity vector 
                              
                                 Δ
                              
                            in 
                              
                                 T
                              
                            corresponding to the geodesic from 
                              
                                 p
                              
                            to 
                              
                                 q
                              
                            on 
                              
                                 M
                              
                           . The logarithmic map [24] for the log-Euclidean metric is given by:
                              
                                 (2)
                                 
                                    
                                       
                                          log
                                       
                                       
                                          p
                                       
                                    
                                    q
                                    =
                                    log
                                    q
                                    -
                                    log
                                    p
                                    =
                                    Δ
                                 
                              
                           
                        

Given two points 
                              
                                 p
                                 ,
                                 
                                 q
                              
                            on 
                              
                                 M
                              
                           , the geodesic under the log-Euclidean metric is given by [24]:
                              
                                 (3)
                                 
                                    d
                                    (
                                    p
                                    ,
                                    q
                                    )
                                    =
                                    ‖
                                    
                                       
                                          log
                                       
                                       
                                          p
                                       
                                    
                                    q
                                    
                                       
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    ‖
                                    log
                                    q
                                    -
                                    log
                                    p
                                    
                                       
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        

The mean of a set of points on a manifold lying on a small neighborhood of manifold can be calculated extrinsically or intrinsically. The Karcher mean (or, Fréchet mean) is the minimum weighted mean of a set of points on a manifold 
                              
                                 M
                              
                            with respect to a manifold point 
                              
                                 x
                              
                           . Given a finite number of points 
                              
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 N
                                 }
                              
                            on 
                              
                                 M
                              
                            within an observation window, the Karcher mean on the manifold is defined as [38–41],
                              
                                 (4)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          x
                                       
                                    
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          N
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          min
                                       
                                       
                                          x
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             x
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 x
                                 =
                                 
                                    
                                       argmin
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          x
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ,
                                 
                                 x
                                 ∈
                                 M
                                 ,
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                              
                            is the weight, and 
                              
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 〈
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       〉
                                    
                                    
                                       x
                                    
                                 
                              
                           . The Karcher mean is an intrinsic mean computed directly on the manifold. Gradient descent approach is usually employed to solve this minimization problem. The Riemannian mean (or, the expected mean on a Riemannian manifold) utilized in this paper is an extrinsic mean. Computing this Riemannian mean requires mapping the points on 
                              
                                 M
                              
                            to the tangent space 
                              
                                 T
                              
                            by using the logarithmic operator, computing the mean in 
                              
                                 T
                              
                           , and then exponentially mapping the result back to 
                              
                                 M
                              
                           . The Riemannian mean for 
                              
                                 
                                    
                                       Symm
                                    
                                    
                                       n
                                    
                                    
                                       +
                                    
                                 
                              
                            matrices under the log-Euclidean metric is calculated by [42,41]:
                              
                                 (5)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          LE
                                       
                                    
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          N
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          exp
                                       
                                       
                                          I
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                             
                                             
                                                
                                                   log
                                                
                                                
                                                   I
                                                
                                             
                                             
                                                
                                                   p
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 I
                              
                            is the identity matrix with the same dimension as 
                              
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                              
                           .


                           Remarks: The exponential mapping, logarithmic mapping and geodesic can also be computed by using the affine invariant metric on Riemannian manifolds. For the sake of completion, the required formulae are summarized below (see [18] for more details).
                              
                                 (6)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      exp
                                                   
                                                   
                                                      p
                                                   
                                                
                                                (
                                                Δ
                                                )
                                                =
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                                exp
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      -
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                                Δ
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      -
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                                )
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      log
                                                   
                                                   
                                                      p
                                                   
                                                
                                                (
                                                q
                                                )
                                                =
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                                log
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      -
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                                
                                                   
                                                      qp
                                                   
                                                   
                                                      -
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                                )
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                d
                                                (
                                                p
                                                ,
                                                q
                                                )
                                                =
                                                tr
                                                [
                                                
                                                   
                                                      log
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      -
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                                
                                                   
                                                      qp
                                                   
                                                   
                                                      -
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                                )
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

This section describes the proposed Bayesian formulation for online domain-shift learning of object appearances through exploiting Riemannian manifolds, a nonlinear dynamic model, and a method for partial-occlusion handling. It is worth mentioning that online learning with occlusion handling plays an essential role in maintaining a timely reference object model and effectively prevents tracking drift especially when objects are highly dynamic. Online learning is an essential step for mitigating tracking drift through timely updating the reference model of dynamic objects, especially when significant deformations and/or out-of-plane pose changes of objects occur. The main ideas behind the proposed online domain-shift learning on the manifold are twofold: (a) the estimation of current object appearance on the manifold is set to be dependent on a set of predicted candidate appearances that are weighted by their probabilities, and in combination with their priors; (b) each candidate appearance is estimated by modeling both the appearance and its change (or, velocity), where a new predicted value remains on the manifold and moves smoothly along the geodesic. The rational behind these ideas is to enhance the online learning through the following ways: by using a particle filter on the manifold would enable nonlinear estimation of non-Gaussian distributed pdf (used as the weights) for more robust learning; by increasing the model order (to include both the position of manifold point and its velocity), the accuracy of manifold point estimation may be improved; finally, by using a manifold would allow the shift of appearance domain, especially when significant out-of-plane pose changes occur. To avoid online learning when partial object occlusion occurs, an occlusion handling strategy is added.

Let the object appearance at t be described by a covariance matrix 
                           
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                              
                           
                        , (i.e., a point on a Riemannian manifold) and the speed of appearance change be 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    t
                                 
                              
                           
                        . We define the state vector as follows:
                           
                              (7)
                              
                                 
                                    
                                       s
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             C
                                          
                                          
                                             t
                                          
                                       
                                       
                                       
                                          
                                             Δ
                                          
                                          
                                             t
                                          
                                       
                                       ]
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        Let the state (i.e., object appearance) dynamics be described by the following nonlinear model,
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   h
                                                   (
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         Δ
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                   =
                                                   
                                                      
                                                         exp
                                                      
                                                      
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               t
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Δ
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Δ
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         Δ
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              h
                              (
                              ·
                              )
                           
                         is a nonlinear mapping function (equivalently to the exponential mapping 
                           
                              
                                 
                                    exp
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                    
                                 
                              
                           
                         under this model), 
                           
                              
                                 
                                    exp
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                    
                                 
                              
                           
                         is the exponential mapping with the starting point at 
                           
                              
                                 
                                    C
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                           
                         (including the acceleration and model noise) is assumed to be zero-mean white, 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                           
                         is constant in each sample interval 
                           
                              T
                              =
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              -
                              
                                 
                                    t
                                 
                                 
                                    k
                                    -
                                    1
                                 
                              
                           
                        , and 
                           
                              T
                              =
                              1
                           
                         is set for mathematical convenience. We refer (8) as the nonlinear model, noting the two state space equations are defined in two different but interrelated spaces (manifold points and their associated tangent planes for two different components. The first equation in (8) is the nonlinear dynamic appearance model on the manifold where two manifold points at successive time instants are related by 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    t
                                 
                              
                           
                         in the tangent plane. The second equation in (8) is a constant velocity model in the tangent plane where the acceleration is considered as white noise. The above nonlinear model can be considered as a 2nd-order discrete white noise acceleration model for Riemannian manifold points. Noting these definitions are different from the conventional constant velocity model where this velocity model is defined on the tangent plane interrelated to each individual manifold point, while the appearance model is in fact a second-order nonlinear dynamic model on the Riemannian manifold. To the best of our knowledge, such a second-order nonlinear dynamic model on a Riemannian manifold is new.

Our aim here is to perform online domain-shift learning of new state 
                           
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                              
                           
                         through Bayesian estimation on a Riemannian manifold. This can be roughly described as predicting a set of candidate appearances on the manifold, computing their weights by estimating the conditional pdf (or likelihood), and the posterior estimation of appearance by combining priors and weighted predicted candidates in the MMSE sense on the manifold. This is realized with the help of a Particle Filter (PF) on the manifold. We use the following notations for different types of covariance matrices throughout the subsequent text:
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                             
                                                j
                                             
                                          
                                          :
                                       
                                       
                                          for
                                          
                                          j
                                          th
                                          
                                          predicted candidate object
                                          
                                          (
                                          i
                                          .
                                          e
                                          .
                                          j
                                          th particle)at
                                          
                                          t
                                          -
                                          1
                                          .
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                t
                                             
                                             
                                                obj
                                             
                                          
                                          :
                                       
                                       
                                          for posterior reference object at
                                          
                                          t
                                          ,
                                          
                                          before occlusion handling.
                                       
                                    
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                t
                                             
                                             
                                                obj
                                             
                                          
                                          :
                                       
                                       
                                          for finally selected reference object at
                                          
                                          t
                                          ,
                                          
                                          after occlusion handling.
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                t
                                             
                                             
                                                obj
                                             
                                          
                                          :
                                       
                                       
                                          for new object observation
                                          
                                          (
                                          from the tracking process in PF
                                          -
                                          2
                                          )
                                          
                                          at
                                          
                                          t
                                          .
                                       
                                    
                                 
                              
                           
                        
                     


                        Fig. 2
                         shows the block diagram of online learning that is integrated with the object tracking process (see Section 5). It is worth mentioning that although particle filters are widely used in tracking, defining particle filters directly on Riemannian manifolds is new.

Let the current observation at time t be 
                           
                              
                                 
                                    Z
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    obj
                                 
                              
                           
                         that is provided by the tracking process (see Section 5), where 
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    obj
                                 
                              
                           
                         is the covariance matrix of tracked object at t. Let 
                           
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                              
                           
                        , the first component in the state vector of (7), be estimated. The recursive Bayesian estimation under the first order Markov assumption becomes,
                           
                              (9)
                              
                                 p
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       Z
                                    
                                    
                                       0
                                       :
                                       t
                                    
                                 
                                 )
                                 ∝
                                 p
                                 (
                                 
                                    
                                       Z
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 ∫
                                 p
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       Δ
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 p
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       Z
                                    
                                    
                                       0
                                       :
                                       t
                                       -
                                       1
                                    
                                 
                                 )
                                 d
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                              
                           
                         is the state vector of object manifold appearance at time 
                           
                              t
                              ,
                              
                              
                                 
                                    Z
                                 
                                 
                                    0
                                    :
                                    t
                                 
                              
                           
                         is the observations up to t. Using the weighted sum of randomly generated samples or particles drawn from a proposal distribution [44], the posterior pdf estimate is approximated as:
                           
                              (10)
                              
                                 p
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                                 |
                                 
                                    
                                       Z
                                    
                                    
                                       0
                                       :
                                       t
                                    
                                 
                                 )
                                 ≈
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                                 δ
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                           
                         is the particle, 
                           
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                           
                         is the weight, 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              =
                              1
                              ,
                              
                              
                                 
                                    N
                                 
                                 
                                    1
                                 
                              
                           
                         is the total number of particles. Since this PF is employed on the manifold where the nonlinear model describes state variables in two inter-connected spaces, the realization of this PF requires the interaction between manifold points and tangent planes. Three major steps are included as follows:

Let 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       j
                                    
                                 
                              
                            be the manifold particle point at previous time 
                              
                                 t
                                 -
                                 1
                              
                            and 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       j
                                    
                                 
                              
                            be the velocity particle that connects (
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       2
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       j
                                    
                                 
                              
                           ), where 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       j
                                    
                                 
                              
                            is the end point of the geodesic starting from 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       2
                                    
                                    
                                       j
                                    
                                 
                              
                           . First, a set of velocity particles 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                              
                            (originated from 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       j
                                    
                                 
                              
                           ) is generated in tangent planes using the previous velocity particles 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       j
                                    
                                 
                              
                            according to 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       Δ
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                              
                            (the 2nd equation of (8)), 
                              
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       1
                                    
                                 
                              
                           . Then, a set of new manifold particles 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                              
                            is obtained from 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                              
                            through the exponential mapping, according to 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       exp
                                    
                                    
                                       
                                          
                                             C
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                            (the 1st equation of (8)). These manifold points 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                              
                            are considered as the predicted points at t.

The likelihood is computed from the Gaussian-distributed geodesic between the observation 
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       obj
                                    
                                 
                              
                            and predicted manifold point 
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                              
                           ,
                              
                                 (11)
                                 
                                    p
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   t
                                                
                                                
                                                   obj
                                                
                                             
                                             |
                                             
                                                
                                                   C
                                                
                                                
                                                   t
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    =
                                    exp
                                    
                                       
                                          
                                             -
                                             
                                                
                                                   d
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         obj
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         l
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       l
                                    
                                    
                                       2
                                    
                                 
                              
                            is the measurement noise (
                              
                                 
                                    
                                       σ
                                    
                                    
                                       l
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0.1
                              
                            in our tests), and 
                              
                                 d
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                t
                                             
                                             
                                                obj
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                t
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   log
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         obj
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   t
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                              
                           . The particle weight which is proportional to the geodesic between the observation and the predicted manifold particle point at t, and the corresponding particle weight at 
                              
                                 t
                                 -
                                 1
                              
                           , is updated as follows,
                              
                                 (12)
                                 
                                    
                                       
                                          w
                                       
                                       
                                          t
                                       
                                       
                                          j
                                       
                                    
                                    ∝
                                    
                                       
                                          w
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                       
                                          j
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          t
                                       
                                       
                                          obj
                                       
                                    
                                    |
                                    
                                       
                                          C
                                       
                                       
                                          t
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                           and subsequently normalized by 
                              
                                 
                                    
                                       w
                                    
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                                 /
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                              
                           . Resampling is applied if 
                              
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       eff
                                    
                                 
                                 =
                                 1
                                 /
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             t
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 <
                                 N
                                 
                                    
                                       1
                                    
                                    
                                       th
                                    
                                 
                              
                           , where 
                              
                                 N
                                 
                                    
                                       1
                                    
                                    
                                       th
                                    
                                 
                              
                            is a threshold, to prevent the degeneracy problem [17].

Finally, the MMSE estimate of object appearance 
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       obj
                                    
                                 
                              
                            is obtained as the expected value of weighted predicted particles on the manifold and also noting (5), by:
                              
                                 (13)
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          t
                                       
                                       
                                          obj
                                       
                                    
                                    =
                                    
                                       
                                          exp
                                       
                                       
                                          I
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   t
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                
                                                   log
                                                
                                                
                                                   I
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   t
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                           Fig. 3
                            shows the relationship of manifold particles, velocity particles, observation point, and the predicted and posterior estimated points between two time instants.

In this part, we introduce a method to tackle a potential problem that may occur in online learning when the target object is partially occluded. The difficulty in handling occlusions of deformable objects with large out-of-plane pose changes is caused by the ambiguity between the changes caused by object itself, or by other occluding objects/background. It is important that an online learning method only updates the reference object appearance when changes are caused by the dynamic object itself (e.g. pose, deformation), while avoids updating when changes are due to partial occlusions as this could lead to subsequent tracking drift. We propose a criterion that gives a rough estimation of these two cases. If the latter case appear, then online learning process would be frozen to prevent absorbing wrong information to the reference object. To the best of our knowledge, for Riemannian manifold tracking, no successful criterion for online learning of large out-of-plane pose changing object with occlusion handling has so far been reported.

The occlusion handling strategy is based on the observation that relatively large differences (or less cross-correlation) between the tracked region and the reference object may occur when the object experiences occlusions as compared with object pose changes. We employ the geodesic distance between the reference object at (t
                        −1) and the current online learned object before occlusion handling as the measure,
                           
                              (14)
                              
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       obj
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       obj
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   log
                                                
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         t
                                                         -
                                                         1
                                                      
                                                      
                                                         obj
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   t
                                                
                                                
                                                   obj
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        If the geodesic distance in (14) is large than a threshold 
                           
                              
                                 
                                    d
                                 
                                 
                                    th
                                 
                              
                           
                         (determined empirically),
                           
                              (15)
                              
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 >
                                 
                                    
                                       d
                                    
                                    
                                       th
                                    
                                 
                              
                           
                        then the object is considered as likely to be occluded and no updating is performed. The rationale behind the choice is based on the observation that, the geodesic from an occluding object/background to the reference object is usually larger than that of a moving object to its own reference object, noting that the geodesic describes the manifold distance between object appearance in the box and the manifold reference object at the previous time (t
                        −1). A very large 
                           
                              
                                 
                                    d
                                 
                                 
                                    t
                                 
                              
                           
                         could indicate a possible object occlusion. Hence, the new reference object appearance 
                           
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                                 
                                    obj
                                 
                              
                           
                        at t is only updated as follow, if (15) is not satisfied:
                           
                              (16)
                              
                                 
                                    
                                       C
                                    
                                    
                                       t
                                    
                                    
                                       obj
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       obj
                                    
                                 
                              
                           
                        Otherwise, no update is made. It is worth mentioning that an alternative approach was employed by using Bhattacharyya coefficient (BC) in [10,4] for occlusion handling during online learning in a vector space. We have tested the same strategy by using BC for occlusion handling on the Riemannian manifold where our results show that the strategy works on the Riemannian manifold as well. One disadvantage is that using BC requires extra computations as comparing with geodesic-based occlusion handling that is also consistent with the online learning metric.

This section describes an object appearance descriptor by using the covariance matrix of Gabor features, where two aspects are introduced to the covariance matrix. One is the use of partitioned regions of each candidate object bounding box to obtain spatial-dependent features hence spatial-dependent covariance matrices. Although the concept of object partition is well known, using features in partitioned regions for forming spatial-dependent covariance matrices in Riemannian manifold tracking, in the best of our knowledge, is new. Another aspect is to form the covariance matrix by using Gabor features, so that the covariance matrix is also frequency and orientation-dependent, in addition to that Gabor features are complete description of object. Apart from using spatial, frequency and orientation-dependent covariance matrices, another motivation of using Gabor features is to have a flexible descriptor that is suitable to both visual and infrared (IR) video objects. Since IR images contain relatively low frequency components, one could use a smaller number of Gabor filters to generate features. It is worth mentioning that other efficient feature descriptors, e.g. HoG (Histogram of Oriented Gradients), higher order moments, can be used to replace the Gabor features to form the covariance matrix in the proposed tracker.

Given an image in a candidate object bounding box, partitioning is first applied that divides the box into L sub-regions. Let a d-component feature vector 
                        
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           (
                           x
                           ,
                           y
                           )
                        
                      in each pixel 
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      of a jth sub-region 
                        
                           
                              
                                 R
                              
                              
                                 j
                              
                           
                        
                      be defined as follows:
                        
                           (17)
                           
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 
                                    
                                       
                                          x
                                          
                                          y
                                          
                                          I
                                          
                                          
                                             
                                                I
                                             
                                             
                                                g
                                             
                                             
                                                1
                                             
                                          
                                          
                                          ⋯
                                          
                                          
                                             
                                                I
                                             
                                             
                                                g
                                             
                                             
                                                K
                                             
                                          
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                           
                        
                     where 
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      is the pixel position, I is the image intensity, 
                        
                           
                              
                                 I
                              
                              
                                 g
                              
                              
                                 k
                              
                           
                           ,
                           
                           k
                           =
                           1
                           ,
                           …
                           ,
                           K
                        
                     , is the real outputs of Gabor filters at different orientations and frequencies, and the Gabor filter kernel (associated with a real filter) [43] is defined as:
                        
                           (18)
                           
                              
                                 
                                    g
                                 
                                 
                                    f
                                    ,
                                    θ
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              =
                              exp
                              
                                 
                                    
                                       -
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            y
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              cos
                              (
                              2
                              π
                              f
                              
                                 
                                    x
                                 
                                 
                                    ̃
                                 
                              
                              )
                           
                        
                     where 
                        
                           f
                           ,
                           
                           θ
                           ,
                           
                           
                              
                                 σ
                              
                              
                                 x
                              
                           
                        
                      and 
                        
                           
                              
                                 σ
                              
                              
                                 y
                              
                           
                        
                      are the center frequency, orientation, spread (along the x and y directions), respectively, and 
                        
                           
                              
                                 x
                              
                              
                                 ̃
                              
                           
                           =
                           x
                           cos
                           θ
                           +
                           y
                           sin
                           θ
                           ,
                           
                           
                              
                                 y
                              
                              
                                 ̃
                              
                           
                           =
                           -
                           x
                           sin
                           θ
                           +
                           y
                           cos
                           θ
                        
                     .

Different from [6], the covariance matrix is formed by L sub-matrices for partitioned sub-regions. For jth sub-region 
                        
                           
                              
                                 R
                              
                              
                                 j
                              
                           
                        
                     , a sub-covariance matrix is formed from the sample average,
                        
                           (19)
                           
                              
                                 
                                    C
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    M
                                    -
                                    1
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              -
                              
                                 
                                    m
                                 
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              )
                              
                                 
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    -
                                    
                                       
                                          m
                                       
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 
                                    T
                                 
                              
                           
                        
                     where M is the total number of samples in 
                        
                           
                              
                                 R
                              
                              
                                 j
                              
                           
                        
                     , and 
                        
                           
                              
                                 m
                              
                              
                                 v
                              
                              
                                 j
                              
                           
                        
                      is the mean.

This section briefly describes the Bayesian tracking process on the manifold, noting that the tracking result 
                        
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 t
                              
                              
                                 obj
                              
                           
                        
                      from this process is fed to the online learning process as a new observation. It is worth mentioning that the tracking process here is similar in the spirit to that in [4], where a PF is used to estimate the affine bounding box parameters, while the appearance of object is embedded as the likelihood in the PF. The key difference is that the embedded appearance in this tracker is on the manifold whereas in [4] it is defined in a linear space. For the sake of completeness, the tracking process is briefly described as follows.

The aim in the tracking process is to estimate the posterior pdf of object bounding box (and the image within the bounding box). This is realized by utilizing another PF, referred to as PF-2. Let the state vector 
                        
                           s
                           
                              
                                 2
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 [
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                                 
                                 
                                    
                                       β
                                    
                                    
                                       t
                                    
                                 
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       t
                                    
                                 
                                 
                                 
                                    
                                       α
                                    
                                    
                                       t
                                    
                                 
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       t
                                    
                                 
                                 ]
                              
                              
                                 T
                              
                           
                        
                     at tbe defined as the affine bounding box parameters (2D box center, scale, rotation, aspect ratio and skew) and 
                        
                           z
                           
                              
                                 2
                              
                              
                                 0
                                 :
                                 t
                              
                           
                        
                      be the observations. The recursive Bayesian estimation under the first-order Markov assumption becomes,
                        
                           (20)
                           
                              p
                              (
                              s
                              
                                 
                                    2
                                 
                                 
                                    t
                                 
                              
                              |
                              z
                              
                                 
                                    2
                                 
                                 
                                    0
                                    :
                                    t
                                 
                              
                              )
                              ∝
                              p
                              (
                              z
                              
                                 
                                    2
                                 
                                 
                                    t
                                 
                              
                              |
                              s
                              
                                 
                                    2
                                 
                                 
                                    t
                                 
                              
                              )
                              ∫
                              p
                              (
                              s
                              
                                 
                                    2
                                 
                                 
                                    t
                                 
                              
                              |
                              s
                              
                                 
                                    2
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              )
                              p
                              (
                              s
                              
                                 
                                    2
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              |
                              z
                              
                                 
                                    2
                                 
                                 
                                    0
                                    :
                                    t
                                    -
                                    1
                                 
                              
                              )
                              d
                              s
                              
                                 
                                    2
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                           
                        
                     where 
                        
                           z
                           
                              
                                 2
                              
                              
                                 0
                                 :
                                 t
                              
                           
                        
                      is the observations up to t. Given a set of particles at 
                        
                           t
                           -
                           1
                        
                     , a new set of particles 
                        
                           
                              
                                 {
                                 s
                                 
                                    
                                       2
                                    
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 
                                    
                                       N
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                      is generated by PF-2 according to the state equation,
                        
                           (21)
                           
                              s
                              
                                 
                                    2
                                 
                                 
                                    t
                                 
                              
                              =
                              s
                              
                                 
                                    2
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              +
                              v
                              2
                              ,
                              
                              v
                              2
                              ∼
                              N
                              (
                              0
                              ,
                              Ω
                              )
                           
                        
                     The posterior pdf is estimated by 
                        
                           p
                           (
                           s
                           
                              
                                 2
                              
                              
                                 t
                              
                           
                           |
                           z
                           
                              
                                 2
                              
                              
                                 0
                                 :
                                 t
                              
                           
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 
                                    
                                       N
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           w
                           
                              
                                 2
                              
                              
                                 t
                              
                              
                                 i
                              
                           
                           δ
                           
                              
                                 
                                    s
                                    
                                       
                                          2
                                       
                                       
                                          t
                                       
                                    
                                    -
                                    s
                                    
                                       
                                          2
                                       
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        
                     . Assuming 
                        
                           p
                           
                              
                                 
                                    s
                                    
                                       
                                          2
                                       
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    s
                                    
                                       
                                          2
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        
                      is equal to the proposal 
                        
                           q
                           
                              
                                 
                                    s
                                    
                                       
                                          2
                                       
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    s
                                    
                                       
                                          2
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    z
                                    
                                       
                                          2
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                           
                        
                     , particle weights 
                        
                           w
                           
                              
                                 2
                              
                              
                                 t
                              
                              
                                 i
                              
                           
                        
                      are updated by 
                        
                           w
                           
                              
                                 2
                              
                              
                                 t
                              
                              
                                 i
                              
                           
                           ∝
                           w
                           
                              
                                 2
                              
                              
                                 t
                                 -
                                 1
                              
                              
                                 i
                              
                           
                           p
                           
                              
                                 
                                    z
                                    
                                       
                                          2
                                       
                                       
                                          t
                                       
                                    
                                    |
                                    s
                                    
                                       
                                          2
                                       
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        
                     , followed by the normalization. Further, resampling is applied if 
                        
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 eff
                              
                           
                           =
                           1
                           
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          w
                                          
                                             
                                                2
                                             
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    <
                                    N
                                    
                                       
                                          2
                                       
                                       
                                          th
                                       
                                    
                                 
                              
                           
                        
                      is satisfied [17]. The key difference of our tracking part as comparing to the conventional PF tracking is that the likelihood is defined as the Gaussian distributed geodesic on the manifold between the reference object appearance at 
                        
                           (
                           t
                           -
                           1
                           )
                        
                      (defined as the previously online learned 
                        
                           
                              
                                 C
                              
                              
                                 t
                                 -
                                 1
                              
                              
                                 obj
                              
                           
                        
                     ) and the ith particle of object appearance in PF-2,
                        
                           (22)
                           
                              p
                              
                                 
                                    
                                       z
                                       
                                          
                                             2
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       s
                                       
                                          
                                             2
                                          
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              ∝
                              p
                              (
                              z
                              
                                 
                                    2
                                 
                                 
                                    t
                                 
                              
                              |
                              g
                              
                                 
                                    
                                       s
                                       
                                          
                                             2
                                          
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              )
                              =
                              exp
                              
                                 
                                    
                                       -
                                       
                                          
                                             d
                                             
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            t
                                                            -
                                                            1
                                                         
                                                         
                                                            obj
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   w
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           g
                           (
                           s
                           
                              
                                 2
                              
                              
                                 t
                              
                           
                           )
                        
                      is the covariance matrix describing the object appearance within the bounding box, 
                        
                           
                              
                                 σ
                              
                              
                                 w
                                 2
                              
                              
                                 2
                              
                           
                        
                      is the variance of measurement noise, and 
                        
                           d
                           (
                           
                              
                                 C
                              
                              
                                 t
                                 -
                                 1
                              
                              
                                 obj
                              
                           
                           ,
                           
                              
                                 C
                              
                              
                                 t
                              
                              
                                 i
                              
                           
                           )
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             log
                                          
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   t
                                                   -
                                                   1
                                                
                                                
                                                   obj
                                                
                                             
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              
                                 2
                              
                              
                                 2
                              
                           
                        
                     is the Geodesic on the manifold. Finally, the MAP (maximum a posteriori) estimate of bounding box parameter vector is obtained as 
                        
                           s
                           
                              
                                 2
                              
                              
                                 t
                              
                              
                                 obj
                              
                           
                           =
                           s
                           
                              
                                 2
                              
                              
                                 t
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                           ,
                           
                           where
                           
                           
                              
                                 i
                              
                              
                                 ∗
                              
                           
                           =
                           
                              
                                 argmax
                              
                              
                                 i
                              
                           
                           (
                           w
                           
                              
                                 2
                              
                              
                                 t
                              
                              
                                 i
                              
                           
                           )
                        
                     . Using the estimated 
                        
                           s
                           
                              
                                 2
                              
                              
                                 t
                              
                              
                                 obj
                              
                           
                        
                     , the corresponding appearance 
                        
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 t
                              
                              
                                 obj
                              
                           
                        
                      of tracked object within the box is computed and provided to the online learning process at t.

The complete tracking scheme is the combination of tracking process and online learning process, running in alternation. The pseudo code of the proposed algorithm is summarized in Table 1
                     .

@&#EXPERIMENTAL RESULTS@&#

Since the proposed tracker is designed to tackle problems in tracking deformable objects with significant out-of-plane (i.e., non-planar) pose changes in videos, especially when the size of objects is relatively large as comparing to the size of images, several videos containing large size objects with such scenarios, captured by a moving (or static) camera in visual-band (or infrared), are used. To facilitate other applications, we also include some examples of videos in PETS and CAVIAR datasets, even though they mainly contain relatively small size objects. For testing the robustness of the proposed scheme in handling long-term partial occlusions, several videos containing a large size object (e.g. human face) with significant out-of-plane changes accompanied by long-term partial occlusion are also used.

Most test videos used in this section were obtained from public domains: videos “Chia”, “Danni” and “Behzad” were from video database Honda/UCSD [45], “Car-2” was from PETS2000 dataset 5, “PETS2009 S2 V1-L5” was from PETS2009 dataset, “Dudek” was from [46], “OneShopOneWait2Corr” was from CAVIAR dataset 2 [47], “Car-1” and “Jogging” were from [6], “David”, Girl”, “Faceocc2”, “Surfer” and “Sylvester” were from [29], only “IR face-1” and “IR face-2” were made in our university campus.

For all test videos, each object bounding box is partitioned into L
                        =16 rectangular sub-regions. The initial bounding box of each target object is manually selected. Each object region (i.e. the entire object area) is normalized to 
                           
                              32
                              ×
                              32
                           
                         pixels, 
                           
                              
                                 
                                    N
                                 
                                 
                                    1
                                 
                              
                              =
                              400
                              ,
                              
                              
                                 
                                    σ
                                 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              0.001
                              ,
                              
                              
                                 
                                    σ
                                 
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                              =
                              0.1
                              ,
                              
                              N
                              
                                 
                                    1
                                 
                                 
                                    th
                                 
                              
                              =
                              50
                           
                         are set for PF-1; 
                           
                              
                                 
                                    N
                                 
                                 
                                    2
                                 
                              
                              =
                              600
                              ,
                              
                              
                                 
                                    σ
                                 
                                 
                                    w
                                    2
                                 
                                 
                                    2
                                 
                              
                              =
                              0.25
                           
                        , and 
                           
                              N
                              
                                 
                                    2
                                 
                                 
                                    th
                                 
                              
                              =
                              75
                           
                         are set for PF-2. Gabor filters are applied at central frequencies 
                           
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                              /
                              3
                              ,
                              
                              1
                              /
                              6
                              ,
                              
                              1
                              /
                              12
                              ,
                              
                              1
                              /
                              24
                           
                        , orientations 
                           
                              Δ
                              
                                 
                                    θ
                                 
                                 
                                    n
                                 
                              
                              =
                              45
                              °
                              ,
                              
                              n
                              =
                              0
                              ,
                              …
                              ,
                              3
                           
                        , and 
                           
                              
                                 
                                    σ
                                 
                                 
                                    x
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    y
                                 
                              
                              =
                              0.5
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                           
                        , and K
                        =16. Similar to most PF tracking methods, noise variances of affine bounding box in (21) are pre-determined, empirically selected according to dynamic range of changes in different videos. Table 2
                         describes the noise variances 
                           
                              Ω
                              =
                              diag
                              
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             β
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             γ
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             ϕ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                         used in for PF-2 (empirically set in our tests, under the principle that variances are proportional to the corresponding variable changing speed).

Further, the vector form of sub-covariance matrix on the Riemannian manifold is used, where the logarithm is applied to each sub-covariance matrices 
                           
                              log
                              (
                              
                                 
                                    C
                                 
                                 
                                    j
                                 
                              
                              )
                           
                        . Since 
                           
                              log
                              (
                              
                                 
                                    C
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         is symmetric, it can be more efficiently represented by the upper triangular 
                           
                              d
                              (
                              d
                              +
                              1
                              )
                              /
                              2
                           
                         elements, 
                           
                              vec
                              (
                              log
                              (
                              
                                 
                                    C
                                 
                                 
                                    j
                                 
                              
                              )
                              )
                              =
                              
                                 
                                    [
                                    log
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    ,
                                    log
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          2
                                          ,
                                          1
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    ,
                                    …
                                    ,
                                    log
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          d
                                          ,
                                          d
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    ]
                                 
                                 
                                    T
                                 
                              
                           
                        . The vector form of the covariance matrix for a candidate object within bounding box is then formed by concatenating 
                           
                              vec
                              (
                              log
                              (
                              
                                 
                                    C
                                 
                                 
                                    j
                                 
                              
                              )
                              )
                              ,
                              
                              j
                              =
                              1
                              ,
                              …
                              ,
                              L
                           
                        , to 
                           
                              vec
                              (
                              log
                              (
                              C
                              )
                              )
                              =
                              
                                 
                                    
                                       
                                          vec
                                          (
                                          log
                                          (
                                          
                                             
                                                C
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          )
                                          ⋯
                                          vec
                                          (
                                          log
                                          (
                                          
                                             
                                                C
                                             
                                             
                                                L
                                             
                                          
                                          )
                                          )
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                           
                        .

The proposed tracking scheme is then compared with 10 existing trackers, including 3 closely-related manifold trackers (T1–T2, T6), 4 non manifold-based trackers (T3–T5, T10), and 3 learned classifier-based trackers (T7–T9), listed below:
                           
                              •
                              Tracker T1 uses covariance-based tracking [6].

Tracker T2 uses probabilistic tracking on the Riemannian manifold [16].

Tracker T3 uses subspace-learning-based tracking [3].

Tracker T4 uses mean shift tracking [9].

Tracker T5 uses CONDENSATION tracking [11].

Tracker T6 uses Grassmann manifold tracking [14].

Tracker T7 uses multiple instance learning (MIL) tracking [29].

Tracker T8 uses Online-AdaBoost (OAB) tracking [28].

Tracker T9 uses FragTrack tracking [27].

Tracker T10 uses vector-space PF online learning and tracking (see the description below).

Tracker T10 can be considered as the corresponding version of the proposed tracker performed in the vector space. In the tracker T10, the covariance matrix is formed in exactly the same way as in the proposed tracker (see Section 4). Differences of tracker T10 to the proposed tracker include: the distance 
                           
                              d
                              (
                              ·
                              ,
                              ·
                              )
                           
                         in the likelihood function (i.e., Eqs. (11) and (22)) is replaced by the Frobenius distance between two covariance matrices 
                           
                              
                                 
                                    d
                                 
                                 
                                    F
                                 
                              
                              (
                              A
                              ,
                              B
                              )
                              =
                              
                                 
                                    trace
                                    (
                                    (
                                    A
                                    -
                                    B
                                    )
                                    
                                    
                                       
                                          (
                                          A
                                          -
                                          B
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    )
                                 
                              
                           
                        , the dynamic model in (8) is defined in the vector space, and the MMSE in (13) is replaced by 
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    obj
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 
                                    ω
                                 
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                           
                         in the vector space. It is worth mentioning that results from these trackers are either obtained from provided/implemented codes where parameters are set according to the description in papers, or set to generate the best tracking results, or in PF tracking case the affine box variances are set to be the same as in Table 2.

In addition to visual inspection of tracking results and comparisons to several existing trackers, quantitative evaluations are performed based on the following 5 objective evaluation criteria:
                           
                              (1)
                              
                                 Euclidean distance: is defined between the four corners of tracked object bounding box and manually marked Ground Truth (GT) box,
                                    
                                       (23)
                                       
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                4
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   4
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                            ,
                                                            1
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            i
                                                            ,
                                                            1
                                                         
                                                         
                                                            GT
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                            ,
                                                            2
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            i
                                                            ,
                                                            2
                                                         
                                                         
                                                            GT
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 where 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             2
                                          
                                       
                                       )
                                       ,
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             i
                                             ,
                                          
                                          
                                             GT
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             i
                                             ,
                                             2
                                          
                                          
                                             GT
                                          
                                       
                                       )
                                    
                                 , are the corners of bounding box.


                                 Mean Square Error (MSE): is defined between each individual parameter in 
                                    
                                       s
                                       
                                          
                                             2
                                          
                                          
                                             t
                                          
                                       
                                    
                                  for tracked object boxes and ground truth boxes over video frames,
                                    
                                       (24)
                                       
                                          
                                             
                                                MSE
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            s
                                                            
                                                               
                                                                  2
                                                               
                                                               
                                                                  t
                                                                  ,
                                                                  i
                                                               
                                                            
                                                            -
                                                            s
                                                            
                                                               
                                                                  2
                                                               
                                                               
                                                                  t
                                                                  ,
                                                                  i
                                                               
                                                               
                                                                  GT
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                          i
                                          =
                                          1
                                          ,
                                          ⋯
                                          ,
                                          6
                                       
                                    
                                 where 
                                    
                                       s
                                       
                                          
                                             2
                                          
                                          
                                             t
                                             ,
                                             i
                                          
                                       
                                    
                                  and 
                                    
                                       s
                                       
                                          
                                             2
                                          
                                          
                                             t
                                             ,
                                             i
                                          
                                          
                                             GT
                                          
                                       
                                    
                                  are the ith component of parameter vector of tracked box and ground truth box at time t, and N is the total number of frames in a video.


                                 Structural Similarity (SSIM): is defined between object images within the tracked box and the ground truth box,
                                    
                                       (25)
                                       
                                          SSIM
                                          (
                                          X
                                          ,
                                          Y
                                          )
                                          =
                                          
                                             
                                                (
                                                2
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      X
                                                   
                                                
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      Y
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                (
                                                2
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      XY
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      X
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      Y
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                (
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      X
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      Y
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 where 
                                    
                                       X
                                       ,
                                       
                                       Y
                                    
                                  are two images within the tracked boxes, 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             X
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             μ
                                          
                                          
                                             Y
                                          
                                       
                                    
                                  are mean values, 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             X
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             Y
                                          
                                          
                                             2
                                          
                                       
                                    
                                  are variances, 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             XY
                                          
                                       
                                    
                                  is the covariance, 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                             L
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                
                                                   k
                                                
                                                
                                                   2
                                                
                                             
                                             L
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                  are two small constants to stabilize the division with a very small denominator value (
                                    
                                       
                                          
                                             k
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0.01
                                       ,
                                       
                                       
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       0.03
                                       ,
                                       
                                       L
                                       =
                                       255
                                    
                                 ). If the tracked object is similar to the corresponding GT object, then SSIM value is large (maximum 1.0), otherwise, small (minimum 0.0). Under this criterion, good performance is indicated by high SSIM values. The average SSIM, 
                                    
                                       
                                          
                                             SSIM
                                          
                                          
                                             avg
                                          
                                       
                                    
                                 , is then computed by averaging the SSIM over all frames in each video.


                                 Bhattacharyya distance: is defined between object images within the tracked box and the ground truth box,
                                    
                                       (26)
                                       
                                          
                                             
                                                d
                                             
                                             
                                                B
                                             
                                          
                                          =
                                          
                                             
                                                1
                                                -
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                                ρ
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      u
                                                   
                                                
                                                ,
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      u
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 where u is the bin index, 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             u
                                          
                                       
                                    
                                  (or 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             u
                                          
                                       
                                    
                                 ) is the histogram of tracked object image (or the ground truth object image). Under this criterion, good performance is indicated by small 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             B
                                          
                                       
                                    
                                  values. The average Bhattacharyya distance is computed over all frames in each video.


                                 Average Tracking Accuracy (ATA): is defined as the ratio of the spatial intersection and union of the ground-truth object and the tracked object over all frames. It is adopted from a PETS2009 evaluation criterion [49]),
                                    
                                       (27)
                                       
                                          ATA
                                          =
                                          
                                             
                                                STDA
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            G
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            D
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 where
                                    
                                       
                                          STDA
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         mapped
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            frames
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      |
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ∩
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      |
                                                   
                                                   
                                                      |
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ∪
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      |
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ∪
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ≠
                                                      0
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 and 
                                    
                                       
                                          
                                             G
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                    
                                  are respectively the 
                                    
                                       i
                                       th
                                    
                                  target ground-truth and the tracked object, and 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             G
                                          
                                          
                                             t
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             D
                                          
                                          
                                             t
                                          
                                       
                                    
                                  are the number of ground-truth and tracked objects at time 
                                    
                                       t
                                       ,
                                       
                                       
                                          
                                             N
                                          
                                          
                                             G
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             D
                                          
                                       
                                    
                                  denote respectively the number of unique ground-truth objects and tracked objects in the video, 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             mapped
                                          
                                       
                                    
                                  is the number of mapped pairs of ground-truth and tracked objects, and 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             frames
                                          
                                       
                                    
                                  is the total number of frames in a video. In our tests, the number of detected object is set i
                                 =1, 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             mapped
                                          
                                       
                                    
                                 =1 (or, 0) if there is a matched (or, no matched) tracked object. The range of ATA is 
                                    
                                       [
                                       0.0
                                       ,
                                       1.0
                                       ]
                                    
                                 , where the highest value 1.0 is related to the best performance.

To examine the performance of the proposed tracker, this subsection includes some tracked video frames for visual inspection. First, tracking results obtained from the proposed tracking scheme on 15 videos are included for visual inspections. Then, corresponding tracking results from some existing trackers are included for visual comparisons. Tracked results from different methods are examined/compared in terms of bounding box area that covers the desired object, tightness of the bounding box to the object, orientation, width and height of the bounding box with respect to the object inside the box, in addition to whether the desired object is tracked. The corresponding figures containing the test results from the proposed tracker/existing trackers in this subsection are summarized in Table 3
                         below.

All these 15 videos contain dynamic objects (e.g. human faces, persons, cars) with significant out-of-plane pose changes. The aim is to test the robustness of the proposed tracker against non-planar complex changes in deformable objects, including large pose changes during the course of continuous motion. For all the results summarized in Table 3, a red color bounding box is used for the proposed tracker. Although only Fig. 8 containing the comparison with T3–T5, the selected “Chia” video os one of the most challenged videos. In all these figures, key video frames or frames from a fixed frame interval are selected.

For testing the proposed tracking scheme, Figs. 4–9
                        
                        
                        
                        
                        
                         show some results from 15 videos, including several large-size video objects in these figures and a figure with zoomed-in details within the tracked box, 3 video results from PETS/CAVIAR dataset (where object size is relatively small), and 3 video results from Jomda/UCSD CAVIAR datasets (see Section 7.1). To compare with other trackers, results from 10 existing trackers are included (see the description in Table 3).

One can see from Fig. 4 that the proposed tracker is very robust with tighter and more accurately tracked boxes and much reduced tracking drift as compared with T1 and T2, despite the large pose change in target objects and severe illumination changes in images. Also, from the zoomed-in results in Fig. 5 on 2 videos, the proposed tracker shows robust performance. Noting the video “Girl” contains fast and significant out-of-plane pose changes, while “Faceocc2” contains significant partial occlusions. Observing Fig. 6, the proposed tracker also shows better tracking results when objects contain large out-of-plane pose changes (e.g.: after woman changes her body pose in #75; after white shirt man changes his pose in #100, 110; after the intersection of 2 men in #110). Furthermore, Fig. 7 shows the results on 5 videos, where frames from the proposed tracker and T7–T9 can be compared on videos “David”, “Girl”, “Faceocc2”, “Surfer” and “Sylvester” (where tracked frames from T7 to T9 are extracted from the figure in [29] and from the videos provided in the website). An additional frame is added in “Faceocc2” (#740) to show the tracking result after the full occlusion, and in “Girl” (#492) to show the tracked box with orientation. Comparing the results in videos and in Fig. 7, the proposed method appears to have provided better results in terms of tightness and/or better orientation of tracked bounding boxes in these tests. It is worth mentioning that the methodology and underlying philosophy in the proposed and these 3 trackers are very different, fair and detailed comparisons would be difficult: the performance of the proposed tracker is largely determined by selecting appropriate models, nonlinear spaces and Bayesian estimation, while tracking-by-detection methods in computer vision (e.g. [29,28]) are much dependent on classifiers and training samples (or, fragmented positive/negative samples) whose performance is impacted by the margin of online trained classifier. Observing the results in Fig. 8, the proposed scheme shows visible improvement in tracking as comparing with T3, T4 and T5, probably due to “Chia” video containing significant out-of-plane pose changes plus significant object deformation. Observing the results in Fig. 9, the proposed scheme has shown much better tracking as compared with the tracker T10 in the vector space, especially in scenarios where a target object experiences significant out-of-plane pose changes. This becomes more obvious when one observes Fig. 12.

@&#PERFORMANCE EVALUATION@&#

In addition to visual inspection/comparision of tracking results, we apply 5 criteria (see Section 7.1) to evaluate the proposed tracker and to compare with several existing trackers. These evaluations are summarized in Table 4
                        .


                        Fig. 10–12
                        
                        
                        , Tables 5–8
                        
                        
                        
                         show the evaluations and comparisons using the five criteria. Further more, Fig. 13
                         shows SSIM values as a function of image frames on two videos.

Comparing the results in all these figures and tables specified in Table 4, the proposed scheme clearly shows better performance on these test videos (i.e., in terms of smaller Euclidean distances, MSEs and Bhattacharyya distances and higher structural similarities) over the existing trackers T1–T6 and T10. Since object appearances change with time, the improvement of tracking is most visible when video frame number (or, time) increases, in which error could accumulate over time if a tracker is not so robust. As mentioned early, online learning and occlusion handling play an important role in preventing tracking drift and maintaining good tracking. Further, observing ATA values on 10 videos in Table 8, the results has provided further and consistent support on the robustness of the proposed tracker. It is worth noting the results in Fig. 12, where the proposed scheme shows much smaller errors, especially in frames where a target object experiences significant out-of-plane pose changes. Also, one can observe that tracking performance has improved much more in video “Danni” as comparing to that in “Car-1” (noting the maximum value in the y-axis). This is probably due to the reason that video ‘Danni’ contains much significant out-of-plane pose changes as compared with the pose changes in ‘Car-1’ (partially turning left and right) in addition to large face size in “Danni”. Fig. 12 provides further support to the idea that the proposed manifold manifold-based tracker is able to significantly improve the performance over non-manifold based trackers (e.g., vector space-based tracker T10), especially in scenarios of large target objects containing significant out-of-plane changes. Further, it is worth mentioning that comparison of MSEs to these methods should only be made on the relevant parameters of box. Since T1, T2, T4 do not estimate the rotation angle of box, T1 and T4 do not estimate the width and height of box, comparisons with these trackers can be made through using the remaining parameters and criteria other than MSEs. All these evaluations have provided consistent support on the robustness of the proposed tracker as compared with the existing trackers T1–T6 and T10.

To further evaluate the performance of online learning and occlusion handling, tests are performed on videos containing large-size objects with significant non-planar pose changes accompanied with long-term partial occlusions. Several partial occlusion videos were semi-synthetically generated by adding an occluding real object image (a book) to the left and top side to partially cover a target human face (up to a maximum of 60% face area) with continuous out-of-plane pose changes. This is designed to test the proposed occlusion handling strategy in online learning. In the best of our knowledge, there is no previous work that handled/tested such complex scenarios by using Riemannian manifold tracking techniques. The test results in this subsection are summarized in Table 9
                        .

Observing the tracking results in Fig. 14
                        , the propose tracker is shown to be robust to long-term partial occlusions in the test videos. Observing the results in Fig. 15
                        , one can see that T1 often partially tracks the object, T2 has drift away and subsequently failed to track the object, while the proposed tracker shows good tracking with visibly better performance in terms of tracking entire object area in the box, and the tightness, orientation, width and height of the tracked box with respect to the target object within the box. Further comparisons can be seen from the results in Fig. 7, in the 4th row (proposed tracker) and 3rd row (T7–T9) containing the “Girl” video frames. Observing Fig. 16
                        , the online learning process is shown to have significantly improved the tracking performance as comparing to that without employing online learning. Further, adding occlusion handling in the online learning process (as comparing with no occlusion handling) has significantly improved the tracking performance on the test videos. All these results have provided further support on the effectiveness of the proposed manifold online learning and occlusion handling process.

Since the number of particles in a particle filter could both impact the tracking performance and speed, we conduct the following tests to examine the influence between the number of particles and tracking performance. In our experiments described in previous subsections, the number of particles were empirically chosen as 
                           
                              
                                 
                                    N
                                 
                                 
                                    1
                                 
                              
                              =
                              400
                           
                         and 
                           
                              
                                 
                                    N
                                 
                                 
                                    2
                                 
                              
                              =
                              600
                           
                        . Using a smaller number of particles could degrade the tracking performance, however, require less computation. Fig. 18
                         shows the average MSE (measured by four corners of tracked and reference boxes), average SSIM (measured by tracked and reference image areas), and average time/frame as a function of reduced percentages of particles (with respect to 
                           
                              (
                              
                                 
                                    N
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    N
                                 
                                 
                                    2
                                 
                              
                              )
                              =
                              (
                              400
                              ,
                              600
                              )
                           
                        , or 100%, used in our experiments). Observing curves in Fig. 18, it is indicated that faster tracking is obtained when the number of particles is reduced, meanwhile the tracking performance is degraded (i.e., increased MSE and decreased SSIM).

The computational time of the proposed scheme is approximately 15s for tracking one frame of video (on average), using our Matlab programs (without optimizing the program codes) in a PC with an Intel Xeon CPU 2GHz and 4GB RAM. The speed is largely constrained by the mappings between the manifold and tangent planes, and also by using our Matlab programs. Table 10
                         shows the execution time that is further split into tracking process and online learning process, as well as the time used in multiple exponential and logarithmic mappings in the learning part.

Results in the table show that manifold learning requires more time (approximately 65% time) than that of tracking. This is due to different computational burden in the learning and tracking parts, where particle filter PF-1 requires more computations due to multiple mappings between manifold candidate points (covariance matrices) and their tangent planes. Results in Table 10 also indicate that exponential and logarithmic mappings take about 85% time in the learning part. It is worth mentioning that relatively slow speed is a common issue in most manifold-based tracking methods probably due to the computational load of mapping functions, which is also confirmed in our tests. Desirable solutions, among others, could be the use of dedicated hardware for computing the manifold mapping functions. Despite its computational speed, manifold tracking remains attractive in terms of its technique and its robust performance in offline processing.

@&#DISCUSSIONS@&#


                        Objects to be tracked: The proposed method is designed for tracking single object through complex scenes at each run. Tracking multiple objects hence needs to run the tracker several times, which is a disadvantage of the method. Further, the initially bounding box for each object is selected manually, in order to limit the scope of this study. Other methods, e.g. HoG (histograms of oriented gradients) [48], could be exploited for detecting objects that enter the image scene.

@&#CONCLUSION@&#

The proposed scheme, consisting of a tracking process and an online domain-shift learning process on the Riemannian manifold with geodesic-based partial occlusion handling, is shown to be effective and very robust for tracking visual and infrared objects. Gabor features extracted from partitioned objects within bounding boxes are effective for describing object appearances in both visual and IR bands. Online domain-shift learning with geodesic distance-based occlusion handling using manifold candidate appearances at each time instant is effective for fast learning of dynamic objects and for mitigating tracking drift, leading to better tracking results. The proposed scheme has visibly improved the performance in terms of reducing tracking drift and tightly tracked object bounding boxes, especially in scenarios when deformable objects are large in size as comparing with the image size, and experience significant out-of-planar pose changes. Comparisons and performance evaluations with ten existing trackers have provided further support to the robustness of the proposed scheme. Computational speed in terms of learning, tracking and mapping functions are also given from our tests, which indicates that efficiently implementing manifold mapping functions (e.g. by dedicated hardware) would be desirable.

@&#REFERENCES@&#

