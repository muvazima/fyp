@&#MAIN-TITLE@&#High throughput resource shared 2D integer transform computation for H.264/MPEG-4 AVC

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Parallel processing of two independent blocks of 
                                 4
                                 ×
                                 4
                               data.


                        
                        
                           
                           High circuit utilization ratio during 2D 
                                 8
                                 ×
                                 8
                               and 
                                 4
                                 ×
                                 4
                               integer transform computation.


                        
                        
                           
                           Data stream processing capability.


                        
                        
                           
                           High throughput.


                        
                        
                           
                           Small gate count.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

DCT

Dual clock architecture

H.264/MPEG-4 AVC

IDCT

Integer transform

Resource sharing

@&#ABSTRACT@&#


               Graphical abstract
               
                  
               
               
                  
               
            

@&#INTRODUCTION@&#

Integer transform based on forward and inverse Discrete Cosine Transform (DCT/IDCT) is employed in the H.264/MPEG-4 advanced video coding (AVC) standard, and it provides a balance between the compression ratio and video degradation due to compression [1,2]. The two-dimensional (2D) 
                        4
                        ×
                        4
                      integer transform allows for faster computation while the 2D 
                        8
                        ×
                        8
                      integer transform offers better compression for high-quality videos [3–5]. Row-column decomposition for DCT computations requires transpose memory, which leads to a larger implementation area and a low computational speed. Various architectures have been proposed to support independent implementation [6,7] as well as variable block size transformations [8,9]. Shared resource architectures and unified transform implementation have been proposed to optimize the area consumption and throughput [10,11], and architectures with a high throughput utilize intermediate memory and thereby require a larger implementation area and power consumption, which in turn limits their applicability in a low-power mobile environment. The matrix arithmetic operations that were described in [12] have been used to present shared resource architecture to achieve a high level of throughput with an optimized area requirement [13]. In [13] resource shared 2D 
                        4
                        ×
                        4
                      and 2D 
                        8
                        ×
                        8
                      integer transform computation were carried out by using a unified pipelined implementation. Although optimized, the structure can process only one block of 
                        4
                        ×
                        4
                      data during 2D 
                        4
                        ×
                        4
                      integer transform computation. During this time, approximately 25% of the circuit was used while the rest of the 75% processed non-useful data. In other words, during the 2D 
                        4
                        ×
                        4
                      integer transform computation, the shared resource architecture in [13] uses less than 50% of its resources, leading to undesirable power usage.

In the proposed architecture, two 
                        4
                        ×
                        4
                      blocks can be processed in parallel to compute their respective 2D 
                        4
                        ×
                        4
                      integer transform by adding data re-arrangement and input/output ordering stages to the 2D 
                        8
                        ×
                        8
                      integer transform. It is shown that by using the hardware of 2D 
                        8
                        ×
                        8
                      integer transform, the 2D 
                        4
                        ×
                        4
                      integer transform of two independent blocks of size 
                        4
                        ×
                        4
                      can be computed. Hence, by sharing the computing resources between the 2D 
                        8
                        ×
                        8
                      integer transform computation and 2D 
                        4
                        ×
                        4
                      integer transform computation the implementation area can be optimized without sacrificing the throughput. To achieve resource sharing data rearrangement blocks are added to the existing 2D 
                        8
                        ×
                        8
                      integer transform computation design. The data re-arrangement and input/output ordering stages do not involve computation and can be merged with their preceding or succeeding stages. This allows the design to achieve a high throughput during the 2D 
                        8
                        ×
                        8
                      integer transform computation and parallel processing of two blocks during the 2D 
                        4
                        ×
                        4
                      integer transform computation. Parallel processing during 2D 
                        4
                        ×
                        4
                      integer transform computations allows for better resource utilization and optimized power consumption. Parallel processing also increases the overall throughput of the 2D 
                        4
                        ×
                        4
                      integer transform computation by 200%. In each stage, the simplified computation allows for the use of a high-frequency clock at each stage to help increase the overall throughput.

The following sections explain the basic operations and structure of the 2D 
                        4
                        ×
                        4
                      and 
                        8
                        ×
                        8
                      integer transform used in H.264. Thereafter, the proposed algorithm and its implementation are presented. Next, a comparison is made with existing systems, and the conclusion is finally presented.

For the H.264/MPEG-4 AVC FRExt, the 2-D forward integer transform is computed using an integer coefficient matrix, 
                        C
                      
                     [7]. Correspondingly, for an 
                        8
                        ×
                        8
                      matrix 
                        
                           
                              X
                           
                           
                              8
                           
                        
                     , the 2-D 
                        8
                        ×
                        8
                      forward transform 
                        
                           
                              Y
                           
                           
                              8
                           
                        
                      is calculated as [7]
                     
                        
                           (1a)
                           
                              
                                 
                                    
                                       Y
                                    
                                    
                                       8
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          C
                                          X
                                       
                                       
                                          8
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          T
                                       
                                    
                                    )
                                 
                                 ⊙
                                 
                                    
                                       E
                                    
                                    
                                       g
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              E
                           
                           
                              g
                           
                        
                      = scaling matrix 
                        
                           
                              E
                           
                           
                              g
                           
                        
                      that is absorbed in the quantization process, “⊙” = element by element multiplication of 
                        
                           
                              E
                           
                           
                              g
                           
                        
                     , 
                        
                           
                              (
                              
                              )
                           
                           
                              T
                           
                        
                      is the matrix transpose operator.
                        
                           
                              
                                 C
                                 =
                                 (
                                 1
                                 /
                                 8
                                 )
                                 ⋅
                                 
                                    [
                                    
                                       
                                          
                                             8
                                             
                                          
                                          
                                             8
                                             
                                          
                                          
                                             8
                                             
                                          
                                          
                                             8
                                             
                                          
                                          
                                             8
                                             
                                          
                                          
                                             8
                                             
                                          
                                          
                                             8
                                             
                                          
                                          
                                             8
                                          
                                       
                                       
                                          
                                             12
                                             
                                          
                                          
                                             10
                                             
                                          
                                          
                                             6
                                             
                                          
                                          
                                             3
                                             
                                          
                                          
                                             −
                                             3
                                             
                                          
                                          
                                             6
                                             
                                          
                                          
                                             −
                                             10
                                             
                                          
                                          
                                             −
                                             12
                                          
                                       
                                       
                                          
                                             8
                                             
                                          
                                          
                                             4
                                             
                                          
                                          
                                             −
                                             4
                                             
                                          
                                          
                                             −
                                             8
                                             
                                          
                                          
                                             −
                                             8
                                             
                                          
                                          
                                             −
                                             4
                                             
                                          
                                          
                                             4
                                             
                                          
                                          
                                             8
                                          
                                       
                                       
                                          
                                             10
                                             
                                          
                                          
                                             −
                                             3
                                             
                                          
                                          
                                             −
                                             12
                                             
                                          
                                          
                                             −
                                             6
                                             
                                          
                                          
                                             6
                                             
                                          
                                          
                                             12
                                             
                                          
                                          
                                             3
                                             
                                          
                                          
                                             −
                                             10
                                          
                                       
                                       
                                          
                                             8
                                             
                                          
                                          
                                             −
                                             8
                                             
                                          
                                          
                                             −
                                             8
                                             
                                          
                                          
                                             8
                                             
                                          
                                          
                                             8
                                             
                                          
                                          
                                             −
                                             8
                                             
                                          
                                          
                                             −
                                             8
                                             
                                          
                                          
                                             8
                                          
                                       
                                       
                                          
                                             6
                                             
                                          
                                          
                                             −
                                             12
                                             
                                          
                                          
                                             3
                                             
                                          
                                          
                                             10
                                             
                                          
                                          
                                             −
                                             10
                                             
                                          
                                          
                                             −
                                             3
                                             
                                          
                                          
                                             12
                                             
                                          
                                          
                                             −
                                             6
                                          
                                       
                                       
                                          
                                             4
                                             
                                          
                                          
                                             −
                                             8
                                             
                                          
                                          
                                             8
                                             
                                          
                                          
                                             −
                                             4
                                             
                                          
                                          
                                             −
                                             4
                                             
                                          
                                          
                                             8
                                             
                                          
                                          
                                             −
                                             8
                                             
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             3
                                             
                                          
                                          
                                             −
                                             6
                                             
                                          
                                          
                                             10
                                             
                                          
                                          
                                             −
                                             12
                                             
                                          
                                          
                                             12
                                             
                                          
                                          
                                             −
                                             10
                                             
                                          
                                          
                                             6
                                             
                                          
                                          
                                             3
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                     
                  

Using matrix product and matrix transpose properties [12], the core equation in Eq. (1a) can be decomposed as
                        
                           (1b)
                           
                              
                                 
                                    
                                       Y
                                    
                                    
                                       8
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       C
                                       
                                          
                                             (
                                             
                                                
                                                   C
                                                   X
                                                
                                                
                                                   8
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 ⊙
                                 
                                    
                                       E
                                    
                                    
                                       g
                                    
                                 
                              
                           
                        
                     
                  

In [9], the linear transformation (see appendix) is used to give the column-wise stacking vector of 
                        
                           
                              X
                           
                           
                              8
                           
                        
                      and 
                        
                           
                              Y
                           
                           
                              8
                           
                        
                     , 
                        
                           
                              X
                           
                           
                              vec
                           
                           
                              8
                           
                        
                      and 
                        
                           
                              Y
                           
                           
                              vec
                           
                           
                              8
                           
                        
                      the forward transform as
                        
                           (2)
                           
                              
                                 (
                                 C
                                 ⊗
                                 C
                                 )
                                 ⋅
                                 
                                    
                                       X
                                    
                                    
                                       vec
                                    
                                    
                                       8
                                    
                                 
                                 =
                                 
                                    
                                       Y
                                    
                                    
                                       vec
                                    
                                    
                                       8
                                    
                                 
                              
                           
                        
                     
                  

The core forward and inverse transforms were further decomposed as
                        
                           (3)
                           
                              
                                 
                                    
                                       (
                                       C
                                       ⊗
                                       C
                                       )
                                       ⋅
                                       
                                          
                                             X
                                          
                                          
                                             vec
                                          
                                          
                                             8
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                   ‾
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   8
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               {
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     4
                                                                  
                                                               
                                                               ⊗
                                                               [
                                                               (
                                                               
                                                                  
                                                                     H
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               ⊕
                                                               
                                                                  
                                                                     Q
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               )
                                                               ⊕
                                                               
                                                                  
                                                                     Q
                                                                  
                                                                  
                                                                     3
                                                                  
                                                               
                                                               }
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            Stage
                                                         
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               7
                                                               ,
                                                               1
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         
                                                            
                                                               {
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     4
                                                                  
                                                               
                                                               ⊗
                                                               [
                                                               (
                                                               
                                                                  
                                                                     H
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               ⊕
                                                               
                                                                  
                                                                     Q
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               )
                                                               ⊕
                                                               
                                                                  
                                                                     Q
                                                                  
                                                                  
                                                                     3
                                                                  
                                                               
                                                               }
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            Stage
                                                         
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               7
                                                               ,
                                                               2
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                   }
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   7
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               [
                                                               (
                                                               
                                                                  
                                                                     H
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               ⊕
                                                               
                                                                  
                                                                     Q
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               )
                                                               ⊗
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     8
                                                                  
                                                               
                                                               ]
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            Stage
                                                         
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               6
                                                               ,
                                                               1
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  Q
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                            ⊗
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  8
                                                               
                                                            
                                                            )
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            Stage
                                                         
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               6
                                                               ,
                                                               2
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                   }
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   6
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            {
                                                            
                                                               
                                                                  
                                                                     
                                                                        {
                                                                        
                                                                           
                                                                              I
                                                                           
                                                                           
                                                                              4
                                                                           
                                                                        
                                                                        ⊗
                                                                        
                                                                           [
                                                                           (
                                                                           
                                                                              
                                                                                 H
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           ⊗
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           )
                                                                           
                                                                              
                                                                                 P
                                                                              
                                                                              
                                                                                 4
                                                                              
                                                                           
                                                                           ⊕
                                                                           
                                                                              
                                                                                 Q
                                                                              
                                                                              
                                                                                 1
                                                                              
                                                                           
                                                                           ]
                                                                        
                                                                        }
                                                                     
                                                                  
                                                                  ︸
                                                               
                                                               
                                                                  
                                                                     Stage
                                                                  
                                                                  
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                     
                                                                        5
                                                                        ,
                                                                        1
                                                                     
                                                                     
                                                                        8
                                                                     
                                                                  
                                                               
                                                            
                                                            ⊕
                                                            
                                                               
                                                                  
                                                                     
                                                                        {
                                                                        
                                                                           
                                                                              I
                                                                           
                                                                           
                                                                              4
                                                                           
                                                                        
                                                                        ⊗
                                                                        
                                                                           [
                                                                           (
                                                                           
                                                                              
                                                                                 H
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           ⊗
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           )
                                                                           
                                                                              
                                                                                 P
                                                                              
                                                                              
                                                                                 4
                                                                              
                                                                           
                                                                           ⊕
                                                                           
                                                                              
                                                                                 Q
                                                                              
                                                                              
                                                                                 1
                                                                              
                                                                           
                                                                           ]
                                                                        
                                                                        }
                                                                     
                                                                  
                                                                  ︸
                                                               
                                                               
                                                                  
                                                                     Stage
                                                                  
                                                                  
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                     
                                                                        5
                                                                        ,
                                                                        2
                                                                     
                                                                     
                                                                        8
                                                                     
                                                                  
                                                               
                                                            
                                                            }
                                                         
                                                      
                                                      ︸
                                                   
                                                   
                                                      
                                                         Stage
                                                      
                                                      
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            5
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               {
                                                               
                                                                  [
                                                                  (
                                                                  
                                                                     
                                                                        H
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  ⊗
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  )
                                                                  
                                                                     
                                                                        P
                                                                     
                                                                     
                                                                        4
                                                                     
                                                                  
                                                                  ]
                                                               
                                                               ⊗
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     8
                                                                  
                                                               
                                                               }
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            Stage
                                                         
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               4
                                                               ,
                                                               1
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  Q
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            ⊗
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  8
                                                               
                                                            
                                                            )
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            Stage
                                                         
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               4
                                                               ,
                                                               2
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                   }
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   4
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⊗
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      32
                                                   
                                                
                                                )
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   3
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      8
                                                   
                                                
                                                ⊗
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⊗
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      4
                                                   
                                                
                                                )
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                   
                                                   ‾
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   1
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             X
                                          
                                          
                                             vec
                                          
                                          
                                             8
                                          
                                       
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              X
                           
                           
                              vec
                           
                           
                              8
                           
                        
                      is the column-wise stacking version of 
                        
                           
                              X
                           
                           
                              8
                           
                        
                     , ⊗ denotes the Kronecker product [12] (see Appendix), ⊕ denotes the direct sum operation [12] (see Appendix), 
                        
                           
                              
                                 
                                    P
                                 
                                 ‾
                              
                           
                           
                              r
                           
                        
                        =
                        
                           
                              P
                           
                           
                              r
                           
                        
                        ⊗
                        
                           
                              P
                           
                           
                              r
                           
                        
                      and 
                        
                           
                              
                                 
                                    P
                                 
                                 ‾
                              
                           
                           
                              c
                           
                        
                        =
                        
                           
                              P
                           
                           
                              c
                           
                        
                        ⊗
                        
                           
                              P
                           
                           
                              c
                           
                        
                     . 
                        
                           
                              I
                           
                           
                              n
                           
                        
                      is the 
                        n
                        ×
                        n
                      identity matrix, and the value of the other matrices is given below.
                        
                           
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             r
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             4
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                       
                                       
                                          
                                             H
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   3
                                                   /
                                                   2
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   −
                                                   3
                                                   /
                                                   2
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   −
                                                   3
                                                   /
                                                   2
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   −
                                                   1
                                                   
                                                
                                                
                                                   3
                                                   /
                                                   2
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   /
                                                   4
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   1
                                                   /
                                                   4
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   −
                                                   1
                                                   /
                                                   4
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   1
                                                   /
                                                   4
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                       
                                       
                                          
                                             Q
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   1
                                                   /
                                                   2
                                                
                                             
                                             
                                                
                                                   1
                                                   /
                                                   2
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                    
                                 
                              
                           
                        
                     
                  

The fractional constants of each stage are shifted to the output, and the forward transform can be given as
                        
                           (4)
                           
                              
                                 
                                    
                                       (
                                       C
                                       ⊗
                                       C
                                       )
                                       ⋅
                                       
                                          
                                             X
                                          
                                          
                                             vec
                                          
                                          
                                             8
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       =
                                       1
                                       /
                                       64
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                   ‾
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   8
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            {
                                                            
                                                               
                                                                  
                                                                     
                                                                        {
                                                                        
                                                                           
                                                                              I
                                                                           
                                                                           
                                                                              4
                                                                           
                                                                        
                                                                        ⊗
                                                                        [
                                                                        2
                                                                        ⋅
                                                                        
                                                                           (
                                                                           2
                                                                           ⋅
                                                                           
                                                                              
                                                                                 H
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           ⊕
                                                                           
                                                                              
                                                                                 Q
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                        ⊕
                                                                        
                                                                           
                                                                              Q
                                                                           
                                                                           
                                                                              3
                                                                           
                                                                           
                                                                              ′
                                                                           
                                                                        
                                                                        }
                                                                     
                                                                  
                                                                  ︸
                                                               
                                                               
                                                                  
                                                                     Stage
                                                                  
                                                                  
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                     
                                                                        7
                                                                        ,
                                                                        1
                                                                     
                                                                     
                                                                        8
                                                                     
                                                                  
                                                               
                                                            
                                                            ⊕
                                                            
                                                               
                                                                  
                                                                     
                                                                        {
                                                                        
                                                                           
                                                                              I
                                                                           
                                                                           
                                                                              4
                                                                           
                                                                        
                                                                        ⊗
                                                                        [
                                                                        2
                                                                        ⋅
                                                                        
                                                                           (
                                                                           2
                                                                           ⋅
                                                                           
                                                                              
                                                                                 H
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           ⊕
                                                                           
                                                                              
                                                                                 Q
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                        ⊕
                                                                        
                                                                           
                                                                              Q
                                                                           
                                                                           
                                                                              3
                                                                           
                                                                           
                                                                              ′
                                                                           
                                                                        
                                                                        }
                                                                     
                                                                  
                                                                  ︸
                                                               
                                                               
                                                                  
                                                                     Stage
                                                                  
                                                                  
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                     
                                                                        7
                                                                        ,
                                                                        2
                                                                     
                                                                     
                                                                        8
                                                                     
                                                                  
                                                               
                                                            
                                                            }
                                                         
                                                      
                                                      ︸
                                                   
                                                   
                                                      
                                                         Stage
                                                      
                                                      
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            7
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            2
                                                            ⋅
                                                            
                                                               [
                                                               
                                                                  (
                                                                  2
                                                                  ⋅
                                                                  
                                                                     
                                                                        H
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  ⊕
                                                                  
                                                                     
                                                                        Q
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                                  )
                                                               
                                                               ⊗
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     8
                                                                  
                                                               
                                                               ]
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            Stage
                                                         
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               6
                                                               ,
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     Q
                                                                  
                                                                  
                                                                     3
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                               ⊗
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     8
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            Stage
                                                         
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               6
                                                               ,
                                                               2
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                   }
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   6
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            {
                                                            
                                                               
                                                                  
                                                                     
                                                                        {
                                                                        
                                                                           
                                                                              I
                                                                           
                                                                           
                                                                              4
                                                                           
                                                                        
                                                                        ⊗
                                                                        
                                                                           [
                                                                           2
                                                                           ⋅
                                                                           (
                                                                           
                                                                              
                                                                                 H
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           ⊗
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           )
                                                                           
                                                                              
                                                                                 P
                                                                              
                                                                              
                                                                                 4
                                                                              
                                                                           
                                                                           ⊕
                                                                           
                                                                              
                                                                                 Q
                                                                              
                                                                              
                                                                                 1
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                           ]
                                                                        
                                                                        }
                                                                     
                                                                  
                                                                  ︸
                                                               
                                                               
                                                                  
                                                                     Stage
                                                                  
                                                                  
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                     
                                                                        5
                                                                        ,
                                                                        1
                                                                     
                                                                     
                                                                        8
                                                                     
                                                                  
                                                               
                                                            
                                                            ⊕
                                                            
                                                               
                                                                  
                                                                     
                                                                        {
                                                                        
                                                                           
                                                                              I
                                                                           
                                                                           
                                                                              4
                                                                           
                                                                        
                                                                        ⊗
                                                                        
                                                                           [
                                                                           2
                                                                           ⋅
                                                                           (
                                                                           
                                                                              
                                                                                 H
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           ⊗
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           )
                                                                           
                                                                              
                                                                                 P
                                                                              
                                                                              
                                                                                 4
                                                                              
                                                                           
                                                                           ⊕
                                                                           
                                                                              
                                                                                 Q
                                                                              
                                                                              
                                                                                 1
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                           ]
                                                                        
                                                                        }
                                                                     
                                                                  
                                                                  ︸
                                                               
                                                               
                                                                  
                                                                     Stage
                                                                  
                                                                  
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                     
                                                                        5
                                                                        ,
                                                                        2
                                                                     
                                                                     
                                                                        8
                                                                     
                                                                  
                                                               
                                                            
                                                            }
                                                         
                                                      
                                                      ︸
                                                   
                                                   
                                                      
                                                         Stage
                                                      
                                                      
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            5
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            2
                                                            ⋅
                                                            
                                                               {
                                                               
                                                                  [
                                                                  (
                                                                  
                                                                     
                                                                        H
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  ⊗
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  )
                                                                  
                                                                     
                                                                        P
                                                                     
                                                                     
                                                                        4
                                                                     
                                                                  
                                                                  ]
                                                               
                                                               ⊗
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     8
                                                                  
                                                               
                                                               }
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            Stage
                                                         
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               4
                                                               ,
                                                               1
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     Q
                                                                  
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                               ⊗
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     8
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            Stage
                                                         
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               4
                                                               ,
                                                               2
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                   }
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   4
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⊗
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      32
                                                   
                                                
                                                )
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   3
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      8
                                                   
                                                
                                                ⊗
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⊗
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      4
                                                   
                                                
                                                )
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                   
                                                   ‾
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   1
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             X
                                          
                                          
                                             vec
                                          
                                          
                                             8
                                          
                                       
                                    
                                 
                              
                           
                        
                      where, 
                        
                           
                              Q
                           
                           
                              1
                           
                        
                        =
                        1
                        /
                        2
                        ⋅
                        
                           
                              Q
                           
                           
                              1
                           
                           
                              ′
                           
                        
                     , 
                        
                           
                              Q
                           
                           
                              2
                           
                        
                        =
                        1
                        /
                        2
                        ⋅
                        
                           
                              Q
                           
                           
                              2
                           
                           
                              ′
                           
                        
                      and 
                        
                           
                              Q
                           
                           
                              3
                           
                        
                        =
                        1
                        /
                        4
                        ⋅
                        
                           
                              Q
                           
                           
                              3
                           
                           
                              ′
                           
                        
                     , and
                        
                           
                              
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   3
                                                   
                                                
                                                
                                                   2
                                                   
                                                
                                                
                                                   2
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   2
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   −
                                                   3
                                                   
                                                
                                                
                                                   −
                                                   2
                                                
                                             
                                             
                                                
                                                   2
                                                   
                                                
                                                
                                                   −
                                                   3
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   2
                                                   
                                                
                                                
                                                   −
                                                   2
                                                   
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                       
                                       
                                          
                                             Q
                                          
                                          
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   2
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   −
                                                   2
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             3
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   4
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   4
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   −
                                                   1
                                                   
                                                
                                                
                                                   4
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   −
                                                   4
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                    
                                 
                              
                           
                        
                     
                  

For H.264/MPEG-4 AVC, the forward 
                        4
                        ×
                        4
                      integer transform of 
                        
                           
                              X
                           
                           
                              4
                           
                        
                     , is given as 
                        
                           
                              Y
                           
                           
                              4
                           
                        
                     , [6]
                     
                        
                           (5a)
                           
                              
                                 
                                    
                                       Y
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          H
                                          X
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          H
                                       
                                       
                                          T
                                       
                                    
                                    )
                                 
                                 ⊙
                                 
                                    
                                       E
                                    
                                    
                                       f
                                    
                                 
                              
                           
                        
                      where,
                        
                           (5b)
                           
                              
                                 
                                    
                                       H
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   2
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   −
                                                   1
                                                   
                                                
                                                
                                                   −
                                                   2
                                                
                                             
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   −
                                                   1
                                                   
                                                
                                                
                                                   −
                                                   1
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   −
                                                   2
                                                   
                                                
                                                
                                                   2
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             f
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                
                                                
                                                   
                                                      a
                                                      b
                                                   
                                                   /
                                                   2
                                                   
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                
                                                
                                                   
                                                      a
                                                      b
                                                   
                                                   /
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      a
                                                      b
                                                   
                                                   /
                                                   2
                                                   
                                                
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   /
                                                   4
                                                   
                                                
                                                
                                                   
                                                      a
                                                      b
                                                   
                                                   /
                                                   2
                                                   
                                                
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   /
                                                   4
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                
                                                
                                                   
                                                      a
                                                      b
                                                   
                                                   /
                                                   2
                                                   
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                
                                                
                                                   
                                                      a
                                                      b
                                                   
                                                   /
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      a
                                                      b
                                                   
                                                   /
                                                   2
                                                   
                                                
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   /
                                                   4
                                                   
                                                
                                                
                                                   
                                                      a
                                                      b
                                                   
                                                   /
                                                   2
                                                   
                                                
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   /
                                                   4
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                    
                                 
                                 
                                    
                                       a
                                       =
                                       1
                                       /
                                       2
                                       ,
                                       
                                       b
                                       =
                                       
                                          
                                             (
                                             2
                                             /
                                             5
                                             )
                                          
                                          
                                             1
                                             /
                                             2
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        
                     
                  

Using transpose property the core equation in Eq. (5a) can be decomposed as
                        
                           (6)
                           
                              
                                 
                                    
                                       Y
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       H
                                       
                                          
                                             (
                                             
                                                
                                                   H
                                                   X
                                                
                                                
                                                   4
                                                
                                             
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 ⊙
                                 
                                    
                                       E
                                    
                                    
                                       f
                                    
                                 
                              
                           
                        
                     
                  

As shown in [6], the core forward transform 
                        (
                        H
                        
                           
                              X
                           
                           
                              4
                           
                        
                        
                           
                              H
                           
                           
                              T
                           
                        
                        )
                      is used as the forward integer transform, and 
                        
                           
                              E
                           
                           
                              f
                           
                        
                      is absorbed in the quantization process. For the column-wise stacking vector of 
                        
                           
                              X
                           
                           
                              4
                           
                        
                      and 
                        
                           
                              Y
                           
                           
                              4
                           
                        
                     , 
                        
                           
                              X
                           
                           
                              vec
                           
                           
                              4
                           
                        
                      and 
                        
                           
                              Y
                           
                           
                              vec
                           
                           
                              4
                           
                        
                     , the forward transform is given as
                        
                           (7)
                           
                              
                                 (
                                 H
                                 ⊗
                                 H
                                 )
                                 ⋅
                                 
                                    
                                       X
                                    
                                    
                                       vec
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 
                                    
                                       Y
                                    
                                    
                                       vec
                                    
                                    
                                       4
                                    
                                 
                              
                           
                        
                     
                  

As shown in [6], the core forward transform is further decomposed as
                        
                           (8)
                           
                              
                                 
                                    
                                       (
                                       H
                                       ⊗
                                       H
                                       )
                                       ⋅
                                       
                                          
                                             X
                                          
                                          
                                             vec
                                          
                                          
                                             4
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   7
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                       
                                          {
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ⊗
                                                      (
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ⊕
                                                      V
                                                      )
                                                   
                                                   ︸
                                                
                                                
                                                   
                                                      Stage
                                                   
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         5
                                                         b
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ⊗
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   )
                                                
                                                ︸
                                             
                                             
                                                
                                                   Stage
                                                
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      5
                                                      a
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          ⊕
                                          
                                             
                                                
                                                   P
                                                   (
                                                   2
                                                   ,
                                                   4
                                                   )
                                                
                                                ︸
                                             
                                             
                                                
                                                   Stage
                                                
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      6
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          [
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ⊗
                                                   V
                                                   )
                                                
                                                ︸
                                             
                                             
                                                
                                                   Stage
                                                
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      5
                                                      d
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ⊗
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                ︸
                                             
                                             
                                                
                                                   Stage
                                                
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      5
                                                      c
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          ⊕
                                          
                                             
                                                
                                                   (
                                                   V
                                                   ⊗
                                                   V
                                                   )
                                                
                                                ︸
                                             
                                             
                                                
                                                   Stage
                                                
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      5
                                                      e
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       
                                          
                                             
                                                P
                                                (
                                                4
                                                ,
                                                2
                                                )
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   4
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                       }
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⊕
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      8
                                                   
                                                
                                                )
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   3
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      4
                                                   
                                                
                                                ⊗
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⊗
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      C
                                                   
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   1
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             X
                                          
                                          
                                             vec
                                          
                                          
                                             4
                                          
                                       
                                    
                                 
                              
                           
                        
                      where, 
                        
                           
                              
                                 
                                    P
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              R
                           
                        
                        =
                        
                           
                              P
                           
                           
                              R
                           
                        
                        ⊗
                        
                           
                              P
                           
                           
                              R
                           
                        
                      and 
                        
                           
                              
                                 
                                    P
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              C
                           
                        
                        =
                        
                           
                              P
                           
                           
                              C
                           
                        
                        ⊗
                        
                           
                              P
                           
                           
                              C
                           
                        
                     , 
                        
                           
                              I
                           
                           
                              n
                           
                        
                        =
                        n
                        ×
                        n
                      identity matrix.
                        
                           (9)
                           
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             R
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          ]
                                       
                                       ,
                                       
                                       
                                          
                                             P
                                          
                                          
                                             C
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                       
                                       V
                                       ⊗
                                       V
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   4
                                                   
                                                
                                                
                                                   2
                                                   
                                                
                                                
                                                   2
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   2
                                                   
                                                
                                                
                                                   −
                                                   4
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   −
                                                   2
                                                
                                             
                                             
                                                
                                                   2
                                                   
                                                
                                                
                                                   1
                                                   
                                                
                                                
                                                   −
                                                   4
                                                   
                                                
                                                
                                                   −
                                                   2
                                                
                                             
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   −
                                                   2
                                                   
                                                
                                                
                                                   −
                                                   2
                                                   
                                                
                                                
                                                   4
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                    
                                 
                                 
                                    
                                       V
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   2
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   −
                                                   2
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                    
                                 
                              
                           
                        
                     
                  

The matrix decomposition shown in Eq. (1a) and (6) can be used to implement a row-column decomposed integer transform computation architecture [14,15]. The basic block diagram of such a system is as shown in Fig. 1
                     .

In this architecture, the input 2D matrix is first processed column wise. The output of select logic goes to the input of the core matrix multiplication circuit 
                        C
                        
                           
                              
                                 Ø
                              
                           
                           
                              i
                           
                        
                     . During this first stage of processing 
                        
                           
                              I
                           
                           
                              sel
                           
                        
                      select signal is set in mode to allow 
                        
                           
                              
                                 Ø
                              
                           
                           
                              i
                           
                        
                      to be 
                        
                           
                              X
                           
                           
                              n
                              ,
                              i
                           
                        
                     . The output of the multiplication circuit is stored in the transpose memory, 
                        
                           
                              T
                           
                           
                              1
                           
                        
                     , to transpose the result of column processing using the output select signal 
                        
                           
                              O
                           
                           
                              e
                              n
                           
                        
                     . After all the columns have been processed the output of the transpose memory is feedback through the select logic. The transpose operation in 
                        
                           
                              T
                           
                           
                              1
                           
                        
                      allows for the row processing. During this second set of processing 
                        
                           
                              I
                           
                           
                              sel
                           
                        
                      select signal is set in the mode to allow 
                        
                           
                              
                                 Ø
                              
                           
                           
                              i
                           
                        
                      to be 
                        
                           
                              T
                           
                           
                              n
                              ,
                              i
                           
                        
                     . After the second set of processing the 
                        
                           
                              O
                           
                           
                              e
                              n
                           
                        
                      signal saves the final result in transpose memory 
                        
                           
                              T
                           
                           
                              2
                           
                        
                     .

The advantage of such scheme is its simplicity. The timing of the 
                        
                           
                              I
                           
                           
                              sel
                           
                        
                      and 
                        
                           
                              O
                           
                           
                              e
                              n
                           
                        
                      select signal can be controlled such that the transpose memory 
                        
                           
                              T
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              T
                           
                           
                              2
                           
                        
                      can be merged. The merging of transpose memory 
                        
                           
                              T
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              T
                           
                           
                              2
                           
                        
                      helps to reduce the implementation hardware. The principle disadvantage of this scheme is that at any given time instance, during first and second stage of processing, only n element vector is processed. For the best case scenario, consider that core matrix multiplication takes only one clock for processing one set of input vector. Let us consider that maximum latency between transpose memory write and read is one clock. Hence, for 2D integer transform computation of 
                        n
                        ×
                        n
                      input matrix, first stage of calculation will require n clocks. Thereafter, 1 clock will be used by the transpose memory 
                        
                           
                              T
                           
                           
                              1
                           
                        
                     . Similarly, second stage of processing will require n clock cycles. Therefore, even in best case scenario, total 
                        2
                        n
                        +
                        1
                      clock cycles will be required to process 
                        n
                        ×
                        n
                      input samples. In actual implementation the core matrix multiplication requires more one than one clock for processing the n element vector. Hence, the final latency is much more than 
                        2
                        n
                        +
                        1
                      in a real design. The 2D integer transform designs based on row-column decomposition architecture must be optimized to meet desired real time latency constrains [14,15]. In terms of implementation, when the intermediate memory, 
                        
                           
                              T
                           
                           
                              1
                           
                        
                     , and the output memory, 
                        
                           
                              T
                           
                           
                              2
                           
                        
                     , are merged, the timing of memory read and write affects the maximum computational speed of the design. Hence the memory merging will also affect the maximum achievable throughput of the system. Many architectures have been proposed to achieve high throughput at the expense of increased hardware or allow multi-transform processing using a unified architecture [3–5,8,9].

In [6,7] and [10], the matrix decomposition of core integer transform used in H.264 is presented. A simplified implementation of design proposed in [6,7] and [10] is shown in Fig. 2
                     .

In [6,7] and [10] it is shown that using matrix manipulation, the 2D integer computation can be broken down in to a sequence of data addition, subtraction and re-arrangement operation. It is shown that 
                        n
                        ×
                        n
                      input samples is converted to a vector with 
                        
                           
                              n
                           
                           
                              2
                           
                        
                      elements which are processed in parallel. The implementation based on [6,7] and [10] will not require transpose memory. Since all the input samples are processed in parallel the throughput of such system is high enough to achieve real time encoding performance. The design proposed in [6,7] and [10] deals with design of 2D 
                        4
                        ×
                        4
                      and 
                        8
                        ×
                        8
                      integer transform separately and hence, the implementation based on these designs will require separate processing units for 2D 
                        4
                        ×
                        4
                      and 
                        8
                        ×
                        8
                      integer transform computation. This will lead to higher area requirement for hardware implementation. On the other hand, while 2D 
                        4
                        ×
                        4
                      integer transform unit is being used 2D 
                        8
                        ×
                        8
                      integer transform unit will remain idle and vice-versa. Hence, if the unused block is not completely disconnected, there will be unnecessary power consumption due to inefficient hardware usage.

The resource sharing architecture presented in [13] describes the method to use the 2D 
                        8
                        ×
                        8
                      integer transform architecture to compute the 2D 
                        4
                        ×
                        4
                      integer transform. The resource sharing version of the 
                        8
                        ×
                        8
                      integer transform can be given as
                        
                           (10)
                           
                              
                                 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             out
                                          
                                          
                                             8
                                          
                                       
                                       =
                                       (
                                       C
                                       ⊗
                                       C
                                       )
                                       ⋅
                                       
                                          
                                             X
                                          
                                          
                                             i
                                             n
                                          
                                       
                                       =
                                       1
                                       /
                                       64
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                   ‾
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   8
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            {
                                                            
                                                               
                                                                  
                                                                     
                                                                        {
                                                                        
                                                                           
                                                                              I
                                                                           
                                                                           
                                                                              4
                                                                           
                                                                        
                                                                        ⊗
                                                                        [
                                                                        2
                                                                        ⋅
                                                                        
                                                                           (
                                                                           2
                                                                           ⋅
                                                                           
                                                                              
                                                                                 H
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           ⊕
                                                                           
                                                                              
                                                                                 Q
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                        ⊕
                                                                        
                                                                           
                                                                              Q
                                                                           
                                                                           
                                                                              3
                                                                           
                                                                           
                                                                              ′
                                                                           
                                                                        
                                                                        }
                                                                     
                                                                  
                                                                  ︸
                                                               
                                                               
                                                                  
                                                                     Stage
                                                                  
                                                                  
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                     
                                                                        7
                                                                        ,
                                                                        1
                                                                     
                                                                     
                                                                        8
                                                                     
                                                                  
                                                               
                                                            
                                                            ⊕
                                                            
                                                               
                                                                  
                                                                     
                                                                        {
                                                                        
                                                                           
                                                                              I
                                                                           
                                                                           
                                                                              4
                                                                           
                                                                        
                                                                        ⊗
                                                                        [
                                                                        2
                                                                        ⋅
                                                                        
                                                                           (
                                                                           2
                                                                           ⋅
                                                                           
                                                                              
                                                                                 H
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           ⊕
                                                                           
                                                                              
                                                                                 Q
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                        ⊕
                                                                        
                                                                           
                                                                              Q
                                                                           
                                                                           
                                                                              3
                                                                           
                                                                           
                                                                              ′
                                                                           
                                                                        
                                                                        }
                                                                     
                                                                  
                                                                  ︸
                                                               
                                                               
                                                                  
                                                                     Stage
                                                                  
                                                                  
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                     
                                                                        7
                                                                        ,
                                                                        2
                                                                     
                                                                     
                                                                        8
                                                                     
                                                                  
                                                               
                                                            
                                                            }
                                                         
                                                      
                                                      ︸
                                                   
                                                   
                                                      
                                                         Stage
                                                      
                                                      
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            7
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            2
                                                            ⋅
                                                            
                                                               [
                                                               
                                                                  (
                                                                  2
                                                                  ⋅
                                                                  
                                                                     
                                                                        H
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  ⊕
                                                                  
                                                                     
                                                                        Q
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                                  )
                                                               
                                                               ⊗
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     8
                                                                  
                                                               
                                                               ]
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            Stage
                                                         
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               6
                                                               ,
                                                               1
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     Q
                                                                  
                                                                  
                                                                     3
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                               ⊗
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     8
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            Stage
                                                         
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               6
                                                               ,
                                                               2
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                   }
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   6
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       
                                          
                                             
                                                ⋅
                                                
                                                   
                                                      
                                                         
                                                            {
                                                            
                                                               
                                                                  
                                                                     
                                                                        {
                                                                        
                                                                           
                                                                              I
                                                                           
                                                                           
                                                                              4
                                                                           
                                                                        
                                                                        ⊗
                                                                        
                                                                           [
                                                                           2
                                                                           ⋅
                                                                           (
                                                                           
                                                                              
                                                                                 H
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           ⊗
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           )
                                                                           
                                                                              
                                                                                 P
                                                                              
                                                                              
                                                                                 4
                                                                              
                                                                           
                                                                           ⊕
                                                                           
                                                                              
                                                                                 Q
                                                                              
                                                                              
                                                                                 1
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                           ]
                                                                        
                                                                        }
                                                                     
                                                                  
                                                                  ︸
                                                               
                                                               
                                                                  
                                                                     Stage
                                                                  
                                                                  
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                     
                                                                        5
                                                                        ,
                                                                        1
                                                                     
                                                                     
                                                                        8
                                                                     
                                                                  
                                                               
                                                            
                                                            ⊕
                                                            
                                                               
                                                                  
                                                                     
                                                                        {
                                                                        
                                                                           
                                                                              I
                                                                           
                                                                           
                                                                              4
                                                                           
                                                                        
                                                                        ⊗
                                                                        
                                                                           [
                                                                           2
                                                                           ⋅
                                                                           (
                                                                           
                                                                              
                                                                                 H
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           ⊗
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           )
                                                                           
                                                                              
                                                                                 P
                                                                              
                                                                              
                                                                                 4
                                                                              
                                                                           
                                                                           ⊕
                                                                           
                                                                              
                                                                                 Q
                                                                              
                                                                              
                                                                                 1
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                           ]
                                                                        
                                                                        }
                                                                     
                                                                  
                                                                  ︸
                                                               
                                                               
                                                                  
                                                                     Stage
                                                                  
                                                                  
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                     
                                                                        5
                                                                        ,
                                                                        2
                                                                     
                                                                     
                                                                        8
                                                                     
                                                                  
                                                               
                                                            
                                                            }
                                                         
                                                      
                                                      ︸
                                                   
                                                   
                                                      
                                                         Stage
                                                      
                                                      
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            5
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            2
                                                            ⋅
                                                            
                                                               {
                                                               
                                                                  [
                                                                  (
                                                                  
                                                                     
                                                                        H
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  ⊗
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  )
                                                                  
                                                                     
                                                                        P
                                                                     
                                                                     
                                                                        4
                                                                     
                                                                  
                                                                  ]
                                                               
                                                               ⊗
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     8
                                                                  
                                                               
                                                               }
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            Stage
                                                         
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               4
                                                               ,
                                                               1
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     Q
                                                                  
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                               ⊗
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     8
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            Stage
                                                         
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               4
                                                               ,
                                                               2
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                   }
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   4
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      4
                                                   
                                                   
                                                      8
                                                   
                                                
                                                (
                                                s
                                                )
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   M
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⊗
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      32
                                                   
                                                
                                                )
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   3
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      8
                                                   
                                                
                                                ⊗
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⊗
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      4
                                                   
                                                
                                                )
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                   
                                                   ‾
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   1
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                s
                                                )
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   M
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             X
                                          
                                          
                                             i
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Similarly, the 
                        4
                        ×
                        4
                      integer transform is given as
                        
                           (11)
                           
                              
                                 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             out
                                          
                                          
                                             4
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       (
                                       H
                                       ⊗
                                       H
                                       )
                                       ⋅
                                       
                                          
                                             X
                                          
                                          
                                             vec
                                          
                                          
                                             4
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       1
                                       /
                                       4
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   7
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   [
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                   ⊕
                                                   P
                                                   (
                                                   2
                                                   ,
                                                   4
                                                   )
                                                   ]
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   6
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       ⋅
                                       
                                          {
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ⊗
                                                      
                                                         (
                                                         4
                                                         
                                                            
                                                               H
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         ⊕
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   ︸
                                                
                                                
                                                   
                                                      Stage
                                                   
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         5
                                                         b
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          ⊕
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ⊗
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                
                                                ︸
                                             
                                             
                                                
                                                   Stage
                                                
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      5
                                                      d
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          ⊕
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ⊗
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                
                                                ︸
                                             
                                             
                                                
                                                   Stage
                                                
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      5
                                                      e
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          }
                                       
                                       ⋅
                                       
                                          
                                             V
                                          
                                          
                                             i
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       2
                                       ⋅
                                       V
                                       ;
                                       
                                       
                                          
                                             V
                                          
                                          
                                             i
                                             n
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                       
                                       
                                          
                                             V
                                          
                                          
                                             a
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                R
                                                r
                                             
                                             
                                                v
                                                o
                                             
                                          
                                          ⋅
                                          
                                             
                                                O
                                             
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                8
                                             
                                          
                                          ]
                                       
                                       /
                                       2
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             O
                                          
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             8
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         O
                                                      
                                                      
                                                         r
                                                         a
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         O
                                                      
                                                      
                                                         r
                                                         b
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                       
                                       
                                          
                                             O
                                          
                                          
                                             r
                                             a
                                          
                                          
                                             8
                                          
                                       
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      (
                                                      1
                                                      )
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      (
                                                      2
                                                      )
                                                      
                                                   
                                                   
                                                      …
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      (
                                                      8
                                                      )
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             T
                                          
                                       
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             O
                                          
                                          
                                             r
                                             b
                                          
                                          
                                             8
                                          
                                       
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      (
                                                      17
                                                      )
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      (
                                                      18
                                                      )
                                                      
                                                   
                                                   
                                                      …
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      (
                                                      24
                                                      )
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             T
                                          
                                       
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             R
                                             r
                                          
                                          
                                             v
                                             o
                                          
                                       
                                       =
                                       
                                          
                                             R
                                             v
                                             t
                                          
                                          
                                             v
                                             o
                                          
                                       
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ;
                                    
                                 
                                 
                                    
                                       i
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       12
                                       ;
                                       
                                       j
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       8
                                       ,
                                       17
                                       ,
                                       18
                                       ,
                                       …
                                       24
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             R
                                             v
                                             t
                                          
                                          
                                             v
                                             o
                                          
                                       
                                       =
                                       
                                          
                                             R
                                          
                                          
                                             v
                                             o
                                          
                                          
                                             T
                                          
                                       
                                       ;
                                       
                                       
                                          
                                             V
                                          
                                          
                                             r
                                          
                                       
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            4
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                      (
                                                      13
                                                      )
                                                      
                                                   
                                                   
                                                      ⋯
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            4
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                      (
                                                      16
                                                      )
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (12)
                           
                              
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       s
                                       )
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                
                                                
                                                   s
                                                   =
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         64
                                                      
                                                   
                                                   
                                                
                                                
                                                   s
                                                   =
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             4
                                          
                                          
                                             8
                                          
                                       
                                       (
                                       s
                                       )
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         4
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                   
                                                
                                                
                                                   s
                                                   =
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         64
                                                      
                                                   
                                                   
                                                
                                                
                                                   s
                                                   =
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (13)
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       n
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   vec
                                                
                                                
                                                   4
                                                
                                             
                                             
                                          
                                          
                                             s
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   vec
                                                
                                                
                                                   8
                                                
                                             
                                             
                                          
                                          
                                             s
                                             =
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                      where 
                        s
                      is the select logic for 
                        4
                        ×
                        4
                      (
                        s
                        =
                        1
                     ) and 
                        8
                        ×
                        8
                      (
                        s
                        =
                        0
                     ) integer transform computations.
                        
                           (14)
                           
                              
                                 
                                    
                                       R
                                    
                                    
                                       4
                                    
                                    
                                       8
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 ]
                              
                           
                        
                      where, 
                        
                           
                              r
                           
                           
                              i
                              j
                           
                        
                        =
                        
                           {
                           
                              
                                 
                                    1
                                    
                                 
                                 
                                    i
                                    =
                                    
                                       
                                          i
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    k
                                    )
                                    ;
                                    
                                    j
                                    =
                                    
                                       
                                          j
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    k
                                    )
                                    ;
                                 
                              
                              
                                 
                                    0
                                    
                                 
                                 
                                    otherwise
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       
                                          
                                             i
                                          
                                          
                                             s
                                          
                                       
                                       =
                                       [
                                       1
                                       ,
                                       2
                                       ,
                                       3
                                       ,
                                       4
                                       ,
                                       25
                                       ,
                                       26
                                       ,
                                       27
                                       ,
                                       28
                                       ,
                                       5
                                       ,
                                       29
                                       ,
                                       33
                                       ,
                                       35
                                       ,
                                       6
                                       ,
                                       30
                                       ,
                                       34
                                       ,
                                       36
                                       ]
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             j
                                          
                                          
                                             s
                                          
                                       
                                       =
                                       [
                                       1
                                       ,
                                       2
                                       ,
                                       5
                                       ,
                                       6
                                       ,
                                       9
                                       ,
                                       10
                                       ,
                                       13
                                       ,
                                       14
                                       ,
                                       33
                                       ,
                                       34
                                       ,
                                       37
                                       ,
                                       38
                                       ,
                                       41
                                       ,
                                       42
                                       ,
                                       45
                                       ,
                                       46
                                       ]
                                       ;
                                    
                                 
                                 
                                    
                                       k
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       16
                                    
                                 
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       β
                                       ⊗
                                       
                                          {
                                          
                                             
                                                I
                                             
                                             
                                                2
                                             
                                          
                                          ⊗
                                          
                                             [
                                             α
                                             ⊗
                                             (
                                             
                                                
                                                   I
                                                
                                                
                                                   2
                                                
                                             
                                             ⊗
                                             α
                                             )
                                             ]
                                          
                                          }
                                       
                                    
                                 
                                 
                                    
                                       β
                                       =
                                       [
                                       
                                          
                                             
                                                1
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                                
                                             
                                             
                                                0
                                             
                                          
                                       
                                       ]
                                       ;
                                       
                                       α
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   1
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   0
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                        
                      and,
                        
                           (15)
                           
                              
                                 
                                    
                                       R
                                    
                                    
                                       o
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   Φ
                                                
                                                
                                                   f
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   Z
                                                
                                                
                                                   48
                                                   ,
                                                   64
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ;
                                 
                                 
                                    
                                       Φ
                                    
                                    
                                       f
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          Φ
                                       
                                       
                                          1
                                       
                                    
                                    ⊗
                                    
                                       (
                                       (
                                       
                                          
                                             I
                                          
                                          
                                             2
                                          
                                       
                                       ⊗
                                       
                                          
                                             Φ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       ⊗
                                       
                                          
                                             I
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             1
                                             
                                          
                                          
                                             0
                                             
                                          
                                          
                                             0
                                             
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                             
                                          
                                          
                                             0
                                             
                                          
                                          
                                             1
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                    ]
                                 
                                 ;
                              
                           
                        
                      
                     
                        
                           
                              Z
                           
                           
                              p
                              ,
                              q
                           
                        
                      is all zero elements matrix of size 
                        p
                        ×
                        q
                     .

The basic implementation scheme based on the design proposed in [13] is shown in Fig. 3
                     .

In H.264, the transform size is based on the size of sub-blocks in the macro-blocks. Once when an 
                        8
                        ×
                        8
                      size sub-block is partitioned, 4 blocks of 
                        4
                        ×
                        4
                      size will be formed. Hence, whenever a block of 
                        4
                        ×
                        4
                      size is processed 3 other blocks of 
                        4
                        ×
                        4
                      size are waiting to be processed. Eqs. (10) and (11) show that the structure presented in [13] utilizes only a portion of the complete circuit when a single block of 
                        4
                        ×
                        4
                      data has been processed for the 2D 
                        4
                        ×
                        4
                      integer transform computation. Since, other blocks of 
                        4
                        ×
                        4
                      size are available, they can be processed in parallel. Hence, to increase the utilization factor, two independent blocks of 
                        4
                        ×
                        4
                      data can be processed for the 2D 
                        4
                        ×
                        4
                      integer transform computation, and this will also increase the throughput for the 2D 
                        4
                        ×
                        4
                      integer transform computation.

As discussed in previous section, the implementation presented in [13] allows resource sharing in 2D 
                        4
                        ×
                        4
                      and 
                        8
                        ×
                        8
                      integer transform computation. The aim of this paper is to show that by using matrix decomposition and data rearrangement operations multiple blocks of 
                        4
                        ×
                        4
                      size can be processed in parallel using the 2D 
                        8
                        ×
                        8
                      integer transform computation circuit. A simplified block diagram of proposed implementation is shown in Fig. 4
                     .

The advantage of proposed implementation is that as compared to existing schemes, the proposed scheme will be able to achieve higher throughput without significant increase in hardware implementation area. In the existing designs only one block of size 
                        4
                        ×
                        4
                      is sent at the input for further processing. However, in the proposed design two blocks of size 
                        4
                        ×
                        4
                      will be processed in parallel. Hence, the difference in the existing and the proposed design will start from the way the input is applied to the system.

In the existing implementation [13], the 
                        4
                        ×
                        4
                      integer transform of one set of 16 pixels can be computed from the 
                        8
                        ×
                        8
                      integer transform by zero-padding the input sample of 16 values to form a 64-element input vector. In most situations, multiple 
                        4
                        ×
                        4
                      blocks are processed during encoding and decoding. Hence, two blocks of dimension 
                        4
                        ×
                        4
                      can be considered to be available and are converted to 16-element vectors, 
                        
                           
                              X
                           
                           
                              A
                              ,
                              
                                 vec
                              
                           
                           
                              4
                           
                        
                      and 
                        
                           
                              X
                           
                           
                              B
                              ,
                              
                                 vec
                              
                           
                           
                              4
                           
                        
                     , for processing. The 
                        4
                        ×
                        4
                      integer transform of 
                        
                           
                              X
                           
                           
                              A
                              ,
                              
                                 vec
                              
                           
                           
                              4
                           
                        
                      and 
                        
                           
                              X
                           
                           
                              B
                              ,
                              
                                 vec
                              
                           
                           
                              4
                           
                        
                      can be computed in parallel using a single butterfly structure of an 
                        8
                        ×
                        8
                      integer transform.

The column-wise stacking vectors 
                           
                              
                                 X
                              
                              
                                 A
                                 ,
                                 
                                    vec
                                 
                              
                              
                                 4
                              
                           
                        , 
                           
                              
                                 X
                              
                              
                                 B
                                 ,
                                 
                                    vec
                                 
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 X
                              
                              
                                 vec
                              
                              
                                 8
                              
                           
                         consist of 16, 16 and 64 elements, respectively. To compute the 
                           4
                           ×
                           4
                         integer transform from the 
                           8
                           ×
                           8
                         integer transform, input 
                           
                              
                                 X
                              
                              
                                 A
                                 ,
                                 
                                    vec
                                 
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 X
                              
                              
                                 B
                                 ,
                                 
                                    vec
                                 
                              
                              
                                 4
                              
                           
                         are concatenated to form a column-wise stacking vector and are then zero padded to obtain 64 element vectors, 
                           
                              
                                 X
                              
                              
                                 4
                                 e
                              
                           
                        , as
                           
                              (16)
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          4
                                          e
                                       
                                    
                                    =
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         A
                                                         ,
                                                         
                                                            vec
                                                         
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         B
                                                         ,
                                                         
                                                            vec
                                                         
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                             
                                          
                                          ]
                                       
                                       
                                          64
                                          ×
                                          1
                                       
                                    
                                 
                              
                           
                        
                     

The output of sections 
                           
                              
                                 S
                              
                              
                                 1
                              
                              
                                 4
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 2
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 3
                              
                              
                                 4
                              
                           
                        , of the 
                           4
                           ×
                           4
                         integer transform, 
                           
                              
                                 O
                              
                              
                                 3
                              
                              
                                 4
                              
                           
                        , are considered to obtain output of sections 
                           
                              
                                 S
                              
                              
                                 1
                              
                              
                                 8
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 2
                              
                              
                                 8
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 3
                              
                              
                                 8
                              
                           
                        , of the 
                           8
                           ×
                           8
                         integer transform, 
                           
                              
                                 O
                              
                              
                                 3
                              
                              
                                 8
                              
                           
                        , as,
                           
                              (17)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          A
                                          B
                                          ,
                                          3
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    
                                       
                                          ψ
                                       
                                       
                                          A
                                          B
                                          ,
                                          3
                                       
                                       
                                          4
                                       
                                    
                                    ⋅
                                    
                                       
                                          X
                                       
                                       
                                          A
                                          B
                                          ,
                                          
                                             vec
                                          
                                       
                                       
                                          4
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          3
                                       
                                       
                                          8
                                       
                                    
                                    =
                                    
                                       
                                          ϕ
                                       
                                       
                                          3
                                       
                                       
                                          8
                                       
                                    
                                    ⋅
                                    
                                       
                                          X
                                       
                                       
                                          vec
                                       
                                       
                                          8
                                       
                                    
                                 
                              
                           
                         where, 
                           
                              
                                 X
                              
                              
                                 A
                                 B
                                 ,
                                 
                                    vec
                                 
                              
                              
                                 4
                              
                           
                           =
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                A
                                                ,
                                                
                                                   vec
                                                
                                             
                                             
                                                4
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                B
                                                ,
                                                
                                                   vec
                                                
                                             
                                             
                                                4
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              
                                 32
                                 ×
                                 1
                              
                           
                        , 
                           
                              
                                 ψ
                              
                              
                                 A
                                 B
                                 ,
                                 3
                              
                              
                                 4
                              
                           
                           =
                           (
                           
                              
                                 ψ
                              
                              
                                 3
                              
                              
                                 4
                              
                           
                           ⊕
                           
                              
                                 ψ
                              
                              
                                 3
                              
                              
                                 4
                              
                           
                           )
                        , 
                           
                              
                                 ψ
                              
                              
                                 3
                              
                              
                                 4
                              
                           
                           =
                           (
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                           ⊕
                           
                              
                                 I
                              
                              
                                 8
                              
                           
                           )
                           ⋅
                           (
                           
                              
                                 I
                              
                              
                                 4
                              
                           
                           ⊗
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                           ⊗
                           
                              
                                 I
                              
                              
                                 2
                              
                           
                           )
                           ⋅
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 C
                              
                           
                         and 
                           
                              
                                 ϕ
                              
                              
                                 3
                              
                              
                                 8
                              
                           
                           =
                           (
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                           ⊕
                           
                              
                                 I
                              
                              
                                 32
                              
                           
                           )
                           ⋅
                           (
                           
                              
                                 I
                              
                              
                                 8
                              
                           
                           ⊗
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                           ⊗
                           
                              
                                 I
                              
                              
                                 4
                              
                           
                           )
                           ⋅
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       c
                                    
                                 
                              
                              ‾
                           
                        .

Eqs. (17) and (18), show that apart from the size of the identity matrix, the other matrices and the operating sequence are identical.

To obtain the zero padded version of 
                           
                              
                                 O
                              
                              
                                 3
                              
                              
                                 4
                              
                           
                        , the zero padded input, 
                           
                              
                                 X
                              
                              
                                 4
                                 e
                              
                           
                        , is pre-multiplied with 
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                         before applying it to stages 
                           
                              
                                 S
                              
                              
                                 1
                              
                              
                                 8
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 2
                              
                              
                                 8
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 3
                              
                              
                                 8
                              
                           
                         of the 
                           8
                           ×
                           8
                         integer transform. The output is again pre-multiplied with matrix 
                           
                              
                                 R
                              
                              
                                 o
                              
                           
                         for output reordering, and in this case, the output of stage 
                           
                              
                                 S
                              
                              
                                 3
                              
                              
                                 8
                              
                           
                         of the 
                           8
                           ×
                           8
                         integer transform is given as
                           
                              (19)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          3
                                       
                                       
                                          4
                                          e
                                       
                                    
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          o
                                       
                                    
                                    ⋅
                                    
                                       
                                          ϕ
                                       
                                       
                                          3
                                       
                                       
                                          8
                                       
                                    
                                    ⋅
                                    
                                       
                                          R
                                       
                                       
                                          i
                                       
                                    
                                    ⋅
                                    
                                       
                                          X
                                       
                                       
                                          4
                                          e
                                       
                                    
                                 
                              
                           
                         where,
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             (
                                             
                                                
                                                   R
                                                
                                                
                                                   i
                                                   ,
                                                   3
                                                
                                             
                                             ⊗
                                             
                                                (
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      i
                                                      ,
                                                      2
                                                   
                                                
                                                ⊗
                                                
                                                   (
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ⊗
                                                   (
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         i
                                                         ,
                                                         1
                                                      
                                                   
                                                   ⊗
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   )
                                                
                                                )
                                             
                                             )
                                          
                                          ;
                                       
                                    
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                i
                                                ,
                                                3
                                             
                                          
                                          =
                                          
                                             [
                                             
                                                
                                                   
                                                      1
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             ]
                                          
                                          ;
                                       
                                    
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                i
                                                ,
                                                2
                                             
                                          
                                          =
                                          
                                             [
                                             
                                                
                                                   
                                                      1
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      1
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      1
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             ]
                                          
                                          ;
                                          
                                          
                                             
                                                R
                                             
                                             
                                                i
                                                ,
                                                1
                                             
                                          
                                          =
                                          
                                             [
                                             
                                                
                                                   
                                                      1
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                              
                           
                         and,
                           
                              (20)
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          o
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             o
                                             ,
                                             3
                                          
                                       
                                       ⊗
                                       
                                          (
                                          
                                             
                                                R
                                             
                                             
                                                o
                                                ,
                                                2
                                             
                                          
                                          ⊗
                                          
                                             (
                                             
                                                
                                                   I
                                                
                                                
                                                   2
                                                
                                             
                                             ⊗
                                             (
                                             
                                                
                                                   R
                                                
                                                
                                                   o
                                                   ,
                                                   1
                                                
                                             
                                             ⊗
                                             
                                                
                                                   I
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             )
                                          
                                          )
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                o
                                                ,
                                                3
                                             
                                          
                                          =
                                          
                                             [
                                             
                                                
                                                   
                                                      1
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             ]
                                          
                                          ;
                                          
                                          
                                             
                                                R
                                             
                                             
                                                o
                                                ,
                                                2
                                             
                                          
                                          =
                                          
                                             [
                                             
                                                
                                                   
                                                      1
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      1
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      1
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             ]
                                          
                                          ;
                                       
                                    
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                o
                                                ,
                                                1
                                             
                                          
                                          =
                                          
                                             [
                                             
                                                
                                                   
                                                      1
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      1
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The 
                           
                              
                                 O
                              
                              
                                 3
                              
                              
                                 4
                                 e
                              
                           
                         that is thus obtained is the zero padded version of 
                           
                              
                                 O
                              
                              
                                 3
                              
                              
                                 4
                              
                           
                         and is given by
                           
                              (21)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          3
                                       
                                       
                                          4
                                          e
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      O
                                                   
                                                   
                                                      A
                                                      B
                                                      ,
                                                      3
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      32
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                 
                              
                           
                         
                        
                           
                              
                                 Z
                              
                              
                                 p
                                 ,
                                 q
                              
                           
                         represents an all zero elements matrix of size 
                           p
                           ×
                           q
                        .

Hence, the zero padded version of 
                           
                              
                                 O
                              
                              
                                 3
                              
                              
                                 4
                              
                           
                        ; the output from stages 
                           
                              
                                 S
                              
                              
                                 1
                              
                              
                                 4
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 2
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 3
                              
                              
                                 4
                              
                           
                         of the 
                           4
                           ×
                           4
                         integer transform; can be obtained from stages 
                           
                              
                                 S
                              
                              
                                 1
                              
                              
                                 8
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 2
                              
                              
                                 8
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 3
                              
                              
                                 8
                              
                           
                         of the 
                           8
                           ×
                           8
                         integer transform.

During the computation of the 
                           8
                           ×
                           8
                         integer transform, the output of stage 
                           
                              
                                 S
                              
                              
                                 3
                              
                              
                                 8
                              
                           
                         is passed directly on to stage 
                           
                              
                                 S
                              
                              
                                 4
                              
                              
                                 8
                              
                           
                        . However, stage 
                           
                              
                                 S
                              
                              
                                 4
                              
                              
                                 4
                              
                           
                         of the 
                           4
                           ×
                           4
                         integer transform re-orders the input vector using a permutation matrix 
                           P
                           (
                           4
                           ,
                           2
                           )
                        . Hence, to compute the 
                           4
                           ×
                           4
                         integer transform by using the 
                           8
                           ×
                           8
                         integer transform, a conditional re-ordering matrix must be inserted between stages 
                           
                              
                                 S
                              
                              
                                 3
                              
                              
                                 8
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 4
                              
                              
                                 8
                              
                           
                         of the 
                           8
                           ×
                           8
                         integer transform.

The output of stage 
                           
                              
                                 S
                              
                              
                                 4
                              
                              
                                 4
                              
                           
                         of the 
                           4
                           ×
                           4
                         integer transform is given by
                           
                              (22)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          4
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    P
                                    (
                                    4
                                    ,
                                    2
                                    )
                                    ⋅
                                    
                                       
                                          O
                                       
                                       
                                          3
                                       
                                       
                                          4
                                       
                                    
                                 
                              
                           
                        
                     

To compute the zero padded version of 
                           
                              
                                 O
                              
                              
                                 4
                              
                              
                                 4
                              
                           
                        , the output of stage 
                           
                              
                                 S
                              
                              
                                 4
                              
                              
                                 8
                              
                           
                        , 
                           
                              
                                 O
                              
                              
                                 3
                              
                              
                                 4
                                 e
                              
                           
                        , is reordered by pre-multiplying it with the reordering matrix 
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         as
                           
                              (23)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          4
                                       
                                       
                                          4
                                          e
                                       
                                    
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          O
                                       
                                       
                                          3
                                       
                                       
                                          4
                                          e
                                       
                                    
                                    ;
                                 
                              
                           
                         where
                           
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    
                                       (
                                       P
                                       (
                                       4
                                       ,
                                       2
                                       )
                                       ⊕
                                       P
                                       (
                                       4
                                       ,
                                       2
                                       )
                                       ⊕
                                       
                                          
                                             Z
                                          
                                          
                                             32
                                          
                                       
                                       )
                                    
                                 
                              
                           
                         with 
                           
                              
                                 Z
                              
                              
                                 n
                              
                           
                         as an all zero elements matrix of size 
                           n
                           ×
                           n
                        .

While computing the 
                           4
                           ×
                           4
                         integer transform, 
                           
                              
                                 O
                              
                              
                                 3
                              
                              
                                 4
                                 e
                              
                           
                         becomes the zero padded version of 
                           
                              
                                 O
                              
                              
                                 3
                              
                              
                                 4
                              
                           
                         and is given by
                           
                              (24)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          4
                                       
                                       
                                          4
                                          e
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      O
                                                   
                                                   
                                                      4
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      32
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                           
                        
                     

Consider that the input to stage 5 of 2D 
                           4
                           ×
                           4
                         integer transform based on Eq. (8) is given by 
                           
                              
                                 v
                              
                              
                                 
                                    in
                                 
                                 ,
                                 5
                              
                           
                           (
                           n
                           )
                        , where 
                           n
                           =
                           1
                         to 16. Eq. (8) for 2D 
                           4
                           ×
                           4
                         integer transform shows that the processing in stage 5 is split into two sub-sections. Sub-section 
                           
                              
                                 S
                              
                              
                                 5
                                 a
                              
                              
                                 4
                              
                           
                         is for processing top 8 inputs to stage 5 i.e. for processing inputs 
                           
                              
                                 v
                              
                              
                                 
                                    in
                                 
                                 ,
                                 5
                              
                           
                           (
                           1
                           )
                         to 
                           
                              
                                 v
                              
                              
                                 
                                    in
                                 
                                 ,
                                 5
                              
                           
                           (
                           8
                           )
                        . Similarly, sub-section 
                           
                              
                                 S
                              
                              
                                 5
                                 b
                              
                              
                                 4
                              
                           
                         is for processing bottom 8 inputs to stage 5 i.e. for processing inputs 
                           
                              
                                 v
                              
                              
                                 
                                    in
                                 
                                 ,
                                 5
                              
                           
                           (
                           9
                           )
                         to 
                           
                              
                                 v
                              
                              
                                 
                                    in
                                 
                                 ,
                                 5
                              
                           
                           (
                           16
                           )
                        . The resource sharing architecture presented in [13] shows that while using the architecture of 2D 
                           8
                           ×
                           8
                         integer transform for the computation of 2D 
                           4
                           ×
                           4
                         integer transform, the computation in sub section 
                           
                              
                                 S
                              
                              
                                 5
                                 b
                              
                              
                                 4
                              
                           
                         is further split in to two sub-sections. One sub-section to process inputs 
                           
                              
                                 v
                              
                              
                                 
                                    in
                                 
                                 ,
                                 5
                              
                           
                           (
                           9
                           )
                         to 
                           
                              
                                 v
                              
                              
                                 
                                    in
                                 
                                 ,
                                 5
                              
                           
                           (
                           12
                           )
                         and another to process inputs 
                           
                              
                                 v
                              
                              
                                 
                                    in
                                 
                                 ,
                                 5
                              
                           
                           (
                           12
                           )
                         to 
                           
                              
                                 v
                              
                              
                                 
                                    in
                                 
                                 ,
                                 5
                              
                           
                           (
                           16
                           )
                        . To simplify the computation and optimize resource sharing the 4 inputs from lower order input, 
                           
                              
                                 v
                              
                              
                                 
                                    in
                                 
                                 ,
                                 5
                              
                           
                           (
                           9
                           )
                         to 
                           
                              
                                 v
                              
                              
                                 
                                    in
                                 
                                 ,
                                 5
                              
                           
                           (
                           12
                           )
                        , were combined with top 8 input samples, 
                           
                              
                                 v
                              
                              
                                 
                                    in
                                 
                                 ,
                                 5
                              
                           
                           (
                           1
                           )
                         to 
                           
                              
                                 v
                              
                              
                                 
                                    in
                                 
                                 ,
                                 5
                              
                           
                           (
                           8
                           )
                        . This combined 12 input sample vector was processed separately from lower order inputs, 
                           
                              
                                 v
                              
                              
                                 
                                    in
                                 
                                 ,
                                 5
                              
                           
                           (
                           13
                           )
                         to 
                           
                              
                                 v
                              
                              
                                 
                                    in
                                 
                                 ,
                                 5
                              
                           
                           (
                           16
                           )
                        . Through this segregation the computation is simplified as processing of input 
                           
                              
                                 v
                              
                              
                                 
                                    in
                                 
                                 ,
                                 5
                              
                           
                           (
                           1
                           )
                         to 
                           
                              
                                 v
                              
                              
                                 
                                    in
                                 
                                 ,
                                 5
                              
                           
                           (
                           12
                           )
                         does not require multiplication with sub-matrix block 
                           (
                           V
                           ⊗
                           V
                           )
                         given in Eq. (9), while the processing of inputs 
                           
                              
                                 v
                              
                              
                                 
                                    in
                                 
                                 ,
                                 5
                              
                           
                           (
                           13
                           )
                         to 
                           
                              
                                 v
                              
                              
                                 
                                    in
                                 
                                 ,
                                 5
                              
                           
                           (
                           16
                           )
                         requires multiplication with sub-matrix block 
                           (
                           V
                           ⊗
                           V
                           )
                         given in Eq. (9).

In the proposed design the input samples from two independent data blocks are processed in parallel during 2D 
                           4
                           ×
                           4
                         integer transform computation. Hence, the 12 sample input vector from both the independent data blocks must be considered. For any input vector 
                           
                              
                                 V
                              
                              
                                 12
                                 ,
                                 1
                              
                           
                         of size 
                           12
                           ×
                           1
                        , the output of stage 
                           
                              
                                 S
                              
                              
                                 5
                                 a
                              
                              
                                 4
                              
                           
                         of the 
                           4
                           ×
                           4
                         integer transform is given by
                           
                              (25a)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          12
                                          ,
                                          1
                                          U
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          2
                                       
                                    
                                    ⊗
                                    
                                       
                                          I
                                       
                                       
                                          4
                                       
                                    
                                    )
                                    
                                       
                                          V
                                       
                                       
                                          12
                                          ,
                                          1
                                          U
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 V
                              
                              
                                 12
                                 ,
                                 1
                                 U
                              
                           
                           (
                           j
                           )
                           =
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                V
                                             
                                             
                                                12
                                                ,
                                                1
                                             
                                          
                                          (
                                          1
                                          )
                                          
                                       
                                       
                                          ⋯
                                          
                                       
                                       
                                          
                                             
                                                V
                                             
                                             
                                                12
                                                ,
                                                1
                                             
                                          
                                          (
                                          8
                                          )
                                       
                                    
                                 
                                 ]
                              
                              
                                 T
                              
                           
                        .

Hence, for the input vectors 
                           
                              
                                 V
                              
                              
                                 12
                                 ,
                                 1
                                 A
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 12
                                 ,
                                 1
                                 B
                              
                           
                         of size 
                           12
                           ×
                           1
                        , associated with the main input vector 
                           
                              
                                 X
                              
                              
                                 A
                                 ,
                                 
                                    vec
                                 
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 X
                              
                              
                                 B
                                 ,
                                 
                                    vec
                                 
                              
                              
                                 4
                              
                           
                        , the output of stage 
                           
                              
                                 S
                              
                              
                                 5
                                 a
                              
                              
                                 4
                              
                           
                         of the 
                           4
                           ×
                           4
                         integer transform is given by
                           
                              (25b)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          12
                                          ,
                                          1
                                          U
                                          A
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          2
                                       
                                    
                                    ⊗
                                    
                                       
                                          I
                                       
                                       
                                          4
                                       
                                    
                                    )
                                    
                                       
                                          V
                                       
                                       
                                          12
                                          ,
                                          1
                                          U
                                          A
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (25c)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          12
                                          ,
                                          1
                                          U
                                          B
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          2
                                       
                                    
                                    ⊗
                                    
                                       
                                          I
                                       
                                       
                                          4
                                       
                                    
                                    )
                                    
                                       
                                          V
                                       
                                       
                                          12
                                          ,
                                          1
                                          U
                                          B
                                       
                                    
                                 
                              
                           
                         where, 
                           
                              
                                 V
                              
                              
                                 12
                                 ,
                                 1
                                 U
                                 A
                              
                           
                           (
                           j
                           )
                           =
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                V
                                             
                                             
                                                12
                                                ,
                                                1
                                                A
                                             
                                          
                                          (
                                          1
                                          )
                                          
                                       
                                       
                                          ⋯
                                          
                                       
                                       
                                          
                                             
                                                V
                                             
                                             
                                                12
                                                ,
                                                1
                                                A
                                             
                                          
                                          (
                                          8
                                          )
                                       
                                    
                                 
                                 ]
                              
                              
                                 T
                              
                           
                        ; 
                           
                              
                                 V
                              
                              
                                 12
                                 ,
                                 1
                                 U
                                 B
                              
                           
                           (
                           j
                           )
                           =
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                V
                                             
                                             
                                                12
                                                ,
                                                1
                                                B
                                             
                                          
                                          (
                                          1
                                          )
                                          
                                       
                                       
                                          ⋯
                                          
                                       
                                       
                                          
                                             
                                                V
                                             
                                             
                                                12
                                                ,
                                                1
                                                B
                                             
                                          
                                          (
                                          8
                                          )
                                       
                                    
                                 
                                 ]
                              
                              
                                 T
                              
                           
                        .

Similarly, the output of stage 
                           
                              
                                 S
                              
                              
                                 5
                                 c
                              
                              
                                 4
                              
                           
                         of the 
                           4
                           ×
                           4
                         integer transform is given by
                           
                              (26a)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          12
                                          ,
                                          1
                                          L
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          2
                                       
                                    
                                    ⊗
                                    
                                       
                                          I
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    
                                       
                                          V
                                       
                                       
                                          12
                                          ,
                                          1
                                          L
                                       
                                    
                                 
                              
                           
                         where, 
                           
                              
                                 V
                              
                              
                                 12
                                 ,
                                 1
                                 L
                              
                           
                           (
                           j
                           )
                           =
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                V
                                             
                                             
                                                12
                                                ,
                                                1
                                             
                                          
                                          (
                                          9
                                          )
                                          
                                       
                                       
                                          ⋯
                                          
                                       
                                       
                                          
                                             
                                                V
                                             
                                             
                                                12
                                                ,
                                                1
                                             
                                          
                                          (
                                          12
                                          )
                                       
                                    
                                 
                                 ]
                              
                              
                                 T
                              
                           
                        .

Therefore, for input vectors 
                           
                              
                                 V
                              
                              
                                 12
                                 ,
                                 1
                                 A
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 12
                                 ,
                                 1
                                 A
                              
                           
                         of size 
                           12
                           ×
                           1
                        , associated with main input vector 
                           
                              
                                 X
                              
                              
                                 A
                                 ,
                                 
                                    vec
                                 
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 X
                              
                              
                                 B
                                 ,
                                 
                                    vec
                                 
                              
                              
                                 4
                              
                           
                        , the output of stage 
                           
                              
                                 S
                              
                              
                                 5
                                 c
                              
                              
                                 4
                              
                           
                         of 
                           4
                           ×
                           4
                         integer transform is given by
                           
                              (26b)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          12
                                          ,
                                          1
                                          L
                                          A
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          2
                                       
                                    
                                    ⊗
                                    
                                       
                                          I
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    
                                       
                                          V
                                       
                                       
                                          12
                                          ,
                                          1
                                          L
                                          A
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (26c)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          12
                                          ,
                                          1
                                          L
                                          B
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          2
                                       
                                    
                                    ⊗
                                    
                                       
                                          I
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    
                                       
                                          V
                                       
                                       
                                          12
                                          ,
                                          1
                                          L
                                          B
                                       
                                    
                                 
                              
                           
                         where, 
                           
                              
                                 V
                              
                              
                                 12
                                 ,
                                 1
                                 L
                                 A
                              
                           
                           (
                           j
                           )
                           =
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                V
                                             
                                             
                                                12
                                                ,
                                                1
                                                A
                                             
                                          
                                          (
                                          9
                                          )
                                          
                                       
                                       
                                          ⋯
                                          
                                       
                                       
                                          
                                             
                                                V
                                             
                                             
                                                12
                                                ,
                                                1
                                                A
                                             
                                          
                                          (
                                          12
                                          )
                                       
                                    
                                 
                                 ]
                              
                              
                                 T
                              
                           
                        ; 
                           
                              
                                 V
                              
                              
                                 12
                                 ,
                                 1
                                 L
                                 B
                              
                           
                           (
                           j
                           )
                           =
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                V
                                             
                                             
                                                12
                                                ,
                                                1
                                                B
                                             
                                          
                                          (
                                          9
                                          )
                                          
                                       
                                       
                                          ⋯
                                          
                                       
                                       
                                          
                                             
                                                V
                                             
                                             
                                                12
                                                ,
                                                1
                                                B
                                             
                                          
                                          (
                                          12
                                          )
                                       
                                    
                                 
                                 ]
                              
                              
                                 T
                              
                           
                        .

The output of stages 
                           
                              
                                 S
                              
                              
                                 5
                                 a
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 5
                                 c
                              
                              
                                 4
                              
                           
                         of the 
                           4
                           ×
                           4
                         integer transform can be obtained simultaneously as
                           
                              (27a)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          12
                                          ,
                                          1
                                          A
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    
                                       [
                                       (
                                       
                                          
                                             H
                                          
                                          
                                             2
                                          
                                       
                                       ⊗
                                       
                                          
                                             I
                                          
                                          
                                             4
                                          
                                       
                                       )
                                       ⊕
                                       (
                                       
                                          
                                             H
                                          
                                          
                                             2
                                          
                                       
                                       ⊗
                                       
                                          
                                             I
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       ]
                                    
                                    
                                       
                                          V
                                       
                                       
                                          12
                                          ,
                                          1
                                          A
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (27b)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          12
                                          ,
                                          1
                                          B
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    
                                       [
                                       (
                                       
                                          
                                             H
                                          
                                          
                                             2
                                          
                                       
                                       ⊗
                                       
                                          
                                             I
                                          
                                          
                                             4
                                          
                                       
                                       )
                                       ⊕
                                       (
                                       
                                          
                                             H
                                          
                                          
                                             2
                                          
                                       
                                       ⊗
                                       
                                          
                                             I
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       ]
                                    
                                    
                                       
                                          V
                                       
                                       
                                          12
                                          ,
                                          1
                                          B
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (28a)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          12
                                          ,
                                          1
                                          A
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      O
                                                   
                                                   
                                                      12
                                                      ,
                                                      1
                                                      U
                                                      A
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      O
                                                   
                                                   
                                                      12
                                                      ,
                                                      1
                                                      L
                                                      A
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                 
                              
                           
                        
                        
                           
                              (28b)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          12
                                          ,
                                          1
                                          B
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      O
                                                   
                                                   
                                                      12
                                                      ,
                                                      1
                                                      U
                                                      B
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      O
                                                   
                                                   
                                                      12
                                                      ,
                                                      1
                                                      L
                                                      B
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                 
                              
                           
                        
                     

The input vectors 
                           
                              
                                 V
                              
                              
                                 12
                                 ,
                                 1
                                 A
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 12
                                 ,
                                 1
                                 B
                              
                           
                         can be zero padded to obtain input vector 
                           
                              
                                 V
                              
                              
                                 32
                                 ,
                                 1
                              
                           
                         of size 
                           32
                           ×
                           1
                         as
                           
                              (29a)
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          32
                                          ,
                                          1
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      12
                                                      ,
                                                      1
                                                      A
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      4
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      12
                                                      ,
                                                      1
                                                      B
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      4
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                 
                              
                           
                        
                     

The zero padded vector version of 
                           
                              
                                 V
                              
                              
                                 32
                                 ,
                                 1
                              
                           
                         with a size of 
                           64
                           ×
                           1
                         is obtained by output re-ordering the stage 4 output of the 
                           8
                           ×
                           8
                         integer transform.
                           
                              (29b)
                              
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      32
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      32
                                                      ,
                                                      e
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          a
                                       
                                    
                                    
                                       
                                          O
                                       
                                       
                                          4
                                       
                                       
                                          4
                                          e
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 V
                              
                              
                                 32
                                 ,
                                 e
                              
                           
                         is the zero padded version of output not included in 
                           
                              
                                 V
                              
                              
                                 32
                                 ,
                                 1
                              
                           
                        .

It can be shown that if the input vector 
                           
                              
                                 V
                              
                              
                                 32
                                 ,
                                 1
                              
                           
                         is rearranged, stage 
                           
                              
                                 S
                              
                              
                                 4
                                 ,
                                 1
                              
                           
                         of the 
                           8
                           ×
                           8
                         integer transform can simultaneously perform the operations in stages 
                           
                              
                                 S
                              
                              
                                 5
                                 a
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 5
                                 c
                              
                              
                                 4
                              
                           
                         of the 
                           4
                           ×
                           4
                         integer transform. To achieve this, the input is pre-multiplied with reordering matrix 
                           
                              
                                 R
                              
                              
                                 b
                              
                           
                        . The re-ordered input 
                           
                              
                                 V
                              
                              
                                 32
                                 ,
                                 r
                              
                           
                        , is given by
                           
                              (30a)
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          32
                                          ,
                                          r
                                       
                                    
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          b
                                       
                                    
                                    
                                       
                                          V
                                       
                                       
                                          32
                                          ,
                                          1
                                       
                                    
                                 
                              
                           
                        
                     

Eqs. (29b) and (30a) are combined to obtain the zero padded vector for the input of the stage 
                           
                              
                                 S
                              
                              
                                 4
                                 ,
                                 1
                              
                           
                         of the 
                           8
                           ×
                           8
                         integer transform, 
                           
                              
                                 V
                              
                              
                                 32
                                 ,
                                 r
                              
                           
                        , as
                           
                              (30b)
                              
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      32
                                                      ,
                                                      r
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      32
                                                      ,
                                                      e
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      b
                                                   
                                                
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      32
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      b
                                                   
                                                
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      32
                                                      ,
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          b
                                       
                                    
                                    ⊕
                                    
                                       
                                          I
                                       
                                       
                                          b
                                       
                                    
                                    )
                                    
                                       
                                          R
                                       
                                       
                                          a
                                       
                                    
                                    
                                       
                                          O
                                       
                                       
                                          4
                                       
                                       
                                          4
                                          e
                                       
                                    
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          O
                                       
                                       
                                          4
                                       
                                       
                                          4
                                          e
                                       
                                    
                                 
                              
                           
                         where,
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                4
                                             
                                          
                                          =
                                          (
                                          
                                             
                                                R
                                             
                                             
                                                b
                                             
                                          
                                          ⊕
                                          
                                             
                                                I
                                             
                                             
                                                b
                                             
                                          
                                          )
                                          
                                             
                                                R
                                             
                                             
                                                a
                                             
                                          
                                          =
                                          (
                                          
                                             
                                                R
                                             
                                             
                                                v
                                             
                                          
                                          ⊕
                                          
                                             
                                                Z
                                             
                                             
                                                24
                                                ,
                                                32
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                v
                                             
                                          
                                          =
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            4
                                                            ,
                                                            1
                                                            ,
                                                            2
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            4
                                                            ,
                                                            3
                                                            ,
                                                            2
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            2
                                                            ,
                                                            1
                                                            ,
                                                            4
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            2
                                                            ,
                                                            5
                                                            ,
                                                            4
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            2
                                                            ,
                                                            2
                                                            ,
                                                            4
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            2
                                                            ,
                                                            6
                                                            ,
                                                            4
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            4
                                                            ,
                                                            2
                                                            ,
                                                            2
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            4
                                                            ,
                                                            4
                                                            ,
                                                            2
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            4
                                                            ,
                                                            2
                                                            ,
                                                            2
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            4
                                                            ,
                                                            4
                                                            ,
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          ;
                                       
                                    
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                s
                                                ,
                                                l
                                                ,
                                                n
                                             
                                          
                                          =
                                          
                                             
                                                W
                                             
                                             
                                                n
                                             
                                          
                                          ⊗
                                          
                                             
                                                I
                                             
                                             
                                                s
                                             
                                          
                                          ;
                                       
                                    
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                n
                                             
                                          
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      1
                                                      
                                                   
                                                   
                                                      i
                                                      =
                                                      l
                                                      /
                                                      n
                                                      ;
                                                      
                                                      j
                                                      =
                                                      
                                                      
                                                         mod
                                                      
                                                      
                                                      (
                                                      l
                                                      /
                                                      n
                                                      )
                                                   
                                                
                                                
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      otherwise
                                                      ;
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

For the re-ordered input vector 
                           
                              
                                 V
                              
                              
                                 32
                                 ,
                                 r
                              
                           
                         the output of stage 
                           
                              
                                 S
                              
                              
                                 4
                                 ,
                                 1
                              
                              
                                 8
                              
                           
                         of the 
                           8
                           ×
                           8
                         integer transform is given by
                           
                              (31)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          r
                                       
                                       
                                          8
                                       
                                    
                                    =
                                    
                                       [
                                       2
                                       ⋅
                                       {
                                       
                                          [
                                          (
                                          
                                             
                                                H
                                             
                                             
                                                2
                                             
                                          
                                          ⊗
                                          
                                             
                                                I
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          
                                             
                                                P
                                             
                                             
                                                4
                                             
                                          
                                          ]
                                       
                                       ⊗
                                       
                                          
                                             I
                                          
                                          
                                             8
                                          
                                       
                                       ]
                                    
                                    
                                       
                                          V
                                       
                                       
                                          32
                                          ,
                                          r
                                       
                                    
                                 
                              
                           
                        
                     

Eqs. (28) and (31) are compared to show that 
                           
                              
                                 O
                              
                              
                                 r
                              
                              
                                 8
                              
                           
                         and 
                           
                              
                                 O
                              
                              
                                 12
                                 ,
                                 1
                              
                              
                                 4
                              
                           
                         are related by
                           
                              (32)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          u
                                          ,
                                          4
                                       
                                       
                                          4
                                          e
                                       
                                    
                                    =
                                    2
                                    ⋅
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      O
                                                   
                                                   
                                                      12
                                                      ,
                                                      1
                                                      A
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      4
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      O
                                                   
                                                   
                                                      12
                                                      ,
                                                      1
                                                      B
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      4
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          v
                                          o
                                       
                                    
                                    
                                       
                                          O
                                       
                                       
                                          r
                                       
                                       
                                          8
                                       
                                    
                                    ;
                                 
                              
                           
                         where,
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                v
                                                o
                                             
                                          
                                          =
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            4
                                                            ,
                                                            1
                                                            ,
                                                            2
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            4
                                                            ,
                                                            3
                                                            ,
                                                            2
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            2
                                                            ,
                                                            1
                                                            ,
                                                            4
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            2
                                                            ,
                                                            5
                                                            ,
                                                            4
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            4
                                                            ,
                                                            2
                                                            ,
                                                            2
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            4
                                                            ,
                                                            4
                                                            ,
                                                            2
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            2
                                                            ,
                                                            2
                                                            ,
                                                            4
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            2
                                                            ,
                                                            6
                                                            ,
                                                            4
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                s
                                                ,
                                                l
                                                ,
                                                n
                                             
                                          
                                          =
                                          
                                             
                                                W
                                             
                                             
                                                n
                                             
                                          
                                          ⊗
                                          
                                             
                                                I
                                             
                                             
                                                s
                                             
                                          
                                          ;
                                       
                                    
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                n
                                             
                                          
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      1
                                                      
                                                   
                                                   
                                                      i
                                                      =
                                                      l
                                                      /
                                                      n
                                                      ;
                                                      
                                                      j
                                                      =
                                                      
                                                      
                                                         mod
                                                      
                                                      
                                                      (
                                                      l
                                                      /
                                                      n
                                                      )
                                                   
                                                
                                                
                                                   
                                                      0
                                                      
                                                   
                                                   
                                                      otherwise
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The computations in stage 
                           
                              
                                 S
                              
                              
                                 5
                                 e
                              
                              
                                 4
                              
                           
                         of the 
                           4
                           ×
                           4
                         integer transform can be carried out by using the 
                           8
                           ×
                           8
                         integer transform. However, this will require significant data re-ordering and additional adders, thereby introducing a significant latency to the output and reducing the overall throughput. Hence, stage 
                           
                              
                                 S
                              
                              
                                 5
                                 e
                              
                              
                                 4
                              
                           
                         of the 
                           4
                           ×
                           4
                         integer transform has been separately implemented to reduce latency. The input for this section will consist of four input values from vector 
                           
                              
                                 O
                              
                              
                                 4
                              
                              
                                 4
                                 e
                              
                           
                        , which correspond to the last four inputs from vector 
                           
                              
                                 O
                              
                              
                                 4
                              
                              
                                 4
                              
                           
                        .

The output of stage 
                           
                              
                                 S
                              
                              
                                 3
                              
                              
                                 8
                              
                           
                         of the 
                           8
                           ×
                           8
                         integer transform provides the input to stages 
                           
                              
                                 S
                              
                              
                                 4
                                 ,
                                 1
                              
                              
                                 8
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 4
                                 ,
                                 2
                              
                              
                                 8
                              
                           
                         of the 
                           8
                           ×
                           8
                         integer transform. Eqs. (30), (31) and (32) are used to show that stage 
                           
                              
                                 S
                              
                              
                                 4
                                 ,
                                 1
                              
                              
                                 8
                              
                           
                         can simultaneously perform the operations from stages 
                           
                              
                                 S
                              
                              
                                 5
                                 a
                              
                              
                                 8
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 5
                                 c
                              
                              
                                 8
                              
                           
                         of the 
                           4
                           ×
                           4
                         integer transform. During this computation period, stage 
                           
                              
                                 S
                              
                              
                                 4
                                 ,
                                 2
                              
                              
                                 8
                              
                           
                         of the 
                           8
                           ×
                           8
                         integer transform remains idle. Eqs. (31) and (32) show that 
                           
                              
                                 S
                              
                              
                                 4
                                 ,
                                 1
                              
                              
                                 8
                              
                           
                         can perform simultaneous calculations when the input has been arranged as 
                           
                              
                                 V
                              
                              
                                 r
                              
                           
                        . To construct 
                           
                              
                                 V
                              
                              
                                 r
                              
                           
                        , vector 
                           
                              
                                 V
                              
                              
                                 32
                                 ,
                                 1
                              
                           
                         is required, which in turn requires vector 
                           
                              
                                 V
                              
                              
                                 12
                                 ,
                                 1
                              
                           
                        . A zero padded version of 
                           
                              
                                 V
                              
                              
                                 32
                                 ,
                                 1
                              
                           
                         can be obtained from 
                           
                              
                                 O
                              
                              
                                 3
                              
                              
                                 4
                                 e
                              
                           
                         as
                           
                              (33)
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          v
                                       
                                       
                                          8
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      32
                                                      ,
                                                      r
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      32
                                                      ,
                                                      e
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          O
                                       
                                       
                                          4
                                       
                                       
                                          4
                                          e
                                       
                                    
                                    ;
                                 
                              
                           
                         where,
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                V
                                             
                                             
                                                32
                                                ,
                                                e
                                             
                                          
                                          =
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            4
                                                            ,
                                                            1
                                                            A
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            4
                                                            ,
                                                            1
                                                            B
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            24
                                                            ,
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          ;
                                       
                                    
                                    
                                       
                                          
                                             
                                                V
                                             
                                             
                                                4
                                                ,
                                                1
                                                A
                                             
                                          
                                          (
                                          j
                                          )
                                          =
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               12
                                                               ,
                                                               1
                                                               A
                                                            
                                                         
                                                         (
                                                         13
                                                         )
                                                         
                                                      
                                                      
                                                         ⋯
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               12
                                                               ,
                                                               1
                                                               A
                                                            
                                                         
                                                         (
                                                         16
                                                         )
                                                      
                                                   
                                                
                                                ]
                                             
                                             
                                                T
                                             
                                          
                                          ;
                                       
                                    
                                    
                                       
                                          
                                             
                                                V
                                             
                                             
                                                4
                                                ,
                                                1
                                                B
                                             
                                          
                                          (
                                          j
                                          )
                                          =
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               12
                                                               ,
                                                               1
                                                               B
                                                            
                                                         
                                                         (
                                                         13
                                                         )
                                                         
                                                      
                                                      
                                                         ⋯
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               12
                                                               ,
                                                               1
                                                               B
                                                            
                                                         
                                                         (
                                                         16
                                                         )
                                                      
                                                   
                                                
                                                ]
                                             
                                             
                                                T
                                             
                                          
                                          ;
                                       
                                    
                                 
                              
                           
                        
                     


                        
                           
                              
                                 V
                              
                              
                                 32
                                 ,
                                 r
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 32
                                 ,
                                 e
                              
                           
                         are the input vectors of stages 
                           
                              
                                 S
                              
                              
                                 4
                                 ,
                                 1
                              
                              
                                 8
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 4
                                 ,
                                 2
                              
                              
                                 8
                              
                           
                         of the 
                           8
                           ×
                           8
                         integer transform. Based on the previous discussion, stage 
                           
                              
                                 S
                              
                              
                                 4
                                 ,
                                 2
                              
                              
                                 8
                              
                           
                         of the 
                           8
                           ×
                           8
                         integer transform is known to remain idle, and the inputs, 
                           
                              
                                 V
                              
                              
                                 4
                                 ,
                                 1
                              
                           
                        , corresponding to the last four outputs of stage 
                           
                              
                                 S
                              
                              
                                 4
                              
                              
                                 4
                              
                           
                         of the 
                           4
                           ×
                           4
                         integer transform can be given to stage 
                           
                              
                                 S
                              
                              
                                 5
                                 e
                              
                              
                                 4
                              
                           
                         of the 
                           4
                           ×
                           4
                         integer transform, which has been implemented separately.

Finally, Eqs. (19), (23), (30), (31) and (33) are used to give the combined input to stages 
                           
                              
                                 S
                              
                              
                                 4
                                 ,
                                 1
                              
                              
                                 8
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 4
                                 ,
                                 2
                              
                              
                                 8
                              
                           
                         of the 
                           8
                           ×
                           8
                         integer transform, 
                           
                              
                                 V
                              
                              
                                 4
                              
                              
                                 8
                              
                           
                         as
                           
                              (34)
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          4
                                       
                                       
                                          8
                                       
                                    
                                    =
                                    
                                       
                                          O
                                       
                                       
                                          v
                                       
                                       
                                          8
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      32
                                                      ,
                                                      r
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      32
                                                      ,
                                                      e
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          O
                                       
                                       
                                          4
                                       
                                       
                                          4
                                          e
                                       
                                    
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          o
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          3
                                       
                                       
                                          8
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          4
                                          e
                                       
                                    
                                    ;
                                 
                              
                           
                        
                     

To obtain a smaller latency, all re-ordering matrices can be combined in one single re-ordering matrix 
                           
                              
                                 R
                              
                              
                                 4
                              
                              
                                 8
                              
                           
                         given by
                           
                              (35)
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          4
                                       
                                       
                                          8
                                       
                                    
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          o
                                       
                                    
                                 
                              
                           
                        
                     

Eq. (35) is solved to give the reordering matrix 
                           
                              
                                 R
                              
                              
                                 4
                              
                              
                                 8
                              
                           
                         as
                           
                              (36)
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          4
                                       
                                       
                                          8
                                       
                                    
                                    =
                                    [
                                    
                                       
                                          r
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    ]
                                 
                              
                           
                         where 
                           
                              
                                 r
                              
                              
                                 i
                                 j
                              
                           
                           =
                           
                              {
                              
                                 
                                    
                                       1
                                       
                                    
                                    
                                       i
                                       =
                                       
                                          
                                             i
                                          
                                          
                                             s
                                          
                                       
                                       (
                                       k
                                       )
                                       ;
                                       
                                       j
                                       =
                                       
                                          
                                             j
                                          
                                          
                                             s
                                          
                                       
                                       (
                                       k
                                       )
                                       ;
                                    
                                 
                                 
                                    
                                       0
                                       
                                    
                                    
                                       otherwise
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   =
                                                   [
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   3
                                                   ,
                                                   4
                                                   ,
                                                   25
                                                   ,
                                                   26
                                                   ,
                                                   27
                                                   ,
                                                   28
                                                   ,
                                                   5
                                                   ,
                                                   6
                                                   ,
                                                   7
                                                   ,
                                                   8
                                                   ,
                                                   29
                                                   ,
                                                   30
                                                   ,
                                                   31
                                                   ,
                                                   32
                                                   ,
                                                   9
                                                   ,
                                                   17
                                                   ,
                                                   33
                                                   ,
                                                
                                             
                                             
                                                
                                                
                                                   35
                                                   ,
                                                   10
                                                   ,
                                                   18
                                                   ,
                                                   34
                                                   ,
                                                   36
                                                   ,
                                                   11
                                                   ,
                                                   19
                                                   ,
                                                   37
                                                   ,
                                                   39
                                                   ,
                                                   12
                                                   ,
                                                   20
                                                   ,
                                                   38
                                                   ,
                                                   40
                                                   ]
                                                   ;
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   =
                                                   [
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   5
                                                   ,
                                                   6
                                                   ,
                                                   9
                                                   ,
                                                   10
                                                   ,
                                                   13
                                                   ,
                                                   14
                                                   ,
                                                   17
                                                   ,
                                                   18
                                                   ,
                                                   21
                                                   ,
                                                   22
                                                   ,
                                                   25
                                                   ,
                                                   26
                                                   ,
                                                   29
                                                   ,
                                                   30
                                                   ,
                                                   33
                                                   ,
                                                
                                             
                                             
                                                
                                                
                                                   34
                                                   ,
                                                   37
                                                   ,
                                                   38
                                                   ,
                                                   41
                                                   ,
                                                   42
                                                   ,
                                                   45
                                                   ,
                                                   46
                                                   ,
                                                   49
                                                   ,
                                                   50
                                                   ,
                                                   53
                                                   ,
                                                   54
                                                   ,
                                                   57
                                                   ,
                                                   58
                                                   ,
                                                   61
                                                   ,
                                                   62
                                                   ]
                                                   ;
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          k
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          32
                                       
                                    
                                 
                              
                           
                        
                     

It should be noted that the original 
                           4
                           ×
                           4
                         and 
                           8
                           ×
                           8
                         integer transform do not contain the matrices introduced in Section 4. These matrices are part of the proposed work where matrices 
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 R
                              
                              
                                 4
                              
                              
                                 8
                              
                           
                         are added to the existing 
                           8
                           ×
                           8
                         transform architecture to obtain a partial result for the 
                           4
                           ×
                           4
                         integer 2D DCT computation.

As shown in Ref. [13], sections 
                        
                           
                              S
                           
                           
                              5
                              b
                           
                           
                              4
                           
                        
                      and 
                        
                           
                              S
                           
                           
                              5
                              d
                           
                           
                              4
                           
                        
                      of the 
                        4
                        ×
                        4
                      integer transform are independently implemented to achieve a high throughput. Sections 
                        
                           
                              S
                           
                           
                              6
                           
                           
                              4
                           
                        
                      and 
                        
                           
                              S
                           
                           
                              7
                           
                           
                              4
                           
                        
                      of the 
                        4
                        ×
                        4
                      integer transform perform an input re-ordering without any computations, and thus, they are independently implemented using output buffers.

From previous sections, re-ordering matrices 
                        
                           
                              R
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              R
                           
                           
                              4
                           
                           
                              8
                           
                        
                      are inserted before stages 
                        
                           
                              S
                           
                           
                              1
                           
                           
                              8
                           
                        
                      and 
                        
                           
                              S
                           
                           
                              4
                           
                           
                              8
                           
                        
                     , respectively, in the 
                        8
                        ×
                        8
                      integer transform to allow the computation of the 
                        4
                        ×
                        4
                      integer transform from the same circuit. These matrices are bypassed or treated as identity matrices during the 
                        8
                        ×
                        8
                      integer transform computation. Hence, for the actual implementation, 
                        
                           
                              R
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              R
                           
                           
                              4
                           
                           
                              8
                           
                        
                      are changed to 
                        
                           
                              R
                           
                           
                              i
                           
                        
                        (
                        s
                        )
                      and 
                        
                           
                              R
                           
                           
                              4
                           
                           
                              8
                           
                        
                        (
                        s
                        )
                     , respectively, and are defined as
                        
                           (37)
                           
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   i
                                                
                                             
                                             
                                          
                                          
                                             s
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   64
                                                
                                             
                                             
                                          
                                          
                                             s
                                             =
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (38)
                           
                              
                                 
                                    
                                       R
                                    
                                    
                                       4
                                    
                                    
                                       8
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   4
                                                
                                                
                                                   8
                                                
                                             
                                             
                                          
                                          
                                             s
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   64
                                                
                                             
                                             
                                          
                                          
                                             s
                                             =
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                      where, 
                        s
                      is the select logic for 
                        4
                        ×
                        4
                      (
                        s
                        =
                        1
                     ) and 
                        8
                        ×
                        8
                      (
                        s
                        =
                        0
                     ) integer transform computations.

Finally, Eqs. (15), (19), (23), (32), (33), (34), (35), (37), and (38) are used to give the shared resource version of the 
                        8
                        ×
                        8
                      integer transform as
                        
                           (39)
                           
                              
                                 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             out
                                          
                                          
                                             8
                                          
                                       
                                       =
                                       (
                                       C
                                       ⊗
                                       C
                                       )
                                       ⋅
                                       
                                          
                                             X
                                          
                                          
                                             i
                                             n
                                          
                                       
                                       =
                                       1
                                       /
                                       64
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                   ‾
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   8
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            {
                                                            
                                                               
                                                                  
                                                                     
                                                                        {
                                                                        
                                                                           
                                                                              I
                                                                           
                                                                           
                                                                              4
                                                                           
                                                                        
                                                                        ⊗
                                                                        [
                                                                        2
                                                                        ⋅
                                                                        
                                                                           (
                                                                           2
                                                                           ⋅
                                                                           
                                                                              
                                                                                 H
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           ⊕
                                                                           
                                                                              
                                                                                 Q
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                        ⊕
                                                                        
                                                                           
                                                                              Q
                                                                           
                                                                           
                                                                              3
                                                                           
                                                                           
                                                                              ′
                                                                           
                                                                        
                                                                        }
                                                                     
                                                                  
                                                                  ︸
                                                               
                                                               
                                                                  
                                                                     Stage
                                                                  
                                                                  
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                     
                                                                        7
                                                                        ,
                                                                        1
                                                                     
                                                                     
                                                                        8
                                                                     
                                                                  
                                                               
                                                            
                                                            ⊕
                                                            
                                                               
                                                                  
                                                                     
                                                                        {
                                                                        
                                                                           
                                                                              I
                                                                           
                                                                           
                                                                              4
                                                                           
                                                                        
                                                                        ⊗
                                                                        [
                                                                        2
                                                                        ⋅
                                                                        
                                                                           (
                                                                           2
                                                                           ⋅
                                                                           
                                                                              
                                                                                 H
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           ⊕
                                                                           
                                                                              
                                                                                 Q
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                        ⊕
                                                                        
                                                                           
                                                                              Q
                                                                           
                                                                           
                                                                              3
                                                                           
                                                                           
                                                                              ′
                                                                           
                                                                        
                                                                        }
                                                                     
                                                                  
                                                                  ︸
                                                               
                                                               
                                                                  
                                                                     Stage
                                                                  
                                                                  
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                     
                                                                        7
                                                                        ,
                                                                        2
                                                                     
                                                                     
                                                                        8
                                                                     
                                                                  
                                                               
                                                            
                                                            }
                                                         
                                                      
                                                      ︸
                                                   
                                                   
                                                      
                                                         Stage
                                                      
                                                      
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            7
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            2
                                                            ⋅
                                                            
                                                               [
                                                               
                                                                  (
                                                                  2
                                                                  ⋅
                                                                  
                                                                     
                                                                        H
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  ⊕
                                                                  
                                                                     
                                                                        Q
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                                  )
                                                               
                                                               ⊗
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     8
                                                                  
                                                               
                                                               ]
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            Stage
                                                         
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               6
                                                               ,
                                                               1
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     Q
                                                                  
                                                                  
                                                                     3
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                               ⊗
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     8
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            Stage
                                                         
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               6
                                                               ,
                                                               2
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                   }
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   6
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            {
                                                            
                                                               
                                                                  
                                                                     
                                                                        {
                                                                        
                                                                           
                                                                              I
                                                                           
                                                                           
                                                                              4
                                                                           
                                                                        
                                                                        ⊗
                                                                        
                                                                           [
                                                                           2
                                                                           ⋅
                                                                           (
                                                                           
                                                                              
                                                                                 H
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           ⊗
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           )
                                                                           
                                                                              
                                                                                 P
                                                                              
                                                                              
                                                                                 4
                                                                              
                                                                           
                                                                           ⊕
                                                                           
                                                                              
                                                                                 Q
                                                                              
                                                                              
                                                                                 1
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                           ]
                                                                        
                                                                        }
                                                                     
                                                                  
                                                                  ︸
                                                               
                                                               
                                                                  
                                                                     Stage
                                                                  
                                                                  
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                     
                                                                        5
                                                                        ,
                                                                        1
                                                                     
                                                                     
                                                                        8
                                                                     
                                                                  
                                                               
                                                            
                                                            ⊕
                                                            
                                                               
                                                                  
                                                                     
                                                                        {
                                                                        
                                                                           
                                                                              I
                                                                           
                                                                           
                                                                              4
                                                                           
                                                                        
                                                                        ⊗
                                                                        
                                                                           [
                                                                           2
                                                                           ⋅
                                                                           (
                                                                           
                                                                              
                                                                                 H
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           ⊗
                                                                           
                                                                              
                                                                                 I
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                           )
                                                                           
                                                                              
                                                                                 P
                                                                              
                                                                              
                                                                                 4
                                                                              
                                                                           
                                                                           ⊕
                                                                           
                                                                              
                                                                                 Q
                                                                              
                                                                              
                                                                                 1
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                           ]
                                                                        
                                                                        }
                                                                     
                                                                  
                                                                  ︸
                                                               
                                                               
                                                                  
                                                                     Stage
                                                                  
                                                                  
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                     
                                                                        5
                                                                        ,
                                                                        2
                                                                     
                                                                     
                                                                        8
                                                                     
                                                                  
                                                               
                                                            
                                                            }
                                                         
                                                      
                                                      ︸
                                                   
                                                   
                                                      
                                                         Stage
                                                      
                                                      
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            5
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            2
                                                            ⋅
                                                            
                                                               {
                                                               
                                                                  [
                                                                  (
                                                                  
                                                                     
                                                                        H
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  ⊗
                                                                  
                                                                     
                                                                        I
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  )
                                                                  
                                                                     
                                                                        P
                                                                     
                                                                     
                                                                        4
                                                                     
                                                                  
                                                                  ]
                                                               
                                                               ⊗
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     8
                                                                  
                                                               
                                                               }
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            Stage
                                                         
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               4
                                                               ,
                                                               1
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                   ⊕
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     Q
                                                                  
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                               ⊗
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     8
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         ︸
                                                      
                                                      
                                                         
                                                            Stage
                                                         
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               4
                                                               ,
                                                               2
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                   }
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   4
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      4
                                                   
                                                   
                                                      8
                                                   
                                                
                                                (
                                                s
                                                )
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   M
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                       ⋅
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⊗
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      32
                                                   
                                                
                                                )
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   3
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      8
                                                   
                                                
                                                ⊗
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⊗
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      4
                                                   
                                                
                                                )
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                   
                                                   ‾
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   1
                                                
                                                
                                                   8
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                s
                                                )
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   M
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             X
                                          
                                          
                                             i
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (40)
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       n
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   4
                                                   e
                                                
                                             
                                             
                                          
                                          
                                             s
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   vec
                                                
                                                
                                                   8
                                                
                                             
                                             
                                          
                                          
                                             s
                                             =
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Similarly, the 
                        4
                        ×
                        4
                      integer transform is given as
                        
                           (41a)
                           
                              
                                 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             
                                                out
                                             
                                             ,
                                             A
                                          
                                          
                                             4
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       (
                                       H
                                       ⊗
                                       H
                                       )
                                       ⋅
                                       
                                          
                                             X
                                          
                                          
                                             
                                                vec
                                             
                                             ,
                                             A
                                          
                                          
                                             4
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       1
                                       /
                                       4
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   7
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   [
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                   ⊕
                                                   P
                                                   (
                                                   2
                                                   ,
                                                   4
                                                   )
                                                   ]
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   6
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       ⋅
                                       
                                          {
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ⊗
                                                      
                                                         (
                                                         4
                                                         
                                                            
                                                               H
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         ⊕
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   ︸
                                                
                                                
                                                   
                                                      Stage
                                                   
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         5
                                                         b
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          ⊕
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ⊗
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                
                                                ︸
                                             
                                             
                                                
                                                   Stage
                                                
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      5
                                                      d
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          ⊕
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ⊗
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                
                                                ︸
                                             
                                             
                                                
                                                   Stage
                                                
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      5
                                                      e
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          }
                                       
                                       ⋅
                                       
                                          
                                             V
                                          
                                          
                                             i
                                             n
                                             ,
                                             A
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (41b)
                           
                              
                                 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             
                                                out
                                             
                                             ,
                                             B
                                          
                                          
                                             4
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       (
                                       H
                                       ⊗
                                       H
                                       )
                                       ⋅
                                       
                                          
                                             X
                                          
                                          
                                             
                                                vec
                                             
                                             ,
                                             B
                                          
                                          
                                             4
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       1
                                       /
                                       4
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   7
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   [
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                   ⊕
                                                   P
                                                   (
                                                   2
                                                   ,
                                                   4
                                                   )
                                                   ]
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                Stage
                                             
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   6
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       ⋅
                                       
                                          {
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ⊗
                                                      
                                                         (
                                                         4
                                                         
                                                            
                                                               H
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         ⊕
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   ︸
                                                
                                                
                                                   
                                                      Stage
                                                   
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         5
                                                         b
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          ⊕
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ⊗
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                
                                                ︸
                                             
                                             
                                                
                                                   Stage
                                                
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      5
                                                      d
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          ⊕
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ⊗
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                
                                                ︸
                                             
                                             
                                                
                                                   Stage
                                                
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      5
                                                      e
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          }
                                       
                                       ⋅
                                       
                                          
                                             V
                                          
                                          
                                             i
                                             n
                                             ,
                                             B
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             i
                                             n
                                             ,
                                             A
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         u
                                                         ,
                                                         A
                                                      
                                                   
                                                   (
                                                   i
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         l
                                                         ,
                                                         A
                                                      
                                                   
                                                   (
                                                   j
                                                   )
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                       
                                       
                                          
                                             V
                                          
                                          
                                             i
                                             n
                                             ,
                                             B
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         u
                                                         ,
                                                         B
                                                      
                                                   
                                                   (
                                                   i
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         l
                                                         ,
                                                         B
                                                      
                                                   
                                                   (
                                                   j
                                                   )
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             u
                                             ,
                                             A
                                          
                                       
                                       (
                                       i
                                       )
                                       =
                                       
                                          
                                             O
                                          
                                          
                                             u
                                             ,
                                             4
                                          
                                          
                                             4
                                             e
                                          
                                       
                                       (
                                       i
                                       )
                                       ;
                                       
                                       
                                          
                                             V
                                          
                                          
                                             u
                                             ,
                                             B
                                          
                                       
                                       (
                                       i
                                       )
                                       =
                                       
                                          
                                             O
                                          
                                          
                                             u
                                             ,
                                             4
                                          
                                          
                                             4
                                             e
                                          
                                       
                                       (
                                       16
                                       +
                                       i
                                       )
                                       ;
                                       
                                       i
                                       =
                                       (
                                       1
                                       .
                                       .
                                       12
                                       )
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             l
                                             ,
                                             A
                                          
                                       
                                       (
                                       j
                                       )
                                       =
                                       
                                          
                                             V
                                          
                                          
                                             32
                                             ,
                                             e
                                          
                                       
                                       (
                                       j
                                       )
                                       ;
                                       
                                       
                                          
                                             V
                                          
                                          
                                             l
                                             ,
                                             B
                                          
                                       
                                       (
                                       j
                                       )
                                       =
                                       
                                          
                                             V
                                          
                                          
                                             32
                                             ,
                                             e
                                          
                                       
                                       (
                                       4
                                       +
                                       j
                                       )
                                       ;
                                       
                                       j
                                       =
                                       (
                                       1
                                       .
                                       .
                                       4
                                       )
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       2
                                       ⋅
                                       V
                                       ;
                                       
                                       
                                          
                                             V
                                          
                                          
                                             i
                                             n
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                       
                                       
                                          
                                             V
                                          
                                          
                                             a
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                R
                                                r
                                             
                                             
                                                v
                                                o
                                             
                                          
                                          ⋅
                                          
                                             
                                                O
                                             
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                8
                                             
                                          
                                          ]
                                       
                                       /
                                       2
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             O
                                          
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             8
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         O
                                                      
                                                      
                                                         r
                                                         a
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         O
                                                      
                                                      
                                                         r
                                                         b
                                                      
                                                      
                                                         8
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                       
                                       
                                          
                                             O
                                          
                                          
                                             r
                                             a
                                          
                                          
                                             8
                                          
                                       
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      (
                                                      1
                                                      )
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      (
                                                      2
                                                      )
                                                      
                                                   
                                                   
                                                      …
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      (
                                                      8
                                                      )
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             T
                                          
                                       
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             O
                                          
                                          
                                             r
                                             b
                                          
                                          
                                             8
                                          
                                       
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      (
                                                      17
                                                      )
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      (
                                                      18
                                                      )
                                                      
                                                   
                                                   
                                                      …
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      (
                                                      24
                                                      )
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             T
                                          
                                       
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             R
                                             r
                                          
                                          
                                             v
                                             o
                                          
                                       
                                       =
                                       
                                          
                                             R
                                             v
                                             t
                                          
                                          
                                             v
                                             o
                                          
                                       
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ;
                                    
                                 
                                 
                                    
                                       i
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       12
                                       ;
                                       
                                       j
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       8
                                       ,
                                       17
                                       ,
                                       18
                                       ,
                                       …
                                       24
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             R
                                             v
                                             t
                                          
                                          
                                             v
                                             o
                                          
                                       
                                       =
                                       
                                          
                                             R
                                          
                                          
                                             v
                                             o
                                          
                                          
                                             T
                                          
                                       
                                       ;
                                       
                                       
                                          
                                             V
                                          
                                          
                                             r
                                          
                                       
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            4
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                      (
                                                      13
                                                      )
                                                      
                                                   
                                                   
                                                      ⋯
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            4
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                      (
                                                      16
                                                      )
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

It should be noted that all matrices proposed in Sections 4 and 5 are absent from the previously existing literature [6,9,13]. These matrices have been proposed to allow partial results to be computed for 
                        4
                        ×
                        4
                      2D DCT using the 
                        8
                        ×
                        8
                      integer transform.

In previous implementations of shared resource architectures, the overall implementation was comprised of smaller independent units. In [13] it is shown that the basic building blocks comprised of vector addition and reordering operations were implemented. Thereafter, these building blocks were integrated in higher-level complex sub-blocks to perform the desired data manipulation at each stage. For example, multiplying a vector, 
                        
                           
                              v
                           
                           
                              1
                           
                        
                     , with 
                        
                           
                              H
                           
                           
                              2
                           
                        
                      requires addition and subtraction. Similarly, multiplication of a vector, 
                        
                           
                              v
                           
                           
                              2
                           
                        
                     , with 
                        
                           
                              Q
                           
                           
                              2
                           
                           
                              ′
                           
                        
                      requires a data shift, an addition and a subtraction operation. Therefore, if a vector, 
                        
                           
                              v
                           
                           
                              3
                           
                        
                        =
                        
                           
                              [
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                              ]
                           
                           
                              T
                           
                        
                     , is multiplied by the sub-block in stage 
                        
                           
                              S
                           
                           
                              6
                              ,
                              1
                           
                           
                              8
                           
                        
                      to compute 
                        (
                        2
                        ⋅
                        [
                        (
                        2
                        ⋅
                        
                           
                              H
                           
                           
                              2
                           
                        
                        ⊕
                        
                           
                              Q
                           
                           
                              2
                           
                           
                              ′
                           
                        
                        )
                        ]
                        )
                        ⋅
                        
                           
                              v
                           
                           
                              3
                           
                        
                     , a total of two data shift, two addition and two subtraction operations are required.

The data shift in the computation of 
                        (
                        2
                        ⋅
                        [
                        (
                        2
                        ⋅
                        
                           
                              H
                           
                           
                              2
                           
                        
                        ⊕
                        
                           
                              Q
                           
                           
                              2
                           
                           
                              ′
                           
                        
                        )
                        ]
                        )
                        ⋅
                        
                           
                              v
                           
                           
                              3
                           
                        
                      is the result of multiplication with a factor of 2. Hence, the shift operation can be hardwired to reduce the computation time. Similarly, addition and subtraction are performed on independent input and can hence be performed in parallel. Therefore, the computation of the 2D DCT integer transform given in Eqs. (39) and (40) has been split into stages such that the computation within each stage can be carried out independently. Clock based synchronization is used to show that the maximum latency between the input and output in each stage is not more than an addition or subtraction operation. In stages like 
                        
                           
                              M
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              M
                           
                           
                              2
                           
                        
                     , only the data rearrangement has been performed, and hence, the actual latency is less than an arithmetic operation.

Based on Eq. (39) the block diagram for the computation of the 2D 
                        8
                        ×
                        8
                      integer transform is shown in Fig. 5a
                     . Similarly, based on Eq. (41), the block diagram to compute the 2D 
                        4
                        ×
                        4
                      integer transform is shown in Fig. 5b
                     .


                        Fig. 5a and Fig. 5b show the architecture to compute the 2D 
                           8
                           ×
                           8
                         and 
                           4
                           ×
                           4
                         integer transform. In the actual implementation, stages 
                           
                              
                                 M
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 1
                              
                              
                                 8
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 2
                              
                              
                                 8
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 3
                              
                              
                                 8
                              
                           
                         and 
                           
                              
                                 M
                              
                              
                                 2
                              
                           
                         are shared. Fig. 6
                         shows the implementation structure that integrates both 2D 
                           8
                           ×
                           8
                         and 
                           4
                           ×
                           4
                         integer transform. The sections that are common in the computation of 2D 
                           8
                           ×
                           8
                         and 
                           4
                           ×
                           4
                         integer transform can be seen to provide intermediate results to the sections that are exclusive to the 2D 
                           8
                           ×
                           8
                         and 
                           4
                           ×
                           4
                         integer transform computation. To reduce the power consumption, the clock input to the sections that are required exclusively for the 2D 
                           4
                           ×
                           4
                         integer transform computation can be disabled during the 2D 
                           8
                           ×
                           8
                         integer transform computation. Similarly, the clock input to the sections required exclusively for the 2D 
                           8
                           ×
                           8
                         integer transform computation can be disabled during the 2D 
                           4
                           ×
                           4
                         integer transform computation.

In the proposed design, let the worst case latency in any stage be 
                           
                              
                                 L
                              
                              
                                 w
                              
                           
                        , the worst case setup time in any stage be 
                           
                              
                                 S
                              
                              
                                 w
                              
                           
                         and the worst case hold time in any stage be 
                           
                              
                                 H
                              
                              
                                 w
                              
                           
                        . Hence, with single clock structure the minimum clock period, 
                           
                              
                                 T
                              
                              
                                 c
                                 1
                              
                           
                           (
                           min
                           ⁡
                           )
                         must be greater than the worst case computational delay + setup time of the next stage+hold time for the next stage, i.e. 
                           
                              
                                 T
                              
                              
                                 c
                                 1
                              
                           
                           (
                           min
                           ⁡
                           )
                           >
                           
                              
                                 L
                              
                              
                                 w
                              
                           
                           +
                           
                              
                                 S
                              
                              
                                 w
                              
                           
                           +
                           
                              
                                 H
                              
                              
                                 w
                              
                           
                        . Using a 10% margin the minimum clock period for a single clock design, 
                           
                              
                                 T
                              
                              
                                 c
                                 1
                              
                           
                           (
                           min
                           ⁡
                           )
                         can be given as 
                           
                              
                                 T
                              
                              
                                 c
                                 1
                              
                           
                           (
                           min
                           ⁡
                           )
                           =
                           1.1
                           (
                           
                              
                                 L
                              
                              
                                 w
                              
                           
                           +
                           
                              
                                 S
                              
                              
                                 w
                              
                           
                           +
                           
                              
                                 H
                              
                              
                                 w
                              
                           
                           )
                        . Hence, the maximum frequency of operation will be 
                           
                              
                                 F
                              
                              
                                 c
                                 1
                              
                           
                           (
                           max
                           ⁡
                           )
                           =
                           1
                           /
                           
                              
                                 T
                              
                              
                                 c
                                 1
                              
                           
                           (
                           min
                           ⁡
                           )
                        . For a CMOS implementation the dynamic power consumption in each stage, 
                           
                              
                                 P
                              
                              
                                 d
                                 s
                              
                           
                        , is proportional to the switching frequency, i.e., 
                           
                              
                                 P
                              
                              
                                 d
                                 s
                              
                           
                           ∝
                           
                              
                                 F
                              
                              
                                 c
                                 1
                              
                           
                           (
                           max
                           ⁡
                           )
                        . Fig. 5a shows that there are 11 stages in the implementation of the 2D 
                           8
                           ×
                           8
                         integer transform and Fig. 5b shows that there are 10 stages in the implementation of the 2D 
                           4
                           ×
                           4
                         integer transform. Hence, for 2D 
                           8
                           ×
                           8
                         integer transform, if all the stages are triggered every clock cycle then the instantaneous dynamic power consumption, 
                           
                              
                                 P
                              
                              
                                 d
                                 8
                              
                           
                        , is proportional to the product of number of stages and the switching frequency, i.e., 
                           
                              
                                 P
                              
                              
                                 d
                                 8
                              
                           
                           =
                           11
                           .
                           
                              
                                 P
                              
                              
                                 d
                                 s
                              
                           
                           ∝
                           11
                           .
                           
                              
                                 F
                              
                              
                                 c
                                 1
                              
                           
                           (
                           max
                           ⁡
                           )
                        . Similarly, for 2D 
                           4
                           ×
                           4
                         integer transform, if all the stages are triggered every clock cycle then the instantaneous dynamic power consumption, 
                           
                              
                                 P
                              
                              
                                 d
                                 4
                              
                           
                        , is proportional to the product of number of stages and the switching frequency, i.e., 
                           
                              
                                 P
                              
                              
                                 d
                                 4
                              
                           
                           =
                           10
                           .
                           
                              
                                 P
                              
                              
                                 d
                                 s
                              
                           
                           ∝
                           10
                           .
                           
                              
                                 F
                              
                              
                                 c
                                 1
                              
                           
                           (
                           max
                           ⁡
                           )
                        . To maintain the power consumption within reasonable limits, the maximum switching frequency is reduced and the clock margin is set to be about 2 times the minimum clock period. Hence, 
                           
                              
                                 T
                              
                              
                                 c
                                 1
                              
                           
                           (
                           >
                           
                              
                                 T
                              
                              
                                 c
                                 1
                              
                           
                           (
                           min
                           ⁡
                           )
                           )
                           =
                           2
                           (
                           
                              
                                 L
                              
                              
                                 w
                              
                           
                           +
                           
                              
                                 S
                              
                              
                                 w
                              
                           
                           +
                           
                              
                                 H
                              
                              
                                 w
                              
                           
                           )
                        , 
                           
                              
                                 F
                              
                              
                                 c
                                 1
                              
                           
                           (
                           max
                           ⁡
                           )
                           =
                           1
                           /
                           
                              
                                 T
                              
                              
                                 c
                                 1
                              
                           
                           (
                           min
                           ⁡
                           )
                           =
                           1
                           /
                           (
                           2
                           (
                           
                              
                                 L
                              
                              
                                 w
                              
                           
                           +
                           
                              
                                 S
                              
                              
                                 w
                              
                           
                           +
                           
                              
                                 H
                              
                              
                                 w
                              
                           
                           )
                           )
                        , 
                           
                              
                                 P
                              
                              
                                 d
                                 s
                              
                           
                           ∝
                           
                              
                                 F
                              
                              
                                 c
                                 1
                              
                           
                           (
                           max
                           ⁡
                           )
                           =
                           1
                           /
                           (
                           2
                           (
                           
                              
                                 L
                              
                              
                                 w
                              
                           
                           +
                           
                              
                                 S
                              
                              
                                 w
                              
                           
                           +
                           
                              
                                 H
                              
                              
                                 w
                              
                           
                           )
                           )
                        , 
                           
                              
                                 P
                              
                              
                                 d
                                 8
                              
                           
                           =
                           11
                           .
                           
                              
                                 P
                              
                              
                                 d
                                 s
                              
                           
                           ∝
                           11
                           .
                           
                              
                                 F
                              
                              
                                 c
                                 1
                              
                           
                           (
                           max
                           ⁡
                           )
                           =
                           11
                           /
                           (
                           2
                           (
                           
                              
                                 L
                              
                              
                                 w
                              
                           
                           +
                           
                              
                                 S
                              
                              
                                 w
                              
                           
                           +
                           
                              
                                 H
                              
                              
                                 w
                              
                           
                           )
                           )
                        , 
                           
                              
                                 P
                              
                              
                                 d
                                 4
                              
                           
                           =
                           10
                           .
                           
                              
                                 P
                              
                              
                                 d
                                 s
                              
                           
                           ∝
                           10
                           .
                           
                              
                                 F
                              
                              
                                 c
                                 1
                              
                           
                           (
                           max
                           ⁡
                           )
                           =
                           10
                           /
                           (
                           2
                           (
                           
                              
                                 L
                              
                              
                                 w
                              
                           
                           +
                           
                              
                                 S
                              
                              
                                 w
                              
                           
                           +
                           
                              
                                 H
                              
                              
                                 w
                              
                           
                           )
                           )
                        . Fig. 7
                         shows the triggering timing requirement for single clock design and dual anti phase clock design.

In a dual anti-phase clock design with 50% duty cycle, the alternating stages can be triggered by anti-phase clocks as shown in Fig. 7. Consider that each stage is triggered at the rising edge of the input clock. Hence, when the rising edge of clock C_
                           
                              
                                 F
                              
                              
                                 c
                                 2
                              
                           
                         occurs, only half of the stages will be triggered. The remaining sections will be triggered at the rising edge of the anti-phase clock, C_
                           
                              
                                 F
                              
                              
                                 c
                                 2
                                 _
                                 i
                              
                           
                        . This will have two effect on the design.
                           
                              A.
                              At any time only half of the stages will be triggered. Hence, for 2D 
                                    8
                                    ×
                                    8
                                  integer transform, the instantaneous dynamic power consumption, 
                                    
                                       
                                          P
                                       
                                       
                                          d
                                          8
                                       
                                    
                                 , will be proportional to the product of (number of stages)/2 and the switching frequency, i.e., 
                                    
                                       
                                          P
                                       
                                       
                                          d
                                          8
                                       
                                    
                                    =
                                    6
                                    .
                                    
                                       
                                          P
                                       
                                       
                                          d
                                          s
                                       
                                    
                                    (
                                    ≈
                                    5.5
                                    
                                       
                                          P
                                       
                                       
                                          d
                                          s
                                       
                                    
                                    )
                                    ∝
                                    6
                                    .
                                    
                                       
                                          F
                                       
                                       
                                          c
                                          1
                                       
                                    
                                    (
                                    max
                                    ⁡
                                    )
                                 . Similarly, for 2D 
                                    4
                                    ×
                                    4
                                  integer transform, the instantaneous dynamic power consumption, 
                                    
                                       
                                          P
                                       
                                       
                                          d
                                          4
                                       
                                    
                                 , is proportional to the product of (number of stages)/2 and the switching frequency, i.e., 
                                    
                                       
                                          P
                                       
                                       
                                          d
                                          4
                                       
                                    
                                    =
                                    5
                                    .
                                    
                                       
                                          P
                                       
                                       
                                          d
                                          s
                                       
                                    
                                    ∝
                                    5
                                    .
                                    
                                       
                                          F
                                       
                                       
                                          c
                                          1
                                       
                                    
                                    (
                                    max
                                    ⁡
                                    )
                                 . Due to reduced power consumption, the maximum switching frequency is reduced but not significantly and the clock margin is set to be about 10% of the minimum clock period. Hence, 
                                    
                                       
                                          T
                                       
                                       
                                          c
                                          1
                                       
                                    
                                    (
                                    >
                                    
                                       
                                          T
                                       
                                       
                                          c
                                          1
                                       
                                    
                                    (
                                    min
                                    ⁡
                                    )
                                    )
                                    =
                                    1.1
                                    (
                                    
                                       
                                          L
                                       
                                       
                                          w
                                       
                                    
                                    +
                                    
                                       
                                          S
                                       
                                       
                                          w
                                       
                                    
                                    +
                                    
                                       
                                          H
                                       
                                       
                                          w
                                       
                                    
                                    )
                                 , 
                                    
                                       
                                          F
                                       
                                       
                                          c
                                          1
                                       
                                    
                                    (
                                    max
                                    ⁡
                                    )
                                    =
                                    1
                                    /
                                    
                                       
                                          T
                                       
                                       
                                          c
                                          1
                                       
                                    
                                    (
                                    min
                                    ⁡
                                    )
                                    =
                                    1
                                    /
                                    (
                                    1.1
                                    (
                                    
                                       
                                          L
                                       
                                       
                                          w
                                       
                                    
                                    +
                                    
                                       
                                          S
                                       
                                       
                                          w
                                       
                                    
                                    +
                                    
                                       
                                          H
                                       
                                       
                                          w
                                       
                                    
                                    )
                                    )
                                 , 
                                    
                                       
                                          P
                                       
                                       
                                          d
                                          s
                                       
                                    
                                    ∝
                                    
                                       
                                          F
                                       
                                       
                                          c
                                          1
                                       
                                    
                                    (
                                    max
                                    ⁡
                                    )
                                    =
                                    1
                                    /
                                    (
                                    1.1
                                    (
                                    
                                       
                                          L
                                       
                                       
                                          w
                                       
                                    
                                    +
                                    
                                       
                                          S
                                       
                                       
                                          w
                                       
                                    
                                    +
                                    
                                       
                                          H
                                       
                                       
                                          w
                                       
                                    
                                    )
                                    )
                                 , 
                                    
                                       
                                          P
                                       
                                       
                                          d
                                          8
                                       
                                    
                                    =
                                    6
                                    .
                                    
                                       
                                          P
                                       
                                       
                                          d
                                          s
                                       
                                    
                                    ∝
                                    6
                                    .
                                    
                                       
                                          F
                                       
                                       
                                          c
                                          1
                                       
                                    
                                    (
                                    max
                                    ⁡
                                    )
                                    =
                                    6
                                    /
                                    (
                                    1.1
                                    (
                                    
                                       
                                          L
                                       
                                       
                                          w
                                       
                                    
                                    +
                                    
                                       
                                          S
                                       
                                       
                                          w
                                       
                                    
                                    +
                                    
                                       
                                          H
                                       
                                       
                                          w
                                       
                                    
                                    )
                                    )
                                 , 
                                    
                                       
                                          P
                                       
                                       
                                          d
                                          4
                                       
                                    
                                    =
                                    5
                                    .
                                    
                                       
                                          P
                                       
                                       
                                          d
                                          s
                                       
                                    
                                    ∝
                                    5
                                    .
                                    
                                       
                                          F
                                       
                                       
                                          c
                                          1
                                       
                                    
                                    (
                                    max
                                    ⁡
                                    )
                                    =
                                    5
                                    /
                                    (
                                    1.1
                                    (
                                    
                                       
                                          L
                                       
                                       
                                          w
                                       
                                    
                                    +
                                    
                                       
                                          S
                                       
                                       
                                          w
                                       
                                    
                                    +
                                    
                                       
                                          H
                                       
                                       
                                          w
                                       
                                    
                                    )
                                    )
                                 . Hence, if power consumption of all the stages is considered together than the power consumption of the single clock design will be same as that of the dual anti-phase clock design. However, in this case, the operating frequency of the dual anti-phase clock design will be higher than that of the single clock design.

As discussed earlier, if the clock frequency of the single clock design and the dual anti-phase clock design is kept same, the dynamic power consumption in the dual clock structure is significantly reduced as compared to the single clock design.

Due to these reasons, dual anti-phase clock has been used in the implementation of the proposed design. Further reduction in latency can be achieved by merging different sections in to a single section.

It should be noted that currently existing designs can also use dual clock system as long as the computations are done in mutually independent stages. The effect of using dual clock design on timing and power consumption in existing schemes requires a case-by-case analysis. Hence, such an analysis is considered outside the scope of this manuscript.

Stages 
                           
                              
                                 M
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 1
                              
                              
                                 8
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 2
                              
                              
                                 8
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 3
                              
                              
                                 8
                              
                           
                         and 
                           
                              
                                 M
                              
                              
                                 2
                              
                           
                         are shared in the computation of the 2D 
                           8
                           ×
                           8
                         integer transform as well as in the computation of the 2D 
                           4
                           ×
                           4
                         integer transform. Anti-phase clocks are alternately used to reduce the computation time. In other words, if 
                           
                              
                                 M
                              
                              
                                 1
                              
                           
                         is clocked by a clock 
                           
                              
                                 C
                              
                              
                                 k
                              
                           
                        , the next stage 
                           
                              
                                 S
                              
                              
                                 1
                              
                              
                                 8
                              
                           
                         will be clocked by 
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       k
                                    
                                 
                              
                              ‾
                           
                         (180 phase shifted 
                           
                              
                                 C
                              
                              
                                 k
                              
                           
                        ). As discussed earlier, the computation in each stage is independent, and therefore, a new data set can be given as the input in next clock edge once the data passes through one stage. This pipelined dual clocked architecture reduces the latency to half.


                        Fig. 5a shows that there are 11 stages in the implementation of the 2D 
                           8
                           ×
                           8
                         integer transform. Hence, a total of 11 clock cycles will be required for the 2D 
                           8
                           ×
                           8
                         integer transform computation. With the use of a dual clock structure, the latency is reduced to 5.5 Clock cycles, and to further reduce the latency and increase the throughput, sections with data shift operations can be combined with their preceding or succeeding stages. For example, stages 
                           
                              
                                 S
                              
                              
                                 1
                              
                              
                                 8
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 2
                              
                              
                                 8
                              
                           
                         consist of simple input reordering and can be merged into one block, which will reduce the overall latency to 4.5 clock cycles.


                        Fig. 5b shows that there are 10 stages in the implementation of the 2D 
                           4
                           ×
                           4
                         integer transform. Hence, a total of 10 clock cycles will be required for the 2D 
                           4
                           ×
                           4
                         integer transform computation. The dual clock structure reduces the latency to 5 Clock cycles, and similar to the 2D 
                           8
                           ×
                           8
                         integer transform computation structure, the sections with data shift operations can be combined with their preceding or succeeding stages. For example, the output stages of the 
                           4
                           ×
                           4
                         integer transform 
                           
                              
                                 S
                              
                              
                                 6
                              
                              
                                 4
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 7
                              
                              
                                 4
                              
                           
                         and 1/4 can be merged into one block, and sub-block 
                           K
                         can be implemented as combinational logic without clock input since it performs data selection only. This will reduce the overall latency to 3 clock cycles.

Eqs. (39), (40) and (42) show that switching between the 2D 
                           8
                           ×
                           8
                         integer transform computation and 2D 
                           4
                           ×
                           4
                         integer transform computation is controlled by the select signal, 
                           s
                        . Fig. 8
                         shows the timing diagram for the 2D 
                           8
                           ×
                           8
                         integer transform computation (
                           s
                           =
                           0
                        ). As shown in the timing diagram, the alternative stages are clocked by anti-phase clocks, and the output of each stage is available at the rising edge of the input clock. After the data has been passed to the succeeding stage, the data input to the current stage can be updated. Hence, new data input can be applied to the pipelined architecture at each rising edge, and thus the maximum input to output latency is 4.5 clocks due to the merging of stages and use of a dual clock architecture.


                        Fig. 9
                         shows the timing diagram to compute the 2D 
                           4
                           ×
                           4
                         integer transform (
                           s
                           =
                           1
                        ). Stages 
                           
                              
                                 M
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 1
                              
                              
                                 8
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 2
                              
                              
                                 8
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 3
                              
                              
                                 8
                              
                           
                         and 
                           
                              
                                 M
                              
                              
                                 2
                              
                           
                         are used in the computation for the 2D 
                           8
                           ×
                           8
                         as well as the 2D 
                           4
                           ×
                           4
                         integer transform. The alternating stages are clocked by anti-phase clocks. The maximum input to output latency is 3 clocks due to the merging of stages and use of a dual clock architecture.

Let the total number of shift and add operations required in 2D 
                           4
                           ×
                           4
                         and 
                           8
                           ×
                           8
                         integer transform computation be 
                           
                              
                                 Θ
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 Θ
                              
                              
                                 8
                              
                           
                         be respectively. As shown in previous sections, to achieve resource sharing in 2D 
                           4
                           ×
                           4
                         and 
                           8
                           ×
                           8
                         integer transform computation; using the scheme presented in [6,7] and [10]; additional stages have been introduced in the proposed design. However, it should be noted that the new sections introduced in proposed paper are data rearrangement blocks. There are no arithmetic or logical operation performed in these sections. Hence, it can be concluded that 
                           
                              
                                 Θ
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 Θ
                              
                              
                                 8
                              
                           
                         of the proposed design is same as that of 2D 
                           4
                           ×
                           4
                         and 
                           8
                           ×
                           8
                         integer transform presented in [6,7] and [10]. It has already been proved in [6,7] and [10] that the fast 2D 
                           4
                           ×
                           4
                         and 
                           8
                           ×
                           8
                         integer transform requires smaller number of shift and add operations as compared to the existing schemes.

If the designs presented in [6,7] and [10] are implemented separately, as shown in Fig. 2, the total number of shift and add elements required for implementation will be approximately equal to 
                           
                              
                                 Θ
                              
                              
                                 4
                              
                           
                           +
                           
                              
                                 Θ
                              
                              
                                 8
                              
                           
                        . For the resource shared implementation presented in [13] let the number of shift and add operations common in 2D 
                           4
                           ×
                           4
                         and 
                           8
                           ×
                           8
                         integer transform be given by 
                           
                              
                                 Θ
                              
                              
                                 4
                                 +
                                 8
                              
                           
                        . Hence, the number of shift and add operations required for implementation of design based on [13] will approximately be equal to 
                           
                              
                                 Θ
                              
                              
                                 4
                              
                           
                           +
                           
                              
                                 Θ
                              
                              
                                 8
                              
                           
                           −
                           
                              
                                 Θ
                              
                              
                                 4
                                 +
                                 8
                              
                           
                        . In the proposed implementation the newly added blocks does not require any shift and add operations. Hence, the number of shift and add operations in the proposed resource shared architecture is also approximately equal to 
                           
                              
                                 Θ
                              
                              
                                 4
                              
                           
                           +
                           
                              
                                 Θ
                              
                              
                                 8
                              
                           
                           −
                           
                              
                                 Θ
                              
                              
                                 4
                                 +
                                 8
                              
                           
                        . Since 
                           
                              
                                 Θ
                              
                              
                                 4
                              
                           
                           +
                           
                              
                                 Θ
                              
                              
                                 8
                              
                           
                           −
                           
                              
                                 Θ
                              
                              
                                 4
                                 +
                                 8
                              
                           
                           <
                           
                              
                                 Θ
                              
                              
                                 4
                              
                           
                           +
                           
                              
                                 Θ
                              
                              
                                 8
                              
                           
                         the number of computational elements required for implementation of proposed scheme will be less than the total number of shift and add elements required for independent implementation of 2D 
                           4
                           ×
                           4
                         and 
                           8
                           ×
                           8
                         integer transform based on [6,7] and [10]. Hence, it can be concluded that the proposed scheme can achieve higher throughput by parallel processing of two independent blocks of 
                           4
                           ×
                           4
                         size with approximately same number of processing elements as [13] and less number of computation elements based on row-column decomposition methodology for 2D integer transform computation.

To verify the proposed design, the VHDL code of the proposed design was synthesized using Artisan TSMC 0.18-μm Process Standard Cell and the Synopsys Design Compiler tool. Synopsys IC compiler tool has been used for placement and route (P&R). The proposed architecture has been implemented using 0.18 μm CMOS technology to develop an ASIC prototype for functionality and operating speed verification. The maximum achievable clock frequency for the proposed implementation is 1.316 GHz. For functional verification, an anti-phase clock of 1.25 GHz was used to verify the post synthesis simulation results. For design verification various alternatives are available. For example, the proposed design can be used in conjunction with the H.264/MPEG-4 AVC reference software [16] as a hardware accelerator. Another way is to apply pre-defined inputs to the proposed design and compare the output with the standard response. For this research work a simplified verification method way employed. Fig. 10
                      shows the verification environment setup used in this research work. Random input sample patterns resembling pixel values were generated using software tools such as MATLAB. This set of input data pattern was applied to two different test objects. The first test object is standard 2D 
                        8
                        ×
                        8
                      and 
                        4
                        ×
                        4
                      integer transform given by Eqs. (1a) and (5a). The second test object is the ASIC based on proposed design. The standard 2D 
                        8
                        ×
                        8
                      and 
                        4
                        ×
                        4
                      integer transform runs at software level while FPGA based verification platform was used to connect MATLAB with ASIC based on proposed design. The outputs from the ASIC based on proposed design is compared with the standard 2D 
                        8
                        ×
                        8
                      and 
                        4
                        ×
                        4
                      integer transform for verification. The core transform used in H.264 reference software [16] and the proposed scheme is same. The difference in reference software and proposed scheme is the method with which the 2D integer transforms are computed. The software as well as proposed scheme uses integer computations. Hence, the results obtained from the proposed scheme and the software code shall be identical. During the implementation of proposed scheme the bit length of adders in various sections are chosen such that difference and hence, the mean square error (MSE) between the result from the software based integer transform and proposed design is zero.

Real time processing of high resolution video, such as HD 1080p (
                        1920
                        ×
                        1080
                     ), requires high DCT computation throughput. In [17], H.264/MPEG-4 AVC reference software JM14.0 is used to present the throughput requirements for various video samples. The results in [17] show that with the increase in video frame size, the minimum throughput requirement increases from Mega-pixels per second to Giga-pixels per second. This minimum required throughput also affects the power consumption of the clocked circuits that are employed in high-throughput DCT computation designs.


                     Table 1
                      shows a comparison of existing implementations with the proposed implementation. The results of the implementation show that the proposed design can achieve twice the throughput for 2D 
                        4
                        ×
                        4
                      integer transform computation as compared to the shared resource architecture in [13]. The operating frequency of the proposed design is about six times higher (1.316 GHz) that of other unified architectures. The proposed architecture does not require transpose or intermediate memory and hence requires a fewer number of gates than the other unified architectures with a high throughput. When compared to the shared resource architecture in [13], the proposed design requires a higher number of gates for implementation due to parallel processing of two independent 
                        4
                        ×
                        4
                      blocks for 2D 
                        4
                        ×
                        4
                      integer transform computation. Hence, with less than a 12% increase in gate count, the throughput for 2D 
                        4
                        ×
                        4
                      integer transform computation increases by 100%. It should be noted that the new sections introduced in the proposed design are used for sample reordering. There are no arithmetic operations performed in these blocks. To achieve 2D 
                        4
                        ×
                        4
                      integer transform from 2D 
                        8
                        ×
                        8
                      integer transform, the design in [13] also uses data rearrangement sections which are combined with their preceding or succeeding stages to reduce latency. Hence, even though the data re-ordering sections in proposed design are different from those used in [13], the number of computations in the data path for 2D 
                        4
                        ×
                        4
                      and 
                        8
                        ×
                        8
                      integer transform is same in proposed design and the resource shared architecture of [13]. Since the data reordering computations are merged with preceding or succeeding stages, the latency in the data path 2D 
                        4
                        ×
                        4
                      and 
                        8
                        ×
                        8
                      integer transform is same in proposed design and the resource shared architecture of [13]. Hence, for the 2D 
                        8
                        ×
                        8
                      integer transform the proposed scheme can achieve same clock speed as the design presented in [13]. For the 2D 
                        4
                        ×
                        4
                      integer transform computation two blocks are processed in parallel and hence the total number pixels processed is doubled. Therefore, the throughput for the 2D 
                        4
                        ×
                        4
                      integer transform computation in the proposed design is doubled to that of the design presented in [13]. At each stage, the output is buffered at the rising edge of the corresponding input clock. Therefore, as shown in the timing diagram, each stage can start processing a new set of input data while the succeeding stage performs the intermediate computations for the previous set of input data. Therefore, the initial input to output latency is of 4.5 clocks for the 2D 
                        8
                        ×
                        8
                      integer transform computation. Similarly, the initial input to output latency is 3 clocks for 2D 
                        4
                        ×
                        4
                      integer transform computation. The pipelined structure allows continuous data stream processing.

As shown in Table 1, the reduced computation time and small gate count allow the proposed design to achieve the highest throughput to area ratio, and the throughput of the proposed design is about 3 times that of existing architectures. Designs based on parallel computation architecture achieve high throughput at the expense of higher gate count [13–15]. Designs based on row-column decomposition have simple architecture. Hence, they can achieve high operating frequency and lower gate count at the expense of throughput [9–11,13]. In the proposed manuscript, matrix decomposition has been used to simplify parallel processing of inputs and intermediate results in each stage. Simplified computations helps to reduce the latency in various stages without significantly increasing the gate count. A lower gate count and higher throughput results in a throughput-to-area ratio of the proposed design that is about 4 times larger than any of the other architectures. In conclusion, the proposed design for the shared resource architecture for 2D 
                        8
                        ×
                        8
                      and 
                        4
                        ×
                        4
                      integer transform computation has following salient features:
                        
                           a)
                           Parallel processing of two independent blocks of 
                                 4
                                 ×
                                 4
                               data.

High circuit utilization ratio during 2D 
                                 8
                                 ×
                                 8
                               and 
                                 4
                                 ×
                                 4
                               integer transform computation.

Data stream processing capability.

High operating frequency helps reduce latency

High throughput.

Small gate count.

@&#FUTURE WORK@&#

There are various ways in which parallelism in system design can be obtained. For example, research result shows that significant improvement in design performance can be achieved by using design languages like OpenCL C [21,22]. Similarly, by using design tool constructs, parallelism can be obtained in implementation which helps to reduce latency and improve throughput [23,24]. The aim of this paper is to use the inherent parallelism in the underling algorithm to achieve high throughput. The HDL based implementation has been used for this research work to verify the proposed modification in the computation scheme. This HDL based implementations also helps the designer to determine the timing requirement of the implementation in ASIC design environment. The proposed scheme uses parallel data path between various stages. This leads to routing issues in placement and route (P&R) and clock tree synthesis and hence requires proper pin placement analysis. Therefore, after simplifying the system algorithm itself, further improvement in performance as well as simplicity in overall system implementation can be expected by the use of design languages like OpenCL C and design tool constructs offered by various synthesis and P&R tools.

In recent years, the successor of H.264/MPEG-4 AVC, High Efficiency Video Coding (HEVC) has been standardized. The core transform used in HEVC is integer transform based on DCT. While H.264 supports integer transform of size 
                        4
                        ×
                        4
                      and 
                        8
                        ×
                        8
                     , HEVC supports integer transform of size 
                        4
                        ×
                        4
                     , 
                        8
                        ×
                        8
                     , 
                        16
                        ×
                        16
                      and 
                        32
                        ×
                        32
                     . As shown in [25] the transform kernels in H.264/MPEG-4 AVC as well as HEVC are of form given in Eq. (42).
                        
                           (42)
                           
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             4
                                             ×
                                             4
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   a
                                                   
                                                
                                                
                                                   a
                                                   
                                                
                                                
                                                   a
                                                   
                                                
                                                
                                                   a
                                                
                                             
                                             
                                                
                                                   f
                                                   
                                                
                                                
                                                   g
                                                   
                                                
                                                
                                                   −
                                                   g
                                                   
                                                
                                                
                                                   −
                                                   f
                                                
                                             
                                             
                                                
                                                   a
                                                   
                                                
                                                
                                                   −
                                                   a
                                                   
                                                
                                                
                                                   −
                                                   a
                                                   
                                                
                                                
                                                   a
                                                
                                             
                                             
                                                
                                                   g
                                                   
                                                
                                                
                                                   −
                                                   f
                                                   
                                                
                                                
                                                   f
                                                   
                                                
                                                
                                                   −
                                                   g
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             8
                                             ×
                                             8
                                          
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   a
                                                   
                                                
                                                
                                                   a
                                                   
                                                
                                                
                                                   a
                                                   
                                                
                                                
                                                   a
                                                   
                                                
                                                
                                                   a
                                                   
                                                
                                                
                                                   a
                                                   
                                                
                                                
                                                   a
                                                   
                                                
                                                
                                                   a
                                                
                                             
                                             
                                                
                                                   b
                                                   
                                                
                                                
                                                   c
                                                   
                                                
                                                
                                                   d
                                                   
                                                
                                                
                                                   e
                                                   
                                                
                                                
                                                   −
                                                   e
                                                   
                                                
                                                
                                                   −
                                                   d
                                                   
                                                
                                                
                                                   −
                                                   c
                                                   
                                                
                                                
                                                   −
                                                   b
                                                
                                             
                                             
                                                
                                                   f
                                                   
                                                
                                                
                                                   g
                                                   
                                                
                                                
                                                   −
                                                   g
                                                   
                                                
                                                
                                                   −
                                                   f
                                                   
                                                
                                                
                                                   −
                                                   f
                                                   
                                                
                                                
                                                   −
                                                   g
                                                   
                                                
                                                
                                                   g
                                                   
                                                
                                                
                                                   f
                                                
                                             
                                             
                                                
                                                   c
                                                   
                                                
                                                
                                                   −
                                                   e
                                                   
                                                
                                                
                                                   −
                                                   b
                                                   
                                                
                                                
                                                   −
                                                   d
                                                   
                                                
                                                
                                                   d
                                                   
                                                
                                                
                                                   b
                                                   
                                                
                                                
                                                   e
                                                   
                                                
                                                
                                                   −
                                                   c
                                                
                                             
                                             
                                                
                                                   a
                                                   
                                                
                                                
                                                   −
                                                   a
                                                   
                                                
                                                
                                                   −
                                                   a
                                                   
                                                
                                                
                                                   a
                                                   
                                                
                                                
                                                   a
                                                   
                                                
                                                
                                                   −
                                                   a
                                                   
                                                
                                                
                                                   −
                                                   a
                                                   
                                                
                                                
                                                   a
                                                
                                             
                                             
                                                
                                                   d
                                                   
                                                
                                                
                                                   −
                                                   b
                                                   
                                                
                                                
                                                   e
                                                   
                                                
                                                
                                                   c
                                                   
                                                
                                                
                                                   −
                                                   c
                                                   
                                                
                                                
                                                   −
                                                   e
                                                   
                                                
                                                
                                                   b
                                                   
                                                
                                                
                                                   −
                                                   d
                                                
                                             
                                             
                                                
                                                   g
                                                   
                                                
                                                
                                                   −
                                                   f
                                                   
                                                
                                                
                                                   f
                                                   
                                                
                                                
                                                   −
                                                   g
                                                   
                                                
                                                
                                                   −
                                                   g
                                                   
                                                
                                                
                                                   f
                                                   
                                                
                                                
                                                   −
                                                   f
                                                   
                                                
                                                
                                                   g
                                                
                                             
                                             
                                                
                                                   e
                                                   
                                                
                                                
                                                   −
                                                   d
                                                   
                                                
                                                
                                                   c
                                                   
                                                
                                                
                                                   −
                                                   b
                                                   
                                                
                                                
                                                   b
                                                   
                                                
                                                
                                                   −
                                                   c
                                                   
                                                
                                                
                                                   d
                                                   
                                                
                                                
                                                   −
                                                   e
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                        
                     
                  

Using this similarity unified transform architectures have been proposed for use in coding standards such as AVC, AVS, VC-1 and HEVC [24]. These schemes provide flexible architecture and reasonable throughput with respect to area requirement. Although the form of transform kernels are same the actual values of coefficients used in various transforms vary significantly. It should also be noted that the unified architectures often employ row-column processing strategy for computation of 2D transform using 1D transforms. Hence, these designs will consist of transpose memory and their throughput will be less than the designs based on direct 2D computation architectures. The coefficients in H.264 and HEVC integer transforms are neither same nor multiple of each other. Hence, the matrix factorization proposed in this research work is for H.264 only and cannot be directly applied to HEVC. However, due to similarity in their kernel the decomposition technique considered can be applied to HEVC to achieve similar high throughput architectures. This however requires entirely new set of decomposition matrices and hence beyond the scope of this manuscript.

@&#CONCLUSION@&#

Shared resource architectures can be used to provide area vs. throughput optimized solution for 2D 
                        8
                        ×
                        8
                      and 
                        4
                        ×
                        4
                      integer transform computations for advanced video coding standard (AVC)/H.264. The proposed implementation uses a base design for high throughput 2D 
                        8
                        ×
                        8
                      integer transform computation. The intermediate data routing sections allows the use of the base circuit for high throughput 2D 
                        4
                        ×
                        4
                      integer transform computation, and relative to existing designs where only one data set can be processed at a time, the proposed circuit can perform high throughput 2D 
                        4
                        ×
                        4
                      integer transform computations for two independent data sets in parallel. Hence, the throughput of 2D 
                        4
                        ×
                        4
                      integer transform computations can be doubled without sacrificing the throughput of 2D 
                        8
                        ×
                        8
                      integer transform computations. When compared to existing shared resource designs, the gate count increases by less than 0.12 times while the corresponding throughput for the 2D 
                        4
                        ×
                        4
                      integer transform computation increases by 2 times. A high-frequency dual clock pipelined architecture is used in the proposed design to achieve a throughput of 18.7G pixels/sec for 2D 
                        8
                        ×
                        8
                      integer transform computation. Similarly, since two blocks of 
                        4
                        ×
                        4
                      pixels can be processed in parallel, the throughput of 
                        4
                        ×
                        4
                      integer transform is of 14G pixels/sec. Key design aspects, like a low gate count, high throughput and high design utilization ration, help the proposed design achieve real-time processing of H.264/MPEG-4 AVC high definition video.

If 
                        A
                      is an 
                        m
                        ×
                        n
                      matrix and 
                        B
                      is a 
                        p
                        ×
                        q
                      matrix, then the Kronecker product 
                        A
                        ⊗
                        B
                      is the 
                        m
                        p
                        ×
                        n
                        q
                      block matrix defined as [12]
                     
                        
                           (A.1)
                           
                              
                                 A
                                 ⊗
                                 B
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   11
                                                
                                             
                                             B
                                             
                                          
                                          
                                             ⋯
                                             
                                          
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   1
                                                   n
                                                
                                             
                                             B
                                          
                                       
                                       
                                          
                                             ⋮
                                             
                                          
                                          
                                             ⋱
                                             
                                          
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   m
                                                   1
                                                
                                             
                                             B
                                             
                                          
                                          
                                             ⋯
                                             
                                          
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   m
                                                   n
                                                
                                             
                                             B
                                          
                                       
                                    
                                    ]
                                 
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       m
                                       p
                                       ,
                                       n
                                       p
                                    
                                 
                                 (
                                 R
                                 /
                                 C
                                 )
                              
                           
                        
                     
                     
                        
                           (A.2)
                           
                              
                                 (
                                 α
                                 A
                                 )
                                 ⊗
                                 B
                                 =
                                 A
                                 ⊗
                                 (
                                 α
                                 B
                                 )
                                 =
                                 α
                                 (
                                 A
                                 ⊗
                                 B
                                 )
                                 =
                                 (
                                 A
                                 ⊗
                                 B
                                 )
                                 α
                              
                           
                        
                     
                     
                        
                           (A.3)
                           
                              
                                 
                                    
                                       (
                                       A
                                       ⊗
                                       B
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          T
                                       
                                    
                                    ⊗
                                    
                                       
                                          B
                                       
                                       
                                          T
                                       
                                    
                                    )
                                 
                              
                           
                        
                     
                  

The direct sum of matrices 
                        A
                      and 
                        B
                      is denoted with 
                        A
                        ⊕
                        B
                      and is defined as [12]
                     
                        
                           (A.4)
                           
                              
                                 A
                                 ⊕
                                 B
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             A
                                             
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                             
                                          
                                          
                                             B
                                          
                                       
                                    
                                    ]
                                 
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       (
                                       m
                                       +
                                       p
                                       )
                                       ,
                                       (
                                       n
                                       +
                                       q
                                       )
                                    
                                 
                                 (
                                 R
                                 /
                                 C
                                 )
                              
                           
                        
                     
                  

The linear transformation of any matrix 
                        X
                        ∈
                        
                           
                              M
                           
                           
                              n
                              ,
                              p
                           
                        
                        (
                        R
                        /
                        C
                        )
                      to 
                        Y
                        ∈
                        
                           
                              M
                           
                           
                              m
                              ,
                              q
                           
                        
                        (
                        R
                        /
                        C
                        )
                      given by 
                        
                           A
                           X
                           B
                        
                        =
                        Y
                      can be expressed as [12]
                     
                        
                           (A.5)
                           
                              
                                 
                                    (
                                    
                                       
                                          B
                                       
                                       
                                          T
                                       
                                    
                                    ⊗
                                    A
                                    )
                                 
                                 ⋅
                                 
                                    
                                       X
                                    
                                    
                                       vec
                                    
                                 
                                 =
                                 
                                    
                                       Y
                                    
                                    
                                       vec
                                    
                                 
                              
                           
                        
                      where, 
                        
                           
                              X
                           
                           
                              vec
                           
                        
                      and 
                        
                           
                              Y
                           
                           
                              vec
                           
                        
                      are the column-wise stacking vectors of 
                        X
                      and 
                        Y
                     , respectively, and “⋅” denotes the basic matrix multiplication.

@&#REFERENCES@&#

