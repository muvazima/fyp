@&#MAIN-TITLE@&#Supplier selection in the processed food industry under uncertainty

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present a stochastic programming model for supplier selection.


                        
                        
                           
                           We incorporate uncertainty in the demand and in the supplier operation.


                        
                        
                           
                           We propose an enhanced Benders decomposition algorithm for this problem.


                        
                        
                           
                           Sourcing actions vary between using an integrated and a decoupled approach.


                        
                        
                           
                           Solving a single master problem in the Benders decomposition is more efficient.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Supplier selection

Production-distribution planning

Perishability

Disjunctive programming

Benders decomposition

@&#ABSTRACT@&#


               
               
                  This paper addresses an integrated framework for deciding about the supplier selection in the processed food industry under uncertainty. The relevance of including tactical production and distribution planning in this procurement decision is assessed. The contribution of this paper is three-fold. Firstly, we propose a new two-stage stochastic mixed-integer programming model for the supplier selection in the process food industry that maximizes profit and minimizes risk of low customer service. Secondly, we reiterate the importance of considering main complexities of food supply chain management such as: perishability of both raw materials and final products; uncertainty at both downstream and upstream parameters; and age dependent demand. Thirdly, we develop a solution method based on a multi-cut Benders decomposition and generalized disjunctive programming. Results indicate that sourcing and branding actions vary significantly between using an integrated and a decoupled approach. The proposed multi-cut Benders decomposition algorithm improved the solutions of the larger instances of this problem when compared with a classical Benders decomposition algorithm and with the solution of the monolithic model.
               
            

@&#INTRODUCTION@&#

The importance of food supply chain management has been growing both at the industrial and scientific levels. The challenges faced in food supply chains are at the intersection of several disciplines and go beyond the traditional cost minimization concern. Particularly, in the process food industry, companies have to deal with higher uncertainties both upstream and downstream of the supply chain. These uncertainties are related to an ever increasing product variety, more demanding customers and a highly interconnected distribution network. This implies that companies operating in the process food industry need to manage the risk/cost trade-off without disregarding freshness, sustainability and corporate social responsibility issues (Maloni & Brown, 2006).

Effective and efficient decision support models and methods for supply chain planning are critical for this sector that is the largest manufacturing sector in Europe with a turnover of 1048 billion euros, employing over 4.2 million people (FoodDrink Europe, 2014). It is widely acknowledged that the standard tools for supply chain management perform poorly when applied to process food industries (Rajurkar & Jain, 2011). The characteristics of food supply chains are significantly different from other supply chains. The main difference is the continuous change in the quality of raw materials – from the time they are shipped from the grower to the time they are processed at the plant, and in the quality of final products – from the time they are shipped from the plant to the time they are consumed. Ahumada and Villalobos (2009) state that food supply chains are more complex and harder to manage than other supply chains. The shelf-lives of raw, intermediate and final goods together with the strong uncertainties in the whole chain challenge a good supply chain management and planning (Ahumada, Villalobos, & Mason, 2012). Despite the relevant specificities of process food industries, the consideration of perishability, customers’ willingness to pay and risk management at the strategic and planning levels has been seldom addressed in the literature.

The present work addresses the joint decision of choosing which suppliers to select, and the planning of procurement, production and distribution in a medium-term planning horizon. We focus on companies that process a main perishable raw material and convert it into perishable final food products. These conditions happen for instance in the dairy, fresh juices and tomato sauce industries. Within this scope we integrate strategic and tactical decisions in a common framework. We consider a setting in which companies have their plants and distribution channels well established and, therefore, the supply chain strategic decisions address the supplier selection and the related product branding. We classify the suppliers and the product branding as local or mainstream. This differentiation has already been made for the agri-business (Ata, Lee, & Tongarlak, 2012), but never for the food processing industry. However, there are several practical examples of the leverage than can be achieved in the customers’ willingness to pay by branding a product as local, and correspondingly sourcing raw materials from local suppliers (Frash, DiPietro, & Smith, 2015; Martinez, 2010; Oberholtzer, Dimitri, & Jaenicke, 2014). Therefore, the demand and the list price is assumed higher for fresh products that are branded and produced with local raw materials. In contrast, a similar product with a low remaining shelf-life and produced with mainstream raw materials has a lower demand and a lower list price.

Within this context, we propose a two-stage stochastic mixed-integer programming model to tackle this supplier selection problem. In the first-stage we decide the branding of products and the quantities to be procured in advance from each supplier. In the second-stage, we decide on the produced and transported quantities as well as on the quantities procured in the spot market. Uncertainties relate to the suppliers’ raw material availability, suppliers’ lead time, suppliers’ spot market prices and demand for final products.

The different sources of uncertainty in this supplier selection problem render the corresponding stochastic programming model hard to solve as a considerable number of scenarios have to be considered. Therefore, to solve this problem we propose a multi-cut Benders decomposition method. Moreover, to improve its convergence we test several acceleration techniques.

The remainder of this paper is as follows. Section 2 reviews relevant contributions in the supplier selection problem. Section 3 describes formally the problem and the proposed mathematical formulations. Section 4 is devoted to the model validation through an illustrative example. In particular, the importance of considering uncertainty, the integration of the supplier selection with tactical planning decisions, and the impact of a risk-averse strategy are discussed. Section 5 presents the implementation of a multi-cut Benders decomposition algorithm for this problem. Section 6 reports computational results for larger instances. Finally, Section 7 draws the main conclusions and indicates future lines of research.

@&#LITERATURE REVIEW@&#

The research on supplier selection problems has been traditionally divided between the operations management community that seeks an intuitive understanding of this problem, and the operations research community that explores the advantages of structuring this decision process and unveils hidden trade-offs through the use of techniques, such as mathematical programming (De Boer, Labro, & Morlacchi, 2001). For a thorough review of quantitative methods for the supplier selection problem the readers are referred to Ho, Xu, and Dey (2010).

Most of the approaches to tackle the supplier selection problem are based on the Analytic Hierarchy Process (AHP) method to help decision makers in dealing with both uncertainty and subjectivity (Deng, Hu, Deng, & Mahadevan, 2014). There are also examples of works that combine AHP with other techniques, such as fuzzy linear programming (Sevkli, Koh, Zaim, Demirbag, & Tatoglu, 2008). Data Envelopment Analysis (DEA) is also another widely used technique for supplier selection problems. For example, Kumar, Jain, and Kumar (2014) propose a methodology for the supplier selection taking into consideration the carbon footprints of suppliers as an attribute of the DEA model.

The most straightforward extension to the supplier selection problem is to couple it with decisions about inventory management (Aissaoui, Haouari, & Hassini, 2007). Guo and Li (2014) integrate supplier selection and inventory management for multi-echelon systems. Other works incorporate other decisions, such as the carrier selection, besides determining the ordering quantities (Choudhary & Shankar, 2014).

More recently, researchers have started to address other relevant aspects that can be studied under this general problem. Chen and Guo (2014) study the importance of supplier selection in competitive markets, and indicated that besides the more evident conclusion that dual sourcing can help to mitigate supply chain risks, strategic sourcing can also be an effective tool in approaching retail competition. Qian (2014) develops an analytic approach that incorporates extensive market data when determining the supplier selection in a make-to-order production strategy. With a more practical emphasis, Hong and Lee (2013) lay the foundations of a decision support system for effective risk-management when selecting suppliers in a spot market using measures similar to the Conditional Value-at-Risk (Rockafellar & Uryasev, 2000, 2002), such as the Expected Profit-Supply at Risk. Another relevant aspect is disruption management, especially regarding the suppliers’ availability. Silbermayr and Minner (2014) develop an analytic model based on Markov decision processes in which suppliers may be completely unavailable at a given (stochastic) interval of time. Due to the complexity of the optimal ordering policies, they also derive a heuristic approach.

Uncertainty has been incorporated in supplier selection problems either through stochastic programming or simulation. Moreover, distinct sources of uncertainty and different distributions for these uncertainties have been considered. Using a hybrid simulation optimization methodology, Ding, Benyoucef, and Xie (2005) are able to estimate the impact of the supplier selection on the tactical processes of the supply chain, and use this information back in the decision about which suppliers to select. Stochastic programming has proved to be a suitable methodology to address complex issues involved in supplier selection. Sawik (2013) proposes a similar model to the one presented in this paper as it is able to deal with multiple periods and it accounts for uncertainty through stochastic programming. Hammami, Temponi, and Frein (2014) propose a model for supplier selection considering uncertainty on the currency fluctuation. Through a case-study, the authors were able to show the value of the stochastic solution when compared to the deterministic model.

In light of this discussion, the main contributions of this paper to the supplier selection literature relate to accounting for uncertainty in the lead time, the consideration of distribution decisions and the emphasis on the characteristics of processed food industries. This last point is in line with an ongoing discussion about the sustainability and profitability of local sourcing for processed food industries (Schönhart, Penker, & Schmid, 2009).

In terms of solution methods, as the complexity of our problem required the use of a more sophisticated approach rather than solving the monolithic model, we show the applicability of a multi-cut Benders decomposition method to this supplier selection problem. Moreover, we show that the valid inequalities that can be obtained from a generalized disjunctive programming formulation (Raman & Grossmann, 1994) can be used in order to tighten the Benders master problem.
                  

This section describes the supplier selection problem for supply chains in the processed food industry and the mathematical models that have been developed. Let 
                        
                           k
                           =
                           1
                           ,
                           …
                           ,
                           K
                        
                      be the products that are produced in the different factories (
                        
                           f
                           ∈
                           F
                        
                     ). To produce these products the factories have to procure raw materials from the different available suppliers (
                        
                           s
                           ∈
                           S
                        
                     ). These raw materials are classified either as mainstream (
                        
                           u
                           =
                           0
                        
                     ) or local (
                        
                           u
                           =
                           1
                        
                     ) depending on the distance between the supplier and the customers. Notice that the focus is on a divergent production structure in which a main raw material (milk, oranges or tomatoes, for example) is transformed into several final products that vary only in the packaging or in the incorporation of small amounts of other ingredients. The planning horizon is divided into periods 
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                     . These periods correspond to months as we are dealing with tactical planning. After production, which can take place in regular schedules or overtime, products are transferred to retailers (
                        
                           r
                           ∈
                           R
                        
                     ), which face an uncertain demand (
                        
                           D
                           
                              k
                              t
                              r
                           
                           
                              a
                              v
                           
                        
                     ) that also depends on the products’ age 
                        
                           a
                           ∈
                           
                              A
                              k
                           
                           =
                           
                              {
                              0
                              ,
                              …
                              ,
                              
                                 (
                                 S
                                 
                                    L
                                    k
                                 
                                 −
                                 1
                                 )
                              
                              }
                           
                           ,
                        
                      where SLk
                      corresponds to the shelf-life of product k. Notice that raw materials also have limited age, 
                        
                           a
                           ∈
                           
                              A
                              u
                           
                           =
                           
                              {
                              0
                              ,
                              …
                              ,
                              
                                 (
                                 
                                    
                                       
                                          S
                                          L
                                       
                                       ^
                                    
                                    u
                                 
                                 −
                                 1
                                 )
                              
                              }
                           
                           ,
                        
                      where 
                        
                           
                              
                                 S
                                 L
                              
                              ^
                           
                           u
                        
                      corresponds to the shelf-life of raw material u.

The stochastic data is initially given by continuous distributions and it is then modeled on some probability space, where V is a set of discrete scenarios with corresponding probabilities of occurrence ϕv
                     , such that ϕv
                      > 0 and 
                        
                           
                              ∑
                              v
                           
                           
                              ϕ
                              v
                           
                           =
                           1
                        
                     . This discretization relates to the sampling strategy used in the computational experiments. In our two-stage stochastic program, we define the quantities to procure in advance from each supplier (stsf
                     ) and the branding strategy for each product: local (
                        
                           
                              χ
                              k
                           
                           =
                           1
                        
                     ) or mainstream (
                        
                           
                              χ
                              k
                           
                           =
                           0
                        
                     ) as first-stage decisions. Notice that when a product is branded as local it has to be produced only using local raw materials, whereas when a product is branded as mainstream, it is possible to use a dual sourcing strategy, and therefore procure raw materials from local and mainstream suppliers. Procured quantities in the spot market (
                        
                           
                              s
                              ¯
                           
                           
                              t
                              s
                              f
                           
                           v
                        
                     ), production quantities in regular schedules and in overtime (
                        
                           p
                           
                              k
                              u
                              f
                              t
                           
                           
                              a
                              v
                           
                        
                      and 
                        
                           
                              p
                              ¯
                           
                           
                              k
                              u
                              f
                              t
                           
                           
                              a
                              v
                           
                        
                     ), transportation flows (
                        
                           x
                           
                              k
                              t
                              f
                              r
                           
                           v
                        
                     ), inventory levels of both raw materials (
                        
                           
                              w
                              ^
                           
                           
                              u
                              t
                              f
                           
                           
                              a
                              v
                           
                        
                     ) and final products (
                        
                           w
                           
                              k
                              t
                              r
                           
                           
                              a
                              v
                           
                        
                     ), and demand satisfaction (
                        
                           ψ
                           
                              k
                              u
                              t
                              r
                           
                           
                              a
                              v
                           
                        
                     ) are the second-stage decisions.

When making the first-stage decisions there are four sources of uncertainty to be considered. The first regards the demand for final products that is not known with certainty when negotiating contracts with suppliers and while deciding the branding strategy for each product. This reflects the real-world setting in which demand for fast moving consumer food goods is highly variable. The other three sources of uncertainty are related to the suppliers of raw materials: availability, lead time and spot price. While local suppliers have more uncertainty in the available quantities to be delivered over the planning horizon, mainstream suppliers have larger and more volatile lead times. Generally, local suppliers manage less structured operations and are harder to be engaged in risk mitigating strategies, such as production in several locations. Mainstream suppliers are by definition located in farther locations, and therefore their lead times usually contain more variability. For a thorough review on the characteristics of these two types of suppliers the readers are referred to King (2010). Regarding the spot price, it usually depends more on the negotiation undertaken and on the yields of that period than on the type of supplier. Negotiating in the spot market has a critical component of price uncertainty that is reflected in our model. Fig. 1 illustrates the general problem framework and clarifies the connection between the formulation stages and the supply chain processes. Consider the following indices, parameters, and decision variables that are used in the stochastic programming formulation.

                        Indices and sets


                        
                           
                              
                                 k
                                 ∈
                                 K
                              
                           
                        
                        
                           final products

supplier/raw material classification: 0 for mainstream, 1 for local

suppliers

factories

retailers

periods

ages (in periods)

scenarios

set of suppliers that supply raw material of type u
                           

set of ages that product k may have

set of ages that raw material u may have

unit purchasing cost of raw material when bought in advance at supplier s
                           

transportation cost from supplier s (factory f) to factory f (retailer r)

shelf-life duration of product k (raw material u) right after being produced (time)

holding cost for product k (raw material u)

normal (extra) production cost for product k when produced in factory f
                           

list price for product k when branded as product of type u
                           

capacity consumption (time) needed to produce one unit of product k in factory f
                           

normal (extra) capacity of factory f available in period t
                           

demand at retailer r for product k with age a in period t in scenario v
                           

lead time offset of a shipment due to arrive in period t from supplier s in scenario v
                           

unit purchasing cost of raw material when bought in a spot deal from supplier s in scenario v
                           

availability of raw material at supplier s for supplying in period t in scenario v
                           

probability of occurrence of scenario v
                           

quantity of raw material procured in advance from supplier s in period t for supplying factory f
                           

equals 1, if product k is produced using only local raw materials (0 otherwise)

value-at-risk of the customer service

auxiliary variable that quantifies the amount of raw material procured in advance from supplier s that arrives in period t with age a for supplying factory f in scenario v
                           

quantity of raw material procured with a spot deal from supplier s in period t for supplying factory f in scenario v
                           

regular (overtime) produced quantity of product k in factory f using raw materials of type u with age a in period t and scenario v
                           

transported quantity of product k from factory f to retailer r in period t and scenario v
                           

initial inventory of product k (raw material u) with age a in period t in scenario v at retailer r (factory f), 
                                 
                                    a
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    min
                                    
                                       {
                                       S
                                       
                                          L
                                          k
                                       
                                       ,
                                       t
                                       −
                                       1
                                       }
                                    
                                    
                                       (
                                       a
                                       =
                                       0
                                       ,
                                       …
                                       ,
                                       min
                                       
                                          {
                                          
                                             
                                                
                                                   S
                                                   L
                                                
                                                ^
                                             
                                             u
                                          
                                          ,
                                          t
                                          −
                                          1
                                          }
                                       
                                       )
                                    
                                 
                              
                           

fraction of the demand for product k produced with suppliers of type u delivered with age a in period t in scenario v from retailer r, 
                                 
                                    a
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    min
                                    {
                                    S
                                    
                                       L
                                       k
                                    
                                    −
                                    1
                                    ,
                                    t
                                    −
                                    1
                                    }
                                 
                              
                           

auxiliary variable for calculating the conditional value-at-risk of the customer service

The mixed-integer linear programming formulation of the problem is described next. The constraints that this problem is subject to are organized around the respective supply chain echelon.

The first part of objective function (1) maximizes the profit of the producer over the tactical planning horizon. Expected revenue, which depends on the products’ branding is subtracted by supply chain related costs: purchasing costs of raw materials, both when bought in advance and or in the spot market, holding costs for raw materials and final products, transportation costs between the supply chain nodes, and normal and extra production costs. The second part the objective function (starting with γ) maximizes the conditional value-at-risk of the customer service. This measure reflects the expected customer service of the 
                           
                              (
                              1
                              −
                              α
                              )
                              
                              ×
                              
                              100
                           
                         percent scenarios that yield the lowest customer service. For that purpose, the conditional value-at-risk of the customer service accounts for the expected customer service below a measure η (value-at-risk of the customer service) at the confidence level α. The value-at-risk of the customer service is the maximum customer service such that its probability of being lower than or equal to this value is lower than or equal to (
                           
                              1
                              −
                              α
                           
                        ). This is an adaptation of the Conditional Value-at-Risk (Rockafellar & Uryasev, 2000, 2002) focusing on the customer service. Similar concepts, such as the supply-at-risk (SaR) were developed in an analogous context (Hong & Lee, 2013). The incorporation of risk-measures in supplier selection problems with a narrower scope have already been proposed by other authors (e.g. Sawik, 2013). The main advantage of the resulting risk-averse models is the ability to reshape the profit distribution in such a way that the worst-case scenarios are drastically reduced. Moreover, similar risk-averse models have proved to be quite effective in the food industry (Amorim, Alem, & Almada-Lobo, 2013). The risk-aversion of the solution is controlled by weight parameter γ.

                           
                              (1)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             max
                                             
                                                ∑
                                                v
                                             
                                             
                                                ϕ
                                                v
                                             
                                             [
                                             
                                                ∑
                                                
                                                   k
                                                   ,
                                                   u
                                                   ,
                                                   t
                                                   ,
                                                   r
                                                   ,
                                                   a
                                                
                                             
                                             L
                                             
                                                P
                                                
                                                   k
                                                   u
                                                
                                             
                                             ·
                                             
                                                D
                                                
                                                   k
                                                   t
                                                   r
                                                
                                                
                                                   0
                                                   v
                                                
                                             
                                             ·
                                             
                                                ψ
                                                
                                                   k
                                                   u
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   k
                                                   ,
                                                   t
                                                   ,
                                                   r
                                                   ,
                                                   a
                                                   <
                                                   S
                                                   
                                                      L
                                                      k
                                                   
                                                
                                             
                                             H
                                             
                                                C
                                                k
                                             
                                             ·
                                             
                                                w
                                                
                                                   k
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             −
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   ,
                                                   t
                                                   ,
                                                   f
                                                   ,
                                                   r
                                                
                                             
                                             
                                                
                                                   
                                                      T
                                                      C
                                                   
                                                   ^
                                                
                                                
                                                   f
                                                   r
                                                
                                             
                                             ·
                                             
                                                x
                                                
                                                   k
                                                   t
                                                   f
                                                   r
                                                
                                                v
                                             
                                             −
                                             
                                                ∑
                                                
                                                   k
                                                   ,
                                                   u
                                                   ,
                                                   t
                                                   ,
                                                   f
                                                   ,
                                                   a
                                                
                                             
                                             
                                                (
                                                P
                                                
                                                   C
                                                   
                                                      k
                                                      f
                                                   
                                                
                                                ·
                                                
                                                   p
                                                   
                                                      k
                                                      u
                                                      t
                                                      f
                                                   
                                                   
                                                      a
                                                      v
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         P
                                                         C
                                                      
                                                      ¯
                                                   
                                                   
                                                      k
                                                      f
                                                   
                                                
                                                ·
                                                
                                                   
                                                      p
                                                      ¯
                                                   
                                                   
                                                      k
                                                      u
                                                      t
                                                      f
                                                   
                                                   
                                                      a
                                                      v
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             −
                                             
                                             
                                                ∑
                                                
                                                   u
                                                   ,
                                                   t
                                                   ,
                                                   f
                                                   ,
                                                   a
                                                   <
                                                   
                                                      
                                                         
                                                            S
                                                            L
                                                         
                                                         ^
                                                      
                                                      u
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      H
                                                      C
                                                   
                                                   ^
                                                
                                                u
                                             
                                             ·
                                             
                                                
                                                   w
                                                   ^
                                                
                                                
                                                   u
                                                   t
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   s
                                                   ,
                                                   f
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         S
                                                         P
                                                      
                                                      ¯
                                                   
                                                   
                                                      s
                                                   
                                                   v
                                                
                                                +
                                                T
                                                
                                                   C
                                                   
                                                      s
                                                      f
                                                   
                                                
                                                )
                                             
                                             ·
                                             
                                                
                                                   s
                                                   ¯
                                                
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                v
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             −
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ,
                                                   s
                                                   ,
                                                   f
                                                   ,
                                                   a
                                                
                                             
                                             
                                                (
                                                S
                                                
                                                   P
                                                   s
                                                
                                                +
                                                T
                                                
                                                   C
                                                   
                                                      s
                                                      f
                                                   
                                                
                                                )
                                             
                                             ·
                                             
                                                τ
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ]
                                             +
                                             γ
                                             ·
                                             
                                                (
                                                η
                                                −
                                                
                                                   1
                                                   
                                                      1
                                                      −
                                                      α
                                                   
                                                
                                                
                                                   ∑
                                                   v
                                                
                                                
                                                   ϕ
                                                   v
                                                
                                                ·
                                                
                                                   δ
                                                   v
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Decision variable η retrieves an approximation of the customer service value-at-risk and the auxiliary variable δv
                         is defined using Eq. (2). The equation defines variable δv
                         making it zero when the customer service in a given scenario is higher that the customer service value-at-risk. Otherwise, variable δv
                         determines the difference between the customer service value-at-risk and the corresponding mean customer service of the scenario. Fig. 2
                         shows a graphical representation of the customer service conditional value-at-risk. The graph represents the distribution of the random customer service (ω). The customer service conditional value-at-risk is given by 
                           
                              E
                              [
                              ω
                              |
                              ω
                              ≤
                              V
                              a
                              
                                 R
                                 α
                              
                              
                                 (
                                 ω
                                 )
                              
                              ]
                              ,
                           
                         where VaRα
                        (ω) is the value-at-risk of the customer service with a confidence of α.

                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             
                                                δ
                                                v
                                             
                                             ≥
                                             η
                                             −
                                             
                                                ∑
                                                
                                                   k
                                                   ,
                                                   u
                                                   ,
                                                   t
                                                   ,
                                                   r
                                                   ,
                                                   a
                                                   ∈
                                                   
                                                      A
                                                      k
                                                   
                                                
                                             
                                             
                                                ψ
                                                
                                                   k
                                                   u
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             
                                             ∀
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Eq. (3) translates the first stage decision that defines the quantity and the arrival time of raw material from each supplier (stsf
                        ) to a second stage decision variable (
                           
                              τ
                              
                                 t
                                 s
                                 f
                              
                              
                                 a
                                 v
                              
                           
                        ) that is affected by the uncertainty on the lead time (
                           
                              L
                              
                                 T
                                 
                                    t
                                    s
                                 
                                 v
                              
                           
                        ) and by the availability of the supplier (
                           
                              A
                              
                                 Q
                                 
                                    t
                                    s
                                 
                                 v
                              
                           
                        ). Lead time uncertainty offsets both the arrival time and the age of the product. Therefore, if 
                           
                              L
                              
                                 T
                                 
                                    t
                                    c
                                 
                                 v
                              
                              =
                              2
                           
                         then a product that was supposed to arrive on 
                           
                              t
                              =
                              2
                           
                         with age 0, will arrive on 
                           
                              t
                              =
                              4
                           
                         with age 2 in scenario v. The availability 
                           
                              A
                              
                                 Q
                                 
                                    t
                                    s
                                 
                                 v
                              
                           
                         is defined a fraction between 0 and 1. The domain of variable 
                           
                              τ
                              
                                 t
                                 s
                                 f
                              
                              
                                 a
                                 v
                              
                           
                         is extended in the temporal dimension to accommodate for arrivals outside the planning horizon. The utilization of this raw material is not possible in the current planning horizon.

                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                                τ
                                                
                                                   t
                                                   +
                                                   L
                                                   
                                                      T
                                                      
                                                         t
                                                         s
                                                      
                                                      v
                                                   
                                                   ,
                                                   s
                                                   f
                                                
                                                
                                                   L
                                                   
                                                      T
                                                      
                                                         t
                                                         s
                                                      
                                                      v
                                                   
                                                   ,
                                                   v
                                                
                                             
                                             =
                                             A
                                             
                                                Q
                                                
                                                   t
                                                   s
                                                
                                                v
                                             
                                             ·
                                             
                                                s
                                                
                                                   t
                                                   s
                                                   f
                                                
                                             
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             
                                             s
                                             ∈
                                             S
                                             ,
                                             
                                             
                                             f
                                             ∈
                                             F
                                             ,
                                             
                                             
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Over the entire planning horizon it is also important to enforce that the amount of product arriving with different ages is equal to the quantities that the producer has ordered discounted by the availability (4).

                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   ,
                                                   a
                                                   ∈
                                                   
                                                      A
                                                      u
                                                   
                                                
                                             
                                             
                                                τ
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             =
                                             
                                                ∑
                                                t
                                             
                                             A
                                             
                                                Q
                                                
                                                   t
                                                   s
                                                
                                                v
                                             
                                             ·
                                             
                                                s
                                                
                                                   t
                                                   s
                                                   f
                                                
                                             
                                             
                                             
                                             ∀
                                             s
                                             ∈
                                             S
                                             ,
                                             
                                             
                                             f
                                             ∈
                                             F
                                             ,
                                             
                                             
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Eq. (5) indicates that the inventory amount of raw material available to process at factory f with age 0 is equivalent to the amount bought in the spot market and bought in advance when there were no delivery delays.

                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   
                                                      S
                                                      u
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   τ
                                                   
                                                      t
                                                      s
                                                      f
                                                   
                                                   
                                                      0
                                                      v
                                                   
                                                
                                                +
                                                
                                                   
                                                      s
                                                      ¯
                                                   
                                                   
                                                      t
                                                      s
                                                      f
                                                   
                                                   v
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   w
                                                   ^
                                                
                                                
                                                   u
                                                   t
                                                   f
                                                
                                                
                                                   0
                                                   v
                                                
                                             
                                             
                                             
                                             ∀
                                             u
                                             ∈
                                             U
                                             ,
                                             
                                             
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             
                                             f
                                             ∈
                                             F
                                             ,
                                             
                                             
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Eq. (6) is an inventory balance constraint for the stock of the raw materials. It also updates the age of the raw material stock and takes into account the raw materials arriving with older ages (larger than 0). Notice that the domain of the inventory variables is constrained in its definition in the beginning of Section 3.

                           
                              (6)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                   ^
                                                
                                                
                                                   u
                                                   t
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             =
                                             
                                                
                                                   w
                                                   ^
                                                
                                                
                                                   u
                                                   ,
                                                   t
                                                   −
                                                   1
                                                   ,
                                                   f
                                                
                                                
                                                   a
                                                   −
                                                   1
                                                   ,
                                                   v
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   
                                                      S
                                                      u
                                                   
                                                
                                             
                                             
                                                τ
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             −
                                             
                                                ∑
                                                k
                                             
                                             
                                                (
                                                
                                                   p
                                                   
                                                      k
                                                      u
                                                      ,
                                                      t
                                                      −
                                                      1
                                                      ,
                                                      f
                                                   
                                                   
                                                      a
                                                      −
                                                      1
                                                      ,
                                                      v
                                                   
                                                
                                                +
                                                
                                                   
                                                      p
                                                      ¯
                                                   
                                                   
                                                      k
                                                      u
                                                      ,
                                                      t
                                                      −
                                                      1
                                                      ,
                                                      f
                                                   
                                                   
                                                      a
                                                      −
                                                      1
                                                      ,
                                                      v
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             ∀
                                             u
                                             ∈
                                             U
                                             ,
                                             t
                                             ∈
                                             
                                                {
                                                2
                                                ,
                                                …
                                                ,
                                                T
                                                +
                                                1
                                                }
                                             
                                             ,
                                             f
                                             ∈
                                             F
                                             ,
                                             a
                                             ∈
                                             
                                                A
                                                u
                                             
                                             :
                                             a
                                             ≥
                                             1
                                             ,
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Eq. (7) forces the utilization of local raw material in case the product is branded as local.

                           
                              (7)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                p
                                                
                                                   k
                                                   0
                                                   t
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             +
                                             
                                                
                                                   p
                                                   ¯
                                                
                                                
                                                   k
                                                   0
                                                   t
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ≤
                                             M
                                             
                                                (
                                                1
                                                −
                                                
                                                   χ
                                                   k
                                                
                                                )
                                             
                                             
                                             
                                             ∀
                                             k
                                             ∈
                                             K
                                             ,
                                             
                                             
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             f
                                             ∈
                                             F
                                             ,
                                             
                                             
                                             a
                                             ∈
                                             
                                                A
                                                u
                                             
                                             :
                                             u
                                             =
                                             0
                                             ,
                                             
                                             
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Eqs. (8) and (9) limit both normal and extra production to the available factory capacity, respectively.

                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ,
                                                   u
                                                   ,
                                                   a
                                                   ∈
                                                   
                                                      A
                                                      u
                                                   
                                                
                                             
                                             
                                                E
                                                
                                                   k
                                                   f
                                                
                                             
                                             
                                                p
                                                
                                                   k
                                                   u
                                                   t
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ≤
                                             C
                                             
                                                P
                                                
                                                   f
                                                   t
                                                
                                             
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             
                                             f
                                             ∈
                                             F
                                             ,
                                             
                                             
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ,
                                                   u
                                                   ,
                                                   a
                                                   ∈
                                                   
                                                      A
                                                      u
                                                   
                                                
                                             
                                             
                                                E
                                                
                                                   k
                                                   f
                                                
                                             
                                             
                                                
                                                   p
                                                   ¯
                                                
                                                
                                                   k
                                                   u
                                                   t
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ≤
                                             
                                                
                                                   
                                                      C
                                                      P
                                                   
                                                   ¯
                                                
                                                
                                                   f
                                                   t
                                                
                                             
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             
                                             f
                                             ∈
                                             F
                                             ,
                                             
                                             
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Eq. (10) forces all production made in the different factories to flow to retailers within the same planning period.

                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   u
                                                   ,
                                                   a
                                                   ∈
                                                   
                                                      A
                                                      u
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   p
                                                   
                                                      k
                                                      u
                                                      t
                                                      f
                                                   
                                                   
                                                      a
                                                      v
                                                   
                                                
                                                +
                                                
                                                   
                                                      p
                                                      ¯
                                                   
                                                   
                                                      k
                                                      u
                                                      t
                                                      f
                                                   
                                                   
                                                      a
                                                      v
                                                   
                                                
                                                )
                                             
                                             =
                                             
                                                ∑
                                                r
                                             
                                             
                                                x
                                                
                                                   k
                                                   t
                                                   f
                                                   r
                                                
                                                v
                                             
                                             
                                             
                                             ∀
                                             k
                                             ∈
                                             K
                                             ,
                                             
                                             
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             
                                             f
                                             ∈
                                             F
                                             ,
                                             
                                             
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The amount of final products entering each retailer corresponds to the inventory available to satisfy demand with age 0 (11). Therefore, notice that after processing the raw materials, the age of the final products is always set to 0.

                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                f
                                             
                                             
                                                x
                                                
                                                   k
                                                   t
                                                   f
                                                   r
                                                
                                                v
                                             
                                             =
                                             
                                                w
                                                
                                                   k
                                                   t
                                                   r
                                                
                                                
                                                   0
                                                   v
                                                
                                             
                                             
                                             
                                             ∀
                                             k
                                             ∈
                                             K
                                             ,
                                             
                                             
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             
                                             r
                                             ∈
                                             R
                                             ,
                                             
                                             
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Eqs. (12) and (13) link the choice on the product branding as local (
                           
                              
                                 χ
                                 k
                              
                              =
                              1
                              ,
                              u
                              =
                              1
                           
                        ) or mainstream (
                           
                              
                                 χ
                                 k
                              
                              =
                              0
                              ,
                              u
                              =
                              0
                           
                        ) to the type of demand fulfilled that will determine the list price that the customer pays. These constraints define the revenue of the solution with the first term of the objective function (1).

                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                ψ
                                                
                                                   k
                                                   0
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ≤
                                             1
                                             −
                                             
                                                χ
                                                k
                                             
                                             
                                             
                                             ∀
                                             k
                                             ∈
                                             K
                                             ,
                                             
                                             
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             
                                             r
                                             ∈
                                             R
                                             ,
                                             
                                             
                                             a
                                             ∈
                                             
                                                A
                                                k
                                             
                                             ,
                                             
                                             
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                ψ
                                                
                                                   k
                                                   1
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ≤
                                             
                                                χ
                                                k
                                             
                                             
                                             
                                             ∀
                                             k
                                             ∈
                                             K
                                             ,
                                             
                                             
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             
                                             r
                                             ∈
                                             R
                                             ,
                                             
                                             
                                             a
                                             ∈
                                             
                                                A
                                                k
                                             
                                             ,
                                             
                                             
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Eq. (14) is another inventory balance constraint, but this time in the retailers premises for final products. This constraint updates the age of final products’ inventory throughout the planning periods.

                           
                              (14)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                w
                                                
                                                   k
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             =
                                             
                                                w
                                                
                                                   k
                                                   ,
                                                   t
                                                   −
                                                   1
                                                   ,
                                                   r
                                                
                                                
                                                   a
                                                   −
                                                   1
                                                   ,
                                                   v
                                                
                                             
                                             −
                                             
                                                ∑
                                                u
                                             
                                             
                                                D
                                                
                                                   k
                                                   ,
                                                   t
                                                   −
                                                   1
                                                   ,
                                                   r
                                                
                                                
                                                   0
                                                   v
                                                
                                             
                                             
                                                ψ
                                                
                                                   k
                                                   u
                                                   ,
                                                   t
                                                   −
                                                   1
                                                   ,
                                                   r
                                                
                                                
                                                   a
                                                   −
                                                   1
                                                   ,
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             ∀
                                             k
                                             ∈
                                             K
                                             ,
                                             
                                             
                                             t
                                             ∈
                                             
                                                {
                                                2
                                                ,
                                                …
                                                ,
                                                
                                                   (
                                                   T
                                                   +
                                                   1
                                                   )
                                                
                                                }
                                             
                                             ,
                                             
                                             
                                             r
                                             ∈
                                             R
                                             ,
                                             
                                             
                                             a
                                             ∈
                                             
                                                A
                                                k
                                             
                                             :
                                             a
                                             ≥
                                             1
                                             ,
                                             
                                             
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Eq. (15) keeps the demand fulfilled at different inventory ages below the respective demand profile (Amorim, Costa, & Almada-Lobo, 2014).

                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                u
                                             
                                             
                                                D
                                                
                                                   k
                                                   t
                                                   r
                                                
                                                
                                                   0
                                                   v
                                                
                                             
                                             
                                                ψ
                                                
                                                   k
                                                   u
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ≤
                                             
                                                D
                                                
                                                   k
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             
                                             
                                             ∀
                                             k
                                             ∈
                                             P
                                             ,
                                             
                                             
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             
                                             r
                                             ∈
                                             R
                                             ,
                                             
                                             
                                             a
                                             ∈
                                             
                                                A
                                                k
                                             
                                             ,
                                             
                                             
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Eq. (16) ensures that the demand fulfilled with different ages is always below the demand that the customer would be willing to pay for the product in the fresher state.

                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   u
                                                   ,
                                                   a
                                                   ∈
                                                   
                                                      A
                                                      k
                                                   
                                                
                                             
                                             
                                                ψ
                                                
                                                   k
                                                   u
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ≤
                                             1
                                             
                                             
                                             ∀
                                             k
                                             ∈
                                             K
                                             ,
                                             
                                             
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             
                                             r
                                             ∈
                                             R
                                             ,
                                             
                                             
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                s
                                                
                                                   t
                                                   s
                                                   f
                                                
                                             
                                             ,
                                             
                                                τ
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                v
                                             
                                             ,
                                             
                                                
                                                   s
                                                   ¯
                                                
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                v
                                             
                                             ,
                                             
                                                w
                                                
                                                   k
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ,
                                             
                                                
                                                   w
                                                   ^
                                                
                                                
                                                   u
                                                   t
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ,
                                             
                                                p
                                                
                                                   k
                                                   u
                                                   t
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                   ¯
                                                
                                                
                                                   k
                                                   u
                                                   t
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ,
                                             
                                                x
                                                
                                                   k
                                                   t
                                                   f
                                                   r
                                                
                                                v
                                             
                                             ,
                                             
                                                ψ
                                                
                                                   k
                                                   u
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ,
                                             
                                                δ
                                                v
                                             
                                             ≥
                                             0
                                             ;
                                             
                                                χ
                                                k
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             ;
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             η
                                             ∈
                                             ℜ
                                             
                                             
                                             ∀
                                             k
                                             ∈
                                             K
                                             ,
                                             
                                             u
                                             ∈
                                             U
                                             ,
                                             a
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             s
                                             ∈
                                             S
                                             ,
                                             
                                             f
                                             ∈
                                             F
                                             ,
                                             
                                             r
                                             ∈
                                             R
                                             ,
                                             
                                             v
                                             ∈
                                             V
                                             
                                             
                                             
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           Property 3.1
                           The supplier selection problem for supply chains in the processed food industry (1)–(17) has complete recourse, i.e., there exists a feasible second-stage decision for every first-stage decision and independently of the uncertainties (Wets, 1983).

The supplier selection for supply chains in the processed food industry may be formulated with generalized disjunctive programming (GDP) (Raman & Grossmann, 1994). With GDP the different boolean decisions are represented through disjunctions. These disjunctions are then related through propositions. After having a problem formulated using GDP it is possible to derive other formulations, such as big-M (Nemhauser & Wolsey, 1988) or convex hull reformulations (Balas, 1985). For an overview of the fundamentals of GDP please refer to Castro and Grossmann (2012); Grossmann and Trespalacios (2013).

One possible GDP formulation of the problem addressed in this paper is formalized next. Boolean variables Yk
                         indicate if product k is branded as local.

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             max
                                             
                                                ∑
                                                v
                                             
                                             
                                                ϕ
                                                v
                                             
                                             [
                                             
                                                ∑
                                                
                                                   k
                                                   ,
                                                   u
                                                   ,
                                                   t
                                                   ,
                                                   r
                                                   ,
                                                   a
                                                
                                             
                                             L
                                             
                                                P
                                                
                                                   k
                                                   u
                                                
                                             
                                             ·
                                             
                                                D
                                                
                                                   k
                                                   t
                                                   r
                                                
                                                
                                                   0
                                                   v
                                                
                                             
                                             ·
                                             
                                                ψ
                                                
                                                   k
                                                   u
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   k
                                                   ,
                                                   t
                                                   ,
                                                   r
                                                   ,
                                                   a
                                                   <
                                                   S
                                                   
                                                      L
                                                      k
                                                   
                                                
                                             
                                             H
                                             
                                                C
                                                k
                                             
                                             ·
                                             
                                                w
                                                
                                                   k
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             −
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   ,
                                                   t
                                                   ,
                                                   f
                                                   ,
                                                   r
                                                
                                             
                                             
                                                
                                                   
                                                      T
                                                      C
                                                   
                                                   ^
                                                
                                                
                                                   f
                                                   r
                                                
                                             
                                             ·
                                             
                                                x
                                                
                                                   k
                                                   t
                                                   f
                                                   r
                                                
                                                v
                                             
                                             −
                                             
                                                ∑
                                                
                                                   k
                                                   ,
                                                   u
                                                   ,
                                                   t
                                                   ,
                                                   f
                                                   ,
                                                   a
                                                
                                             
                                             
                                                (
                                                P
                                                
                                                   C
                                                   
                                                      k
                                                      f
                                                   
                                                
                                                ·
                                                
                                                   p
                                                   
                                                      k
                                                      u
                                                      t
                                                      f
                                                   
                                                   
                                                      a
                                                      v
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         P
                                                         C
                                                      
                                                      ¯
                                                   
                                                   
                                                      k
                                                      f
                                                   
                                                
                                                ·
                                                
                                                   
                                                      p
                                                      ¯
                                                   
                                                   
                                                      k
                                                      u
                                                      t
                                                      f
                                                   
                                                   
                                                      a
                                                      v
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             −
                                             
                                             
                                                ∑
                                                
                                                   u
                                                   ,
                                                   t
                                                   ,
                                                   f
                                                   ,
                                                   a
                                                   <
                                                   
                                                      
                                                         
                                                            S
                                                            L
                                                         
                                                         ^
                                                      
                                                      u
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      H
                                                      C
                                                   
                                                   ^
                                                
                                                u
                                             
                                             ·
                                             
                                                
                                                   w
                                                   ^
                                                
                                                
                                                   u
                                                   t
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   s
                                                   ,
                                                   f
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         S
                                                         P
                                                      
                                                      ¯
                                                   
                                                   
                                                      s
                                                   
                                                   v
                                                
                                                +
                                                T
                                                
                                                   C
                                                   
                                                      s
                                                      f
                                                   
                                                
                                                )
                                             
                                             ·
                                             
                                                
                                                   s
                                                   ¯
                                                
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                v
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             −
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ,
                                                   s
                                                   ,
                                                   f
                                                   ,
                                                   a
                                                
                                             
                                             
                                                (
                                                S
                                                
                                                   P
                                                   s
                                                
                                                +
                                                T
                                                
                                                   C
                                                   
                                                      s
                                                      f
                                                   
                                                
                                                )
                                             
                                             ·
                                             
                                                τ
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ]
                                             +
                                             γ
                                             ·
                                             
                                                (
                                                η
                                                −
                                                
                                                   1
                                                   
                                                      1
                                                      −
                                                      α
                                                   
                                                
                                                
                                                   ∑
                                                   v
                                                
                                                
                                                   ϕ
                                                   v
                                                
                                                ·
                                                
                                                   δ
                                                   v
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        subject to:

                           
                              (18)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            Y
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                               
                                                                  k
                                                                  0
                                                                  t
                                                                  f
                                                               
                                                               v
                                                            
                                                            =
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                                  ¯
                                                               
                                                               
                                                                  k
                                                                  0
                                                                  t
                                                                  f
                                                               
                                                               v
                                                            
                                                            =
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ψ
                                                               
                                                                  k
                                                                  0
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            =
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                               
                                                                  k
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            =
                                                            
                                                               w
                                                               
                                                                  k
                                                                  ,
                                                                  t
                                                                  −
                                                                  1
                                                                  ,
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  −
                                                                  1
                                                                  ,
                                                                  v
                                                               
                                                            
                                                            −
                                                            
                                                               D
                                                               
                                                                  k
                                                                  ,
                                                                  t
                                                                  −
                                                                  1
                                                                  ,
                                                                  r
                                                               
                                                               
                                                                  0
                                                                  v
                                                               
                                                            
                                                            
                                                               ψ
                                                               
                                                                  k
                                                                  1
                                                                  ,
                                                                  t
                                                                  −
                                                                  1
                                                                  ,
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  −
                                                                  1
                                                                  ,
                                                                  v
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            0
                                                            ≤
                                                            
                                                               D
                                                               
                                                                  k
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  0
                                                                  v
                                                               
                                                            
                                                            
                                                               ψ
                                                               
                                                                  k
                                                                  1
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            ≤
                                                            
                                                               D
                                                               
                                                                  k
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               a
                                                            
                                                            
                                                               ψ
                                                               
                                                                  k
                                                                  1
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            ≤
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             ⊻
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            ¬
                                                            
                                                               Y
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ψ
                                                               
                                                                  k
                                                                  1
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            =
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                               
                                                                  k
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            =
                                                            
                                                               w
                                                               
                                                                  k
                                                                  ,
                                                                  t
                                                                  −
                                                                  1
                                                                  ,
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  −
                                                                  1
                                                                  ,
                                                                  v
                                                               
                                                            
                                                            −
                                                            
                                                               D
                                                               
                                                                  k
                                                                  ,
                                                                  t
                                                                  −
                                                                  1
                                                                  ,
                                                                  r
                                                               
                                                               
                                                                  0
                                                                  v
                                                               
                                                            
                                                            
                                                               ψ
                                                               
                                                                  k
                                                                  0
                                                                  ,
                                                                  t
                                                                  −
                                                                  1
                                                                  ,
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  −
                                                                  1
                                                                  ,
                                                                  v
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            0
                                                            ≤
                                                            
                                                               D
                                                               
                                                                  k
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  0
                                                                  v
                                                               
                                                            
                                                            
                                                               ψ
                                                               
                                                                  k
                                                                  0
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            ≤
                                                            
                                                               D
                                                               
                                                                  k
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               a
                                                            
                                                            
                                                               ψ
                                                               
                                                                  k
                                                                  0
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            ≤
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             
                                             ∀
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                 
                              
                           
                        
                        (2)–(6), (8)–(11)
                        
                           
                              (19)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                s
                                                
                                                   t
                                                   s
                                                   f
                                                
                                             
                                             ,
                                             
                                             
                                                τ
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                v
                                             
                                             ,
                                             
                                             
                                                
                                                   s
                                                   ¯
                                                
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                v
                                             
                                             ,
                                             
                                             
                                                w
                                                
                                                   k
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   w
                                                   ^
                                                
                                                
                                                   u
                                                   t
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ,
                                             
                                             
                                                p
                                                
                                                   k
                                                   u
                                                   t
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   p
                                                   ¯
                                                
                                                
                                                   k
                                                   u
                                                   t
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ,
                                             
                                             
                                                x
                                                
                                                   k
                                                   t
                                                   f
                                                   r
                                                
                                                v
                                             
                                             ,
                                             
                                             
                                                ψ
                                                
                                                   k
                                                   u
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ,
                                             
                                             
                                                δ
                                                v
                                             
                                             ≥
                                             0
                                             ;
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             η
                                             ∈
                                             ℜ
                                             
                                             
                                             ∀
                                             k
                                             ∈
                                             K
                                             ,
                                             
                                             u
                                             ∈
                                             U
                                             ,
                                             a
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             s
                                             ∈
                                             S
                                             ,
                                             
                                             f
                                             ∈
                                             F
                                             ,
                                             
                                             r
                                             ∈
                                             R
                                             ,
                                             
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             
                                                Y
                                                k
                                             
                                             ∈
                                             
                                                {
                                                T
                                                r
                                                u
                                                e
                                                ,
                                                F
                                                a
                                                l
                                                s
                                                e
                                                }
                                             
                                             
                                             ∀
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Disjunctions (18) use the information about the branding choice to set to zero part of the linear decision variables. In particular, when branding a product as local (Yk
                        ) it is possible to set to zero both the decisions variables related with production and demand fulfillment of products using mainstream raw materials (
                           
                              
                                 p
                                 
                                    k
                                    0
                                    t
                                    f
                                 
                                 v
                              
                              ,
                              
                                 
                                    p
                                    ¯
                                 
                                 
                                    k
                                    0
                                    t
                                    f
                                 
                                 v
                              
                           
                         and 
                           
                              ψ
                              
                                 k
                                 0
                                 t
                                 r
                              
                              
                                 a
                                 v
                              
                           
                        ).

One of the advantages of formulating a problem using GDP is the potential of deriving alternative models. The supplier selection for supply chains in the processed food industry can be addressed from a strategic level in which it is necessary to first choose between three different options: (1) use local single sourcing to produce all products; (2) use mainstream single sourcing to produce all products; (3) use dual sourcing and choose individually which product to brand as local and mainstream. The formulations that are presented next make no use of global constraints as it is possible to fit all constraints inside of the mentioned disjunctions. Boolean variables Zi
                         indicate if option (i) is chosen.

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             max
                                             
                                                ∑
                                                v
                                             
                                             
                                                ϕ
                                                v
                                             
                                             [
                                             
                                                ∑
                                                
                                                   k
                                                   ,
                                                   u
                                                   ,
                                                   t
                                                   ,
                                                   r
                                                   ,
                                                   a
                                                
                                             
                                             L
                                             
                                                P
                                                
                                                   k
                                                   u
                                                
                                             
                                             ·
                                             
                                                D
                                                
                                                   k
                                                   t
                                                   r
                                                
                                                
                                                   0
                                                   v
                                                
                                             
                                             ·
                                             
                                                ψ
                                                
                                                   k
                                                   u
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   k
                                                   ,
                                                   t
                                                   ,
                                                   r
                                                   ,
                                                   a
                                                   <
                                                   S
                                                   
                                                      L
                                                      k
                                                   
                                                
                                             
                                             H
                                             
                                                C
                                                k
                                             
                                             ·
                                             
                                                w
                                                
                                                   k
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             −
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   ,
                                                   t
                                                   ,
                                                   f
                                                   ,
                                                   r
                                                
                                             
                                             
                                                
                                                   
                                                      T
                                                      C
                                                   
                                                   ^
                                                
                                                
                                                   f
                                                   r
                                                
                                             
                                             ·
                                             
                                                x
                                                
                                                   k
                                                   t
                                                   f
                                                   r
                                                
                                                v
                                             
                                             −
                                             
                                                ∑
                                                
                                                   k
                                                   ,
                                                   u
                                                   ,
                                                   t
                                                   ,
                                                   f
                                                   ,
                                                   a
                                                
                                             
                                             
                                                (
                                                P
                                                
                                                   C
                                                   
                                                      k
                                                      f
                                                   
                                                
                                                ·
                                                
                                                   p
                                                   
                                                      k
                                                      u
                                                      t
                                                      f
                                                   
                                                   
                                                      a
                                                      v
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         P
                                                         C
                                                      
                                                      ¯
                                                   
                                                   
                                                      k
                                                      f
                                                   
                                                
                                                ·
                                                
                                                   
                                                      p
                                                      ¯
                                                   
                                                   
                                                      k
                                                      u
                                                      t
                                                      f
                                                   
                                                   
                                                      a
                                                      v
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             −
                                             
                                             
                                                ∑
                                                
                                                   u
                                                   ,
                                                   t
                                                   ,
                                                   f
                                                   ,
                                                   a
                                                   <
                                                   
                                                      
                                                         
                                                            S
                                                            L
                                                         
                                                         ^
                                                      
                                                      u
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      H
                                                      C
                                                   
                                                   ^
                                                
                                                u
                                             
                                             ·
                                             
                                                
                                                   w
                                                   ^
                                                
                                                
                                                   u
                                                   t
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   s
                                                   ,
                                                   f
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         S
                                                         P
                                                      
                                                      ¯
                                                   
                                                   
                                                      s
                                                   
                                                   v
                                                
                                                +
                                                T
                                                
                                                   C
                                                   
                                                      s
                                                      f
                                                   
                                                
                                                )
                                             
                                             ·
                                             
                                                
                                                   s
                                                   ¯
                                                
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                v
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             −
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ,
                                                   s
                                                   ,
                                                   f
                                                   ,
                                                   a
                                                
                                             
                                             
                                                (
                                                S
                                                
                                                   P
                                                   s
                                                
                                                +
                                                T
                                                
                                                   C
                                                   
                                                      s
                                                      f
                                                   
                                                
                                                )
                                             
                                             ·
                                             
                                                τ
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ]
                                             +
                                             γ
                                             ·
                                             
                                                (
                                                η
                                                −
                                                
                                                   1
                                                   
                                                      1
                                                      −
                                                      α
                                                   
                                                
                                                
                                                   ∑
                                                   v
                                                
                                                
                                                   ϕ
                                                   v
                                                
                                                ·
                                                
                                                   δ
                                                   v
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        subject to:

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            Z
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               s
                                                               
                                                                  t
                                                                  s
                                                                  f
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  s
                                                                  ¯
                                                               
                                                               
                                                                  t
                                                                  s
                                                                  f
                                                               
                                                               v
                                                            
                                                            ,
                                                            
                                                               τ
                                                               
                                                                  t
                                                                  s
                                                                  f
                                                               
                                                               v
                                                            
                                                            =
                                                            0
                                                            
                                                            ∀
                                                            s
                                                            ∈
                                                            
                                                               S
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  w
                                                                  ^
                                                               
                                                               
                                                                  0
                                                                  f
                                                                  d
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            =
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                               
                                                                  k
                                                                  0
                                                                  t
                                                                  f
                                                               
                                                               v
                                                            
                                                            ,
                                                            
                                                               
                                                                  p
                                                                  ¯
                                                               
                                                               
                                                                  k
                                                                  0
                                                                  t
                                                                  f
                                                               
                                                               v
                                                            
                                                            =
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ψ
                                                               
                                                                  k
                                                                  0
                                                                  t
                                                                  c
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            =
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               δ
                                                               v
                                                            
                                                            ≥
                                                            η
                                                            −
                                                            
                                                               ∑
                                                               
                                                                  k
                                                                  ,
                                                                  t
                                                                  ,
                                                                  r
                                                                  ,
                                                                  a
                                                                  ∈
                                                                  
                                                                     A
                                                                     k
                                                                  
                                                               
                                                            
                                                            
                                                               ψ
                                                               
                                                                  k
                                                                  1
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               τ
                                                               
                                                                  t
                                                                  +
                                                                  L
                                                                  
                                                                     T
                                                                     
                                                                        t
                                                                        s
                                                                     
                                                                     v
                                                                  
                                                                  ,
                                                                  s
                                                                  f
                                                               
                                                               
                                                                  L
                                                                  
                                                                     T
                                                                     
                                                                        t
                                                                        s
                                                                     
                                                                     v
                                                                  
                                                                  ,
                                                                  v
                                                               
                                                            
                                                            =
                                                            A
                                                            
                                                               Q
                                                               
                                                                  t
                                                                  s
                                                               
                                                               v
                                                            
                                                            
                                                               s
                                                               
                                                                  t
                                                                  s
                                                                  f
                                                               
                                                            
                                                            
                                                            ∀
                                                            s
                                                            ∈
                                                            
                                                               S
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  t
                                                                  ,
                                                                  a
                                                                  ∈
                                                                  
                                                                     A
                                                                     u
                                                                  
                                                               
                                                            
                                                            
                                                               τ
                                                               
                                                                  t
                                                                  s
                                                                  f
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            =
                                                            
                                                               ∑
                                                               t
                                                            
                                                            A
                                                            
                                                               Q
                                                               
                                                                  t
                                                                  s
                                                               
                                                               v
                                                            
                                                            
                                                               s
                                                               
                                                                  t
                                                                  s
                                                                  f
                                                               
                                                            
                                                            
                                                            ∀
                                                            s
                                                            ∈
                                                            
                                                               S
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  s
                                                                  ∈
                                                                  
                                                                     S
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  τ
                                                                  
                                                                     t
                                                                     s
                                                                     f
                                                                  
                                                                  
                                                                     0
                                                                     v
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     s
                                                                     ¯
                                                                  
                                                                  
                                                                     t
                                                                     s
                                                                     f
                                                                  
                                                                  v
                                                               
                                                               )
                                                            
                                                            =
                                                            
                                                               
                                                                  w
                                                                  ^
                                                               
                                                               
                                                                  1
                                                                  t
                                                                  f
                                                               
                                                               
                                                                  0
                                                                  v
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  w
                                                                  ^
                                                               
                                                               
                                                                  1
                                                                  t
                                                                  f
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  w
                                                                  ^
                                                               
                                                               
                                                                  1
                                                                  ,
                                                                  t
                                                                  −
                                                                  1
                                                                  ,
                                                                  f
                                                               
                                                               
                                                                  a
                                                                  −
                                                                  1
                                                                  ,
                                                                  v
                                                               
                                                            
                                                            +
                                                            
                                                               ∑
                                                               
                                                                  s
                                                                  ∈
                                                                  
                                                                     S
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               τ
                                                               
                                                                  t
                                                                  s
                                                                  f
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            −
                                                            
                                                               ∑
                                                               k
                                                            
                                                            
                                                               p
                                                               
                                                                  k
                                                                  1
                                                                  ,
                                                                  t
                                                                  −
                                                                  1
                                                                  ,
                                                                  f
                                                               
                                                               
                                                                  a
                                                                  −
                                                                  1
                                                                  ,
                                                                  v
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  k
                                                                  ,
                                                                  a
                                                                  ∈
                                                                  
                                                                     A
                                                                     u
                                                                  
                                                                  :
                                                                  u
                                                                  =
                                                                  1
                                                               
                                                            
                                                            
                                                               E
                                                               
                                                                  k
                                                                  f
                                                               
                                                            
                                                            
                                                               p
                                                               
                                                                  k
                                                                  1
                                                                  t
                                                                  f
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            ≤
                                                            C
                                                            
                                                               P
                                                               
                                                                  f
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  k
                                                                  ,
                                                                  a
                                                                  ∈
                                                                  
                                                                     A
                                                                     u
                                                                  
                                                                  :
                                                                  u
                                                                  =
                                                                  1
                                                               
                                                            
                                                            
                                                               E
                                                               
                                                                  k
                                                                  f
                                                               
                                                            
                                                            
                                                               
                                                                  p
                                                                  ¯
                                                               
                                                               
                                                                  k
                                                                  1
                                                                  t
                                                                  f
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            ≤
                                                            
                                                               
                                                                  
                                                                     C
                                                                     P
                                                                  
                                                                  ¯
                                                               
                                                               
                                                                  f
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  a
                                                                  ∈
                                                                  
                                                                     A
                                                                     u
                                                                  
                                                                  :
                                                                  u
                                                                  =
                                                                  1
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  p
                                                                  
                                                                     k
                                                                     1
                                                                     t
                                                                     f
                                                                  
                                                                  
                                                                     a
                                                                     v
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     p
                                                                     ¯
                                                                  
                                                                  
                                                                     k
                                                                     1
                                                                     t
                                                                     f
                                                                  
                                                                  
                                                                     a
                                                                     v
                                                                  
                                                               
                                                               )
                                                            
                                                            =
                                                            
                                                               ∑
                                                               r
                                                            
                                                            
                                                               x
                                                               
                                                                  k
                                                                  t
                                                                  f
                                                                  r
                                                               
                                                               v
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               f
                                                            
                                                            
                                                               x
                                                               
                                                                  k
                                                                  t
                                                                  f
                                                                  r
                                                               
                                                               v
                                                            
                                                            =
                                                            
                                                               w
                                                               
                                                                  k
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  0
                                                                  v
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                               
                                                                  k
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            =
                                                            
                                                               w
                                                               
                                                                  k
                                                                  ,
                                                                  t
                                                                  −
                                                                  1
                                                                  ,
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  −
                                                                  1
                                                                  ,
                                                                  v
                                                               
                                                            
                                                            −
                                                            
                                                               ∑
                                                               u
                                                            
                                                            
                                                               D
                                                               
                                                                  k
                                                                  ,
                                                                  t
                                                                  −
                                                                  1
                                                                  ,
                                                                  r
                                                               
                                                               
                                                                  0
                                                                  v
                                                               
                                                            
                                                            
                                                               ψ
                                                               
                                                                  k
                                                                  1
                                                                  ,
                                                                  t
                                                                  −
                                                                  1
                                                                  ,
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  −
                                                                  1
                                                                  ,
                                                                  v
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               D
                                                               
                                                                  k
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  0
                                                                  v
                                                               
                                                            
                                                            
                                                               ψ
                                                               
                                                                  k
                                                                  1
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            ≤
                                                            
                                                               D
                                                               
                                                                  k
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  a
                                                                  ∈
                                                                  
                                                                     A
                                                                     k
                                                                  
                                                               
                                                            
                                                            
                                                               ψ
                                                               
                                                                  k
                                                                  1
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            ≤
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             ∨
                                             
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            Z
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               s
                                                               
                                                                  t
                                                                  s
                                                                  f
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  s
                                                                  ¯
                                                               
                                                               
                                                                  t
                                                                  s
                                                                  f
                                                               
                                                               v
                                                            
                                                            ,
                                                            
                                                               τ
                                                               
                                                                  t
                                                                  s
                                                                  f
                                                               
                                                               v
                                                            
                                                            =
                                                            0
                                                            
                                                            ∀
                                                            s
                                                            ∈
                                                            
                                                               S
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  w
                                                                  ^
                                                               
                                                               
                                                                  1
                                                                  f
                                                                  d
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            =
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                               
                                                                  k
                                                                  1
                                                                  t
                                                                  f
                                                               
                                                               v
                                                            
                                                            ,
                                                            
                                                               
                                                                  p
                                                                  ¯
                                                               
                                                               
                                                                  k
                                                                  1
                                                                  t
                                                                  f
                                                               
                                                               v
                                                            
                                                            =
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ψ
                                                               
                                                                  k
                                                                  1
                                                                  t
                                                                  c
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            =
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               δ
                                                               v
                                                            
                                                            ≥
                                                            η
                                                            −
                                                            
                                                               ∑
                                                               
                                                                  k
                                                                  ,
                                                                  t
                                                                  ,
                                                                  r
                                                                  ,
                                                                  a
                                                                  ∈
                                                                  
                                                                     A
                                                                     k
                                                                  
                                                               
                                                            
                                                            
                                                               ψ
                                                               
                                                                  k
                                                                  0
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               τ
                                                               
                                                                  t
                                                                  +
                                                                  L
                                                                  
                                                                     T
                                                                     
                                                                        t
                                                                        s
                                                                     
                                                                     v
                                                                  
                                                                  ,
                                                                  s
                                                                  f
                                                               
                                                               
                                                                  L
                                                                  
                                                                     T
                                                                     
                                                                        t
                                                                        s
                                                                     
                                                                     v
                                                                  
                                                                  ,
                                                                  v
                                                               
                                                            
                                                            =
                                                            A
                                                            
                                                               Q
                                                               
                                                                  t
                                                                  s
                                                               
                                                               v
                                                            
                                                            
                                                               s
                                                               
                                                                  t
                                                                  s
                                                                  f
                                                               
                                                            
                                                            
                                                            ∀
                                                            s
                                                            ∈
                                                            
                                                               S
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  t
                                                                  ,
                                                                  a
                                                                  ∈
                                                                  
                                                                     A
                                                                     u
                                                                  
                                                               
                                                            
                                                            
                                                               τ
                                                               
                                                                  t
                                                                  s
                                                                  f
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            =
                                                            
                                                               ∑
                                                               t
                                                            
                                                            A
                                                            
                                                               Q
                                                               
                                                                  t
                                                                  s
                                                               
                                                               v
                                                            
                                                            
                                                               s
                                                               
                                                                  t
                                                                  s
                                                                  f
                                                               
                                                            
                                                            
                                                            ∀
                                                            s
                                                            ∈
                                                            
                                                               S
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  s
                                                                  ∈
                                                                  
                                                                     S
                                                                     0
                                                                  
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  τ
                                                                  
                                                                     t
                                                                     s
                                                                     f
                                                                  
                                                                  
                                                                     0
                                                                     v
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     s
                                                                     ¯
                                                                  
                                                                  
                                                                     t
                                                                     s
                                                                     f
                                                                  
                                                                  v
                                                               
                                                               )
                                                            
                                                            =
                                                            
                                                               
                                                                  w
                                                                  ^
                                                               
                                                               
                                                                  0
                                                                  t
                                                                  f
                                                               
                                                               
                                                                  0
                                                                  v
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  w
                                                                  ^
                                                               
                                                               
                                                                  0
                                                                  t
                                                                  f
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  w
                                                                  ^
                                                               
                                                               
                                                                  0
                                                                  ,
                                                                  t
                                                                  −
                                                                  1
                                                                  ,
                                                                  f
                                                               
                                                               
                                                                  a
                                                                  −
                                                                  1
                                                                  ,
                                                                  v
                                                               
                                                            
                                                            +
                                                            
                                                               ∑
                                                               
                                                                  s
                                                                  ∈
                                                                  
                                                                     S
                                                                     0
                                                                  
                                                               
                                                            
                                                            
                                                               τ
                                                               
                                                                  t
                                                                  s
                                                                  f
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            −
                                                            
                                                               ∑
                                                               k
                                                            
                                                            
                                                               p
                                                               
                                                                  k
                                                                  0
                                                                  ,
                                                                  t
                                                                  −
                                                                  1
                                                                  ,
                                                                  f
                                                               
                                                               
                                                                  a
                                                                  −
                                                                  1
                                                                  ,
                                                                  v
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  k
                                                                  ,
                                                                  a
                                                                  ∈
                                                                  
                                                                     A
                                                                     u
                                                                  
                                                                  :
                                                                  u
                                                                  =
                                                                  0
                                                               
                                                            
                                                            
                                                               E
                                                               
                                                                  k
                                                                  f
                                                               
                                                            
                                                            
                                                               p
                                                               
                                                                  k
                                                                  0
                                                                  t
                                                                  f
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            ≤
                                                            C
                                                            
                                                               P
                                                               
                                                                  f
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  k
                                                                  ,
                                                                  a
                                                                  ∈
                                                                  
                                                                     A
                                                                     u
                                                                  
                                                                  :
                                                                  u
                                                                  =
                                                                  0
                                                               
                                                            
                                                            
                                                               E
                                                               
                                                                  k
                                                                  f
                                                               
                                                            
                                                            
                                                               
                                                                  p
                                                                  ¯
                                                               
                                                               
                                                                  k
                                                                  0
                                                                  t
                                                                  f
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            ≤
                                                            
                                                               
                                                                  
                                                                     C
                                                                     P
                                                                  
                                                                  ¯
                                                               
                                                               
                                                                  f
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  a
                                                                  ∈
                                                                  
                                                                     A
                                                                     u
                                                                  
                                                                  :
                                                                  u
                                                                  =
                                                                  0
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  p
                                                                  
                                                                     k
                                                                     0
                                                                     t
                                                                     f
                                                                  
                                                                  
                                                                     a
                                                                     v
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     p
                                                                     ¯
                                                                  
                                                                  
                                                                     k
                                                                     0
                                                                     t
                                                                     f
                                                                  
                                                                  
                                                                     a
                                                                     v
                                                                  
                                                               
                                                               )
                                                            
                                                            =
                                                            
                                                               ∑
                                                               r
                                                            
                                                            
                                                               x
                                                               
                                                                  k
                                                                  t
                                                                  f
                                                                  r
                                                               
                                                               v
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               f
                                                            
                                                            
                                                               x
                                                               
                                                                  k
                                                                  t
                                                                  f
                                                                  r
                                                               
                                                               v
                                                            
                                                            =
                                                            
                                                               w
                                                               
                                                                  k
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  0
                                                                  v
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               w
                                                               
                                                                  k
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            =
                                                            
                                                               w
                                                               
                                                                  k
                                                                  ,
                                                                  t
                                                                  −
                                                                  1
                                                                  ,
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  −
                                                                  1
                                                                  ,
                                                                  v
                                                               
                                                            
                                                            −
                                                            
                                                               ∑
                                                               u
                                                            
                                                            
                                                               D
                                                               
                                                                  k
                                                                  ,
                                                                  t
                                                                  −
                                                                  1
                                                                  ,
                                                                  r
                                                               
                                                               
                                                                  0
                                                                  v
                                                               
                                                            
                                                            
                                                               ψ
                                                               
                                                                  k
                                                                  0
                                                                  ,
                                                                  t
                                                                  −
                                                                  1
                                                                  ,
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  −
                                                                  1
                                                                  ,
                                                                  v
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               D
                                                               
                                                                  k
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  0
                                                                  v
                                                               
                                                            
                                                            
                                                               ψ
                                                               
                                                                  k
                                                                  0
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            ≤
                                                            
                                                               D
                                                               
                                                                  k
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  a
                                                                  ∈
                                                                  
                                                                     A
                                                                     k
                                                                  
                                                               
                                                            
                                                            
                                                               ψ
                                                               
                                                                  k
                                                                  01
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  a
                                                                  v
                                                               
                                                            
                                                            ≤
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             ∨
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Z
                                                               3
                                                            
                                                            
                                                               (
                                                               2
                                                               )
                                                            
                                                            −
                                                            
                                                               (
                                                               11
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            18
                                                            )
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             
                                                Z
                                                1
                                             
                                             ⊻
                                             
                                                Z
                                                2
                                             
                                             ⊻
                                             
                                                Z
                                                3
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             
                                                Z
                                                3
                                             
                                             ⇔
                                             
                                                Y
                                                k
                                             
                                             ⊻
                                             ¬
                                             
                                                Y
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             
                                                Z
                                                3
                                             
                                             ⇒
                                             
                                                ∨
                                                k
                                             
                                             
                                                [
                                                ¬
                                                
                                                   Y
                                                   k
                                                
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                s
                                                
                                                   t
                                                   s
                                                   f
                                                
                                             
                                             ,
                                             
                                             
                                                τ
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                v
                                             
                                             ,
                                             
                                             
                                                
                                                   s
                                                   ¯
                                                
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                v
                                             
                                             ,
                                             
                                             
                                                w
                                                
                                                   k
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   w
                                                   ^
                                                
                                                
                                                   u
                                                   t
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ,
                                             
                                             
                                                p
                                                
                                                   k
                                                   u
                                                   t
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   p
                                                   ¯
                                                
                                                
                                                   k
                                                   u
                                                   t
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ,
                                             
                                             
                                                x
                                                
                                                   k
                                                   t
                                                   f
                                                   r
                                                
                                                v
                                             
                                             ,
                                             
                                             
                                                ψ
                                                
                                                   k
                                                   u
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             ,
                                             
                                             
                                                δ
                                                v
                                             
                                             ≥
                                             0
                                             ;
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             η
                                             ∈
                                             ℜ
                                             
                                             
                                             ∀
                                             k
                                             ∈
                                             K
                                             ,
                                             
                                             u
                                             ∈
                                             U
                                             ,
                                             a
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             s
                                             ∈
                                             S
                                             ,
                                             
                                             f
                                             ∈
                                             F
                                             ,
                                             
                                             r
                                             ∈
                                             R
                                             ,
                                             
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (26)
                              
                                 
                                    
                                       
                                          
                                             
                                                Z
                                                1
                                             
                                             ,
                                             
                                                Z
                                                2
                                             
                                             ,
                                             
                                                Z
                                                3
                                             
                                             ∈
                                             
                                                {
                                                T
                                                r
                                                u
                                                e
                                                ,
                                                F
                                                a
                                                l
                                                s
                                                e
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                    
                                       
                                          
                                             
                                                Y
                                                k
                                             
                                             ∈
                                             
                                                {
                                                T
                                                r
                                                u
                                                e
                                                ,
                                                F
                                                a
                                                l
                                                s
                                                e
                                                }
                                             
                                             
                                             ∀
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Disjunctions (21) use the information about the sourcing strategy choice to narrow the search space. The first and the second disjunctions (Z
                        1 and Z
                        2) set to zero all variables related to mainstream sourcing/branding and to local sourcing/branding, respectively. The third disjunction (Z
                        3) has an embedded disjunction similar to the one presented in the previous section (cf. Section 3.2.1). Logic proposition (23) forces the choice of one of the sourcing strategies. Logic proposition (24) states that if a dual sourcing strategy is chosen then it is necessary to decide for each product the branding (mainstream or local). Finally, logic proposition (25) ensures that when choosing a dual sourcing strategy there exists at least one product that is not branded as local.

The use of GDP modeling in this context will be clearer in Section 5.1 where the related convex hull reformulation is used.

In this section we validate with an illustrative example the importance of considering uncertainty, the impact of considering the integrated approach, and the effects of a risk-averse strategy in the supplier selection for supply chains in the processed food industry.

We consider a mainstream and a local supplier (
                           
                              S
                              =
                              2
                           
                        ) that supply raw material to a factory (
                           
                              F
                              =
                              1
                           
                        ). This factory converts the raw material into six products (
                           
                              K
                              =
                              6
                           
                        ) and fulfills demand for 3 retailers over a horizon of 1 year, discretized in 
                           
                              T
                              =
                              12
                           
                         time periods. Purchasing raw materials in advance from the mainstream supplier costs 0.3 monetary units and from the local supplier it costs 0.5. Both raw materials have a shelf-life of 3 periods. All transportation costs are given in Table 1
                        . Holding costs of both raw and final products are 0.05. All final products require one unit of time of capacity to be produced (
                           
                              
                                 E
                                 
                                    k
                                    f
                                 
                              
                              =
                              1
                           
                        ). There is constant available normal capacity throughout the planning horizon that is equal to the expected demand across all scenarios for products in its fresher state. Therefore, the capacity per period CPtf
                         is determined as

                           
                              
                                 
                                    
                                       
                                          
                                             C
                                             
                                                P
                                                
                                                   t
                                                   f
                                                
                                             
                                             =
                                             
                                                ∑
                                                
                                                   k
                                                   ,
                                                   r
                                                
                                             
                                             E
                                             
                                                (
                                                
                                                   D
                                                   
                                                      k
                                                      t
                                                      r
                                                   
                                                   
                                                      0
                                                      v
                                                   
                                                
                                                )
                                             
                                             ,
                                             
                                             ∀
                                             t
                                             ,
                                             f
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Extra capacity (
                           
                              
                                 
                                    C
                                    P
                                 
                                 ¯
                              
                              
                                 t
                                 f
                              
                           
                        ) is 25 percent of the normal one. Producing within the normal capacity (PCkf
                        ) costs 0.1, while using the extra capacity costs 10 percent more (
                           
                              
                                 
                                    
                                       P
                                       C
                                    
                                    ¯
                                 
                                 
                                    k
                                    f
                                 
                              
                              =
                              0.11
                           
                        ).

The remaining deterministic parameters for products k (SLk
                         and LPku
                        ) and the statistics used to generate the demand of final products (
                           
                              D
                              
                                 k
                                 t
                                 r
                              
                              
                                 a
                                 v
                              
                           
                        ) are given in Table 2
                        . Note that the list price for a product branded as local is 10 percent higher than for a product branded as mainstream. This value is in line with the average extra willingness to pay for local products (Martinez, 2010). Demand for final products follows a gamma distribution (Van Donselaar, van Woensel, Broekmeulen, & Fransoo, 2006). We consider that final products have a medium product quality risk, and therefore, a linear decay of demand over the age of the product until they reach zero (Amorim, et al., 2014; Tsiros & Heilman, 2005). These data reflects general parameters of perishable consumer goods products, such as milk and yogurt.

As already mentioned, the supply uncertainties are related to three stochastic parameters: 
                           
                              L
                              
                                 T
                                 
                                    t
                                    s
                                 
                                 v
                              
                              ,
                           
                        
                        
                           
                              
                                 
                                    S
                                    P
                                 
                                 ¯
                              
                              
                                 s
                              
                              v
                           
                         and 
                           
                              A
                              
                                 Q
                                 
                                    t
                                    s
                                 
                                 v
                              
                           
                        . The local supplier has no uncertainty in the delivery dates and the mainstream is characterized by an exponential negative offset (Qian, 2014) with an expected value of one period. The raw material spot cost for both suppliers is on average 10 percent more expensive than the corresponding cost when buying in advance (SPs
                        ). This cost surplus follows a normal distribution (Fu, Lee, & Teo, 2010) and has a coefficient of variation of one. Finally, the mainstream supplier has no availability issues and the local supplier has a uniformly distributed availability (Federgruen & Yang, 2008) in the interval [0.7, 1]. The value for α is set to 0.95 in all experiments.

To measure the importance of uncertainty we use the Expected Value of Perfect Information (EVPI) and the Value of Stochastic Solution (VSS). These two metrics are often used to evaluate the importance of using stochastic solutions over deterministic approximations.

Let RP be the optimal value of solving the two-stage stochastic programming problem (1)–(17), and consider WS
                           v
                         the optimal value of solving the same problem only for scenario 
                           
                              v
                              ∈
                              V
                           
                        . Then, the wait-and-see (WS) solution is determined as the expected value of WS
                           v
                         over all scenarios. EVPI is obtained with the difference between WS and the RP:
                        
                        
                        
                           
                              (28)
                              
                                 
                                    
                                       
                                          
                                             
                                                EVPI
                                                =
                                                WS
                                                −
                                                RP
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The EVPI may be seen as the cost of uncertainty or the maximum amount the decision maker is willing to pay in order to make a decision without uncertainty. Higher EVPIs mean that uncertainty is important to the problem (Wallace & Ziemba, 2005).

Now, let EV be the solution obtained by solving the problem in which stochastic parameters are replaced by their expected values. The expected value of using the first-stage decisions of EV over all scenarios is denoted as EEV (expected value of using the EV solution). VSS is obtained as follows:

                           
                              (29)
                              
                                 
                                    
                                       
                                          
                                             
                                                VSS
                                                =
                                                RP
                                                −
                                                EEV
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

VSS estimates the profit that may be obtained by adopting the stochastic model rather than using the approximated mean-value one. Therefore, VSS shows the cost of ignoring the uncertainty in choosing a first-stage decision (Birge & Louveaux, 1997).

In general, there may be cases in which fixing first-stage decision variables may result in unfeasible EEV problems. However, as the supplier selection for supply chains in the processed food industry has complete recourse that is not the case (cf. Property 3.1).

To approximate both EVPI and VSS for the supplier selection problem we have sampled 1296 scenarios with equal probability from the stochastic parameters and solved the supplier selection problem with parameter γ set to 0 and 100. Table 3 presents the results for these two metrics.

Both metrics are far from zero and they increase with the risk-aversion of the solution. The importance of uncertainty grows along with the concerns about customer service. Acquiring more precise information about uncertain parameters seems not to be as critical as acknowledging the stochastic nature of this problem. The values of the EVPI show that the recourse decisions are able to correct substantially previous actions. The relative VSS values are higher than 40 percent, which denotes the importance of incorporating the variability of the possible outcomes instead of using expected values to make supplier selection decisions in the processed food industry context.

In order to assess the impact of considering an integrated approach to the supplier selection and production-distribution planning, we have performed sensitivity analysis on the key parameters that may influence the advantages of this approach. Through preliminary computational tests, weight γ is changed such that customer service conditional value at risk (cscVaR) is either 90 percent or 95 percent, the shelf-life of the raw materials (
                           
                              
                                 
                                    S
                                    L
                                 
                                 ^
                              
                              u
                           
                        ) is varied between 3 and 9 periods and the list price of a product branded as local (LP
                        
                           k0) is 0 percent or 10 percent higher than the mainstream list price.

Solutions are obtained with a sample average approximation scheme (Shapiro & Homem-de Mello, 1998). We sampled 81 scenarios and solved 50 instances of the approximating stochastic programming. We then evaluated the objective function by solving 1296 independently sampled scenarios. In the Decoupled approach, first problem (1)–(17) is solved without production-distribution planning constraints (6)–(11). Afterward, having the procurement and demand fulfillment variables fixed the overall problem is solved. In the Integrated approach, problem (1)–(17) is solved simultaneously.

In Tables 4 and 5 we report for the Decoupled and Integrated approach, respectively, several indicators:

                           
                              •
                              profit – first part of objective function (1)
                              

local (percent) – quantity of local procured raw material over the total procured raw material, 
                                    
                                       ∑
                                       
                                          (
                                          
                                             τ
                                             
                                                t
                                                
                                                   s
                                                   ′
                                                
                                                f
                                             
                                             
                                                a
                                                v
                                             
                                          
                                          +
                                          
                                             
                                                s
                                                ¯
                                             
                                             
                                                t
                                                
                                                   s
                                                   ′
                                                
                                                f
                                             
                                             v
                                          
                                          )
                                       
                                       /
                                       ∑
                                       
                                          (
                                          
                                             τ
                                             
                                                t
                                                s
                                                f
                                             
                                             
                                                a
                                                v
                                             
                                          
                                          +
                                          
                                             
                                                s
                                                ¯
                                             
                                             
                                                t
                                                s
                                                f
                                             
                                             v
                                          
                                          )
                                       
                                       :
                                       
                                          s
                                          ′
                                       
                                       ∈
                                       
                                          S
                                          1
                                       
                                    
                                 .

spoiled (percent) – amount of spoiled raw material over the total procured raw material, 
                                    
                                       ∑
                                       
                                          w
                                          
                                             u
                                             t
                                             f
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      L
                                                   
                                                   ^
                                                
                                                u
                                             
                                             v
                                          
                                       
                                       /
                                       ∑
                                       
                                          (
                                          
                                             τ
                                             
                                                t
                                                s
                                                f
                                             
                                             
                                                a
                                                v
                                             
                                          
                                          +
                                          
                                             
                                                s
                                                ¯
                                             
                                             
                                                t
                                                s
                                                f
                                             
                                             v
                                          
                                          )
                                       
                                    
                                 .

raw (percent) – total procured raw material over the total demand 
                                    
                                       ∑
                                       
                                          (
                                          
                                             τ
                                             
                                                t
                                                s
                                                f
                                             
                                             
                                                a
                                                v
                                             
                                          
                                          +
                                          
                                             
                                                s
                                                ¯
                                             
                                             
                                                t
                                                s
                                                f
                                             
                                             v
                                          
                                          )
                                       
                                       /
                                       ∑
                                       
                                          D
                                          
                                             k
                                             t
                                             r
                                          
                                          
                                             0
                                             v
                                          
                                       
                                    
                                 .

# local – number of products that the model chose to be branded as local, ∑χk
                                 .

Comparing the results of both approaches it is clear that the integrated approach is relevant as it is able to grasp the advantages of having a product branded as local in order to dilute key supply chain costs. These costs may arise, for example, from producing in overtime. With the 10 percent increase in the list price, the decoupled approach does not lead to any product being branded as local, whereas the integrated approach suggests to brand several products this way. This even happens for the case of product 4, which has an absolute difference in the list price between the two brands of less than 20 cents. These decisions force the amount of local raw material to rise considerably above 50 percent. This indicates that the sourcing/branding decisions in the processed food industry may need to take a wider view over the supply chain than just focusing on the procurement processes. Results also show that the logistics characteristics of local suppliers (for instance smaller and less variable lead time) may not constitute a significant attribute to rise considerably the amount of raw materials bought from such suppliers.
                     

Taking advantage of the higher customer willingness to pay for local products increases profit and lowers the amount of spoiled raw material. The lower levels of raw material reaching their shelf-lives is related with the difference in the lead time uncertainty between mainstream and local suppliers. On the other hand, both higher service levels and lower shelf-lives of raw materials lead to an increase in the amount of spoiled material and an increase of the quantities purchased from suppliers in relation to the actual demand. The quantity of raw materials procured is also related to the amount of local supplies due to the availability uncertainties that corresponding suppliers are subject to.

Across all solutions a dual sourcing strategy is chosen. This is in line with other qualitative supplier selection studies in the process food industry that reiterate the importance of complementary in procurement (Vukina, Shin, & Zheng, 2009). Regarding the trade-off between profit and cscVaR, small losses in the average profit may lead to substantial shift in cscVaR.

In Section 3.1 we have introduced in the supplier selection problem a new objective function that aims to maximize the customer service conditional value-at-risk. The behavior of such risk-aversion measures is well documented for the case in which profit is the metric to be tackled. The previous section showed the relatively low influence of attributing more weight to customer service conditional value-at-risk on the average profit. Nevertheless, as this model deals with an uncertain setting, it is relevant to go one step further and understand the impact on the profit distribution as this customer service measure is optimized.

To obtain such insights we have used the results obtained for the integrated approach when solving the 1296 independently sampled scenarios in the previous section. These results were extended by considering a risk-neutral approach (
                           
                              γ
                              =
                              0
                           
                        ). The risk-neutral approach yielded a customer service conditional value-at-risk of 80 percent. The results of the profit distribution after the uncertainty realization are similar across the instances with different shelf-lives and different list prices. Fig. 3 shows the results for the instance in which the list price of a product branded as local (LP
                        
                           k0) is the same as the mainstream list price and the shelf-life of the raw materials (
                           
                              
                                 
                                    S
                                    L
                                 
                                 ^
                              
                              u
                           
                        ) is 3 periods. Each series correspond to a risk-aversion strategy regarding the customer service: neutral (cscVaR equals 80 percent), averse (cscVaR equals 90 percent) and very averse (cscVaR equals 95 percent).

Comparing the three risk-aversion strategies it can be seen that as expected the average profit has a slight decrease as we aim to provide better service levels. But, more importantly, it seems that the dispersion of the profit increases as we aim for a more conservative attitude towards the customer service level. At a first glance this is counterintuitive because usually risk-averse strategies trade-off average profits by more predictable outcomes. However, to achieve higher service levels – averse to losses in the cscVaR, producers have to take riskier decisions, such as procuring more locally and more quantity. For certain uncertainty realization this may yield significant losses.

Even while using a sample average approximation scheme, it is necessary to solve a large number of two-stage stochastic programs that are not trivial to solve using monolithic models as the ones described in Section 3. In this section we discuss a multi-cut Benders decomposition method that can be embedded in the sample average approximation scheme in a hybrid solution approach to solve this supplier selection problem (Santoso, Ahmed, Goetschalckx, & Shapiro, 2005).

Benders decomposition (Benders, 1962) is a solution method that is more commonly known as L-Shaped method when applied to stochastic programming (Van Slyke & Wets, 1969). This solution method partitions the complete formulation into two models. The Benders master problem approximates the cost of the scenarios in the space of first-stage decision variables, and the Benders subproblems are obtained from the original one by fixing the first stage variables to the values obtained in the master problem. This solution method iterates between these two models improving the upper bounds obtained in the master problem (UB) with information coming from the lower bounds of the subproblems (LB).

The resulting Benders subproblems (BSP) that may be decomposed for each scenario 
                        
                           v
                           ∈
                           V
                        
                      are formulated for each iteration i as follows:

                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          max
                                          
                                             ∑
                                             v
                                          
                                          
                                             ϕ
                                             v
                                          
                                          [
                                          
                                             ∑
                                             
                                                k
                                                ,
                                                u
                                                ,
                                                t
                                                ,
                                                r
                                                ,
                                                a
                                             
                                          
                                          L
                                          
                                             P
                                             
                                                k
                                                u
                                             
                                          
                                          ·
                                          
                                             D
                                             
                                                k
                                                t
                                                r
                                             
                                             
                                                0
                                                v
                                             
                                          
                                          ·
                                          
                                             ψ
                                             
                                                k
                                                u
                                                t
                                                r
                                             
                                             
                                                a
                                                v
                                             
                                          
                                          −
                                          
                                             ∑
                                             
                                                k
                                                ,
                                                t
                                                ,
                                                r
                                                ,
                                                a
                                                <
                                                S
                                                
                                                   L
                                                   k
                                                
                                             
                                          
                                          H
                                          
                                             C
                                             k
                                          
                                          ·
                                          
                                             w
                                             
                                                k
                                                t
                                                r
                                             
                                             
                                                a
                                                v
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          −
                                          
                                          
                                             ∑
                                             
                                                k
                                                ,
                                                t
                                                ,
                                                f
                                                ,
                                                r
                                             
                                          
                                          
                                             
                                                
                                                   T
                                                   C
                                                
                                                ^
                                             
                                             
                                                f
                                                r
                                             
                                          
                                          ·
                                          
                                             x
                                             
                                                k
                                                t
                                                f
                                                r
                                             
                                             v
                                          
                                          −
                                          
                                             ∑
                                             
                                                k
                                                ,
                                                u
                                                ,
                                                t
                                                ,
                                                f
                                                ,
                                                a
                                             
                                          
                                          
                                             (
                                             P
                                             
                                                C
                                                
                                                   k
                                                   f
                                                
                                             
                                             ·
                                             
                                                p
                                                
                                                   k
                                                   u
                                                   t
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      P
                                                      C
                                                   
                                                   ¯
                                                
                                                
                                                   k
                                                   f
                                                
                                             
                                             ·
                                             
                                                
                                                   p
                                                   ¯
                                                
                                                
                                                   k
                                                   u
                                                   t
                                                   f
                                                
                                                
                                                   a
                                                   v
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          −
                                          
                                          
                                             ∑
                                             
                                                u
                                                ,
                                                t
                                                ,
                                                f
                                                ,
                                                a
                                                <
                                                
                                                   
                                                      
                                                         S
                                                         L
                                                      
                                                      ^
                                                   
                                                   u
                                                
                                             
                                          
                                          
                                             
                                                
                                                   H
                                                   C
                                                
                                                ^
                                             
                                             u
                                          
                                          ·
                                          
                                             
                                                w
                                                ^
                                             
                                             
                                                u
                                                t
                                                f
                                             
                                             
                                                a
                                                v
                                             
                                          
                                          −
                                          
                                             ∑
                                             
                                                s
                                                ,
                                                f
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      S
                                                      P
                                                   
                                                   ¯
                                                
                                                
                                                   s
                                                
                                                v
                                             
                                             +
                                             T
                                             
                                                C
                                                
                                                   s
                                                   f
                                                
                                             
                                             )
                                          
                                          ·
                                          
                                             
                                                s
                                                ¯
                                             
                                             
                                                t
                                                s
                                                f
                                             
                                             v
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          −
                                          
                                          
                                             ∑
                                             
                                                t
                                                ,
                                                s
                                                ,
                                                f
                                                ,
                                                a
                                             
                                          
                                          
                                             (
                                             S
                                             
                                                P
                                                s
                                             
                                             +
                                             T
                                             
                                                C
                                                
                                                   s
                                                   f
                                                
                                             
                                             )
                                          
                                          ·
                                          
                                             τ
                                             
                                                t
                                                s
                                                f
                                             
                                             
                                                a
                                                v
                                             
                                          
                                          ]
                                          −
                                          γ
                                          ·
                                          
                                             (
                                             
                                                1
                                                
                                                   1
                                                   −
                                                   α
                                                
                                             
                                             
                                                ∑
                                                v
                                             
                                             
                                                ϕ
                                                v
                                             
                                             ·
                                             
                                                δ
                                                v
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     subject to:

                        
                           (30)
                           
                              
                                 
                                    
                                       
                                          
                                             δ
                                             v
                                          
                                          ≥
                                          
                                             η
                                             i
                                          
                                          −
                                          
                                             ∑
                                             
                                                k
                                                ,
                                                u
                                                ,
                                                t
                                                ,
                                                r
                                                ,
                                                a
                                                ∈
                                                
                                                   A
                                                   k
                                                
                                             
                                          
                                          
                                             ψ
                                             
                                                k
                                                u
                                                t
                                                r
                                             
                                             
                                                a
                                                v
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (31)
                           
                              
                                 
                                    
                                       
                                          
                                             τ
                                             
                                                t
                                                +
                                                L
                                                
                                                   T
                                                   
                                                      t
                                                      s
                                                   
                                                   v
                                                
                                                ,
                                                s
                                                f
                                             
                                             
                                                L
                                                
                                                   T
                                                   
                                                      t
                                                      s
                                                   
                                                   v
                                                
                                                ,
                                                v
                                             
                                          
                                          =
                                          A
                                          
                                             Q
                                             
                                                t
                                                s
                                             
                                             v
                                          
                                          
                                             s
                                             
                                                t
                                                s
                                                f
                                             
                                             i
                                          
                                          
                                          ∀
                                          t
                                          ∈
                                          T
                                          ,
                                          
                                          s
                                          ∈
                                          S
                                          ,
                                          
                                          f
                                          ∈
                                          F
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (32)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                t
                                                ,
                                                a
                                                ∈
                                                
                                                   A
                                                   u
                                                
                                             
                                          
                                          
                                             τ
                                             
                                                t
                                                s
                                                f
                                             
                                             
                                                a
                                                v
                                             
                                          
                                          =
                                          
                                             ∑
                                             t
                                          
                                          A
                                          
                                             Q
                                             
                                                t
                                                s
                                             
                                             v
                                          
                                          
                                             s
                                             
                                                t
                                                s
                                                f
                                             
                                             i
                                          
                                          
                                          ∀
                                          s
                                          ∈
                                          S
                                          ,
                                          
                                          f
                                          ∈
                                          F
                                       
                                    
                                 
                              
                           
                        
                     
                     (5) and (6)
                     
                        
                           (33)
                           
                              
                                 
                                    
                                       
                                          
                                             p
                                             
                                                k
                                                0
                                                t
                                                f
                                             
                                             
                                                a
                                                v
                                             
                                          
                                          +
                                          
                                             
                                                p
                                                ¯
                                             
                                             
                                                k
                                                0
                                                t
                                                f
                                             
                                             
                                                a
                                                v
                                             
                                          
                                          ≤
                                          M
                                          
                                             (
                                             1
                                             −
                                             
                                                χ
                                                
                                                   k
                                                
                                                i
                                             
                                             )
                                          
                                          
                                          
                                          ∀
                                          k
                                          ∈
                                          K
                                          ,
                                          
                                          t
                                          ∈
                                          T
                                          ,
                                          
                                          f
                                          ∈
                                          F
                                          ,
                                          a
                                          ∈
                                          
                                             A
                                             u
                                          
                                          :
                                          u
                                          =
                                          0
                                       
                                    
                                 
                              
                           
                        
                     
                     (8)–(11)
                     
                        
                           (34)
                           
                              
                                 
                                    
                                       
                                          
                                             ψ
                                             
                                                k
                                                0
                                                t
                                                r
                                             
                                             
                                                a
                                                v
                                             
                                          
                                          ≤
                                          1
                                          −
                                          
                                             χ
                                             
                                                k
                                             
                                             i
                                          
                                          
                                          
                                          ∀
                                          k
                                          ∈
                                          K
                                          ,
                                          
                                          t
                                          ∈
                                          T
                                          ,
                                          
                                          r
                                          ∈
                                          R
                                          ,
                                          
                                          a
                                          ∈
                                          
                                             A
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (35)
                           
                              
                                 
                                    
                                       
                                          
                                             ψ
                                             
                                                k
                                                1
                                                t
                                                r
                                             
                                             
                                                a
                                                v
                                             
                                          
                                          ≤
                                          
                                             χ
                                             
                                                k
                                             
                                             i
                                          
                                          
                                          
                                          ∀
                                          k
                                          ∈
                                          K
                                          ,
                                          
                                          t
                                          ∈
                                          T
                                          ,
                                          
                                          r
                                          ∈
                                          R
                                          ,
                                          
                                          a
                                          ∈
                                          
                                             A
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     (14)–(16)
                     
                        
                           (36)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             τ
                                             
                                                t
                                                s
                                                f
                                             
                                             v
                                          
                                          ,
                                          
                                          
                                             
                                                s
                                                ¯
                                             
                                             
                                                t
                                                s
                                                f
                                             
                                             v
                                          
                                          ,
                                          
                                          
                                             w
                                             
                                                k
                                                t
                                                r
                                             
                                             
                                                a
                                                v
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                w
                                                ^
                                             
                                             
                                                u
                                                t
                                                f
                                             
                                             
                                                a
                                                v
                                             
                                          
                                          ,
                                          
                                          
                                             p
                                             
                                                k
                                                u
                                                t
                                                f
                                             
                                             
                                                a
                                                v
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                p
                                                ¯
                                             
                                             
                                                k
                                                u
                                                t
                                                f
                                             
                                             
                                                a
                                                v
                                             
                                          
                                          ,
                                          
                                          
                                             x
                                             
                                                k
                                                t
                                                f
                                                r
                                             
                                             v
                                          
                                          ,
                                          
                                          
                                             ψ
                                             
                                                k
                                                u
                                                t
                                                r
                                             
                                             
                                                a
                                                v
                                             
                                          
                                          ,
                                          
                                          
                                             δ
                                             v
                                          
                                          ≥
                                          0
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          ∀
                                          k
                                          ∈
                                          K
                                          ,
                                          
                                          u
                                          ∈
                                          U
                                          ,
                                          a
                                          ,
                                          t
                                          ∈
                                          T
                                          ,
                                          
                                          s
                                          ∈
                                          S
                                          ,
                                          
                                          f
                                          ∈
                                          F
                                          ,
                                          
                                          r
                                          ∈
                                          R
                                       
                                    
                                 
                              
                           
                        
                     
                  

In the Benders subproblems we use the optimal first-stage solution of variables stsf, χk
                      and η coming from the solution of the master problem in the previous iteration i that are denoted as 
                        
                           
                              s
                              
                                 t
                                 s
                                 f
                              
                              i
                           
                           ,
                        
                     
                     
                        
                           χ
                           
                              k
                           
                           i
                        
                      and ηi
                     .

The Benders master problem (BMP) is formulated as follows:

                        
                           (37)
                           
                              
                                 
                                    
                                       
                                          max
                                          γ
                                          ·
                                          η
                                          −
                                          
                                             ∑
                                             v
                                          
                                          
                                             ϕ
                                             v
                                          
                                          ·
                                          
                                             θ
                                             v
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (38)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             θ
                                             v
                                          
                                          ≥
                                          −
                                          η
                                          
                                             Γ
                                             
                                                v
                                                i
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                t
                                                ,
                                                s
                                                ,
                                                f
                                             
                                          
                                          A
                                          
                                             Q
                                             
                                                t
                                                s
                                             
                                             v
                                          
                                          
                                             s
                                             
                                                t
                                                s
                                                f
                                             
                                          
                                          
                                             Δ
                                             
                                                t
                                                s
                                                f
                                             
                                             
                                                v
                                                i
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                t
                                                ,
                                                s
                                                ,
                                                f
                                             
                                          
                                          A
                                          
                                             Q
                                             
                                                t
                                                s
                                             
                                             v
                                          
                                          
                                             s
                                             
                                                t
                                                s
                                                f
                                             
                                          
                                          
                                             Θ
                                             
                                                s
                                                f
                                             
                                             
                                                v
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          +
                                          
                                          
                                             ∑
                                             
                                                k
                                                ,
                                                t
                                                ,
                                                f
                                                ,
                                                a
                                             
                                          
                                          M
                                          
                                             (
                                             1
                                             −
                                             
                                                χ
                                                k
                                             
                                             )
                                          
                                          
                                             Λ
                                             
                                                k
                                                t
                                                f
                                             
                                             
                                                a
                                                v
                                                i
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                t
                                                ,
                                                f
                                             
                                          
                                          C
                                          
                                             P
                                             
                                                f
                                                t
                                             
                                          
                                          
                                             Ξ
                                             
                                                t
                                                f
                                             
                                             
                                                v
                                                i
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                t
                                                ,
                                                f
                                             
                                          
                                          
                                             
                                                
                                                   C
                                                   P
                                                
                                                ¯
                                             
                                             
                                                f
                                                t
                                             
                                          
                                          
                                             Π
                                             
                                                t
                                                f
                                             
                                             
                                                v
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          +
                                          
                                          
                                             ∑
                                             
                                                k
                                                ,
                                                t
                                                ,
                                                r
                                                ,
                                                a
                                             
                                          
                                          
                                             (
                                             
                                                Ω
                                                
                                                   k
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                   i
                                                
                                             
                                             −
                                             
                                                χ
                                                k
                                             
                                             
                                                Ω
                                                
                                                   k
                                                   t
                                                   r
                                                
                                                
                                                   a
                                                   v
                                                   i
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             ∑
                                             
                                                k
                                                ,
                                                t
                                                ,
                                                r
                                                ,
                                                a
                                             
                                          
                                          
                                             χ
                                             k
                                          
                                          
                                             Υ
                                             
                                                k
                                                t
                                                r
                                             
                                             
                                                a
                                                v
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          +
                                          
                                          
                                             ∑
                                             
                                                k
                                                ,
                                                t
                                                ,
                                                r
                                                ,
                                                a
                                             
                                          
                                          
                                             D
                                             
                                                k
                                                t
                                                r
                                             
                                             
                                                a
                                                v
                                             
                                          
                                          
                                             Φ
                                             
                                                k
                                                t
                                                r
                                             
                                             
                                                a
                                                v
                                                i
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                k
                                                ,
                                                t
                                                ,
                                                r
                                             
                                          
                                          
                                             Ψ
                                             
                                                k
                                                t
                                                r
                                             
                                             
                                                v
                                                i
                                             
                                          
                                          
                                          ∀
                                          v
                                          ∈
                                          V
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             s
                                             
                                                t
                                                s
                                                f
                                             
                                          
                                          ≥
                                          0
                                          ;
                                          
                                             χ
                                             k
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          ;
                                          η
                                          ∈
                                          ℜ
                                          
                                          
                                          ∀
                                          k
                                          ∈
                                          K
                                          ,
                                          
                                          t
                                          ∈
                                          T
                                          ,
                                          
                                          s
                                          ∈
                                          S
                                          ,
                                          
                                          f
                                          ∈
                                          F
                                       
                                    
                                 
                              
                           
                        
                     
                  

In the Benders master problem we use the dual values Γvi
                     , 
                        
                           
                              Δ
                              
                                 t
                                 s
                                 f
                              
                              
                                 v
                                 i
                              
                           
                           ,
                        
                     
                     
                        
                           
                              Θ
                              
                                 s
                                 f
                              
                              
                                 v
                                 i
                              
                           
                           ,
                        
                     
                     
                        
                           
                              Λ
                              
                                 k
                                 t
                                 f
                              
                              
                                 a
                                 v
                                 i
                              
                           
                           ,
                        
                     
                     
                        
                           
                              Ξ
                              
                                 t
                                 f
                              
                              
                                 v
                                 i
                              
                           
                           ,
                        
                     
                     
                        
                           
                              Π
                              
                                 t
                                 f
                              
                              
                                 v
                                 i
                              
                           
                           ,
                        
                     
                     
                        
                           
                              Ω
                              
                                 k
                                 t
                                 r
                              
                              
                                 a
                                 v
                                 i
                              
                           
                           ,
                        
                     
                     
                        
                           
                              Υ
                              
                                 k
                                 t
                                 r
                              
                              
                                 a
                                 v
                                 i
                              
                           
                           ,
                        
                     
                     
                        
                           Φ
                           
                              k
                              t
                              r
                           
                           
                              a
                              v
                              i
                           
                        
                      and 
                        
                           Ψ
                           
                              k
                              t
                              r
                           
                           
                              v
                              i
                           
                        
                      of constraints (30), (31), (32), (33), (8), (9), (34), (35), (15) and (16), respectively, in iteration i. Note that after preliminary experiments we chose to add an optimality cut per scenario (38) in the master problem instead of a single global cut (Birge & Louveaux, 1988; You & Grossmann, 2013). As mentioned before this problem has complete recourse, therefore, no feasibility cuts are necessary (cf. Property 3.1).

                        Remark 5.1
                        It is possible to use a more intensive multi-cutting strategy by introducing cuts per time period t. However, it is necessary to distinguish the customer service in each period, and therefore, to rewrite Eq. (2) as 
                              
                                 
                                    δ
                                    v
                                 
                                 ≥
                                 η
                                 −
                                 
                                    ∑
                                    
                                       k
                                       ,
                                       u
                                       ,
                                       r
                                       ,
                                       a
                                       ∈
                                       
                                          A
                                          k
                                       
                                    
                                 
                                 
                                    ψ
                                    
                                       k
                                       u
                                       t
                                       r
                                    
                                    
                                       a
                                       v
                                    
                                 
                                 
                                 ∀
                                 t
                                 ∈
                                 T
                                 ,
                                 v
                                 ∈
                                 V
                              
                           . Consequently dual values Γvi
                            have to be extended to incorporate the time dimension.


                     Algorithm 1
                      outlines the main steps of the solution method, where ε is a very small threshold value.

The Benders decomposition algorithm is known to have some convergence issues that can be mitigated through acceleration techniques. In the remainder of this section we discuss approaches that can be used to this end.

The resulting BMP from the original formulation (cf. Section 3.1) has no constraints besides the on-the-fly optimality cuts and the decision variables domain constraints. Therefore, before “enough” cuts are added into the BMP the convergence of the solution method is expected to be rather slow. The lack of first-stage constraints is related to two characteristics of this problem. Firstly, the uncertainty of suppliers, both in the available quantity and on the lead time, forces a translation of the purchased quantities in advance stsf
                         into a second-stage decision variable 
                           
                              τ
                              
                                 t
                                 s
                                 f
                              
                              
                                 a
                                 v
                              
                           
                        . Secondly, the two main first-stage decision variables (stsf
                         and χk
                        ) are not tightly related due to the multi-echelon scope of the supplier selection for supply chains in the processed food industry, which separates the acquisition of raw materials u from the transformation and selling of final products k.

With the GDP formulation presented in Section 3.2.2 we are able to tighten the first-stage decisions by introducing the three disjunctions Zi
                         related with the sourcing strategy. Transforming the GDP formulation into a mixed-integer programming model by applying classical Boolean algebra rules to convert the logic propositions (Williams, 1999) and reformulating the disjunctions using a hull reformulation (Lee & Grossmann, 2000) results in the following first-stage constraints that are added to the BMP.

                           
                              (39)
                              
                                 
                                    
                                       
                                          
                                             
                                                z
                                                1
                                             
                                             ≤
                                             
                                                χ
                                                k
                                             
                                             
                                             ∀
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (40)
                              
                                 
                                    
                                       
                                          
                                             1
                                             −
                                             
                                                z
                                                2
                                             
                                             ≥
                                             
                                                χ
                                                k
                                             
                                             
                                             ∀
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (41)
                              
                                 
                                    
                                       
                                          
                                             K
                                             −
                                             
                                                z
                                                3
                                             
                                             ≥
                                             
                                                ∑
                                                k
                                             
                                             
                                                χ
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (42)
                              
                                 
                                    
                                       
                                          
                                             
                                                z
                                                1
                                             
                                             +
                                             
                                                z
                                                2
                                             
                                             +
                                             
                                                z
                                                3
                                             
                                             =
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (43)
                              
                                 
                                    
                                       
                                          
                                             
                                                s
                                                
                                                   t
                                                   s
                                                   f
                                                
                                             
                                             =
                                             
                                                s
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                2
                                             
                                             +
                                             
                                                s
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                3
                                             
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             s
                                             ∈
                                             
                                                S
                                                0
                                             
                                             ,
                                             
                                             f
                                             ∈
                                             F
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (44)
                              
                                 
                                    
                                       
                                          
                                             
                                                s
                                                
                                                   t
                                                   s
                                                   f
                                                
                                             
                                             =
                                             
                                                s
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                1
                                             
                                             +
                                             
                                                s
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                3
                                             
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             s
                                             ∈
                                             
                                                S
                                                1
                                             
                                             ,
                                             
                                             f
                                             ∈
                                             F
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (45)
                              
                                 
                                    
                                       
                                          
                                             0
                                             ≤
                                             
                                                s
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                1
                                             
                                             ≤
                                             
                                                ∑
                                                
                                                   
                                                      t
                                                      ′
                                                   
                                                   ≥
                                                   t
                                                
                                             
                                             
                                                (
                                                C
                                                
                                                   P
                                                   
                                                      f
                                                      t
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         C
                                                         P
                                                      
                                                      ¯
                                                   
                                                   
                                                      f
                                                      t
                                                   
                                                
                                                )
                                             
                                             
                                                z
                                                1
                                             
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             s
                                             ∈
                                             
                                                S
                                                1
                                             
                                             ,
                                             
                                             f
                                             ∈
                                             F
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (46)
                              
                                 
                                    
                                       
                                          
                                             0
                                             ≤
                                             
                                                s
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                2
                                             
                                             ≤
                                             
                                                ∑
                                                
                                                   
                                                      t
                                                      ′
                                                   
                                                   ≥
                                                   t
                                                
                                             
                                             
                                                (
                                                C
                                                
                                                   P
                                                   
                                                      f
                                                      t
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         C
                                                         P
                                                      
                                                      ¯
                                                   
                                                   
                                                      f
                                                      t
                                                   
                                                
                                                )
                                             
                                             
                                                z
                                                2
                                             
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             s
                                             ∈
                                             
                                                S
                                                0
                                             
                                             ,
                                             
                                             f
                                             ∈
                                             F
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (47)
                              
                                 
                                    
                                       
                                          
                                             0
                                             ≤
                                             
                                                s
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                3
                                             
                                             ≤
                                             
                                                ∑
                                                
                                                   
                                                      t
                                                      ′
                                                   
                                                   ≥
                                                   t
                                                
                                             
                                             
                                                (
                                                C
                                                
                                                   P
                                                   
                                                      f
                                                      t
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         C
                                                         P
                                                      
                                                      ¯
                                                   
                                                   
                                                      f
                                                      t
                                                   
                                                
                                                )
                                             
                                             
                                                z
                                                3
                                             
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                             ,
                                             
                                             s
                                             ∈
                                             S
                                             ,
                                             
                                             f
                                             ∈
                                             F
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (48)
                              
                                 
                                    
                                       
                                          
                                             
                                                s
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                1
                                             
                                             ,
                                             
                                             
                                                s
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                2
                                             
                                             
                                                s
                                                
                                                   t
                                                   s
                                                   f
                                                
                                                3
                                             
                                             ≥
                                             0
                                             ;
                                             
                                                z
                                                1
                                             
                                             ,
                                             
                                                z
                                                2
                                             
                                             ,
                                             
                                                z
                                                3
                                             
                                             ,
                                             
                                             
                                                χ
                                                k
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Note that χk
                         are the binary variables resulting from transforming Boolean variables Yk
                         and z
                        1, z
                        2, z
                        3 are the binary variables resulting from transforming Boolean variables Z
                        1, Z
                        2, Z
                        3, respectively. Moreover, 
                           
                              
                                 s
                                 
                                    t
                                    s
                                    f
                                 
                                 1
                              
                              ,
                              
                                 s
                                 
                                    t
                                    s
                                    f
                                 
                                 2
                              
                              ,
                              
                                 s
                                 
                                    t
                                    s
                                    f
                                 
                                 3
                              
                           
                         are the disaggregated variables of stsf
                         for each disjunctive term.

The key idea in this acceleration scheme is to consider prior solutions to the BMP, and then to modify the evaluation of the objective function to also optimize over best convex combination of multipliers (Smith, 2004).

Let 
                           
                              
                                 s
                                 
                                    t
                                    s
                                    f
                                 
                                 i
                              
                              ,
                           
                        
                        
                           
                              χ
                              
                                 k
                              
                              i
                           
                         and ηi
                         for 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                           
                         be the solutions found after solving the BMP over the last i iterations. Parameter I controls the frequency for which the modified BSP (mBSP) is solved. In this problem the solution of the first-stage decision variables stsf, χk
                         and η that was found in the previous iteration is replaced by the convex combination of these variables over the past I iterations 
                           
                              
                                 ∑
                                 i
                              
                              
                                 λ
                                 i
                              
                              
                                 s
                                 
                                    t
                                    s
                                    f
                                 
                                 i
                              
                              ,
                           
                        
                        
                           
                              
                                 ∑
                                 i
                              
                              
                                 λ
                                 i
                              
                              
                                 χ
                                 
                                    k
                                 
                                 i
                              
                           
                         and ∑
                           i
                        
                        λiηi
                        , respectively. The objective function (30) is modified by adding the following term

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                i
                                             
                                             
                                                λ
                                                i
                                             
                                             ·
                                             γ
                                             ·
                                             
                                                η
                                                i
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Moreover, it is necessary to add the following constraints:

                           
                              (49)
                              
                                 
                                    
                                       
                                          
                                             0
                                             ≤
                                             λ
                                             ≤
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (50)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                i
                                             
                                             
                                                λ
                                                i
                                             
                                             =
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                     

After solving mBSP in a given iteration, Algorithm 1 proceeds by getting the dual values of the subproblem constraints and adding the associated cuts to the BMP. Once mBSP is solved in one iteration, BSP is solved for the next I iterations.

In the classical Benders solution method, outlined in Algorithm 1, we alternate between solving a master problem and the subproblems. In this acceleration scheme we solve a single master problem and generate Benders cuts on the fly as we find feasible master solutions. This general approach is named branch-and-check (Thorsteinsson, 2001). This approach can be also seen as a branch-and-cut algorithm with the Benders subproblems sourcing the cuts. In the reminder of the paper we use modern Benders to refer to this method.

This method takes advantage of callback functions in the solver of the master problem. Its main advantage is that it avoids considerable rework in the branch-and-bound because we are keeping the same tree throughout the iterations of the Benders algorithm. Its main drawback is the harder implementation procedure.

In this section we describe computational experiments using the multi-cut Benders decomposition algorithm presented in Section 5. We sampled 81, 256 and 625 scenarios from the instances described in Section 4.1 and solved for the case in which it is necessary to decide about the supplying/branding strategy of 6, 12 and 24 products. Parameter γ was set to 0 and to 1000. Therefore, in total we report results for 18 instances. All the programs were implemented in C++ and solved using IBM ILOG CPLEX Optimization Studio 12.4 on an Intel E5-2450 processor under a Scientific Linux 6.5 platform. For instances with 81 scenarios, each run was limited to 2 cores of the processor and 8 gigabytes of RAM. For instances with 12 and 24 products under 256 and 625 scenarios the execution was limited to 3 cores and 12 gigabytes of RAM.

In order to achieve better computational results, we solved the scenario subproblems with parallel computing. We grouped the scenarios into subproblems, in a way that each subproblem has 9 to 50 scenarios, depending of the number of scenarios in each instance. This method was effective in improving the computational performance and in reducing the amount of RAM required.


                     Table 6
                      shows the size of the monolithic model for each instance.

We report in Table 7
                      and 8
                      results for each instance using the mixed-integer solver to solve the monolithic model (Monolithic), modern Benders decomposition algorithm (MB) (cf. Section 5.3) and the same algorithm with the hull reformulation (MB+H) (cf. Section 5.1). In Table 7, instances were run with the parameter γ set to 0. The results of Table 8 represent the runs with γ set to 1000. All solution methods were limited to 21,600 seconds (6 hours). The complete results comparing the performance of all the methods are available upon request.

The results show that for the instances with 6 products and 81 scenarios CPLEX was able to solve to optimality within the given time. However, for the more realistic and larger instances, with more scenarios and products, most of the times the solver was not able to find a feasible solution to the model. The Benders algorithms did not have enough time to converge with 12 or 24 products, but they achieved better overall results in instances with 6 products and in all instances with 256 and 625 scenarios. When comparing the lower bound, modern Benders decomposition methods (with or without hull reformulation) outperformed all other methods as they were able to find reasonable or good solutions in all instances.

Although Benders decomposition achieved better solutions in almost every case, it was not able to obtain good upper bounds in instances with a larger number of products, which resulted in higher gaps. This may be caused by the structure and the size of the model, and also by the slow convergence of Benders decomposition in some cases (You & Grossmann, 2013).

When compared with classical Benders decomposition, modern Benders decomposition achieved better convergence in all instances. This can be explained by the faster solving time of the master problem and also by the usage of only one single exploration tree, in a way that it is not necessary to create a search tree and revisit the same nodes at each iteration.

The other acceleration techniques did not perform as well as expected. Convex combination was not able to improve the convergence and in instances with 256 and 625 scenarios, it reached the total amount of memory allowed in the first iterations. Nonetheless, we cannot conclude that these methods are not effective for other models or instances. In instances with more products, the hull reformulation constraints were able to improve the optimality gap of the solutions.

The solution performance of all methods seems to decrease when the parameter γ changes from 0 to 1000. This is line with the work of Miller and Ruszczynski (2011) which shows that the more traditional decomposition algorithms have a better performance for risk-neutral models (
                        
                           γ
                           =
                           0
                        
                     ) rather than for risk-averse ones (
                        
                           γ
                           =
                           1000
                        
                     ).


                     Fig. 4
                      shows the convergence of the upper and lower bound for the multi-cut Benders decomposition algorithm variants and the monolithic approach when solving the instance with 6 products, 81 scenarios and γ set to 0. In this case, the modern Benders method had a faster convergence than other variants of Benders and than the monolithic approach.

@&#CONCLUSIONS AND FUTURE WORK@&#

This paper proposes a novel formulation to tackle the integrated decision of supplier selection and production-distribution planning for processed food supply chains. Uncertainty is present in the suppliers’ processes namely in lead time, availability and spot price, and in customers’ demand, which furthermore depends on the age of the sold product. Results show that only by taking such an integrated approach of tactical and strategic levels, it is possible to make better decisions regarding sourcing of perishable raw materials to produce processed food products. The advantages of the premium price customers are willing to pay is undervalued by decoupled approaches.

Due to the difficulty in solving the problem, we explored a multi-cut Benders decomposition algorithm that leverages the different proposed formulations. This algorithm suits the structure of this supplier selection problem, however, in a short time span it is hard to obtain optimal solutions. Modern Benders decomposition was able to improve significantly the results in comparison with the classical Benders method and the monolithic model. Although acceleration techniques did not perform effectively, hull reformulation applied to the Benders master problem showed that it is potentially a promising method to improve the convergence of Benders, particularly in problems where one can take more advantage of disjunctive programming to tighten the master problem.

Future research in terms of modeling should focus on improving the realistic aspects of the models, for example by considering setup costs and the quality decay of raw materials throughout the aging process. In terms of solution methods, it would be interesting to explore other possible decomposition algorithms, such as Lagrangian decomposition and cross decomposition strategies.

@&#ACKNOWLEDGMENTS@&#

This work is financed by the ERDF – European Regional Development Fund through the COMPETE Programme (operational programme for competitiveness) and by National Funds through the FCT – Fundação para a Ciência e a Tecnologia (Portuguese Foundation for Science and Technology) within project “FCOMP-01-0124-FEDER-041499”. The first author would like also to acknowledge the support of the CMU-Portugal Programme.

@&#REFERENCES@&#

